/*! For license information please see 15.7cdeb6de.chunk.js.LICENSE.txt */
(this["webpackJsonppathfinder-react"]=this["webpackJsonppathfinder-react"]||[]).push([[15],[function(e,t,n){"use strict";n.d(t,"dc",(function(){return at})),n.d(t,"bd",(function(){return ue.a})),n.d(t,"cd",(function(){return ue.b})),n.d(t,"gf",(function(){return it.a})),n.d(t,"sf",(function(){return it.b})),n.d(t,"md",(function(){return ot.b})),n.d(t,"nd",(function(){return ot.e})),n.d(t,"od",(function(){return ot.g})),n.d(t,"pd",(function(){return ot.h})),n.d(t,"qd",(function(){return ot.i})),n.d(t,"rd",(function(){return ot.p})),n.d(t,"sd",(function(){return ot.q})),n.d(t,"vd",(function(){return ot.t})),n.d(t,"wd",(function(){return ot.u})),n.d(t,"xd",(function(){return ot.v})),n.d(t,"zd",(function(){return ot.A})),n.d(t,"Ad",(function(){return ot.B})),n.d(t,"Bd",(function(){return ot.D})),n.d(t,"Cd",(function(){return ot.E})),n.d(t,"Dd",(function(){return ot.G})),n.d(t,"Ed",(function(){return ot.H})),n.d(t,"Fd",(function(){return ot.I})),n.d(t,"Gd",(function(){return ot.J})),n.d(t,"Hd",(function(){return ot.K})),n.d(t,"Id",(function(){return ot.L})),n.d(t,"Jd",(function(){return ot.M})),n.d(t,"Kd",(function(){return ot.N})),n.d(t,"Ld",(function(){return ot.O})),n.d(t,"Md",(function(){return ot.P})),n.d(t,"Nd",(function(){return ot.W})),n.d(t,"Qd",(function(){return ot.Z})),n.d(t,"Sd",(function(){return ot.eb})),n.d(t,"Vd",(function(){return ot.gb})),n.d(t,"Wd",(function(){return ot.jb})),n.d(t,"Xd",(function(){return ot.lb})),n.d(t,"Yd",(function(){return ot.nb})),n.d(t,"Zd",(function(){return ot.ob})),n.d(t,"be",(function(){return ot.rb})),n.d(t,"ce",(function(){return ot.tb})),n.d(t,"de",(function(){return ot.ub})),n.d(t,"ie",(function(){return ot.Db})),n.d(t,"ke",(function(){return ot.Jb})),n.d(t,"le",(function(){return ot.Mb})),n.d(t,"me",(function(){return ot.Ob})),n.d(t,"ne",(function(){return ot.Ub})),n.d(t,"oe",(function(){return ot.Vb})),n.d(t,"pe",(function(){return ot.Wb})),n.d(t,"qe",(function(){return ot.Yb})),n.d(t,"re",(function(){return ot.Zb})),n.d(t,"te",(function(){return ot.cc})),n.d(t,"ue",(function(){return ot.fc})),n.d(t,"ve",(function(){return ot.hc})),n.d(t,"we",(function(){return ot.kc})),n.d(t,"ye",(function(){return ot.mc})),n.d(t,"ze",(function(){return ot.nc})),n.d(t,"Ae",(function(){return ot.oc})),n.d(t,"Be",(function(){return ot.pc})),n.d(t,"Ce",(function(){return ot.sc})),n.d(t,"De",(function(){return ot.yc})),n.d(t,"Ee",(function(){return ot.zc})),n.d(t,"Fe",(function(){return ot.Ec})),n.d(t,"Ge",(function(){return ot.Fc})),n.d(t,"Je",(function(){return ot.Jc})),n.d(t,"Ke",(function(){return ot.Lc})),n.d(t,"Le",(function(){return ot.Mc})),n.d(t,"Me",(function(){return ot.Uc})),n.d(t,"Ne",(function(){return ot.Wc})),n.d(t,"Oe",(function(){return ot.Xc})),n.d(t,"Re",(function(){return ot.Zc})),n.d(t,"Se",(function(){return ot.ed})),n.d(t,"Te",(function(){return ot.fd})),n.d(t,"Ue",(function(){return ot.gd})),n.d(t,"Ve",(function(){return ot.hd})),n.d(t,"We",(function(){return ot.id})),n.d(t,"Ye",(function(){return ot.jd})),n.d(t,"Ze",(function(){return ot.kd})),n.d(t,"af",(function(){return ot.pd})),n.d(t,"bf",(function(){return ot.qd})),n.d(t,"cf",(function(){return ot.td})),n.d(t,"df",(function(){return ot.ud})),n.d(t,"ef",(function(){return ot.yd})),n.d(t,"ff",(function(){return ot.zd})),n.d(t,"hf",(function(){return ot.Bd})),n.d(t,"if",(function(){return ot.Cd})),n.d(t,"jf",(function(){return ot.Dd})),n.d(t,"kf",(function(){return ot.Ed})),n.d(t,"nf",(function(){return ot.Jd})),n.d(t,"qf",(function(){return ot.Md})),n.d(t,"rf",(function(){return ot.Pd})),n.d(t,"uf",(function(){return ot.Qd})),n.d(t,"xf",(function(){return ot.Rd})),n.d(t,"yf",(function(){return ot.Td})),n.d(t,"zf",(function(){return ot.Ud})),n.d(t,"pf",(function(){return ot.Ld})),n.d(t,"Rd",(function(){return ot.cb})),n.d(t,"ee",(function(){return ot.xb})),n.d(t,"je",(function(){return ot.Gb})),n.d(t,"ae",(function(){return ot.qb})),n.d(t,"of",(function(){return xt})),n.d(t,"Td",(function(){return tt.c})),n.d(t,"se",(function(){return tt.e})),n.d(t,"mf",(function(){return tt.h})),n.d(t,"Pd",(function(){return tt.b})),n.d(t,"ge",(function(){return tt.d})),n.d(t,"Qe",(function(){return tt.g})),n.d(t,"He",(function(){return tt.f})),n.d(t,"td",(function(){return tt.a})),n.d(t,"Ie",(function(){return Me.e})),n.d(t,"vf",(function(){return nt.b})),n.d(t,"Ud",(function(){return d.b})),n.d(t,"wf",(function(){return qe})),n.d(t,"xe",(function(){return St.a})),n.d(t,"yd",(function(){return a})),n.d(t,"fe",(function(){return r})),n.d(t,"Pe",(function(){return i})),n.d(t,"tf",(function(){return Qe})),n.d(t,"ud",(function(){return s})),n.d(t,"lf",(function(){return Je})),n.d(t,"Xe",(function(){return _e})),n.d(t,"Od",(function(){return yn})),n.d(t,"he",(function(){return u})),n.d(t,"wb",(function(){return Bn.b})),n.d(t,"L",(function(){return Bn.a})),n.d(t,"a",(function(){return Fe.a})),n.d(t,"b",(function(){return Fe.b})),n.d(t,"c",(function(){return Fe.c})),n.d(t,"d",(function(){return Fe.d})),n.d(t,"e",(function(){return Fe.e})),n.d(t,"f",(function(){return Fe.f})),n.d(t,"g",(function(){return Fe.g})),n.d(t,"h",(function(){return Fe.h})),n.d(t,"i",(function(){return Fe.i})),n.d(t,"j",(function(){return Fe.j})),n.d(t,"k",(function(){return Fe.k})),n.d(t,"l",(function(){return Fe.l})),n.d(t,"n",(function(){return Fe.n})),n.d(t,"m",(function(){return Fe.m})),n.d(t,"o",(function(){return Fe.o})),n.d(t,"r",(function(){return Fe.r})),n.d(t,"p",(function(){return Fe.p})),n.d(t,"q",(function(){return Fe.q})),n.d(t,"s",(function(){return Fe.s})),n.d(t,"t",(function(){return Fe.t})),n.d(t,"u",(function(){return Fe.u})),n.d(t,"v",(function(){return Fe.w})),n.d(t,"w",(function(){return Fe.x})),n.d(t,"x",(function(){return Fe.y})),n.d(t,"y",(function(){return Fe.z})),n.d(t,"z",(function(){return Fe.A})),n.d(t,"A",(function(){return Fe.B})),n.d(t,"B",(function(){return Fe.C})),n.d(t,"C",(function(){return Fe.D})),n.d(t,"D",(function(){return Fe.E})),n.d(t,"E",(function(){return Fe.F})),n.d(t,"F",(function(){return Fe.G})),n.d(t,"G",(function(){return Fe.H})),n.d(t,"H",(function(){return Fe.I})),n.d(t,"I",(function(){return Fe.J})),n.d(t,"K",(function(){return Fe.L})),n.d(t,"J",(function(){return Fe.K})),n.d(t,"M",(function(){return Fe.M})),n.d(t,"N",(function(){return Fe.N})),n.d(t,"O",(function(){return Fe.O})),n.d(t,"P",(function(){return Fe.P})),n.d(t,"Q",(function(){return Fe.Q})),n.d(t,"R",(function(){return Fe.R})),n.d(t,"S",(function(){return Fe.S})),n.d(t,"U",(function(){return Fe.U})),n.d(t,"T",(function(){return Fe.T})),n.d(t,"lc",(function(){return Fe.kc})),n.d(t,"V",(function(){return Fe.V})),n.d(t,"W",(function(){return Fe.W})),n.d(t,"X",(function(){return Fe.X})),n.d(t,"Z",(function(){return Fe.Z})),n.d(t,"Y",(function(){return Fe.Y})),n.d(t,"ab",(function(){return Fe.ab})),n.d(t,"bb",(function(){return Fe.bb})),n.d(t,"cb",(function(){return Fe.cb})),n.d(t,"db",(function(){return Fe.db})),n.d(t,"eb",(function(){return Fe.eb})),n.d(t,"fb",(function(){return Fe.fb})),n.d(t,"gb",(function(){return Fe.gb})),n.d(t,"hb",(function(){return Fe.hb})),n.d(t,"jb",(function(){return Fe.jb})),n.d(t,"nb",(function(){return Fe.nb})),n.d(t,"mb",(function(){return Fe.mb})),n.d(t,"ob",(function(){return Fe.ob})),n.d(t,"pb",(function(){return Fe.pb})),n.d(t,"rb",(function(){return Fe.rb})),n.d(t,"qb",(function(){return Fe.qb})),n.d(t,"sb",(function(){return Fe.sb})),n.d(t,"tb",(function(){return Fe.tb})),n.d(t,"ub",(function(){return Fe.ub})),n.d(t,"vb",(function(){return Fe.vb})),n.d(t,"zb",(function(){return Fe.yb})),n.d(t,"Ab",(function(){return Fe.zb})),n.d(t,"Bb",(function(){return Fe.Ab})),n.d(t,"Cb",(function(){return Fe.Bb})),n.d(t,"Db",(function(){return Fe.Cb})),n.d(t,"Eb",(function(){return Fe.Db})),n.d(t,"Fb",(function(){return Fe.Fb})),n.d(t,"Gb",(function(){return Fe.Gb})),n.d(t,"Hb",(function(){return Fe.Hb})),n.d(t,"xb",(function(){return Fe.wb})),n.d(t,"yb",(function(){return Fe.xb})),n.d(t,"Ib",(function(){return Fe.Ib})),n.d(t,"Ob",(function(){return Fe.Ob})),n.d(t,"Jb",(function(){return Fe.Jb})),n.d(t,"Mb",(function(){return Fe.Mb})),n.d(t,"Kb",(function(){return Fe.Kb})),n.d(t,"Lb",(function(){return Fe.Lb})),n.d(t,"Nb",(function(){return Fe.Nb})),n.d(t,"Pb",(function(){return Fe.Pb})),n.d(t,"Qb",(function(){return Fe.Qb})),n.d(t,"Rb",(function(){return Fe.Rb})),n.d(t,"Sb",(function(){return Fe.Sb})),n.d(t,"Tb",(function(){return Fe.Tb})),n.d(t,"Ub",(function(){return Fe.Ub})),n.d(t,"Vb",(function(){return Fe.Vb})),n.d(t,"Wb",(function(){return Fe.Wb})),n.d(t,"ac",(function(){return Fe.ac})),n.d(t,"Xb",(function(){return Fe.Xb})),n.d(t,"Yb",(function(){return Fe.Yb})),n.d(t,"Zb",(function(){return Fe.Zb})),n.d(t,"cc",(function(){return Fe.cc})),n.d(t,"bc",(function(){return Fe.bc})),n.d(t,"ec",(function(){return Fe.dc})),n.d(t,"fc",(function(){return Fe.ec})),n.d(t,"gc",(function(){return Fe.fc})),n.d(t,"hc",(function(){return Fe.gc})),n.d(t,"ic",(function(){return Fe.hc})),n.d(t,"jc",(function(){return Fe.ic})),n.d(t,"kc",(function(){return Fe.jc})),n.d(t,"mc",(function(){return Fe.lc})),n.d(t,"nc",(function(){return Fe.mc})),n.d(t,"pc",(function(){return Fe.oc})),n.d(t,"sc",(function(){return Fe.rc})),n.d(t,"tc",(function(){return Fe.sc})),n.d(t,"qc",(function(){return Fe.pc})),n.d(t,"rc",(function(){return Fe.qc})),n.d(t,"oc",(function(){return Fe.nc})),n.d(t,"uc",(function(){return Fe.tc})),n.d(t,"wc",(function(){return Fe.vc})),n.d(t,"xc",(function(){return Fe.wc})),n.d(t,"yc",(function(){return Fe.xc})),n.d(t,"zc",(function(){return Fe.yc})),n.d(t,"Ac",(function(){return Fe.zc})),n.d(t,"Fc",(function(){return Fe.Ec})),n.d(t,"Dc",(function(){return Fe.Cc})),n.d(t,"Ec",(function(){return Fe.Dc})),n.d(t,"Cc",(function(){return Fe.Bc})),n.d(t,"Bc",(function(){return Fe.Ac})),n.d(t,"Hc",(function(){return Fe.Gc})),n.d(t,"Pc",(function(){return Fe.Oc})),n.d(t,"Yc",(function(){return Fe.Xc})),n.d(t,"Ic",(function(){return Fe.Hc})),n.d(t,"Oc",(function(){return Fe.Nc})),n.d(t,"Gc",(function(){return Fe.Fc})),n.d(t,"Jc",(function(){return Fe.Ic})),n.d(t,"Kc",(function(){return Fe.Jc})),n.d(t,"Lc",(function(){return Fe.Kc})),n.d(t,"Mc",(function(){return Fe.Lc})),n.d(t,"Nc",(function(){return Fe.Mc})),n.d(t,"Rc",(function(){return Fe.Qc})),n.d(t,"Qc",(function(){return Fe.Pc})),n.d(t,"Tc",(function(){return Fe.Sc})),n.d(t,"Uc",(function(){return Fe.Tc})),n.d(t,"Vc",(function(){return Fe.Uc})),n.d(t,"Wc",(function(){return Fe.Vc})),n.d(t,"Xc",(function(){return Fe.Wc})),n.d(t,"Zc",(function(){return Fe.Yc})),n.d(t,"ad",(function(){return Fe.Zc})),n.d(t,"dd",(function(){return Fe.ad})),n.d(t,"ed",(function(){return Fe.bd})),n.d(t,"fd",(function(){return Fe.cd})),n.d(t,"gd",(function(){return Fe.dd})),n.d(t,"hd",(function(){return Fe.ed})),n.d(t,"id",(function(){return Fe.fd})),n.d(t,"jd",(function(){return Fe.gd})),n.d(t,"kd",(function(){return Fe.hd})),n.d(t,"Sc",(function(){return Fe.Rc})),n.d(t,"ib",(function(){return Fe.ib})),n.d(t,"vc",(function(){return Fe.uc})),n.d(t,"ld",(function(){return Fe.id})),n.d(t,"kb",(function(){return Fe.kb})),n.d(t,"lb",(function(){return Fe.lb}));var r={};n.r(r),n.d(r,"copyModel",(function(){return $})),n.d(r,"listModels",(function(){return U})),n.d(r,"moveModel",(function(){return te})),n.d(r,"removeModel",(function(){return Q})),n.d(r,"browserFiles",(function(){return fe})),n.d(r,"browserHTTPRequest",(function(){return ke})),n.d(r,"concatenateArrayBuffers",(function(){return C.d})),n.d(r,"decodeWeights",(function(){return C.e})),n.d(r,"encodeWeights",(function(){return C.f})),n.d(r,"fromMemory",(function(){return Ne})),n.d(r,"getLoadHandlers",(function(){return y})),n.d(r,"getModelArtifactsInfoForJSON",(function(){return C.g})),n.d(r,"getSaveHandlers",(function(){return A})),n.d(r,"http",(function(){return Se})),n.d(r,"isHTTPScheme",(function(){return Be})),n.d(r,"loadWeights",(function(){return ve})),n.d(r,"registerLoadRouter",(function(){return v})),n.d(r,"registerSaveRouter",(function(){return b})),n.d(r,"weightsLoaderFactory",(function(){return ye})),n.d(r,"withSaveHandler",(function(){return Oe}));var a={};n.r(a),n.d(a,"fromPixelsAsync",(function(){return Xe})),n.d(a,"toPixels",(function(){return Ye})),n.d(a,"fromPixels",(function(){return Ke}));var i={};n.r(i),n.d(i,"Serializable",(function(){return De})),n.d(i,"SerializationMap",(function(){return Pe})),n.d(i,"registerClass",(function(){return Ue}));var o={};n.r(o),n.d(o,"segOpComputeOptimalWindowSize",(function(){return Cn})),n.d(o,"computeOutShape",(function(){return mn})),n.d(o,"collectGatherOpShapeInfo",(function(){return bn}));var s={};n.r(s),n.d(s,"axesAreInnerMostDims",(function(){return kt.b})),n.d(s,"combineLocations",(function(){return kt.c})),n.d(s,"computeOutAndReduceShapes",(function(){return kt.d})),n.d(s,"expandShapeToKeepDim",(function(){return kt.e})),n.d(s,"assertAxesAreInnerMostDims",(function(){return kt.a})),n.d(s,"getAxesPermutation",(function(){return kt.f})),n.d(s,"getUndoAxesPermutation",(function(){return kt.h})),n.d(s,"getInnerMostAxes",(function(){return kt.g})),n.d(s,"getBroadcastDims",(function(){return Zt.b})),n.d(s,"getReductionAxes",(function(){return Zt.c})),n.d(s,"assertAndGetBroadcastShape",(function(){return Zt.a})),n.d(s,"assertParamsConsistent",(function(){return Rt})),n.d(s,"computeOutShape",(function(){return Nt})),n.d(s,"computeDilation2DInfo",(function(){return Ot.d})),n.d(s,"computePool2DInfo",(function(){return Ot.e})),n.d(s,"computePool3DInfo",(function(){return Ot.f})),n.d(s,"computeConv2DInfo",(function(){return Ot.a})),n.d(s,"computeConv3DInfo",(function(){return Ot.b})),n.d(s,"computeDefaultPad",(function(){return Ot.c})),n.d(s,"tupleValuesAreOne",(function(){return Ot.i})),n.d(s,"eitherStridesOrDilationsAreOne",(function(){return Ot.h})),n.d(s,"convertConv2DDataFormat",(function(){return Ot.g})),n.d(s,"getFusedDyActivation",(function(){return Wt.c})),n.d(s,"getFusedBiasGradient",(function(){return Wt.b})),n.d(s,"applyActivation",(function(){return Wt.a})),n.d(s,"shouldFuse",(function(){return Wt.d})),n.d(s,"PARALLELIZE_THRESHOLD",(function(){return Ft})),n.d(s,"computeOptimalWindowSize",(function(){return Mt})),n.d(s,"slice_util",(function(){return _e})),n.d(s,"upcastType",(function(){return it.b})),n.d(s,"getImageCenter",(function(){return Vt})),n.d(s,"getReshaped",(function(){return Tt})),n.d(s,"getPermuted",(function(){return Et})),n.d(s,"getReshapedPermuted",(function(){return jt})),n.d(s,"getSliceBeginCoords",(function(){return Lt})),n.d(s,"getSliceSize",(function(){return Xt})),n.d(s,"prepareAndValidate",(function(){return Ht})),n.d(s,"validateUpdateShape",(function(){return Yt.c})),n.d(s,"validateInput",(function(){return Yt.b})),n.d(s,"calculateShapes",(function(){return Yt.a})),n.d(s,"SELU_SCALEALPHA",(function(){return zt.b})),n.d(s,"SELU_SCALE",(function(){return zt.a})),n.d(s,"ERF_P",(function(){return Kt})),n.d(s,"ERF_A1",(function(){return _t})),n.d(s,"ERF_A2",(function(){return Dt})),n.d(s,"ERF_A3",(function(){return Pt})),n.d(s,"ERF_A4",(function(){return Ut})),n.d(s,"ERF_A5",(function(){return Jt})),n.d(s,"warn",(function(){return Qt})),n.d(s,"log",(function(){return qt})),n.d(s,"mergeRealAndImagArrays",(function(){return $t})),n.d(s,"splitRealAndImagArrays",(function(){return en})),n.d(s,"complexWithEvenIndex",(function(){return tn})),n.d(s,"complexWithOddIndex",(function(){return nn})),n.d(s,"getComplexWithIndex",(function(){return rn})),n.d(s,"assignToTypedArray",(function(){return an})),n.d(s,"exponents",(function(){return on})),n.d(s,"exponent",(function(){return sn})),n.d(s,"decodeEinsumEquation",(function(){return ln})),n.d(s,"getEinsumPermutation",(function(){return gn})),n.d(s,"checkEinsumDimSizes",(function(){return dn})),n.d(s,"getEinsumComputePath",(function(){return hn})),n.d(s,"isIdentityPermutation",(function(){return fn})),n.d(s,"prepareSplitSize",(function(){return In})),n.d(s,"segment_util",(function(){return o})),n.d(s,"fromUint8ToStringArray",(function(){return vn})),n.d(s,"fromStringArrayToUint8",(function(){return An}));var u={};n.r(u),n.d(u,"nonMaxSuppressionV3Impl",(function(){return wn.a})),n.d(u,"nonMaxSuppressionV4Impl",(function(){return wn.b})),n.d(u,"nonMaxSuppressionV5Impl",(function(){return wn.c})),n.d(u,"whereImpl",(function(){return Gn.a}));var c=n(11),l=(n(200),n(1)),g=n(9),d=n(36),h=n(16),f=n(7),p=n.n(f),I=n(17),C=n(68),m=function(){function e(){Object(l.a)(this,e),this.saveRouters=[],this.loadRouters=[]}return Object(g.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),b=function(e){return m.registerSaveRouter(e)},v=function(e){return m.registerLoadRouter(e)},A=function(e){return m.getSaveHandlers(e)},y=function(e,t){return m.getLoadHandlers(e,t)},w="tensorflowjs",G="models_store",B="model_info_store";function x(){if(!Object(d.b)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function S(e){var t=e.result;t.createObjectStore(G,{keyPath:"modelPath"}),t.createObjectStore(B,{keyPath:"modelPath"})}var k=function(){function e(t){if(Object(l.a)(this,e),this.indexedDB=x(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return Object(g.a)(e,[{key:"save",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(w,1);a.onupgradeneeded=function(){return S(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(G,"readonly"),s=o.objectStore(G).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=Object(C.g)(t),l=i.transaction(B,"readwrite"),g=l.objectStore(B),d=g.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var a=(u=i.transaction(G,"readwrite")).objectStore(G).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(g=l.objectStore(B)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},d.onerror=function(e){return i.close(),r(d.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();k.URL_SCHEME="indexeddb://";var Z=function(e){return Object(d.b)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(k.URL_SCHEME)?(t=e.slice(k.URL_SCHEME.length),new k(t)):null;var t};m.registerSaveRouter(Z),m.registerLoadRouter(Z);var R=function(){function e(){Object(l.a)(this,e),this.indexedDB=x()}return Object(g.a)(e,[{key:"listModels",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(w,1);r.onupgradeneeded=function(){return S(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(B,"readonly"),i=a.objectStore(B).getAll();i.onsuccess=function(){var t,n={},r=Object(h.a)(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(k.URL_SCHEME)?r.slice(k.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(w,1);a.onupgradeneeded=function(){return S(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(B,"readwrite"),s=o.objectStore(B),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(G,"readwrite")).objectStore(G).delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),N=n(19),O="/",W="tensorflowjs_models",F="info",M="model_topology",V="weight_specs",T="weight_data",E="model_metadata";function j(e){return{info:[W,e,F].join(O),topology:[W,e,M].join(O),weightSpecs:[W,e,V].join(O),weightData:[W,e,T].join(O),modelMetadata:[W,e,E].join(O)}}function L(e){var t=e.split(O);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(O)}var X=function(){function e(t){if(Object(l.a)(this,e),!Object(d.b)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=j(this.modelPath)}return Object(g.a)(e,[{key:"save",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r,a,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Object(C.g)(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Object(C.a)(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy},null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 20:throw e.prev=20,e.t0=e.catch(7),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 28:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t,n,r,a,i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Object(C.b)(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();X.URL_SCHEME="localstorage://";var H=function(e){return Object(d.b)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(X.URL_SCHEME)?(t=e.slice(X.URL_SCHEME.length),new X(t)):null;var t};m.registerSaveRouter(H),m.registerLoadRouter(H);var Y=function(){function e(){Object(l.a)(this,e),Object(N.b)(Object(d.b)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Object(N.b)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return Object(g.a)(e,[{key:"listModels",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t,n,r,a,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=W+O,r=O+F,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=L(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(X.URL_SCHEME)?a.slice(X.URL_SCHEME.length):a,n=j(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),e.abrupt("return",r);case 10:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),z="://",K=function(){function e(){Object(l.a)(this,e),this.managers={}}return Object(g.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Object(N.b)(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(z)&&(t=t.slice(0,t.indexOf(z))),Object(N.b)(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Object(N.b)(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function _(e){if(-1===e.indexOf(z))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(K.getSchemes().join(",")));return{scheme:e.split(z)[0],path:e.split(z)[1]}}function D(e,t){return P.apply(this,arguments)}function P(){return(P=Object(I.a)(p.a.mark((function e(t,n){var r,a,i,o,s,u,c,l,g,d,h=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>2&&void 0!==h[2]&&h[2],Object(N.b)(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),a=m.getLoadHandlers(t),Object(N.b)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),Object(N.b)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],o=m.getSaveHandlers(n),Object(N.b)(o.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),Object(N.b)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=_(t).scheme,c=_(t).path,l=u===_(t).scheme,e.next=15,i.load();case 15:if(g=e.sent,!r||!l){e.next=19;break}return e.next=19,K.getManager(u).removeModel(c);case 19:return e.next=21,s.save(g);case 21:if(d=e.sent,!r||l){e.next=25;break}return e.next=25,K.getManager(u).removeModel(c);case 25:return e.abrupt("return",d.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return J.apply(this,arguments)}function J(){return(J=Object(I.a)(p.a.mark((function e(){var t,n,r,a,i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=K.getSchemes(),n={},r=Object(h.a)(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,K.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+z+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function Q(e){return q.apply(this,arguments)}function q(){return(q=Object(I.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_(t),r=K.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(I.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",D(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(I.a)(p.a.mark((function e(t,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",D(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=function(){function e(){Object(l.a)(this,e)}return Object(g.a)(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(Object(d.b)().get("IS_BROWSER")){Object(d.b)().setPlatform("browser",new re);try{K.registerManager(X.URL_SCHEME,new Y)}catch(xn){}try{K.registerManager(k.URL_SCHEME,new R)}catch(xn){}}n(429);var ae=n(76),ie=n(27),oe=n(107),se=n(220),ue=n(14);Object(c.b)();var ce={buffer:ae.a,cast:ie.a,clone:oe.a,print:se.a};Object(ue.f)(ce);var le=n(21);function ge(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var de=function(){function e(t){if(Object(l.a)(this,e),!Object(d.b)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return Object(g.a)(e,[{key:"save",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r,a,i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,e.next=18,ge((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 18:if(null==t.weightData){e.next=24;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,e.next=24,ge((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 24:return e.abrupt("return",{modelArtifactsInfo:Object(C.g)(t)});case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();de.URL_SCHEME="downloads://";var he=function(){function e(t){if(Object(l.a)(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}return Object(g.a)(e,[{key:"load",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t,n,r=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===n.length&&e({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=r.checkManifestAndWeightFiles(u,n)}catch(xn){return void a(xn)}var l=[],g=[],d=[];u.forEach((function(e){e.paths.forEach((function(e){g.push(e),d.push(null)})),l.push.apply(l,Object(le.a)(e.weights))})),u.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=g.indexOf(t);if(d[a]=r,-1===d.indexOf(null)){var i={modelTopology:s,weightSpecs:l,weightData:Object(C.d)(d),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy};null!=o.signature&&(i.signature=o.signature),null!=o.userDefinedMetadata&&(i.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(i.modelInitializer=o.modelInitializer),e(i)}},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(c[t])}))}))}else a(new Error("weightManifest field is missing from file ".concat(t.name)))}else a(new Error("modelTopology field is missing from file ".concat(t.name)))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(t)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return Object(C.c)(e.name)})),i={},o=Object(h.a)(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=Object(C.c)(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch(xn){o.e(xn)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return i}}]),e}();function fe(e){return new he(e)}m.registerSaveRouter((function(e){return Object(d.b)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(de.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new de(e)}(e.slice(de.URL_SCHEME.length)):null}));var pe=n(3);function Ie(e,t,n,r){!function(e){Object(N.b)(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Object(N.b)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),Object(N.b)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),Object(N.b)(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}var Ce=n(209);function me(e,t){return be.apply(this,arguments)}function be(){return(be=Object(I.a)(p.a.mark((function e(t,n){var r,a,i,o,s,u,c,l,g;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Object(d.b)().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,Ie(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,u=s.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(u);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,Ie(u,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return g=e.t1,e.abrupt("return",g);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(I.a)(p.a.mark((function e(t){var n,r,a,i,o=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=ye((function(e){return me(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(e){return function(){var t=Object(I.a)(p.a.mark((function t(n){var r,a,i,o,s,u,c,l,g,d,h,f,I=arguments;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=I.length>1&&void 0!==I[1]?I[1]:"",a=I.length>2?I[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=Ce.a[r]*N.O(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),u.push(e.name),n+=c}))})),s.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),g=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;g.push(t)}))})),t.next=15,e(g);case 15:return d=t.sent,h={},f=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=d[f+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<t;c++){var l=new Uint8Array(d[f+c]);s.set(l,u),u+=l.byteLength}o[e].forEach((function(e){var t=i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=Object(C.e)(t,[e.manifestEntry]);for(var r in n)h[r]=n[r]})),f+=t})),t.abrupt("return",h);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}var we=function(){function e(t,n){if(Object(l.a)(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Object(N.b)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Object(d.b)().platform.fetch,Object(N.b)(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Object(N.b)(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return Object(g.a)(e,[{key:"save",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r,a,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=13,this.fetch(this.path,n);case 13:if(!(i=e.sent).ok){e.next=18;break}return e.abrupt("return",{modelArtifactsInfo:Object(C.g)(t),responses:[i]});case 18:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t,n,r,a,i,o,s,u,c,l,g,d,h,f,I,C;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,c=n.signature,l=n.userDefinedMetadata,null!=a||null!=i){e.next=25;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 25:if(null==i){e.next=32;break}return e.next=28,this.loadWeights(i);case 28:h=e.sent,f=Object(pe.a)(h,2),g=f[0],d=f[1];case 32:return I={modelTopology:a,weightSpecs:g,weightData:d,generatedBy:o,convertedBy:s,format:u},null!=c&&(I.signature=c),null!=l&&(I.userDefinedMetadata=l),(C=n.modelInitializer)&&(I.modelInitializer=C),e.abrupt("return",I);case 38:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r,a,i,o,s,u,c,l,g,d,f,I,m,b,v,A,y,w;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=Ge(n),a=Object(pe.a)(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=[],c=Object(h.a)(t);try{for(c.s();!(l=c.n()).done;)g=l.value,u.push.apply(u,Object(le.a)(g.weights))}catch(xn){c.e(xn)}finally{c.f()}d=[],f=[],I=Object(h.a)(t);try{for(I.s();!(m=I.n()).done;){b=m.value,v=Object(h.a)(b.paths);try{for(v.s();!(A=v.n()).done;)y=A.value,null!=this.weightUrlConverter?f.push(this.weightUrlConverter(y)):d.push(s+y+o)}catch(xn){v.e(xn)}finally{v.f()}}}catch(xn){I.e(xn)}finally{I.f()}if(!this.weightUrlConverter){e.next=19;break}return e.t0=d.push,e.t1=d,e.t2=le.a,e.next=16,Promise.all(f);case 16:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 19:return e.next=21,me(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return w=e.sent,e.abrupt("return",[u,Object(C.d)(w)]);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Ge(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function Be(e){return null!=e.match(we.URL_SCHEME_REGEX)}we.URL_SCHEME_REGEX=/^https?:\/\//;var xe=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Be(e)})):Be(e))?Se(e,t):null};function Se(e,t){return new we(e,t)}function ke(e,t){return Se(e,t)}m.registerSaveRouter(xe),m.registerLoadRouter(xe);var Ze=function(){function e(t){Object(l.a)(this,e),this.modelArtifacts=t}return Object(g.a)(e,[{key:"load",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Re=function(){function e(t){Object(l.a)(this,e),this.saveHandler=t}return Object(g.a)(e,[{key:"save",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Ne(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new Ze(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ze({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ze({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function Oe(e){return new Re(e)}var We,Fe=n(6),Me=n(99),Ve=n(5),Te=n(10),Ee=n(251);function je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(a){var u=2;if(a&&e.readyState<u)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var l=Object(Me.b)(Fe.ib,c.a.backendName);if(null!=l){var g={pixels:e},d={numChannels:t};return c.a.runKernel(Fe.ib,g,d)}var h,f,p=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],I=Object(pe.a)(p,2),C=I[0],m=I[1];if(o?h=e.getContext("2d").getImageData(0,0,C,m).data:r||n?h=e.data:(i||a||s)&&(null==We&&(We=document.createElement("canvas").getContext("2d")),We.canvas.width=C,We.canvas.height=m,We.drawImage(e,0,0,C,m),h=We.getImageData(0,0,C,m).data),4===t)f=new Int32Array(h);else{var b=C*m;f=new Int32Array(b*t);for(var v=0;v<b;v++)for(var A=0;A<t;++A)f[v*t+A]=h[4*v+A]}var y=[m,C,t];return Object(Ee.a)(f,y,"int32")}function Le(e){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}function Xe(e){return He.apply(this,arguments)}function He(){return(He=Object(I.a)(p.a.mark((function e(t){var n,r,a,i=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=null,!Object(d.b)().getBool("WRAP_TO_IMAGEBITMAP")||!Le(t)){e.next=15;break}return e.prev=3,e.next=6,createImageBitmap(t,{premultiplyAlpha:"none"});case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a=null;case 12:r=null!=a&&a.width===t.width&&a.height===t.height?a:t,e.next=16;break;case 15:r=t;case 16:return e.abrupt("return",je(r,n));case 17:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function Ye(e,t){return ze.apply(this,arguments)}function ze(){return(ze=Object(I.a)(p.a.mark((function e(t,n){var r,a,i,o,s,u,c,l,g,d,h,f,I,C,m,b,v;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(Ve.a)(t,"img","toPixels"),t instanceof ue.a||(a=r,r=Object(ie.a)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=Object(pe.a)(i,2),s=o[0],u=o[1],!((c=2===r.rank?1:r.shape[2])>4||2===c)){e.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(c));case 8:if("float32"===r.dtype||"int32"===r.dtype){e.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 10:return e.next=12,r.data();case 12:l=e.sent,g="float32"===r.dtype?255:1,d=new Uint8ClampedArray(u*s*4),h=0;case 16:if(!(h<s*u)){e.next=41;break}f=[0,0,0,255],I=0;case 19:if(!(I<c)){e.next=33;break}if(C=l[h*c+I],"float32"!==r.dtype){e.next=26;break}if(!(C<0||C>1)){e.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(C,"."));case 24:e.next=29;break;case 26:if("int32"!==r.dtype){e.next=29;break}if(!(C<0||C>255)){e.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(C,"."));case 29:1===c?(f[0]=C*g,f[1]=C*g,f[2]=C*g):f[I]=C*g;case 30:I++,e.next=19;break;case 33:d[(m=4*h)+0]=Math.round(f[0]),d[m+1]=Math.round(f[1]),d[m+2]=Math.round(f[2]),d[m+3]=Math.round(f[3]);case 38:++h,e.next=16;break;case 41:return null!=n&&(n.width=u,n.height=s,b=n.getContext("2d"),v=new ImageData(d,u,s),b.putImageData(v,0,0)),r!==t&&r.dispose(),e.abrupt("return",d);case 44:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ke=Object(Te.b)({fromPixels_:je}),_e=n(163),De=function(){function e(){Object(l.a)(this,e)}return Object(g.a)(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),Pe=function(){function e(){Object(l.a)(this,e),this.classNameMap={}}return Object(g.a)(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function Ue(e){Object(N.b)(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),Object(N.b)("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),Object(N.b)(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Pe.register(e)}var Je=n(37),Qe=n(24),qe="3.7.0",$e=n(12),et=n(13),tt=n(46),nt=n(59),rt=n(32),at=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return Object(tt.b)(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return Object(nt.b)(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&Object(tt.b)(this.iterations_)}},{key:"saveIterations",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:Object(rt.a)(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(De);Object.defineProperty(at,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var it=n(130),ot=n(35),st=n(28),ut=n(30),ct=n(20),lt=n(65),gt=n(43),dt=n(34),ht=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(l.a)(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=c.a.backend.epsilon()),a}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=c.a.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:Object(tt.h)((function(){return Object(dt.a)(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:Object(tt.h)((function(){return Object(dt.a)(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;Object(tt.h)((function(){var e=Object(st.a)(Object(ct.a)(o,t.rho),Object(ct.a)(Object(gt.a)(i),1-t.rho)),n=Object(ct.a)(Object(ut.a)(Object(lt.a)(Object(st.a)(s,t.epsilon)),Object(lt.a)(Object(st.a)(o,t.epsilon))),i),r=Object(st.a)(Object(ct.a)(s,t.rho),Object(ct.a)(Object(gt.a)(n),1-t.rho));o.assign(e),s.assign(r);var u=Object(st.a)(Object(ct.a)(n,-t.learningRate),a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(Object(tt.b)(this.accumulatedGrads.map((function(e){return e.variable}))),Object(tt.b)(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(le.a)(this.accumulatedGrads),Object(le.a)(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(at);ht.className="Adadelta",Ue(ht);var ft=n(135),pt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return Object(l.a)(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=c.a.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:Object(tt.h)((function(){return Object(ft.a)(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;Object(tt.h)((function(){var e=Object(st.a)(o,Object(gt.a)(i));o.assign(e);var n=Object(st.a)(Object(ct.a)(Object(ut.a)(i,Object(lt.a)(Object(st.a)(e,c.a.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&Object(tt.b)(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(at);pt.className="Adagrad",Ue(pt);var It=n(85),Ct=n(29),mt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Object(l.a)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],Object(tt.h)((function(){i.accBeta1=Object(rt.a)(r).variable(),i.accBeta2=Object(rt.a)(a).variable()})),null==o&&(i.epsilon=c.a.backend.epsilon()),i}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Object(tt.h)((function(){var r=Object(Ct.a)(1,t.accBeta1),a=Object(Ct.a)(1,t.accBeta2);n.forEach((function(n,i){var o=c.a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Object(tt.h)((function(){return Object(dt.a)(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:Object(tt.h)((function(){return Object(dt.a)(o).variable(false)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,l=t.accumulatedSecondMoment[i].variable,g=Object(st.a)(Object(ct.a)(u,t.beta1),Object(ct.a)(s,1-t.beta1)),d=Object(st.a)(Object(ct.a)(l,t.beta2),Object(ct.a)(Object(gt.a)(s),1-t.beta2)),h=Object(ut.a)(g,r),f=Object(ut.a)(d,a);u.assign(g),l.assign(d);var p=Object(st.a)(Object(ct.a)(Object(ut.a)(h,Object(st.a)(Object(lt.a)(f),t.epsilon)),-t.learningRate),o);o.assign(p)}})),t.accBeta1.assign(Object(ct.a)(t.accBeta1,t.beta1)),t.accBeta2.assign(Object(ct.a)(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Object(tt.b)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&Object(tt.b)(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(le.a)(this.accumulatedFirstMoment),Object(le.a)(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r=this;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,Object(tt.h)((function(){r.accBeta1.assign(Object(It.a)(r.beta1,r.iterations_+1)),r.accBeta2.assign(Object(It.a)(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(at);mt.className="Adam",Ue(mt);var bt=n(71),vt=n(138),At=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Object(l.a)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],Object(tt.h)((function(){i.iteration=Object(rt.a)(0).variable(),i.accBeta1=Object(rt.a)(r).variable()})),null==o&&(i.epsilon=c.a.backend.epsilon()),i}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);Object(tt.h)((function(){var r=Object(Ct.a)(1,t.accBeta1),a=Object(ut.a)(-t.learningRate,Object(st.a)(Object(ct.a)(t.iteration,t.decay),1));n.forEach((function(n,i){var o=c.a.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:Object(dt.a)(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:Object(dt.a)(o).variable(false)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,l=t.accumulatedWeightedInfNorm[i].variable,g=Object(st.a)(Object(ct.a)(u,t.beta1),Object(ct.a)(s,1-t.beta1)),d=Object(ct.a)(l,t.beta2),h=Object(bt.a)(s),f=Object(vt.a)(d,h);u.assign(g),l.assign(f);var p=Object(st.a)(Object(ct.a)(Object(ut.a)(a,r),Object(ut.a)(g,Object(st.a)(f,t.epsilon))),o);o.assign(p)}})),t.iteration.assign(Object(st.a)(t.iteration,1)),t.accBeta1.assign(Object(ct.a)(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Object(tt.b)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&Object(tt.b)(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(at);At.className="Adamax",Ue(At);var yt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=c.a.registeredVariables[n];Object(tt.h)((function(){var e=Object(st.a)(Object(ct.a)(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=Object(tt.d)(Object(rt.a)(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(at);yt.className="SGD",Ue(yt);var wt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(l.a)(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=Object(rt.a)(a.momentum),a}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=c.a.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:Object(tt.h)((function(){return Object(dt.a)(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&Object(tt.h)((function(){var e,n=Object(st.a)(Object(ct.a)(t.m,i),o);e=t.useNesterov?Object(st.a)(Object(ct.a)(t.c,Object(st.a)(o,Object(ct.a)(n,t.m))),a):Object(st.a)(Object(ct.a)(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&Object(tt.b)(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(yt);wt.className="Momentum",Ue(wt);var Gt=function(e){Object($e.a)(n,e);var t=Object(et.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(l.a)(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=s,null==o&&(r.epsilon=c.a.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return Object(g.a)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=c.a.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:Object(tt.h)((function(){return Object(dt.a)(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:Object(tt.h)((function(){return Object(dt.a)(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:Object(tt.h)((function(){return Object(dt.a)(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var s=t.accumulatedMeanSquares[r].variable,u=t.accumulatedMoments[r].variable;Object(tt.h)((function(){var e=Object(st.a)(Object(ct.a)(s,t.decay),Object(ct.a)(Object(gt.a)(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=Object(st.a)(Object(ct.a)(n,t.decay),Object(ct.a)(o,1-t.decay)),c=Object(ut.a)(Object(ct.a)(o,t.learningRate),Object(lt.a)(Object(Ct.a)(e,Object(st.a)(Object(gt.a)(i),t.epsilon)))),l=Object(st.a)(Object(ct.a)(u,t.momentum),c);s.assign(e),n.assign(i),u.assign(l);var g=Object(Ct.a)(a,l);a.assign(g)}else{var d=Object(st.a)(Object(ct.a)(s,t.decay),Object(ct.a)(Object(gt.a)(o),1-t.decay)),h=Object(st.a)(Object(ct.a)(u,t.momentum),Object(ut.a)(Object(ct.a)(o,t.learningRate),Object(lt.a)(Object(st.a)(d,t.epsilon))));s.assign(d),u.assign(h);var f=Object(Ct.a)(a,h);a.assign(f)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&Object(tt.b)(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Object(tt.b)(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&Object(tt.b)(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(Object(le.a)(this.accumulatedMeanSquares),Object(le.a)(this.accumulatedMoments)),this.centered&&t.push.apply(t,Object(le.a)(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=Object(I.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(at);Gt.className="RMSProp",Ue(Gt);var Bt=function(){function e(){Object(l.a)(this,e)}return Object(g.a)(e,null,[{key:"sgd",value:function(e){return new yt(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new wt(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Gt(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new mt(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new ht(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new At(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new pt(e,t)}}]),e}(),xt={sgd:Bt.sgd,momentum:Bt.momentum,adadelta:Bt.adadelta,adagrad:Bt.adagrad,rmsprop:Bt.rmsprop,adamax:Bt.adamax,adam:Bt.adam},St=n(331),kt=n(67),Zt=n(33);function Rt(e,t){var n=e[0].length;e.forEach((function(e,t){N.b(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),N.b(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)N.b(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function Nt(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var Ot=n(53),Wt=n(72),Ft=30;function Mt(e){return e<=Ft?e:Object(N.G)(e,Math.floor(Math.sqrt(e)))}function Vt(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Tt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function Et(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<e;++s)s>=2*t+1||s%2===1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function jt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Lt(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Xt(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function Ht(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===Object(N.O)(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var u=e.shape,c=a.slice();c.pop();for(var l=1,g=i;g<n;++g)l*=u[g],c.push(u[g]);var d=[].concat(Object(le.a)(Object(N.j)(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,d]}var Yt=n(162),zt=n(205),Kt=.3275911,_t=.254829592,Dt=-.284496736,Pt=1.421413741,Ut=-1.453152027,Jt=1.061405429;function Qt(){var e;Object(d.b)().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function qt(){var e;Object(d.b)().getBool("IS_TEST")||(e=console).log.apply(e,arguments)}function $t(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function en(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function tn(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function nn(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function rn(e,t){return{real:e[2*t],imag:e[2*t+1]}}function an(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function on(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function sn(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var un="->",cn=/->/g;function ln(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(cn,"").length)/un.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(un,'").'));var r=e.split(un),a=Object(pe.a)(r,2),i=a[0],o=a[1];Object(N.b)(-1===i.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var s=i.split(","),u=s.length;if(t!==u)throw new Error("Expected ".concat(u," input tensors, received ").concat(t));if(u>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var c=[],l=function(e){var t=o[e];if(!s.some((function(e){return-1!==e.indexOf(t)})))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===c.indexOf(t)&&c.push(t)},g=0;g<o.length;++g)l(g);for(var d=0;d<i.length;++d){var h=i[d];-1===c.indexOf(h)&&","!==h&&c.push(h)}for(var f=new Array(s.length),p=0;p<u;++p){if(new Set(s[p].split("")).size!==s[p].length)throw new Error("Found duplicate axes in input component ".concat(s[p],". ")+"Support for duplicate axes in input is not implemented yet.");f[p]=[];for(var I=0;I<s[p].length;++I)f[p].push(c.indexOf(s[p][I]))}for(var C=c.length,m=[],b=o.length;b<C;++b)m.push(b);return{allDims:c,summedDims:m,idDims:f}}function gn(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function dn(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:Object(N.b)(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function hn(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],s=0;s<r.length;++s){var u,c=pn(t,r[s]),l=Object(h.a)(c);try{for(l.s();!(u=l.n()).done;){var g=u.value;-1===o.indexOf(g)&&(a[s].push(g),o.push(g))}}catch(xn){l.e(xn)}finally{l.f()}}return{path:r,steps:a}}function fn(e){return e.every((function(e,t){return e===t}))}function pn(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function In(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)Object(N.b)(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);Object(N.b)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}Object(N.b)(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function Cn(e,t){var n,r=!1;for(e<=Ft?(n=e,r=!0):n=Object(N.G)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Object(N.G)(e,n+1);return n}function mn(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function bn(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],u=[],c=1,l=1,g=1,d=0;d<r;++d)u.push(e.shape[d]),c*=e.shape[d];for(var h=r;h<n;h++)u.push(e.shape[h]),l*=e.shape[h];for(var f=r;f<a;f++)u.push(t.shape[f]);for(var p=n+1;p<i;p++)u.push(e.shape[p]),g*=e.shape[p];return{batchSize:c,sliceSize:g,outerSize:l,dimSize:s,outputShape:u}}function vn(e){try{return e.map((function(e){return Object(Qe.decodeString)(e)}))}catch(xn){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(xn))}}function An(e){return e.map((function(e){return Object(Qe.encodeString)(e)}))}var yn=n(219),wn=n(113),Gn=n(255),Bn=n(201)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";e.exports=n(408)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(257);var a=n(141),i=n(258);function o(e,t){return Object(r.a)(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}}(e,t)||Object(a.a)(e,t)||Object(i.a)()}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return d}));var r=n(3),a=n(0);function i(e,t,n,r,i){var s=t.inputParams[e];if(s&&void 0!==s.inputIndexStart){var u=s.inputIndexStart,c=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?u+1:s.inputIndexEnd;if("tensor"===s.type)return o(t.inputNames[s.inputIndexStart],n,r,i);if("tensors"===s.type)return t.inputNames.slice(u,c).map((function(e){return o(e,n,r,i)}));var l=o(t.inputNames.slice(u)[0],n,r,i),g=l.dataSync();return"number"===s.type?g[0]:a.tf.toNestedArray(l.shape,g)}var d=t.attrParams[e];return d&&d.value}function o(e,t,n,a){var i=l(e),o=Object(r.a)(i,2),s=o[0],u=o[1];if(null!=a){var g=a.getHashTableHandleByName(s);if(null!=g)return g}var d=n.currentContextIds.find((function(e){return!!t[c(s,e)]}));return void 0!==d?t[c(s,d)][u]:void 0}function s(e,t,n){return t[c(e,n.currentContextId)]}function u(e,t){var n=l(e),a=Object(r.a)(n,3),i=a[0],o=a[1],s=a[2];return[c(i,t&&t.currentContextId),o,s]}function c(e,t){return t?"".concat(e,"-").concat(t):e}function l(e){var t=e.split(":");if(1===t.length)return[e,0,void 0];var n=t[0],r=3===t.length?t[1]:void 0;return[n,Number(t[t.length-1]),r]}function g(e,t,n){var r=i("pad",e,t,n);if("explicit"===r){r=i("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],o=0;o<4;o++)a[o][0]=r[2*o],a[o][1]=r[2*o+1];return a}return r}function d(e){return e.kept?e:Object(a.Cd)(e)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return d}));var r=n(11),a=n(36),i=n(14),o=n(19),s=n(24);function u(e,t){var n=e;if(Object(o.A)(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Object(o.A)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Object(a.b)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&c(e,r,[]),r}function c(e,t,n){if(n=n||[],Array.isArray(e)||Object(o.A)(e)){Object(o.b)(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),Object(o.b)(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)c(e[a],r,n.concat(a))}else Object(o.b)(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function l(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function g(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof i.a)return l(a,e.dtype,t,n),e;var c=Object(o.r)(e);if("string"!==c&&["bool","int32","float32"].indexOf(a)>=0&&(c=a),l(a,c,t,n),null==e||!Object(o.A)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var g=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(g,"'"))}var d=u(e,c);Object(o.A)(e)||Array.isArray(e)||(e=[e]);var h=!0,f="string"!==c?Object(s.toTypedArray)(e,c):Object(o.m)(e,[],h);return r.a.makeTensor(f,d,c)}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return g(e,"".concat(t,"[").concat(a,"]"),n,r)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return g})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"m",(function(){return I})),n.d(t,"o",(function(){return C})),n.d(t,"r",(function(){return m})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return v})),n.d(t,"s",(function(){return A})),n.d(t,"t",(function(){return y})),n.d(t,"u",(function(){return w})),n.d(t,"v",(function(){return G})),n.d(t,"w",(function(){return B})),n.d(t,"x",(function(){return x})),n.d(t,"y",(function(){return S})),n.d(t,"z",(function(){return k})),n.d(t,"A",(function(){return Z})),n.d(t,"B",(function(){return R})),n.d(t,"C",(function(){return N})),n.d(t,"D",(function(){return O})),n.d(t,"E",(function(){return W})),n.d(t,"F",(function(){return F})),n.d(t,"G",(function(){return M})),n.d(t,"H",(function(){return V})),n.d(t,"I",(function(){return T})),n.d(t,"J",(function(){return E})),n.d(t,"L",(function(){return j})),n.d(t,"K",(function(){return L})),n.d(t,"M",(function(){return X})),n.d(t,"N",(function(){return H})),n.d(t,"O",(function(){return Y})),n.d(t,"P",(function(){return z})),n.d(t,"Q",(function(){return K})),n.d(t,"R",(function(){return _})),n.d(t,"S",(function(){return D})),n.d(t,"U",(function(){return P})),n.d(t,"T",(function(){return U})),n.d(t,"kc",(function(){return J})),n.d(t,"V",(function(){return Q})),n.d(t,"W",(function(){return q})),n.d(t,"X",(function(){return $})),n.d(t,"Z",(function(){return ee})),n.d(t,"Y",(function(){return te})),n.d(t,"ab",(function(){return ne})),n.d(t,"bb",(function(){return re})),n.d(t,"cb",(function(){return ae})),n.d(t,"db",(function(){return ie})),n.d(t,"eb",(function(){return oe})),n.d(t,"fb",(function(){return se})),n.d(t,"gb",(function(){return ue})),n.d(t,"hb",(function(){return ce})),n.d(t,"jb",(function(){return le})),n.d(t,"nb",(function(){return ge})),n.d(t,"mb",(function(){return de})),n.d(t,"ob",(function(){return he})),n.d(t,"pb",(function(){return fe})),n.d(t,"rb",(function(){return pe})),n.d(t,"qb",(function(){return Ie})),n.d(t,"sb",(function(){return Ce})),n.d(t,"tb",(function(){return me})),n.d(t,"ub",(function(){return be})),n.d(t,"vb",(function(){return ve})),n.d(t,"yb",(function(){return Ae})),n.d(t,"zb",(function(){return ye})),n.d(t,"Ab",(function(){return we})),n.d(t,"Bb",(function(){return Ge})),n.d(t,"Cb",(function(){return Be})),n.d(t,"Db",(function(){return xe})),n.d(t,"Fb",(function(){return Se})),n.d(t,"Gb",(function(){return ke})),n.d(t,"Hb",(function(){return Ze})),n.d(t,"Eb",(function(){return Re})),n.d(t,"wb",(function(){return Ne})),n.d(t,"xb",(function(){return Oe})),n.d(t,"Ib",(function(){return We})),n.d(t,"Ob",(function(){return Fe})),n.d(t,"Jb",(function(){return Me})),n.d(t,"Mb",(function(){return Ve})),n.d(t,"Kb",(function(){return Te})),n.d(t,"Lb",(function(){return Ee})),n.d(t,"Nb",(function(){return je})),n.d(t,"Pb",(function(){return Le})),n.d(t,"Qb",(function(){return Xe})),n.d(t,"Rb",(function(){return He})),n.d(t,"Sb",(function(){return Ye})),n.d(t,"Tb",(function(){return ze})),n.d(t,"Ub",(function(){return Ke})),n.d(t,"Vb",(function(){return _e})),n.d(t,"Wb",(function(){return De})),n.d(t,"ac",(function(){return Pe})),n.d(t,"Xb",(function(){return Ue})),n.d(t,"Yb",(function(){return Je})),n.d(t,"Zb",(function(){return Qe})),n.d(t,"cc",(function(){return qe})),n.d(t,"bc",(function(){return $e})),n.d(t,"dc",(function(){return et})),n.d(t,"ec",(function(){return tt})),n.d(t,"fc",(function(){return nt})),n.d(t,"gc",(function(){return rt})),n.d(t,"hc",(function(){return at})),n.d(t,"ic",(function(){return it})),n.d(t,"jc",(function(){return ot})),n.d(t,"lc",(function(){return st})),n.d(t,"mc",(function(){return ut})),n.d(t,"oc",(function(){return ct})),n.d(t,"rc",(function(){return lt})),n.d(t,"sc",(function(){return gt})),n.d(t,"pc",(function(){return dt})),n.d(t,"qc",(function(){return ht})),n.d(t,"nc",(function(){return ft})),n.d(t,"tc",(function(){return pt})),n.d(t,"vc",(function(){return It})),n.d(t,"wc",(function(){return Ct})),n.d(t,"xc",(function(){return mt})),n.d(t,"yc",(function(){return bt})),n.d(t,"zc",(function(){return vt})),n.d(t,"Ec",(function(){return At})),n.d(t,"Cc",(function(){return yt})),n.d(t,"Dc",(function(){return wt})),n.d(t,"Bc",(function(){return Gt})),n.d(t,"Ac",(function(){return Bt})),n.d(t,"Gc",(function(){return xt})),n.d(t,"Oc",(function(){return St})),n.d(t,"Xc",(function(){return kt})),n.d(t,"Hc",(function(){return Zt})),n.d(t,"Nc",(function(){return Rt})),n.d(t,"Fc",(function(){return Nt})),n.d(t,"Ic",(function(){return Ot})),n.d(t,"Jc",(function(){return Wt})),n.d(t,"Kc",(function(){return Ft})),n.d(t,"Lc",(function(){return Mt})),n.d(t,"Mc",(function(){return Vt})),n.d(t,"Qc",(function(){return Tt})),n.d(t,"Pc",(function(){return Et})),n.d(t,"Sc",(function(){return jt})),n.d(t,"Tc",(function(){return Lt})),n.d(t,"Uc",(function(){return Xt})),n.d(t,"Vc",(function(){return Ht})),n.d(t,"Wc",(function(){return Yt})),n.d(t,"Yc",(function(){return zt})),n.d(t,"Zc",(function(){return Kt})),n.d(t,"ad",(function(){return _t})),n.d(t,"bd",(function(){return Dt})),n.d(t,"cd",(function(){return Pt})),n.d(t,"dd",(function(){return Ut})),n.d(t,"ed",(function(){return Jt})),n.d(t,"fd",(function(){return Qt})),n.d(t,"gd",(function(){return qt})),n.d(t,"hd",(function(){return $t})),n.d(t,"Rc",(function(){return en})),n.d(t,"ib",(function(){return tn})),n.d(t,"uc",(function(){return nn})),n.d(t,"id",(function(){return rn})),n.d(t,"kb",(function(){return an})),n.d(t,"lb",(function(){return on}));var r="Abs",a="Acos",i="Acosh",o="Add",s="AddN",u="All",c="Any",l="ArgMax",g="ArgMin",d="Asin",h="Asinh",f="Atan",p="Atanh",I="Atan2",C="AvgPool",m="AvgPoolGrad",b="AvgPool3D",v="AvgPool3DGrad",A="BatchMatMul",y="BatchToSpaceND",w="Bincount",G="BroadcastTo",B="Cast",x="Ceil",S="ClipByValue",k="Complex",Z="ComplexAbs",R="Concat",N="Conv2D",O="Conv2DBackpropFilter",W="Conv2DBackpropInput",F="Conv3D",M="Conv3DBackpropFilterV2",V="Conv3DBackpropInputV2",T="Cos",E="Cosh",j="Cumsum",L="CropAndResize",X="DenseBincount",H="DepthToSpace",Y="DepthwiseConv2dNative",z="DepthwiseConv2dNativeBackpropFilter",K="DepthwiseConv2dNativeBackpropInput",_="Diag",D="Dilation2D",P="Dilation2DBackpropInput",U="Dilation2DBackpropFilter",J="RealDiv",Q="Einsum",q="Elu",$="EluGrad",ee="Erf",te="Equal",ne="Exp",re="ExpandDims",ae="Expm1",ie="FFT",oe="Fill",se="FlipLeftRight",ue="Floor",ce="FloorDiv",le="FusedBatchNorm",ge="GatherV2",de="GatherNd",he="Greater",fe="GreaterEqual",pe="Identity",Ie="IFFT",Ce="Imag",me="IsFinite",be="IsInf",ve="IsNan",Ae="LeakyRelu",ye="Less",we="LessEqual",Ge="LinSpace",Be="Log",xe="Log1p",Se="LogicalAnd",ke="LogicalNot",Ze="LogicalOr",Re="LogSoftmax",Ne="LRN",Oe="LRNGrad",We="Max",Fe="Maximum",Me="MaxPool",Ve="MaxPoolGrad",Te="MaxPool3D",Ee="MaxPool3DGrad",je="MaxPoolWithArgmax",Le="Mean",Xe="Min",He="Minimum",Ye="MirrorPad",ze="Mod",Ke="Multinomial",_e="Multiply",De="Neg",Pe="NotEqual",Ue="NonMaxSuppressionV3",Je="NonMaxSuppressionV4",Qe="NonMaxSuppressionV5",qe="OnesLike",$e="OneHot",et="Pack",tt="PadV2",nt="Pow",rt="Prelu",at="Prod",it="Range",ot="Real",st="Reciprocal",ut="Relu",ct="Reshape",lt="ResizeNearestNeighbor",gt="ResizeNearestNeighborGrad",dt="ResizeBilinear",ht="ResizeBilinearGrad",ft="Relu6",pt="Reverse",It="Round",Ct="Rsqrt",mt="ScatterNd",bt="Select",vt="Selu",At="Slice",yt="Sin",wt="Sinh",Gt="Sign",Bt="Sigmoid",xt="Softplus",St="Sqrt",kt="Sum",Zt="SpaceToBatchND",Rt="SplitV",Nt="Softmax",Ot="SparseFillEmptyRows",Wt="SparseReshape",Ft="SparseSegmentMean",Mt="SparseSegmentSum",Vt="SparseToDense",Tt="SquaredDifference",Et="Square",jt="StridedSlice",Lt="StringNGrams",Xt="StringSplit",Ht="StringToHashBucketFast",Yt="Sub",zt="Tan",Kt="Tanh",_t="Tile",Dt="TopK",Pt="Transform",Ut="Transpose",Jt="Unique",Qt="Unpack",qt="UnsortedSegmentSum",$t="ZerosLike",en="Step",tn="FromPixels",nn="RotateWithOffset",rn="_FusedMatMul",an="FusedConv2D",on="FusedDepthwiseConv2D"},function(e,t,n){e.exports=n(421)},function(e,t,n){"use strict";e.exports=n(416)},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(11),a=n(19),i="__op";function o(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var s=function(){r.a.startScope(n);try{var e=o.apply(void 0,arguments);return Object(a.x)(e)&&console.error("Cannot return a Promise inside of tidy."),r.a.endScope(e),e}catch(t){throw r.a.endScope(null),t}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return k}));var r=n(16),a=n(21),i=n(7),o=n.n(i),s=n(17),u=n(1),c=n(9),l=n(201),g=n(36),d=n(154),h=n(6),f=n(99),p=n(24),I=n(19),C=function(){function e(t,n){Object(u.a)(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new m)}return Object(c.a)(e,[{key:"profileKernel",value:function(e,t,n){var a,i,o=function(){a=n()},s=p.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();var u,c=Object(r.a)(a);try{for(c.s();!(u=c.n()).done;){u.value.dataSync()}}catch(h){c.e(h)}finally{c.f()}i=Promise.resolve({kernelMs:p.now()-s})}if(Object(g.b)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var l=function(t){var n=a[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},d=0;d<a.length;d++)l(d);return{kernelName:e,outputs:a,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var m=function(){function e(){Object(u.a)(this,e)}return Object(c.a)(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?I.L("".concat(r,"ms"),9):r.error,s=I.L(e,25),u=t.rank,c=t.size,l=I.L(t.shape.toString(),14),g="";for(var d in a){var h=a[d];if(null!=h){var f=h.shape||t.shape,p=f.length;g+="".concat(d,": ").concat(p,"D ").concat(p>0?f:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(g,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function b(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],g=!1,d=0;d<t.length;d++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),g=!0,a[s.id]=!0;break}if(g)break}}var h={};h[n.id]=!0;for(var f={},p=e.length-1;p>=0;p--)for(var I=e[p],C=I.inputs,m=0;m<I.outputs.length;m++)if(h[I.outputs[m].id]){for(var b in C)h[C[b].id]=!0,f[I.id]=!0;break}for(var v=[],A=0;A<e.length;A++){var y=e[A];if(a[y.id]&&f[y.id]){var w={};for(var G in y.inputs){var B=y.inputs[G];r[B.id]&&(w[G]=B)}var x=Object.assign({},y);x.inputs=w,x.outputs=y.outputs,v.push(x)}}return v}function v(e,t,n,r){for(var a=function(a){var i=t[a],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var s=i.gradient(o),u=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var a=n((function(){return s[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[t];if(!I.a(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{var u=e[o.id];e[o.id]=r(u,a),u.dispose()}};for(var c in i.inputs)u(c)},i=t.length-1;i>=0;i--)a(i)}var A=n(14),y=n(37);function w(e){return null!=e.kernelName}var G=function(){function e(){Object(u.a)(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return Object(c.a)(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),B=function(){function e(t){Object(u.a)(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new G}return Object(c.a)(e,[{key:"ready",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new C(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;Object(f.c)(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;Object(f.c)(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof l.b||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=k.runKernel(h.rb,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return k.runKernel(h.w,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(!(null!=Object(f.b)(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,u=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=w(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(w(e)){var l=e.kernelName,g=e.inputs,d=e.attrs;null==this.backendName&&this.backend;var h=Object(f.b)(l,this.backendName);I.b(null!=h,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=h.kernelFunc({inputs:g,attrs:d,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){if(null!=e.rank)return e;var t=e.dataId,n=e.shape,r=e.dtype;return a.makeTensorFromDataId(t,n,r)}));if(o){var s=a.getTensorsForGradient(l,g,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var p=e.forwardFunc,C=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return p(a.backend,C)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var m,b=e.inputs,v=e.attrs,A=w(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(m=a.profiler.profileKernel(c,b,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(m),t=m.outputs):t=n()})),o&&this.addTapeNode(c,b,t,A,i,v),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-u,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map((function(e){return null!=b[e]?b[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Object(f.a)(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(I.b(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&I.z(e[0])&&(a=e.map((function(e){return p.encodeString(e)})));var i=r.write(a,t,n),o=new A.a(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=Object(I.f)(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){n=n||"float32";var a=new A.a(t,n,e,this.nextTensorId());return this.trackTensor(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new A.c(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*I.g(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof A.c||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*I.g(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,i,s,u,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,i=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,Object(a.a)(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-i,s=Object(r.a)(this.state.activeProfile.kernels),e.prev=12,s.s();case 14:if((u=s.n()).done){e.next=24;break}return c=u.value,e.next=18,c.kernelTimeMs;case 18:return c.kernelTimeMs=e.sent,e.next=21,c.extraInfo;case 21:c.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),s.e(e.t0);case 29:return e.prev=29,s.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=Object(f.a)(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=I.F(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=Object(y.getTensorsInContainer)(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(I.b(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));I.b(o instanceof A.a,(function(){return"The result y returned by f() must be a tensor."}));var s=b(this.state.activeTape,t,o);if(!i&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[o.id]=null==n?x(o.shape):n,v(e,s,(function(e){return a.tidy(e)}),Z);var i=t.map((function(t){return e[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){var t,n=Object(r.a)(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:o,grads:i}}))}},{key:"customGrad",value:function(e){var t=this;return I.b(I.u(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;I.b(r.every((function(e){return e instanceof A.a})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));var s=function(t,n){return i=e.apply(void 0,[].concat(r,[n])),I.b(i.value instanceof A.a,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),I.b(I.u(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},u=function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];I.b(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),I.b(a.every((function(e){return e instanceof A.a})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o};return t.runKernelFunc({forwardFunc:s,backwardsFunc:u,inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(p.now)(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=Object(p.now)()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new G,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function x(e){var t=Object(I.D)(Object(I.O)(e),"float32");return k.makeTensor(t,e,"float32")}function S(){var e=Object(d.b)();if(null==e._tfengine){var t=new g.a(e);e._tfengine=new B(t)}return Object(g.c)(e._tfengine.ENV),Object(A.g)((function(){return e._tfengine})),e._tfengine}B.nextTensorId=0,B.nextVariableId=0;var k=S();function Z(e,t){var n={a:e,b:t};return k.runKernel(h.d,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(188);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(r.a)(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(22),a=n(265),i=n(158);function o(e){var t=Object(a.a)();return function(){var n,a=Object(r.a)(e);if(t){var o=Object(r.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(i.a)(this,n)}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"g",(function(){return y})),n.d(t,"f",(function(){return w})),n.d(t,"e",(function(){return G})),n.d(t,"a",(function(){return B})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return S}));var r=n(12),a=n(13),i=n(7),o=n.n(i),s=n(17),u=n(1),c=n(9),l=n(154),g=n(21),d=n(19);function h(e,t,n,r){var a=Object(d.j)(t),i=function(e,t,n,r){var a=Object(d.O)(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?C(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,g=0;g<i;g++)o[g]=Math.max(o[g],f(u[l+g],0,n).length);return o}(e,t,n,a),o=t.length,s=I(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}function f(e,t,n){var r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):Object(d.z)(e)?"'".concat(e,"'"):"bool"===n?p(e):parseFloat(e.toFixed(7)).toString(),Object(d.L)(r,t)}function p(e){return 0===e?"false":"true"}function I(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],u=t.length;if(0===u){if("complex64"===n){var c=C(e);return[f(c[0],0,n)]}return"bool"===n?[p(e[0])]:[e[0].toString()]}if(1===u){if(s>20){var l=3*o,d=Array.from(e.slice(0,l)),h=Array.from(e.slice((s-3)*o,s*o));return"complex64"===n&&(d=C(d),h=C(h)),["["+d.map((function(e,t){return f(e,a[t],n)})).join(", ")+", ..., "+h.map((function(e,t){return f(e,a[s-3+t],n)})).join(", ")+"]"]}var m="complex64"===n?C(e):Array.from(e);return["["+m.map((function(e,t){return f(e,a[t],n)})).join(", ")+"]"]}var b=t.slice(1),v=r.slice(1),A=r[0]*o,y=[];if(s>20){for(var w=0;w<3;w++){var G=w*A,B=G+A;y.push.apply(y,Object(g.a)(I(e.slice(G,B),b,n,v,a,!1)))}y.push("...");for(var x=s-3;x<s;x++){var S=x*A,k=S+A;y.push.apply(y,Object(g.a)(I(e.slice(S,k),b,n,v,a,x===s-1)))}}else for(var Z=0;Z<s;Z++){var R=Z*A,N=R+A;y.push.apply(y,Object(g.a)(I(e.slice(R,N),b,n,v,a,Z===s-1)))}var O=2===u?",":"";y[0]="["+y[0]+O;for(var W=1;W<y.length-1;W++)y[W]=" "+y[W]+O;for(var F=",\n",M=2;M<u;M++)F+="\n";return y[y.length-1]=" "+y[y.length-1]+"]"+(i?"":F),y}function C(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var m=n(24),b=function(){function e(t,n,r){var a=this;if(Object(u.a)(this,e),this.dtype=n,this.shape=t.slice(),this.size=d.O(t),null!=r){var i=r.length;d.b(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||d.n(n,this.size),this.strides=Object(d.j)(t)}return Object(c.a)(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),d.b(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var u=t[t.length-1],c=0;c<t.length-1;++c)u+=this.strides[c]*t[c];return this.values[u]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return v().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),v=null,A=null;function y(e){v=e}function w(e){A=e}function G(e){e}var B=function(){function e(t,n,r,a){Object(u.a)(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=d.O(t),this.strides=Object(d.j)(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object(c.a)(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",A.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return A.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Object(d.T)(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return Object(d.T)(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=v().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return m.decodeString(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var e=v().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return m.decodeString(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,v().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(v().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return A.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),A.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return h(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),A.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),v().makeVariable(this,e,t,n)}}]),e}();function x(){return Object(l.a)("Tensor",(function(){return B}))}Object.defineProperty(B,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),x();var S=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r,a,i){var o;return Object(u.a)(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return Object(c.a)(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!d.a(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));v().disposeTensor(this),this.dataId=e.dataId,v().incRef(this,null)}},{key:"dispose",value:function(){v().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(B);Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return e instanceof B&&null!=e.assign&&e.assign instanceof Function}})},function(e,t,n){"use strict";n.r(t),n.d(t,"ACESFilmicToneMapping",(function(){return Ce})),n.d(t,"AddEquation",(function(){return L})),n.d(t,"AddOperation",(function(){return de})),n.d(t,"AdditiveAnimationBlendMode",(function(){return un})),n.d(t,"AdditiveBlending",(function(){return V})),n.d(t,"AlphaFormat",(function(){return Qe})),n.d(t,"AlwaysDepth",(function(){return re})),n.d(t,"AlwaysStencilFunc",(function(){return jn})),n.d(t,"AmbientLight",(function(){return Eg})),n.d(t,"AmbientLightProbe",(function(){return sd})),n.d(t,"AnimationClip",(function(){return jl})),n.d(t,"AnimationLoader",(function(){return Dl})),n.d(t,"AnimationMixer",(function(){return Ld})),n.d(t,"AnimationObjectGroup",(function(){return Ed})),n.d(t,"AnimationUtils",(function(){return xl})),n.d(t,"ArcCurve",(function(){return tg})),n.d(t,"ArrayCamera",(function(){return eu})),n.d(t,"ArrowHelper",(function(){return Rh})),n.d(t,"Audio",(function(){return md})),n.d(t,"AudioAnalyser",(function(){return Gd})),n.d(t,"AudioContext",(function(){return ad})),n.d(t,"AudioListener",(function(){return Cd})),n.d(t,"AudioLoader",(function(){return id})),n.d(t,"AxesHelper",(function(){return Nh})),n.d(t,"AxisHelper",(function(){return Nf})),n.d(t,"BackSide",(function(){return R})),n.d(t,"BasicDepthPacking",(function(){return vn})),n.d(t,"BasicShadowMap",(function(){return B})),n.d(t,"BinaryTextureLoader",(function(){return Vf})),n.d(t,"Bone",(function(){return Eu})),n.d(t,"BooleanKeyframeTrack",(function(){return Ol})),n.d(t,"BoundingBoxHelper",(function(){return Of})),n.d(t,"Box2",(function(){return Jd})),n.d(t,"Box3",(function(){return Ir})),n.d(t,"Box3Helper",(function(){return Sh})),n.d(t,"BoxBufferGeometry",(function(){return Ri})),n.d(t,"BoxGeometry",(function(){return Ri})),n.d(t,"BoxHelper",(function(){return xh})),n.d(t,"BufferAttribute",(function(){return Ya})),n.d(t,"BufferGeometry",(function(){return li})),n.d(t,"BufferGeometryLoader",(function(){return _g})),n.d(t,"ByteType",(function(){return Le})),n.d(t,"Cache",(function(){return Xl})),n.d(t,"Camera",(function(){return Mi})),n.d(t,"CameraHelper",(function(){return Ah})),n.d(t,"CanvasRenderer",(function(){return Ef})),n.d(t,"CanvasTexture",(function(){return hc})),n.d(t,"CatmullRomCurve3",(function(){return sg})),n.d(t,"CineonToneMapping",(function(){return Ie})),n.d(t,"CircleBufferGeometry",(function(){return pc})),n.d(t,"CircleGeometry",(function(){return pc})),n.d(t,"ClampToEdgeWrapping",(function(){return Se})),n.d(t,"Clock",(function(){return gd})),n.d(t,"Color",(function(){return ja})),n.d(t,"ColorKeyframeTrack",(function(){return Wl})),n.d(t,"CompressedTexture",(function(){return dc})),n.d(t,"CompressedTextureLoader",(function(){return Pl})),n.d(t,"ConeBufferGeometry",(function(){return Cc})),n.d(t,"ConeGeometry",(function(){return Cc})),n.d(t,"CubeCamera",(function(){return Ei})),n.d(t,"CubeReflectionMapping",(function(){return ve})),n.d(t,"CubeRefractionMapping",(function(){return Ae})),n.d(t,"CubeTexture",(function(){return ji})),n.d(t,"CubeTextureLoader",(function(){return Jl})),n.d(t,"CubeUVReflectionMapping",(function(){return Ge})),n.d(t,"CubeUVRefractionMapping",(function(){return Be})),n.d(t,"CubicBezierCurve",(function(){return gg})),n.d(t,"CubicBezierCurve3",(function(){return dg})),n.d(t,"CubicInterpolant",(function(){return kl})),n.d(t,"CullFaceBack",(function(){return y})),n.d(t,"CullFaceFront",(function(){return w})),n.d(t,"CullFaceFrontBack",(function(){return G})),n.d(t,"CullFaceNone",(function(){return A})),n.d(t,"Curve",(function(){return $l})),n.d(t,"CurvePath",(function(){return bg})),n.d(t,"CustomBlending",(function(){return j})),n.d(t,"CustomToneMapping",(function(){return me})),n.d(t,"CylinderBufferGeometry",(function(){return Ic})),n.d(t,"CylinderGeometry",(function(){return Ic})),n.d(t,"Cylindrical",(function(){return Pd})),n.d(t,"DataTexture",(function(){return Xi})),n.d(t,"DataTexture2DArray",(function(){return go})),n.d(t,"DataTexture3D",(function(){return ho})),n.d(t,"DataTextureLoader",(function(){return Ql})),n.d(t,"DataUtils",(function(){return Fh})),n.d(t,"DecrementStencilOp",(function(){return kn})),n.d(t,"DecrementWrapStencilOp",(function(){return Rn})),n.d(t,"DefaultLoadingManager",(function(){return Yl})),n.d(t,"DepthFormat",(function(){return rt})),n.d(t,"DepthStencilFormat",(function(){return at})),n.d(t,"DepthTexture",(function(){return fc})),n.d(t,"DirectionalLight",(function(){return Tg})),n.d(t,"DirectionalLightHelper",(function(){return mh})),n.d(t,"DiscreteInterpolant",(function(){return Rl})),n.d(t,"DodecahedronBufferGeometry",(function(){return bc})),n.d(t,"DodecahedronGeometry",(function(){return bc})),n.d(t,"DoubleSide",(function(){return N})),n.d(t,"DstAlphaFactor",(function(){return Q})),n.d(t,"DstColorFactor",(function(){return $})),n.d(t,"DynamicBufferAttribute",(function(){return Af})),n.d(t,"DynamicCopyUsage",(function(){return Dn})),n.d(t,"DynamicDrawUsage",(function(){return Xn})),n.d(t,"DynamicReadUsage",(function(){return zn})),n.d(t,"EdgesGeometry",(function(){return Gc})),n.d(t,"EdgesHelper",(function(){return Wf})),n.d(t,"EllipseCurve",(function(){return eg})),n.d(t,"EqualDepth",(function(){return oe})),n.d(t,"EqualStencilFunc",(function(){return Fn})),n.d(t,"EquirectangularReflectionMapping",(function(){return ye})),n.d(t,"EquirectangularRefractionMapping",(function(){return we})),n.d(t,"Euler",(function(){return ea})),n.d(t,"EventDispatcher",(function(){return Qn})),n.d(t,"ExtrudeBufferGeometry",(function(){return $c})),n.d(t,"ExtrudeGeometry",(function(){return $c})),n.d(t,"FaceColors",(function(){return lf})),n.d(t,"FileLoader",(function(){return _l})),n.d(t,"FlatShading",(function(){return O})),n.d(t,"Float16BufferAttribute",(function(){return Qa})),n.d(t,"Float32Attribute",(function(){return Zf})),n.d(t,"Float32BufferAttribute",(function(){return qa})),n.d(t,"Float64Attribute",(function(){return Rf})),n.d(t,"Float64BufferAttribute",(function(){return $a})),n.d(t,"FloatType",(function(){return Ke})),n.d(t,"Fog",(function(){return uu})),n.d(t,"FogExp2",(function(){return su})),n.d(t,"Font",(function(){return $g})),n.d(t,"FontLoader",(function(){return rd})),n.d(t,"FrontSide",(function(){return Z})),n.d(t,"Frustum",(function(){return zi})),n.d(t,"GLBufferAttribute",(function(){return Yd})),n.d(t,"GLSL1",(function(){return Un})),n.d(t,"GLSL3",(function(){return Jn})),n.d(t,"GammaEncoding",(function(){return fn})),n.d(t,"GreaterDepth",(function(){return ue})),n.d(t,"GreaterEqualDepth",(function(){return se})),n.d(t,"GreaterEqualStencilFunc",(function(){return En})),n.d(t,"GreaterStencilFunc",(function(){return Vn})),n.d(t,"GridHelper",(function(){return hh})),n.d(t,"Group",(function(){return tu})),n.d(t,"HalfFloatType",(function(){return _e})),n.d(t,"HemisphereLight",(function(){return wg})),n.d(t,"HemisphereLightHelper",(function(){return dh})),n.d(t,"HemisphereLightProbe",(function(){return od})),n.d(t,"IcosahedronBufferGeometry",(function(){return tl})),n.d(t,"IcosahedronGeometry",(function(){return tl})),n.d(t,"ImageBitmapLoader",(function(){return Qg})),n.d(t,"ImageLoader",(function(){return Ul})),n.d(t,"ImageUtils",(function(){return ir})),n.d(t,"ImmediateRenderObject",(function(){return eh})),n.d(t,"IncrementStencilOp",(function(){return Sn})),n.d(t,"IncrementWrapStencilOp",(function(){return Zn})),n.d(t,"InstancedBufferAttribute",(function(){return Kg})),n.d(t,"InstancedBufferGeometry",(function(){return zg})),n.d(t,"InstancedInterleavedBuffer",(function(){return Hd})),n.d(t,"InstancedMesh",(function(){return _u})),n.d(t,"Int16Attribute",(function(){return Bf})),n.d(t,"Int16BufferAttribute",(function(){return Da})),n.d(t,"Int32Attribute",(function(){return Sf})),n.d(t,"Int32BufferAttribute",(function(){return Ua})),n.d(t,"Int8Attribute",(function(){return yf})),n.d(t,"Int8BufferAttribute",(function(){return za})),n.d(t,"IntType",(function(){return Ye})),n.d(t,"InterleavedBuffer",(function(){return lu})),n.d(t,"InterleavedBufferAttribute",(function(){return du})),n.d(t,"Interpolant",(function(){return Sl})),n.d(t,"InterpolateDiscrete",(function(){return en})),n.d(t,"InterpolateLinear",(function(){return tn})),n.d(t,"InterpolateSmooth",(function(){return nn})),n.d(t,"InvertStencilOp",(function(){return Nn})),n.d(t,"JSONLoader",(function(){return jf})),n.d(t,"KeepStencilOp",(function(){return Bn})),n.d(t,"KeyframeTrack",(function(){return Nl})),n.d(t,"LOD",(function(){return Nu})),n.d(t,"LatheBufferGeometry",(function(){return nl})),n.d(t,"LatheGeometry",(function(){return nl})),n.d(t,"Layers",(function(){return ta})),n.d(t,"LensFlare",(function(){return Xf})),n.d(t,"LessDepth",(function(){return ae})),n.d(t,"LessEqualDepth",(function(){return ie})),n.d(t,"LessEqualStencilFunc",(function(){return Mn})),n.d(t,"LessStencilFunc",(function(){return Wn})),n.d(t,"Light",(function(){return yg})),n.d(t,"LightProbe",(function(){return Xg})),n.d(t,"Line",(function(){return $u})),n.d(t,"Line3",(function(){return $d})),n.d(t,"LineBasicMaterial",(function(){return Du})),n.d(t,"LineCurve",(function(){return hg})),n.d(t,"LineCurve3",(function(){return fg})),n.d(t,"LineDashedMaterial",(function(){return Gl})),n.d(t,"LineLoop",(function(){return rc})),n.d(t,"LinePieces",(function(){return uf})),n.d(t,"LineSegments",(function(){return nc})),n.d(t,"LineStrip",(function(){return sf})),n.d(t,"LinearEncoding",(function(){return dn})),n.d(t,"LinearFilter",(function(){return Fe})),n.d(t,"LinearInterpolant",(function(){return Zl})),n.d(t,"LinearMipMapLinearFilter",(function(){return Ee})),n.d(t,"LinearMipMapNearestFilter",(function(){return Ve})),n.d(t,"LinearMipmapLinearFilter",(function(){return Te})),n.d(t,"LinearMipmapNearestFilter",(function(){return Me})),n.d(t,"LinearToneMapping",(function(){return fe})),n.d(t,"Loader",(function(){return zl})),n.d(t,"LoaderUtils",(function(){return Yg})),n.d(t,"LoadingManager",(function(){return Hl})),n.d(t,"LogLuvEncoding",(function(){return In})),n.d(t,"LoopOnce",(function(){return Qt})),n.d(t,"LoopPingPong",(function(){return $t})),n.d(t,"LoopRepeat",(function(){return qt})),n.d(t,"LuminanceAlphaFormat",(function(){return tt})),n.d(t,"LuminanceFormat",(function(){return et})),n.d(t,"MOUSE",(function(){return b})),n.d(t,"Material",(function(){return Oa})),n.d(t,"MaterialLoader",(function(){return Hg})),n.d(t,"Math",(function(){return tr})),n.d(t,"MathUtils",(function(){return tr})),n.d(t,"Matrix3",(function(){return ar})),n.d(t,"Matrix4",(function(){return zr})),n.d(t,"MaxEquation",(function(){return z})),n.d(t,"Mesh",(function(){return ki})),n.d(t,"MeshBasicMaterial",(function(){return La})),n.d(t,"MeshDepthMaterial",(function(){return Ps})),n.d(t,"MeshDistanceMaterial",(function(){return Us})),n.d(t,"MeshFaceMaterial",(function(){return df})),n.d(t,"MeshLambertMaterial",(function(){return yl})),n.d(t,"MeshMatcapMaterial",(function(){return wl})),n.d(t,"MeshNormalMaterial",(function(){return Al})),n.d(t,"MeshPhongMaterial",(function(){return bl})),n.d(t,"MeshPhysicalMaterial",(function(){return ml})),n.d(t,"MeshStandardMaterial",(function(){return Cl})),n.d(t,"MeshToonMaterial",(function(){return vl})),n.d(t,"MinEquation",(function(){return Y})),n.d(t,"MirroredRepeatWrapping",(function(){return ke})),n.d(t,"MixOperation",(function(){return ge})),n.d(t,"MultiMaterial",(function(){return hf})),n.d(t,"MultiplyBlending",(function(){return E})),n.d(t,"MultiplyOperation",(function(){return le})),n.d(t,"NearestFilter",(function(){return Ze})),n.d(t,"NearestMipMapLinearFilter",(function(){return We})),n.d(t,"NearestMipMapNearestFilter",(function(){return Ne})),n.d(t,"NearestMipmapLinearFilter",(function(){return Oe})),n.d(t,"NearestMipmapNearestFilter",(function(){return Re})),n.d(t,"NeverDepth",(function(){return ne})),n.d(t,"NeverStencilFunc",(function(){return On})),n.d(t,"NoBlending",(function(){return F})),n.d(t,"NoColors",(function(){return cf})),n.d(t,"NoToneMapping",(function(){return he})),n.d(t,"NormalAnimationBlendMode",(function(){return sn})),n.d(t,"NormalBlending",(function(){return M})),n.d(t,"NotEqualDepth",(function(){return ce})),n.d(t,"NotEqualStencilFunc",(function(){return Tn})),n.d(t,"NumberKeyframeTrack",(function(){return Fl})),n.d(t,"Object3D",(function(){return pa})),n.d(t,"ObjectLoader",(function(){return Dg})),n.d(t,"ObjectSpaceNormalMap",(function(){return wn})),n.d(t,"OctahedronBufferGeometry",(function(){return rl})),n.d(t,"OctahedronGeometry",(function(){return rl})),n.d(t,"OneFactor",(function(){return _})),n.d(t,"OneMinusDstAlphaFactor",(function(){return q})),n.d(t,"OneMinusDstColorFactor",(function(){return ee})),n.d(t,"OneMinusSrcAlphaFactor",(function(){return J})),n.d(t,"OneMinusSrcColorFactor",(function(){return P})),n.d(t,"OrthographicCamera",(function(){return Mg})),n.d(t,"PCFShadowMap",(function(){return x})),n.d(t,"PCFSoftShadowMap",(function(){return S})),n.d(t,"PMREMGenerator",(function(){return $h})),n.d(t,"ParametricBufferGeometry",(function(){return al})),n.d(t,"ParametricGeometry",(function(){return al})),n.d(t,"Particle",(function(){return pf})),n.d(t,"ParticleBasicMaterial",(function(){return mf})),n.d(t,"ParticleSystem",(function(){return If})),n.d(t,"ParticleSystemMaterial",(function(){return bf})),n.d(t,"Path",(function(){return vg})),n.d(t,"PerspectiveCamera",(function(){return Vi})),n.d(t,"Plane",(function(){return ba})),n.d(t,"PlaneBufferGeometry",(function(){return Di})),n.d(t,"PlaneGeometry",(function(){return Di})),n.d(t,"PlaneHelper",(function(){return kh})),n.d(t,"PointCloud",(function(){return ff})),n.d(t,"PointCloudMaterial",(function(){return Cf})),n.d(t,"PointLight",(function(){return Fg})),n.d(t,"PointLightHelper",(function(){return uh})),n.d(t,"Points",(function(){return cc})),n.d(t,"PointsMaterial",(function(){return ac})),n.d(t,"PolarGridHelper",(function(){return fh})),n.d(t,"PolyhedronBufferGeometry",(function(){return mc})),n.d(t,"PolyhedronGeometry",(function(){return mc})),n.d(t,"PositionalAudio",(function(){return wd})),n.d(t,"PropertyBinding",(function(){return Td})),n.d(t,"PropertyMixer",(function(){return Bd})),n.d(t,"QuadraticBezierCurve",(function(){return pg})),n.d(t,"QuadraticBezierCurve3",(function(){return Ig})),n.d(t,"Quaternion",(function(){return dr})),n.d(t,"QuaternionKeyframeTrack",(function(){return Vl})),n.d(t,"QuaternionLinearInterpolant",(function(){return Ml})),n.d(t,"REVISION",(function(){return m})),n.d(t,"RGBADepthPacking",(function(){return An})),n.d(t,"RGBAFormat",(function(){return $e})),n.d(t,"RGBAIntegerFormat",(function(){return lt})),n.d(t,"RGBA_ASTC_10x10_Format",(function(){return Wt})),n.d(t,"RGBA_ASTC_10x5_Format",(function(){return Rt})),n.d(t,"RGBA_ASTC_10x6_Format",(function(){return Nt})),n.d(t,"RGBA_ASTC_10x8_Format",(function(){return Ot})),n.d(t,"RGBA_ASTC_12x10_Format",(function(){return Ft})),n.d(t,"RGBA_ASTC_12x12_Format",(function(){return Mt})),n.d(t,"RGBA_ASTC_4x4_Format",(function(){return yt})),n.d(t,"RGBA_ASTC_5x4_Format",(function(){return wt})),n.d(t,"RGBA_ASTC_5x5_Format",(function(){return Gt})),n.d(t,"RGBA_ASTC_6x5_Format",(function(){return Bt})),n.d(t,"RGBA_ASTC_6x6_Format",(function(){return xt})),n.d(t,"RGBA_ASTC_8x5_Format",(function(){return St})),n.d(t,"RGBA_ASTC_8x6_Format",(function(){return kt})),n.d(t,"RGBA_ASTC_8x8_Format",(function(){return Zt})),n.d(t,"RGBA_BPTC_Format",(function(){return Vt})),n.d(t,"RGBA_ETC2_EAC_Format",(function(){return At})),n.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return mt})),n.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return Ct})),n.d(t,"RGBA_S3TC_DXT1_Format",(function(){return dt})),n.d(t,"RGBA_S3TC_DXT3_Format",(function(){return ht})),n.d(t,"RGBA_S3TC_DXT5_Format",(function(){return ft})),n.d(t,"RGBDEncoding",(function(){return bn})),n.d(t,"RGBEEncoding",(function(){return pn})),n.d(t,"RGBEFormat",(function(){return nt})),n.d(t,"RGBFormat",(function(){return qe})),n.d(t,"RGBIntegerFormat",(function(){return ct})),n.d(t,"RGBM16Encoding",(function(){return mn})),n.d(t,"RGBM7Encoding",(function(){return Cn})),n.d(t,"RGB_ETC1_Format",(function(){return bt})),n.d(t,"RGB_ETC2_Format",(function(){return vt})),n.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return It})),n.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return pt})),n.d(t,"RGB_S3TC_DXT1_Format",(function(){return gt})),n.d(t,"RGFormat",(function(){return st})),n.d(t,"RGIntegerFormat",(function(){return ut})),n.d(t,"RawShaderMaterial",(function(){return Il})),n.d(t,"Ray",(function(){return Yr})),n.d(t,"Raycaster",(function(){return zd})),n.d(t,"RectAreaLight",(function(){return jg})),n.d(t,"RedFormat",(function(){return it})),n.d(t,"RedIntegerFormat",(function(){return ot})),n.d(t,"ReinhardToneMapping",(function(){return pe})),n.d(t,"RepeatWrapping",(function(){return xe})),n.d(t,"ReplaceStencilOp",(function(){return xn})),n.d(t,"ReverseSubtractEquation",(function(){return H})),n.d(t,"RingBufferGeometry",(function(){return il})),n.d(t,"RingGeometry",(function(){return il})),n.d(t,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return Pt})),n.d(t,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Kt})),n.d(t,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return _t})),n.d(t,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return Dt})),n.d(t,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return Ut})),n.d(t,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Jt})),n.d(t,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Tt})),n.d(t,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Et})),n.d(t,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return jt})),n.d(t,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return Lt})),n.d(t,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return Xt})),n.d(t,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return Ht})),n.d(t,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Yt})),n.d(t,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return zt})),n.d(t,"Scene",(function(){return cu})),n.d(t,"SceneUtils",(function(){return Lf})),n.d(t,"ShaderChunk",(function(){return Pi})),n.d(t,"ShaderLib",(function(){return Ji})),n.d(t,"ShaderMaterial",(function(){return Fi})),n.d(t,"ShadowMaterial",(function(){return pl})),n.d(t,"Shape",(function(){return Ag})),n.d(t,"ShapeBufferGeometry",(function(){return ol})),n.d(t,"ShapeGeometry",(function(){return ol})),n.d(t,"ShapePath",(function(){return qg})),n.d(t,"ShapeUtils",(function(){return Jc})),n.d(t,"ShortType",(function(){return Xe})),n.d(t,"Skeleton",(function(){return Xu})),n.d(t,"SkeletonHelper",(function(){return oh})),n.d(t,"SkinnedMesh",(function(){return Tu})),n.d(t,"SmoothShading",(function(){return W})),n.d(t,"Sphere",(function(){return Mr})),n.d(t,"SphereBufferGeometry",(function(){return sl})),n.d(t,"SphereGeometry",(function(){return sl})),n.d(t,"Spherical",(function(){return Dd})),n.d(t,"SphericalHarmonics3",(function(){return Lg})),n.d(t,"SplineCurve",(function(){return Cg})),n.d(t,"SpotLight",(function(){return Zg})),n.d(t,"SpotLightHelper",(function(){return nh})),n.d(t,"Sprite",(function(){return Su})),n.d(t,"SpriteMaterial",(function(){return fu})),n.d(t,"SrcAlphaFactor",(function(){return U})),n.d(t,"SrcAlphaSaturateFactor",(function(){return te})),n.d(t,"SrcColorFactor",(function(){return D})),n.d(t,"StaticCopyUsage",(function(){return _n})),n.d(t,"StaticDrawUsage",(function(){return Ln})),n.d(t,"StaticReadUsage",(function(){return Yn})),n.d(t,"StereoCamera",(function(){return ld})),n.d(t,"StreamCopyUsage",(function(){return Pn})),n.d(t,"StreamDrawUsage",(function(){return Hn})),n.d(t,"StreamReadUsage",(function(){return Kn})),n.d(t,"StringKeyframeTrack",(function(){return Tl})),n.d(t,"SubtractEquation",(function(){return X})),n.d(t,"SubtractiveBlending",(function(){return T})),n.d(t,"TOUCH",(function(){return v})),n.d(t,"TangentSpaceNormalMap",(function(){return yn})),n.d(t,"TetrahedronBufferGeometry",(function(){return ul})),n.d(t,"TetrahedronGeometry",(function(){return ul})),n.d(t,"TextBufferGeometry",(function(){return cl})),n.d(t,"TextGeometry",(function(){return cl})),n.d(t,"Texture",(function(){return sr})),n.d(t,"TextureLoader",(function(){return ql})),n.d(t,"TorusBufferGeometry",(function(){return ll})),n.d(t,"TorusGeometry",(function(){return ll})),n.d(t,"TorusKnotBufferGeometry",(function(){return gl})),n.d(t,"TorusKnotGeometry",(function(){return gl})),n.d(t,"Triangle",(function(){return Ra})),n.d(t,"TriangleFanDrawMode",(function(){return gn})),n.d(t,"TriangleStripDrawMode",(function(){return ln})),n.d(t,"TrianglesDrawMode",(function(){return cn})),n.d(t,"TubeBufferGeometry",(function(){return dl})),n.d(t,"TubeGeometry",(function(){return dl})),n.d(t,"UVMapping",(function(){return be})),n.d(t,"Uint16Attribute",(function(){return xf})),n.d(t,"Uint16BufferAttribute",(function(){return Pa})),n.d(t,"Uint32Attribute",(function(){return kf})),n.d(t,"Uint32BufferAttribute",(function(){return Ja})),n.d(t,"Uint8Attribute",(function(){return wf})),n.d(t,"Uint8BufferAttribute",(function(){return Ka})),n.d(t,"Uint8ClampedAttribute",(function(){return Gf})),n.d(t,"Uint8ClampedBufferAttribute",(function(){return _a})),n.d(t,"Uniform",(function(){return Xd})),n.d(t,"UniformsLib",(function(){return Ui})),n.d(t,"UniformsUtils",(function(){return Wi})),n.d(t,"UnsignedByteType",(function(){return je})),n.d(t,"UnsignedInt248Type",(function(){return Je})),n.d(t,"UnsignedIntType",(function(){return ze})),n.d(t,"UnsignedShort4444Type",(function(){return De})),n.d(t,"UnsignedShort5551Type",(function(){return Pe})),n.d(t,"UnsignedShort565Type",(function(){return Ue})),n.d(t,"UnsignedShortType",(function(){return He})),n.d(t,"VSMShadowMap",(function(){return k})),n.d(t,"Vector2",(function(){return nr})),n.d(t,"Vector3",(function(){return hr})),n.d(t,"Vector4",(function(){return cr})),n.d(t,"VectorKeyframeTrack",(function(){return El})),n.d(t,"Vertex",(function(){return vf})),n.d(t,"VertexColors",(function(){return gf})),n.d(t,"VideoTexture",(function(){return gc})),n.d(t,"WebGL1Renderer",(function(){return ou})),n.d(t,"WebGLCubeRenderTarget",(function(){return Li})),n.d(t,"WebGLMultisampleRenderTarget",(function(){return gr})),n.d(t,"WebGLRenderTarget",(function(){return lr})),n.d(t,"WebGLRenderTargetCube",(function(){return Tf})),n.d(t,"WebGLRenderer",(function(){return iu})),n.d(t,"WebGLUtils",(function(){return $s})),n.d(t,"WireframeGeometry",(function(){return hl})),n.d(t,"WireframeHelper",(function(){return Ff})),n.d(t,"WrapAroundEnding",(function(){return on})),n.d(t,"XHRLoader",(function(){return Mf})),n.d(t,"ZeroCurvatureEnding",(function(){return rn})),n.d(t,"ZeroFactor",(function(){return K})),n.d(t,"ZeroSlopeEnding",(function(){return an})),n.d(t,"ZeroStencilOp",(function(){return Gn})),n.d(t,"sRGBEncoding",(function(){return hn}));var r,a=n(7),i=n.n(a),o=n(17),s=n(16),u=n(41),c=n(3),l=n(158),g=n(23),d=n(22),h=n(50),f=n(12),p=n(13),I=n(1),C=n(9),m="127",b={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},v={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},A=0,y=1,w=2,G=3,B=0,x=1,S=2,k=3,Z=0,R=1,N=2,O=1,W=2,F=0,M=1,V=2,T=3,E=4,j=5,L=100,X=101,H=102,Y=103,z=104,K=200,_=201,D=202,P=203,U=204,J=205,Q=206,q=207,$=208,ee=209,te=210,ne=0,re=1,ae=2,ie=3,oe=4,se=5,ue=6,ce=7,le=0,ge=1,de=2,he=0,fe=1,pe=2,Ie=3,Ce=4,me=5,be=300,ve=301,Ae=302,ye=303,we=304,Ge=306,Be=307,xe=1e3,Se=1001,ke=1002,Ze=1003,Re=1004,Ne=1004,Oe=1005,We=1005,Fe=1006,Me=1007,Ve=1007,Te=1008,Ee=1008,je=1009,Le=1010,Xe=1011,He=1012,Ye=1013,ze=1014,Ke=1015,_e=1016,De=1017,Pe=1018,Ue=1019,Je=1020,Qe=1021,qe=1022,$e=1023,et=1024,tt=1025,nt=$e,rt=1026,at=1027,it=1028,ot=1029,st=1030,ut=1031,ct=1032,lt=1033,gt=33776,dt=33777,ht=33778,ft=33779,pt=35840,It=35841,Ct=35842,mt=35843,bt=36196,vt=37492,At=37496,yt=37808,wt=37809,Gt=37810,Bt=37811,xt=37812,St=37813,kt=37814,Zt=37815,Rt=37816,Nt=37817,Ot=37818,Wt=37819,Ft=37820,Mt=37821,Vt=36492,Tt=37840,Et=37841,jt=37842,Lt=37843,Xt=37844,Ht=37845,Yt=37846,zt=37847,Kt=37848,_t=37849,Dt=37850,Pt=37851,Ut=37852,Jt=37853,Qt=2200,qt=2201,$t=2202,en=2300,tn=2301,nn=2302,rn=2400,an=2401,on=2402,sn=2500,un=2501,cn=0,ln=1,gn=2,dn=3e3,hn=3001,fn=3007,pn=3002,In=3003,Cn=3004,mn=3005,bn=3006,vn=3200,An=3201,yn=0,wn=1,Gn=0,Bn=7680,xn=7681,Sn=7682,kn=7683,Zn=34055,Rn=34056,Nn=5386,On=512,Wn=513,Fn=514,Mn=515,Vn=516,Tn=517,En=518,jn=519,Ln=35044,Xn=35048,Hn=35040,Yn=35045,zn=35049,Kn=35041,_n=35046,Dn=35050,Pn=35042,Un="100",Jn="300 es";function Qn(){}Object.assign(Qn.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,a=n.length;r<a;r++)n[r].call(this,e);e.target=null}}}});for(var qn=[],$n=0;$n<256;$n++)qn[$n]=($n<16?"0":"")+$n.toString(16);var er=1234567,tr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(qn[255&e]+qn[e>>8&255]+qn[e>>16&255]+qn[e>>24&255]+"-"+qn[255&t]+qn[t>>8&255]+"-"+qn[t>>16&15|64]+qn[t>>24&255]+"-"+qn[63&n|128]+qn[n>>8&255]+"-"+qn[n>>16&255]+qn[n>>24&255]+qn[255&r]+qn[r>>8&255]+qn[r>>16&255]+qn[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,a){return r+(e-t)*(a-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:function(e,t,n){return(1-n)*e+n*t},damp:function(e,t,n,r){return tr.lerp(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(tr.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(er=e%2147483647),((er=16807*er%2147483647)-1)/2147483646},degToRad:function(e){return e*tr.DEG2RAD},radToDeg:function(e){return e*tr.RAD2DEG},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,a){var i=Math.cos,o=Math.sin,s=i(n/2),u=o(n/2),c=i((t+r)/2),l=o((t+r)/2),g=i((t-r)/2),d=o((t-r)/2),h=i((r-t)/2),f=o((r-t)/2);switch(a){case"XYX":e.set(s*l,u*g,u*d,s*c);break;case"YZY":e.set(u*d,s*l,u*g,s*c);break;case"ZXZ":e.set(u*g,u*d,s*l,s*c);break;case"XZX":e.set(s*l,u*f,u*h,s*c);break;case"YXY":e.set(u*h,s*l,u*f,s*c);break;case"ZYZ":e.set(u*f,u*h,s*l,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}},nr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,e),this.x=t,this.y=n}return Object(C.a)(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=this.x-e.x,i=this.y-e.y;return this.x=a*n-i*r+e.x,this.y=a*r+i*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}]),e}();nr.prototype.isVector2=!0;var rr,ar=function(){function e(){Object(I.a)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return Object(C.a)(e,[{key:"set",value:function(e,t,n,r,a,i,o,s,u){var c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=a,c[5]=s,c[6]=n,c[7]=i,c[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,a=this.elements,i=n[0],o=n[3],s=n[6],u=n[1],c=n[4],l=n[7],g=n[2],d=n[5],h=n[8],f=r[0],p=r[3],I=r[6],C=r[1],m=r[4],b=r[7],v=r[2],A=r[5],y=r[8];return a[0]=i*f+o*C+s*v,a[3]=i*p+o*m+s*A,a[6]=i*I+o*b+s*y,a[1]=u*f+c*C+l*v,a[4]=u*p+c*m+l*A,a[7]=u*I+c*b+l*y,a[2]=g*f+d*C+h*v,a[5]=g*p+d*m+h*A,a[8]=g*I+d*b+h*y,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*i*c-t*o*u-n*a*c+n*o*s+r*a*u-r*i*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=c*i-o*u,g=o*s-c*a,d=u*a-i*s,h=t*l+n*g+r*d;if(0===h)return this.set(0,0,0,0,0,0,0,0,0);var f=1/h;return e[0]=l*f,e[1]=(r*u-c*n)*f,e[2]=(o*n-r*i)*f,e[3]=g*f,e[4]=(c*t-r*s)*f,e[5]=(r*a-o*t)*f,e[6]=d*f,e[7]=(n*s-u*t)*f,e[8]=(i*t-n*a)*f,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,a,i,o){var s=Math.cos(a),u=Math.sin(a);return this.set(n*s,n*u,-n*(s*i+u*o)+i+e,-r*u,r*s,-r*(-u*i+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,a=r[0],i=r[3],o=r[6],s=r[1],u=r[4],c=r[7];return r[0]=t*a+n*s,r[3]=t*i+n*u,r[6]=t*o+n*c,r[1]=-n*a+t*s,r[4]=-n*i+t*u,r[7]=-n*o+t*c,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();ar.prototype.isMatrix3=!0;var ir={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===rr&&(rr=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),rr.width=e.width,rr.height=e.height;var n=rr.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=rr}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}},or=0,sr=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Se,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Se,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Fe,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Te,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:$e,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:je,g=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:dn;return Object(I.a)(this,n),e=t.call(this),Object.defineProperty(Object(h.a)(e),"id",{value:or++}),e.uuid=tr.generateUUID(),e.name="",e.image=r,e.mipmaps=[],e.mapping=a,e.wrapS=i,e.wrapT=o,e.magFilter=s,e.minFilter=u,e.anisotropy=g,e.format=c,e.internalFormat=null,e.type=l,e.offset=new nr(0,0),e.repeat=new nr(1,1),e.center=new nr(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new ar,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=d,e.version=0,e.onUpdate=null,e}return Object(C.a)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=tr.generateUUID()),!t&&void 0===e.images[r.uuid]){var a;if(Array.isArray(r)){a=[];for(var i=0,o=r.length;i<o;i++)r[i].isDataTexture?a.push(ur(r[i].image)):a.push(ur(r[i]))}else a=ur(r);e.images[r.uuid]={uuid:r.uuid,url:a}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==be)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case xe:e.x=e.x-Math.floor(e.x);break;case Se:e.x=e.x<0?0:1;break;case ke:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case xe:e.y=e.y-Math.floor(e.y);break;case Se:e.y=e.y<0?0:1;break;case ke:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(Qn);function ur(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?ir.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}sr.DEFAULT_IMAGE=void 0,sr.DEFAULT_MAPPING=be,sr.prototype.isTexture=!0;var cr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(I.a)(this,e),this.x=t,this.y=n,this.z=r,this.w=a}return Object(C.a)(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,a=this.w,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r+i[12]*a,this.y=i[1]*t+i[5]*n+i[9]*r+i[13]*a,this.z=i[2]*t+i[6]*n+i[10]*r+i[14]*a,this.w=i[3]*t+i[7]*n+i[11]*r+i[15]*a,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,a,i=.01,o=.1,s=e.elements,u=s[0],c=s[4],l=s[8],g=s[1],d=s[5],h=s[9],f=s[2],p=s[6],I=s[10];if(Math.abs(c-g)<i&&Math.abs(l-f)<i&&Math.abs(h-p)<i){if(Math.abs(c+g)<o&&Math.abs(l+f)<o&&Math.abs(h+p)<o&&Math.abs(u+d+I-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var C=(u+1)/2,m=(d+1)/2,b=(I+1)/2,v=(c+g)/4,A=(l+f)/4,y=(h+p)/4;return C>m&&C>b?C<i?(n=0,r=.707106781,a=.707106781):(r=v/(n=Math.sqrt(C)),a=A/n):m>b?m<i?(n=.707106781,r=0,a=.707106781):(n=v/(r=Math.sqrt(m)),a=y/r):b<i?(n=.707106781,r=.707106781,a=0):(n=A/(a=Math.sqrt(b)),r=y/a),this.set(n,r,a,t),this}var w=Math.sqrt((p-h)*(p-h)+(l-f)*(l-f)+(g-c)*(g-c));return Math.abs(w)<.001&&(w=1),this.x=(p-h)/w,this.y=(l-f)/w,this.z=(g-c)/w,this.w=Math.acos((u+d+I-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}]),e}();cr.prototype.isVector4=!0;var lr=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;return Object(I.a)(this,n),(i=t.call(this)).width=e,i.height=r,i.depth=1,i.scissor=new cr(0,0,e,r),i.scissorTest=!1,i.viewport=new cr(0,0,e,r),a=a||{},i.texture=new sr(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),i.texture.image={},i.texture.image.width=e,i.texture.image.height=r,i.texture.image.depth=1,i.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,i.texture.minFilter=void 0!==a.minFilter?a.minFilter:Fe,i.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,i.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,i.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,i}return Object(C.a)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Qn);lr.prototype.isWebGLRenderTarget=!0;var gr=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;return Object(I.a)(this,n),(i=t.call(this,e,r,a)).samples=4,i}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this}}]),n}(lr);gr.prototype.isWebGLMultisampleRenderTarget=!0;var dr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(I.a)(this,e),this._x=t,this._y=n,this._z=r,this._w=a}return Object(C.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,a=e._z,i=e._order,o=Math.cos,s=Math.sin,u=o(n/2),c=o(r/2),l=o(a/2),g=s(n/2),d=s(r/2),h=s(a/2);switch(i){case"XYZ":this._x=g*c*l+u*d*h,this._y=u*d*l-g*c*h,this._z=u*c*h+g*d*l,this._w=u*c*l-g*d*h;break;case"YXZ":this._x=g*c*l+u*d*h,this._y=u*d*l-g*c*h,this._z=u*c*h-g*d*l,this._w=u*c*l+g*d*h;break;case"ZXY":this._x=g*c*l-u*d*h,this._y=u*d*l+g*c*h,this._z=u*c*h+g*d*l,this._w=u*c*l-g*d*h;break;case"ZYX":this._x=g*c*l-u*d*h,this._y=u*d*l+g*c*h,this._z=u*c*h-g*d*l,this._w=u*c*l+g*d*h;break;case"YZX":this._x=g*c*l+u*d*h,this._y=u*d*l+g*c*h,this._z=u*c*h-g*d*l,this._w=u*c*l-g*d*h;break;case"XZY":this._x=g*c*l-u*d*h,this._y=u*d*l-g*c*h,this._z=u*c*h+g*d*l,this._w=u*c*l+g*d*h;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],a=t[8],i=t[1],o=t[5],s=t[9],u=t[2],c=t[6],l=t[10],g=n+o+l;if(g>0){var d=.5/Math.sqrt(g+1);this._w=.25/d,this._x=(c-s)*d,this._y=(a-u)*d,this._z=(i-r)*d}else if(n>o&&n>l){var h=2*Math.sqrt(1+n-o-l);this._w=(c-s)/h,this._x=.25*h,this._y=(r+i)/h,this._z=(a+u)/h}else if(o>l){var f=2*Math.sqrt(1+o-n-l);this._w=(a-u)/f,this._x=(r+i)/f,this._y=.25*f,this._z=(s+c)/f}else{var p=2*Math.sqrt(1+l-n-o);this._w=(i-r)/p,this._x=(a+u)/p,this._y=(s+c)/p,this._z=.25*p}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(tr.clamp(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,a=e._z,i=e._w,o=t._x,s=t._y,u=t._z,c=t._w;return this._x=n*c+i*o+r*u-a*s,this._y=r*c+i*s+a*o-n*u,this._z=a*c+i*u+n*s-r*o,this._w=i*c-n*o-r*s-a*u,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,a=this._z,i=this._w,o=i*e._w+n*e._x+r*e._y+a*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=i,this._x=n,this._y=r,this._z=a,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;return this._w=u*i+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*a+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),l=Math.atan2(c,o),g=Math.sin((1-t)*l)/c,d=Math.sin(t*l)/c;return this._w=i*g+this._w*d,this._x=n*g+this._x*d,this._y=r*g+this._y*d,this._z=a*g+this._z*d,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,a,i,o){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],g=a[i+0],d=a[i+1],h=a[i+2],f=a[i+3];if(0===o)return e[t+0]=s,e[t+1]=u,e[t+2]=c,void(e[t+3]=l);if(1===o)return e[t+0]=g,e[t+1]=d,e[t+2]=h,void(e[t+3]=f);if(l!==f||s!==g||u!==d||c!==h){var p=1-o,I=s*g+u*d+c*h+l*f,C=I>=0?1:-1,m=1-I*I;if(m>Number.EPSILON){var b=Math.sqrt(m),v=Math.atan2(b,I*C);p=Math.sin(p*v)/b,o=Math.sin(o*v)/b}var A=o*C;if(s=s*p+g*A,u=u*p+d*A,c=c*p+h*A,l=l*p+f*A,p===1-o){var y=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=y,u*=y,c*=y,l*=y}}e[t]=s,e[t+1]=u,e[t+2]=c,e[t+3]=l}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,a,i){var o=n[r],s=n[r+1],u=n[r+2],c=n[r+3],l=a[i],g=a[i+1],d=a[i+2],h=a[i+3];return e[t]=o*h+c*l+s*d-u*g,e[t+1]=s*h+c*g+u*l-o*d,e[t+2]=u*h+c*d+o*g-s*l,e[t+3]=c*h-o*l-s*g-u*d,e}}]),e}();dr.prototype.isQuaternion=!0;var hr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(I.a)(this,e),this.x=t,this.y=n,this.z=r}return Object(C.a)(e,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(pr.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(pr.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*r,this.y=a[1]*t+a[4]*n+a[7]*r,this.z=a[2]*t+a[5]*n+a[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements,i=1/(a[3]*t+a[7]*n+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*r+a[12])*i,this.y=(a[1]*t+a[5]*n+a[9]*r+a[13])*i,this.z=(a[2]*t+a[6]*n+a[10]*r+a[14])*i,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.x,i=e.y,o=e.z,s=e.w,u=s*t+i*r-o*n,c=s*n+o*t-a*r,l=s*r+a*n-i*t,g=-a*t-i*n-o*r;return this.x=u*s+g*-a+c*-o-l*-i,this.y=c*s+g*-i+l*-a-u*-o,this.z=l*s+g*-o+u*-i-c*-a,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r,this.y=a[1]*t+a[5]*n+a[9]*r,this.z=a[2]*t+a[6]*n+a[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=t.x,o=t.y,s=t.z;return this.x=r*s-a*o,this.y=a*i-n*s,this.z=n*o-r*i,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return fr.copy(this).projectOnVector(e),this.sub(fr)}},{key:"reflect",value:function(e){return this.sub(fr.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(tr.clamp(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}]),e}();hr.prototype.isVector3=!0;var fr=new hr,pr=new dr,Ir=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr(-1/0,-1/0,-1/0);Object(I.a)(this,e),this.min=t,this.max=n}return Object(C.a)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,a=-1/0,i=-1/0,o=-1/0,s=0,u=e.length;s<u;s+=3){var c=e[s],l=e[s+1],g=e[s+2];c<t&&(t=c),l<n&&(n=l),g<r&&(r=g),c>a&&(a=c),l>i&&(i=l),g>o&&(o=g)}return this.min.set(t,n,r),this.max.set(a,i,o),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,a=-1/0,i=-1/0,o=-1/0,s=0,u=e.count;s<u;s++){var c=e.getX(s),l=e.getY(s),g=e.getZ(s);c<t&&(t=c),l<n&&(n=l),g<r&&(r=g),c>a&&(a=c),l>i&&(i=l),g>o&&(o=g)}return this.min.set(t,n,r),this.max.set(a,i,o),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=mr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new hr),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new hr),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),br.copy(t.boundingBox),br.applyMatrix4(e.matrixWorld),this.union(br));for(var n=e.children,r=0,a=n.length;r<a;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new hr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,mr),mr.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(xr),Sr.subVectors(this.max,xr),vr.subVectors(e.a,xr),Ar.subVectors(e.b,xr),yr.subVectors(e.c,xr),wr.subVectors(Ar,vr),Gr.subVectors(yr,Ar),Br.subVectors(vr,yr);var t=[0,-wr.z,wr.y,0,-Gr.z,Gr.y,0,-Br.z,Br.y,wr.z,0,-wr.x,Gr.z,0,-Gr.x,Br.z,0,-Br.x,-wr.y,wr.x,0,-Gr.y,Gr.x,0,-Br.y,Br.x,0];return!!Rr(t,vr,Ar,yr,Sr)&&(!!Rr(t=[1,0,0,0,1,0,0,0,1],vr,Ar,yr,Sr)&&(kr.crossVectors(wr,Gr),Rr(t=[kr.x,kr.y,kr.z],vr,Ar,yr,Sr)))}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new hr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return mr.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(mr).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(Cr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Cr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Cr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Cr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Cr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Cr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Cr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Cr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Cr)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Ir.prototype.isBox3=!0;var Cr=[new hr,new hr,new hr,new hr,new hr,new hr,new hr,new hr],mr=new hr,br=new Ir,vr=new hr,Ar=new hr,yr=new hr,wr=new hr,Gr=new hr,Br=new hr,xr=new hr,Sr=new hr,kr=new hr,Zr=new hr;function Rr(e,t,n,r,a){for(var i=0,o=e.length-3;i<=o;i+=3){Zr.fromArray(e,i);var s=a.x*Math.abs(Zr.x)+a.y*Math.abs(Zr.y)+a.z*Math.abs(Zr.z),u=t.dot(Zr),c=n.dot(Zr),l=r.dot(Zr);if(Math.max(-Math.max(u,c,l),Math.min(u,c,l))>s)return!1}return!0}var Nr=new Ir,Or=new hr,Wr=new hr,Fr=new hr,Mr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Object(I.a)(this,e),this.center=t,this.radius=n}return Object(C.a)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):Nr.setFromPoints(e).getCenter(n);for(var r=0,a=0,i=e.length;a<i;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new hr),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Ir),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){Fr.subVectors(e,this.center);var t=Fr.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Fr.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return Wr.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Or.copy(e.center).add(Wr)),this.expandByPoint(Or.copy(e.center).sub(Wr)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Vr=new hr,Tr=new hr,Er=new hr,jr=new hr,Lr=new hr,Xr=new hr,Hr=new hr,Yr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr(0,0,-1);Object(I.a)(this,e),this.origin=t,this.direction=n}return Object(C.a)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new hr),t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,Vr)),this}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new hr),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=Vr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Vr.copy(this.direction).multiplyScalar(t).add(this.origin),Vr.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){Tr.copy(e).add(t).multiplyScalar(.5),Er.copy(t).sub(e).normalize(),jr.copy(this.origin).sub(Tr);var a,i,o,s,u=.5*e.distanceTo(t),c=-this.direction.dot(Er),l=jr.dot(this.direction),g=-jr.dot(Er),d=jr.lengthSq(),h=Math.abs(1-c*c);if(h>0)if(i=c*l-g,s=u*h,(a=c*g-l)>=0)if(i>=-s)if(i<=s){var f=1/h;o=(a*=f)*(a+c*(i*=f)+2*l)+i*(c*a+i+2*g)+d}else i=u,o=-(a=Math.max(0,-(c*i+l)))*a+i*(i+2*g)+d;else i=-u,o=-(a=Math.max(0,-(c*i+l)))*a+i*(i+2*g)+d;else i<=-s?o=-(a=Math.max(0,-(-c*u+l)))*a+(i=a>0?-u:Math.min(Math.max(-u,-g),u))*(i+2*g)+d:i<=s?(a=0,o=(i=Math.min(Math.max(-u,-g),u))*(i+2*g)+d):o=-(a=Math.max(0,-(c*u+l)))*a+(i=a>0?u:Math.min(Math.max(-u,-g),u))*(i+2*g)+d;else i=c>0?-u:u,o=-(a=Math.max(0,-(c*i+l)))*a+i*(i+2*g)+d;return n&&n.copy(this.direction).multiplyScalar(a).add(this.origin),r&&r.copy(Er).multiplyScalar(i).add(Tr),o}},{key:"intersectSphere",value:function(e,t){Vr.subVectors(e.center,this.origin);var n=Vr.dot(this.direction),r=Vr.dot(Vr)-n*n,a=e.radius*e.radius;if(r>a)return null;var i=Math.sqrt(a-r),o=n-i,s=n+i;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,a,i,o,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,g=this.origin;return u>=0?(n=(e.min.x-g.x)*u,r=(e.max.x-g.x)*u):(n=(e.max.x-g.x)*u,r=(e.min.x-g.x)*u),c>=0?(a=(e.min.y-g.y)*c,i=(e.max.y-g.y)*c):(a=(e.max.y-g.y)*c,i=(e.min.y-g.y)*c),n>i||a>r?null:((a>n||n!==n)&&(n=a),(i<r||r!==r)&&(r=i),l>=0?(o=(e.min.z-g.z)*l,s=(e.max.z-g.z)*l):(o=(e.max.z-g.z)*l,s=(e.min.z-g.z)*l),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,Vr)}},{key:"intersectTriangle",value:function(e,t,n,r,a){Lr.subVectors(t,e),Xr.subVectors(n,e),Hr.crossVectors(Lr,Xr);var i,o=this.direction.dot(Hr);if(o>0){if(r)return null;i=1}else{if(!(o<0))return null;i=-1,o=-o}jr.subVectors(this.origin,e);var s=i*this.direction.dot(Xr.crossVectors(jr,Xr));if(s<0)return null;var u=i*this.direction.dot(Lr.cross(jr));if(u<0)return null;if(s+u>o)return null;var c=-i*jr.dot(Hr);return c<0?null:this.at(c/o,a)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),zr=function(){function e(){Object(I.a)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return Object(C.a)(e,[{key:"set",value:function(e,t,n,r,a,i,o,s,u,c,l,g,d,h,f,p){var I=this.elements;return I[0]=e,I[4]=t,I[8]=n,I[12]=r,I[1]=a,I[5]=i,I[9]=o,I[13]=s,I[2]=u,I[6]=c,I[10]=l,I[14]=g,I[3]=d,I[7]=h,I[11]=f,I[15]=p,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Kr.setFromMatrixColumn(e,0).length(),a=1/Kr.setFromMatrixColumn(e,1).length(),i=1/Kr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,a=e.z,i=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(a),l=Math.sin(a);if("XYZ"===e.order){var g=i*c,d=i*l,h=o*c,f=o*l;t[0]=s*c,t[4]=-s*l,t[8]=u,t[1]=d+h*u,t[5]=g-f*u,t[9]=-o*s,t[2]=f-g*u,t[6]=h+d*u,t[10]=i*s}else if("YXZ"===e.order){var p=s*c,I=s*l,C=u*c,m=u*l;t[0]=p+m*o,t[4]=C*o-I,t[8]=i*u,t[1]=i*l,t[5]=i*c,t[9]=-o,t[2]=I*o-C,t[6]=m+p*o,t[10]=i*s}else if("ZXY"===e.order){var b=s*c,v=s*l,A=u*c,y=u*l;t[0]=b-y*o,t[4]=-i*l,t[8]=A+v*o,t[1]=v+A*o,t[5]=i*c,t[9]=y-b*o,t[2]=-i*u,t[6]=o,t[10]=i*s}else if("ZYX"===e.order){var w=i*c,G=i*l,B=o*c,x=o*l;t[0]=s*c,t[4]=B*u-G,t[8]=w*u+x,t[1]=s*l,t[5]=x*u+w,t[9]=G*u-B,t[2]=-u,t[6]=o*s,t[10]=i*s}else if("YZX"===e.order){var S=i*s,k=i*u,Z=o*s,R=o*u;t[0]=s*c,t[4]=R-S*l,t[8]=Z*l+k,t[1]=l,t[5]=i*c,t[9]=-o*c,t[2]=-u*c,t[6]=k*l+Z,t[10]=S-R*l}else if("XZY"===e.order){var N=i*s,O=i*u,W=o*s,F=o*u;t[0]=s*c,t[4]=-l,t[8]=u*c,t[1]=N*l+F,t[5]=i*c,t[9]=O*l-W,t[2]=W*l-O,t[6]=o*c,t[10]=F*l+N}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Dr,e,Pr)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return Qr.subVectors(e,t),0===Qr.lengthSq()&&(Qr.z=1),Qr.normalize(),Ur.crossVectors(n,Qr),0===Ur.lengthSq()&&(1===Math.abs(n.z)?Qr.x+=1e-4:Qr.z+=1e-4,Qr.normalize(),Ur.crossVectors(n,Qr)),Ur.normalize(),Jr.crossVectors(Qr,Ur),r[0]=Ur.x,r[4]=Jr.x,r[8]=Qr.x,r[1]=Ur.y,r[5]=Jr.y,r[9]=Qr.y,r[2]=Ur.z,r[6]=Jr.z,r[10]=Qr.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,a=this.elements,i=n[0],o=n[4],s=n[8],u=n[12],c=n[1],l=n[5],g=n[9],d=n[13],h=n[2],f=n[6],p=n[10],I=n[14],C=n[3],m=n[7],b=n[11],v=n[15],A=r[0],y=r[4],w=r[8],G=r[12],B=r[1],x=r[5],S=r[9],k=r[13],Z=r[2],R=r[6],N=r[10],O=r[14],W=r[3],F=r[7],M=r[11],V=r[15];return a[0]=i*A+o*B+s*Z+u*W,a[4]=i*y+o*x+s*R+u*F,a[8]=i*w+o*S+s*N+u*M,a[12]=i*G+o*k+s*O+u*V,a[1]=c*A+l*B+g*Z+d*W,a[5]=c*y+l*x+g*R+d*F,a[9]=c*w+l*S+g*N+d*M,a[13]=c*G+l*k+g*O+d*V,a[2]=h*A+f*B+p*Z+I*W,a[6]=h*y+f*x+p*R+I*F,a[10]=h*w+f*S+p*N+I*M,a[14]=h*G+f*k+p*O+I*V,a[3]=C*A+m*B+b*Z+v*W,a[7]=C*y+m*x+b*R+v*F,a[11]=C*w+m*S+b*N+v*M,a[15]=C*G+m*k+b*O+v*V,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],a=e[12],i=e[1],o=e[5],s=e[9],u=e[13],c=e[2],l=e[6],g=e[10],d=e[14];return e[3]*(+a*s*l-r*u*l-a*o*g+n*u*g+r*o*d-n*s*d)+e[7]*(+t*s*d-t*u*g+a*i*g-r*i*d+r*u*c-a*s*c)+e[11]*(+t*u*l-t*o*d-a*i*l+n*i*d+a*o*c-n*u*c)+e[15]*(-r*o*c-t*s*l+t*o*g+r*i*l-n*i*g+n*s*c)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],u=e[7],c=e[8],l=e[9],g=e[10],d=e[11],h=e[12],f=e[13],p=e[14],I=e[15],C=l*p*u-f*g*u+f*s*d-o*p*d-l*s*I+o*g*I,m=h*g*u-c*p*u-h*s*d+i*p*d+c*s*I-i*g*I,b=c*f*u-h*l*u+h*o*d-i*f*d-c*o*I+i*l*I,v=h*l*s-c*f*s-h*o*g+i*f*g+c*o*p-i*l*p,A=t*C+n*m+r*b+a*v;if(0===A)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var y=1/A;return e[0]=C*y,e[1]=(f*g*a-l*p*a-f*r*d+n*p*d+l*r*I-n*g*I)*y,e[2]=(o*p*a-f*s*a+f*r*u-n*p*u-o*r*I+n*s*I)*y,e[3]=(l*s*a-o*g*a-l*r*u+n*g*u+o*r*d-n*s*d)*y,e[4]=m*y,e[5]=(c*p*a-h*g*a+h*r*d-t*p*d-c*r*I+t*g*I)*y,e[6]=(h*s*a-i*p*a-h*r*u+t*p*u+i*r*I-t*s*I)*y,e[7]=(i*g*a-c*s*a+c*r*u-t*g*u-i*r*d+t*s*d)*y,e[8]=b*y,e[9]=(h*l*a-c*f*a-h*n*d+t*f*d+c*n*I-t*l*I)*y,e[10]=(i*f*a-h*o*a+h*n*u-t*f*u-i*n*I+t*o*I)*y,e[11]=(c*o*a-i*l*a-c*n*u+t*l*u+i*n*d-t*o*d)*y,e[12]=v*y,e[13]=(c*f*r-h*l*r+h*n*g-t*f*g-c*n*p+t*l*p)*y,e[14]=(h*o*r-i*f*r-h*n*s+t*f*s+i*n*p-t*o*p)*y,e[15]=(i*l*r-c*o*r+c*n*s-t*l*s-i*n*g+t*o*g)*y,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,a=e.z;return t[0]*=n,t[4]*=r,t[8]*=a,t[1]*=n,t[5]*=r,t[9]*=a,t[2]*=n,t[6]*=r,t[10]*=a,t[3]*=n,t[7]*=r,t[11]*=a,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=1-n,i=e.x,o=e.y,s=e.z,u=a*i,c=a*o;return this.set(u*i+n,u*o-r*s,u*s+r*o,0,u*o+r*s,c*o+n,c*s-r*i,0,u*s-r*o,c*s+r*i,a*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,a=t._x,i=t._y,o=t._z,s=t._w,u=a+a,c=i+i,l=o+o,g=a*u,d=a*c,h=a*l,f=i*c,p=i*l,I=o*l,C=s*u,m=s*c,b=s*l,v=n.x,A=n.y,y=n.z;return r[0]=(1-(f+I))*v,r[1]=(d+b)*v,r[2]=(h-m)*v,r[3]=0,r[4]=(d-b)*A,r[5]=(1-(g+I))*A,r[6]=(p+C)*A,r[7]=0,r[8]=(h+m)*y,r[9]=(p-C)*y,r[10]=(1-(g+f))*y,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,a=Kr.set(r[0],r[1],r[2]).length(),i=Kr.set(r[4],r[5],r[6]).length(),o=Kr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],_r.copy(this);var s=1/a,u=1/i,c=1/o;return _r.elements[0]*=s,_r.elements[1]*=s,_r.elements[2]*=s,_r.elements[4]*=u,_r.elements[5]*=u,_r.elements[6]*=u,_r.elements[8]*=c,_r.elements[9]*=c,_r.elements[10]*=c,t.setFromRotationMatrix(_r),n.x=a,n.y=i,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,a,i){void 0===i&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*a/(t-e),u=2*a/(n-r),c=(t+e)/(t-e),l=(n+r)/(n-r),g=-(i+a)/(i-a),d=-2*i*a/(i-a);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=g,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,a,i){var o=this.elements,s=1/(t-e),u=1/(n-r),c=1/(i-a),l=(t+e)*s,g=(n+r)*u,d=(i+a)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-g,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();zr.prototype.isMatrix4=!0;var Kr=new hr,_r=new zr,Dr=new hr(0,0,0),Pr=new hr(1,1,1),Ur=new hr,Jr=new hr,Qr=new hr,qr=new zr,$r=new dr,ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;Object(I.a)(this,e),this._x=t,this._y=n,this._z=r,this._order=a}return Object(C.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e,t,n){var r=tr.clamp,a=e.elements,i=a[0],o=a[4],s=a[8],u=a[1],c=a[5],l=a[9],g=a[2],d=a[6],h=a[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,h),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-g,i),this._z=0);break;case"ZXY":this._x=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-g,h),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,i));break;case"ZYX":this._y=Math.asin(-r(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(u,i)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-g,i)):(this._x=0,this._y=Math.atan2(s,h));break;case"XZY":this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-l,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return qr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qr,t,n)}},{key:"setFromVector3",value:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)}},{key:"reorder",value:function(e){return $r.setFromEuler(this),this.setFromQuaternion($r,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new hr(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();ea.prototype.isEuler=!0,ea.DefaultOrder="XYZ",ea.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var ta=function(){function e(){Object(I.a)(this,e),this.mask=1}return Object(C.a)(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}}]),e}(),na=0,ra=new hr,aa=new dr,ia=new zr,oa=new hr,sa=new hr,ua=new hr,ca=new dr,la=new hr(1,0,0),ga=new hr(0,1,0),da=new hr(0,0,1),ha={type:"added"},fa={type:"removed"};function pa(){Object.defineProperty(this,"id",{value:na++}),this.uuid=tr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pa.DefaultUp.clone();var e=new hr,t=new ea,n=new dr,r=new hr(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new zr},normalMatrix:{value:new ar}}),this.matrix=new zr,this.matrixWorld=new zr,this.matrixAutoUpdate=pa.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ta,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}pa.DefaultUp=new hr(0,1,0),pa.DefaultMatrixAutoUpdate=!0,pa.prototype=Object.assign(Object.create(Qn.prototype),{constructor:pa,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return aa.setFromAxisAngle(e,t),this.quaternion.multiply(aa),this},rotateOnWorldAxis:function(e,t){return aa.setFromAxisAngle(e,t),this.quaternion.premultiply(aa),this},rotateX:function(e){return this.rotateOnAxis(la,e)},rotateY:function(e){return this.rotateOnAxis(ga,e)},rotateZ:function(e){return this.rotateOnAxis(da,e)},translateOnAxis:function(e,t){return ra.copy(e).applyQuaternion(this.quaternion),this.position.add(ra.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(la,e)},translateY:function(e){return this.translateOnAxis(ga,e)},translateZ:function(e){return this.translateOnAxis(da,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(ia.copy(this.matrixWorld).invert())},lookAt:function(e,t,n){e.isVector3?oa.copy(e):oa.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),sa.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ia.lookAt(sa,oa,this.up):ia.lookAt(oa,sa,this.up),this.quaternion.setFromRotationMatrix(ia),r&&(ia.extractRotation(r.matrixWorld),aa.setFromRotationMatrix(ia),this.quaternion.premultiply(aa.invert()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ha)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(fa)),this},clear:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(fa)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),ia.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ia.multiply(e.parent.matrixWorld)),e.applyMatrix4(ia),this.add(e),e.updateWorldMatrix(!1,!0),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var a=this.children[n].getObjectByProperty(e,t);if(void 0!==a)return a}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new hr),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new dr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sa,e,ua),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new hr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sa,ca,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new hr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,a=0,i=r.length;a<i;a++)r[a].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function a(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);var i=this.geometry.parameters;if(void 0!==i&&void 0!==i.shapes){var o=i.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var c=o[s];a(e.shapes,c)}else a(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var l=[],g=0,d=this.material.length;g<d;g++)l.push(a(e.materials,this.material[g]));r.material=l}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(var h=0;h<this.children.length;h++)r.children.push(this.children[h].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var f=0;f<this.animations.length;f++){var p=this.animations[f];r.animations.push(a(e.animations,p))}}if(t){var I=w(e.geometries),C=w(e.materials),m=w(e.textures),b=w(e.images),v=w(e.shapes),A=w(e.skeletons),y=w(e.animations);I.length>0&&(n.geometries=I),C.length>0&&(n.materials=C),m.length>0&&(n.textures=m),b.length>0&&(n.images=b),v.length>0&&(n.shapes=v),A.length>0&&(n.skeletons=A),y.length>0&&(n.animations=y)}return n.object=r,n;function w(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var Ia=new hr,Ca=new hr,ma=new ar,ba=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,e),this.normal=t,this.constant=n}return Object(C.a)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=Ia.subVectors(n,t).cross(Ca.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new hr),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new hr);var n=e.delta(Ia),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:t.copy(n).multiplyScalar(a).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new hr),e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||ma.getNormalMatrix(e),r=this.coplanarPoint(Ia).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(a),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();ba.prototype.isPlane=!0;var va=new hr,Aa=new hr,ya=new hr,wa=new hr,Ga=new hr,Ba=new hr,xa=new hr,Sa=new hr,ka=new hr,Za=new hr,Ra=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new hr;Object(I.a)(this,e),this.a=t,this.b=n,this.c=r}return Object(C.a)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return va.subVectors(this.c,this.b),Aa.subVectors(this.a,this.b),.5*va.cross(Aa).length()}},{key:"getMidpoint",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new hr),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new ba),e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,a,i){return e.getUV(t,this.a,this.b,this.c,n,r,a,i)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new hr);var n,r,a=this.a,i=this.b,o=this.c;Ga.subVectors(i,a),Ba.subVectors(o,a),Sa.subVectors(e,a);var s=Ga.dot(Sa),u=Ba.dot(Sa);if(s<=0&&u<=0)return t.copy(a);ka.subVectors(e,i);var c=Ga.dot(ka),l=Ba.dot(ka);if(c>=0&&l<=c)return t.copy(i);var g=s*l-c*u;if(g<=0&&s>=0&&c<=0)return n=s/(s-c),t.copy(a).addScaledVector(Ga,n);Za.subVectors(e,o);var d=Ga.dot(Za),h=Ba.dot(Za);if(h>=0&&d<=h)return t.copy(o);var f=d*u-s*h;if(f<=0&&u>=0&&h<=0)return r=u/(u-h),t.copy(a).addScaledVector(Ba,r);var p=c*h-d*l;if(p<=0&&l-c>=0&&d-h>=0)return xa.subVectors(o,i),r=(l-c)/(l-c+(d-h)),t.copy(i).addScaledVector(xa,r);var I=1/(p+f+g);return n=f*I,r=g*I,t.copy(a).addScaledVector(Ga,n).addScaledVector(Ba,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new hr),r.subVectors(n,t),va.subVectors(e,t),r.cross(va);var a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,a){va.subVectors(r,t),Aa.subVectors(n,t),ya.subVectors(e,t);var i=va.dot(va),o=va.dot(Aa),s=va.dot(ya),u=Aa.dot(Aa),c=Aa.dot(ya),l=i*u-o*o;if(void 0===a&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),a=new hr),0===l)return a.set(-2,-1,-1);var g=1/l,d=(u*s-o*c)*g,h=(i*c-o*s)*g;return a.set(1-d-h,h,d)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,wa),wa.x>=0&&wa.y>=0&&wa.x+wa.y<=1}},{key:"getUV",value:function(e,t,n,r,a,i,o,s){return this.getBarycoord(e,t,n,r,wa),s.set(0,0),s.addScaledVector(a,wa.x),s.addScaledVector(i,wa.y),s.addScaledVector(o,wa.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return va.subVectors(n,t),Aa.subVectors(e,t),va.cross(Aa).dot(r)<0}}]),e}(),Na=0;function Oa(){Object.defineProperty(this,"id",{value:Na++}),this.uuid=tr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=M,this.side=Z,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=U,this.blendDst=J,this.blendEquation=L,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ie,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=jn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Bn,this.stencilZFail=Bn,this.stencilZPass=Bn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Oa.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Oa,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===O;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==M&&(n.blending=this.blending),this.side!==Z&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var a=r(e.textures),i=r(e.images);a.length>0&&(n.textures=a),i.length>0&&(n.images=i)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var a=0;a!==r;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Oa.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var Wa={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Fa={h:0,s:0,l:0},Ma={h:0,s:0,l:0};function Va(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Ta(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ea(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var ja=function(){function e(t,n,r){return Object(I.a)(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return Object(C.a)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){if(e=tr.euclideanModulo(e,1),t=tr.clamp(t,0,1),n=tr.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,a=2*n-r;this.r=Va(a,r,e+1/3),this.g=Va(a,r,e),this.b=Va(a,r,e-1/3)}return this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,a=n[1],i=n[2];switch(a){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(o,s,u)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=Wa[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=Ta(e.r),this.g=Ta(e.g),this.b=Ta(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Ea(e.r),this.g=Ea(e.g),this.b=Ea(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,a=this.g,i=this.b,o=Math.max(r,a,i),s=Math.min(r,a,i),u=(s+o)/2;if(s===o)t=0,n=0;else{var c=o-s;switch(n=u<=.5?c/(o+s):c/(2-o-s),o){case r:t=(a-i)/c+(a<i?6:0);break;case a:t=(i-r)/c+2;break;case i:t=(r-a)/c+4}t/=6}return e.h=t,e.s=n,e.l=u,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Fa),Fa.h+=e,Fa.s+=t,Fa.l+=n,this.setHSL(Fa.h,Fa.s,Fa.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Fa),e.getHSL(Ma);var n=tr.lerp(Fa.h,Ma.h,t),r=tr.lerp(Fa.s,Ma.s,t),a=tr.lerp(Fa.l,Ma.l,t);return this.setHSL(n,r,a),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();ja.NAMES=Wa,ja.prototype.isColor=!0,ja.prototype.r=1,ja.prototype.g=1,ja.prototype.b=1;var La=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new ja(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=le,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}]),n}(Oa);La.prototype.isMeshBasicMaterial=!0;var Xa=new hr,Ha=new nr;function Ya(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Ln,this.updateRange={offset:0,count:-1},this.version=0}function za(e,t,n){Ya.call(this,new Int8Array(e),t,n)}function Ka(e,t,n){Ya.call(this,new Uint8Array(e),t,n)}function _a(e,t,n){Ya.call(this,new Uint8ClampedArray(e),t,n)}function Da(e,t,n){Ya.call(this,new Int16Array(e),t,n)}function Pa(e,t,n){Ya.call(this,new Uint16Array(e),t,n)}function Ua(e,t,n){Ya.call(this,new Int32Array(e),t,n)}function Ja(e,t,n){Ya.call(this,new Uint32Array(e),t,n)}function Qa(e,t,n){Ya.call(this,new Uint16Array(e),t,n)}function qa(e,t,n){Ya.call(this,new Float32Array(e),t,n)}function $a(e,t,n){Ya.call(this,new Float64Array(e),t,n)}function ei(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(Ya.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ya.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,a=this.itemSize;r<a;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new ja),t[n++]=i.r,t[n++]=i.g,t[n++]=i.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new nr),t[n++]=i.x,t[n++]=i.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new hr),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new cr),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n++]=i.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)Ha.fromBufferAttribute(this,t),Ha.applyMatrix3(e),this.setXY(t,Ha.x,Ha.y);else if(3===this.itemSize)for(var r=0,a=this.count;r<a;r++)Xa.fromBufferAttribute(this,r),Xa.applyMatrix3(e),this.setXYZ(r,Xa.x,Xa.y,Xa.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)Xa.x=this.getX(t),Xa.y=this.getY(t),Xa.z=this.getZ(t),Xa.applyMatrix4(e),this.setXYZ(t,Xa.x,Xa.y,Xa.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)Xa.x=this.getX(t),Xa.y=this.getY(t),Xa.z=this.getZ(t),Xa.applyNormalMatrix(e),this.setXYZ(t,Xa.x,Xa.y,Xa.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)Xa.x=this.getX(t),Xa.y=this.getY(t),Xa.z=this.getZ(t),Xa.transformDirection(e),this.setXYZ(t,Xa.x,Xa.y,Xa.z);return this},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,a){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=a,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Ln&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}),za.prototype=Object.create(Ya.prototype),za.prototype.constructor=za,Ka.prototype=Object.create(Ya.prototype),Ka.prototype.constructor=Ka,_a.prototype=Object.create(Ya.prototype),_a.prototype.constructor=_a,Da.prototype=Object.create(Ya.prototype),Da.prototype.constructor=Da,Pa.prototype=Object.create(Ya.prototype),Pa.prototype.constructor=Pa,Ua.prototype=Object.create(Ya.prototype),Ua.prototype.constructor=Ua,Ja.prototype=Object.create(Ya.prototype),Ja.prototype.constructor=Ja,Qa.prototype=Object.create(Ya.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isFloat16BufferAttribute=!0,qa.prototype=Object.create(Ya.prototype),qa.prototype.constructor=qa,$a.prototype=Object.create(Ya.prototype),$a.prototype.constructor=$a;var ti={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ni(e,t){return new ti[e](t)}var ri=0,ai=new zr,ii=new pa,oi=new hr,si=new Ir,ui=new Ir,ci=new hr;function li(){Object.defineProperty(this,"id",{value:ri++}),this.uuid=tr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}li.prototype=Object.assign(Object.create(Qn.prototype),{constructor:li,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(ei(e)>65535?Ja:Pa)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new ar).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var a=this.attributes.tangent;return void 0!==a&&(a.transformDirection(e),a.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return ai.makeRotationX(e),this.applyMatrix4(ai),this},rotateY:function(e){return ai.makeRotationY(e),this.applyMatrix4(ai),this},rotateZ:function(e){return ai.makeRotationZ(e),this.applyMatrix4(ai),this},translate:function(e,t,n){return ai.makeTranslation(e,t,n),this.applyMatrix4(ai),this},scale:function(e,t,n){return ai.makeScale(e,t,n),this.applyMatrix4(ai),this},lookAt:function(e){return ii.lookAt(e),ii.updateMatrix(),this.applyMatrix4(ii.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(oi).negate(),this.translate(oi.x,oi.y,oi.z),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new qa(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Ir);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new hr(-1/0,-1/0,-1/0),new hr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var a=t[n];si.setFromBufferAttribute(a),this.morphTargetsRelative?(ci.addVectors(this.boundingBox.min,si.min),this.boundingBox.expandByPoint(ci),ci.addVectors(this.boundingBox.max,si.max),this.boundingBox.expandByPoint(ci)):(this.boundingBox.expandByPoint(si.min),this.boundingBox.expandByPoint(si.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Mr);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new hr,1/0);if(e){var n=this.boundingSphere.center;if(si.setFromBufferAttribute(e),t)for(var r=0,a=t.length;r<a;r++){var i=t[r];ui.setFromBufferAttribute(i),this.morphTargetsRelative?(ci.addVectors(si.min,ui.min),si.expandByPoint(ci),ci.addVectors(si.max,ui.max),si.expandByPoint(ci)):(si.expandByPoint(ui.min),si.expandByPoint(ui.max))}si.getCenter(n);for(var o=0,s=0,u=e.count;s<u;s++)ci.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(ci));if(t)for(var c=0,l=t.length;c<l;c++)for(var g=t[c],d=this.morphTargetsRelative,h=0,f=g.count;h<f;h++)ci.fromBufferAttribute(g,h),d&&(oi.fromBufferAttribute(e,h),ci.add(oi)),o=Math.max(o,n.distanceToSquared(ci));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,a=t.normal.array,i=t.uv.array,o=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new Ya(new Float32Array(4*o),4));for(var s=t.tangent.array,u=[],c=[],l=0;l<o;l++)u[l]=new hr,c[l]=new hr;var g=new hr,d=new hr,h=new hr,f=new nr,p=new nr,I=new nr,C=new hr,m=new hr,b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(var v=0,A=b.length;v<A;++v)for(var y=b[v],w=y.start,G=w,B=w+y.count;G<B;G+=3)V(n[G+0],n[G+1],n[G+2]);for(var x=new hr,S=new hr,k=new hr,Z=new hr,R=0,N=b.length;R<N;++R)for(var O=b[R],W=O.start,F=W,M=W+O.count;F<M;F+=3)T(n[F+0]),T(n[F+1]),T(n[F+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function V(e,t,n){g.fromArray(r,3*e),d.fromArray(r,3*t),h.fromArray(r,3*n),f.fromArray(i,2*e),p.fromArray(i,2*t),I.fromArray(i,2*n),d.sub(g),h.sub(g),p.sub(f),I.sub(f);var a=1/(p.x*I.y-I.x*p.y);isFinite(a)&&(C.copy(d).multiplyScalar(I.y).addScaledVector(h,-p.y).multiplyScalar(a),m.copy(h).multiplyScalar(p.x).addScaledVector(d,-I.x).multiplyScalar(a),u[e].add(C),u[t].add(C),u[n].add(C),c[e].add(m),c[t].add(m),c[n].add(m))}function T(e){k.fromArray(a,3*e),Z.copy(k);var t=u[e];x.copy(t),x.sub(k.multiplyScalar(k.dot(t))).normalize(),S.crossVectors(Z,t);var n=S.dot(c[e])<0?-1:1;s[4*e]=x.x,s[4*e+1]=x.y,s[4*e+2]=x.z,s[4*e+3]=n}},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Ya(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,a=n.count;r<a;r++)n.setXYZ(r,0,0,0);var i=new hr,o=new hr,s=new hr,u=new hr,c=new hr,l=new hr,g=new hr,d=new hr;if(e)for(var h=0,f=e.count;h<f;h+=3){var p=e.getX(h+0),I=e.getX(h+1),C=e.getX(h+2);i.fromBufferAttribute(t,p),o.fromBufferAttribute(t,I),s.fromBufferAttribute(t,C),g.subVectors(s,o),d.subVectors(i,o),g.cross(d),u.fromBufferAttribute(n,p),c.fromBufferAttribute(n,I),l.fromBufferAttribute(n,C),u.add(g),c.add(g),l.add(g),n.setXYZ(p,u.x,u.y,u.z),n.setXYZ(I,c.x,c.y,c.z),n.setXYZ(C,l.x,l.y,l.z)}else for(var m=0,b=t.count;m<b;m+=3)i.fromBufferAttribute(t,m+0),o.fromBufferAttribute(t,m+1),s.fromBufferAttribute(t,m+2),g.subVectors(s,o),d.subVectors(i,o),g.cross(d),n.setXYZ(m+0,g.x,g.y,g.z),n.setXYZ(m+1,g.x,g.y,g.z),n.setXYZ(m+2,g.x,g.y,g.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var a=n[r].array,i=e.attributes[r],o=i.array,s=i.itemSize*t,u=Math.min(o.length,a.length-s),c=0,l=s;c<u;c++,l++)a[l]=o[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)ci.fromBufferAttribute(e,t),ci.normalize(),e.setXYZ(t,ci.x,ci.y,ci.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,a=e.normalized,i=new n.constructor(t.length*r),o=0,s=0,u=0,c=t.length;u<c;u++){o=t[u]*r;for(var l=0;l<r;l++)i[s++]=n[o++]}return new Ya(i,r,a)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new li,n=this.index.array,r=this.attributes;for(var a in r){var i=e(r[a],n);t.setAttribute(a,i)}var o=this.morphAttributes;for(var s in o){for(var u=[],c=o[s],l=0,g=c.length;l<g;l++){var d=e(c[l],n);u.push(d)}t.morphAttributes[s]=u}t.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,f=0,p=h.length;f<p;f++){var I=h[f];t.addGroup(I.start,I.count,I.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var a=this.attributes;for(var i in a){var o=a[i];e.data.attributes[i]=o.toJSON(e.data)}var s={},u=!1;for(var c in this.morphAttributes){for(var l=this.morphAttributes[c],g=[],d=0,h=l.length;d<h;d++){var f=l[d];g.push(f.toJSON(e.data))}g.length>0&&(s[c]=g,u=!0)}u&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var p=this.groups;p.length>0&&(e.data.groups=JSON.parse(JSON.stringify(p)));var I=this.boundingSphere;return null!==I&&(e.data.boundingSphere={center:I.center.toArray(),radius:I.radius}),e},clone:function(){return(new li).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var a in r){var i=r[a];this.setAttribute(a,i.clone(t))}var o=e.morphAttributes;for(var s in o){for(var u=[],c=o[s],l=0,g=c.length;l<g;l++)u.push(c[l].clone(t));this.morphAttributes[s]=u}this.morphTargetsRelative=e.morphTargetsRelative;for(var d=e.groups,h=0,f=d.length;h<f;h++){var p=d[h];this.addGroup(p.start,p.count,p.materialIndex)}var I=e.boundingBox;null!==I&&(this.boundingBox=I.clone());var C=e.boundingSphere;return null!==C&&(this.boundingSphere=C.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var gi=new zr,di=new Yr,hi=new Mr,fi=new hr,pi=new hr,Ii=new hr,Ci=new hr,mi=new hr,bi=new hr,vi=new hr,Ai=new hr,yi=new hr,wi=new nr,Gi=new nr,Bi=new nr,xi=new hr,Si=new hr;function ki(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new li,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new La;pa.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function Zi(e,t,n,r,a,i,o,s,u,c,l,g){fi.fromBufferAttribute(a,c),pi.fromBufferAttribute(a,l),Ii.fromBufferAttribute(a,g);var d=e.morphTargetInfluences;if(t.morphTargets&&i&&d){vi.set(0,0,0),Ai.set(0,0,0),yi.set(0,0,0);for(var h=0,f=i.length;h<f;h++){var p=d[h],I=i[h];0!==p&&(Ci.fromBufferAttribute(I,c),mi.fromBufferAttribute(I,l),bi.fromBufferAttribute(I,g),o?(vi.addScaledVector(Ci,p),Ai.addScaledVector(mi,p),yi.addScaledVector(bi,p)):(vi.addScaledVector(Ci.sub(fi),p),Ai.addScaledVector(mi.sub(pi),p),yi.addScaledVector(bi.sub(Ii),p)))}fi.add(vi),pi.add(Ai),Ii.add(yi)}e.isSkinnedMesh&&t.skinning&&(e.boneTransform(c,fi),e.boneTransform(l,pi),e.boneTransform(g,Ii));var C=function(e,t,n,r,a,i,o,s){if(null===(t.side===R?r.intersectTriangle(o,i,a,!0,s):r.intersectTriangle(a,i,o,t.side!==N,s)))return null;Si.copy(s),Si.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(Si);return u<n.near||u>n.far?null:{distance:u,point:Si.clone(),object:e}}(e,t,n,r,fi,pi,Ii,xi);if(C){s&&(wi.fromBufferAttribute(s,c),Gi.fromBufferAttribute(s,l),Bi.fromBufferAttribute(s,g),C.uv=Ra.getUV(xi,fi,pi,Ii,wi,Gi,Bi,new nr)),u&&(wi.fromBufferAttribute(u,c),Gi.fromBufferAttribute(u,l),Bi.fromBufferAttribute(u,g),C.uv2=Ra.getUV(xi,fi,pi,Ii,wi,Gi,Bi,new nr));var m={a:c,b:l,c:g,normal:new hr,materialIndex:0};Ra.getNormal(fi,pi,Ii,m.normal),C.face=m}return C}ki.prototype=Object.assign(Object.create(pa.prototype),{constructor:ki,isMesh:!0,copy:function(e){return pa.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,a=this.material,i=this.matrixWorld;if(void 0!==a&&(null===r.boundingSphere&&r.computeBoundingSphere(),hi.copy(r.boundingSphere),hi.applyMatrix4(i),!1!==e.ray.intersectsSphere(hi)&&(gi.copy(i).invert(),di.copy(e.ray).applyMatrix4(gi),null===r.boundingBox||!1!==di.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,u=r.morphAttributes.position,c=r.morphTargetsRelative,l=r.attributes.uv,g=r.attributes.uv2,d=r.groups,h=r.drawRange;if(null!==o)if(Array.isArray(a))for(var f=0,p=d.length;f<p;f++)for(var I=d[f],C=a[I.materialIndex],m=Math.max(I.start,h.start),b=Math.min(I.start+I.count,h.start+h.count);m<b;m+=3){var v=o.getX(m),A=o.getX(m+1),y=o.getX(m+2);(n=Zi(this,C,e,di,s,u,c,l,g,v,A,y))&&(n.faceIndex=Math.floor(m/3),n.face.materialIndex=I.materialIndex,t.push(n))}else for(var w=Math.max(0,h.start),G=Math.min(o.count,h.start+h.count);w<G;w+=3){var B=o.getX(w),x=o.getX(w+1),S=o.getX(w+2);(n=Zi(this,a,e,di,s,u,c,l,g,B,x,S))&&(n.faceIndex=Math.floor(w/3),t.push(n))}else if(void 0!==s)if(Array.isArray(a))for(var k=0,Z=d.length;k<Z;k++)for(var R=d[k],N=a[R.materialIndex],O=Math.max(R.start,h.start),W=Math.min(R.start+R.count,h.start+h.count);O<W;O+=3){(n=Zi(this,N,e,di,s,u,c,l,g,O,O+1,O+2))&&(n.faceIndex=Math.floor(O/3),n.face.materialIndex=R.materialIndex,t.push(n))}else for(var F=Math.max(0,h.start),M=Math.min(s.count,h.start+h.count);F<M;F+=3){(n=Zi(this,a,e,di,s,u,c,l,g,F,F+1,F+2))&&(n.faceIndex=Math.floor(F/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});var Ri=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(I.a)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:a,depth:i,widthSegments:o,heightSegments:s,depthSegments:u};var c=Object(h.a)(e);o=Math.floor(o),s=Math.floor(s),u=Math.floor(u);var l=[],g=[],d=[],f=[],p=0,C=0;function m(e,t,n,r,a,i,o,s,u,h,I){for(var m=i/u,b=o/h,v=i/2,A=o/2,y=s/2,w=u+1,G=h+1,B=0,x=0,S=new hr,k=0;k<G;k++)for(var Z=k*b-A,R=0;R<w;R++){var N=R*m-v;S[e]=N*r,S[t]=Z*a,S[n]=y,g.push(S.x,S.y,S.z),S[e]=0,S[t]=0,S[n]=s>0?1:-1,d.push(S.x,S.y,S.z),f.push(R/u),f.push(1-k/h),B+=1}for(var O=0;O<h;O++)for(var W=0;W<u;W++){var F=p+W+w*O,M=p+W+w*(O+1),V=p+(W+1)+w*(O+1),T=p+(W+1)+w*O;l.push(F,M,T),l.push(M,V,T),x+=6}c.addGroup(C,x,I),C+=x,p+=B}return m("z","y","x",-1,-1,i,a,r,u,s,0),m("z","y","x",1,-1,i,a,-r,u,s,1),m("x","z","y",1,1,r,i,a,o,u,2),m("x","z","y",1,-1,r,i,-a,o,u,3),m("x","y","z",1,-1,r,a,i,o,s,4),m("x","y","z",-1,-1,r,a,-i,o,s,5),e.setIndex(l),e.setAttribute("position",new qa(g,3)),e.setAttribute("normal",new qa(d,3)),e.setAttribute("uv",new qa(f,2)),e}return n}(li);function Ni(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var a=e[n][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?t[n][r]=a.clone():Array.isArray(a)?t[n][r]=a.slice():t[n][r]=a}return t}function Oi(e){for(var t={},n=0;n<e.length;n++){var r=Ni(e[n]);for(var a in r)t[a]=r[a]}return t}var Wi={clone:Ni,merge:Oi};function Fi(e){Oa.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Mi(){pa.call(this),this.type="Camera",this.matrixWorldInverse=new zr,this.projectionMatrix=new zr,this.projectionMatrixInverse=new zr}function Vi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;Mi.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Fi.prototype=Object.create(Oa.prototype),Fi.prototype.constructor=Fi,Fi.prototype.isShaderMaterial=!0,Fi.prototype.copy=function(e){return Oa.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ni(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},Fi.prototype.toJSON=function(e){var t=Oa.prototype.toJSON.call(this,e);for(var n in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var a={};for(var i in this.extensions)!0===this.extensions[i]&&(a[i]=!0);return Object.keys(a).length>0&&(t.extensions=a),t},Mi.prototype=Object.assign(Object.create(pa.prototype),{constructor:Mi,isCamera:!0,copy:function(e,t){return pa.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new hr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){pa.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){pa.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Vi.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Vi,isPerspectiveCamera:!0,copy:function(e,t){return Mi.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*tr.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*tr.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*tr.RAD2DEG*Math.atan(Math.tan(.5*tr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,a,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*tr.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,a=-.5*r,i=this.view;if(null!==this.view&&this.view.enabled){var o=i.fullWidth,s=i.fullHeight;a+=i.offsetX*r/o,t-=i.offsetY*n/s,r*=i.width/o,n*=i.height/s}var u=this.filmOffset;0!==u&&(a+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){var t=pa.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Ti=90,Ei=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;if(Object(I.a)(this,n),(i=t.call(this)).type="CubeCamera",!0!==a.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),Object(l.a)(i);i.renderTarget=a;var o=new Vi(Ti,1,e,r);o.layers=i.layers,o.up.set(0,-1,0),o.lookAt(new hr(1,0,0)),i.add(o);var s=new Vi(Ti,1,e,r);s.layers=i.layers,s.up.set(0,-1,0),s.lookAt(new hr(-1,0,0)),i.add(s);var u=new Vi(Ti,1,e,r);u.layers=i.layers,u.up.set(0,0,1),u.lookAt(new hr(0,1,0)),i.add(u);var c=new Vi(Ti,1,e,r);c.layers=i.layers,c.up.set(0,0,-1),c.lookAt(new hr(0,-1,0)),i.add(c);var g=new Vi(Ti,1,e,r);g.layers=i.layers,g.up.set(0,-1,0),g.lookAt(new hr(0,0,1)),i.add(g);var d=new Vi(Ti,1,e,r);return d.layers=i.layers,d.up.set(0,-1,0),d.lookAt(new hr(0,0,-1)),i.add(d),i}return Object(C.a)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=Object(c.a)(this.children,6),a=r[0],i=r[1],o=r[2],s=r[3],u=r[4],l=r[5],g=e.xr.enabled,d=e.getRenderTarget();e.xr.enabled=!1;var h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,a),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,u),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(d),e.xr.enabled=g}}]),n}(pa),ji=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s,u,c,l,g){var d;return Object(I.a)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:ve,u=void 0!==u?u:qe,(d=t.call(this,e,r,a,i,o,s,u,c,l,g))._needsFlipEnvMap=!0,d.flipY=!1,d}return Object(C.a)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(sr);ji.prototype.isCubeTexture=!0;var Li=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;return Object(I.a)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=a),i=t.call(this,e,e,r),r=r||{},i.texture=new ji(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:Fe,i.texture._needsFlipEnvMap=!1,i}return Object(C.a)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=$e,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",a="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",i=new Ri(5,5,5),o=new Fi({name:"CubemapFromEquirect",uniforms:Ni(n),vertexShader:r,fragmentShader:a,side:R,blending:F});o.uniforms.tEquirect.value=t;var s=new ki(i,o),u=t.minFilter;return t.minFilter===Te&&(t.minFilter=Fe),new Ei(1,10,this).update(e,s),t.minFilter=u,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var a=e.getRenderTarget(),i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(a)}}]),n}(lr);Li.prototype.isWebGLCubeRenderTarget=!0;var Xi=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s,u,c,l,g,d,h){var f;return Object(I.a)(this,n),(f=t.call(this,null,s,u,c,l,g,i,o,d,h)).image={data:e||null,width:r||1,height:a||1},f.magFilter=void 0!==l?l:Ze,f.minFilter=void 0!==g?g:Ze,f.generateMipmaps=!1,f.flipY=!1,f.unpackAlignment=1,f.needsUpdate=!0,f}return n}(sr);Xi.prototype.isDataTexture=!0;var Hi=new Mr,Yi=new hr,zi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ba,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ba,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ba,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ba,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ba,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new ba;Object(I.a)(this,e),this.planes=[t,n,r,a,i,o]}return Object(C.a)(e,[{key:"set",value:function(e,t,n,r,a,i){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(a),o[5].copy(i),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],l=n[7],g=n[8],d=n[9],h=n[10],f=n[11],p=n[12],I=n[13],C=n[14],m=n[15];return t[0].setComponents(o-r,l-s,f-g,m-p).normalize(),t[1].setComponents(o+r,l+s,f+g,m+p).normalize(),t[2].setComponents(o+a,l+u,f+d,m+I).normalize(),t[3].setComponents(o-a,l-u,f-d,m-I).normalize(),t[4].setComponents(o-i,l-c,f-h,m-C).normalize(),t[5].setComponents(o+i,l+c,f+h,m+C).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Hi.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Hi)}},{key:"intersectsSprite",value:function(e){return Hi.center.set(0,0,0),Hi.radius=.7071067811865476,Hi.applyMatrix4(e.matrixWorld),this.intersectsSphere(Hi)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,a=0;a<6;a++){if(t[a].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Yi.x=r.normal.x>0?e.max.x:e.min.x,Yi.y=r.normal.y>0?e.max.y:e.min.y,Yi.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Yi)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function Ki(){var e=null,t=!1,n=null,r=null;function a(t,i){n(t,i),r=e.requestAnimationFrame(a)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(a),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function _i(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,a){if(t.isGLBufferAttribute){var i=r.get(t);(!i||i.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var a=t.array,i=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,a,i),t.onUploadCallback();var s=5126;return a instanceof Float32Array?s=5126:a instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):a instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:a instanceof Int16Array?s=5122:a instanceof Uint32Array?s=5125:a instanceof Int32Array?s=5124:a instanceof Int8Array?s=5120:a instanceof Uint8Array&&(s=5121),{buffer:o,type:s,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version}}(t,a)):o.version<t.version&&(!function(t,r,a){var i=r.array,o=r.updateRange;e.bindBuffer(a,t),-1===o.count?e.bufferSubData(a,0,i):(n?e.bufferSubData(a,o.offset*i.BYTES_PER_ELEMENT,i,o.offset,o.count):e.bufferSubData(a,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,t,a),o.version=t.version)}}}}var Di=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(I.a)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:a,widthSegments:i,heightSegments:o};for(var s=r/2,u=a/2,c=Math.floor(i),l=Math.floor(o),g=c+1,d=l+1,h=r/c,f=a/l,p=[],C=[],m=[],b=[],v=0;v<d;v++)for(var A=v*f-u,y=0;y<g;y++){var w=y*h-s;C.push(w,-A,0),m.push(0,0,1),b.push(y/c),b.push(1-v/l)}for(var G=0;G<l;G++)for(var B=0;B<c;B++){var x=B+g*G,S=B+g*(G+1),k=B+1+g*(G+1),Z=B+1+g*G;p.push(x,S,Z),p.push(S,k,Z)}return e.setIndex(p),e.setAttribute("position",new qa(C,3)),e.setAttribute("normal",new qa(m,3)),e.setAttribute("uv",new qa(b,2)),e}return n}(li),Pi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Ui={common:{diffuse:{value:new ja(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ar},uv2Transform:{value:new ar},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new nr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ja(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ja(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ar}},sprite:{diffuse:{value:new ja(15658734)},opacity:{value:1},center:{value:new nr(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ar}}},Ji={basic:{uniforms:Oi([Ui.common,Ui.specularmap,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.fog]),vertexShader:Pi.meshbasic_vert,fragmentShader:Pi.meshbasic_frag},lambert:{uniforms:Oi([Ui.common,Ui.specularmap,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.fog,Ui.lights,{emissive:{value:new ja(0)}}]),vertexShader:Pi.meshlambert_vert,fragmentShader:Pi.meshlambert_frag},phong:{uniforms:Oi([Ui.common,Ui.specularmap,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.fog,Ui.lights,{emissive:{value:new ja(0)},specular:{value:new ja(1118481)},shininess:{value:30}}]),vertexShader:Pi.meshphong_vert,fragmentShader:Pi.meshphong_frag},standard:{uniforms:Oi([Ui.common,Ui.envmap,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.roughnessmap,Ui.metalnessmap,Ui.fog,Ui.lights,{emissive:{value:new ja(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag},toon:{uniforms:Oi([Ui.common,Ui.aomap,Ui.lightmap,Ui.emissivemap,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.gradientmap,Ui.fog,Ui.lights,{emissive:{value:new ja(0)}}]),vertexShader:Pi.meshtoon_vert,fragmentShader:Pi.meshtoon_frag},matcap:{uniforms:Oi([Ui.common,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,Ui.fog,{matcap:{value:null}}]),vertexShader:Pi.meshmatcap_vert,fragmentShader:Pi.meshmatcap_frag},points:{uniforms:Oi([Ui.points,Ui.fog]),vertexShader:Pi.points_vert,fragmentShader:Pi.points_frag},dashed:{uniforms:Oi([Ui.common,Ui.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pi.linedashed_vert,fragmentShader:Pi.linedashed_frag},depth:{uniforms:Oi([Ui.common,Ui.displacementmap]),vertexShader:Pi.depth_vert,fragmentShader:Pi.depth_frag},normal:{uniforms:Oi([Ui.common,Ui.bumpmap,Ui.normalmap,Ui.displacementmap,{opacity:{value:1}}]),vertexShader:Pi.normal_vert,fragmentShader:Pi.normal_frag},sprite:{uniforms:Oi([Ui.sprite,Ui.fog]),vertexShader:Pi.sprite_vert,fragmentShader:Pi.sprite_frag},background:{uniforms:{uvTransform:{value:new ar},t2D:{value:null}},vertexShader:Pi.background_vert,fragmentShader:Pi.background_frag},cube:{uniforms:Oi([Ui.envmap,{opacity:{value:1}}]),vertexShader:Pi.cube_vert,fragmentShader:Pi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pi.equirect_vert,fragmentShader:Pi.equirect_frag},distanceRGBA:{uniforms:Oi([Ui.common,Ui.displacementmap,{referencePosition:{value:new hr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pi.distanceRGBA_vert,fragmentShader:Pi.distanceRGBA_frag},shadow:{uniforms:Oi([Ui.lights,Ui.fog,{color:{value:new ja(0)},opacity:{value:1}}]),vertexShader:Pi.shadow_vert,fragmentShader:Pi.shadow_frag}};function Qi(e,t,n,r,a){var i,o,s=new ja(0),u=0,c=null,l=0,g=null;function d(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,a)}return{getClearColor:function(){return s},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),d(s,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){d(s,u=e)},render:function(n,a,h,f){var p=!0===a.isScene?a.background:null;p&&p.isTexture&&(p=t.get(p));var I=e.xr,C=I.getSession&&I.getSession();C&&"additive"===C.environmentBlendMode&&(p=null),null===p?d(s,u):p&&p.isColor&&(d(p,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.mapping===Ge)?(void 0===o&&((o=new ki(new Ri(1,1,1),new Fi({name:"BackgroundCubeMaterial",uniforms:Ni(Ji.cube.uniforms),vertexShader:Ji.cube.vertexShader,fragmentShader:Ji.cube.fragmentShader,side:R,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),o.material.uniforms.envMap.value=p,o.material.uniforms.flipEnvMap.value=p.isCubeTexture&&p._needsFlipEnvMap?-1:1,c===p&&l===p.version&&g===e.toneMapping||(o.material.needsUpdate=!0,c=p,l=p.version,g=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):p&&p.isTexture&&(void 0===i&&((i=new ki(new Di(2,2),new Fi({name:"BackgroundMaterial",uniforms:Ni(Ji.background.uniforms),vertexShader:Ji.background.vertexShader,fragmentShader:Ji.background.fragmentShader,side:Z,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&l===p.version&&g===e.toneMapping||(i.material.needsUpdate=!0,c=p,l=p.version,g=e.toneMapping),n.unshift(i,i.geometry,i.material,0,0,null))}}}function qi(e,t,n,r){var a=e.getParameter(34921),i=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==i,s={},u=d(null),c=u;function l(t){return r.isWebGL2?e.bindVertexArray(t):i.bindVertexArrayOES(t)}function g(t){return r.isWebGL2?e.deleteVertexArray(t):i.deleteVertexArrayOES(t)}function d(e){for(var t=[],n=[],r=[],i=0;i<a;i++)t[i]=0,n[i]=0,r[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function h(){for(var e=c.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function f(e){p(e,0)}function p(n,a){var i=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;(i[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==a)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,a),s[n]=a)}function I(){for(var t=c.newAttributes,n=c.enabledAttributes,r=0,a=n.length;r<a;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function C(t,n,a,i,o,s){!0!==r.isWebGL2||5124!==a&&5125!==a?e.vertexAttribPointer(t,n,a,i,o,s):e.vertexAttribIPointer(t,n,a,o,s)}function m(){b(),c!==u&&l((c=u).object)}function b(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(a,u,g,m,b){var v=!1;if(o){var A=function(t,n,a){var o=!0===a.wireframe,u=s[t.id];void 0===u&&(u={},s[t.id]=u);var c=u[n.id];void 0===c&&(c={},u[n.id]=c);var l=c[o];void 0===l&&(l=d(r.isWebGL2?e.createVertexArray():i.createVertexArrayOES()),c[o]=l);return l}(m,g,u);c!==A&&l((c=A).object),(v=function(e,t){var n=c.attributes,r=e.attributes,a=0;for(var i in r){var o=n[i],s=r[i];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;a++}return c.attributesNum!==a||c.index!==t}(m,b))&&function(e,t){var n={},r=e.attributes,a=0;for(var i in r){var o=r[i],s={};s.attribute=o,o.data&&(s.data=o.data),n[i]=s,a++}c.attributes=n,c.attributesNum=a,c.index=t}(m,b)}else{var y=!0===u.wireframe;c.geometry===m.id&&c.program===g.id&&c.wireframe===y||(c.geometry=m.id,c.program=g.id,c.wireframe=y,v=!0)}!0===a.isInstancedMesh&&(v=!0),null!==b&&n.update(b,34963),v&&(!function(a,i,o,s){if(!1===r.isWebGL2&&(a.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;h();var u=s.attributes,c=o.getAttributes(),l=i.defaultAttributeValues;for(var g in c){var d=c[g];if(d>=0){var m=u[g];if(void 0!==m){var b=m.normalized,v=m.itemSize,A=n.get(m);if(void 0===A)continue;var y=A.buffer,w=A.type,G=A.bytesPerElement;if(m.isInterleavedBufferAttribute){var B=m.data,x=B.stride,S=m.offset;B&&B.isInstancedInterleavedBuffer?(p(d,B.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=B.meshPerAttribute*B.count)):f(d),e.bindBuffer(34962,y),C(d,v,w,b,x*G,S*G)}else m.isInstancedBufferAttribute?(p(d,m.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=m.meshPerAttribute*m.count)):f(d),e.bindBuffer(34962,y),C(d,v,w,b,0,0)}else if("instanceMatrix"===g){var k=n.get(a.instanceMatrix);if(void 0===k)continue;var Z=k.buffer,R=k.type;p(d+0,1),p(d+1,1),p(d+2,1),p(d+3,1),e.bindBuffer(34962,Z),e.vertexAttribPointer(d+0,4,R,!1,64,0),e.vertexAttribPointer(d+1,4,R,!1,64,16),e.vertexAttribPointer(d+2,4,R,!1,64,32),e.vertexAttribPointer(d+3,4,R,!1,64,48)}else if("instanceColor"===g){var N=n.get(a.instanceColor);if(void 0===N)continue;var O=N.buffer,W=N.type;p(d,1),e.bindBuffer(34962,O),e.vertexAttribPointer(d,3,W,!1,12,0)}else if(void 0!==l){var F=l[g];if(void 0!==F)switch(F.length){case 2:e.vertexAttrib2fv(d,F);break;case 3:e.vertexAttrib3fv(d,F);break;case 4:e.vertexAttrib4fv(d,F);break;default:e.vertexAttrib1fv(d,F)}}}}I()}(a,u,g,m),null!==b&&e.bindBuffer(34963,n.get(b).buffer))},reset:m,resetDefaultState:b,dispose:function(){for(var e in m(),s){var t=s[e];for(var n in t){var r=t[n];for(var a in r)g(r[a].object),delete r[a];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var a in r)g(r[a].object),delete r[a];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var a in r)g(r[a].object),delete r[a];delete n[e.id]}}},initAttributes:h,enableAttribute:f,disableUnusedAttributes:I}}function $i(e,t,n,r){var a,i=r.isWebGL2;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,o,s){if(0!==s){var u,c;if(i)u=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[c](a,r,o,s),n.update(o,a,s)}}}function eo(e,t,n){var r;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var i="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=a(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=!0===n.logarithmicDepthBuffer,c=e.getParameter(34930),l=e.getParameter(35660),g=e.getParameter(3379),d=e.getParameter(34076),h=e.getParameter(34921),f=e.getParameter(36347),p=e.getParameter(36348),I=e.getParameter(36349),C=l>0,m=i||t.has("OES_texture_float");return{isWebGL2:i,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:a,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:g,maxCubemapSize:d,maxAttributes:h,maxVertexUniforms:f,maxVaryings:p,maxFragmentUniforms:I,vertexTextures:C,floatFragmentTextures:m,floatVertexTextures:C&&m,maxSamples:i?e.getParameter(36183):0}}function to(e){var t=this,n=null,r=0,a=!1,i=!1,o=new ba,s=new ar,u={value:null,needsUpdate:!1};function c(){u.value!==n&&(u.value=n,u.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function l(e,n,r,a){var i=null!==e?e.length:0,c=null;if(0!==i){if(c=u.value,!0!==a||null===c){var l=r+4*i,g=n.matrixWorldInverse;s.getNormalMatrix(g),(null===c||c.length<l)&&(c=new Float32Array(l));for(var d=0,h=r;d!==i;++d,h+=4)o.copy(e[d]).applyMatrix4(g,s),o.normal.toArray(c,h),c[h+3]=o.constant}u.value=c,u.needsUpdate=!0}return t.numPlanes=i,t.numIntersection=0,c}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,i){var o=0!==e.length||t||0!==r||a;return a=t,n=l(e,i,0),r=e.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,c()},this.setState=function(t,o,s){var g=t.clippingPlanes,d=t.clipIntersection,h=t.clipShadows,f=e.get(t);if(!a||null===g||0===g.length||i&&!h)i?l(null):c();else{var p=i?0:r,I=4*p,C=f.clippingState||null;u.value=C,C=l(g,o,I,s);for(var m=0;m!==I;++m)C[m]=n[m];f.clippingState=C,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=p}}}function no(e){var t=new WeakMap;function n(e,t){return t===ye?e.mapping=ve:t===we&&(e.mapping=Ae),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var a=t.get(n);void 0!==a&&(t.delete(n),a.dispose())}return{get:function(a){if(a&&a.isTexture){var i=a.mapping;if(i===ye||i===we){if(t.has(a))return n(t.get(a).texture,a.mapping);var o=a.image;if(o&&o.height>0){var s=e.getRenderTarget(),u=new Li(o.height/2);return u.fromEquirectangularTexture(e,a),t.set(a,u),e.setRenderTarget(s),a.addEventListener("dispose",r),n(u.texture,a.mapping)}return null}}return a},dispose:function(){t=new WeakMap}}}function ro(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ao(e,t,n,r){var a={},i=new WeakMap;function o(e){var s=e.target;for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);s.removeEventListener("dispose",o),delete a[s.id];var c=i.get(s);c&&(t.remove(c),i.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,a=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,c=s.length;u<c;u+=3){var l=s[u+0],g=s[u+1],d=s[u+2];n.push(l,g,g,d,d,l)}}else{var h=a.array;o=a.version;for(var f=0,p=h.length/3-1;f<p;f+=3){var I=f+0,C=f+1,m=f+2;n.push(I,C,C,m,m,I)}}var b=new(ei(n)>65535?Ja:Pa)(n,1);b.version=o;var v=i.get(e);v&&t.remove(v),i.set(e,b)}return{get:function(e,t){return!0===a[t.id]||(t.addEventListener("dispose",o),a[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var a=e.morphAttributes;for(var i in a)for(var o=a[i],s=0,u=o.length;s<u;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=i.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return i.get(e)}}}function io(e,t,n,r){var a,i,o,s=r.isWebGL2;this.setMode=function(e){a=e},this.setIndex=function(e){i=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,i,t*o),n.update(r,a,1)},this.renderInstances=function(r,u,c){if(0!==c){var l,g;if(s)l=e,g="drawElementsInstanced";else if(g="drawElementsInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[g](a,u,i,r*o,c),n.update(u,a,c)}}}function oo(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function so(e,t){return e[0]-t[0]}function uo(e,t){return Math.abs(t[1])-Math.abs(e[1])}function co(e){for(var t={},n=new Float32Array(8),r=[],a=0;a<8;a++)r[a]=[a,0];return{update:function(a,i,o,s){var u=a.morphTargetInfluences,c=void 0===u?0:u.length,l=t[i.id];if(void 0===l){l=[];for(var g=0;g<c;g++)l[g]=[g,0];t[i.id]=l}for(var d=0;d<c;d++){var h=l[d];h[0]=d,h[1]=u[d]}l.sort(uo);for(var f=0;f<8;f++)f<c&&l[f][1]?(r[f][0]=l[f][0],r[f][1]=l[f][1]):(r[f][0]=Number.MAX_SAFE_INTEGER,r[f][1]=0);r.sort(so);for(var p=o.morphTargets&&i.morphAttributes.position,I=o.morphNormals&&i.morphAttributes.normal,C=0,m=0;m<8;m++){var b=r[m],v=b[0],A=b[1];v!==Number.MAX_SAFE_INTEGER&&A?(p&&i.getAttribute("morphTarget"+m)!==p[v]&&i.setAttribute("morphTarget"+m,p[v]),I&&i.getAttribute("morphNormal"+m)!==I[v]&&i.setAttribute("morphNormal"+m,I[v]),n[m]=A,C+=A):(p&&!0===i.hasAttribute("morphTarget"+m)&&i.deleteAttribute("morphTarget"+m),I&&!0===i.hasAttribute("morphNormal"+m)&&i.deleteAttribute("morphNormal"+m),n[m]=0)}var y=i.morphTargetsRelative?1:1-C;s.getUniforms().setValue(e,"morphTargetBaseInfluence",y),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function lo(e,t,n,r){var a=new WeakMap;function i(e){var t=e.target;t.removeEventListener("dispose",i),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var o=r.render.frame,s=e.geometry,u=t.get(e,s);return a.get(u)!==o&&(t.update(u),a.set(u,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",i)&&e.addEventListener("dispose",i),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),u},dispose:function(){a=new WeakMap}}}Ji.physical={uniforms:Oi([Ji.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new nr(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ja(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag};var go=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(I.a)(this,n),(e=t.call(this,null)).image={data:r,width:a,height:i,depth:o},e.magFilter=Ze,e.minFilter=Ze,e.wrapR=Se,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return n}(sr);go.prototype.isDataTexture2DArray=!0;var ho=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(I.a)(this,n),(e=t.call(this,null)).image={data:r,width:a,height:i,depth:o},e.magFilter=Ze,e.minFilter=Ze,e.wrapR=Se,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return n}(sr);ho.prototype.isDataTexture3D=!0;var fo=new sr,po=new go,Io=new ho,Co=new ji,mo=[],bo=[],vo=new Float32Array(16),Ao=new Float32Array(9),yo=new Float32Array(4);function wo(e,t,n){var r=e[0];if(r<=0||r>0)return e;var a=t*n,i=mo[a];if(void 0===i&&(i=new Float32Array(a),mo[a]=i),0!==t){r.toArray(i,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(i,s)}return i}function Go(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Bo(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function xo(e,t){var n=bo[t];void 0===n&&(n=new Int32Array(t),bo[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function So(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ko(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Go(n,t))return;e.uniform2fv(this.addr,t),Bo(n,t)}}function Zo(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Go(n,t))return;e.uniform3fv(this.addr,t),Bo(n,t)}}function Ro(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Go(n,t))return;e.uniform4fv(this.addr,t),Bo(n,t)}}function No(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Go(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Bo(n,t)}else{if(Go(n,r))return;yo.set(r),e.uniformMatrix2fv(this.addr,!1,yo),Bo(n,r)}}function Oo(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Go(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Bo(n,t)}else{if(Go(n,r))return;Ao.set(r),e.uniformMatrix3fv(this.addr,!1,Ao),Bo(n,r)}}function Wo(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Go(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Bo(n,t)}else{if(Go(n,r))return;vo.set(r),e.uniformMatrix4fv(this.addr,!1,vo),Bo(n,r)}}function Fo(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Mo(e,t){var n=this.cache;Go(n,t)||(e.uniform2iv(this.addr,t),Bo(n,t))}function Vo(e,t){var n=this.cache;Go(n,t)||(e.uniform3iv(this.addr,t),Bo(n,t))}function To(e,t){var n=this.cache;Go(n,t)||(e.uniform4iv(this.addr,t),Bo(n,t))}function Eo(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function jo(e,t){var n=this.cache;Go(n,t)||(e.uniform2uiv(this.addr,t),Bo(n,t))}function Lo(e,t){var n=this.cache;Go(n,t)||(e.uniform3uiv(this.addr,t),Bo(n,t))}function Xo(e,t){var n=this.cache;Go(n,t)||(e.uniform4uiv(this.addr,t),Bo(n,t))}function Ho(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.safeSetTexture2D(t||fo,a)}function Yo(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture3D(t||Io,a)}function zo(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.safeSetTextureCube(t||Co,a)}function Ko(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture2DArray(t||po,a)}function _o(e,t){e.uniform1fv(this.addr,t)}function Do(e,t){var n=wo(t,this.size,2);e.uniform2fv(this.addr,n)}function Po(e,t){var n=wo(t,this.size,3);e.uniform3fv(this.addr,n)}function Uo(e,t){var n=wo(t,this.size,4);e.uniform4fv(this.addr,n)}function Jo(e,t){var n=wo(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Qo(e,t){var n=wo(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function qo(e,t){var n=wo(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function $o(e,t){e.uniform1iv(this.addr,t)}function es(e,t){e.uniform2iv(this.addr,t)}function ts(e,t){e.uniform3iv(this.addr,t)}function ns(e,t){e.uniform4iv(this.addr,t)}function rs(e,t){e.uniform1uiv(this.addr,t)}function as(e,t){e.uniform2uiv(this.addr,t)}function is(e,t){e.uniform3uiv(this.addr,t)}function os(e,t){e.uniform4uiv(this.addr,t)}function ss(e,t,n){var r=t.length,a=xo(n,r);e.uniform1iv(this.addr,a);for(var i=0;i!==r;++i)n.safeSetTexture2D(t[i]||fo,a[i])}function us(e,t,n){var r=t.length,a=xo(n,r);e.uniform1iv(this.addr,a);for(var i=0;i!==r;++i)n.safeSetTextureCube(t[i]||Co,a[i])}function cs(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return So;case 35664:return ko;case 35665:return Zo;case 35666:return Ro;case 35674:return No;case 35675:return Oo;case 35676:return Wo;case 5124:case 35670:return Fo;case 35667:case 35671:return Mo;case 35668:case 35672:return Vo;case 35669:case 35673:return To;case 5125:return Eo;case 36294:return jo;case 36295:return Lo;case 36296:return Xo;case 35678:case 36198:case 36298:case 36306:case 35682:return Ho;case 35679:case 36299:case 36307:return Yo;case 35680:case 36300:case 36308:case 36293:return zo;case 36289:case 36303:case 36311:case 36292:return Ko}}(t.type)}function ls(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return _o;case 35664:return Do;case 35665:return Po;case 35666:return Uo;case 35674:return Jo;case 35675:return Qo;case 35676:return qo;case 5124:case 35670:return $o;case 35667:case 35671:return es;case 35668:case 35672:return ts;case 35669:case 35673:return ns;case 5125:return rs;case 36294:return as;case 36295:return is;case 36296:return os;case 35678:case 36198:case 36298:case 36306:case 35682:return ss;case 35680:case 36300:case 36308:case 36293:return us}}(t.type)}function gs(e){this.id=e,this.seq=[],this.map={}}ls.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Bo(t,e)},gs.prototype.setValue=function(e,t,n){for(var r=this.seq,a=0,i=r.length;a!==i;++a){var o=r[a];o.setValue(e,t[o.id],n)}};var ds=/(\w+)(\])?(\[|\.)?/g;function hs(e,t){e.seq.push(t),e.map[t.id]=t}function fs(e,t,n){var r=e.name,a=r.length;for(ds.lastIndex=0;;){var i=ds.exec(r),o=ds.lastIndex,s=i[1],u="]"===i[2],c=i[3];if(u&&(s|=0),void 0===c||"["===c&&o+2===a){hs(n,void 0===c?new cs(s,e,t):new ls(s,e,t));break}var l=n.map[s];void 0===l&&hs(n,l=new gs(s)),n=l}}function ps(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var a=e.getActiveUniform(t,r);fs(a,e.getUniformLocation(t,a.name),this)}}function Is(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}ps.prototype.setValue=function(e,t,n,r){var a=this.map[t];void 0!==a&&a.setValue(e,n,r)},ps.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},ps.upload=function(e,t,n,r){for(var a=0,i=t.length;a!==i;++a){var o=t[a],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},ps.seqWithValue=function(e,t){for(var n=[],r=0,a=e.length;r!==a;++r){var i=e[r];i.id in t&&n.push(i)}return n};var Cs=0;function ms(e){switch(e){case dn:return["Linear","( value )"];case hn:return["sRGB","( value )"];case pn:return["RGBE","( value )"];case Cn:return["RGBM","( value, 7.0 )"];case mn:return["RGBM","( value, 16.0 )"];case bn:return["RGBD","( value, 256.0 )"];case fn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case In:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function bs(e,t,n){var r=e.getShaderParameter(t,35713),a=e.getShaderInfoLog(t).trim();return r&&""===a?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+a+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function vs(e,t){var n=ms(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function As(e,t){var n=ms(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function ys(e,t){var n;switch(t){case fe:n="Linear";break;case pe:n="Reinhard";break;case Ie:n="OptimizedCineon";break;case Ce:n="ACESFilmic";break;case me:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ws(e){return""!==e}function Gs(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Bs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var xs=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ss(e){return e.replace(xs,ks)}function ks(e,t){var n=Pi[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Ss(n)}var Zs=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Rs=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ns(e){return e.replace(Rs,Ws).replace(Zs,Os)}function Os(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Ws(e,t,n,r)}function Ws(e,t,n,r){for(var a="",i=parseInt(t);i<parseInt(n);i++)a+=r.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return a}function Fs(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ms(e,t,n,r){var a,i,o=e.getContext(),s=n.defines,u=n.vertexShader,c=n.fragmentShader,l=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===x?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===S?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===k&&(t="SHADOWMAP_TYPE_VSM"),t}(n),g=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ve:case Ae:t="ENVMAP_TYPE_CUBE";break;case Ge:case Be:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Ae:case Be:t="ENVMAP_MODE_REFRACTION"}return t}(n),h=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case le:t="ENVMAP_BLENDING_MULTIPLY";break;case ge:t="ENVMAP_BLENDING_MIX";break;case de:t="ENVMAP_BLENDING_ADD"}return t}(n),f=e.gammaFactor>0?e.gammaFactor:1,p=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ws).join("\n")}(n),I=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),C=o.createProgram(),m=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((a=[I].filter(ws).join("\n")).length>0&&(a+="\n"),(i=[p,I].filter(ws).join("\n")).length>0&&(i+="\n")):(a=[Fs(n),"#define SHADER_NAME "+n.shaderName,I,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+f,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ws).join("\n"),i=[p,Fs(n),"#define SHADER_NAME "+n.shaderName,I,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+f,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+d:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==he?"#define TONE_MAPPING":"",n.toneMapping!==he?Pi.tonemapping_pars_fragment:"",n.toneMapping!==he?ys("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Pi.encodings_pars_fragment,n.map?vs("mapTexelToLinear",n.mapEncoding):"",n.matcap?vs("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?vs("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?vs("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?vs("lightMapTexelToLinear",n.lightMapEncoding):"",As("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ws).join("\n")),u=Bs(u=Gs(u=Ss(u),n),n),c=Bs(c=Gs(c=Ss(c),n),n),u=Ns(u),c=Ns(c),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(m="#version 300 es\n",a=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+a,i=["#define varying in",n.glslVersion===Jn?"":"out highp vec4 pc_fragColor;",n.glslVersion===Jn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i);var b,v,A=m+i+c,y=Is(o,35633,m+a+u),w=Is(o,35632,A);if(o.attachShader(C,y),o.attachShader(C,w),void 0!==n.index0AttributeName?o.bindAttribLocation(C,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(C,0,"position"),o.linkProgram(C),e.debug.checkShaderErrors){var G=o.getProgramInfoLog(C).trim(),B=o.getShaderInfoLog(y).trim(),Z=o.getShaderInfoLog(w).trim(),R=!0,N=!0;if(!1===o.getProgramParameter(C,35714)){R=!1;var O=bs(o,y,"vertex"),W=bs(o,w,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(C,35715),"gl.getProgramInfoLog",G,O,W)}else""!==G?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",G):""!==B&&""!==Z||(N=!1);N&&(this.diagnostics={runnable:R,programLog:G,vertexShader:{log:B,prefix:a},fragmentShader:{log:Z,prefix:i}})}return o.deleteShader(y),o.deleteShader(w),this.getUniforms=function(){return void 0===b&&(b=new ps(o,C)),b},this.getAttributes=function(){return void 0===v&&(v=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),a=0;a<r;a++){var i=e.getActiveAttrib(t,a).name;n[i]=e.getAttribLocation(t,i)}return n}(o,C)),v},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(C),this.program=void 0},this.name=n.shaderName,this.id=Cs++,this.cacheKey=t,this.usedTimes=1,this.program=C,this.vertexShader=y,this.fragmentShader=w,this}function Vs(e,t,n,r,a,i){var o=[],s=r.isWebGL2,u=r.logarithmicDepthBuffer,c=r.floatVertexTextures,l=r.maxVertexUniforms,g=r.vertexTextures,d=r.precision,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function p(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=dn,t}return{getParameters:function(a,o,f,I,C){var m,b,v=I.fog,A=a.isMeshStandardMaterial?I.environment:null,y=t.get(a.envMap||A),w=h[a.type],G=C.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(c)return 1024;var n=l,r=Math.floor((n-20)/4),a=Math.min(r,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(C):0;if(null!==a.precision&&(d=r.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",d,"instead."),w){var B=Ji[w];m=B.vertexShader,b=B.fragmentShader}else m=a.vertexShader,b=a.fragmentShader;var x=e.getRenderTarget();return{isWebGL2:s,shaderID:w,shaderName:a.type,vertexShader:m,fragmentShader:b,defines:a.defines,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:d,instancing:!0===C.isInstancedMesh,instancingColor:!0===C.isInstancedMesh&&null!==C.instanceColor,supportsVertexTextures:g,outputEncoding:null!==x?p(x.texture):e.outputEncoding,map:!!a.map,mapEncoding:p(a.map),matcap:!!a.matcap,matcapEncoding:p(a.matcap),envMap:!!y,envMapMode:y&&y.mapping,envMapEncoding:p(y),envMapCubeUV:!!y&&(y.mapping===Ge||y.mapping===Be),lightMap:!!a.lightMap,lightMapEncoding:p(a.lightMap),aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:p(a.emissiveMap),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===wn,tangentSpaceNormalMap:a.normalMapType===yn,clearcoatMap:!!a.clearcoatMap,clearcoatRoughnessMap:!!a.clearcoatRoughnessMap,clearcoatNormalMap:!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,sheen:!!a.sheen,transmissionMap:!!a.transmissionMap,combine:a.combine,vertexTangents:a.normalMap&&a.vertexTangents,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&C.geometry.attributes.color&&4===C.geometry.attributes.color.itemSize,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.displacementMap||!!a.transmissionMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmissionMap)&&!!a.displacementMap,fog:!!v,useFog:a.fog,fogExp2:v&&v.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:u,skinning:a.skinning&&G>0,maxBones:G,useVertexTexture:c,morphTargets:a.morphTargets,morphNormals:a.morphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:i.numPlanes,numClipIntersection:i.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&f.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:he,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,alphaTest:a.alphaTest,doubleSided:a.side===N,flipSided:a.side===R,depthPacking:void 0!==a.depthPacking&&a.depthPacking,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var a=0;a<f.length;a++)n.push(t[f[a]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=h[e.type];if(n){var r=Ji[n];t=Wi.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,s=o.length;i<s;i++){var u=o[i];if(u.cacheKey===n){++(r=u).usedTimes;break}}return void 0===r&&(r=new Ms(e,n,t,a),o.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=o.indexOf(e);o[t]=o[o.length-1],o.pop(),e.destroy()}},programs:o}}function Ts(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Es(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function js(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Ls(e){var t=[],n=0,r=[],a=[],i={id:-1};function o(r,a,o,s,u,c){var l=t[n],g=e.get(o);return void 0===l?(l={id:r.id,object:r,geometry:a,material:o,program:g.program||i,groupOrder:s,renderOrder:r.renderOrder,z:u,group:c},t[n]=l):(l.id=r.id,l.object=r,l.geometry=a,l.material=o,l.program=g.program||i,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=u,l.group=c),n++,l}return{opaque:r,transparent:a,init:function(){n=0,r.length=0,a.length=0},push:function(e,t,n,i,s,u){var c=o(e,t,n,i,s,u);(!0===n.transparent?a:r).push(c)},unshift:function(e,t,n,i,s,u){var c=o(e,t,n,i,s,u);(!0===n.transparent?a:r).unshift(c)},finish:function(){for(var e=n,r=t.length;e<r;e++){var a=t[e];if(null===a.id)break;a.id=null,a.object=null,a.geometry=null,a.material=null,a.program=null,a.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Es),a.length>1&&a.sort(t||js)}}}function Xs(e){var t=new WeakMap;return{get:function(n,r){var a;return!1===t.has(n)?(a=new Ls(e),t.set(n,[a])):r>=t.get(n).length?(a=new Ls(e),t.get(n).push(a)):a=t.get(n)[r],a},dispose:function(){t=new WeakMap}}}function Hs(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new hr,color:new ja};break;case"SpotLight":n={position:new hr,direction:new hr,color:new ja,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new hr,color:new ja,distance:0,decay:0};break;case"HemisphereLight":n={direction:new hr,skyColor:new ja,groundColor:new ja};break;case"RectAreaLight":n={color:new ja,position:new hr,halfWidth:new hr,halfHeight:new hr}}return e[t.id]=n,n}}}var Ys=0;function zs(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ks(e,t){for(var n=new Hs,r=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nr};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nr,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;i<9;i++)a.probe.push(new hr);var o=new hr,s=new zr,u=new zr;return{setup:function(i){for(var o=0,s=0,u=0,c=0;c<9;c++)a.probe[c].set(0,0,0);var l=0,g=0,d=0,h=0,f=0,p=0,I=0,C=0;i.sort(zs);for(var m=0,b=i.length;m<b;m++){var v=i[m],A=v.color,y=v.intensity,w=v.distance,G=v.shadow&&v.shadow.map?v.shadow.map.texture:null;if(v.isAmbientLight)o+=A.r*y,s+=A.g*y,u+=A.b*y;else if(v.isLightProbe)for(var B=0;B<9;B++)a.probe[B].addScaledVector(v.sh.coefficients[B],y);else if(v.isDirectionalLight){var x=n.get(v);if(x.color.copy(v.color).multiplyScalar(v.intensity),v.castShadow){var S=v.shadow,k=r.get(v);k.shadowBias=S.bias,k.shadowNormalBias=S.normalBias,k.shadowRadius=S.radius,k.shadowMapSize=S.mapSize,a.directionalShadow[l]=k,a.directionalShadowMap[l]=G,a.directionalShadowMatrix[l]=v.shadow.matrix,p++}a.directional[l]=x,l++}else if(v.isSpotLight){var Z=n.get(v);if(Z.position.setFromMatrixPosition(v.matrixWorld),Z.color.copy(A).multiplyScalar(y),Z.distance=w,Z.coneCos=Math.cos(v.angle),Z.penumbraCos=Math.cos(v.angle*(1-v.penumbra)),Z.decay=v.decay,v.castShadow){var R=v.shadow,N=r.get(v);N.shadowBias=R.bias,N.shadowNormalBias=R.normalBias,N.shadowRadius=R.radius,N.shadowMapSize=R.mapSize,a.spotShadow[d]=N,a.spotShadowMap[d]=G,a.spotShadowMatrix[d]=v.shadow.matrix,C++}a.spot[d]=Z,d++}else if(v.isRectAreaLight){var O=n.get(v);O.color.copy(A).multiplyScalar(y),O.halfWidth.set(.5*v.width,0,0),O.halfHeight.set(0,.5*v.height,0),a.rectArea[h]=O,h++}else if(v.isPointLight){var W=n.get(v);if(W.color.copy(v.color).multiplyScalar(v.intensity),W.distance=v.distance,W.decay=v.decay,v.castShadow){var F=v.shadow,M=r.get(v);M.shadowBias=F.bias,M.shadowNormalBias=F.normalBias,M.shadowRadius=F.radius,M.shadowMapSize=F.mapSize,M.shadowCameraNear=F.camera.near,M.shadowCameraFar=F.camera.far,a.pointShadow[g]=M,a.pointShadowMap[g]=G,a.pointShadowMatrix[g]=v.shadow.matrix,I++}a.point[g]=W,g++}else if(v.isHemisphereLight){var V=n.get(v);V.skyColor.copy(v.color).multiplyScalar(y),V.groundColor.copy(v.groundColor).multiplyScalar(y),a.hemi[f]=V,f++}}h>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Ui.LTC_FLOAT_1,a.rectAreaLTC2=Ui.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=Ui.LTC_HALF_1,a.rectAreaLTC2=Ui.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=o,a.ambient[1]=s,a.ambient[2]=u;var T=a.hash;T.directionalLength===l&&T.pointLength===g&&T.spotLength===d&&T.rectAreaLength===h&&T.hemiLength===f&&T.numDirectionalShadows===p&&T.numPointShadows===I&&T.numSpotShadows===C||(a.directional.length=l,a.spot.length=d,a.rectArea.length=h,a.point.length=g,a.hemi.length=f,a.directionalShadow.length=p,a.directionalShadowMap.length=p,a.pointShadow.length=I,a.pointShadowMap.length=I,a.spotShadow.length=C,a.spotShadowMap.length=C,a.directionalShadowMatrix.length=p,a.pointShadowMatrix.length=I,a.spotShadowMatrix.length=C,T.directionalLength=l,T.pointLength=g,T.spotLength=d,T.rectAreaLength=h,T.hemiLength=f,T.numDirectionalShadows=p,T.numPointShadows=I,T.numSpotShadows=C,a.version=Ys++)},setupView:function(e,t){for(var n=0,r=0,i=0,c=0,l=0,g=t.matrixWorldInverse,d=0,h=e.length;d<h;d++){var f=e[d];if(f.isDirectionalLight){var p=a.directional[n];p.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),p.direction.sub(o),p.direction.transformDirection(g),n++}else if(f.isSpotLight){var I=a.spot[i];I.position.setFromMatrixPosition(f.matrixWorld),I.position.applyMatrix4(g),I.direction.setFromMatrixPosition(f.matrixWorld),o.setFromMatrixPosition(f.target.matrixWorld),I.direction.sub(o),I.direction.transformDirection(g),i++}else if(f.isRectAreaLight){var C=a.rectArea[c];C.position.setFromMatrixPosition(f.matrixWorld),C.position.applyMatrix4(g),u.identity(),s.copy(f.matrixWorld),s.premultiply(g),u.extractRotation(s),C.halfWidth.set(.5*f.width,0,0),C.halfHeight.set(0,.5*f.height,0),C.halfWidth.applyMatrix4(u),C.halfHeight.applyMatrix4(u),c++}else if(f.isPointLight){var m=a.point[r];m.position.setFromMatrixPosition(f.matrixWorld),m.position.applyMatrix4(g),r++}else if(f.isHemisphereLight){var b=a.hemi[l];b.direction.setFromMatrixPosition(f.matrixWorld),b.direction.transformDirection(g),b.direction.normalize(),l++}}},state:a}}function _s(e,t){var n=new Ks(e,t),r=[],a=[];return{init:function(){r.length=0,a.length=0},state:{lightsArray:r,shadowsArray:a,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){a.push(e)}}}function Ds(e,t){var n=new WeakMap;return{get:function(r){var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(a=new _s(e,t),n.set(r,[a])):i>=n.get(r).length?(a=new _s(e,t),n.get(r).push(a)):a=n.get(r)[i],a},dispose:function(){n=new WeakMap}}}var Ps=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=vn,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(Oa);Ps.prototype.isMeshDepthMaterial=!0;var Us=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new hr,r.nearDistance=1,r.farDistance=1e3,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(Oa);Us.prototype.isMeshDistanceMaterial=!0;function Js(e,t,n){var r=new zi,a=new nr,i=new nr,o=new cr,s=[],u=[],c={},l=n.maxTextureSize,g={0:R,1:Z,2:N},d=new Fi({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new nr},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),h=d.clone();h.defines.HORIZONTAL_PASS=1;var f=new li;f.setAttribute("position",new Ya(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new ki(f,d),I=this;function C(n,r){var a=t.update(p);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,d,p,null),h.uniforms.shadow_pass.value=n.mapPass.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,h,p,null)}function m(e,t,n){var r=e<<0|t<<1|n<<2,a=s[r];return void 0===a&&(a=new Ps({depthPacking:An,morphTargets:e,skinning:t}),s[r]=a),a}function b(e,t,n){var r=e<<0|t<<1|n<<2,a=u[r];return void 0===a&&(a=new Us({morphTargets:e,skinning:t}),u[r]=a),a}function v(t,n,r,a,i,o,s){var u=null,l=m,d=t.customDepthMaterial;if(!0===a.isPointLight&&(l=b,d=t.customDistanceMaterial),void 0===d){var h=!1;!0===r.morphTargets&&(h=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var f=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?f=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),u=l(h,f,!0===t.isInstancedMesh)}else u=d;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var p=u.uuid,I=r.uuid,C=c[p];void 0===C&&(C={},c[p]=C);var v=C[I];void 0===v&&(v=u.clone(),C[I]=v),u=v}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=s===k?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:g[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===a.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(a.matrixWorld),u.nearDistance=i,u.farDistance=o),u}function A(n,a,i,o,s){if(!1!==n.visible){if(n.layers.test(a.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===k)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld);var u=t.update(n),c=n.material;if(Array.isArray(c))for(var l=u.groups,g=0,d=l.length;g<d;g++){var h=l[g],f=c[h.materialIndex];if(f&&f.visible){var p=v(n,u,f,o,i.near,i.far,s);e.renderBufferDirect(i,null,u,p,n,h)}}else if(c.visible){var I=v(n,u,c,o,i.near,i.far,s);e.renderBufferDirect(i,null,u,I,n,null)}}for(var C=n.children,m=0,b=C.length;m<b;m++)A(C[m],a,i,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=x,this.render=function(t,n,s){if(!1!==I.enabled&&(!1!==I.autoUpdate||!1!==I.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),c=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),d=e.state;d.setBlending(F),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var h=0,f=t.length;h<f;h++){var p=t[h],m=p.shadow;if(void 0!==m){if(!1!==m.autoUpdate||!1!==m.needsUpdate){a.copy(m.mapSize);var b=m.getFrameExtents();if(a.multiply(b),i.copy(m.mapSize),(a.x>l||a.y>l)&&(a.x>l&&(i.x=Math.floor(l/b.x),a.x=i.x*b.x,m.mapSize.x=i.x),a.y>l&&(i.y=Math.floor(l/b.y),a.y=i.y*b.y,m.mapSize.y=i.y)),null===m.map&&!m.isPointLightShadow&&this.type===k){var v={minFilter:Fe,magFilter:Fe,format:$e};m.map=new lr(a.x,a.y,v),m.map.texture.name=p.name+".shadowMap",m.mapPass=new lr(a.x,a.y,v),m.camera.updateProjectionMatrix()}if(null===m.map){var y={minFilter:Ze,magFilter:Ze,format:$e};m.map=new lr(a.x,a.y,y),m.map.texture.name=p.name+".shadowMap",m.camera.updateProjectionMatrix()}e.setRenderTarget(m.map),e.clear();for(var w=m.getViewportCount(),G=0;G<w;G++){var B=m.getViewport(G);o.set(i.x*B.x,i.y*B.y,i.x*B.z,i.y*B.w),d.viewport(o),m.updateMatrices(p,G),r=m.getFrustum(),A(n,s,m.camera,p,this.type)}m.isPointLightShadow||this.type!==k||C(m,s),m.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",p,"has no shadow.")}I.needsUpdate=!1,e.setRenderTarget(u,c,g)}}}function Qs(e,t,n){var r,a,i=n.isWebGL2;var o=new function(){var t=!1,n=new cr,r=null,a=new cr(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,i,o,s){!0===s&&(t*=o,r*=o,i*=o),n.set(t,r,i,o),!1===a.equals(n)&&(e.clearColor(t,r,i,o),a.copy(n))},reset:function(){t=!1,r=null,a.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,a=null;return{setTest:function(e){e?be(2929):ve(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case ne:e.depthFunc(512);break;case re:e.depthFunc(519);break;case ae:e.depthFunc(513);break;case ie:e.depthFunc(515);break;case oe:e.depthFunc(514);break;case se:e.depthFunc(518);break;case ue:e.depthFunc(516);break;case ce:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){a!==t&&(e.clearDepth(t),a=t)},reset:function(){t=!1,n=null,r=null,a=null}}},c=new function(){var t=!1,n=null,r=null,a=null,i=null,o=null,s=null,u=null,c=null;return{setTest:function(e){t||(e?be(2960):ve(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&a===n&&i===o||(e.stencilFunc(t,n,o),r=t,a=n,i=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,a=null,i=null,o=null,s=null,u=null,c=null}}},l={},g=null,d={},h=null,f=!1,p=null,I=null,C=null,m=null,b=null,v=null,G=null,B=!1,x=null,S=null,k=null,Z=null,O=null,W=e.getParameter(35661),le=!1,ge=0,de=e.getParameter(7938);-1!==de.indexOf("WebGL")?(ge=parseFloat(/^WebGL (\d)/.exec(de)[1]),le=ge>=1):-1!==de.indexOf("OpenGL ES")&&(ge=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),le=ge>=2);var he=null,fe={},pe=new cr(0,0,e.canvas.width,e.canvas.height),Ie=new cr(0,0,e.canvas.width,e.canvas.height);function Ce(t,n,r){var a=new Uint8Array(4),i=e.createTexture();e.bindTexture(t,i),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,a);return i}var me={};function be(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function ve(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}me[3553]=Ce(3553,3553,1),me[34067]=Ce(34067,34069,6),o.setClear(0,0,0,1),s.setClear(1),c.setClear(0),be(2929),s.setFunc(ie),Be(!1),xe(y),be(2884),Ge(F);var Ae=(r={},Object(u.a)(r,L,32774),Object(u.a)(r,X,32778),Object(u.a)(r,H,32779),r);if(i)Ae[Y]=32775,Ae[z]=32776;else{var ye=t.get("EXT_blend_minmax");null!==ye&&(Ae[Y]=ye.MIN_EXT,Ae[z]=ye.MAX_EXT)}var we=(a={},Object(u.a)(a,K,0),Object(u.a)(a,_,1),Object(u.a)(a,D,768),Object(u.a)(a,U,770),Object(u.a)(a,te,776),Object(u.a)(a,$,774),Object(u.a)(a,Q,772),Object(u.a)(a,P,769),Object(u.a)(a,J,771),Object(u.a)(a,ee,775),Object(u.a)(a,q,773),a);function Ge(t,n,r,a,i,o,s,u){if(t!==F){if(!1===f&&(be(3042),f=!0),t===j)i=i||n,o=o||r,s=s||a,n===I&&i===b||(e.blendEquationSeparate(Ae[n],Ae[i]),I=n,b=i),r===C&&a===m&&o===v&&s===G||(e.blendFuncSeparate(we[r],we[a],we[o],we[s]),C=r,m=a,v=o,G=s),p=t,B=null;else if(t!==p||u!==B){if(I===L&&b===L||(e.blendEquation(32774),I=L,b=L),u)switch(t){case M:e.blendFuncSeparate(1,771,1,771);break;case V:e.blendFunc(1,1);break;case T:e.blendFuncSeparate(0,0,769,771);break;case E:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case M:e.blendFuncSeparate(770,771,1,771);break;case V:e.blendFunc(770,1);break;case T:e.blendFunc(0,769);break;case E:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}C=null,m=null,v=null,G=null,p=t,B=u}}else!0===f&&(ve(3042),f=!1)}function Be(t){x!==t&&(t?e.frontFace(2304):e.frontFace(2305),x=t)}function xe(t){t!==A?(be(2884),t!==S&&(t===y?e.cullFace(1029):t===w?e.cullFace(1028):e.cullFace(1032))):ve(2884),S=t}function Se(t,n,r){t?(be(32823),Z===n&&O===r||(e.polygonOffset(n,r),Z=n,O=r)):ve(32823)}function ke(t){void 0===t&&(t=33984+W-1),he!==t&&(e.activeTexture(t),he=t)}return{buffers:{color:o,depth:s,stencil:c},enable:be,disable:ve,bindFramebuffer:function(t,n){null===n&&null!==g&&(n=g),d[t]!==n&&(e.bindFramebuffer(t,n),d[t]=n)},bindXRFramebuffer:function(t){t!==g&&(e.bindFramebuffer(36160,t),g=t)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:Ge,setMaterial:function(e,t){e.side===N?ve(2884):be(2884);var n=e.side===R;t&&(n=!n),Be(n),e.blending===M&&!1===e.transparent?Ge(F):Ge(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),o.setMask(e.colorWrite);var r=e.stencilWrite;c.setTest(r),r&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Se(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?be(32926):ve(32926)},setFlipSided:Be,setCullFace:xe,setLineWidth:function(t){t!==k&&(le&&e.lineWidth(t),k=t)},setPolygonOffset:Se,setScissorTest:function(e){e?be(3089):ve(3089)},activeTexture:ke,bindTexture:function(t,n){null===he&&ke();var r=fe[he];void 0===r&&(r={type:void 0,texture:void 0},fe[he]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||me[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=fe[he];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===pe.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),pe.copy(t))},viewport:function(t){!1===Ie.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),Ie.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},he=null,fe={},g=null,d={},h=null,f=!1,p=null,I=null,C=null,m=null,b=null,v=null,G=null,B=!1,x=null,S=null,k=null,Z=null,O=null,pe.set(0,0,e.canvas.width,e.canvas.height),Ie.set(0,0,e.canvas.width,e.canvas.height),o.reset(),s.reset(),c.reset()}}}function qs(e,t,n,r,a,i,o){var s,c,l,g=a.isWebGL2,d=a.maxTextures,h=a.maxCubemapSize,f=a.maxTextureSize,p=a.maxSamples,I=new WeakMap,C=!1;try{C="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(X){}function m(e,t){return C?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function b(e,t,n,r){var a=1;if((e.width>r||e.height>r)&&(a=r/Math.max(e.width,e.height)),a<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var i=t?tr.floorPowerOfTwo:Math.floor,o=i(a*e.width),s=i(a*e.height);void 0===l&&(l=m(o,s));var u=n?m(o,s):l;return u.width=o,u.height=s,u.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),u}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return tr.isPowerOfTwo(e.width)&&tr.isPowerOfTwo(e.height)}function A(e,t){return e.generateMipmaps&&t&&e.minFilter!==Ze&&e.minFilter!==Fe}function y(t,n,a,i){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log2(Math.max(a,i))}function w(n,r,a){if(!1===g)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var i=r;return 6403===r&&(5126===a&&(i=33326),5131===a&&(i=33325),5121===a&&(i=33321)),6407===r&&(5126===a&&(i=34837),5131===a&&(i=34843),5121===a&&(i=32849)),6408===r&&(5126===a&&(i=34836),5131===a&&(i=34842),5121===a&&(i=32856)),33325!==i&&33326!==i&&34842!==i&&34836!==i||t.get("EXT_color_buffer_float"),i}function G(e){return e===Ze||e===Re||e===Oe?9728:9729}function B(t){var n=t.target;n.removeEventListener("dispose",B),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&I.delete(n),o.memory.textures--}function x(t){var n=t.target;n.removeEventListener("dispose",x),function(t){var n=t.texture,a=r.get(t),i=r.get(n);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)e.deleteFramebuffer(a.__webglFramebuffer[o]),a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer[o]);else e.deleteFramebuffer(a.__webglFramebuffer),a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer),a.__webglMultisampledFramebuffer&&e.deleteFramebuffer(a.__webglMultisampledFramebuffer),a.__webglColorRenderbuffer&&e.deleteRenderbuffer(a.__webglColorRenderbuffer),a.__webglDepthRenderbuffer&&e.deleteRenderbuffer(a.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}(n),o.memory.textures--}var S=0;function k(e,t){var a=r.get(e);if(e.isVideoTexture&&function(e){var t=o.render.frame;I.get(e)!==t&&(I.set(e,t),e.update())}(e),e.version>0&&a.__version!==e.version){var i=e.image;if(void 0===i)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==i.complete)return void F(a,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,a.__webglTexture)}function Z(t,a){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,a){if(6!==r.image.length)return;W(t,r),n.activeTexture(33984+a),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,u=[],c=0;c<6;c++)u[c]=o||s?s?r.image[c].image:r.image[c]:b(r.image[c],!1,!0,h);var l,d=u[0],f=v(d)||g,p=i.convert(r.format),I=i.convert(r.type),C=w(r.internalFormat,p,I);if(O(34067,r,f),o){for(var m=0;m<6;m++){l=u[m].mipmaps;for(var G=0;G<l.length;G++){var B=l[G];r.format!==$e&&r.format!==qe?null!==p?n.compressedTexImage2D(34069+m,G,C,B.width,B.height,0,B.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+m,G,C,B.width,B.height,0,p,I,B.data)}}t.__maxMipLevel=l.length-1}else{l=r.mipmaps;for(var x=0;x<6;x++)if(s){n.texImage2D(34069+x,0,C,u[x].width,u[x].height,0,p,I,u[x].data);for(var S=0;S<l.length;S++){var k=l[S].image[x].image;n.texImage2D(34069+x,S+1,C,k.width,k.height,0,p,I,k.data)}}else{n.texImage2D(34069+x,0,C,p,I,u[x]);for(var Z=0;Z<l.length;Z++){var R=l[Z];n.texImage2D(34069+x,Z+1,C,p,I,R.image[x])}}t.__maxMipLevel=l.length}A(r,f)&&y(34067,r,d.width,d.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(o,t,a):(n.activeTexture(33984+a),n.bindTexture(34067,o.__webglTexture))}var R=(s={},Object(u.a)(s,xe,10497),Object(u.a)(s,Se,33071),Object(u.a)(s,ke,33648),s),N=(c={},Object(u.a)(c,Ze,9728),Object(u.a)(c,Re,9984),Object(u.a)(c,Oe,9986),Object(u.a)(c,Fe,9729),Object(u.a)(c,Me,9985),Object(u.a)(c,Te,9987),c);function O(n,i,o){if(o?(e.texParameteri(n,10242,R[i.wrapS]),e.texParameteri(n,10243,R[i.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,R[i.wrapR]),e.texParameteri(n,10240,N[i.magFilter]),e.texParameteri(n,10241,N[i.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),i.wrapS===Se&&i.wrapT===Se||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,G(i.magFilter)),e.texParameteri(n,10241,G(i.minFilter)),i.minFilter!==Ze&&i.minFilter!==Fe&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(i.type===Ke&&!1===t.has("OES_texture_float_linear"))return;if(!1===g&&i.type===_e&&!1===t.has("OES_texture_half_float_linear"))return;(i.anisotropy>1||r.get(i).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,a.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy)}}function W(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",B),t.__webglTexture=e.createTexture(),o.memory.textures++)}function F(t,r,a){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),W(t,r),n.activeTexture(33984+a),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var s,u=function(e){return!g&&(e.wrapS!==Se||e.wrapT!==Se||e.minFilter!==Ze&&e.minFilter!==Fe)}(r)&&!1===v(r.image),c=b(r.image,u,!1,f),l=v(c)||g,d=i.convert(r.format),h=i.convert(r.type),p=w(r.internalFormat,d,h);O(o,r,l);var I=r.mipmaps;if(r.isDepthTexture)p=6402,g?p=r.type===Ke?36012:r.type===ze?33190:r.type===Je?35056:33189:r.type===Ke&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===rt&&6402===p&&r.type!==He&&r.type!==ze&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=He,h=i.convert(r.type)),r.format===at&&6402===p&&(p=34041,r.type!==Je&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Je,h=i.convert(r.type))),n.texImage2D(3553,0,p,c.width,c.height,0,d,h,null);else if(r.isDataTexture)if(I.length>0&&l){for(var C=0,m=I.length;C<m;C++)s=I[C],n.texImage2D(3553,C,p,s.width,s.height,0,d,h,s.data);r.generateMipmaps=!1,t.__maxMipLevel=I.length-1}else n.texImage2D(3553,0,p,c.width,c.height,0,d,h,c.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var G=0,B=I.length;G<B;G++)s=I[G],r.format!==$e&&r.format!==qe?null!==d?n.compressedTexImage2D(3553,G,p,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,G,p,s.width,s.height,0,d,h,s.data);t.__maxMipLevel=I.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,p,c.width,c.height,c.depth,0,d,h,c.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,p,c.width,c.height,c.depth,0,d,h,c.data),t.__maxMipLevel=0;else if(I.length>0&&l){for(var x=0,S=I.length;x<S;x++)s=I[x],n.texImage2D(3553,x,p,d,h,s);r.generateMipmaps=!1,t.__maxMipLevel=I.length-1}else n.texImage2D(3553,0,p,d,h,c),t.__maxMipLevel=0;A(r,l)&&y(o,r,c.width,c.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function M(t,a,o,s){var u=a.texture,c=i.convert(u.format),l=i.convert(u.type),g=w(u.internalFormat,c,l);32879===s||35866===s?n.texImage3D(s,0,g,a.width,a.height,a.depth,0,c,l,null):n.texImage2D(s,0,g,a.width,a.height,0,c,l,null),n.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(u).__webglTexture,0),n.bindFramebuffer(36160,null)}function V(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var a=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===Ke?a=36012:o.type===ze&&(a=33190));var s=E(n);e.renderbufferStorageMultisample(36161,s,a,n.width,n.height)}else e.renderbufferStorage(36161,a,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var u=E(n);e.renderbufferStorageMultisample(36161,u,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var c=n.texture,l=i.convert(c.format),g=i.convert(c.type),d=w(c.internalFormat,l,g);if(r){var h=E(n);e.renderbufferStorageMultisample(36161,h,d,n.width,n.height)}else e.renderbufferStorage(36161,d,n.width,n.height)}e.bindRenderbuffer(36161,null)}function T(t){var a=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,a){if(a&&a.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!a.depthTexture||!a.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(a.depthTexture).__webglTexture&&a.depthTexture.image.width===a.width&&a.depthTexture.image.height===a.height||(a.depthTexture.image.width=a.width,a.depthTexture.image.height=a.height,a.depthTexture.needsUpdate=!0),k(a.depthTexture,0);var i=r.get(a.depthTexture).__webglTexture;if(a.depthTexture.format===rt)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(a.depthTexture.format!==at)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(a.__webglFramebuffer,t)}else if(i){a.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(36160,a.__webglFramebuffer[o]),a.__webglDepthbuffer[o]=e.createRenderbuffer(),V(a.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(36160,a.__webglFramebuffer),a.__webglDepthbuffer=e.createRenderbuffer(),V(a.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function E(e){return g&&e.isWebGLMultisampleRenderTarget?Math.min(p,e.samples):0}var j=!1,L=!1;this.allocateTextureUnit=function(){var e=S;return e>=d&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+d),S+=1,e},this.resetTextureUnits=function(){S=0},this.setTexture2D=k,this.setTexture2DArray=function(e,t){var a=r.get(e);e.version>0&&a.__version!==e.version?F(a,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,a.__webglTexture))},this.setTexture3D=function(e,t){var a=r.get(e);e.version>0&&a.__version!==e.version?F(a,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,a.__webglTexture))},this.setTextureCube=Z,this.setupRenderTarget=function(t){var a=t.texture,s=r.get(t),u=r.get(a);t.addEventListener("dispose",x),u.__webglTexture=e.createTexture(),u.__version=a.version,o.memory.textures++;var c=!0===t.isWebGLCubeRenderTarget,l=!0===t.isWebGLMultisampleRenderTarget,d=a.isDataTexture3D||a.isDataTexture2DArray,h=v(t)||g;if(!g||a.format!==qe||a.type!==Ke&&a.type!==_e||(a.format=$e,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),c){s.__webglFramebuffer=[];for(var f=0;f<6;f++)s.__webglFramebuffer[f]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),l)if(g){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var p=i.convert(a.format),I=i.convert(a.type),C=w(a.internalFormat,p,I),m=E(t);e.renderbufferStorageMultisample(36161,m,C,t.width,t.height),n.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),V(s.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(c){n.bindTexture(34067,u.__webglTexture),O(34067,a,h);for(var b=0;b<6;b++)M(s.__webglFramebuffer[b],t,36064,34069+b);A(a,h)&&y(34067,a,t.width,t.height),n.bindTexture(34067,null)}else{var G=3553;if(d)if(g)G=a.isDataTexture3D?32879:35866;else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(G,u.__webglTexture),O(G,a,h),M(s.__webglFramebuffer,t,36064,G),A(a,h)&&y(3553,a,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&T(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(A(t,v(e)||g)){var a=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(t).__webglTexture;n.bindTexture(a,i),y(a,t,e.width,e.height),n.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(g){var a=r.get(t);n.bindFramebuffer(36008,a.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,a.__webglFramebuffer);var i=t.width,o=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,i,o,0,0,i,o,s,9728),n.bindFramebuffer(36160,a.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===j&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),j=!0),e=e.texture),k(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===L&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),L=!0),e=e.texture),Z(e,t)}}function $s(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===je)return 5121;if(e===De)return 32819;if(e===Pe)return 32820;if(e===Ue)return 33635;if(e===Le)return 5120;if(e===Xe)return 5122;if(e===He)return 5123;if(e===Ye)return 5124;if(e===ze)return 5125;if(e===Ke)return 5126;if(e===_e)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===Qe)return 6406;if(e===qe)return 6407;if(e===$e)return 6408;if(e===et)return 6409;if(e===tt)return 6410;if(e===rt)return 6402;if(e===at)return 34041;if(e===it)return 6403;if(e===ot)return 36244;if(e===st)return 33319;if(e===ut)return 33320;if(e===ct)return 36248;if(e===lt)return 36249;if(e===gt||e===dt||e===ht||e===ft){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===gt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===dt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===ht)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===ft)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===pt||e===It||e===Ct||e===mt){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===pt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===It)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Ct)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===mt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===bt)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===vt||e===At)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===vt)return n.COMPRESSED_RGB8_ETC2;if(e===At)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===yt||e===wt||e===Gt||e===Bt||e===xt||e===St||e===kt||e===Zt||e===Rt||e===Nt||e===Ot||e===Wt||e===Ft||e===Mt||e===Tt||e===Et||e===jt||e===Lt||e===Xt||e===Ht||e===Yt||e===zt||e===Kt||e===_t||e===Dt||e===Pt||e===Ut||e===Jt?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===Vt?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===Je?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}var eu=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(I.a)(this,n),(e=t.call(this)).cameras=r,e}return n}(Vi);eu.prototype.isArrayCamera=!0;var tu=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this)).type="Group",e}return n}(pa);function nu(){this._targetRay=null,this._grip=null,this._hand=null}function ru(e,t){var n=this,r=e.state,a=null,s=1,u=null,c="local-floor",l=null,g=[],d=new Map,h=new Vi;h.layers.enable(1),h.viewport=new cr;var f=new Vi;f.layers.enable(2),f.viewport=new cr;var p=[h,f],I=new eu;I.layers.enable(1),I.layers.enable(2);var C=null,m=null;function b(e){var t=d.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function v(){d.forEach((function(e,t){e.disconnect(t)})),d.clear(),C=null,m=null,r.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),x.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function A(e){for(var t=a.inputSources,n=0;n<g.length;n++)d.set(t[n],g[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],o=d.get(i);o&&(o.dispatchEvent({type:"disconnected",data:i}),d.delete(i))}for(var s=0;s<e.added.length;s++){var u=e.added[s],c=d.get(u);c&&c.dispatchEvent({type:"connected",data:u})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=g[e];return void 0===t&&(t=new nu,g[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){var t=g[e];return void 0===t&&(t=new nu,g[e]=t),t.getGripSpace()},this.getHand=function(e){var t=g[e];return void 0===t&&(t=new nu,g[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){c=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u},this.getSession=function(){return a},this.setSession=function(){var e=Object(o.a)(i.a.mark((function e(r){var o,l,g;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=r)){e.next=24;break}if(a.addEventListener("select",b),a.addEventListener("selectstart",b),a.addEventListener("selectend",b),a.addEventListener("squeeze",b),a.addEventListener("squeezestart",b),a.addEventListener("squeezeend",b),a.addEventListener("end",v),a.addEventListener("inputsourceschange",A),!0===(o=t.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,t.makeXRCompatible();case 14:return l={antialias:o.antialias,alpha:o.alpha,depth:o.depth,stencil:o.stencil,framebufferScaleFactor:s},g=new XRWebGLLayer(a,t,l),a.updateRenderState({baseLayer:g}),e.next=19,a.requestReferenceSpace(c);case 19:u=e.sent,x.setContext(a),x.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var y=new hr,w=new hr;function G(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){I.near=f.near=h.near=e.near,I.far=f.far=h.far=e.far,C===I.near&&m===I.far||(a.updateRenderState({depthNear:I.near,depthFar:I.far}),C=I.near,m=I.far);var t=e.parent,n=I.cameras;G(I,t);for(var r=0;r<n.length;r++)G(n[r],t);e.matrixWorld.copy(I.matrixWorld),e.matrix.copy(I.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var i=e.children,o=0,s=i.length;o<s;o++)i[o].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){y.setFromMatrixPosition(t.matrixWorld),w.setFromMatrixPosition(n.matrixWorld);var r=y.distanceTo(w),a=t.projectionMatrix.elements,i=n.projectionMatrix.elements,o=a[14]/(a[10]-1),s=a[14]/(a[10]+1),u=(a[9]+1)/a[5],c=(a[9]-1)/a[5],l=(a[8]-1)/a[0],g=(i[8]+1)/i[0],d=o*l,h=o*g,f=r/(-l+g),p=f*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(p),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var I=o+f,C=s+f,m=d-p,b=h+(r-p),v=u*s/C*I,A=c*s/C*I;e.projectionMatrix.makePerspective(m,b,v,A,I,C)}(I,h,f):I.projectionMatrix.copy(h.projectionMatrix),I};var B=null;var x=new Ki;x.setAnimationLoop((function(e,t){if(null!==(l=t.getViewerPose(u))){var n=l.views,i=a.renderState.baseLayer;r.bindXRFramebuffer(i.framebuffer);var o=!1;n.length!==I.cameras.length&&(I.cameras.length=0,o=!0);for(var s=0;s<n.length;s++){var c=n[s],d=i.getViewport(c),h=p[s];h.matrix.fromArray(c.transform.matrix),h.projectionMatrix.fromArray(c.projectionMatrix),h.viewport.set(d.x,d.y,d.width,d.height),0===s&&I.matrix.copy(h.matrix),!0===o&&I.cameras.push(h)}}for(var f=a.inputSources,C=0;C<g.length;C++){var m=g[C],b=f[C];m.update(b,t,u)}B&&B(e,t)})),this.setAnimationLoop=function(e){B=e},this.dispose=function(){}}function au(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,a,i=e.get(n).envMap;if(i){t.envMap.value=i,t.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var o=e.get(i).__maxMipLevel;void 0!==o&&(t.maxMipLevel.value=o)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uv2Transform.value.copy(a.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===R&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===R&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,a,i){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===R&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===R&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===R&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var a;t.map?a=t.map:t.alphaMap&&(a=t.alphaMap);void 0!==a&&(!0===a.matrixAutoUpdate&&a.updateMatrix(),e.uvTransform.value.copy(a.matrix))}(e,r,a,i):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function iu(e){var t=void 0!==(e=e||{}).canvas?e.canvas:function(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,a=void 0===e.depth||e.depth,i=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",l=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,g=null,d=null,h=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=dn,this.physicallyCorrectLights=!1,this.toneMapping=he,this.toneMappingExposure=1;var p=this,I=!1,C=0,m=0,b=null,v=-1,A=null,y=new cr,w=new cr,G=null,B=t.width,x=t.height,S=1,k=null,Z=null,R=new cr(0,0,B,x),N=new cr(0,0,B,x),O=!1,W=new zi,F=!1,M=!1,V=new zr,T=new hr,E={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function j(){return null===b?S:1}var L,X,H,Y,z,K,_,D,P,U,J,Q,q,$,ee,te,ne,re,ae,ie,oe,se,ue=n;function ce(e,n){for(var r=0;r<e.length;r++){var a=e[r],i=t.getContext(a,n);if(null!==i)return i}return null}try{var le={alpha:r,depth:a,stencil:i,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:l};if(t.addEventListener("webglcontextlost",pe,!1),t.addEventListener("webglcontextrestored",Ie,!1),null===ue){var ge=["webgl2","webgl","experimental-webgl"];if(!0===p.isWebGL1Renderer&&ge.shift(),null===(ue=ce(ge,le)))throw ce(ge)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ue.getShaderPrecisionFormat&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ke){throw console.error("THREE.WebGLRenderer: "+ke.message),ke}function de(){L=new ro(ue),X=new eo(ue,L,e),L.init(X),oe=new $s(ue,L,X),H=new Qs(ue,L,X),Y=new oo(ue),z=new Ts,K=new qs(ue,L,H,z,X,oe,Y),_=new no(p),D=new _i(ue,X),se=new qi(ue,L,D,X),P=new ao(ue,D,Y,se),U=new lo(ue,P,D,Y),re=new co(ue),ee=new to(z),J=new Vs(p,_,L,X,se,ee),Q=new au(z),q=new Xs(z),$=new Ds(L,X),ne=new Qi(p,_,H,U,s),te=new Js(p,U,X),ae=new $i(ue,L,Y,X),ie=new io(ue,L,Y,X),Y.programs=J.programs,p.capabilities=X,p.extensions=L,p.properties=z,p.renderLists=q,p.shadowMap=te,p.state=H,p.info=Y}de();var fe=new ru(p,ue);function pe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),I=!0}function Ie(){console.log("THREE.WebGLRenderer: Context Restored."),I=!1;var e=Y.autoReset,t=te.enabled,n=te.autoUpdate,r=te.needsUpdate,a=te.type;de(),Y.autoReset=e,te.enabled=t,te.autoUpdate=n,te.needsUpdate=r,te.type=a}function Ce(e){var t=e.target;t.removeEventListener("dispose",Ce),function(e){(function(e){var t=z.get(e).programs;void 0!==t&&t.forEach((function(e){J.releaseProgram(e)}))})(e),z.remove(e)}(t)}this.xr=fe,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){var e=L.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=L.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return S},this.setPixelRatio=function(e){void 0!==e&&(S=e,this.setSize(B,x,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new nr),e.set(B,x)},this.setSize=function(e,n,r){fe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(B=e,x=n,t.width=Math.floor(e*S),t.height=Math.floor(n*S),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new nr),e.set(B*S,x*S).floor()},this.setDrawingBufferSize=function(e,n,r){B=e,x=n,S=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new cr),e.copy(y)},this.getViewport=function(e){return e.copy(R)},this.setViewport=function(e,t,n,r){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,r),H.viewport(y.copy(R).multiplyScalar(S).floor())},this.getScissor=function(e){return e.copy(N)},this.setScissor=function(e,t,n,r){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,r),H.scissor(w.copy(N).multiplyScalar(S).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(e){H.setScissorTest(O=e)},this.setOpaqueSort=function(e){k=e},this.setTransparentSort=function(e){Z=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new ja),e.copy(ne.getClearColor())},this.setClearColor=function(){ne.setClearColor.apply(ne,arguments)},this.getClearAlpha=function(){return ne.getClearAlpha()},this.setClearAlpha=function(){ne.setClearAlpha.apply(ne,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ue.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",pe,!1),t.removeEventListener("webglcontextrestored",Ie,!1),q.dispose(),$.dispose(),z.dispose(),_.dispose(),U.dispose(),se.dispose(),fe.dispose(),fe.removeEventListener("sessionstart",be),fe.removeEventListener("sessionend",ve),Ae.stop()},this.renderBufferImmediate=function(e,t){se.initAttributes();var n=z.get(e);e.hasPositions&&!n.position&&(n.position=ue.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ue.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ue.createBuffer()),e.hasColors&&!n.color&&(n.color=ue.createBuffer());var r=t.getAttributes();e.hasPositions&&(ue.bindBuffer(34962,n.position),ue.bufferData(34962,e.positionArray,35048),se.enableAttribute(r.position),ue.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(ue.bindBuffer(34962,n.normal),ue.bufferData(34962,e.normalArray,35048),se.enableAttribute(r.normal),ue.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(ue.bindBuffer(34962,n.uv),ue.bufferData(34962,e.uvArray,35048),se.enableAttribute(r.uv),ue.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(ue.bindBuffer(34962,n.color),ue.bufferData(34962,e.colorArray,35048),se.enableAttribute(r.color),ue.vertexAttribPointer(r.color,3,5126,!1,0,0)),se.disableUnusedAttributes(),ue.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,a,i){null===t&&(t=E);var o=a.isMesh&&a.matrixWorld.determinant()<0,s=Se(e,t,r,a);H.setMaterial(r,o);var u=n.index,c=n.attributes.position;if(null===u){if(void 0===c||0===c.count)return}else if(0===u.count)return;var l,g=1;!0===r.wireframe&&(u=P.getWireframeAttribute(n),g=2),(r.morphTargets||r.morphNormals)&&re.update(a,n,r,s),se.setup(a,r,s,n,u);var d=ae;null!==u&&(l=D.get(u),(d=ie).setIndex(l));var h=null!==u?u.count:c.count,f=n.drawRange.start*g,p=n.drawRange.count*g,I=null!==i?i.start*g:0,C=null!==i?i.count*g:1/0,m=Math.max(f,I),b=Math.min(h,f+p,I+C)-1,v=Math.max(0,b-m+1);if(0!==v){if(a.isMesh)!0===r.wireframe?(H.setLineWidth(r.wireframeLinewidth*j()),d.setMode(1)):d.setMode(4);else if(a.isLine){var A=r.linewidth;void 0===A&&(A=1),H.setLineWidth(A*j()),a.isLineSegments?d.setMode(1):a.isLineLoop?d.setMode(2):d.setMode(3)}else a.isPoints?d.setMode(0):a.isSprite&&d.setMode(4);if(a.isInstancedMesh)d.renderInstances(m,v,a.count);else if(n.isInstancedBufferGeometry){var y=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(m,v,y)}else d.render(m,v)}},this.compile=function(e,t){(d=$.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++){Be(n[r],e,t)}else Be(n,e,t)}))};var me=null;function be(){Ae.stop()}function ve(){Ae.start()}var Ae=new Ki;function ye(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||W.intersectsSprite(e)){r&&T.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);var a=U.update(e),i=e.material;i.visible&&g.push(e,a,i,n,T.z,null)}}else if(e.isImmediateRenderObject)r&&T.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V),g.push(e,null,e.material,n,T.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Y.render.frame&&(e.skeleton.update(),e.skeleton.frame=Y.render.frame),!e.frustumCulled||W.intersectsObject(e))){r&&T.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);var o=U.update(e),s=e.material;if(Array.isArray(s))for(var u=o.groups,c=0,l=u.length;c<l;c++){var h=u[c],f=s[h.materialIndex];f&&f.visible&&g.push(e,o,f,n,T.z,h)}else s.visible&&g.push(e,o,s,n,T.z,null)}for(var p=e.children,I=0,C=p.length;I<C;I++)ye(p[I],t,n,r)}}function we(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,a=0,i=e.length;a<i;a++){var o=e[a],s=o.object,u=o.geometry,c=null===r?o.material:r,l=o.group;if(n.isArrayCamera)for(var g=n.cameras,h=0,f=g.length;h<f;h++){var p=g[h];s.layers.test(p.layers)&&(H.viewport(y.copy(p.viewport)),d.setupLightsView(p),Ge(s,t,p,u,c,l))}else Ge(s,t,n,u,c,l)}}function Ge(e,t,n,r,a,i){if(e.onBeforeRender(p,t,n,r,a,i),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=Se(n,t,a,e);H.setMaterial(a),se.reset(),function(e,t){e.render((function(e){p.renderBufferImmediate(e,t)}))}(e,o)}else p.renderBufferDirect(n,t,r,a,e,i);e.onAfterRender(p,t,n,r,a,i)}function Be(e,t,n){!0!==t.isScene&&(t=E);var r=z.get(e),a=d.state.lights,i=d.state.shadowsArray,o=a.state.version,s=J.getParameters(e,a.state,i,t,n),u=J.getProgramCacheKey(s),c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=_.get(e.envMap||r.environment),void 0===c&&(e.addEventListener("dispose",Ce),c=new Map,r.programs=c);var l=c.get(u);if(void 0!==l){if(r.currentProgram===l&&r.lightsStateVersion===o)return xe(e,s),l}else s.uniforms=J.getUniforms(e),e.onBeforeCompile(s,p),l=J.acquireProgram(s,u),c.set(u,l),r.uniforms=s.uniforms;var g=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(g.clippingPlanes=ee.uniform),xe(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(g.ambientLightColor.value=a.state.ambient,g.lightProbe.value=a.state.probe,g.directionalLights.value=a.state.directional,g.directionalLightShadows.value=a.state.directionalShadow,g.spotLights.value=a.state.spot,g.spotLightShadows.value=a.state.spotShadow,g.rectAreaLights.value=a.state.rectArea,g.ltc_1.value=a.state.rectAreaLTC1,g.ltc_2.value=a.state.rectAreaLTC2,g.pointLights.value=a.state.point,g.pointLightShadows.value=a.state.pointShadow,g.hemisphereLights.value=a.state.hemi,g.directionalShadowMap.value=a.state.directionalShadowMap,g.directionalShadowMatrix.value=a.state.directionalShadowMatrix,g.spotShadowMap.value=a.state.spotShadowMap,g.spotShadowMatrix.value=a.state.spotShadowMatrix,g.pointShadowMap.value=a.state.pointShadowMap,g.pointShadowMatrix.value=a.state.pointShadowMatrix);var h=l.getUniforms(),f=ps.seqWithValue(h.seq,g);return r.currentProgram=l,r.uniformsList=f,l}function xe(e,t){var n=z.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas}function Se(e,t,n,r){!0!==t.isScene&&(t=E),K.resetTextureUnits();var a=t.fog,i=n.isMeshStandardMaterial?t.environment:null,o=null===b?p.outputEncoding:b.texture.encoding,s=_.get(n.envMap||i),u=!0===n.vertexColors&&r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,c=z.get(n),l=d.state.lights;if(!0===F&&(!0===M||e!==A)){var g=e===A&&n.id===v;ee.setState(n,e,g)}var h=!1;n.version===c.__version?c.needsLights&&c.lightsStateVersion!==l.state.version||c.outputEncoding!==o||r.isInstancedMesh&&!1===c.instancing?h=!0:r.isInstancedMesh||!0!==c.instancing?c.envMap!==s||n.fog&&c.fog!==a?h=!0:void 0===c.numClippingPlanes||c.numClippingPlanes===ee.numPlanes&&c.numIntersection===ee.numIntersection?c.vertexAlphas!==u&&(h=!0):h=!0:h=!0:(h=!0,c.__version=n.version);var f=c.currentProgram;!0===h&&(f=Be(n,t,r));var I,C,m=!1,y=!1,w=!1,G=f.getUniforms(),B=c.uniforms;if(H.useProgram(f.program)&&(m=!0,y=!0,w=!0),n.id!==v&&(v=n.id,y=!0),m||A!==e){if(G.setValue(ue,"projectionMatrix",e.projectionMatrix),X.logarithmicDepthBuffer&&G.setValue(ue,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),A!==e&&(A=e,y=!0,w=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var k=G.map.cameraPosition;void 0!==k&&k.setValue(ue,T.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&G.setValue(ue,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&G.setValue(ue,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){G.setOptional(ue,r,"bindMatrix"),G.setOptional(ue,r,"bindMatrixInverse");var Z=r.skeleton;if(Z){var R=Z.bones;if(X.floatVertexTextures){if(null===Z.boneTexture){var N=Math.sqrt(4*R.length);N=tr.ceilPowerOfTwo(N),N=Math.max(N,4);var O=new Float32Array(N*N*4);O.set(Z.boneMatrices);var W=new Xi(O,N,N,$e,Ke);Z.boneMatrices=O,Z.boneTexture=W,Z.boneTextureSize=N}G.setValue(ue,"boneTexture",Z.boneTexture,K),G.setValue(ue,"boneTextureSize",Z.boneTextureSize)}else G.setOptional(ue,Z,"boneMatrices")}}return(y||c.receiveShadow!==r.receiveShadow)&&(c.receiveShadow=r.receiveShadow,G.setValue(ue,"receiveShadow",r.receiveShadow)),y&&(G.setValue(ue,"toneMappingExposure",p.toneMappingExposure),c.needsLights&&(C=w,(I=B).ambientLightColor.needsUpdate=C,I.lightProbe.needsUpdate=C,I.directionalLights.needsUpdate=C,I.directionalLightShadows.needsUpdate=C,I.pointLights.needsUpdate=C,I.pointLightShadows.needsUpdate=C,I.spotLights.needsUpdate=C,I.spotLightShadows.needsUpdate=C,I.rectAreaLights.needsUpdate=C,I.hemisphereLights.needsUpdate=C),a&&n.fog&&Q.refreshFogUniforms(B,a),Q.refreshMaterialUniforms(B,n,S,x),ps.upload(ue,c.uniformsList,B,K)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ps.upload(ue,c.uniformsList,B,K),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&G.setValue(ue,"center",r.center),G.setValue(ue,"modelViewMatrix",r.modelViewMatrix),G.setValue(ue,"normalMatrix",r.normalMatrix),G.setValue(ue,"modelMatrix",r.matrixWorld),f}Ae.setAnimationLoop((function(e){me&&me(e)})),"undefined"!==typeof window&&Ae.setContext(window),this.setAnimationLoop=function(e){me=e,fe.setAnimationLoop(e),null===e?Ae.stop():Ae.start()},fe.addEventListener("sessionstart",be),fe.addEventListener("sessionend",ve),this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==I){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===fe.enabled&&!0===fe.isPresenting&&(t=fe.getCamera(t)),!0===e.isScene&&e.onBeforeRender(p,e,t,n||b),(d=$.get(e,f.length)).init(),f.push(d),V.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),W.setFromProjectionMatrix(V),M=this.localClippingEnabled,F=ee.init(this.clippingPlanes,M,t),(g=q.get(e,h.length)).init(),h.push(g),ye(e,t,0,p.sortObjects),g.finish(),!0===p.sortObjects&&g.sort(k,Z),!0===F&&ee.beginShadows();var a=d.state.shadowsArray;te.render(a,e,t),d.setupLights(),d.setupLightsView(t),!0===F&&ee.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ne.render(g,e,t,r);var i=g.opaque,o=g.transparent;i.length>0&&we(i,e,t),o.length>0&&we(o,e,t),null!==b&&(K.updateRenderTargetMipmap(b),K.updateMultisampleRenderTarget(b)),!0===e.isScene&&e.onAfterRender(p,e,t),H.buffers.depth.setTest(!0),H.buffers.depth.setMask(!0),H.buffers.color.setMask(!0),H.setPolygonOffset(!1),se.resetDefaultState(),v=-1,A=null,f.pop(),d=f.length>0?f[f.length-1]:null,h.pop(),g=h.length>0?h[h.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return C},this.getActiveMipmapLevel=function(){return m},this.getRenderTarget=function(){return b},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;b=e,C=t,m=n,e&&void 0===z.get(e).__webglFramebuffer&&K.setupRenderTarget(e);var r=null,a=!1,i=!1;if(e){var o=e.texture;(o.isDataTexture3D||o.isDataTexture2DArray)&&(i=!0);var s=z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=s[t],a=!0):r=e.isWebGLMultisampleRenderTarget?z.get(e).__webglMultisampledFramebuffer:s,y.copy(e.viewport),w.copy(e.scissor),G=e.scissorTest}else y.copy(R).multiplyScalar(S).floor(),w.copy(N).multiplyScalar(S).floor(),G=O;if(H.bindFramebuffer(36160,r),H.viewport(y),H.scissor(w),H.setScissorTest(G),a){var u=z.get(e.texture);ue.framebufferTexture2D(36160,36064,34069+t,u.__webglTexture,n)}else if(i){var c=z.get(e.texture),l=t||0;ue.framebufferTextureLayer(36160,36064,c.__webglTexture,n||0,l)}},this.readRenderTargetPixels=function(e,t,n,r,a,i,o){if(e&&e.isWebGLRenderTarget){var s=z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){H.bindFramebuffer(36160,s);try{var u=e.texture,c=u.format,l=u.type;if(c!==$e&&oe.convert(c)!==ue.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var g=l===_e&&(L.has("EXT_color_buffer_half_float")||X.isWebGL2&&L.has("EXT_color_buffer_float"));if(l!==je&&oe.convert(l)!==ue.getParameter(35738)&&(l!==Ke||!(X.isWebGL2||L.has("OES_texture_float")||L.has("WEBGL_color_buffer_float")))&&!g)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ue.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-a&&ue.readPixels(t,n,r,a,oe.convert(c),oe.convert(l),i):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var d=null!==b?z.get(b).__webglFramebuffer:null;H.bindFramebuffer(36160,d)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),a=Math.floor(t.image.width*r),i=Math.floor(t.image.height*r),o=oe.convert(t.format);K.setTexture2D(t,0),ue.copyTexImage2D(3553,n,o,e.x,e.y,a,i,0),H.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.image.width,i=t.image.height,o=oe.convert(n.format),s=oe.convert(n.type);K.setTexture2D(n,0),ue.pixelStorei(37440,n.flipY),ue.pixelStorei(37441,n.premultiplyAlpha),ue.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ue.texSubImage2D(3553,r,e.x,e.y,a,i,o,s,t.image.data):t.isCompressedTexture?ue.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ue.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ue.generateMipmap(3553),H.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(p.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var i,o=n.image,s=o.width,u=o.height,c=o.data,l=oe.convert(r.format),g=oe.convert(r.type);if(r.isDataTexture3D)K.setTexture3D(r,0),i=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");K.setTexture2DArray(r,0),i=35866}ue.pixelStorei(37440,r.flipY),ue.pixelStorei(37441,r.premultiplyAlpha),ue.pixelStorei(3317,r.unpackAlignment);var d=ue.getParameter(3314),h=ue.getParameter(32878),f=ue.getParameter(3316),I=ue.getParameter(3315),C=ue.getParameter(32877);ue.pixelStorei(3314,s),ue.pixelStorei(32878,u),ue.pixelStorei(3316,e.min.x),ue.pixelStorei(3315,e.min.y),ue.pixelStorei(32877,e.min.z),ue.texSubImage3D(i,a,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,l,g,c),ue.pixelStorei(3314,d),ue.pixelStorei(32878,h),ue.pixelStorei(3316,f),ue.pixelStorei(3315,I),ue.pixelStorei(32877,C),0===a&&r.generateMipmaps&&ue.generateMipmap(i),H.unbindTexture()}},this.initTexture=function(e){K.setTexture2D(e,0),H.unbindTexture()},this.resetState=function(){C=0,m=0,b=null,H.reset(),se.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}tu.prototype.isGroup=!0,Object.assign(nu.prototype,{constructor:nu,getHandSpace:function(){return null===this._hand&&(this._hand=new tu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new tu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new tu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){var r=null,a=null,i=null,o=this._targetRay,u=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)),c&&e.hand){i=!0;var l,g=Object(s.a)(e.hand.values());try{for(g.s();!(l=g.n()).done;){var d=l.value,h=t.getJointPose(d,n);if(void 0===c.joints[d.jointName]){var f=new tu;f.matrixAutoUpdate=!1,f.visible=!1,c.joints[d.jointName]=f,c.add(f)}var p=c.joints[d.jointName];null!==h&&(p.matrix.fromArray(h.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.jointRadius=h.radius),p.visible=null!==h}}catch(b){g.e(b)}finally{g.f()}var I=c.joints["index-finger-tip"],C=c.joints["thumb-tip"],m=I.position.distanceTo(C.position);c.inputState.pinching&&m>.025?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&m<=.015&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==u&&e.gripSpace&&null!==(a=t.getPose(e.gripSpace,n))&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale));return null!==o&&(o.visible=null!==r),null!==u&&(u.visible=null!==a),null!==c&&(c.visible=null!==i),this}}),Object.assign(ru.prototype,Qn.prototype);var ou=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(iu);ou.prototype.isWebGL1Renderer=!0;var su=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;Object(I.a)(this,e),this.name="",this.color=new ja(t),this.density=n}return Object(C.a)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();su.prototype.isFogExp2=!0;var uu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;Object(I.a)(this,e),this.name="",this.color=new ja(t),this.near=n,this.far=r}return Object(C.a)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();uu.prototype.isFog=!0;var cu=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Object(h.a)(e)})),e}return Object(C.a)(n,[{key:"copy",value:function(e,t){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(pa);function lu(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Ln,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=tr.generateUUID()}cu.prototype.isScene=!0,Object.defineProperty(lu.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(lu.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,a=this.stride;r<a;r++)this.array[e+r]=t.array[n+r];return this},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tr.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new lu(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tr.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var gu=new hr;function du(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}Object.defineProperties(du.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(du.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)gu.x=this.getX(t),gu.y=this.getY(t),gu.z=this.getZ(t),gu.applyMatrix4(e),this.setXYZ(t,gu.x,gu.y,gu.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)gu.x=this.getX(t),gu.y=this.getY(t),gu.z=this.getZ(t),gu.applyNormalMatrix(e),this.setXYZ(t,gu.x,gu.y,gu.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)gu.x=this.getX(t),gu.y=this.getY(t),gu.z=this.getZ(t),gu.transformDirection(e),this.setXYZ(t,gu.x,gu.y,gu.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,a){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=a,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,a=0;a<this.itemSize;a++)t.push(this.data.array[r+a]);return new Ya(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new du(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,a=0;a<this.itemSize;a++)t.push(this.data.array[r+a]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});var hu,fu=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new ja(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Oa);fu.prototype.isSpriteMaterial=!0;var pu=new hr,Iu=new hr,Cu=new hr,mu=new nr,bu=new nr,vu=new zr,Au=new hr,yu=new hr,wu=new hr,Gu=new nr,Bu=new nr,xu=new nr,Su=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;if(Object(I.a)(this,n),(r=t.call(this)).type="Sprite",void 0===hu){hu=new li;var a=new lu(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);hu.setIndex([0,1,2,0,2,3]),hu.setAttribute("position",new du(a,3,0,!1)),hu.setAttribute("uv",new du(a,2,3,!1))}return r.geometry=hu,r.material=void 0!==e?e:new fu,r.center=new nr(.5,.5),r}return Object(C.a)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Iu.setFromMatrixScale(this.matrixWorld),vu.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Cu.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Iu.multiplyScalar(-Cu.z);var n,r,a=this.material.rotation;0!==a&&(r=Math.cos(a),n=Math.sin(a));var i=this.center;ku(Au.set(-.5,-.5,0),Cu,i,Iu,n,r),ku(yu.set(.5,-.5,0),Cu,i,Iu,n,r),ku(wu.set(.5,.5,0),Cu,i,Iu,n,r),Gu.set(0,0),Bu.set(1,0),xu.set(1,1);var o=e.ray.intersectTriangle(Au,yu,wu,!1,pu);if(null!==o||(ku(yu.set(-.5,.5,0),Cu,i,Iu,n,r),Bu.set(0,1),null!==(o=e.ray.intersectTriangle(Au,wu,yu,!1,pu)))){var s=e.ray.origin.distanceTo(pu);s<e.near||s>e.far||t.push({distance:s,point:pu.clone(),uv:Ra.getUV(pu,Au,yu,wu,Gu,Bu,xu,new nr),face:null,object:this})}}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(pa);function ku(e,t,n,r,a,i){mu.subVectors(e,n).addScalar(.5).multiply(r),void 0!==a?(bu.x=i*mu.x-a*mu.y,bu.y=a*mu.x+i*mu.y):bu.copy(mu),e.copy(t),e.x+=bu.x,e.y+=bu.y,e.applyMatrix4(vu)}Su.prototype.isSprite=!0;var Zu=new hr,Ru=new hr,Nu=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties(Object(h.a)(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return Object(C.a)(n,[{key:"copy",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,a=t.length;r<a;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){Zu.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Zu);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){Zu.setFromMatrixPosition(e.matrixWorld),Ru.setFromMatrixPosition(this.matrixWorld);var n,r,a=Zu.distanceTo(Ru)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&a>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,a=0,i=r.length;a<i;a++){var o=r[a];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}]),n}(pa),Ou=new hr,Wu=new cr,Fu=new cr,Mu=new hr,Vu=new zr;function Tu(e,t){ki.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zr,this.bindMatrixInverse=new zr}function Eu(){pa.call(this),this.type="Bone"}Tu.prototype=Object.assign(Object.create(ki.prototype),{constructor:Tu,isSkinnedMesh:!0,copy:function(e){return ki.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new cr,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){ki.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){var n=this.skeleton,r=this.geometry;Wu.fromBufferAttribute(r.attributes.skinIndex,e),Fu.fromBufferAttribute(r.attributes.skinWeight,e),Ou.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var a=0;a<4;a++){var i=Fu.getComponent(a);if(0!==i){var o=Wu.getComponent(a);Vu.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Mu.copy(Ou).applyMatrix4(Vu),i)}}return t.applyMatrix4(this.bindMatrixInverse)}}),Eu.prototype=Object.assign(Object.create(pa.prototype),{constructor:Eu,isBone:!0});var ju=new zr,Lu=new zr,Xu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(I.a)(this,e),this.uuid=tr.generateUUID(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return Object(C.a)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new zr)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new zr;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,a=this.bones.length;r<a;r++){var i=this.bones[r];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,a=0,i=e.length;a<i;a++){var o=e[a]?e[a].matrixWorld:Lu;ju.multiplyMatrices(o,t[a]),ju.toArray(n,16*a)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var a=e.bones[n],i=t[a];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),i=new Eu),this.bones.push(i),this.boneInverses.push((new zr).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,a=t.length;r<a;r++){var i=t[r];e.bones.push(i.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),Hu=new zr,Yu=new zr,zu=[],Ku=new ki;function _u(e,t,n){ki.call(this,e,t),this.instanceMatrix=new Ya(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}_u.prototype=Object.assign(Object.create(ki.prototype),{constructor:_u,isInstancedMesh:!0,copy:function(e){return ki.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Ku.geometry=this.geometry,Ku.material=this.material,void 0!==Ku.material)for(var a=0;a<r;a++){this.getMatrixAt(a,Hu),Yu.multiplyMatrices(n,Hu),Ku.matrixWorld=Yu,Ku.raycast(e,zu);for(var i=0,o=zu.length;i<o;i++){var s=zu[i];s.instanceId=a,s.object=this,t.push(s)}zu.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new Ya(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Du=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new ja(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.morphTargets=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}]),n}(Oa);Du.prototype.isLineBasicMaterial=!0;var Pu=new hr,Uu=new hr,Ju=new zr,Qu=new Yr,qu=new Mr;function $u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new li,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Du;pa.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}$u.prototype=Object.assign(Object.create(pa.prototype),{constructor:$u,isLine:!0,copy:function(e){return pa.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,a=t.count;r<a;r++)Pu.fromBufferAttribute(t,r-1),Uu.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Pu.distanceTo(Uu);e.setAttribute("lineDistance",new qa(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,a=e.params.Line.threshold,i=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qu.copy(n.boundingSphere),qu.applyMatrix4(r),qu.radius+=a,!1!==e.ray.intersectsSphere(qu)){Ju.copy(r).invert(),Qu.copy(e.ray).applyMatrix4(Ju);var o=a/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,u=new hr,c=new hr,l=new hr,g=new hr,d=this.isLineSegments?2:1;if(n.isBufferGeometry){var h=n.index,f=n.attributes.position;if(null!==h)for(var p=Math.max(0,i.start),I=Math.min(h.count,i.start+i.count)-1;p<I;p+=d){var C=h.getX(p),m=h.getX(p+1);if(u.fromBufferAttribute(f,C),c.fromBufferAttribute(f,m),!(Qu.distanceSqToSegment(u,c,g,l)>s)){g.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(g);b<e.near||b>e.far||t.push({distance:b,point:l.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}else for(var v=Math.max(0,i.start),A=Math.min(f.count,i.start+i.count)-1;v<A;v+=d){if(u.fromBufferAttribute(f,v),c.fromBufferAttribute(f,v+1),!(Qu.distanceSqToSegment(u,c,g,l)>s)){g.applyMatrix4(this.matrixWorld);var y=e.ray.origin.distanceTo(g);y<e.near||y>e.far||t.push({distance:y,point:l.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var ec=new hr,tc=new hr;function nc(e,t){$u.call(this,e,t),this.type="LineSegments"}nc.prototype=Object.assign(Object.create($u.prototype),{constructor:nc,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,a=t.count;r<a;r+=2)ec.fromBufferAttribute(t,r),tc.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+ec.distanceTo(tc);e.setAttribute("lineDistance",new qa(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});var rc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(I.a)(this,n),(a=t.call(this,e,r)).type="LineLoop",a}return n}($u);rc.prototype.isLineLoop=!0;var ac=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new ja(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.morphTargets=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}]),n}(Oa);ac.prototype.isPointsMaterial=!0;var ic=new zr,oc=new Yr,sc=new Mr,uc=new hr;function cc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new li,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ac;pa.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function lc(e,t,n,r,a,i,o){var s=oc.distanceSqToPoint(e);if(s<n){var u=new hr;oc.closestPointToPoint(e,u),u.applyMatrix4(r);var c=a.ray.origin.distanceTo(u);if(c<a.near||c>a.far)return;i.push({distance:c,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:o})}}cc.prototype=Object.assign(Object.create(pa.prototype),{constructor:cc,isPoints:!0,copy:function(e){return pa.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,a=e.params.Points.threshold,i=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),sc.copy(n.boundingSphere),sc.applyMatrix4(r),sc.radius+=a,!1!==e.ray.intersectsSphere(sc)){ic.copy(r).invert(),oc.copy(e.ray).applyMatrix4(ic);var o=a/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){var u=n.index,c=n.attributes.position;if(null!==u)for(var l=Math.max(0,i.start),g=Math.min(u.count,i.start+i.count);l<g;l++){var d=u.getX(l);uc.fromBufferAttribute(c,d),lc(uc,d,s,r,e,t,this)}else for(var h=Math.max(0,i.start),f=Math.min(c.count,i.start+i.count);h<f;h++)uc.fromBufferAttribute(c,h),lc(uc,h,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var gc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s,u,c,l){var g;Object(I.a)(this,n),(g=t.call(this,e,r,a,i,o,s,u,c,l)).format=void 0!==u?u:qe,g.minFilter=void 0!==s?s:Fe,g.magFilter=void 0!==o?o:Fe,g.generateMipmaps=!1;var d=Object(h.a)(g);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){d.needsUpdate=!0,e.requestVideoFrameCallback(t)})),g}return Object(C.a)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(sr);gc.prototype.isVideoTexture=!0;var dc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s,u,c,l,g,d,h){var f;return Object(I.a)(this,n),(f=t.call(this,null,s,u,c,l,g,i,o,d,h)).image={width:r,height:a},f.mipmaps=e,f.flipY=!1,f.generateMipmaps=!1,f}return n}(sr);dc.prototype.isCompressedTexture=!0;var hc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s,u,c,l){var g;return Object(I.a)(this,n),(g=t.call(this,e,r,a,i,o,s,u,c,l)).needsUpdate=!0,g}return n}(sr);hc.prototype.isCanvasTexture=!0;var fc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s,u,c,l,g){var d;if(Object(I.a)(this,n),(g=void 0!==g?g:rt)!==rt&&g!==at)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===a&&g===rt&&(a=He),void 0===a&&g===at&&(a=Je),(d=t.call(this,null,i,o,s,u,c,g,a,l)).image={width:e,height:r},d.magFilter=void 0!==u?u:Ze,d.minFilter=void 0!==c?c:Ze,d.flipY=!1,d.generateMipmaps=!1,d}return n}(sr);fc.prototype.isDepthTexture=!0;var pc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;Object(I.a)(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:a,thetaStart:i,thetaLength:o},a=Math.max(3,a);var s=[],u=[],c=[],l=[],g=new hr,d=new nr;u.push(0,0,0),c.push(0,0,1),l.push(.5,.5);for(var h=0,f=3;h<=a;h++,f+=3){var p=i+h/a*o;g.x=r*Math.cos(p),g.y=r*Math.sin(p),u.push(g.x,g.y,g.z),c.push(0,0,1),d.x=(u[f]/r+1)/2,d.y=(u[f+1]/r+1)/2,l.push(d.x,d.y)}for(var C=1;C<=a;C++)s.push(C,C+1,0);return e.setIndex(s),e.setAttribute("position",new qa(u,3)),e.setAttribute("normal",new qa(c,3)),e.setAttribute("uv",new qa(l,2)),e}return n}(li),Ic=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;Object(I.a)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:a,height:i,radialSegments:o,heightSegments:s,openEnded:u,thetaStart:c,thetaLength:l};var g=Object(h.a)(e);o=Math.floor(o),s=Math.floor(s);var d=[],f=[],p=[],C=[],m=0,b=[],v=i/2,A=0;function y(){for(var e=new hr,t=new hr,n=0,u=(a-r)/i,h=0;h<=s;h++){for(var I=[],y=h/s,w=y*(a-r)+r,G=0;G<=o;G++){var B=G/o,x=B*l+c,S=Math.sin(x),k=Math.cos(x);t.x=w*S,t.y=-y*i+v,t.z=w*k,f.push(t.x,t.y,t.z),e.set(S,u,k).normalize(),p.push(e.x,e.y,e.z),C.push(B,1-y),I.push(m++)}b.push(I)}for(var Z=0;Z<o;Z++)for(var R=0;R<s;R++){var N=b[R][Z],O=b[R+1][Z],W=b[R+1][Z+1],F=b[R][Z+1];d.push(N,O,F),d.push(O,W,F),n+=6}g.addGroup(A,n,0),A+=n}function w(e){for(var t=m,n=new nr,i=new hr,s=0,u=!0===e?r:a,h=!0===e?1:-1,I=1;I<=o;I++)f.push(0,v*h,0),p.push(0,h,0),C.push(.5,.5),m++;for(var b=m,y=0;y<=o;y++){var w=y/o*l+c,G=Math.cos(w),B=Math.sin(w);i.x=u*B,i.y=v*h,i.z=u*G,f.push(i.x,i.y,i.z),p.push(0,h,0),n.x=.5*G+.5,n.y=.5*B*h+.5,C.push(n.x,n.y),m++}for(var x=0;x<o;x++){var S=t+x,k=b+x;!0===e?d.push(k,k+1,S):d.push(k+1,k,S),s+=3}g.addGroup(A,s,!0===e?1:2),A+=s}return y(),!1===u&&(r>0&&w(!0),a>0&&w(!1)),e.setIndex(d),e.setAttribute("position",new qa(f,3)),e.setAttribute("normal",new qa(p,3)),e.setAttribute("uv",new qa(C,2)),e}return n}(li),Cc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return Object(I.a)(this,n),(e=t.call(this,0,r,a,i,o,s,u,c)).type="ConeGeometry",e.parameters={radius:r,height:a,radialSegments:i,heightSegments:o,openEnded:s,thetaStart:u,thetaLength:c},e}return n}(Ic),mc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(I.a)(this,n),(a=t.call(this)).type="PolyhedronGeometry",a.parameters={vertices:e,indices:r,radius:i,detail:o};var s=[],u=[];function c(e){for(var t=new hr,n=new hr,a=new hr,i=0;i<r.length;i+=3)p(r[i+0],t),p(r[i+1],n),p(r[i+2],a),l(t,n,a,e)}function l(e,t,n,r){for(var a=r+1,i=[],o=0;o<=a;o++){i[o]=[];for(var s=e.clone().lerp(n,o/a),u=t.clone().lerp(n,o/a),c=a-o,l=0;l<=c;l++)i[o][l]=0===l&&o===a?s:s.clone().lerp(u,l/c)}for(var g=0;g<a;g++)for(var d=0;d<2*(a-g)-1;d++){var h=Math.floor(d/2);d%2===0?(f(i[g][h+1]),f(i[g+1][h]),f(i[g][h])):(f(i[g][h+1]),f(i[g+1][h+1]),f(i[g+1][h]))}}function g(e){for(var t=new hr,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}function d(){for(var e=new hr,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=b(e)/2/Math.PI+.5,r=v(e)/Math.PI+.5;u.push(n,1-r)}C(),h()}function h(){for(var e=0;e<u.length;e+=6){var t=u[e+0],n=u[e+2],r=u[e+4],a=Math.max(t,n,r),i=Math.min(t,n,r);a>.9&&i<.1&&(t<.2&&(u[e+0]+=1),n<.2&&(u[e+2]+=1),r<.2&&(u[e+4]+=1))}}function f(e){s.push(e.x,e.y,e.z)}function p(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function C(){for(var e=new hr,t=new hr,n=new hr,r=new hr,a=new nr,i=new nr,o=new nr,c=0,l=0;c<s.length;c+=9,l+=6){e.set(s[c+0],s[c+1],s[c+2]),t.set(s[c+3],s[c+4],s[c+5]),n.set(s[c+6],s[c+7],s[c+8]),a.set(u[l+0],u[l+1]),i.set(u[l+2],u[l+3]),o.set(u[l+4],u[l+5]),r.copy(e).add(t).add(n).divideScalar(3);var g=b(r);m(a,l+0,e,g),m(i,l+2,t,g),m(o,l+4,n,g)}}function m(e,t,n,r){r<0&&1===e.x&&(u[t]=e.x-1),0===n.x&&0===n.z&&(u[t]=r/2/Math.PI+.5)}function b(e){return Math.atan2(e.z,-e.x)}function v(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return c(o),g(i),d(),a.setAttribute("position",new qa(s,3)),a.setAttribute("normal",new qa(s.slice(),3)),a.setAttribute("uv",new qa(u,2)),0===o?a.computeVertexNormals():a.normalizeNormals(),a}return n}(li),bc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,n);var i=(1+Math.sqrt(5))/2,o=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-i,0,-o,i,0,o,-i,0,o,i,-o,-i,0,-o,i,0,o,-i,0,o,i,0,-i,0,-o,i,0,-o,-i,0,o,i,0,o],u=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return(e=t.call(this,s,u,r,a)).type="DodecahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(mc),vc=new hr,Ac=new hr,yc=new hr,wc=new Ra,Gc=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;if(Object(I.a)(this,n),(a=t.call(this)).type="EdgesGeometry",a.parameters={thresholdAngle:r},r=void 0!==r?r:1,!0===e.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Object(l.a)(a);for(var i=Math.pow(10,4),o=Math.cos(tr.DEG2RAD*r),s=e.getIndex(),u=e.getAttribute("position"),c=s?s.count:u.count,g=[0,0,0],d=["a","b","c"],h=new Array(3),f={},p=[],C=0;C<c;C+=3){s?(g[0]=s.getX(C),g[1]=s.getX(C+1),g[2]=s.getX(C+2)):(g[0]=C,g[1]=C+1,g[2]=C+2);var m=wc.a,b=wc.b,v=wc.c;if(m.fromBufferAttribute(u,g[0]),b.fromBufferAttribute(u,g[1]),v.fromBufferAttribute(u,g[2]),wc.getNormal(yc),h[0]="".concat(Math.round(m.x*i),",").concat(Math.round(m.y*i),",").concat(Math.round(m.z*i)),h[1]="".concat(Math.round(b.x*i),",").concat(Math.round(b.y*i),",").concat(Math.round(b.z*i)),h[2]="".concat(Math.round(v.x*i),",").concat(Math.round(v.y*i),",").concat(Math.round(v.z*i)),h[0]!==h[1]&&h[1]!==h[2]&&h[2]!==h[0])for(var A=0;A<3;A++){var y=(A+1)%3,w=h[A],G=h[y],B=wc[d[A]],x=wc[d[y]],S="".concat(w,"_").concat(G),k="".concat(G,"_").concat(w);k in f&&f[k]?(yc.dot(f[k].normal)<=o&&(p.push(B.x,B.y,B.z),p.push(x.x,x.y,x.z)),f[k]=null):S in f||(f[S]={index0:g[A],index1:g[y],normal:yc.clone()})}}for(var Z in f)if(f[Z]){var R=f[Z],N=R.index0,O=R.index1;vc.fromBufferAttribute(u,N),Ac.fromBufferAttribute(u,O),p.push(vc.x,vc.y,vc.z),p.push(Ac.x,Ac.y,Ac.z)}return a.setAttribute("position",new qa(p,3)),a}return n}(li),Bc=function(e,t,n){n=n||2;var r,a,i,o,s,u,c,l=t&&t.length,g=l?t[0]*n:e.length,d=xc(e,0,g,n,!0),h=[];if(!d||d.next===d.prev)return h;if(l&&(d=function(e,t,n,r){var a,i,o,s=[];for(a=0,i=t.length;a<i;a++)(o=xc(e,t[a]*r,a<i-1?t[a+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(Tc(o));for(s.sort(Wc),a=0;a<s.length;a++)Fc(s[a],n),n=Sc(n,n.next);return n}(e,t,d,n)),e.length>80*n){r=i=e[0],a=o=e[1];for(var f=n;f<g;f+=n)(s=e[f])<r&&(r=s),(u=e[f+1])<a&&(a=u),s>i&&(i=s),u>o&&(o=u);c=0!==(c=Math.max(i-r,o-a))?1/c:0}return kc(d,h,n,r,a,c),h};function xc(e,t,n,r,a){var i,o;if(a===function(e,t,n,r){for(var a=0,i=t,o=n-r;i<n;i+=r)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}(e,t,n,r)>0)for(i=t;i<n;i+=r)o=Dc(i,e[i],e[i+1],o);else for(i=n-r;i>=t;i-=r)o=Dc(i,e[i],e[i+1],o);return o&&Xc(o,o.next)&&(Pc(o),o=o.next),o}function Sc(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Xc(r,r.next)&&0!==Lc(r.prev,r,r.next))r=r.next;else{if(Pc(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function kc(e,t,n,r,a,i,o){if(e){!o&&i&&function(e,t,n,r){var a=e;do{null===a.z&&(a.z=Vc(a.x,a.y,t,n,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,n,r,a,i,o,s,u,c=1;do{for(n=e,e=null,i=null,o=0;n;){for(o++,r=n,s=0,t=0;t<c&&(s++,r=r.nextZ);t++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(a=n,n=n.nextZ,s--):(a=r,r=r.nextZ,u--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;n=r}i.nextZ=null,c*=2}while(o>1)}(a)}(e,r,a,i);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,i?Rc(e,r,a,i):Zc(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),Pc(e),e=u.next,c=u.next;else if((e=u)===c){o?1===o?kc(e=Nc(Sc(e),t,n),t,n,r,a,i,2):2===o&&Oc(e,t,n,r,a,i):kc(Sc(e),t,n,r,a,i,1);break}}}function Zc(e){var t=e.prev,n=e,r=e.next;if(Lc(t,n,r)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(Ec(t.x,t.y,n.x,n.y,r.x,r.y,a.x,a.y)&&Lc(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function Rc(e,t,n,r){var a=e.prev,i=e,o=e.next;if(Lc(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,u=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,c=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,l=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,g=Vc(s,u,t,n,r),d=Vc(c,l,t,n,r),h=e.prevZ,f=e.nextZ;h&&h.z>=g&&f&&f.z<=d;){if(h!==e.prev&&h!==e.next&&Ec(a.x,a.y,i.x,i.y,o.x,o.y,h.x,h.y)&&Lc(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,f!==e.prev&&f!==e.next&&Ec(a.x,a.y,i.x,i.y,o.x,o.y,f.x,f.y)&&Lc(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;h&&h.z>=g;){if(h!==e.prev&&h!==e.next&&Ec(a.x,a.y,i.x,i.y,o.x,o.y,h.x,h.y)&&Lc(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&Ec(a.x,a.y,i.x,i.y,o.x,o.y,f.x,f.y)&&Lc(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Nc(e,t,n){var r=e;do{var a=r.prev,i=r.next.next;!Xc(a,i)&&Hc(a,r,r.next,i)&&Kc(a,i)&&Kc(i,a)&&(t.push(a.i/n),t.push(r.i/n),t.push(i.i/n),Pc(r),Pc(r.next),r=e=i),r=r.next}while(r!==e);return Sc(r)}function Oc(e,t,n,r,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&jc(o,s)){var u=_c(o,s);return o=Sc(o,o.next),u=Sc(u,u.next),kc(o,t,n,r,a,i),void kc(u,t,n,r,a,i)}s=s.next}o=o.next}while(o!==e)}function Wc(e,t){return e.x-t.x}function Fc(e,t){if(t=function(e,t){var n,r=t,a=e.x,i=e.y,o=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>o){if(o=s,s===a){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(a===o)return n;var u,c=n,l=n.x,g=n.y,d=1/0;r=n;do{a>=r.x&&r.x>=l&&a!==r.x&&Ec(i<g?a:o,i,l,g,i<g?o:a,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(a-r.x),Kc(r,e)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&Mc(n,r)))&&(n=r,d=u)),r=r.next}while(r!==c);return n}(e,t)){var n=_c(t,e);Sc(t,t.next),Sc(n,n.next)}}function Mc(e,t){return Lc(e.prev,e,t.prev)<0&&Lc(t.next,e,e.next)<0}function Vc(e,t,n,r,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Tc(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Ec(e,t,n,r,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(i-s)-(a-o)*(r-s)>=0}function jc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Hc(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Kc(e,t)&&Kc(t,e)&&function(e,t){var n=e,r=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!==n.next.y>i&&n.next.y!==n.y&&a<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Lc(e.prev,e,t.prev)||Lc(e,t.prev,t))||Xc(e,t)&&Lc(e.prev,e,e.next)>0&&Lc(t.prev,t,t.next)>0)}function Lc(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Xc(e,t){return e.x===t.x&&e.y===t.y}function Hc(e,t,n,r){var a=zc(Lc(e,t,n)),i=zc(Lc(e,t,r)),o=zc(Lc(n,r,e)),s=zc(Lc(n,r,t));return a!==i&&o!==s||(!(0!==a||!Yc(e,n,t))||(!(0!==i||!Yc(e,r,t))||(!(0!==o||!Yc(n,e,r))||!(0!==s||!Yc(n,t,r)))))}function Yc(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function zc(e){return e>0?1:e<0?-1:0}function Kc(e,t){return Lc(e.prev,e,e.next)<0?Lc(e,t,e.next)>=0&&Lc(e,e.prev,t)>=0:Lc(e,t,e.prev)<0||Lc(e,e.next,t)<0}function _c(e,t){var n=new Uc(e.i,e.x,e.y),r=new Uc(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=a,a.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Dc(e,t,n,r){var a=new Uc(e,t,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function Pc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Uc(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Jc={area:function(e){for(var t=e.length,n=0,r=t-1,a=0;a<t;r=a++)n+=e[r].x*e[a].y-e[a].x*e[r].y;return.5*n},isClockWise:function(e){return Jc.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],a=[];Qc(e),qc(n,e);var i=e.length;t.forEach(Qc);for(var o=0;o<t.length;o++)r.push(i),i+=t[o].length,qc(n,t[o]);for(var s=Bc(n,r),u=0;u<s.length;u+=3)a.push(s.slice(u,u+3));return a}};function Qc(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function qc(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var $c=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;Object(I.a)(this,n),(a=t.call(this)).type="ExtrudeGeometry",a.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];for(var i=Object(h.a)(a),o=[],s=[],u=0,c=e.length;u<c;u++){l(e[u])}function l(e){var t=[],n=void 0!==r.curveSegments?r.curveSegments:12,a=void 0!==r.steps?r.steps:1,u=void 0!==r.depth?r.depth:100,c=void 0===r.bevelEnabled||r.bevelEnabled,l=void 0!==r.bevelThickness?r.bevelThickness:6,g=void 0!==r.bevelSize?r.bevelSize:l-2,d=void 0!==r.bevelOffset?r.bevelOffset:0,h=void 0!==r.bevelSegments?r.bevelSegments:3,f=r.extrudePath,p=void 0!==r.UVGenerator?r.UVGenerator:el;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=r.amount);var I,C,m,b,v,A=!1;f&&(I=f.getSpacedPoints(a),A=!0,c=!1,C=f.computeFrenetFrames(a,!1),m=new hr,b=new hr,v=new hr),c||(h=0,l=0,g=0,d=0);var y=e.extractPoints(n),w=y.shape,G=y.holes;if(!Jc.isClockWise(w)){w=w.reverse();for(var B=0,x=G.length;B<x;B++){var S=G[B];Jc.isClockWise(S)&&(G[B]=S.reverse())}}for(var k=Jc.triangulateShape(w,G),Z=w,R=0,N=G.length;R<N;R++){var O=G[R];w=w.concat(O)}function W(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var F=w.length,M=k.length;function V(e,t,n){var r,a,i,o=e.x-t.x,s=e.y-t.y,u=n.x-e.x,c=n.y-e.y,l=o*o+s*s,g=o*c-s*u;if(Math.abs(g)>Number.EPSILON){var d=Math.sqrt(l),h=Math.sqrt(u*u+c*c),f=t.x-s/d,p=t.y+o/d,I=((n.x-c/h-f)*c-(n.y+u/h-p)*u)/(o*c-s*u),C=(r=f+o*I-e.x)*r+(a=p+s*I-e.y)*a;if(C<=2)return new nr(r,a);i=Math.sqrt(C/2)}else{var m=!1;o>Number.EPSILON?u>Number.EPSILON&&(m=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(m=!0):Math.sign(s)===Math.sign(c)&&(m=!0),m?(r=-s,a=o,i=Math.sqrt(l)):(r=o,a=s,i=Math.sqrt(l/2))}return new nr(r/i,a/i)}for(var T=[],E=0,j=Z.length,L=j-1,X=E+1;E<j;E++,L++,X++)L===j&&(L=0),X===j&&(X=0),T[E]=V(Z[E],Z[L],Z[X]);for(var H,Y=[],z=T.concat(),K=0,_=G.length;K<_;K++){var D=G[K];H=[];for(var P=0,U=D.length,J=U-1,Q=P+1;P<U;P++,J++,Q++)J===U&&(J=0),Q===U&&(Q=0),H[P]=V(D[P],D[J],D[Q]);Y.push(H),z=z.concat(H)}for(var q=0;q<h;q++){for(var $=q/h,ee=l*Math.cos($*Math.PI/2),te=g*Math.sin($*Math.PI/2)+d,ne=0,re=Z.length;ne<re;ne++){var ae=W(Z[ne],T[ne],te);Ne(ae.x,ae.y,-ee)}for(var ie=0,oe=G.length;ie<oe;ie++){var se=G[ie];H=Y[ie];for(var ue=0,ce=se.length;ue<ce;ue++){var le=W(se[ue],H[ue],te);Ne(le.x,le.y,-ee)}}}for(var ge=g+d,de=0;de<F;de++){var he=c?W(w[de],z[de],ge):w[de];A?(b.copy(C.normals[0]).multiplyScalar(he.x),m.copy(C.binormals[0]).multiplyScalar(he.y),v.copy(I[0]).add(b).add(m),Ne(v.x,v.y,v.z)):Ne(he.x,he.y,0)}for(var fe=1;fe<=a;fe++)for(var pe=0;pe<F;pe++){var Ie=c?W(w[pe],z[pe],ge):w[pe];A?(b.copy(C.normals[fe]).multiplyScalar(Ie.x),m.copy(C.binormals[fe]).multiplyScalar(Ie.y),v.copy(I[fe]).add(b).add(m),Ne(v.x,v.y,v.z)):Ne(Ie.x,Ie.y,u/a*fe)}for(var Ce=h-1;Ce>=0;Ce--){for(var me=Ce/h,be=l*Math.cos(me*Math.PI/2),ve=g*Math.sin(me*Math.PI/2)+d,Ae=0,ye=Z.length;Ae<ye;Ae++){var we=W(Z[Ae],T[Ae],ve);Ne(we.x,we.y,u+be)}for(var Ge=0,Be=G.length;Ge<Be;Ge++){var xe=G[Ge];H=Y[Ge];for(var Se=0,ke=xe.length;Se<ke;Se++){var Ze=W(xe[Se],H[Se],ve);A?Ne(Ze.x,Ze.y+I[a-1].y,I[a-1].x+be):Ne(Ze.x,Ze.y,u+be)}}}function Re(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var o=0,s=a+2*h;o<s;o++){var u=F*o,c=F*(o+1);We(t+r+u,t+i+u,t+i+c,t+r+c)}}}function Ne(e,n,r){t.push(e),t.push(n),t.push(r)}function Oe(e,t,n){Fe(e),Fe(t),Fe(n);var r=o.length/3,a=p.generateTopUV(i,o,r-3,r-2,r-1);Me(a[0]),Me(a[1]),Me(a[2])}function We(e,t,n,r){Fe(e),Fe(t),Fe(r),Fe(t),Fe(n),Fe(r);var a=o.length/3,s=p.generateSideWallUV(i,o,a-6,a-3,a-2,a-1);Me(s[0]),Me(s[1]),Me(s[3]),Me(s[1]),Me(s[2]),Me(s[3])}function Fe(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function Me(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(c){for(var t=0,n=F*t,r=0;r<M;r++){var s=k[r];Oe(s[2]+n,s[1]+n,s[0]+n)}n=F*(t=a+2*h);for(var u=0;u<M;u++){var l=k[u];Oe(l[0]+n,l[1]+n,l[2]+n)}}else{for(var g=0;g<M;g++){var d=k[g];Oe(d[2],d[1],d[0])}for(var f=0;f<M;f++){var p=k[f];Oe(p[0]+F*a,p[1]+F*a,p[2]+F*a)}}i.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;Re(Z,t),t+=Z.length;for(var n=0,r=G.length;n<r;n++){var a=G[n];Re(a,t),t+=a.length}i.addGroup(e,o.length/3-e,1)}()}return a.setAttribute("position",new qa(o,3)),a.setAttribute("uv",new qa(s,2)),a.computeVertexNormals(),a}return Object(C.a)(n,[{key:"toJSON",value:function(){var e=li.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,a=e.length;r<a;r++){var i=e[r];n.shapes.push(i.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}}]),n}(li),el={generateTopUV:function(e,t,n,r,a){var i=t[3*n],o=t[3*n+1],s=t[3*r],u=t[3*r+1],c=t[3*a],l=t[3*a+1];return[new nr(i,o),new nr(s,u),new nr(c,l)]},generateSideWallUV:function(e,t,n,r,a,i){var o=t[3*n],s=t[3*n+1],u=t[3*n+2],c=t[3*r],l=t[3*r+1],g=t[3*r+2],d=t[3*a],h=t[3*a+1],f=t[3*a+2],p=t[3*i],I=t[3*i+1],C=t[3*i+2];return Math.abs(s-l)<.01?[new nr(o,1-u),new nr(c,1-g),new nr(d,1-f),new nr(p,1-C)]:[new nr(s,1-u),new nr(l,1-g),new nr(h,1-f),new nr(I,1-C)]}};var tl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,n);var i=(1+Math.sqrt(5))/2,o=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return(e=t.call(this,o,s,r,a)).type="IcosahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(mc),nl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;Object(I.a)(this,n),(r=t.call(this)).type="LatheGeometry",r.parameters={points:e,segments:a,phiStart:i,phiLength:o},a=Math.floor(a),o=tr.clamp(o,0,2*Math.PI);for(var s=[],u=[],c=[],l=1/a,g=new hr,d=new nr,h=0;h<=a;h++)for(var f=i+h*l*o,p=Math.sin(f),C=Math.cos(f),m=0;m<=e.length-1;m++)g.x=e[m].x*p,g.y=e[m].y,g.z=e[m].x*C,u.push(g.x,g.y,g.z),d.x=h/a,d.y=m/(e.length-1),c.push(d.x,d.y);for(var b=0;b<a;b++)for(var v=0;v<e.length-1;v++){var A=v+b*e.length,y=A,w=A+e.length,G=A+e.length+1,B=A+1;s.push(y,w,B),s.push(w,G,B)}if(r.setIndex(s),r.setAttribute("position",new qa(u,3)),r.setAttribute("uv",new qa(c,2)),r.computeVertexNormals(),o===2*Math.PI)for(var x=r.attributes.normal.array,S=new hr,k=new hr,Z=new hr,R=a*e.length*3,N=0,O=0;N<e.length;N++,O+=3)S.x=x[O+0],S.y=x[O+1],S.z=x[O+2],k.x=x[R+O+0],k.y=x[R+O+1],k.z=x[R+O+2],Z.addVectors(S,k).normalize(),x[O+0]=x[R+O+0]=Z.x,x[O+1]=x[R+O+1]=Z.y,x[O+2]=x[R+O+2]=Z.z;return r}return n}(li),rl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,n);var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=t.call(this,i,o,r,a)).type="OctahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(mc);function al(e,t,n){li.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],a=[],i=[],o=[],s=1e-5,u=new hr,c=new hr,l=new hr,g=new hr,d=new hr;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var h=t+1,f=0;f<=n;f++)for(var p=f/n,I=0;I<=t;I++){var C=I/t;e(C,p,c),a.push(c.x,c.y,c.z),C-s>=0?(e(C-s,p,l),g.subVectors(c,l)):(e(C+s,p,l),g.subVectors(l,c)),p-s>=0?(e(C,p-s,l),d.subVectors(c,l)):(e(C,p+s,l),d.subVectors(l,c)),u.crossVectors(g,d).normalize(),i.push(u.x,u.y,u.z),o.push(C,p)}for(var m=0;m<n;m++)for(var b=0;b<t;b++){var v=m*h+b,A=m*h+b+1,y=(m+1)*h+b+1,w=(m+1)*h+b;r.push(v,A,w),r.push(A,y,w)}this.setIndex(r),this.setAttribute("position",new qa(a,3)),this.setAttribute("normal",new qa(i,3)),this.setAttribute("uv",new qa(o,2))}al.prototype=Object.create(li.prototype),al.prototype.constructor=al;var il=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;Object(I.a)(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:a,thetaSegments:i,phiSegments:o,thetaStart:s,thetaLength:u},i=Math.max(3,i);for(var c=[],l=[],g=[],d=[],h=r,f=(a-r)/(o=Math.max(1,o)),p=new hr,C=new nr,m=0;m<=o;m++){for(var b=0;b<=i;b++){var v=s+b/i*u;p.x=h*Math.cos(v),p.y=h*Math.sin(v),l.push(p.x,p.y,p.z),g.push(0,0,1),C.x=(p.x/a+1)/2,C.y=(p.y/a+1)/2,d.push(C.x,C.y)}h+=f}for(var A=0;A<o;A++)for(var y=A*(i+1),w=0;w<i;w++){var G=w+y,B=G,x=G+i+1,S=G+i+2,k=G+1;c.push(B,x,k),c.push(x,S,k)}return e.setIndex(c),e.setAttribute("position",new qa(l,3)),e.setAttribute("normal",new qa(g,3)),e.setAttribute("uv",new qa(d,2)),e}return n}(li),ol=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;Object(I.a)(this,n),(r=t.call(this)).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:a};var i=[],o=[],s=[],u=[],c=0,l=0;if(!1===Array.isArray(e))d(e);else for(var g=0;g<e.length;g++)d(e[g]),r.addGroup(c,l,g),c+=l,l=0;function d(e){var t=o.length/3,n=e.extractPoints(a),r=n.shape,c=n.holes;!1===Jc.isClockWise(r)&&(r=r.reverse());for(var g=0,d=c.length;g<d;g++){var h=c[g];!0===Jc.isClockWise(h)&&(c[g]=h.reverse())}for(var f=Jc.triangulateShape(r,c),p=0,I=c.length;p<I;p++){var C=c[p];r=r.concat(C)}for(var m=0,b=r.length;m<b;m++){var v=r[m];o.push(v.x,v.y,0),s.push(0,0,1),u.push(v.x,v.y)}for(var A=0,y=f.length;A<y;A++){var w=f[A],G=w[0]+t,B=w[1]+t,x=w[2]+t;i.push(G,B,x),l+=3}}return r.setIndex(i),r.setAttribute("position",new qa(o,3)),r.setAttribute("normal",new qa(s,3)),r.setAttribute("uv",new qa(u,2)),r}return Object(C.a)(n,[{key:"toJSON",value:function(){var e=li.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var a=e[n];t.shapes.push(a.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}]),n}(li);var sl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;Object(I.a)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:a,heightSegments:i,phiStart:o,phiLength:s,thetaStart:u,thetaLength:c},a=Math.max(3,Math.floor(a)),i=Math.max(2,Math.floor(i));for(var l=Math.min(u+c,Math.PI),g=0,d=[],h=new hr,f=new hr,p=[],C=[],m=[],b=[],v=0;v<=i;v++){var A=[],y=v/i,w=0;0==v&&0==u?w=.5/a:v==i&&l==Math.PI&&(w=-.5/a);for(var G=0;G<=a;G++){var B=G/a;h.x=-r*Math.cos(o+B*s)*Math.sin(u+y*c),h.y=r*Math.cos(u+y*c),h.z=r*Math.sin(o+B*s)*Math.sin(u+y*c),C.push(h.x,h.y,h.z),f.copy(h).normalize(),m.push(f.x,f.y,f.z),b.push(B+w,1-y),A.push(g++)}d.push(A)}for(var x=0;x<i;x++)for(var S=0;S<a;S++){var k=d[x][S+1],Z=d[x][S],R=d[x+1][S],N=d[x+1][S+1];(0!==x||u>0)&&p.push(k,Z,N),(x!==i-1||l<Math.PI)&&p.push(Z,R,N)}return e.setIndex(p),e.setAttribute("position",new qa(C,3)),e.setAttribute("normal",new qa(m,3)),e.setAttribute("uv",new qa(b,2)),e}return n}(li),ul=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(I.a)(this,n);var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];return(e=t.call(this,i,o,r,a)).type="TetrahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(mc),cl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(I.a)(this,n);var i=a.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),Object(l.a)(r,new li);var o=i.generateShapes(e,a.size);return a.depth=void 0!==a.height?a.height:50,void 0===a.bevelThickness&&(a.bevelThickness=10),void 0===a.bevelSize&&(a.bevelSize=8),void 0===a.bevelEnabled&&(a.bevelEnabled=!1),(r=t.call(this,o,a)).type="TextGeometry",r}return n}($c),ll=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;Object(I.a)(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:a,radialSegments:i,tubularSegments:o,arc:s},i=Math.floor(i),o=Math.floor(o);for(var u=[],c=[],l=[],g=[],d=new hr,h=new hr,f=new hr,p=0;p<=i;p++)for(var C=0;C<=o;C++){var m=C/o*s,b=p/i*Math.PI*2;h.x=(r+a*Math.cos(b))*Math.cos(m),h.y=(r+a*Math.cos(b))*Math.sin(m),h.z=a*Math.sin(b),c.push(h.x,h.y,h.z),d.x=r*Math.cos(m),d.y=r*Math.sin(m),f.subVectors(h,d).normalize(),l.push(f.x,f.y,f.z),g.push(C/o),g.push(p/i)}for(var v=1;v<=i;v++)for(var A=1;A<=o;A++){var y=(o+1)*v+A-1,w=(o+1)*(v-1)+A-1,G=(o+1)*(v-1)+A,B=(o+1)*v+A;u.push(y,w,B),u.push(w,G,B)}return e.setIndex(u),e.setAttribute("position",new qa(c,3)),e.setAttribute("normal",new qa(l,3)),e.setAttribute("uv",new qa(g,2)),e}return n}(li),gl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;Object(I.a)(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:a,tubularSegments:i,radialSegments:o,p:s,q:u},i=Math.floor(i),o=Math.floor(o);for(var c=[],l=[],g=[],d=[],h=new hr,f=new hr,p=new hr,C=new hr,m=new hr,b=new hr,v=new hr,A=0;A<=i;++A){var y=A/i*s*Math.PI*2;W(y,s,u,r,p),W(y+.01,s,u,r,C),b.subVectors(C,p),v.addVectors(C,p),m.crossVectors(b,v),v.crossVectors(m,b),m.normalize(),v.normalize();for(var w=0;w<=o;++w){var G=w/o*Math.PI*2,B=-a*Math.cos(G),x=a*Math.sin(G);h.x=p.x+(B*v.x+x*m.x),h.y=p.y+(B*v.y+x*m.y),h.z=p.z+(B*v.z+x*m.z),l.push(h.x,h.y,h.z),f.subVectors(h,p).normalize(),g.push(f.x,f.y,f.z),d.push(A/i),d.push(w/o)}}for(var S=1;S<=i;S++)for(var k=1;k<=o;k++){var Z=(o+1)*(S-1)+(k-1),R=(o+1)*S+(k-1),N=(o+1)*S+k,O=(o+1)*(S-1)+k;c.push(Z,R,O),c.push(R,N,O)}function W(e,t,n,r,a){var i=Math.cos(e),o=Math.sin(e),s=n/t*e,u=Math.cos(s);a.x=r*(2+u)*.5*i,a.y=r*(2+u)*o*.5,a.z=r*Math.sin(s)*.5}return e.setIndex(c),e.setAttribute("position",new qa(l,3)),e.setAttribute("normal",new qa(g,3)),e.setAttribute("uv",new qa(d,2)),e}return n}(li),dl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(I.a)(this,n),(r=t.call(this)).type="TubeGeometry",r.parameters={path:e,tubularSegments:a,radius:i,radialSegments:o,closed:s};var u=e.computeFrenetFrames(a,s);r.tangents=u.tangents,r.normals=u.normals,r.binormals=u.binormals;var c=new hr,l=new hr,g=new nr,d=new hr,h=[],f=[],p=[],C=[];function m(){for(var e=0;e<a;e++)b(e);b(!1===s?a:0),A(),v()}function b(t){d=e.getPointAt(t/a,d);for(var n=u.normals[t],r=u.binormals[t],s=0;s<=o;s++){var g=s/o*Math.PI*2,p=Math.sin(g),I=-Math.cos(g);l.x=I*n.x+p*r.x,l.y=I*n.y+p*r.y,l.z=I*n.z+p*r.z,l.normalize(),f.push(l.x,l.y,l.z),c.x=d.x+i*l.x,c.y=d.y+i*l.y,c.z=d.z+i*l.z,h.push(c.x,c.y,c.z)}}function v(){for(var e=1;e<=a;e++)for(var t=1;t<=o;t++){var n=(o+1)*(e-1)+(t-1),r=(o+1)*e+(t-1),i=(o+1)*e+t,s=(o+1)*(e-1)+t;C.push(n,r,s),C.push(r,i,s)}}function A(){for(var e=0;e<=a;e++)for(var t=0;t<=o;t++)g.x=e/a,g.y=t/o,p.push(g.x,g.y)}return m(),r.setIndex(C),r.setAttribute("position",new qa(h,3)),r.setAttribute("normal",new qa(f,3)),r.setAttribute("uv",new qa(p,2)),r}return Object(C.a)(n,[{key:"toJSON",value:function(){var e=li.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e}}]),n}(li),hl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;if(Object(I.a)(this,n),(r=t.call(this)).type="WireframeGeometry",!0===e.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Object(l.a)(r);var a=[],i=[0,0],o={},s=new hr;if(null!==e.index){var u=e.attributes.position,c=e.index,g=e.groups;0===g.length&&(g=[{start:0,count:c.count,materialIndex:0}]);for(var d=0,h=g.length;d<h;++d)for(var f=g[d],p=f.start,C=p,m=p+f.count;C<m;C+=3)for(var b=0;b<3;b++){var v=c.getX(C+b),A=c.getX(C+(b+1)%3);i[0]=Math.min(v,A),i[1]=Math.max(v,A);var y=i[0]+","+i[1];void 0===o[y]&&(o[y]={index1:i[0],index2:i[1]})}for(var w in o){var G=o[w];s.fromBufferAttribute(u,G.index1),a.push(s.x,s.y,s.z),s.fromBufferAttribute(u,G.index2),a.push(s.x,s.y,s.z)}}else for(var B=e.attributes.position,x=0,S=B.count/3;x<S;x++)for(var k=0;k<3;k++){var Z=3*x+k;s.fromBufferAttribute(B,Z),a.push(s.x,s.y,s.z);var R=3*x+(k+1)%3;s.fromBufferAttribute(B,R),a.push(s.x,s.y,s.z)}return r.setAttribute("position",new qa(a,3)),r}return n}(li),fl=Object.freeze({__proto__:null,BoxGeometry:Ri,BoxBufferGeometry:Ri,CircleGeometry:pc,CircleBufferGeometry:pc,ConeGeometry:Cc,ConeBufferGeometry:Cc,CylinderGeometry:Ic,CylinderBufferGeometry:Ic,DodecahedronGeometry:bc,DodecahedronBufferGeometry:bc,EdgesGeometry:Gc,ExtrudeGeometry:$c,ExtrudeBufferGeometry:$c,IcosahedronGeometry:tl,IcosahedronBufferGeometry:tl,LatheGeometry:nl,LatheBufferGeometry:nl,OctahedronGeometry:rl,OctahedronBufferGeometry:rl,ParametricGeometry:al,ParametricBufferGeometry:al,PlaneGeometry:Di,PlaneBufferGeometry:Di,PolyhedronGeometry:mc,PolyhedronBufferGeometry:mc,RingGeometry:il,RingBufferGeometry:il,ShapeGeometry:ol,ShapeBufferGeometry:ol,SphereGeometry:sl,SphereBufferGeometry:sl,TetrahedronGeometry:ul,TetrahedronBufferGeometry:ul,TextGeometry:cl,TextBufferGeometry:cl,TorusGeometry:ll,TorusBufferGeometry:ll,TorusKnotGeometry:gl,TorusKnotBufferGeometry:gl,TubeGeometry:dl,TubeBufferGeometry:dl,WireframeGeometry:hl}),pl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new ja(0),r.transparent=!0,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(Oa);pl.prototype.isShadowMaterial=!0;var Il=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return n}(Fi);function Cl(e){Oa.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ja(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ja(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=yn,this.normalScale=new nr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}function ml(e){Cl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new nr(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=tr.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}Il.prototype.isRawShaderMaterial=!0,Cl.prototype=Object.create(Oa.prototype),Cl.prototype.constructor=Cl,Cl.prototype.isMeshStandardMaterial=!0,Cl.prototype.copy=function(e){return Oa.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this},ml.prototype=Object.create(Cl.prototype),ml.prototype.constructor=ml,ml.prototype.isMeshPhysicalMaterial=!0,ml.prototype.copy=function(e){return Cl.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new ja).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};var bl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new ja(16777215),r.specular=new ja(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ja(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=le,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Oa);bl.prototype.isMeshPhongMaterial=!0;var vl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new ja(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ja(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(Oa);vl.prototype.isMeshToonMaterial=!0;var Al=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Oa);Al.prototype.isMeshNormalMaterial=!0;var yl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new ja(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new ja(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=le,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(Oa);yl.prototype.isMeshLambertMaterial=!0;var wl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new ja(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=yn,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Oa);wl.prototype.isMeshMatcapMaterial=!0;var Gl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(Du);Gl.prototype.isLineDashedMaterial=!0;var Bl=Object.freeze({__proto__:null,ShadowMaterial:pl,SpriteMaterial:fu,RawShaderMaterial:Il,ShaderMaterial:Fi,PointsMaterial:ac,MeshPhysicalMaterial:ml,MeshStandardMaterial:Cl,MeshPhongMaterial:bl,MeshToonMaterial:vl,MeshNormalMaterial:Al,MeshLambertMaterial:yl,MeshDepthMaterial:Ps,MeshDistanceMaterial:Us,MeshBasicMaterial:La,MeshMatcapMaterial:wl,LineDashedMaterial:Gl,LineBasicMaterial:Du,Material:Oa}),xl={arraySlice:function(e,t,n){return xl.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,a=new e.constructor(r),i=0,o=0;o!==r;++i)for(var s=n[i]*t,u=0;u!==t;++u)a[o++]=e[s+u];return a},flattenJSON:function(e,t,n,r){for(var a=1,i=e[0];void 0!==i&&void 0===i[r];)i=e[a++];if(void 0!==i){var o=i[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=i[r])&&(t.push(i.time),n.push.apply(n,o)),i=e[a++]}while(void 0!==i);else if(void 0!==o.toArray)do{void 0!==(o=i[r])&&(t.push(i.time),o.toArray(n,n.length)),i=e[a++]}while(void 0!==i);else do{void 0!==(o=i[r])&&(t.push(i.time),n.push(o)),i=e[a++]}while(void 0!==i)}},subclip:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,i=e.clone();i.name=t;for(var o=[],s=0;s<i.tracks.length;++s){for(var u=i.tracks[s],c=u.getValueSize(),l=[],g=[],d=0;d<u.times.length;++d){var h=u.times[d]*a;if(!(h<n||h>=r)){l.push(u.times[d]);for(var f=0;f<c;++f)g.push(u.values[d*c+f])}}0!==l.length&&(u.times=xl.convertArray(l,u.times.constructor),u.values=xl.convertArray(g,u.values.constructor),o.push(u))}i.tracks=o;for(var p=1/0,I=0;I<i.tracks.length;++I)p>i.tracks[I].times[0]&&(p=i.tracks[I].times[0]);for(var C=0;C<i.tracks.length;++C)i.tracks[C].shift(-1*p);return i.resetDuration(),i},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var a=n.tracks.length,i=t/r,o=function(t){var r=n.tracks[t],a=r.ValueTypeName;if("bool"===a||"string"===a)return"continue";var o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===a}));if(void 0===o)return"continue";var s=0,u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=u/3);var c=0,l=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=l/3);var g=r.times.length-1,d=void 0;if(i<=r.times[0]){var h=s,f=u-s;d=xl.arraySlice(r.values,h,f)}else if(i>=r.times[g]){var p=g*u+s,I=p+u-s;d=xl.arraySlice(r.values,p,I)}else{var C=r.createInterpolant(),m=s,b=u-s;C.evaluate(i),d=xl.arraySlice(C.resultBuffer,m,b)}"quaternion"===a&&(new dr).fromArray(d).normalize().conjugate().toArray(d);for(var v=o.times.length,A=0;A<v;++A){var y=A*l+c;if("quaternion"===a)dr.multiplyQuaternionsFlat(o.values,y,d,0,o.values,y);else for(var w=l-2*c,G=0;G<w;++G)o.values[y+G]-=d[G]}},s=0;s<a;++s)o(s);return e.blendMode=un,e}};function Sl(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function kl(e,t,n,r){Sl.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Zl(e,t,n,r){Sl.call(this,e,t,n,r)}function Rl(e,t,n,r){Sl.call(this,e,t,n,r)}Object.assign(Sl.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],a=t[n-1];e:{t:{var i;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<a)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,a)}if(n===o)break;if(a=r,e<(r=t[++n]))break t}i=t.length;break n}if(e>=a)break e;var s=t[1];e<s&&(n=2,a=s);for(var u=n-2;;){if(void 0===a)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===u)break;if(r=a,e>=(a=t[--n-1]))break t}i=n,n=0}for(;n<i;){var c=n+i>>>1;e<t[c]?i=c:n=c+1}if(r=t[n],void 0===(a=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,a,e)}this._cachedIndex=n,this.intervalChanged_(n,a,r)}return this.interpolate_(n,a,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r,i=0;i!==r;++i)t[i]=n[a+i];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Sl.prototype,{beforeStart_:Sl.prototype.copySampleValue_,afterEnd_:Sl.prototype.copySampleValue_}),kl.prototype=Object.assign(Object.create(Sl.prototype),{constructor:kl,DefaultSettings_:{endingStart:rn,endingEnd:rn},intervalChanged_:function(e,t,n){var r=this.parameterPositions,a=e-2,i=e+1,o=r[a],s=r[i];if(void 0===o)switch(this.getSettings_().endingStart){case an:a=e,o=2*t-n;break;case on:o=t+r[a=r.length-2]-r[a+1];break;default:a=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case an:i=e,s=2*n-t;break;case on:i=1,s=n+r[1]-r[0];break;default:i=e-1,s=t}var u=.5*(n-t),c=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=a*c,this._offsetNext=i*c},interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,c=this._offsetPrev,l=this._offsetNext,g=this._weightPrev,d=this._weightNext,h=(n-t)/(r-t),f=h*h,p=f*h,I=-g*p+2*g*f-g*h,C=(1+g)*p+(-1.5-2*g)*f+(-.5+g)*h+1,m=(-1-d)*p+(1.5+d)*f+.5*h,b=d*p-d*f,v=0;v!==o;++v)a[v]=I*i[c+v]+C*i[u+v]+m*i[s+v]+b*i[l+v];return a}}),Zl.prototype=Object.assign(Object.create(Sl.prototype),{constructor:Zl,interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,c=(n-t)/(r-t),l=1-c,g=0;g!==o;++g)a[g]=i[u+g]*l+i[s+g]*c;return a}}),Rl.prototype=Object.assign(Object.create(Sl.prototype),{constructor:Rl,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Nl=function(){function e(t,n,r,a){if(Object(I.a)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=xl.convertArray(n,this.TimeBufferType),this.values=xl.convertArray(r,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}return Object(C.a)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new Rl(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Zl(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new kl(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case en:t=this.InterpolantFactoryMethodDiscrete;break;case tn:t=this.InterpolantFactoryMethodLinear;break;case nn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return en;case this.InterpolantFactoryMethodLinear:return tn;case this.InterpolantFactoryMethodSmooth:return nn}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,a=0,i=r-1;a!==r&&n[a]<e;)++a;for(;-1!==i&&n[i]>t;)--i;if(++i,0!==a||i!==r){a>=i&&(a=(i=Math.max(i,1))-1);var o=this.getValueSize();this.times=xl.arraySlice(n,a,i),this.values=xl.arraySlice(this.values,a*o,i*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,a=n.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var i=null,o=0;o!==a;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==i&&i>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,i),e=!1;break}i=s}if(void 0!==r&&xl.isTypedArray(r))for(var u=0,c=r.length;u!==c;++u){var l=r[u];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,l),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=xl.arraySlice(this.times),t=xl.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===nn,a=e.length-1,i=1,o=1;o<a;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==e[0]))if(r)s=!0;else for(var c=o*n,l=c-n,g=c+n,d=0;d!==n;++d){var h=t[c+d];if(h!==t[l+d]||h!==t[g+d]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];for(var f=o*n,p=i*n,I=0;I!==n;++I)t[p+I]=t[f+I]}++i}}if(a>0){e[i]=e[a];for(var C=a*n,m=i*n,b=0;b!==n;++b)t[m+b]=t[C+b];++i}return i!==e.length?(this.times=xl.arraySlice(e,0,i),this.values=xl.arraySlice(t,0,i*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=xl.arraySlice(this.times,0),t=xl.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:xl.convertArray(e.times,Array),values:xl.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Nl.prototype.TimeBufferType=Float32Array,Nl.prototype.ValueBufferType=Float32Array,Nl.prototype.DefaultInterpolation=tn;var Ol=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(Nl);Ol.prototype.ValueTypeName="bool",Ol.prototype.ValueBufferType=Array,Ol.prototype.DefaultInterpolation=en,Ol.prototype.InterpolantFactoryMethodLinear=void 0,Ol.prototype.InterpolantFactoryMethodSmooth=void 0;var Wl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(Nl);Wl.prototype.ValueTypeName="color";var Fl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(Nl);function Ml(e,t,n,r){Sl.call(this,e,t,n,r)}Fl.prototype.ValueTypeName="number",Ml.prototype=Object.assign(Object.create(Sl.prototype),{constructor:Ml,interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),u=e*o,c=u+o;u!==c;u+=4)dr.slerpFlat(a,0,i,u-o,i,u,s);return a}});var Vl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return Object(C.a)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Ml(this.times,this.values,this.getValueSize(),e)}}]),n}(Nl);Vl.prototype.ValueTypeName="quaternion",Vl.prototype.DefaultInterpolation=tn,Vl.prototype.InterpolantFactoryMethodSmooth=void 0;var Tl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(Nl);Tl.prototype.ValueTypeName="string",Tl.prototype.ValueBufferType=Array,Tl.prototype.DefaultInterpolation=en,Tl.prototype.InterpolantFactoryMethodLinear=void 0,Tl.prototype.InterpolantFactoryMethodSmooth=void 0;var El=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.apply(this,arguments)}return n}(Nl);El.prototype.ValueTypeName="vector";var jl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sn;Object(I.a)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=a,this.uuid=tr.generateUUID(),this.duration<0&&this.resetDuration()}return Object(C.a)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),a=0,i=n.length;a!==i;++a)t.push(Ll(n[a]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},a=0,i=n.length;a!==i;++a)t.push(Nl.toJSON(n[a]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var a=t.length,i=[],o=0;o<a;o++){var s=[],u=[];s.push((o+a-1)%a,o,(o+1)%a),u.push(0,1,0);var c=xl.getKeyframeOrder(s);s=xl.sortedArray(s,1,c),u=xl.sortedArray(u,1,c),r||0!==s[0]||(s.push(a),u.push(u[0])),i.push(new Fl(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/n))}return new this(e,-1,i)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var a=0;a<n.length;a++)if(n[a].name===t)return n[a];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},a=/^([\w-]*?)([\d]+)$/,i=0,o=e.length;i<o;i++){var s=e[i],u=s.name.match(a);if(u&&u.length>1){var c=u[1],l=r[c];l||(r[c]=l=[]),l.push(s)}}var g=[];for(var d in r)g.push(this.CreateFromMorphTargetSequence(d,r[d],t,n));return g}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,a){if(0!==n.length){var i=[],o=[];xl.flattenJSON(n,i,o,r),0!==i.length&&a.push(new e(t,i,o))}},r=[],a=e.name||"default",i=e.fps||30,o=e.blendMode,s=e.length||-1,u=e.hierarchy||[],c=0;c<u.length;c++){var l=u[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){var g={},d=void 0;for(d=0;d<l.length;d++)if(l[d].morphTargets)for(var h=0;h<l[d].morphTargets.length;h++)g[l[d].morphTargets[h]]=-1;for(var f in g){for(var p=[],I=[],C=0;C!==l[d].morphTargets.length;++C){var m=l[d];p.push(m.time),I.push(m.morphTarget===f?1:0)}r.push(new Fl(".morphTargetInfluence["+f+"]",p,I))}s=g.length*(i||1)}else{var b=".bones["+t[c].name+"]";n(El,b+".position",l,"pos",r),n(Vl,b+".quaternion",l,"rot",r),n(El,b+".scale",l,"scl",r)}}return 0===r.length?null:new this(a,s,r,o)}}]),e}();function Ll(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Fl;case"vector":case"vector2":case"vector3":case"vector4":return El;case"color":return Wl;case"quaternion":return Vl;case"bool":case"boolean":return Ol;case"string":return Tl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];xl.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var Xl={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Hl(e,t,n){var r=this,a=!1,i=0,o=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===a&&void 0!==r.onStart&&r.onStart(e,i,o),a=!0},this.itemEnd=function(e){i++,void 0!==r.onProgress&&r.onProgress(e,i,o),i===o&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){var t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],a=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return a}return null}}var Yl=new Hl;function zl(e){this.manager=void 0!==e?e:Yl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(zl.prototype,{load:function(){},loadAsync:function(e,t){var n=this;return new Promise((function(r,a){n.load(e,r,t,a)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var Kl={};function _l(e){zl.call(this,e)}_l.prototype=Object.assign(Object.create(zl.prototype),{constructor:_l,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,i=Xl.get(e);if(void 0!==i)return a.manager.itemStart(e),setTimeout((function(){t&&t(i),a.manager.itemEnd(e)}),0),i;if(void 0===Kl[e]){var o,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var u=s[1],c=!!s[2],l=s[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var g,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),f=0;f<l.length;f++)h[f]=l.charCodeAt(f);g="blob"===d?new Blob([h.buffer],{type:u}):h.buffer;break;case"document":var p=new DOMParser;g=p.parseFromString(l,u);break;case"json":g=JSON.parse(l);break;default:g=l}setTimeout((function(){t&&t(g),a.manager.itemEnd(e)}),0)}catch(C){setTimeout((function(){r&&r(C),a.manager.itemError(e),a.manager.itemEnd(e)}),0)}}else{for(var I in Kl[e]=[],Kl[e].push({onLoad:t,onProgress:n,onError:r}),(o=new XMLHttpRequest).open("GET",e,!0),o.addEventListener("load",(function(t){var n=this.response,r=Kl[e];if(delete Kl[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Xl.add(e,n);for(var i=0,o=r.length;i<o;i++){var s=r[i];s.onLoad&&s.onLoad(n)}a.manager.itemEnd(e)}else{for(var u=0,c=r.length;u<c;u++){var l=r[u];l.onError&&l.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}}),!1),o.addEventListener("progress",(function(t){for(var n=Kl[e],r=0,a=n.length;r<a;r++){var i=n[r];i.onProgress&&i.onProgress(t)}}),!1),o.addEventListener("error",(function(t){var n=Kl[e];delete Kl[e];for(var r=0,i=n.length;r<i;r++){var o=n[r];o.onError&&o.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}),!1),o.addEventListener("abort",(function(t){var n=Kl[e];delete Kl[e];for(var r=0,i=n.length;r<i;r++){var o=n[r];o.onError&&o.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.overrideMimeType&&o.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)o.setRequestHeader(I,this.requestHeader[I]);o.send(null)}return a.manager.itemStart(e),o}Kl[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});var Dl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new _l(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(n){try{t(a.parse(JSON.parse(n)))}catch(i){r?r(i):console.error(i),a.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=jl.parse(e[n]);t.push(r)}return t}}]),n}(zl);function Pl(e){zl.call(this,e)}Pl.prototype=Object.assign(Object.create(zl.prototype),{constructor:Pl,load:function(e,t,n,r){var a=this,i=[],o=new dc,s=new _l(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(a.withCredentials);var u=0;function c(c){s.load(e[c],(function(e){var n=a.parse(e,!0);i[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(o.minFilter=Fe),o.image=i,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var l=0,g=e.length;l<g;++l)c(l);else s.load(e,(function(e){var n=a.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){i[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)i[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),i[s].format=n.format,i[s].width=n.width,i[s].height=n.height}o.image=i}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Fe),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}});var Ul=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,i=Xl.get(e);if(void 0!==i)return a.manager.itemStart(e),setTimeout((function(){t&&t(i),a.manager.itemEnd(e)}),0),i;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),Xl.add(e,this),t&&t(this),a.manager.itemEnd(e)}function u(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),r&&r(t),a.manager.itemError(e),a.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),a.manager.itemStart(e),o.src=e,o}}]),n}(zl),Jl=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=new ji,i=new Ul(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);var o=0;function s(n){i.load(e[n],(function(e){a.images[n]=e,6===++o&&(a.needsUpdate=!0,t&&t(a))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return a}}]),n}(zl);function Ql(e){zl.call(this,e)}function ql(e){zl.call(this,e)}function $l(){this.type="Curve",this.arcLengthDivisions=200}Ql.prototype=Object.assign(Object.create(zl.prototype),{constructor:Ql,load:function(e,t,n,r){var a=this,i=new Xi,o=new _l(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(a.withCredentials),o.load(e,(function(e){var n=a.parse(e);n&&(void 0!==n.image?i.image=n.image:void 0!==n.data&&(i.image.width=n.width,i.image.height=n.height,i.image.data=n.data),i.wrapS=void 0!==n.wrapS?n.wrapS:Se,i.wrapT=void 0!==n.wrapT?n.wrapT:Se,i.magFilter=void 0!==n.magFilter?n.magFilter:Fe,i.minFilter=void 0!==n.minFilter?n.minFilter:Fe,i.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(i.encoding=n.encoding),void 0!==n.flipY&&(i.flipY=n.flipY),void 0!==n.format&&(i.format=n.format),void 0!==n.type&&(i.type=n.type),void 0!==n.mipmaps&&(i.mipmaps=n.mipmaps,i.minFilter=Te),1===n.mipmapCount&&(i.minFilter=Fe),void 0!==n.generateMipmaps&&(i.generateMipmaps=n.generateMipmaps),i.needsUpdate=!0,t&&t(i,n))}),n,r),i}}),ql.prototype=Object.assign(Object.create(zl.prototype),{constructor:ql,load:function(e,t,n,r){var a=new sr,i=new Ul(this.manager);return i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),i.load(e,(function(n){a.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);a.format=r?qe:$e,a.needsUpdate=!0,void 0!==t&&t(a)}),n,r),a}}),Object.assign($l.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),a=0;n.push(0);for(var i=1;i<=e;i++)a+=(t=this.getPoint(i/e)).distanceTo(r),n.push(a),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),a=0,i=r.length;n=t||e*r[i-1];for(var o,s=0,u=i-1;s<=u;)if((o=r[a=Math.floor(s+(u-s)/2)]-n)<0)s=a+1;else{if(!(o>0)){u=a;break}u=a-1}if(r[a=u]===n)return a/(i-1);var c=r[a];return(a+(n-c)/(r[a+1]-c))/(i-1)},getTangent:function(e,t){var n=1e-4,r=e-n,a=e+n;r<0&&(r=0),a>1&&(a=1);var i=this.getPoint(r),o=this.getPoint(a),s=t||(i.isVector2?new nr:new hr);return s.copy(o).sub(i).normalize(),s},getTangentAt:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)},computeFrenetFrames:function(e,t){for(var n=new hr,r=[],a=[],i=[],o=new hr,s=new zr,u=0;u<=e;u++){var c=u/e;r[u]=this.getTangentAt(c,new hr),r[u].normalize()}a[0]=new hr,i[0]=new hr;var l=Number.MAX_VALUE,g=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);g<=l&&(l=g,n.set(1,0,0)),d<=l&&(l=d,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),a[0].crossVectors(r[0],o),i[0].crossVectors(r[0],a[0]);for(var f=1;f<=e;f++){if(a[f]=a[f-1].clone(),i[f]=i[f-1].clone(),o.crossVectors(r[f-1],r[f]),o.length()>Number.EPSILON){o.normalize();var p=Math.acos(tr.clamp(r[f-1].dot(r[f]),-1,1));a[f].applyMatrix4(s.makeRotationAxis(o,p))}i[f].crossVectors(r[f],a[f])}if(!0===t){var I=Math.acos(tr.clamp(a[0].dot(a[e]),-1,1));I/=e,r[0].dot(o.crossVectors(a[0],a[e]))>0&&(I=-I);for(var C=1;C<=e;C++)a[C].applyMatrix4(s.makeRotationAxis(r[C],I*C)),i[C].crossVectors(r[C],a[C])}return{tangents:r,normals:a,binormals:i}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});var eg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return Object(I.a)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=a,e.xRadius=i,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=u,e.aClockwise=c,e.aRotation=l,e}return Object(C.a)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new nr,r=2*Math.PI,a=this.aEndAngle-this.aStartAngle,i=Math.abs(a)<Number.EPSILON;a<0;)a+=r;for(;a>r;)a-=r;a<Number.EPSILON&&(a=i?0:r),!0!==this.aClockwise||i||(a===r?a=-r:a-=r);var o=this.aStartAngle+e*a,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),g=s-this.aX,d=u-this.aY;s=g*c-d*l+this.aX,u=g*l+d*c+this.aY}return n.set(s,u)}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}($l);eg.prototype.isEllipseCurve=!0;var tg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a,i,o,s){var u;return Object(I.a)(this,n),(u=t.call(this,e,r,a,a,i,o,s)).type="ArcCurve",u}return n}(eg);function ng(){var e=0,t=0,n=0,r=0;function a(a,i,o,s){e=a,t=o,n=-3*a+3*i-2*o-s,r=2*a-2*i+o+s}return{initCatmullRom:function(e,t,n,r,i){a(t,n,i*(n-e),i*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,i,o,s){var u=(t-e)/i-(n-e)/(i+o)+(n-t)/o,c=(n-t)/o-(r-t)/(o+s)+(r-n)/s;a(t,n,u*=o,c*=o)},calc:function(a){var i=a*a;return e+t*a+n*i+r*(i*a)}}}tg.prototype.isArcCurve=!0;var rg=new hr,ag=new ng,ig=new ng,og=new ng,sg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return Object(I.a)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=a,e.curveType=i,e.tension=o,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,a=r,i=this.points,o=i.length,s=(o-(this.closed?0:1))*e,u=Math.floor(s),c=s-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/o)+1)*o:0===c&&u===o-1&&(u=o-2,c=1),this.closed||u>0?t=i[(u-1)%o]:(rg.subVectors(i[0],i[1]).add(i[0]),t=rg);var l=i[u%o],g=i[(u+1)%o];if(this.closed||u+2<o?n=i[(u+2)%o]:(rg.subVectors(i[o-1],i[o-2]).add(i[o-1]),n=rg),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,h=Math.pow(t.distanceToSquared(l),d),f=Math.pow(l.distanceToSquared(g),d),p=Math.pow(g.distanceToSquared(n),d);f<1e-4&&(f=1),h<1e-4&&(h=f),p<1e-4&&(p=f),ag.initNonuniformCatmullRom(t.x,l.x,g.x,n.x,h,f,p),ig.initNonuniformCatmullRom(t.y,l.y,g.y,n.y,h,f,p),og.initNonuniformCatmullRom(t.z,l.z,g.z,n.z,h,f,p)}else"catmullrom"===this.curveType&&(ag.initCatmullRom(t.x,l.x,g.x,n.x,this.tension),ig.initCatmullRom(t.y,l.y,g.y,n.y,this.tension),og.initCatmullRom(t.z,l.z,g.z,n.z,this.tension));return a.set(ag.calc(c),ig.calc(c),og.calc(c)),a}},{key:"copy",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var a=this.points[t];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push((new hr).fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}($l);function ug(e,t,n,r,a){var i=.5*(r-t),o=.5*(a-n),s=e*e;return(2*n-2*r+i+o)*(e*s)+(-3*n+3*r-2*i-o)*s+i*e+n}function cg(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function lg(e,t,n,r,a){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,a)}sg.prototype.isCatmullRomCurve3=!0;var gg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new nr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new nr;return Object(I.a)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=a,e.v2=i,e.v3=o,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t,r=this.v0,a=this.v1,i=this.v2,o=this.v3;return n.set(lg(e,r.x,a.x,i.x,o.x),lg(e,r.y,a.y,i.y,o.y)),n}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}($l);gg.prototype.isCubicBezierCurve=!0;var dg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new hr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new hr;return Object(I.a)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=a,e.v2=i,e.v3=o,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,n=t,r=this.v0,a=this.v1,i=this.v2,o=this.v3;return n.set(lg(e,r.x,a.x,i.x,o.x),lg(e,r.y,a.y,i.y,o.y),lg(e,r.z,a.z,i.z,o.z)),n}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}($l);dg.prototype.isCubicBezierCurve3=!0;var hg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr;return Object(I.a)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=a,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){var n=t||new nr;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l);hg.prototype.isLineCurve=!0;var fg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr;return Object(I.a)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=a,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l),pg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new nr;return Object(I.a)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=a,e.v2=i,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t,r=this.v0,a=this.v1,i=this.v2;return n.set(cg(e,r.x,a.x,i.x),cg(e,r.y,a.y,i.y)),n}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l);pg.prototype.isQuadraticBezierCurve=!0;var Ig=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new hr;return Object(I.a)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=a,e.v2=i,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr,n=t,r=this.v0,a=this.v1,i=this.v2;return n.set(cg(e,r.x,a.x,i.x),cg(e,r.y,a.y,i.y),cg(e,r.z,a.z,i.z)),n}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l);Ig.prototype.isQuadraticBezierCurve3=!0;var Cg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(I.a)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return Object(C.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t,r=this.points,a=(r.length-1)*e,i=Math.floor(a),o=a-i,s=r[0===i?i:i-1],u=r[i],c=r[i>r.length-2?r.length-1:i+1],l=r[i>r.length-3?r.length-1:i+2];return n.set(ug(o,s.x,u.x,c.x,l.x),ug(o,s.y,u.y,c.y,l.y)),n}},{key:"copy",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push(a.clone())}return this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var a=this.points[t];e.points.push(a.toArray())}return e}},{key:"fromJSON",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push((new nr).fromArray(a))}return this}}]),n}($l);Cg.prototype.isSplineCurve=!0;var mg=Object.freeze({__proto__:null,ArcCurve:tg,CatmullRomCurve3:sg,CubicBezierCurve:gg,CubicBezierCurve3:dg,EllipseCurve:eg,LineCurve:hg,LineCurve3:fg,QuadraticBezierCurve:pg,QuadraticBezierCurve3:Ig,SplineCurve:Cg}),bg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return Object(C.a)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new hg(t,e))}},{key:"getPoint",value:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var a=n[r]-t,i=this.curves[r],o=i.getLength(),s=0===o?0:1-a/o;return i.getPointAt(s)}r++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,a=this.curves;r<a.length;r++)for(var i=a[r],o=i&&i.isEllipseCurve?2*t:i&&(i.isLineCurve||i.isLineCurve3)?1:i&&i.isSplineCurve?t*i.points.length:t,s=i.getPoints(o),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var a=e.curves[t];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var a=this.curves[t];e.curves.push(a.toJSON())}return e}},{key:"fromJSON",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var a=e.curves[t];this.curves.push((new mg[a.type]).fromJSON(a))}return this}}]),n}($l),vg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new nr,e&&r.setFromPoints(e),r}return Object(C.a)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new hg(this.currentPoint.clone(),new nr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var a=new pg(this.currentPoint.clone(),new nr(e,t),new nr(n,r));return this.curves.push(a),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){var o=new gg(this.currentPoint.clone(),new nr(e,t),new nr(n,r),new nr(a,i));return this.curves.push(o),this.currentPoint.set(a,i),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new Cg(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,a,i){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,a,i),this}},{key:"absarc",value:function(e,t,n,r,a,i){return this.absellipse(e,t,n,n,r,a,i),this}},{key:"ellipse",value:function(e,t,n,r,a,i,o,s){var u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,n,r,a,i,o,s),this}},{key:"absellipse",value:function(e,t,n,r,a,i,o,s){var u=new eg(e,t,n,r,a,i,o,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);return this.currentPoint.copy(l),this}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(bg),Ag=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this,e)).uuid=tr.generateUUID(),r.type="Shape",r.holes=[],r}return Object(C.a)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var a=e.holes[t];this.holes.push(a.clone())}return this}},{key:"toJSON",value:function(){var e=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var a=this.holes[t];e.holes.push(a.toJSON())}return e}},{key:"fromJSON",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var a=e.holes[t];this.holes.push((new vg).fromJSON(a))}return this}}]),n}(vg),yg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(I.a)(this,n),(r=t.call(this)).type="Light",r.color=new ja(e),r.intensity=a,r}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(pa);yg.prototype.isLight=!0;var wg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;return Object(I.a)(this,n),(i=t.call(this,e,a)).type="HemisphereLight",i.position.copy(pa.DefaultUp),i.updateMatrix(),i.groundColor=new ja(r),i}return Object(C.a)(n,[{key:"copy",value:function(e){return yg.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(yg);wg.prototype.isHemisphereLight=!0;var Gg=new zr,Bg=new hr,xg=new hr,Sg=function(){function e(t){Object(I.a)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new nr(512,512),this.map=null,this.mapPass=null,this.matrix=new zr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new zi,this._frameExtents=new nr(1,1),this._viewportCount=1,this._viewports=[new cr(0,0,1,1)]}return Object(C.a)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Bg.setFromMatrixPosition(e.matrixWorld),t.position.copy(Bg),xg.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(xg),t.updateMatrixWorld(),Gg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Gg),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),kg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this,new Vi(50,1,.5,500))).focus=1,e}return Object(C.a)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*tr.RAD2DEG*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&a===t.aspect&&i===t.far||(t.fov=r,t.aspect=a,t.far=i,t.updateProjectionMatrix()),Object(g.a)(Object(d.a)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(Sg);kg.prototype.isSpotLightShadow=!0;var Zg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return Object(I.a)(this,n),(a=t.call(this,e,r)).type="SpotLight",a.position.copy(pa.DefaultUp),a.updateMatrix(),a.target=new pa,a.distance=i,a.angle=o,a.penumbra=s,a.decay=u,a.shadow=new kg,a}return Object(C.a)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(yg);Zg.prototype.isSpotLight=!0;var Rg=new zr,Ng=new hr,Og=new hr,Wg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this,new Vi(90,1,.5,500)))._frameExtents=new nr(4,2),e._viewportCount=6,e._viewports=[new cr(2,1,1,1),new cr(0,1,1,1),new cr(3,1,1,1),new cr(1,1,1,1),new cr(3,0,1,1),new cr(1,0,1,1)],e._cubeDirections=[new hr(1,0,0),new hr(-1,0,0),new hr(0,0,1),new hr(0,0,-1),new hr(0,1,0),new hr(0,-1,0)],e._cubeUps=[new hr(0,1,0),new hr(0,1,0),new hr(0,1,0),new hr(0,1,0),new hr(0,0,1),new hr(0,0,-1)],e}return Object(C.a)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),Ng.setFromMatrixPosition(e.matrixWorld),n.position.copy(Ng),Og.copy(n.position),Og.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Og),n.updateMatrixWorld(),r.makeTranslation(-Ng.x,-Ng.y,-Ng.z),Rg.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Rg)}}]),n}(Sg);Wg.prototype.isPointLightShadow=!0;var Fg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(I.a)(this,n),(a=t.call(this,e,r)).type="PointLight",a.distance=i,a.decay=o,a.shadow=new Wg,a}return Object(C.a)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(yg);Fg.prototype.isPointLight=!0;var Mg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return Object(I.a)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=a,e.top=i,e.bottom=o,e.near=s,e.far=u,e.updateProjectionMatrix(),e}return Object(C.a)(n,[{key:"copy",value:function(e,t){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,a,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,a=n-e,i=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i=(a+=u*this.view.offsetX)+u*this.view.width,s=(o-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(a,i,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=pa.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(Mi);Mg.prototype.isOrthographicCamera=!0;var Vg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){return Object(I.a)(this,n),t.call(this,new Mg(-5,5,5,-5,.5,500))}return n}(Sg);Vg.prototype.isDirectionalLightShadow=!0;var Tg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(I.a)(this,n),(a=t.call(this,e,r)).type="DirectionalLight",a.position.copy(pa.DefaultUp),a.updateMatrix(),a.target=new pa,a.shadow=new Vg,a}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(yg);Tg.prototype.isDirectionalLight=!0;var Eg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;return Object(I.a)(this,n),(a=t.call(this,e,r)).type="AmbientLight",a}return n}(yg);Eg.prototype.isAmbientLight=!0;var jg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return Object(I.a)(this,n),(a=t.call(this,e,r)).type="RectAreaLight",a.width=i,a.height=o,a}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(yg);jg.prototype.isRectAreaLight=!0;var Lg=function(){function e(){Object(I.a)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new hr)}return Object(C.a)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*r),t.addScaledVector(i[2],.488603*a),t.addScaledVector(i[3],.488603*n),t.addScaledVector(i[4],n*r*1.092548),t.addScaledVector(i[5],r*a*1.092548),t.addScaledVector(i[6],.315392*(3*a*a-1)),t.addScaledVector(i[7],n*a*1.092548),t.addScaledVector(i[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*r),t.addScaledVector(i[2],1.023328*a),t.addScaledVector(i[3],1.023328*n),t.addScaledVector(i[4],.858086*n*r),t.addScaledVector(i[5],.858086*r*a),t.addScaledVector(i[6],.743125*a*a-.247708),t.addScaledVector(i[7],.858086*n*a),t.addScaledVector(i[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,a=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*a,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*n*a,t[8]=.546274*(n*n-r*r)}}]),e}();Lg.prototype.isSphericalHarmonics3=!0;var Xg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Lg,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(I.a)(this,n),(e=t.call(this,void 0,a)).sh=r,e}return Object(C.a)(n,[{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=Object(g.a)(Object(d.a)(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(yg);Xg.prototype.isLightProbe=!0;var Hg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this,e)).textures={},r}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new _l(a.manager);i.setPath(a.path),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(n){try{t(a.parse(JSON.parse(n)))}catch(i){r?r(i):console.error(i),a.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Bl[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new ja).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var a in e.uniforms){var i=e.uniforms[a];switch(r.uniforms[a]={},i.type){case"t":r.uniforms[a].value=n(i.value);break;case"c":r.uniforms[a].value=(new ja).setHex(i.value);break;case"v2":r.uniforms[a].value=(new nr).fromArray(i.value);break;case"v3":r.uniforms[a].value=(new hr).fromArray(i.value);break;case"v4":r.uniforms[a].value=(new cr).fromArray(i.value);break;case"m3":r.uniforms[a].value=(new ar).fromArray(i.value);break;case"m4":r.uniforms[a].value=(new zr).fromArray(i.value);break;default:r.uniforms[a].value=i.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new nr).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new nr).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(zl),Yg={decodeText:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(a){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function zg(){li.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Kg(e,t,n,r){"number"===typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ya.call(this,e,t,n),this.meshPerAttribute=r||1}zg.prototype=Object.assign(Object.create(li.prototype),{constructor:zg,isInstancedBufferGeometry:!0,copy:function(e){return li.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=li.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Kg.prototype=Object.assign(Object.create(Ya.prototype),{constructor:Kg,isInstancedBufferAttribute:!0,copy:function(e){return Ya.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Ya.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});var _g=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new _l(a.manager);i.setPath(a.path),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(n){try{t(a.parse(JSON.parse(n)))}catch(i){r?r(i):console.error(i),a.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var a=e.interleavedBuffers[r],i=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],a=new Uint32Array(r).buffer;return n[t]=a,a}(e,a.buffer),o=new lu(ni(a.type,i),a.stride);return o.uuid=a.uuid,t[r]=o,o}var a=e.isInstancedBufferGeometry?new zg:new li,i=e.data.index;if(void 0!==i){var o=ni(i.type,i.array);a.setIndex(new Ya(o,1))}var s=e.data.attributes;for(var u in s){var c=s[u],l=void 0;if(c.isInterleavedBufferAttribute){l=new du(r(e.data,c.data),c.itemSize,c.offset,c.normalized)}else{var g=ni(c.type,c.array);l=new(c.isInstancedBufferAttribute?Kg:Ya)(g,c.itemSize,c.normalized)}void 0!==c.name&&(l.name=c.name),void 0!==c.usage&&l.setUsage(c.usage),void 0!==c.updateRange&&(l.updateRange.offset=c.updateRange.offset,l.updateRange.count=c.updateRange.count),a.setAttribute(u,l)}var d=e.data.morphAttributes;if(d)for(var h in d){for(var f=d[h],p=[],I=0,C=f.length;I<C;I++){var m=f[I],b=void 0;if(m.isInterleavedBufferAttribute)b=new du(r(e.data,m.data),m.itemSize,m.offset,m.normalized);else b=new Ya(ni(m.type,m.array),m.itemSize,m.normalized);void 0!==m.name&&(b.name=m.name),p.push(b)}a.morphAttributes[h]=p}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);var v=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==v)for(var A=0,y=v.length;A!==y;++A){var w=v[A];a.addGroup(w.start,w.count,w.materialIndex)}var G=e.data.boundingSphere;if(void 0!==G){var B=new hr;void 0!==G.center&&B.fromArray(G.center),a.boundingSphere=new Mr(B,G.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}]),n}(zl),Dg=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=""===this.path?Yg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;var o=new _l(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var i=null;try{i=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=i.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?a.parse(i,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,(function(){void 0!==t&&t(u)})),o=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,a,s,n),c=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,c),void 0!==t){var l=!1;for(var g in i)if(i[g]instanceof HTMLImageElement){l=!0;break}!1===l&&t(u)}return u}},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var a=(new Ag).fromJSON(e[n]);t[a.uuid]=a}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var a=0,i=e.length;a<i;a++){var o=(new Xu).fromJSON(e[a],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n,r={};if(void 0!==e)for(var a=new _g,i=0,o=e.length;i<o;i++){var s=void 0,u=e[i];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new fl[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new fl[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new fl[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new fl[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new fl[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new fl[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new fl[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new fl[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new fl[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new fl[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new fl[u.type]((new mg[u.path.type]).fromJSON(u.path),u.tubularSegments,u.radius,u.radialSegments,u.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new fl[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new fl[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var c=0,l=u.shapes.length;c<l;c++){var g=t[u.shapes[c]];n.push(g)}s=new fl[u.type](n,u.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var d=0,h=u.shapes.length;d<h;d++){var f=t[u.shapes[d]];n.push(f)}var p=u.options.extrudePath;void 0!==p&&(u.options.extrudePath=(new mg[p.type]).fromJSON(p)),s=new fl[u.type](n,u.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=a.parse(u);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),!0===s.isBufferGeometry&&void 0!==u.userData&&(s.userData=u.userData),r[u.uuid]=s}return r}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var a=new Hg;a.setTextures(t);for(var i=0,o=e.length;i<o;i++){var s=e[i];if("MultiMaterial"===s.type){for(var u=[],c=0;c<s.materials.length;c++){var l=s.materials[c];void 0===n[l.uuid]&&(n[l.uuid]=a.parse(l)),u.push(n[l.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=a.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],a=jl.parse(r);t[a.uuid]=a}return t}},{key:"parseImages",value:function(e,t){var n,r=this,a={};function i(e){if("string"===typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:ni(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new Hl(t);(n=new Ul(o)).setCrossOrigin(this.crossOrigin);for(var s=0,u=e.length;s<u;s++){var c=e[s],l=c.url;if(Array.isArray(l)){a[c.uuid]=[];for(var g=0,d=l.length;g<d;g++){var h=i(l[g]);null!==h&&(h instanceof HTMLImageElement?a[c.uuid].push(h):a[c.uuid].push(new Xi(h.data,h.width,h.height)))}}else{var f=i(c.url);null!==f&&(a[c.uuid]=f)}}}return a}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var a=0,i=e.length;a<i;a++){var o=e[a];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0,u=t[o.image];Array.isArray(u)?(s=new ji(u),6===u.length&&(s.needsUpdate=!0)):(s=u&&u.data?new Xi(u.data,u.width,u.height):new sr(u),u&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,Pg)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],Ug),s.wrapT=n(o.wrap[1],Ug)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,Jg)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,Jg)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),r[o.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r){var a,i,o;function s(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,a=e.length;r<a;r++){var i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":a=new cu,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new ja(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new uu(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new su(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new Vi(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Mg(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Eg(e.color,e.intensity);break;case"DirectionalLight":a=new Tg(e.color,e.intensity);break;case"PointLight":a=new Fg(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new jg(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Zg(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new wg(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Xg).fromJSON(e);break;case"SkinnedMesh":a=new Tu(i=s(e.geometry),o=u(e.material)),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":a=new ki(i=s(e.geometry),o=u(e.material));break;case"InstancedMesh":i=s(e.geometry),o=u(e.material);var c=e.count,l=e.instanceMatrix,g=e.instanceColor;(a=new _u(i,o,c)).instanceMatrix=new Ya(new Float32Array(l.array),16),void 0!==g&&(a.instanceColor=new Ya(new Float32Array(g.array),g.itemSize));break;case"LOD":a=new Nu;break;case"Line":a=new $u(s(e.geometry),u(e.material));break;case"LineLoop":a=new rc(s(e.geometry),u(e.material));break;case"LineSegments":a=new nc(s(e.geometry),u(e.material));break;case"PointCloud":case"Points":a=new cc(s(e.geometry),u(e.material));break;case"Sprite":a=new Su(u(e.material));break;case"Group":a=new tu;break;case"Bone":a=new Eu;break;default:a=new pa}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var d=e.children,h=0;h<d.length;h++)a.add(this.parseObject(d[h],t,n,r));if(void 0!==e.animations)for(var f=e.animations,p=0;p<f.length;p++){var I=f[p];a.animations.push(r[I])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);for(var C=e.levels,m=0;m<C.length;m++){var b=C[m],v=a.getObjectByProperty("uuid",b.object);void 0!==v&&a.addLevel(v,b.distance)}}return a}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),n}(zl),Pg={UVMapping:be,CubeReflectionMapping:ve,CubeRefractionMapping:Ae,EquirectangularReflectionMapping:ye,EquirectangularRefractionMapping:we,CubeUVReflectionMapping:Ge,CubeUVRefractionMapping:Be},Ug={RepeatWrapping:xe,ClampToEdgeWrapping:Se,MirroredRepeatWrapping:ke},Jg={NearestFilter:Ze,NearestMipmapNearestFilter:Re,NearestMipmapLinearFilter:Oe,LinearFilter:Fe,LinearMipmapNearestFilter:Me,LinearMipmapLinearFilter:Te};function Qg(e){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),zl.call(this,e),this.options={premultiplyAlpha:"none"}}Qg.prototype=Object.assign(Object.create(zl.prototype),{constructor:Qg,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,i=Xl.get(e);if(void 0!==i)return a.manager.itemStart(e),setTimeout((function(){t&&t(i),a.manager.itemEnd(e)}),0),i;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(a.options,{colorSpaceConversion:"none"}))})).then((function(n){Xl.add(e,n),t&&t(n),a.manager.itemEnd(e)})).catch((function(t){r&&r(t),a.manager.itemError(e),a.manager.itemEnd(e)})),a.manager.itemStart(e)}});var qg=function(){function e(){Object(I.a)(this,e),this.type="ShapePath",this.color=new ja,this.subPaths=[],this.currentPath=null}return Object(C.a)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new vg,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){return this.currentPath.bezierCurveTo(e,t,n,r,a,i),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n],i=new Ag;i.curves=a.curves,t.push(i)}return t}function r(e,t){for(var n=t.length,r=!1,a=n-1,i=0;i<n;a=i++){var o=t[a],s=t[i],u=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(o=t[i],u=-u,s=t[a],c=-c),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var l=c*(e.x-o.x)-u*(e.y-o.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var a,i,o,s=Jc.isClockWise,u=this.subPaths;if(0===u.length)return[];if(!0===t)return n(u);var c=[];if(1===u.length)return i=u[0],(o=new Ag).curves=i.curves,c.push(o),c;var l=!s(u[0].getPoints());l=e?!l:l;var g,d,h=[],f=[],p=[],I=0;f[I]=void 0,p[I]=[];for(var C=0,m=u.length;C<m;C++)a=s(g=(i=u[C]).getPoints()),(a=e?!a:a)?(!l&&f[I]&&I++,f[I]={s:new Ag,p:g},f[I].s.curves=i.curves,l&&I++,p[I]=[]):p[I].push({h:i,p:g[0]});if(!f[0])return n(u);if(f.length>1){for(var b=!1,v=[],A=0,y=f.length;A<y;A++)h[A]=[];for(var w=0,G=f.length;w<G;w++)for(var B=p[w],x=0;x<B.length;x++){for(var S=B[x],k=!0,Z=0;Z<f.length;Z++)r(S.p,f[Z].p)&&(w!==Z&&v.push({froms:w,tos:Z,hole:x}),k?(k=!1,h[Z].push(S)):b=!0);k&&h[w].push(S)}v.length>0&&(b||(p=h))}for(var R=0,N=f.length;R<N;R++){o=f[R].s,c.push(o);for(var O=0,W=(d=p[R]).length;O<W;O++)o.holes.push(d[O].h)}return c}}]),e}(),$g=function(){function e(t){Object(I.a)(this,e),this.type="Font",this.data=t}return Object(C.a)(e,[{key:"generateShapes",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=[],r=ed(e,t,this.data),a=0,i=r.length;a<i;a++)Array.prototype.push.apply(n,r[a].toShapes());return n}}]),e}();function ed(e,t,n){for(var r=Array.from(e),a=t/n.resolution,i=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*a,o=[],s=0,u=0,c=0;c<r.length;c++){var l=r[c];if("\n"===l)s=0,u-=i;else{var g=td(l,a,s,u,n);s+=g.offsetX,o.push(g.path)}}return o}function td(e,t,n,r,a){var i=a.glyphs[e]||a.glyphs["?"];if(i){var o,s,u,c,l,g,d,h,f=new qg;if(i.o)for(var p=i._cachedOutline||(i._cachedOutline=i.o.split(" ")),I=0,C=p.length;I<C;){switch(p[I++]){case"m":o=p[I++]*t+n,s=p[I++]*t+r,f.moveTo(o,s);break;case"l":o=p[I++]*t+n,s=p[I++]*t+r,f.lineTo(o,s);break;case"q":u=p[I++]*t+n,c=p[I++]*t+r,l=p[I++]*t+n,g=p[I++]*t+r,f.quadraticCurveTo(l,g,u,c);break;case"b":u=p[I++]*t+n,c=p[I++]*t+r,l=p[I++]*t+n,g=p[I++]*t+r,d=p[I++]*t+n,h=p[I++]*t+r,f.bezierCurveTo(l,g,d,h,u,c)}}return{offsetX:i.ha*t,path:f}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+a.familyName+".")}$g.prototype.isFont=!0;var nd,rd=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new _l(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(i){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=a.parse(n);t&&t(r)}),n,r)}},{key:"parse",value:function(e){return new $g(e)}}]),n}(zl),ad={getContext:function(){return void 0===nd&&(nd=new(window.AudioContext||window.webkitAudioContext)),nd},setContext:function(e){nd=e}},id=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){return Object(I.a)(this,n),t.call(this,e)}return Object(C.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new _l(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(n){try{var i=n.slice(0);ad.getContext().decodeAudioData(i,(function(e){t(e)}))}catch(o){r?r(o):console.error(o),a.manager.itemError(e)}}),n,r)}}]),n}(zl),od=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(I.a)(this,n),a=t.call(this,void 0,i);var o=(new ja).set(e),s=(new ja).set(r),u=new hr(o.r,o.g,o.b),c=new hr(s.r,s.g,s.b),l=Math.sqrt(Math.PI),g=l*Math.sqrt(.75);return a.sh.coefficients[0].copy(u).add(c).multiplyScalar(l),a.sh.coefficients[1].copy(u).sub(c).multiplyScalar(g),a}return n}(Xg);od.prototype.isHemisphereLightProbe=!0;var sd=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(I.a)(this,n),r=t.call(this,void 0,a);var i=(new ja).set(e);return r.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return n}(Xg);sd.prototype.isAmbientLightProbe=!0;var ud=new zr,cd=new zr,ld=function(){function e(){Object(I.a)(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Vi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Vi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return Object(C.a)(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,a=e.projectionMatrix.clone(),i=t.eyeSep/2,o=i*t.near/t.focus,s=t.near*Math.tan(tr.DEG2RAD*t.fov*.5)/t.zoom;cd.elements[12]=-i,ud.elements[12]=i,n=-s*t.aspect+o,r=s*t.aspect+o,a.elements[0]=2*t.near/(r-n),a.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(a),n=-s*t.aspect-o,r=s*t.aspect-o,a.elements[0]=2*t.near/(r-n),a.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cd),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ud)}}]),e}(),gd=function(){function e(t){Object(I.a)(this,e),this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return Object(C.a)(e,[{key:"start",value:function(){this.startTime=dd(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=dd();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function dd(){return("undefined"===typeof performance?Date:performance).now()}var hd=new hr,fd=new dr,pd=new hr,Id=new hr,Cd=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(I.a)(this,n),(e=t.call(this)).type="AudioListener",e.context=ad.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new gd,e}return Object(C.a)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){Object(g.a)(Object(d.a)(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(hd,fd,pd),Id.set(0,0,-1).applyQuaternion(fd),t.positionX){var a=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(hd.x,a),t.positionY.linearRampToValueAtTime(hd.y,a),t.positionZ.linearRampToValueAtTime(hd.z,a),t.forwardX.linearRampToValueAtTime(Id.x,a),t.forwardY.linearRampToValueAtTime(Id.y,a),t.forwardZ.linearRampToValueAtTime(Id.z,a),t.upX.linearRampToValueAtTime(r.x,a),t.upY.linearRampToValueAtTime(r.y,a),t.upZ.linearRampToValueAtTime(r.z,a)}else t.setPosition(hd.x,hd.y,hd.z),t.setOrientation(Id.x,Id.y,Id.z,r.x,r.y,r.z)}}]),n}(pa),md=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return Object(C.a)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(pa),bd=new hr,vd=new dr,Ad=new hr,yd=new hr,wd=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return Object(C.a)(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if(Object(g.a)(Object(d.a)(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(bd,vd,Ad),yd.set(0,0,1).applyQuaternion(vd);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(bd.x,r),t.positionY.linearRampToValueAtTime(bd.y,r),t.positionZ.linearRampToValueAtTime(bd.z,r),t.orientationX.linearRampToValueAtTime(yd.x,r),t.orientationY.linearRampToValueAtTime(yd.y,r),t.orientationZ.linearRampToValueAtTime(yd.z,r)}else t.setPosition(bd.x,bd.y,bd.z),t.setOrientation(yd.x,yd.y,yd.z)}}}]),n}(md),Gd=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;Object(I.a)(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return Object(C.a)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),Bd=function(){function e(t,n,r){var a,i,o;switch(Object(I.a)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":a=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":a=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:a=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return Object(C.a)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,a=e*r+r,i=this.cumulativeWeight;if(0===i){for(var o=0;o!==r;++o)n[a+o]=n[o];i=t}else{var s=t/(i+=t);this._mixBufferRegion(n,a,0,s,r)}this.cumulativeWeight=i}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,a=this.cumulativeWeight,i=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-a,t)}i>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var u=t,c=t+t;u!==c;++u)if(n[u]!==n[u+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var a=n,i=r;a!==i;++a)t[a]=t[r+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,a){if(r>=.5)for(var i=0;i!==a;++i)e[t+i]=e[n+i]}},{key:"_slerp",value:function(e,t,n,r){dr.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,a){var i=this._workIndex*a;dr.multiplyQuaternionsFlat(e,i,e,t,e,n),dr.slerpFlat(e,t,e,t,e,i,r)}},{key:"_lerp",value:function(e,t,n,r,a){for(var i=1-r,o=0;o!==a;++o){var s=t+o;e[s]=e[s]*i+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,a){for(var i=0;i!==a;++i){var o=t+i;e[o]=e[o]+e[n+i]*r}}}]),e}(),xd="\\[\\]\\.:\\/",Sd=new RegExp("[\\[\\]\\.:\\/]","g"),kd="[^\\[\\]\\.:\\/]",Zd="[^"+xd.replace("\\.","")+"]",Rd=/((?:WC+[\/:])*)/.source.replace("WC",kd),Nd=/(WCOD+)?/.source.replace("WCOD",Zd),Od=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kd),Wd=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kd),Fd=new RegExp("^"+Rd+Nd+Od+Wd+"$"),Md=["material","materials","bones"];function Vd(e,t,n){var r=n||Td.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function Td(e,t,n){this.path=t,this.parsedPath=n||Td.parseTrackName(t),this.node=Td.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(Vd.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Td,{Composite:Vd,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Td.Composite(e,t,n):new Td(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Sd,"")},parseTrackName:function(e){var t=Fd.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var a=n.nodeName.substring(r+1);-1!==Md.indexOf(a)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=a)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var a=n[r];if(a.name===t||a.uuid===t)return a;var i=e(a.children);if(i)return i}return null}(e.children);if(r)return r}return null}}),Object.assign(Td.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,a=t.propertyIndex;if(e||(e=Td.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===i){i=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}var s=e[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var c=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[a]&&(a=e.morphTargetDictionary[a])}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=a}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Td.prototype,{_getValue_unbound:Td.prototype.getValue,_setValue_unbound:Td.prototype.setValue});var Ed=function(){function e(){Object(I.a)(this,e),this.uuid=tr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}return Object(C.a)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,a=this._bindings,i=a.length,o=void 0,s=e.length,u=this.nCachedObjects_,c=0,l=arguments.length;c!==l;++c){var g=arguments[c],d=g.uuid,h=t[d];if(void 0===h){h=s++,t[d]=h,e.push(g);for(var f=0,p=i;f!==p;++f)a[f].push(new Td(g,n[f],r[f]))}else if(h<u){o=e[h];var I=--u,C=e[I];t[C.uuid]=h,e[h]=C,t[d]=I,e[I]=g;for(var m=0,b=i;m!==b;++m){var v=a[m],A=v[I],y=v[h];v[h]=A,void 0===y&&(y=new Td(g,n[m],r[m])),v[I]=y}}else e[h]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,a=this.nCachedObjects_,i=0,o=arguments.length;i!==o;++i){var s=arguments[i],u=s.uuid,c=t[u];if(void 0!==c&&c>=a){var l=a++,g=e[l];t[g.uuid]=c,e[c]=g,t[u]=l,e[l]=s;for(var d=0,h=r;d!==h;++d){var f=n[d],p=f[l],I=f[c];f[c]=p,f[l]=I}}}this.nCachedObjects_=a}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,a=this.nCachedObjects_,i=e.length,o=0,s=arguments.length;o!==s;++o){var u=arguments[o],c=u.uuid,l=t[c];if(void 0!==l)if(delete t[c],l<a){var g=--a,d=e[g],h=--i,f=e[h];t[d.uuid]=l,e[l]=d,t[f.uuid]=g,e[g]=f,e.pop();for(var p=0,I=r;p!==I;++p){var C=n[p],m=C[g],b=C[h];C[l]=m,C[g]=b,C.pop()}}else{var v=--i,A=e[v];v>0&&(t[A.uuid]=l),e[l]=A,e.pop();for(var y=0,w=r;y!==w;++y){var G=n[y];G[l]=G[v],G.pop()}}}this.nCachedObjects_=a}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],a=this._bindings;if(void 0!==r)return a[r];var i=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=a.length,n[e]=r,i.push(e),o.push(t),a.push(l);for(var g=c,d=s.length;g!==d;++g){var h=s[g];l[g]=new Td(h,e,t)}return l}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,a=this._parsedPaths,i=this._bindings,o=i.length-1,s=i[o];t[e[o]]=n,i[n]=s,i.pop(),a[n]=a[o],a.pop(),r[n]=r[o],r.pop()}}}]),e}();Ed.prototype.isAnimationObjectGroup=!0;var jd=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;Object(I.a)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=a;for(var i=n.tracks,o=i.length,s=new Array(o),u={endingStart:rn,endingEnd:rn},c=0;c!==o;++c){var l=i[c].createInterpolant(null);s[c]=l,l.settings=u}this._interpolantSettings=u,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return Object(C.a)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,a=e._clip.duration,i=a/r,o=r/a;e.warp(1,i,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,a=r.time,i=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=a,s[1]=a+n,u[0]=e/i,u[1]=t/i,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var a=this._startTime;if(null!==a){var i=(e-a)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var u=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case un:for(var l=0,g=u.length;l!==g;++l)u[l].evaluate(o),c[l].accumulateAdditive(s);break;case sn:default:for(var d=0,h=u.length;d!==h;++d)u[d].evaluate(o),c[d].accumulate(r,s)}}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,a=this._loopCount,i=n===$t;if(0===e)return-1===a?r:i&&1===(1&a)?t-r:r;if(n===Qt){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===a&&(e>=0?(a=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,a+=Math.abs(o);var s=this.repetitions-a;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,i)}else this._setEndings(!1,!1,i);this._loopCount=a,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(i&&1===(1&a))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=an,r.endingEnd=an):(r.endingStart=e?this.zeroSlopeAtStart?an:rn:on,r.endingEnd=t?this.zeroSlopeAtEnd?an:rn:on)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,a=r.time,i=this._weightInterpolant;null===i&&(i=r._lendControlInterpolant(),this._weightInterpolant=i);var o=i.parameterPositions,s=i.sampleValues;return o[0]=a,s[0]=t,o[1]=a+e,s[1]=n,this}}]),e}(),Ld=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(I.a)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return Object(C.a)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,a=r.length,i=e._propertyBindings,o=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==a;++l){var g=r[l],d=g.name,h=c[d];if(void 0!==h)i[l]=h;else{if(void 0!==(h=i[l])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,d));continue}var f=t&&t._propertyBindings[l].binding.parsedPath;++(h=new Bd(Td.create(n,d,f),g.ValueTypeName,g.getValueSize())).referenceCount,this._addInactiveBinding(h,s,d),i[l]=h}o[l].resultBuffer=h.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var a=e._propertyBindings,i=0,o=a.length;i!==o;++i){var s=a[i];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var a=t[n];0===--a.useCount&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,a=this._actionsByClip,i=a[t];if(void 0===i)i={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=i;else{var o=i.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),i.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var a=e._clip.uuid,i=this._actionsByClip,o=i[a],s=o.knownActions,u=s[s.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete i[a],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var a=t[n];0===--a.referenceCount&&this._removeInactiveBinding(a)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,a=this._bindings,i=r[t];void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=a.length,a.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,a=n.path,i=this._bindingsByRootAndName,o=i[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete o[a],0===Object.keys(o).length&&delete i[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Zl(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,a=t[r];e.__cacheIndex=r,t[r]=e,a.__cacheIndex=n,t[n]=a}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,a=r.uuid,i="string"===typeof e?jl.findByName(r,e):e,o=null!==i?i.uuid:e,s=this._actionsByClip[o],u=null;if(void 0===n&&(n=null!==i?i.blendMode:sn),void 0!==s){var c=s.actionByRoot[a];if(void 0!==c&&c.blendMode===n)return c;u=s.knownActions[0],null===i&&(i=u._clip)}if(null===i)return null;var l=new jd(this,i,t,n);return this._bindAction(l,u),this._addInactiveAction(l,o,a),l}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,a="string"===typeof e?jl.findByName(n,e):e,i=a?a.uuid:e,o=this._actionsByClip[i];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,a=Math.sign(e),i=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,a,i)}for(var s=this._bindings,u=this._nActiveBindings,c=0;c!==u;++c)s[c].apply(i);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,a=r[n];if(void 0!==a){for(var i=a.knownActions,o=0,s=i.length;o!==s;++o){var u=i[o];this._deactivateAction(u);var c=u._cacheIndex,l=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,t[c]=l,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var a=n[r].actionByRoot[t];void 0!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}var i=this._bindingsByRootAndName[t];if(void 0!==i)for(var o in i){var s=i[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(Qn);Ld.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Xd=function(){function e(t){Object(I.a)(this,e),"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return Object(C.a)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}();function Hd(e,t,n){lu.call(this,e,t),this.meshPerAttribute=n||1}function Yd(e,t,n,r,a){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=a,this.version=0}function zd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Yr(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new ta,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Kd(e,t){return e.distance-t.distance}function _d(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var a=e.children,i=0,o=a.length;i<o;i++)_d(a[i],t,n,!0)}Hd.prototype=Object.assign(Object.create(lu.prototype),{constructor:Hd,isInstancedInterleavedBuffer:!0,copy:function(e){return lu.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var t=lu.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){var t=lu.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(Yd.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Yd.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(zd.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return _d(e,this,n,t),n.sort(Kd),n},intersectObjects:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,a=e.length;r<a;r++)_d(e[r],this,n,t);return n.sort(Kd),n}});var Dd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(I.a)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return Object(C.a)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(tr.clamp(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Pd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(I.a)(this,e),this.radius=t,this.theta=n,this.y=r,this}return Object(C.a)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ud=new nr,Jd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr(-1/0,-1/0);Object(I.a)(this,e),this.min=t,this.max=n}return Object(C.a)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Ud.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new nr),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new nr),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new nr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new nr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Ud.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Jd.prototype.isBox2=!0;var Qd=new hr,qd=new hr,$d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr;Object(I.a)(this,e),this.start=t,this.end=n}return Object(C.a)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new hr),e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new hr),e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new hr),this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){Qd.subVectors(e,this.start),qd.subVectors(this.end,this.start);var n=qd.dot(qd),r=qd.dot(Qd)/n;return t&&(r=tr.clamp(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new hr),this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function eh(e){pa.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}eh.prototype=Object.create(pa.prototype),eh.prototype.constructor=eh,eh.prototype.isImmediateRenderObject=!0;var th=new hr,nh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r){var a;Object(I.a)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=r;for(var i=new li,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,u=1;s<32;s++,u++){var c=s/32*Math.PI*2,l=u/32*Math.PI*2;o.push(Math.cos(c),Math.sin(c),1,Math.cos(l),Math.sin(l),1)}i.setAttribute("position",new qa(o,3));var g=new Du({fog:!1,toneMapped:!1});return a.cone=new nc(i,g),a.add(a.cone),a.update(),a}return Object(C.a)(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),th.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(th),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(pa),rh=new hr,ah=new zr,ih=new zr,oh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(I.a)(this,n);for(var a=sh(e),i=new li,o=[],s=[],u=new ja(0,0,1),c=new ja(0,1,0),l=0;l<a.length;l++){var g=a[l];g.parent&&g.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(u.r,u.g,u.b),s.push(c.r,c.g,c.b))}i.setAttribute("position",new qa(o,3)),i.setAttribute("color",new qa(s,3));var d=new Du({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,i,d)).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=e,r.bones=a,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return Object(C.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,a=r.getAttribute("position");ih.copy(this.root.matrixWorld).invert();for(var i=0,o=0;i<t.length;i++){var s=t[i];s.parent&&s.parent.isBone&&(ah.multiplyMatrices(ih,s.matrixWorld),rh.setFromMatrixPosition(ah),a.setXYZ(o,rh.x,rh.y,rh.z),ah.multiplyMatrices(ih,s.parent.matrixWorld),rh.setFromMatrixPosition(ah),a.setXYZ(o+1,rh.x,rh.y,rh.z),o+=2)}r.getAttribute("position").needsUpdate=!0,Object(g.a)(Object(d.a)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(nc);function sh(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,sh(e.children[n]));return t}var uh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;Object(I.a)(this,n);var o=new sl(r,4,2),s=new La({wireframe:!0,fog:!1,toneMapped:!1});return(i=t.call(this,o,s)).light=e,i.light.updateMatrixWorld(),i.color=a,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}return Object(C.a)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(ki),ch=new hr,lh=new ja,gh=new ja,dh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;Object(I.a)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=a;var o=new rl(r);o.rotateY(.5*Math.PI),i.material=new La({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var s=o.getAttribute("position"),u=new Float32Array(3*s.count);return o.setAttribute("color",new Ya(u,3)),i.add(new ki(o,i.material)),i.update(),i}return Object(C.a)(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");lh.copy(this.light.color),gh.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var a=n<r/2?lh:gh;t.setXYZ(n,a.r,a.g,a.b)}t.needsUpdate=!0}e.lookAt(ch.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(pa),hh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;Object(I.a)(this,n),i=new ja(i),o=new ja(o);for(var s=a/2,u=r/a,c=r/2,l=[],g=[],d=0,h=0,f=-c;d<=a;d++,f+=u){l.push(-c,0,f,c,0,f),l.push(f,0,-c,f,0,c);var p=d===s?i:o;p.toArray(g,h),h+=3,p.toArray(g,h),h+=3,p.toArray(g,h),h+=3,p.toArray(g,h),h+=3}var C=new li;C.setAttribute("position",new qa(l,3)),C.setAttribute("color",new qa(g,3));var m=new Du({vertexColors:!0,toneMapped:!1});return(e=t.call(this,C,m)).type="GridHelper",e}return n}(nc),fh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;Object(I.a)(this,n),s=new ja(s),u=new ja(u);for(var c=[],l=[],g=0;g<=a;g++){var d=g/a*(2*Math.PI),h=Math.sin(d)*r,f=Math.cos(d)*r;c.push(0,0,0),c.push(h,0,f);var p=1&g?s:u;l.push(p.r,p.g,p.b),l.push(p.r,p.g,p.b)}for(var C=0;C<=i;C++)for(var m=1&C?s:u,b=r-r/i*C,v=0;v<o;v++){var A=v/o*(2*Math.PI),y=Math.sin(A)*b,w=Math.cos(A)*b;c.push(y,0,w),l.push(m.r,m.g,m.b),A=(v+1)/o*(2*Math.PI),y=Math.sin(A)*b,w=Math.cos(A)*b,c.push(y,0,w),l.push(m.r,m.g,m.b)}var G=new li;G.setAttribute("position",new qa(c,3)),G.setAttribute("color",new qa(l,3));var B=new Du({vertexColors:!0,toneMapped:!1});return(e=t.call(this,G,B)).type="PolarGridHelper",e}return n}(nc),ph=new hr,Ih=new hr,Ch=new hr,mh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,a){var i;Object(I.a)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=a,void 0===r&&(r=1);var o=new li;o.setAttribute("position",new qa([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new Du({fog:!1,toneMapped:!1});return i.lightPlane=new $u(o,s),i.add(i.lightPlane),(o=new li).setAttribute("position",new qa([0,0,0,0,0,1],3)),i.targetLine=new $u(o,s),i.add(i.targetLine),i.update(),i}return Object(C.a)(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){ph.setFromMatrixPosition(this.light.matrixWorld),Ih.setFromMatrixPosition(this.light.target.matrixWorld),Ch.subVectors(Ih,ph),this.lightPlane.lookAt(Ih),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Ih),this.targetLine.scale.z=Ch.length()}}]),n}(pa),bh=new hr,vh=new Mi,Ah=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(I.a)(this,n);var a=new li,i=new Du({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],u={},c=new ja(16755200),l=new ja(16711680),g=new ja(43775),d=new ja(16777215),h=new ja(3355443);function f(e,t,n){p(e,n),p(t,n)}function p(e,t){o.push(0,0,0),s.push(t.r,t.g,t.b),void 0===u[e]&&(u[e]=[]),u[e].push(o.length/3-1)}return f("n1","n2",c),f("n2","n4",c),f("n4","n3",c),f("n3","n1",c),f("f1","f2",c),f("f2","f4",c),f("f4","f3",c),f("f3","f1",c),f("n1","f1",c),f("n2","f2",c),f("n3","f3",c),f("n4","f4",c),f("p","n1",l),f("p","n2",l),f("p","n3",l),f("p","n4",l),f("u1","u2",g),f("u2","u3",g),f("u3","u1",g),f("c","t",d),f("p","c",h),f("cn1","cn2",h),f("cn3","cn4",h),f("cf1","cf2",h),f("cf3","cf4",h),a.setAttribute("position",new qa(o,3)),a.setAttribute("color",new qa(s,3)),(r=t.call(this,a,i)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=u,r.update(),r}return Object(C.a)(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;vh.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),yh("c",t,e,vh,0,0,-1),yh("t",t,e,vh,0,0,1),yh("n1",t,e,vh,-1,-1,-1),yh("n2",t,e,vh,1,-1,-1),yh("n3",t,e,vh,-1,1,-1),yh("n4",t,e,vh,1,1,-1),yh("f1",t,e,vh,-1,-1,1),yh("f2",t,e,vh,1,-1,1),yh("f3",t,e,vh,-1,1,1),yh("f4",t,e,vh,1,1,1),yh("u1",t,e,vh,.7,1.1,-1),yh("u2",t,e,vh,-.7,1.1,-1),yh("u3",t,e,vh,0,2,-1),yh("cf1",t,e,vh,-1,0,1),yh("cf2",t,e,vh,1,0,1),yh("cf3",t,e,vh,0,-1,1),yh("cf4",t,e,vh,0,1,1),yh("cn1",t,e,vh,-1,0,-1),yh("cn2",t,e,vh,1,0,-1),yh("cn3",t,e,vh,0,-1,-1),yh("cn4",t,e,vh,0,1,-1),e.getAttribute("position").needsUpdate=!0}}]),n}(nc);function yh(e,t,n,r,a,i,o){bh.set(a,i,o).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),c=0,l=s.length;c<l;c++)u.setXYZ(s[c],bh.x,bh.y,bh.z)}var wh,Gh,Bh=new Ir,xh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;Object(I.a)(this,n);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),s=new li;return s.setIndex(new Ya(i,1)),s.setAttribute("position",new Ya(o,3)),(r=t.call(this,s,new Du({color:a,toneMapped:!1}))).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}return Object(C.a)(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Bh.setFromObject(this.object),!Bh.isEmpty()){var t=Bh.min,n=Bh.max,r=this.geometry.attributes.position,a=r.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=t.x,a[4]=n.y,a[5]=n.z,a[6]=t.x,a[7]=t.y,a[8]=n.z,a[9]=n.x,a[10]=t.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=t.z,a[15]=t.x,a[16]=n.y,a[17]=t.z,a[18]=t.x,a[19]=t.y,a[20]=t.z,a[21]=n.x,a[22]=t.y,a[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return nc.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(nc),Sh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;Object(I.a)(this,n);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new li;return s.setIndex(new Ya(i,1)),s.setAttribute("position",new qa(o,3)),(r=t.call(this,s,new Du({color:a,toneMapped:!1}))).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return Object(C.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Object(g.a)(Object(d.a)(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(nc),kh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;Object(I.a)(this,n);var o=i,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],u=new li;u.setAttribute("position",new qa(s,3)),u.computeBoundingSphere(),(r=t.call(this,u,new Du({color:o,toneMapped:!1}))).type="PlaneHelper",r.plane=e,r.size=a;var c=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],l=new li;return l.setAttribute("position",new qa(c,3)),l.computeBoundingSphere(),r.add(new ki(l,new La({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}return Object(C.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?R:Z,this.lookAt(this.plane.normal),Object(g.a)(Object(d.a)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}($u),Zh=new hr,Rh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hr(0,0,1),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new hr(0,0,0),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*s;return Object(I.a)(this,n),(e=t.call(this)).type="ArrowHelper",void 0===wh&&((wh=new li).setAttribute("position",new qa([0,0,0,0,1,0],3)),(Gh=new Ic(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(a),e.line=new $u(wh,new Du({color:o,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new ki(Gh,new La({color:o,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(i,s,u),e}return Object(C.a)(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Zh.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Zh,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return Object(g.a)(Object(d.a)(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(pa),Nh=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Object(I.a)(this,n);var a=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new li;o.setAttribute("position",new qa(a,3)),o.setAttribute("color",new qa(i,3));var s=new Du({vertexColors:!0,toneMapped:!1});return(e=t.call(this,o,s)).type="AxesHelper",e}return n}(nc),Oh=new Float32Array(1),Wh=new Int32Array(Oh.buffer),Fh={toHalfFloat:function(e){Oh[0]=e;var t=Wh[0],n=t>>16&32768,r=t>>12&2047,a=t>>23&255;return a<103?n:a>142?(n|=31744,n|=(255==a?0:1)&&8388607&t):a<113?n|=((r|=2048)>>114-a)+(r>>113-a&1):(n|=a-112<<10|r>>1,n+=1&r)}},Mh=Math.pow(2,8),Vh=[.125,.215,.35,.446,.526,.582],Th=5+Vh.length,Eh=20,jh=(r={},Object(u.a)(r,dn,0),Object(u.a)(r,hn,1),Object(u.a)(r,pn,2),Object(u.a)(r,Cn,3),Object(u.a)(r,mn,4),Object(u.a)(r,bn,5),Object(u.a)(r,fn,6),r),Lh=new La({side:R,depthWrite:!1,depthTest:!1}),Xh=new ki(new Ri,Lh),Hh=new Mg,Yh=tf(),zh=Yh._lodPlanes,Kh=Yh._sizeLods,_h=Yh._sigmas,Dh=new ja,Ph=null,Uh=(1+Math.sqrt(5))/2,Jh=1/Uh,Qh=[new hr(1,1,1),new hr(-1,1,1),new hr(1,1,-1),new hr(-1,1,-1),new hr(0,Uh,Jh),new hr(0,Uh,-Jh),new hr(Jh,0,Uh),new hr(-Jh,0,Uh),new hr(Uh,Jh,0),new hr(-Uh,Jh,0)];function qh(e){var t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return e.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var $h=function(){function e(t){Object(I.a)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(e){var t=new Float32Array(e),n=new hr(0,1,0);return new Il({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:jh[dn]},outputEncoding:{value:jh[dn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:F,depthTest:!1,depthWrite:!1})}(Eh),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return Object(C.a)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Ph=this._renderer.getRenderTarget();var a=this._allocateTargets();return this._sceneToCubeUV(e,n,r,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=of(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=af(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<zh.length;e++)zh[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Ph),e.scissorTest=!1,rf(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){Ph=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:Ze,minFilter:Ze,generateMipmaps:!1,type:je,format:nt,encoding:ef(e)?e.encoding:pn,depthBuffer:!1},n=nf(t);return n.depthBuffer=!e,this._pingPongRenderTarget=nf(t),n}},{key:"_compileMaterial",value:function(e){var t=new ki(zh[0],e);this._renderer.compile(t,Hh)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var a=new Vi(90,1,t,n),i=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,u=s.autoClear,c=s.outputEncoding,l=s.toneMapping;s.getClearColor(Dh),s.toneMapping=he,s.outputEncoding=dn,s.autoClear=!1;var g=!1,d=e.background;if(d){if(d.isColor){Lh.color.copy(d).convertSRGBToLinear(),e.background=null;var h=qh(Lh.color);Lh.opacity=h,g=!0}}else{Lh.color.copy(Dh).convertSRGBToLinear();var f=qh(Lh.color);Lh.opacity=f,g=!0}for(var p=0;p<6;p++){var I=p%3;0==I?(a.up.set(0,i[p],0),a.lookAt(o[p],0,0)):1==I?(a.up.set(0,0,i[p]),a.lookAt(0,o[p],0)):(a.up.set(0,i[p],0),a.lookAt(0,0,o[p])),rf(r,I*Mh,p>2?Mh:0,Mh,Mh),s.setRenderTarget(r),g&&s.render(Xh,a),s.render(e,a)}s.toneMapping=l,s.outputEncoding=c,s.autoClear=u}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=of()):null==this._equirectShader&&(this._equirectShader=af());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,a=new ki(zh[0],r),i=r.uniforms;i.envMap.value=e,e.isCubeTexture||i.texelSize.value.set(1/e.image.width,1/e.image.height),i.inputEncoding.value=jh[e.encoding],i.outputEncoding.value=jh[t.texture.encoding],rf(t,0,0,3*Mh,2*Mh),n.setRenderTarget(t),n.render(a,Hh)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<Th;r++){var a=Math.sqrt(_h[r]*_h[r]-_h[r-1]*_h[r-1]),i=Qh[(r-1)%Qh.length];this._blur(e,r-1,r,a,i)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,a){var i=this._pingPongRenderTarget;this._halfBlur(e,i,t,n,r,"latitudinal",a),this._halfBlur(i,e,n,n,r,"longitudinal",a)}},{key:"_halfBlur",value:function(e,t,n,r,a,i,o){var s=this._renderer,u=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new ki(zh[r],u),l=u.uniforms,g=Kh[n]-1,d=isFinite(a)?Math.PI/(2*g):2*Math.PI/39,h=a/d,f=isFinite(a)?1+Math.floor(3*h):Eh;f>Eh&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(f," samples when the maximum is set to ").concat(Eh));for(var p=[],I=0,C=0;C<Eh;++C){var m=C/h,b=Math.exp(-m*m/2);p.push(b),0==C?I+=b:C<f&&(I+=2*b)}for(var v=0;v<p.length;v++)p[v]=p[v]/I;l.envMap.value=e.texture,l.samples.value=f,l.weights.value=p,l.latitudinal.value="latitudinal"===i,o&&(l.poleAxis.value=o),l.dTheta.value=d,l.mipInt.value=8-n,l.inputEncoding.value=jh[e.texture.encoding],l.outputEncoding.value=jh[e.texture.encoding];var A=Kh[r];rf(t,3*Math.max(0,Mh-2*A),(0===r?0:2*Mh)+2*A*(r>4?r-8+4:0),3*A,2*A),s.setRenderTarget(t),s.render(c,Hh)}}]),e}();function ef(e){return void 0!==e&&e.type===je&&(e.encoding===dn||e.encoding===hn||e.encoding===fn)}function tf(){for(var e=[],t=[],n=[],r=8,a=0;a<Th;a++){var i=Math.pow(2,r);t.push(i);var o=1/i;a>4?o=Vh[a-8+4-1]:0==a&&(o=0),n.push(o);for(var s=1/(i-1),u=-s/2,c=1+s/2,l=[u,u,c,u,c,c,u,u,c,c,u,c],g=new Float32Array(108),d=new Float32Array(72),h=new Float32Array(36),f=0;f<6;f++){var p=f%3*2/3-1,I=f>2?0:-1,C=[p,I,0,p+2/3,I,0,p+2/3,I+1,0,p,I,0,p+2/3,I+1,0,p,I+1,0];g.set(C,18*f),d.set(l,12*f);var m=[f,f,f,f,f,f];h.set(m,6*f)}var b=new li;b.setAttribute("position",new Ya(g,3)),b.setAttribute("uv",new Ya(d,2)),b.setAttribute("faceIndex",new Ya(h,1)),e.push(b),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function nf(e){var t=new lr(3*Mh,3*Mh,e);return t.texture.mapping=Ge,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function rf(e,t,n,r,a){e.viewport.set(t,n,r,a),e.scissor.set(t,n,r,a)}function af(){var e=new nr(1,1);return new Il({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:jh[dn]},outputEncoding:{value:jh[dn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:F,depthTest:!1,depthWrite:!1})}function of(){return new Il({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:jh[dn]},outputEncoding:{value:jh[dn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:F,depthTest:!1,depthWrite:!1})}var sf=0,uf=1,cf=0,lf=1,gf=2;function df(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function hf(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function ff(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new cc(e,t)}function pf(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Su(e)}function If(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new cc(e,t)}function Cf(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ac(e)}function mf(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ac(e)}function bf(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ac(e)}function vf(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new hr(e,t,n)}function Af(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Ya(e,t).setUsage(Xn)}function yf(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new za(e,t)}function wf(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ka(e,t)}function Gf(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new _a(e,t)}function Bf(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Da(e,t)}function xf(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Pa(e,t)}function Sf(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ua(e,t)}function kf(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ja(e,t)}function Zf(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new qa(e,t)}function Rf(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new $a(e,t)}function Nf(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Nh(e)}function Of(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new xh(e,t)}function Wf(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new nc(new Gc(e.geometry),new Du({color:void 0!==t?t:16777215}))}function Ff(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new nc(new hl(e.geometry),new Du({color:void 0!==t?t:16777215}))}function Mf(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new _l(e)}function Vf(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ql(e)}function Tf(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Li(e,n)}function Ef(){console.error("THREE.CanvasRenderer has been removed")}function jf(){console.error("THREE.JSONLoader has been removed.")}$l.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create($l.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},vg.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},hh.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},oh.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},zl.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Yg.extractUrlBase(e)},zl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Jd.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Jd.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Jd.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Jd.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Ir.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Ir.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ir.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ir.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Ir.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Mr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},zi.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},$d.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},tr.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},tr.nearestPowerOfTwo=function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),tr.floorPowerOfTwo(e)},tr.nextPowerOfTwo=function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),tr.ceilPowerOfTwo(e)},ar.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},ar.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ar.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ar.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ar.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ar.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},zr.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},zr.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},zr.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new hr).setFromMatrixColumn(this,3)},zr.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},zr.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},zr.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},zr.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},zr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},zr.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},zr.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},zr.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},zr.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},zr.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},zr.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},zr.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},zr.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},zr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},zr.prototype.makeFrustum=function(e,t,n,r,a,i){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,a,i)},zr.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ba.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},dr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},dr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Yr.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Yr.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},Yr.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Ra.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Ra.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Ra.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Ra.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Ra.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Ra.barycoordFromPoint=function(e,t,n,r,a){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ra.getBarycoord(e,t,n,r,a)},Ra.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ra.getNormal(e,t,n,r)},Ag.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Ag.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new $c(this,e)},Ag.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ol(this,e)},nr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},nr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},nr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},hr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},hr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},hr.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},hr.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},hr.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},hr.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},hr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},hr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},hr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},cr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},cr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},pa.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},pa.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},pa.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},pa.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},pa.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(pa.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ki.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ki.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),cn},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Tu.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty($l.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Vi.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(yg.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Ya.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Xn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Xn)}}}),Ya.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Xn:Ln),this},Ya.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Ya.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},li.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},li.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Ya(arguments[1],arguments[2])))},li.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},li.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},li.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},li.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},li.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(li.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(zg.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(zd.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(lu.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Xn},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),lu.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Xn:Ln),this},lu.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},$c.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},$c.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},$c.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},cu.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Xd.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Oa.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ja}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===O}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(ml.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Fi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),iu.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},iu.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},iu.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},iu.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},iu.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},iu.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},iu.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},iu.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},iu.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},iu.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},iu.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},iu.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},iu.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},iu.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},iu.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},iu.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},iu.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},iu.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},iu.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},iu.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},iu.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},iu.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},iu.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},iu.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},iu.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(iu.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?hn:dn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Js.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(lr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),md.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new id).load(e,(function(e){t.setBuffer(e)})),this},Gd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ei.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Ei.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},ir.crossOrigin=void 0,ir.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var a=new ql;a.setCrossOrigin(this.crossOrigin);var i=a.load(e,n,void 0,r);return t&&(i.mapping=t),i},ir.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var a=new Jl;a.setCrossOrigin(this.crossOrigin);var i=a.load(e,n,void 0,r);return t&&(i.mapping=t),i},ir.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ir.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Lf={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Xf(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:m}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(141);function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(r.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}},function(e,t,n){"use strict";function r(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){r(o,a,i,s,u,"next",e)}function u(e){r(o,a,i,s,u,"throw",e)}s(void 0)}))}}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({reshape_:function(e,t){var n={x:Object(i.a)(e,"x","reshape","string_or_numeric")},o={shape:t};return r.a.runKernel(a.oc,n,o)}})},function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function a(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));for(var n,r,a=e.length,i=0;a>0;)i=Math.random()*a|0,n=e[--a],r=t[a],e[a]=e[i],t[a]=t[i],e[i]=n,t[i]=r}function i(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2===0?e:e+1}function s(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function u(e,t){var n=Math.random();return t*n+(1-n)*e}function c(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function l(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l(I(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function d(e){l(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||N(e)&&!n)for(var r=0;r<e.length;++r)h(e[r],t,n);else t.push(e);return t}function f(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function p(e){return 0===e.length}function I(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function C(e){return e%1===0}function m(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function b(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function v(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return r(t),t}function A(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function w(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function G(e,t){var n=t.length;return l((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),l(e.every((function(e){return C(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function B(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:G(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function x(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function S(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function k(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function Z(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function R(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function N(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function O(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function W(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function F(e){return"string"===typeof e||e instanceof String}function M(e){return"boolean"===typeof e}function V(e){return"number"===typeof e}function T(e){return Array.isArray(e)?T(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":V(e)?"float32":F(e)?"string":M(e)?"bool":"float32"}function E(e){return!!(e&&e.constructor&&e.call&&e.apply)}function j(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function L(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function X(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var s=t[0],u=t.slice(1),c=u.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<s;l++)a[l]=X(e+l*c,u,n,r);return a}function H(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return X(0,e,t,n)}function Y(e,t){for(var n=z(e,t),r=0;r<n.length;r++)n[r]=1;return n}function z(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function K(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return H(e,new Float32Array(n));if("int32"===t)return H(e,new Int32Array(n));if("bool"===t)return H(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function _(e){e.forEach((function(t){l(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function D(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function P(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function U(e){return e&&e.then&&"function"===typeof e.then}n.d(t,"M",(function(){return r})),n.d(t,"N",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"H",(function(){return o})),n.d(t,"R",(function(){return s})),n.d(t,"J",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return d})),n.d(t,"m",(function(){return h})),n.d(t,"O",(function(){return f})),n.d(t,"y",(function(){return p})),n.d(t,"a",(function(){return I})),n.d(t,"v",(function(){return C})),n.d(t,"S",(function(){return m})),n.d(t,"P",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"L",(function(){return A})),n.d(t,"K",(function(){return y})),n.d(t,"s",(function(){return w})),n.d(t,"I",(function(){return G})),n.d(t,"Q",(function(){return B})),n.d(t,"o",(function(){return x})),n.d(t,"n",(function(){return S})),n.d(t,"h",(function(){return k})),n.d(t,"B",(function(){return Z})),n.d(t,"p",(function(){return R})),n.d(t,"A",(function(){return N})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return W})),n.d(t,"z",(function(){return F})),n.d(t,"t",(function(){return M})),n.d(t,"w",(function(){return V})),n.d(t,"r",(function(){return T})),n.d(t,"u",(function(){return E})),n.d(t,"G",(function(){return j})),n.d(t,"j",(function(){return L})),n.d(t,"T",(function(){return H})),n.d(t,"D",(function(){return Y})),n.d(t,"F",(function(){return z})),n.d(t,"E",(function(){return K})),n.d(t,"c",(function(){return _})),n.d(t,"C",(function(){return D})),n.d(t,"q",(function(){return P})),n.d(t,"x",(function(){return U}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({mul_:function(e,t){var n=Object(s.a)(e,"a","mul"),u=Object(s.a)(t,"b","mul"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.Vb,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(206);var a=n(264),i=n(141);function o(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||Object(a.a)(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22);function a(e,t,n){return(a="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(r.a)(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}},function(e,t,n){"use strict";n.r(t),n.d(t,"shuffle",(function(){return a.M})),n.d(t,"shuffleCombo",(function(){return a.N})),n.d(t,"clamp",(function(){return a.i})),n.d(t,"nearestLargerEven",(function(){return a.H})),n.d(t,"sum",(function(){return a.R})),n.d(t,"randUniform",(function(){return a.J})),n.d(t,"distSquared",(function(){return a.l})),n.d(t,"assert",(function(){return a.b})),n.d(t,"assertShapesMatch",(function(){return a.e})),n.d(t,"assertNonNull",(function(){return a.d})),n.d(t,"flatten",(function(){return a.m})),n.d(t,"sizeFromShape",(function(){return a.O})),n.d(t,"isScalarShape",(function(){return a.y})),n.d(t,"arraysEqual",(function(){return a.a})),n.d(t,"isInt",(function(){return a.v})),n.d(t,"tanh",(function(){return a.S})),n.d(t,"sizeToSquarishShape",(function(){return a.P})),n.d(t,"createShuffledIndices",(function(){return a.k})),n.d(t,"rightPad",(function(){return a.L})),n.d(t,"repeatedTry",(function(){return a.K})),n.d(t,"inferFromImplicitShape",(function(){return a.s})),n.d(t,"parseAxisParam",(function(){return a.I})),n.d(t,"squeezeShape",(function(){return a.Q})),n.d(t,"getTypedArrayFromDType",(function(){return a.o})),n.d(t,"getArrayFromDType",(function(){return a.n})),n.d(t,"checkConversionForErrors",(function(){return a.h})),n.d(t,"isValidDtype",(function(){return a.B})),n.d(t,"hasEncodingLoss",(function(){return a.p})),n.d(t,"isTypedArray",(function(){return a.A})),n.d(t,"bytesPerElement",(function(){return a.g})),n.d(t,"bytesFromStringArray",(function(){return a.f})),n.d(t,"isString",(function(){return a.z})),n.d(t,"isBoolean",(function(){return a.t})),n.d(t,"isNumber",(function(){return a.w})),n.d(t,"inferDtype",(function(){return a.r})),n.d(t,"isFunction",(function(){return a.u})),n.d(t,"nearestDivisor",(function(){return a.G})),n.d(t,"computeStrides",(function(){return a.j})),n.d(t,"toNestedArray",(function(){return a.T})),n.d(t,"makeOnesTypedArray",(function(){return a.D})),n.d(t,"makeZerosTypedArray",(function(){return a.F})),n.d(t,"makeZerosNestedTypedArray",(function(){return a.E})),n.d(t,"assertNonNegativeIntegerDimensions",(function(){return a.c})),n.d(t,"locToIndex",(function(){return a.C})),n.d(t,"indexToLoc",(function(){return a.q})),n.d(t,"isPromise",(function(){return a.x})),n.d(t,"hexToLong",(function(){return s})),n.d(t,"fingerPrint64",(function(){return A})),n.d(t,"createScalarValue",(function(){return y})),n.d(t,"toTypedArray",(function(){return w})),n.d(t,"now",(function(){return G})),n.d(t,"fetch",(function(){return B})),n.d(t,"encodeString",(function(){return x})),n.d(t,"decodeString",(function(){return S}));var r=n(36),a=n(19),i=n(283),o=n.n(i).a||i;function s(e){return o.fromString(e,!0,16)}var u=s("c3a5c85c97cb3127"),c=s("b492b66fbe98f273"),l=s("9ae16a3b2f90404f");function g(e){return e.xor(e.shru(47))}function d(e,t,n){var r=e.slice(t,t+n);return o.fromBytes(Array.from(r),!0,!0)}function h(e,t){return d(e,t,8)}function f(e,t){return d(e,t,4)}function p(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function C(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=p(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(p(a,44)),[a.add(r),i.add(o)]}(h(e,t),h(e,t+8),h(e,t+16),h(e,t+24),n,r)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=l.add(2*t),r=h(e,0).add(l),a=h(e,t-8),i=p(a,37).mul(n).add(r),o=p(r,25).add(a).mul(n);return I(i,o,n)}if(t>=4){var s=l.add(2*t),c=f(e,0);return I(c.shl(3).add(t),f(e,t-4),s)}if(t>0){var d=e[0],C=e[t>>1],m=e[t-1],b=d+(C<<8),v=t+(m<<2);return g(l.mul(b).xor(u.mul(v))).mul(l)}return l}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l.add(2*t),r=h(e,0).mul(c),a=h(e,8),i=h(e,t-8).mul(n),o=h(e,t-16).mul(l);return I(p(r.add(a),43).add(p(i,30)).add(o),r.add(p(a.add(l),18)).add(i),n)}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l.add(2*t),r=h(e,0).mul(l),a=h(e,8),i=h(e,t-8).mul(n),o=h(e,t-16).mul(l),s=p(r.add(a),43).add(p(i,30)).add(o),u=I(s,r.add(p(a.add(l),18)).add(i),n),c=h(e,16).mul(n),g=h(e,24),d=s.add(h(e,t-32)).mul(n),f=u.add(h(e,t-24)).mul(n);return I(p(c.add(g),43).add(p(d,30)).add(f),c.add(p(g.add(r),18)).add(d),n)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=o.fromNumber(81,!0);if(t<=32)return t<=16?m(e,t):b(e,t);if(t<=64)return v(e,t);var r=n,a=n.mul(c).add(113),i=g(a.mul(l).add(113)).mul(l),s=[o.UZERO,o.UZERO],d=[o.UZERO,o.UZERO];r=r.mul(l).add(h(e,0));var f=0,A=64*(t-1>>6),y=A+(t-1&63)-63;do{r=p(r.add(a).add(s[0]).add(h(e,f+8)),37).mul(c),a=p(a.add(s[1]).add(h(e,f+48)),42).mul(c),r=r.xor(d[1]),a=a.add(s[0]).add(h(e,f+40)),i=p(i.add(d[0]),33).mul(c),s=C(e,f,s[1].mul(c),r.add(d[0])),d=C(e,f+32,i.add(d[1]),a.add(h(e,f+16)));var w=[r,i];i=w[0],r=w[1],f+=64}while(f!==A);var G=c.add(i.and(255).shl(1));f=y,d[0]=d[0].add(t-1&63),s[0]=s[0].add(d[0]),d[0]=d[0].add(s[0]),r=p(r.add(a).add(s[0]).add(h(e,f+8)),37).mul(G),a=p(a.add(s[1]).add(h(e,f+48)),42).mul(G),r=r.xor(d[1].mul(9)),a=a.add(s[0].mul(9).add(h(e,f+40))),i=p(i.add(d[0]),33).mul(G),s=C(e,f,s[1].mul(G),r.add(d[0])),d=C(e,f+32,i.add(d[1]),a.add(h(e,f+16)));var B=[r,i];return i=B[0],r=B[1],I(I(s[0],d[0],G).add(g(a).mul(u)).add(i),I(s[1],d[1],G).add(r),G)}function y(e,t){return"string"===t?x(e):w([e],t)}function w(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=a.m(e)),Object(r.b)().getBool("DEBUG")&&a.h(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),i=0;i<n.length;++i)0!==Math.round(e[i])&&(n[i]=1);return n}throw new Error("Unknown data type ".concat(t))}function G(){return Object(r.b)().platform.now()}function B(e,t){return Object(r.b)().platform.fetch(e,t)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.b)().platform.encode(e,t)}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.b)().platform.decode(e,t)}},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(41);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({cast_:function(e,t){var n=Object(i.a)(e,"x","cast");if(!o.B(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var s={x:n},u={dtype:t};return r.a.runKernel(a.w,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({add_:function(e,t){var n=Object(s.a)(e,"a","add"),u=Object(s.a)(t,"b","add"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.d,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({sub_:function(e,t){var n=Object(s.a)(e,"a","sub"),u=Object(s.a)(t,"b","sub"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.Wc,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(168),c=n(10);var l=Object(c.b)({div_:function(e,t){var n=Object(s.a)(e,"a","div"),c=Object(s.a)(t,"b","div"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);if(n=g[0],c=g[1],"int32"===n.dtype&&"int32"===c.dtype)return Object(u.a)(n,c);var d={a:n,b:c};return a.a.runKernel(i.kc,d,{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(27),s=n(10);var u=Object(s.b)({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(i.a)(e,"x","sum");"bool"===s.dtype&&(s=Object(o.a)(s,"int32"));var u={x:s},c={axis:t,keepDims:n};return r.a.runKernel(a.Xc,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19),a=n(79);function i(e,t){if((Object(r.A)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Object(r.A)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(a.a)(e,[],[],t)}},function(e,t,n){"use strict";function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}n.unshift(i)}}return n}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({zerosLike_:function(e){var t={x:Object(i.a)(e,"x","zerosLike")};return r.a.runKernel(a.hd,t)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"f",(function(){return u.a})),n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"i",(function(){return g.a})),n.d(t,"j",(function(){return d.a})),n.d(t,"k",(function(){return h.a})),n.d(t,"l",(function(){return f.a})),n.d(t,"m",(function(){return p.a})),n.d(t,"n",(function(){return I.a})),n.d(t,"o",(function(){return C.a})),n.d(t,"p",(function(){return m.a})),n.d(t,"q",(function(){return b.a})),n.d(t,"r",(function(){return k})),n.d(t,"w",(function(){return Z.a})),n.d(t,"s",(function(){return R.a})),n.d(t,"t",(function(){return O})),n.d(t,"u",(function(){return W})),n.d(t,"v",(function(){return F})),n.d(t,"x",(function(){return M.a})),n.d(t,"z",(function(){return V.a})),n.d(t,"A",(function(){return T.a})),n.d(t,"B",(function(){return E.a})),n.d(t,"C",(function(){return j.a})),n.d(t,"D",(function(){return L.a})),n.d(t,"E",(function(){return X.a})),n.d(t,"F",(function(){return H.a})),n.d(t,"G",(function(){return A.a})),n.d(t,"H",(function(){return Y})),n.d(t,"I",(function(){return z})),n.d(t,"J",(function(){return K})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return D.a})),n.d(t,"M",(function(){return P.a})),n.d(t,"N",(function(){return U.a})),n.d(t,"O",(function(){return J.a})),n.d(t,"P",(function(){return q})),n.d(t,"Q",(function(){return $.a})),n.d(t,"R",(function(){return ee.a})),n.d(t,"T",(function(){return te.a})),n.d(t,"U",(function(){return ne.a})),n.d(t,"V",(function(){return re.a})),n.d(t,"W",(function(){return ae.a})),n.d(t,"X",(function(){return se})),n.d(t,"Y",(function(){return ue.a})),n.d(t,"Z",(function(){return ce.a})),n.d(t,"ab",(function(){return le.a})),n.d(t,"bb",(function(){return ge.a})),n.d(t,"db",(function(){return de.a})),n.d(t,"eb",(function(){return he.a})),n.d(t,"gb",(function(){return fe.a})),n.d(t,"hb",(function(){return pe.a})),n.d(t,"ib",(function(){return Ie.a})),n.d(t,"jb",(function(){return Ce.a})),n.d(t,"kb",(function(){return me.a})),n.d(t,"lb",(function(){return Ae})),n.d(t,"nb",(function(){return ye.a})),n.d(t,"ob",(function(){return we.a})),n.d(t,"pb",(function(){return Ge.a})),n.d(t,"rb",(function(){return Be.a})),n.d(t,"tb",(function(){return xe.a})),n.d(t,"ub",(function(){return Se.a})),n.d(t,"wb",(function(){return ke.a})),n.d(t,"Ab",(function(){return Ze.a})),n.d(t,"Bb",(function(){return Re.a})),n.d(t,"Cb",(function(){return Ne.a})),n.d(t,"Db",(function(){return Oe.a})),n.d(t,"Eb",(function(){return We.a})),n.d(t,"Fb",(function(){return Fe.a})),n.d(t,"Hb",(function(){return Me.a})),n.d(t,"Ib",(function(){return Ve.a})),n.d(t,"Jb",(function(){return Te.a})),n.d(t,"Kb",(function(){return Ee.a})),n.d(t,"Lb",(function(){return je.a})),n.d(t,"Mb",(function(){return Le.a})),n.d(t,"Nb",(function(){return Xe.a})),n.d(t,"Ob",(function(){return He.a})),n.d(t,"Pb",(function(){return Ye.a})),n.d(t,"Qb",(function(){return ze.a})),n.d(t,"Rb",(function(){return Ke.a})),n.d(t,"Tb",(function(){return y.a})),n.d(t,"Ub",(function(){return _e.a})),n.d(t,"Vb",(function(){return De.a})),n.d(t,"Wb",(function(){return Pe.a})),n.d(t,"Xb",(function(){return Ue.a})),n.d(t,"Yb",(function(){return Je.a})),n.d(t,"Zb",(function(){return Qe.a})),n.d(t,"ac",(function(){return et})),n.d(t,"bc",(function(){return tt.a})),n.d(t,"cc",(function(){return nt.a})),n.d(t,"dc",(function(){return rt.a})),n.d(t,"ec",(function(){return at.a})),n.d(t,"fc",(function(){return ut})),n.d(t,"hc",(function(){return w.a})),n.d(t,"ic",(function(){return ct})),n.d(t,"jc",(function(){return lt.a})),n.d(t,"kc",(function(){return gt.a})),n.d(t,"mc",(function(){return dt.a})),n.d(t,"nc",(function(){return ht.a})),n.d(t,"oc",(function(){return qe.a})),n.d(t,"pc",(function(){return ft.a})),n.d(t,"rc",(function(){return pt})),n.d(t,"sc",(function(){return It.a})),n.d(t,"tc",(function(){return Ct})),n.d(t,"uc",(function(){return mt})),n.d(t,"vc",(function(){return bt})),n.d(t,"wc",(function(){return vt})),n.d(t,"xc",(function(){return At.a})),n.d(t,"yc",(function(){return yt.a})),n.d(t,"zc",(function(){return wt.a})),n.d(t,"Ac",(function(){return Gt.a})),n.d(t,"Bc",(function(){return Bt.a})),n.d(t,"Cc",(function(){return xt})),n.d(t,"Dc",(function(){return kt})),n.d(t,"Ec",(function(){return Zt})),n.d(t,"Fc",(function(){return Rt.a})),n.d(t,"Gc",(function(){return Nt.a})),n.d(t,"Hc",(function(){return Ot.a})),n.d(t,"Ic",(function(){return Wt.a})),n.d(t,"Jc",(function(){return Ft.a})),n.d(t,"Kc",(function(){return Mt.a})),n.d(t,"Lc",(function(){return be.a})),n.d(t,"Mc",(function(){return Vt.a})),n.d(t,"Nc",(function(){return Tt})),n.d(t,"Oc",(function(){return Et})),n.d(t,"Pc",(function(){return jt})),n.d(t,"Qc",(function(){return Lt})),n.d(t,"Sc",(function(){return Xt.a})),n.d(t,"Tc",(function(){return Ht.a})),n.d(t,"Uc",(function(){return Yt.a})),n.d(t,"Wc",(function(){return zt.a})),n.d(t,"Xc",(function(){return Kt.a})),n.d(t,"Yc",(function(){return _t.a})),n.d(t,"Zc",(function(){return B.a})),n.d(t,"ad",(function(){return Dt.a})),n.d(t,"cd",(function(){return Pt.a})),n.d(t,"dd",(function(){return Ut.a})),n.d(t,"ed",(function(){return x.a})),n.d(t,"fd",(function(){return Jt})),n.d(t,"gd",(function(){return Qt})),n.d(t,"hd",(function(){return qt})),n.d(t,"id",(function(){return $t})),n.d(t,"jd",(function(){return en.a})),n.d(t,"kd",(function(){return tn.a})),n.d(t,"ld",(function(){return nn.a})),n.d(t,"mb",(function(){return rn.a})),n.d(t,"vb",(function(){return an.a})),n.d(t,"zb",(function(){return on.a})),n.d(t,"Rc",(function(){return sn.a})),n.d(t,"pd",(function(){return un.a})),n.d(t,"qd",(function(){return cn.a})),n.d(t,"rd",(function(){return ot.a})),n.d(t,"sd",(function(){return ln.a})),n.d(t,"td",(function(){return gn.a})),n.d(t,"ud",(function(){return dn.a})),n.d(t,"vd",(function(){return hn.a})),n.d(t,"wd",(function(){return fn.a})),n.d(t,"yd",(function(){return st.a})),n.d(t,"zd",(function(){return pn.a})),n.d(t,"Ad",(function(){return In.a})),n.d(t,"Bd",(function(){return S.a})),n.d(t,"Cd",(function(){return Cn.a})),n.d(t,"Dd",(function(){return mn.a})),n.d(t,"Ed",(function(){return vn})),n.d(t,"Fd",(function(){return An.a})),n.d(t,"Gd",(function(){return yn})),n.d(t,"Hd",(function(){return wn})),n.d(t,"Id",(function(){return Gn})),n.d(t,"Jd",(function(){return ve.a})),n.d(t,"Kd",(function(){return Bn.a})),n.d(t,"Md",(function(){return xn.a})),n.d(t,"Nd",(function(){return Sn.a})),n.d(t,"Od",(function(){return kn.a})),n.d(t,"Pd",(function(){return Zn.a})),n.d(t,"Qd",(function(){return Rn})),n.d(t,"Rd",(function(){return Nn.a})),n.d(t,"Sd",(function(){return On.a})),n.d(t,"Td",(function(){return Wn.a})),n.d(t,"Ud",(function(){return Fn.a})),n.d(t,"y",(function(){return jn})),n.d(t,"Ld",(function(){return Ln.a})),n.d(t,"lc",(function(){return Xn.a})),n.d(t,"gc",(function(){return Yn})),n.d(t,"Vc",(function(){return zn.a})),n.d(t,"nd",(function(){return Kn.a})),n.d(t,"sb",(function(){return _n.a})),n.d(t,"cb",(function(){return Dn})),n.d(t,"fb",(function(){return Pn})),n.d(t,"S",(function(){return Un})),n.d(t,"yb",(function(){return Qn})),n.d(t,"qc",(function(){return G.b})),n.d(t,"a",(function(){return G.a})),n.d(t,"xb",(function(){return ia})),n.d(t,"Gb",(function(){return oa})),n.d(t,"Sb",(function(){return sa})),n.d(t,"od",(function(){return ra})),n.d(t,"qb",(function(){return r})),n.d(t,"bd",(function(){return aa})),n.d(t,"md",(function(){return ua})),n.d(t,"xd",(function(){return ca}));var r={};n.r(r),n.d(r,"conv2d",(function(){return ir})),n.d(r,"depthwiseConv2d",(function(){return ur})),n.d(r,"matMul",(function(){return cr}));var a=n(71),i=n(297),o=n(298),s=n(28),u=n(299),c=n(221),l=n(222),g=n(223),d=n(224),h=n(300),f=n(301),p=n(302),I=n(225),C=n(303),m=n(165),b=n(304),v=n(5),A=n(54),y=n(44),w=n(20),G=n(10),B=n(108),x=n(45),S=n(204);var k=Object(G.b)({basicLSTMCell_:function(e,t,n,r,a,i){var o=Object(v.a)(e,"forgetBias","basicLSTMCell"),u=Object(v.a)(t,"lstmKernel","basicLSTMCell"),c=Object(v.a)(n,"lstmBias","basicLSTMCell"),l=Object(v.a)(r,"data","basicLSTMCell"),g=Object(v.a)(a,"c","basicLSTMCell"),d=Object(v.a)(i,"h","basicLSTMCell"),h=Object(A.a)([l,d],1),f=Object(y.a)(h,u),p=Object(s.a)(f,c),I=p.shape[0],C=p.shape[1]/4,m=[I,C],b=Object(x.a)(p,[0,0],m),G=Object(x.a)(p,[0,C],m),k=Object(x.a)(p,[0,2*C],m),Z=Object(x.a)(p,[0,3*C],m),R=Object(s.a)(Object(w.a)(Object(B.a)(b),Object(S.a)(G)),Object(w.a)(g,Object(B.a)(Object(s.a)(o,k))));return[R,Object(w.a)(Object(S.a)(R),Object(B.a)(Z))]}}),Z=n(132),R=n(118),N=n(19);var O=Object(G.b)({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=Object(v.a)(e,"x","batchNorm"),c=Object(v.a)(t,"mean","batchNorm"),l=Object(v.a)(n,"variance","batchNorm");return null!=a&&(o=Object(v.a)(a,"scale","batchNorm")),null!=r&&(s=Object(v.a)(r,"offset","batchNorm")),N.b(2===u.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(u.rank,".")})),N.b(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),N.b(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&N.b(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&N.b(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),Object(R.a)(u,c,l,s,o,i)}});var W=Object(G.b)({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=Object(v.a)(e,"x","batchNorm"),c=Object(v.a)(t,"mean","batchNorm"),l=Object(v.a)(n,"variance","batchNorm");return null!=a&&(o=Object(v.a)(a,"scale","batchNorm")),null!=r&&(s=Object(v.a)(r,"offset","batchNorm")),N.b(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),N.b(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),N.b(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&N.b(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&N.b(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),Object(R.a)(u,c,l,s,o,i)}});var F=Object(G.b)({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=Object(v.a)(e,"x","batchNorm"),c=Object(v.a)(t,"mean","batchNorm"),l=Object(v.a)(n,"variance","batchNorm");return null!=a&&(o=Object(v.a)(a,"scale","batchNorm")),null!=r&&(s=Object(v.a)(r,"offset","batchNorm")),N.b(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),N.b(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),N.b(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&N.b(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&N.b(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),Object(R.a)(u,c,l,s,o,i)}}),M=n(226),V=n(143),T=n(76),E=n(27),j=n(305),L=n(306),X=n(107),H=n(93);var Y=Object(G.b)({concat1d_:function(e){return Object(A.a)(e,0)}});var z=Object(G.b)({concat2d_:function(e,t){return Object(A.a)(e,t)}});var K=Object(G.b)({concat3d_:function(e,t){return Object(A.a)(e,t)}});var _=Object(G.b)({concat4d_:function(e,t){return Object(A.a)(e,t)}}),D=n(227),P=n(103),U=n(228),J=n(307),Q=n(267);var q=Object(G.b)({conv3dTranspose_:function(e,t,n,r,a){var i=Object(v.a)(e,"x","conv3dTranspose"),o=Object(v.a)(t,"filter","conv3dTranspose");return Object(Q.a)(n,i,o,r,a)}}),$=n(166),ee=n(229),te=n(167),ne=n(308),re=n(230),ae=n(133),ie=n(11),oe=n(6);var se=Object(G.b)({diag_:function(e){var t={x:Object(v.a)(e,"x","diag")};return ie.a.runKernel(oe.R,t)}}),ue=n(231),ce=n(30),le=n(232),ge=n(233),de=n(309),he=n(169),fe=n(134),pe=n(310),Ie=n(69),Ce=n(100),me=n(311),be=n(18),ve=n(120);var Ae=Object(G.b)({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=Object(T.a)([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=Object(be.a)(a.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return Object(ve.a)(Object(Ce.a)(s,0),[n[0],1,1]);if(2===n.length)return Object(ve.a)(Object(Ce.a)(Object(Ce.a)(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(ve.a)(Object(Ce.a)(Object(Ce.a)(Object(Ce.a)(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),ye=n(135),we=n(170),Ge=n(168),Be=n(136),xe=n(70),Se=n(104),ke=n(171),Ze=n(312),Re=n(313),Ne=n(314),Oe=n(172),We=n(173),Fe=n(87),Me=n(315),Ve=n(234),Te=n(112),Ee=n(235),je=n(316),Le=n(317),Xe=n(174),He=n(94),Ye=n(137),ze=n(175),Ke=n(237),_e=n(109),De=n(176),Pe=n(318),Ue=n(319),Je=n(138),Qe=n(129),qe=n(86),$e=n(14);function et(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.indexing,a=void 0===r?"xy":r;if("xy"!==a&&"ij"!==a)throw new TypeError("".concat(a," is not a valid third argument to meshgrid"));if(void 0===e)return[];var i=Object(v.a)(e,"x","meshgrid",e instanceof $e.a?e.dtype:"float32");if(void 0===t)return[i];var o=Object(v.a)(t,"y","meshgrid",t instanceof $e.a?t.dtype:"float32"),s=Object(N.O)(i.shape),u=Object(N.O)(o.shape);return"xy"===a?(i=Object(be.a)(i,[1,-1]),o=Object(be.a)(o,[-1,1]),[Object(y.a)(Object(qe.a)([u,1],i.dtype),i),Object(y.a)(o,Object(qe.a)([1,s],o.dtype))]):(i=Object(be.a)(i,[-1,1]),o=Object(be.a)(o,[1,-1]),[Object(y.a)(i,Object(qe.a)([1,u],i.dtype)),Object(y.a)(Object(qe.a)([s,1],o.dtype),o)])}var tt=n(151),nt=n(177),rt=n(238),at=n(239),it=n(67),ot=n(43),st=n(29);var ut=Object(G.b)({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Object(v.a)(e,"x","moments");var r=Object(N.I)(t,e.shape),a=Object(Qe.a)(e,r,n),i=a.shape;n||(i=Object(it.e)(a.shape,r));var o=Object(ot.a)(Object(st.a)(Object(E.a)(e,"float32"),Object(be.a)(a,i))),s=Object(Qe.a)(o,r,n);return{mean:a,variance:s}}});var ct=Object(G.b)({multiRNNCell_:function(e,t,n,r){for(var a=Object(v.a)(t,"data","multiRNNCell"),i=Object(v.b)(n,"c","multiRNNCell"),o=Object(v.b)(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}for(var g=[],d=[],h=0;h<u.length;h+=2)g.push(u[h]),d.push(u[h+1]);return[g,d]}}),lt=n(320),gt=n(49),dt=n(178),ht=n(240),ft=n(321);var pt=Object(G.b)({outerProduct_:function(e,t){var n=Object(v.a)(e,"v1","outerProduct"),r=Object(v.a)(t,"v2","outerProduct");N.b(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=Object(be.a)(n,[-1,1]),i=Object(be.a)(r,[1,-1]);return Object(y.a)(a,i)}}),It=n(88);var Ct=Object(G.b)({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(N.b)(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Object(It.a)(e,[t],n)}});var mt=Object(G.b)({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(N.b)(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(It.a)(e,t,n)}});var bt=Object(G.b)({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(N.b)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(It.a)(e,t,n)}});var vt=Object(G.b)({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(N.b)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Object(It.a)(e,t,n)}}),At=n(241),yt=n(85),wt=n(179),Gt=n(220),Bt=n(242);var xt=Object(G.b)({rand_:function(e,t,n){var r=Object(N.O)(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return ie.a.makeTensor(a,e,n)}}),St=n(144);var kt=Object(G.b)({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new St.b(t,n,r,a),o=Object(T.a)(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});var Zt=Object(G.b)({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new St.a(t,n,r,!1,a),o=Object(T.a)(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Rt=n(243),Nt=n(145),Ot=n(152),Wt=n(322),Ft=n(115),Mt=n(180),Vt=n(77);var Tt=Object(G.b)({reverse1d_:function(e){var t=Object(v.a)(e,"x","reverse");return N.b(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),Object(Vt.a)(t,0)}});var Et=Object(G.b)({reverse2d_:function(e,t){var n=Object(v.a)(e,"x","reverse");return N.b(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),Object(Vt.a)(n,t)}});var jt=Object(G.b)({reverse3d_:function(e,t){var n=Object(v.a)(e,"x","reverse");return N.b(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),Object(Vt.a)(n,t)}});var Lt=Object(G.b)({reverse4d_:function(e,t){var n=Object(v.a)(e,"x","reverse");return N.b(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),Object(Vt.a)(n,t)}}),Xt=n(244),Ht=n(245),Yt=n(32),zt=n(246),Kt=n(247),_t=n(323),Dt=n(324),Pt=n(248),Ut=n(249);var Jt=Object(G.b)({slice1d_:function(e,t,n){var r=Object(v.a)(e,"x","slice1d");return N.b(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Object(x.a)(r,[t],[n])}});var Qt=Object(G.b)({slice2d_:function(e,t,n){var r=Object(v.a)(e,"x","slice2d");return N.b(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Object(x.a)(r,t,n)}});var qt=Object(G.b)({slice3d_:function(e,t,n){var r=Object(v.a)(e,"x","slice3d");return N.b(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Object(x.a)(r,t,n)}});var $t=Object(G.b)({slice4d_:function(e,t,n){var r=Object(v.a)(e,"x","slice4d");return N.b(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Object(x.a)(r,t,n)}}),en=n(325),tn=n(236),nn=n(139),rn=n(181),an=n(153),on=n(250),sn=n(182),un=n(95),cn=n(65),ln=n(183),gn=n(140),dn=n(96),hn=n(116),fn=n(326),pn=n(31),In=n(327),Cn=n(119),mn=n(78),bn=n(79);function vn(e,t,n){if(Object(N.d)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Object(v.c)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(bn.a)(e,t,r,n)}var An=n(251);function yn(e,t,n){if(Object(N.d)(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Object(v.c)(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Object(bn.a)(e,t,r,n)}function wn(e,t,n){if(Object(N.d)(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Object(v.c)(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Object(bn.a)(e,t,r,n)}function Gn(e,t,n){if(Object(N.d)(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Object(v.c)(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,Object(bn.a)(e,t,r,n)}var Bn=n(252),xn=n(328),Sn=n(253),kn=n(184),Zn=n(117);function Rn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return ie.a.makeVariable(e,t,n,r)}var Nn=n(55),On=n(254),Wn=n(114),Fn=n(34),Mn=n(7),Vn=n.n(Mn),Tn=n(17);function En(){return(En=Object(Tn.a)(Vn.a.mark((function e(t,n,r){var a,i,o,s,u,c,l,g,d,h,f,p,I;return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=Object(v.a)(t,"tensor","boolMask"),i=Object(v.a)(n,"mask","boolMask","bool"),o=null==r?0:r,s=i.rank,u=a.shape,N.b(s>0,(function(){return"mask cannot be scalar"})),N.e(u.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+s;l++)c*=u[l];return g=u.slice(0,o).concat([c],u.slice(o+s)),d=Object(be.a)(a,g),h=Object(be.a)(i,[-1]),e.next=14,Object(On.a)(h);case 14:return f=e.sent,p=Object(gn.a)(f,[1]),I=Object(Be.a)(d,p,o),t!==a&&a.dispose(),n!==i&&i.dispose(),p.dispose(),d.dispose(),h.dispose(),f.dispose(),e.abrupt("return",I);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var jn=function(e,t,n){return En.apply(this,arguments)},Ln=n(89),Xn=n(185),Hn=n(37);var Yn=Object(G.b)({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=Object(v.a)(e,"v","movingAverage"),o=Object(v.a)(t,"x","movingAverage"),u=Object(v.a)(n,"decay","movingAverage");Object(Hn.assertTypesMatch)(i,o),N.b(N.a(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var c=Object(Yt.a)(1),l=Object(st.a)(c,u),g=Object(w.a)(Object(st.a)(o,i),l);if(a){N.b(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var d=Object(v.a)(r,"step","movingAverage");g=Object(ce.a)(g,Object(st.a)(c,Object(yt.a)(u,d)))}return Object(s.a)(i,g)}}),zn=n(329),Kn=n(336),_n=n(330);var Dn=Object(G.b)({dropout_:function(e,t,n,r){var a=Object(v.a)(e,"x","dropout");if(N.b("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),N.b(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof $e.a?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(N.a(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,u=Object(ce.a)(Object(we.a)(Object(s.a)(Object(Rt.a)(i,0,1,"float32",r),o)),o);return Object(w.a)(a,u)}});function Pn(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Un(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Object(mn.a)(a,"float32")}function Jn(){return(Jn=Object(Tn.a)(Vn.a.mark((function e(t,n){var r,a,i,o,s,u,c,l,g,d,h,f,p,I,C,m=arguments;return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m.length>2&&void 0!==m[2]?m[2]:1,a=Object(v.a)(t,"predictions","inTopK"),i=Object(v.a)(n,"targets","inTopK"),Object(N.b)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),Object(N.b)(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),Object(N.e)(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],Object(N.b)(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=10,a.data();case 10:return s=e.sent,e.next=13,i.data();case 13:u=e.sent,c=s.length/o,l=o,g=Object(N.o)("bool",c),d=0;case 17:if(!(d<c)){e.next=35;break}for(h=d*l,f=s.subarray(h,h+l),p=[],I=0;I<f.length;I++)p.push({value:f[I],index:I});p.sort((function(e,t){return t.value-e.value})),g[d]=0,C=0;case 25:if(!(C<r)){e.next=32;break}if(p[C].index!==u[d]){e.next=29;break}return g[d]=1,e.abrupt("break",32);case 29:C++,e.next=25;break;case 32:d++,e.next=17;break;case 35:return t!==a&&a.dispose(),n!==i&&i.dispose(),e.abrupt("return",Object(Cn.a)(g,i.shape,"bool"));case 38:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qn=function(e,t){return Jn.apply(this,arguments)},qn=n(3),$n=n(59),er=n(33),tr=n(192),nr=n(190),rr=n(53),ar=n(72);var ir=Object(G.b)({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,u=e.dilations,c=void 0===u?[1,1]:u,l=e.dimRoundingMode,g=e.bias,d=e.activation,h=void 0===d?"linear":d,f=e.preluActivationWeights,p=e.leakyreluAlpha;if(h=h||"linear",!1===Object(ar.d)(ie.a.state.gradientDepth,h)){var I=Object(P.a)(t,n,r,a,o,c,l);return null!=g&&(I=Object(s.a)(I,g)),Object(ar.a)(I,h,f,p)}var C=Object(v.a)(t,"x","conv2d"),m=Object(v.a)(n,"filter","conv2d"),b=C,A=!1;3===C.rank&&(A=!0,b=Object(be.a)(C,[1,C.shape[0],C.shape[1],C.shape[2]])),N.b(4===b.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(b.rank,".")})),N.b(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(m.rank,".")})),null!=l&&N.b(N.v(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(a,".")})),N.b(b.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input (".concat(b.shape[3],") must match ")+"input depth for filter ".concat(m.shape[2],".")})),N.b(rr.h(r,c),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(c,"'")})),N.b("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var y,w,G=rr.a(b.shape,m.shape,r,c,a,l);if(null!=g){y=Object(v.a)(g,"bias","fused conv2d");var B=Object(Hn.makeTypesMatch)(y,C);y=Object(qn.a)(B,1)[0],er.a(G.outShape,y.shape)}null!=f&&(w=Object(v.a)(f,"prelu weights","fused conv2d"));var x=function(e,t){var n=Object(qn.a)(t,4),i=n[0],o=n[1],s=n[2],u=n[3],l=Object(ar.c)(e,s,h);N.b(rr.i(c),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(c,"'")}));var g=[Object(nr.a)(o.shape,l,i,r,a),Object(tr.a)(o,l,i.shape,r,a)];if(null!=u){var d=Object(ar.b)(u,l);g.push(d)}return g},S={x:b,filter:m,bias:y,preluActivationWeights:w},k={strides:r,pad:a,dataFormat:o,dilations:c,dimRoundingMode:l,activation:h,leakyreluAlpha:p};return null==g?Object($n.a)((function(e,t,n){var r=ie.a.runKernel(oe.kb,S,k);return n([t,e,r]),A&&(r=Object(be.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:x}}))(b,m):Object($n.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.kb,S,k);return r([t,e,a,n]),A&&(a=Object(be.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:x}}))(b,m,y)}}),or=n(271),sr=n(270);var ur=Object(G.b)({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,u=e.dilations,c=void 0===u?[1,1]:u,l=e.dimRoundingMode,g=e.bias,d=e.activation,h=void 0===d?"linear":d,f=e.preluActivationWeights,p=e.leakyreluAlpha;if(!1===Object(ar.d)(ie.a.state.gradientDepth,h)){var I=Object(ae.a)(t,n,r,a,o,c,l);return null!=g&&(I=Object(s.a)(I,g)),Object(ar.a)(I,h,f,p)}var C=Object(v.a)(t,"x","depthwiseConv2d"),m=Object(v.a)(n,"filter","depthwiseConv2d"),b=C,A=!1;3===C.rank&&(A=!0,b=Object(be.a)(C,[1,C.shape[0],C.shape[1],C.shape[2]])),N.b(4===b.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(b.rank,".")})),N.b(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(m.rank,".")})),N.b(b.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(b.shape[3],") must match the inChannels dimension in ")+"filter ".concat(m.shape[2],".")})),null==c&&(c=[1,1]),N.b(rr.h(r,c),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(c,"'")})),null!=l&&N.b(N.v(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(l," but got pad ").concat(a,".")}));var y,w,G=rr.a(b.shape,m.shape,r,c,a,l,!0);if(null!=g){y=Object(v.a)(g,"bias","fused conv2d");var B=Object(Hn.makeTypesMatch)(y,C),x=Object(qn.a)(B,1);y=x[0],er.a(G.outShape,y.shape)}null!=f&&(w=Object(v.a)(f,"prelu weights","fused depthwiseConv2d"));var S=function(e,t){N.b(rr.i(c),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'")}));var n=Object(qn.a)(t,4),i=n[0],o=n[1],s=n[2],u=n[3],g=Object(ar.c)(e,s,h),d=Object(sr.a)(o.shape,g,i,r,a,c,l),f=Object(or.a)(o,g,i.shape,r,a,c,l);return null!=u?[d,f,Object(ar.b)(y,g)]:[d,f]},k={x:b,filter:m,bias:y,preluActivationWeights:w},Z={strides:r,pad:a,dataFormat:o,dilations:c,dimRoundingMode:l,activation:h,leakyreluAlpha:p};return null==g?Object($n.a)((function(e,t,n){var r=ie.a.runKernel(oe.lb,k,Z);return n([t,e,r]),A&&(r=Object(be.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}}))(b,m):Object($n.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.lb,k,Z);return r([t,e,a,n]),A&&(a=Object(be.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}}))(b,m,y)}});var cr=Object(G.b)({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,u=e.bias,c=e.activation,l=void 0===c?"linear":c,g=e.preluActivationWeights,d=e.leakyreluAlpha;if(!1===Object(ar.d)(ie.a.state.gradientDepth,l)){var h=Object(y.a)(t,n,a,o);return null!=u&&(h=Object(s.a)(h,u)),Object(ar.a)(h,l,g,d)}var f=Object(v.a)(t,"a","fused matMul"),p=Object(v.a)(n,"b","fused matMul"),I=Object(Hn.makeTypesMatch)(f,p),C=Object(qn.a)(I,2);f=C[0],p=C[1];var m=a?f.shape[f.rank-2]:f.shape[f.rank-1],b=o?p.shape[p.rank-1]:p.shape[p.rank-2],A=a?f.shape[f.rank-1]:f.shape[f.rank-2],w=o?p.shape[p.rank-2]:p.shape[p.rank-1],G=f.shape.slice(0,-2),B=p.shape.slice(0,-2),x=N.O(G),S=N.O(B);N.b(f.rank>=2&&p.rank>=2&&f.rank===p.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(f.rank," and ").concat(p.rank,".")})),N.b(N.a(G,B),(function(){return"Error in fused matMul: outer dimensions (".concat(G,") and (")+"".concat(B,") of Tensors with shapes ").concat(f.shape," and ")+"".concat(p.shape," must match.")})),N.b(m===b,(function(){return"Error in fused matMul: inner shapes (".concat(m,") and (")+"".concat(b,") of Tensors with shapes ").concat(f.shape," and ")+"".concat(p.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var k,Z,R=f.shape.slice(0,-2).concat([A,w]),O=a?Object(be.a)(f,[x,m,A]):Object(be.a)(f,[x,A,m]),W=o?Object(be.a)(p,[S,w,b]):Object(be.a)(p,[S,b,w]);if(null!=u){k=Object(v.a)(u,"bias","fused matMul");var F=Object(Hn.makeTypesMatch)(k,f);k=Object(qn.a)(F,1)[0],er.a(R,k.shape)}null!=g&&(Z=Object(v.a)(g,"prelu weights","fused matMul"));var M=function(e,t){var n,r,i=Object(qn.a)(t,4),s=i[0],c=i[1],g=i[2],d=i[3],h=Object(ar.c)(Object(be.a)(e,g.shape),g,l);return a||o?!a&&o?(n=Object(y.a)(h,c,!1,!1),r=Object(y.a)(h,s,!0,!1)):a&&!o?(n=Object(y.a)(c,h,!1,!0),r=Object(y.a)(s,h,!1,!1)):(n=Object(y.a)(c,h,!0,!0),r=Object(y.a)(h,s,!0,!0)):(n=Object(y.a)(h,c,!1,!0),r=Object(y.a)(s,h,!0,!1)),null!=u?[n,r,Object(ar.b)(d,h)]:[n,r]},V={a:O,b:W,bias:k,preluActivationWeights:Z},T={transposeA:a,transposeB:o,activation:l,leakyreluAlpha:d};return null==u?Object($n.a)((function(e,t,n){var r=ie.a.runKernel(oe.id,V,T);return n([e,t,r]),{value:Object(be.a)(r,R),gradFunc:M}}))(O,W):Object($n.a)((function(e,t,n,r){var a=ie.a.runKernel(oe.id,V,T);return r([e,t,a,n]),{value:Object(be.a)(a,R),gradFunc:M}}))(O,W,k)}});var lr=Object(G.b)({hammingWindow_:function(e){return Un(e,.54,.46)}});var gr=Object(G.b)({hannWindow_:function(e){return Un(e,.5,.5)}});var dr=Object(G.b)({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Object(x.a)(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Object(A.a)([Object(x.a)(e,i,t-s),Object(ye.a)([s],a)]);o.push(u),i+=n}return 0===o.length?vn([],[0,t]):Object(be.a)(Object(A.a)(o),[o.length,t])}});var hr=Object(G.b)({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:gr;null==r&&(r=Pn(t));var i=dr(e,t,n),o=Object(w.a)(i,a(t));return Object(sn.a)(o,r)}});var fr=Object(G.b)({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(v.a)(e,"image","cropAndResize"),s=Object(v.a)(t,"boxes","cropAndResize","float32"),u=Object(v.a)(n,"boxInd","cropAndResize","int32"),c=s.shape[0];N.b(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),N.b(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),N.b(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),N.b(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),N.b(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),N.b("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:u},g={method:a,extrapolationValue:i,cropSize:r},d=ie.a.runKernel(oe.K,l,g);return d}});var pr=Object(G.b)({flipLeftRight_:function(e){var t=Object(v.a)(e,"image","flipLeftRight","float32");N.b(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return ie.a.runKernel(oe.fb,n,{})}});var Ir=Object(G.b)({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Object(v.a)(e,"image","rotateWithOffset","float32");N.b(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},s=ie.a.runKernel(oe.uc,i,o);return s}});function Cr(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),N.b(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),N.b(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),N.b(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),N.b(1===t.rank,(function(){return"scores must be a 1D tensor"})),N.b(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),N.b(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var mr=Object(G.b)({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Object(v.a)(e,"boxes","nonMaxSuppression"),o=Object(v.a)(t,"scores","nonMaxSuppression"),s=Cr(i,o,n,r,a),u={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return ie.a.runKernel(oe.Xb,{boxes:i,scores:o},u)}}),br=n(113);function vr(){return(vr=Object(Tn.a)(Vn.a.mark((function e(t,n,r){var a,i,o,s,u,c,l,g,d,h,f=arguments;return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=f.length>3&&void 0!==f[3]?f[3]:.5,i=f.length>4&&void 0!==f[4]?f[4]:Number.NEGATIVE_INFINITY,o=Object(v.a)(t,"boxes","nonMaxSuppressionAsync"),s=Object(v.a)(n,"scores","nonMaxSuppressionAsync"),u=Cr(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return c=e.sent,l=c[0],g=c[1],d=Object(br.a)(l,g,r,a,i),h=d.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",Object(mn.a)(h,"int32"));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ar=function(e,t,n){return vr.apply(this,arguments)};var yr=Object(G.b)({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(v.a)(e,"boxes","nonMaxSuppression"),s=Object(v.a)(t,"scores","nonMaxSuppression"),u=Cr(o,s,n,r,a,i),c={boxes:o,scores:s},l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},g=ie.a.runKernel(oe.Zb,c,l);return{selectedIndices:g[0],selectedScores:g[1]}}});function wr(){return(wr=Object(Tn.a)(Vn.a.mark((function e(t,n,r){var a,i,o,s,u,c,l,g,d,h,f,p,I=arguments;return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=I.length>3&&void 0!==I[3]?I[3]:.5,i=I.length>4&&void 0!==I[4]?I[4]:Number.NEGATIVE_INFINITY,o=I.length>5&&void 0!==I[5]?I[5]:0,s=Object(v.a)(t,"boxes","nonMaxSuppressionAsync"),u=Object(v.a)(n,"scores","nonMaxSuppressionAsync"),c=Cr(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([s.data(),u.data()]);case 12:return l=e.sent,g=l[0],d=l[1],h=Object(br.c)(g,d,r,a,i,o),f=h.selectedIndices,p=h.selectedScores,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:Object(mn.a)(f,"int32"),selectedScores:Object(mn.a)(p)});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Gr=function(e,t,n){return wr.apply(this,arguments)};var Br=Object(G.b)({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Object(v.a)(e,"boxes","nonMaxSuppression"),s=Object(v.a)(t,"scores","nonMaxSuppression"),u=Cr(o,s,n,r,a,null),c=u.maxOutputSize,l=u.iouThreshold,g=u.scoreThreshold,d={boxes:o,scores:s},h={maxOutputSize:c,iouThreshold:l,scoreThreshold:g,padToMaxOutputSize:i},f=ie.a.runKernel(oe.Yb,d,h);return{selectedIndices:f[0],validOutputs:f[1]}}});function xr(){return(xr=Object(Tn.a)(Vn.a.mark((function e(t,n,r){var a,i,o,s,u,c,l,g,d,h,f,p,I,C,m,b,A=arguments;return Vn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=A.length>3&&void 0!==A[3]?A[3]:.5,i=A.length>4&&void 0!==A[4]?A[4]:Number.NEGATIVE_INFINITY,o=A.length>5&&void 0!==A[5]&&A[5],s=Object(v.a)(t,"boxes","nonMaxSuppressionAsync"),u=Object(v.a)(n,"scores","nonMaxSuppressionAsync"),c=Cr(s,u,r,a,i,null),l=c.maxOutputSize,g=c.iouThreshold,d=c.scoreThreshold,e.next=11,Promise.all([s.data(),u.data()]);case 11:return h=e.sent,f=Object(qn.a)(h,2),p=f[0],I=f[1],C=Object(br.b)(p,I,l,g,d,o),m=C.selectedIndices,b=C.validOutputs,s!==t&&s.dispose(),u!==n&&u.dispose(),e.abrupt("return",{selectedIndices:Object(mn.a)(m,"int32"),validOutputs:Object(Yt.a)(b,"int32")});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Sr=function(e,t,n){return xr.apply(this,arguments)},kr=n(269),Zr=n(268);function Rr(e,t){for(var n,r,a,i,o,u,c=Object(mn.a)([-1]),l=Object(mn.a)([0]),g=Object(mn.a)([0]),d=0;d<e.size-1;d++){n=Object(x.a)(e,0,d+1),r=Object(x.a)(e,d+1),o=Object(ce.a)(Object(pn.a)(n),t),u=Object(ce.a)(Object(pn.a)(r),t);var h=Object(pn.a)(Object(w.a)(n,Object(Nt.a)(0,n.size)));a=Object(ce.a)(h,Object(pn.a)(n));var f=Object(ye.a)(r.shape,n.size),p=Object(s.a)(Object(Nt.a)(0,r.size),f),I=Object(w.a)(r,p);i=Object(ce.a)(Object(pn.a)(I),Object(pn.a)(r));var C=Object(st.a)(a,i),m=Object(st.a)(a,i),b=Object(w.a)(o,u);g=Object(w.a)(Object(w.a)(b,C),m);var v=Object(xe.a)(g,l);l=Object(Nn.a)(v,g,l),c=Object(Nn.a)(v,Object(mn.a)([d]),c)}return c}var Nr=Object(G.b)({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,c=Object(v.a)(e,"image","threshold"),l=.2989,g=.587,d=.114,h=c.shape[0]*c.shape[1],f=Object(w.a)(Object(mn.a)([u]),255);if(N.b(3===c.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(c.rank,".")})),N.b(3===c.shape[2]||1===c.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(c.shape[2],".")})),N.b("int32"===c.dtype||"float32"===c.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(c.dtype,".")})),N.b("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===c.shape[2]){var p=Object(un.a)(c,[1,1,1],-1),I=Object(qn.a)(p,3);t=I[0],n=I[1],r=I[2];var C=Object(w.a)(t,l),m=Object(w.a)(n,g),b=Object(w.a)(r,d);a=Object(s.a)(Object(s.a)(C,m),b)}else a=e;if("otsu"===i){var A=Object(M.a)(Object(E.a)(Object(Xt.a)(a),"int32"),Object(Cn.a)([]),256);f=Rr(A,h)}var y=o?Object(Fe.a)(a,f):Object(xe.a)(a,f),G=Object(E.a)(Object(w.a)(y,255),"int32");return G}});var Or=Object(G.b)({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=Object(v.a)(e,"image","transform","float32"),s=Object(v.a)(t,"transforms","transform","float32");N.b(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),N.b(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),N.b(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return ie.a.runKernel(oe.cd,u,c)}});var Wr=Object(G.b)({bandPart_:function(e,t,n){Object(N.b)(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),Object(N.b)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Object(v.a)(e,"a","bandPart");Object(N.b)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=r.shape.slice(-2),o=Object(qn.a)(i,2),s=o[0],u=o[1];if(!(t<=s))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(s,")."));if(!(n<=u))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(u,")."));t<0&&(t=s),n<0&&(n=u);var c=Object(be.a)(Object(Nt.a)(0,s,1,"int32"),[-1,1]),l=Object(Nt.a)(0,u,1,"int32"),g=Object(st.a)(c,l),d=Object(He.a)(Object(Fe.a)(g,Object(Yt.a)(+t,"int32")),Object(Se.a)(g,Object(Yt.a)(-n,"int32"))),h=Object(Wn.a)([s,u],r.dtype);return Object(be.a)(Object(dn.a)(Object(Zn.a)(Object(be.a)(r,[-1,s,u])).map((function(e){return Object(Nn.a)(d,e,h)}))),a)}});var Fr=Object(G.b)({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Object(N.b)(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Object(N.b)(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=Object(un.a)(e,e.shape[0],0).map((function(e){return Object(gn.a)(e,[0])}))),Object(N.b)(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(ie.a.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=Object(w.a)(Object(pn.a)(Object(w.a)(n[a],t)),n[a]);t=Object(st.a)(t,i)}return Object(ce.a)(t,Object(Xn.a)(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?Object(dn.a)(n,0):n}}),Mr=n(46);function Vr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ie.a.tidy((function(){Object(N.b)(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=Ae(n),i=Object(X.a)(e),o=vn([[1]],[1,1]),s=Object(X.a)(o),u=n>=r?r:n,c=function(e){var t=i,u=s,c=a,l=ie.a.tidy((function(){var t=Object(x.a)(i,[e,e],[n-e,1]),u=Object(Xn.a)(t),c=Object(x.a)(i,[e,e],[1,1]),l=Object(Nn.a)(Object(xe.a)(c,0),vn([[-1]]),vn([[1]])),g=Object(st.a)(c,Object(w.a)(l,u)),d=Object(ce.a)(t,g);s=1===d.shape[0]?Object(X.a)(o):Object(A.a)([o,Object(x.a)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);var h=Object(gt.a)(Object(ce.a)(Object(y.a)(l,g),u)),f=Object(x.a)(i,[e,0],[n-e,r]),p=Object(w.a)(h,s),I=Object(Ln.a)(s);if(0===e)i=Object(st.a)(f,Object(y.a)(p,Object(y.a)(I,f)));else{var C=Object(st.a)(f,Object(y.a)(p,Object(y.a)(I,f)));i=Object(A.a)([Object(x.a)(i,[0,0],[e,r]),C],0)}var m=Object(Ln.a)(p),b=Object(x.a)(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=Object(st.a)(b,Object(y.a)(Object(y.a)(b,s),m));else{var v=Object(st.a)(b,Object(y.a)(Object(y.a)(b,s),m));a=Object(A.a)([Object(x.a)(a,[0,0],[n,e]),v],1)}return[s,i,a]})),g=Object(qn.a)(l,3);s=g[0],i=g[1],a=g[2],Object(Mr.b)([t,u,c])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=Object(x.a)(a,[0,0],[n,r]),i=Object(x.a)(i,[0,0],[r,r])),[a,i]}))}var Tr=Object(G.b)({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(N.b)(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return Vr(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Object(Zn.a)(Object(be.a)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=Vr(e,t),r=Object(qn.a)(n,2),o=r[0],s=r[1];a.push(o),i.push(s)}));var o=Object(be.a)(Object(dn.a)(a,0),e.shape),s=Object(be.a)(Object(dn.a)(i,0),e.shape);return[o,s]}}),Er=n(61);var jr=Object(G.b)({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Er.a.SUM_BY_NONZERO_WEIGHTS,r=Object(v.a)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Object(v.a)(t,"weights","computeWeightedLoss"));var i=null==a?r:Object(w.a)(r,a);if(n===Er.a.NONE)return i;if(n===Er.a.SUM)return Object(pn.a)(i);if(n===Er.a.MEAN){if(null==a)return Object(Qe.a)(i);var o=r.size/a.size,s=Object(ce.a)(Object(pn.a)(i),Object(pn.a)(a));return o>1?Object(ce.a)(s,Object(Yt.a)(o)):s}if(n===Er.a.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Object(ce.a)(Object(pn.a)(i),Object(Yt.a)(r.size));var u=Object(w.a)(a,Object(qe.a)(r.shape)),c=Object(E.a)(Object(pn.a)(Object(dt.a)(u,Object(Yt.a)(0))),"float32");return Object(ce.a)(Object(pn.a)(i),c)}throw Error("Unknown reduction: ".concat(n))}});var Lr=Object(G.b)({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Er.a.SUM_BY_NONZERO_WEIGHTS,i=Object(v.a)(e,"labels","absoluteDifference"),o=Object(v.a)(t,"predictions","absoluteDifference"),s=null;null!=n&&(s=Object(v.a)(n,"weights","absoluteDifference")),Object(N.e)(i.shape,o.shape,"Error in absoluteDifference: ");var u=Object(a.a)(Object(st.a)(i,o));return jr(u,s,r)}});var Xr=Object(G.b)({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Er.a.SUM_BY_NONZERO_WEIGHTS,i=Object(v.a)(e,"labels","cosineDistance"),o=Object(v.a)(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Object(v.a)(r,"weights","cosineDistance")),Object(N.e)(i.shape,o.shape,"Error in cosineDistance: ");var u=Object(Yt.a)(1),c=Object(st.a)(u,Object(pn.a)(Object(w.a)(i,o),n,!0));return jr(c,s,a)}});var Hr=Object(G.b)({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Er.a.SUM_BY_NONZERO_WEIGHTS,a=Object(v.a)(e,"labels","hingeLoss"),i=Object(v.a)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Object(v.a)(n,"weights","hingeLoss")),Object(N.e)(a.shape,i.shape,"Error in hingeLoss: ");var s=Object(Yt.a)(1);a=Object(st.a)(Object(w.a)(Object(Yt.a)(2),a),s);var u=Object(Ft.a)(Object(st.a)(s,Object(w.a)(a,i)));return jr(u,o,r)}});var Yr=Object(G.b)({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Er.a.SUM_BY_NONZERO_WEIGHTS,o=Object(v.a)(e,"labels","huberLoss"),u=Object(v.a)(t,"predictions","huberLoss"),c=null;null!=n&&(c=Object(v.a)(n,"weights","huberLoss")),Object(N.e)(o.shape,u.shape,"Error in huberLoss: ");var l=Object(Yt.a)(r),g=Object(a.a)(Object(st.a)(u,o)),d=Object(nt.a)(g,l),h=Object(st.a)(g,d),f=Object(s.a)(Object(w.a)(Object(Yt.a)(.5),Object(ot.a)(d)),Object(w.a)(l,h));return jr(f,c,i)}});var zr=Object(G.b)({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Er.a.SUM_BY_NONZERO_WEIGHTS,i=Object(v.a)(e,"labels","logLoss"),o=Object(v.a)(t,"predictions","logLoss"),u=null;null!=n&&(u=Object(v.a)(n,"weights","logLoss")),Object(N.e)(i.shape,o.shape,"Error in logLoss: ");var c=Object(Yt.a)(1),l=Object(Yt.a)(r),g=Object(gt.a)(Object(w.a)(i,Object(Te.a)(Object(s.a)(o,l)))),d=Object(w.a)(Object(st.a)(c,i),Object(Te.a)(Object(s.a)(Object(st.a)(c,o),l))),h=Object(st.a)(g,d);return jr(h,u,a)}});var Kr=Object(G.b)({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Er.a.SUM_BY_NONZERO_WEIGHTS,a=Object(v.a)(e,"labels","meanSquaredError"),i=Object(v.a)(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Object(v.a)(n,"weights","meanSquaredError")),Object(N.e)(a.shape,i.shape,"Error in meanSquaredError: ");var s=Object(ln.a)(a,i);return jr(s,o,r)}});function _r(e,t){var n=Object(v.a)(e,"labels","sigmoidCrossEntropyWithLogits"),r=Object(v.a)(t,"logits","sigmoidCrossEntropyWithLogits");Object(N.e)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=Object(Ft.a)(r),o=Object(w.a)(r,n),u=Object(Ee.a)(Object(Ie.a)(Object(gt.a)(Object(a.a)(r))));return Object(s.a)(Object(st.a)(i,o),u)}var Dr=Object(G.b)({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Er.a.SUM_BY_NONZERO_WEIGHTS,i=Object(v.a)(e,"multiClassLabels","sigmoidCrossEntropy"),o=Object(v.a)(t,"logits","sigmoidCrossEntropy"),u=null;if(null!=n&&(u=Object(v.a)(n,"weights","sigmoidCrossEntropy")),Object(N.e)(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var c=Object(Yt.a)(r),l=Object(Yt.a)(1),g=Object(Yt.a)(.5);i=Object(s.a)(Object(w.a)(i,Object(st.a)(l,c)),Object(w.a)(g,c))}var d=_r(i,o);return jr(d,u,a)}});function Pr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=Object($n.a)((function(e,t,r){var a=Object(Xe.a)(t,[n],!0),i=Object(st.a)(Object(E.a)(t,"float32"),a);r([e,i]);var o=Object(gt.a)(Object(w.a)(i,e));return{value:Object(pn.a)(o,[n]),gradFunc:function(e,t){var r=Object(qn.a)(t,2),a=r[0],i=r[1],o=Object(it.e)(e.shape,[n]);return[Object(w.a)(Object(be.a)(e,o),Object(st.a)(Object(E.a)(a,"float32"),Object(Ie.a)(i))),Object(w.a)(Object(be.a)(e,o),Object(st.a)(Object(Ie.a)(i),Object(E.a)(a,"float32")))]}}}));return r(e,t)}var Ur=Object(G.b)({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Er.a.SUM_BY_NONZERO_WEIGHTS,i=Object(v.a)(e,"onehotLabels","softmaxCrossEntropy"),o=Object(v.a)(t,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=Object(v.a)(n,"weights","softmaxCrossEntropy")),Object(N.e)(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var c=Object(Yt.a)(r),l=Object(Yt.a)(1),g=Object(Yt.a)(i.shape[1]);i=Object(s.a)(Object(w.a)(i,Object(st.a)(l,c)),Object(ce.a)(c,g))}var d=Pr(i,o);return jr(d,u,a)}});var Jr=Object(G.b)({sparseFillEmptyRows_:function(e,t,n,r){var a=Object(v.a)(e,"indices","sparseFillEmptyRows"),i=Object(v.a)(t,"values","sparseFillEmptyRows"),o=Object(v.a)(n,"denseShape","sparseFillEmptyRows"),s=Object(v.a)(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));var u={indices:a,values:i,denseShape:o,defaultValue:s},c=ie.a.runKernel(oe.Ic,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});var Qr=Object(G.b)({sparseReshape_:function(e,t,n){var r=Object(v.a)(e,"inputIndices","sparseReshape"),a=Object(v.a)(t,"inputShape","sparseReshape"),i=Object(v.a)(n,"newShape","sparseReshape");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));var o={inputIndices:r,inputShape:a,newShape:i},s=ie.a.runKernel(oe.Jc,o);return{outputIndices:s[0],outputShape:s[1]}}});var qr=Object(G.b)({sparseSegmentMean_:function(e,t,n){var r=Object(v.a)(e,"data","sparseSegmentMean"),a=Object(v.a)(t,"indices","sparseSegmentMean"),i=Object(v.a)(n,"segmentIds","sparseSegmentMean");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return ie.a.runKernel(oe.Kc,o)}});var $r=Object(G.b)({sparseSegmentSum_:function(e,t,n){var r=Object(v.a)(e,"data","sparseSegmentSum"),a=Object(v.a)(t,"indices","sparseSegmentSum"),i=Object(v.a)(n,"segmentIds","sparseSegmentSum");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return ie.a.runKernel(oe.Lc,o)}});var ea=Object(G.b)({stringNGrams_:function(e,t,n,r,a,i,o,s){var u=Object(v.a)(e,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: ".concat(u.shape));var c=Object(v.a)(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},g={data:u,dataSplits:c},d=ie.a.runKernel(oe.Tc,g,l);return{nGrams:d[0],nGramsSplits:d[1]}}});var ta=Object(G.b)({stringSplit_:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(v.a)(e,"input","stringSplit","string"),a=Object(v.a)(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var i={skipEmpty:n},o={input:r,delimiter:a},s=ie.a.runKernel(oe.Uc,o,i);return{indices:s[0],values:s[1],shape:s[2]}}});var na=Object(G.b)({stringToHashBucketFast_:function(e,t){var n=Object(v.a)(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return ie.a.runKernel(oe.Vc,a,r)}}),ra={fft:rn.a,ifft:an.a,rfft:sn.a,irfft:on.a},aa={hammingWindow:lr,hannWindow:gr,frame:dr,stft:hr},ia={flipLeftRight:pr,resizeNearestNeighbor:Zr.a,resizeBilinear:kr.a,rotateWithOffset:Ir,cropAndResize:fr,nonMaxSuppression:mr,nonMaxSuppressionAsync:Ar,nonMaxSuppressionWithScore:yr,nonMaxSuppressionWithScoreAsync:Gr,nonMaxSuppressionPadded:Br,nonMaxSuppressionPaddedAsync:Sr,threshold:Nr,transform:Or},oa={bandPart:Wr,gramSchmidt:Fr,qr:Tr},sa={absoluteDifference:Lr,computeWeightedLoss:jr,cosineDistance:Xr,hingeLoss:Hr,huberLoss:Yr,logLoss:zr,meanSquaredError:Kr,sigmoidCrossEntropy:Dr,softmaxCrossEntropy:Ur},ua={sparseFillEmptyRows:Jr,sparseReshape:Qr,sparseSegmentMean:qr,sparseSegmentSum:$r},ca={stringNGrams:ea,stringSplit:ta,stringToHashBucketFast:na}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return I}));var r=n(3),a=n(7),i=n.n(a),o=n(17),s=n(1),u=n(9),c=n(19),l="tfjsflags",g=function(){function e(t){Object(s.a)(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=d,this.populateURLFlags()}return Object(u.a)(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Object(c.x)(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(l in t)t.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),a=Object(r.a)(n,2),i=a[0],o=a[1];e.urlFlags[i]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(i,o)}))}}}]),e}();function d(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return h(t,r[0],r[1]),r.join("=")})),t}function h(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function f(){return p}var p=null;function I(e){p=e}},function(e,t,n){"use strict";n.r(t),n.d(t,"makeTypesMatch",(function(){return o})),n.d(t,"assertTypesMatch",(function(){return s})),n.d(t,"isTensorInList",(function(){return u})),n.d(t,"getTensorsInContainer",(function(){return c}));var r=n(14),a=n(130),i=n(19);function o(e,t){if(e.dtype===t.dtype)return[e,t];var n=Object(a.b)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function s(e,t){Object(i.b)(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}function u(e,t){return t.some((function(t){return t.id===e.id}))}function c(e){var t=[];return l(e,t,new Set),t}function l(e,t,n){if(null!=e)if(e instanceof r.a)t.push(e);else if(a=e,Array.isArray(a)||"object"===typeof a){var a,i=e;for(var o in i){var s=i[o];n.has(s)||(n.add(s),l(s,t,n))}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(214);function a(e,t){if(null==e)return{};var n,a,i=Object(r.a)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}},function(e,t,n){"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return We}));var r=n(186),a=n(2),i=n.n(a),o=n(337),s=n.n(o),u=n(338),c=n(339),l=n(286),g=n(146),d=n.n(g);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f=function(e,t){for(var n=[e[0]],r=0,a=t.length;r<a;r+=1)n.push(t[r],e[r+1]);return n},p=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!Object(r.typeOf)(e)},I=Object.freeze([]),C=Object.freeze({});function m(e){return"function"==typeof e}function b(e){return e.displayName||e.name||"Component"}function v(e){return e&&"string"==typeof e.styledComponentId}var A="undefined"!=typeof e&&(Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SC_ATTR||Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SC_ATTR)||"data-styled",y="undefined"!=typeof window&&"HTMLElement"in window,w=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof e&&void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SC_DISABLE_SPEEDY&&""!==Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SC_DISABLE_SPEEDY?"false"!==Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SC_DISABLE_SPEEDY&&Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof e&&void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SC_DISABLE_SPEEDY&&""!==Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SC_DISABLE_SPEEDY&&("false"!==Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SC_DISABLE_SPEEDY&&Object({NODE_ENV:"production",PUBLIC_URL:"/self-driving-car",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SC_DISABLE_SPEEDY)),G={};function B(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var x=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,a=r;e>=a;)(a<<=1)<0&&B(16,""+e);this.groupSizes=new Uint32Array(a),this.groupSizes.set(n),this.length=a;for(var i=r;i<a;i++)this.groupSizes[i]=0}for(var o=this.indexOfGroup(e+1),s=0,u=t.length;s<u;s++)this.tag.insertRule(o,t[s])&&(this.groupSizes[e]++,o++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var a=n;a<r;a++)this.tag.deleteRule(n)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),a=r+n,i=r;i<a;i++)t+=this.tag.getRule(i)+"/*!sc*/\n";return t},e}(),S=new Map,k=new Map,Z=1,R=function(e){if(S.has(e))return S.get(e);for(;k.has(Z);)Z++;var t=Z++;return S.set(e,t),k.set(t,e),t},N=function(e){return k.get(e)},O=function(e,t){S.set(e,t),k.set(t,e)},W="style["+A+'][data-styled-version="5.2.3"]',F=new RegExp("^"+A+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),M=function(e,t,n){for(var r,a=n.split(","),i=0,o=a.length;i<o;i++)(r=a[i])&&e.registerName(t,r)},V=function(e,t){for(var n=t.innerHTML.split("/*!sc*/\n"),r=[],a=0,i=n.length;a<i;a++){var o=n[a].trim();if(o){var s=o.match(F);if(s){var u=0|parseInt(s[1],10),c=s[2];0!==u&&(O(c,u),M(e,c,s[3]),e.getTag().insertRules(u,r)),r.length=0}else r.push(o)}}},T=function(){return"undefined"!=typeof window&&void 0!==window.__webpack_nonce__?window.__webpack_nonce__:null},E=function(e){var t=document.head,n=e||t,r=document.createElement("style"),a=function(e){for(var t=e.childNodes,n=t.length;n>=0;n--){var r=t[n];if(r&&1===r.nodeType&&r.hasAttribute(A))return r}}(n),i=void 0!==a?a.nextSibling:null;r.setAttribute(A,"active"),r.setAttribute("data-styled-version","5.2.3");var o=T();return o&&r.setAttribute("nonce",o),n.insertBefore(r,i),r},j=function(){function e(e){var t=this.element=E(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var a=t[n];if(a.ownerNode===e)return a}B(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),L=function(){function e(e){var t=this.element=E(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t),r=this.nodes[e];return this.element.insertBefore(n,r||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),X=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),H=y,Y={isServer:!y,useCSSOMInjection:!w},z=function(){function e(e,t,n){void 0===e&&(e=C),void 0===t&&(t={}),this.options=h({},Y,{},e),this.gs=t,this.names=new Map(n),!this.options.isServer&&y&&H&&(H=!1,function(e){for(var t=document.querySelectorAll(W),n=0,r=t.length;n<r;n++){var a=t[n];a&&"active"!==a.getAttribute(A)&&(V(e,a),a.parentNode&&a.parentNode.removeChild(a))}}(this))}e.registerId=function(e){return R(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(h({},this.options,{},t),this.gs,n&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(n=(t=this.options).isServer,r=t.useCSSOMInjection,a=t.target,e=n?new X(a):r?new j(a):new L(a),new x(e)));var e,t,n,r,a},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(R(e),this.names.has(e))this.names.get(e).add(t);else{var n=new Set;n.add(t),this.names.set(e,n)}},t.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(R(e),n)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(R(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),n=t.length,r="",a=0;a<n;a++){var i=N(a);if(void 0!==i){var o=e.names.get(i),s=t.getGroup(a);if(void 0!==o&&0!==s.length){var u=A+".g"+a+'[id="'+i+'"]',c="";void 0!==o&&o.forEach((function(e){e.length>0&&(c+=e+",")})),r+=""+s+u+'{content:"'+c+'"}/*!sc*/\n'}}}return r}(this)},e}(),K=/(a)(d)/gi,_=function(e){return String.fromCharCode(e+(e>25?39:97))};function D(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=_(t%52)+n;return(_(t%52)+n).replace(K,"$1-$2")}var P=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},U=function(e){return P(5381,e)};function J(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(m(n)&&!v(n))return!1}return!0}var Q=U("5.2.3"),q=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&J(e),this.componentId=t,this.baseHash=P(Q,t),this.baseStyle=n,z.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.componentId,a=[];if(this.baseStyle&&a.push(this.baseStyle.generateAndInjectStyles(e,t,n)),this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(r,this.staticRulesId))a.push(this.staticRulesId);else{var i=Ie(this.rules,e,t,n).join(""),o=D(P(this.baseHash,i.length)>>>0);if(!t.hasNameForId(r,o)){var s=n(i,"."+o,void 0,r);t.insertRules(r,o,s)}a.push(o),this.staticRulesId=o}else{for(var u=this.rules.length,c=P(this.baseHash,n.hash),l="",g=0;g<u;g++){var d=this.rules[g];if("string"==typeof d)l+=d;else if(d){var h=Ie(d,e,t,n),f=Array.isArray(h)?h.join(""):h;c=P(c,f+g),l+=f}}if(l){var p=D(c>>>0);if(!t.hasNameForId(r,p)){var I=n(l,"."+p,void 0,r);t.insertRules(r,p,I)}a.push(p)}}return a.join(" ")},e}(),$=/^\s*\/\/.*$/gm,ee=[":","[",".","#"];function te(e){var t,n,r,a,i=void 0===e?C:e,o=i.options,s=void 0===o?C:o,c=i.plugins,l=void 0===c?I:c,g=new u.a(s),d=[],h=function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(n,r,a,i,o,s,u,c,l,g){switch(n){case 1:if(0===l&&64===r.charCodeAt(0))return e(r+";"),"";break;case 2:if(0===c)return r+"/*|*/";break;case 3:switch(c){case 102:case 112:return e(a[0]+r),"";default:return r+(0===g?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(t)}}}((function(e){d.push(e)})),f=function(e,r,i){return 0===r&&-1!==ee.indexOf(i[n.length])||i.match(a)?e:"."+t};function p(e,i,o,s){void 0===s&&(s="&");var u=e.replace($,""),c=i&&o?o+" "+i+" { "+u+" }":u;return t=s,n=i,r=new RegExp("\\"+n+"\\b","g"),a=new RegExp("(\\"+n+"\\b){2,}"),g(o||!i?"":i,c)}return g.use([].concat(l,[function(e,t,a){2===e&&a.length&&a[0].lastIndexOf(n)>0&&(a[0]=a[0].replace(r,f))},h,function(e){if(-2===e){var t=d;return d=[],t}}])),p.hash=l.length?l.reduce((function(e,t){return t.name||B(15),P(e,t.name)}),5381).toString():"",p}var ne=i.a.createContext(),re=(ne.Consumer,i.a.createContext()),ae=(re.Consumer,new z),ie=te();function oe(){return Object(a.useContext)(ne)||ae}function se(){return Object(a.useContext)(re)||ie}function ue(e){var t=Object(a.useState)(e.stylisPlugins),n=t[0],r=t[1],o=oe(),u=Object(a.useMemo)((function(){var t=o;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target]),c=Object(a.useMemo)((function(){return te({options:{prefix:!e.disableVendorPrefixes},plugins:n})}),[e.disableVendorPrefixes,n]);return Object(a.useEffect)((function(){s()(n,e.stylisPlugins)||r(e.stylisPlugins)}),[e.stylisPlugins]),i.a.createElement(ne.Provider,{value:u},i.a.createElement(re.Provider,{value:c},e.children))}var ce=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=ie);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"))},this.toString=function(){return B(12,String(n.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=ie),this.name+e.hash},e}(),le=/([A-Z])/,ge=/([A-Z])/g,de=/^ms-/,he=function(e){return"-"+e.toLowerCase()};function fe(e){return le.test(e)?e.replace(ge,he).replace(de,"-ms-"):e}var pe=function(e){return null==e||!1===e||""===e};function Ie(e,t,n,r){if(Array.isArray(e)){for(var a,i=[],o=0,s=e.length;o<s;o+=1)""!==(a=Ie(e[o],t,n,r))&&(Array.isArray(a)?i.push.apply(i,a):i.push(a));return i}return pe(e)?"":v(e)?"."+e.styledComponentId:m(e)?"function"!=typeof(u=e)||u.prototype&&u.prototype.isReactComponent||!t?e:Ie(e(t),t,n,r):e instanceof ce?n?(e.inject(n,r),e.getName(r)):e:p(e)?function e(t,n){var r,a,i=[];for(var o in t)t.hasOwnProperty(o)&&!pe(t[o])&&(p(t[o])?i.push.apply(i,e(t[o],o)):m(t[o])?i.push(fe(o)+":",t[o],";"):i.push(fe(o)+": "+(r=o,(null==(a=t[o])||"boolean"==typeof a||""===a?"":"number"!=typeof a||0===a||r in c.a?String(a).trim():a+"px")+";")));return n?[n+" {"].concat(i,["}"]):i}(e):e.toString();var u}function Ce(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return m(e)||p(e)?Ie(f(I,[e].concat(n))):0===n.length&&1===e.length&&"string"==typeof e[0]?e:Ie(f(e,n))}new Set;var me=function(e,t,n){return void 0===n&&(n=C),e.theme!==n.theme&&e.theme||t||n.theme},be=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,ve=/(^-|-$)/g;function Ae(e){return e.replace(be,"-").replace(ve,"")}var ye=function(e){return D(U(e)>>>0)};function we(e){return"string"==typeof e&&!0}var Ge=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},Be=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function xe(e,t,n){var r=e[n];Ge(t)&&Ge(r)?Se(r,t):e[n]=t}function Se(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];if(Ge(o))for(var s in o)Be(s)&&xe(e,o[s],s)}return e}var ke=i.a.createContext();ke.Consumer;var Ze={};function Re(e,t,n){var r=v(e),o=!we(e),s=t.attrs,u=void 0===s?I:s,c=t.componentId,g=void 0===c?function(e,t){var n="string"!=typeof e?"sc":Ae(e);Ze[n]=(Ze[n]||0)+1;var r=n+"-"+ye("5.2.3"+n+Ze[n]);return t?t+"-"+r:r}(t.displayName,t.parentComponentId):c,f=t.displayName,p=void 0===f?function(e){return we(e)?"styled."+e:"Styled("+b(e)+")"}(e):f,A=t.displayName&&t.componentId?Ae(t.displayName)+"-"+t.componentId:t.componentId||g,y=r&&e.attrs?Array.prototype.concat(e.attrs,u).filter(Boolean):u,w=t.shouldForwardProp;r&&e.shouldForwardProp&&(w=t.shouldForwardProp?function(n,r){return e.shouldForwardProp(n,r)&&t.shouldForwardProp(n,r)}:e.shouldForwardProp);var G,B=new q(n,A,r?e.componentStyle:void 0),x=B.isStatic&&0===u.length,S=function(e,t){return function(e,t,n,r){var i=e.attrs,o=e.componentStyle,s=e.defaultProps,u=e.foldedComponentIds,c=e.shouldForwardProp,g=e.styledComponentId,d=e.target,f=function(e,t,n){void 0===e&&(e=C);var r=h({},t,{theme:e}),a={};return n.forEach((function(e){var t,n,i,o=e;for(t in m(o)&&(o=o(r)),o)r[t]=a[t]="className"===t?(n=a[t],i=o[t],n&&i?n+" "+i:n||i):o[t]})),[r,a]}(me(t,Object(a.useContext)(ke),s)||C,t,i),p=f[0],I=f[1],b=function(e,t,n,r){var a=oe(),i=se();return t?e.generateAndInjectStyles(C,a,i):e.generateAndInjectStyles(n,a,i)}(o,r,p),v=n,A=I.$as||t.$as||I.as||t.as||d,y=we(A),w=I!==t?h({},t,{},I):t,G={};for(var B in w)"$"!==B[0]&&"as"!==B&&("forwardedAs"===B?G.as=w[B]:(c?c(B,l.a):!y||Object(l.a)(B))&&(G[B]=w[B]));return t.style&&I.style!==t.style&&(G.style=h({},t.style,{},I.style)),G.className=Array.prototype.concat(u,g,b!==g?b:null,t.className,I.className).filter(Boolean).join(" "),G.ref=v,Object(a.createElement)(A,G)}(G,e,t,x)};return S.displayName=p,(G=i.a.forwardRef(S)).attrs=y,G.componentStyle=B,G.displayName=p,G.shouldForwardProp=w,G.foldedComponentIds=r?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):I,G.styledComponentId=A,G.target=r?e.target:e,G.withComponent=function(e){var r=t.componentId,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(t,["componentId"]),i=r&&r+"-"+(we(e)?e:Ae(b(e)));return Re(e,h({},a,{attrs:y,componentId:i}),n)},Object.defineProperty(G,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=r?Se({},e.defaultProps,t):t}}),G.toString=function(){return"."+G.styledComponentId},o&&d()(G,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),G}var Ne=function(e){return function e(t,n,a){if(void 0===a&&(a=C),!Object(r.isValidElementType)(n))return B(1,String(n));var i=function(){return t(n,a,Ce.apply(void 0,arguments))};return i.withConfig=function(r){return e(t,n,h({},a,{},r))},i.attrs=function(r){return e(t,n,h({},a,{attrs:Array.prototype.concat(a.attrs,r).filter(Boolean)}))},i}(Re,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){Ne[e]=Ne(e)}));var Oe=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=J(e),z.registerId(this.componentId+1)}var t=e.prototype;return t.createStyles=function(e,t,n,r){var a=r(Ie(this.rules,t,n,r).join(""),""),i=this.componentId+e;n.insertRules(i,i,a)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,n,r){e>2&&z.registerId(this.componentId+e),this.removeStyles(e,n),this.createStyles(e,t,n,r)},e}();function We(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Ce.apply(void 0,[e].concat(n)),s="sc-global-"+ye(JSON.stringify(o)),u=new Oe(o,s);function c(e){var t=oe(),n=se(),r=Object(a.useContext)(ke),i=Object(a.useRef)(t.allocateGSInstance(s)).current;return Object(a.useLayoutEffect)((function(){return l(i,e,t,r,n),function(){return u.removeStyles(i,t)}}),[i,e,t,r,n]),null}function l(e,t,n,r,a){if(u.isStatic)u.renderStyles(e,G,n,a);else{var i=h({},t,{theme:me(t,r,c.defaultProps)});u.renderStyles(e,i,n,a)}}return i.a.memo(c)}!function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString(),n=T();return"<style "+[n&&'nonce="'+n+'"',A+'="true"','data-styled-version="5.2.3"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?B(2):e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)return B(2);var n=((t={})[A]="",t["data-styled-version"]="5.2.3",t.dangerouslySetInnerHTML={__html:e.instance.toString()},t),r=T();return r&&(n.nonce=r),[i.a.createElement("style",h({},n,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new z({isServer:!0}),this.sealed=!1}var t=e.prototype;t.collectStyles=function(e){return this.sealed?B(2):i.a.createElement(ue,{sheet:this.instance},e)},t.interleaveWithNodeStream=function(e){return B(3)}}();t.b=Ne}).call(this,n(197))},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return v}));var r=n(2),a=n.n(r),i=(n(52),a.a.createContext(null));var o=function(e){e()},s={notify:function(){}};function u(){var e=o,t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,a=n={callback:e,next:null,prev:n};return a.prev?a.prev.next=a:t=a,function(){r&&null!==t&&(r=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:t=a.next)}}}}var c=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=s,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=u())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=s)},e}(),l="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?r.useLayoutEffect:r.useEffect;var g=function(e){var t=e.store,n=e.context,o=e.children,s=Object(r.useMemo)((function(){var e=new c(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),u=Object(r.useMemo)((function(){return t.getState()}),[t]);l((function(){var e=s.subscription;return e.trySubscribe(),u!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[s,u]);var g=n||i;return a.a.createElement(g.Provider,{value:s},o)};n(25),n(97),n(146),n(186);function d(){return Object(r.useContext)(i)}function h(e){void 0===e&&(e=i);var t=e===i?d:function(){return Object(r.useContext)(e)};return function(){return t().store}}var f=h();function p(e){void 0===e&&(e=i);var t=e===i?f:h(e);return function(){return t().dispatch}}var I=p(),C=function(e,t){return e===t};function m(e){void 0===e&&(e=i);var t=e===i?d:function(){return Object(r.useContext)(e)};return function(e,n){void 0===n&&(n=C);var a=t(),i=function(e,t,n,a){var i,o=Object(r.useReducer)((function(e){return e+1}),0)[1],s=Object(r.useMemo)((function(){return new c(n,a)}),[n,a]),u=Object(r.useRef)(),g=Object(r.useRef)(),d=Object(r.useRef)(),h=Object(r.useRef)(),f=n.getState();try{if(e!==g.current||f!==d.current||u.current){var p=e(f);i=void 0!==h.current&&t(p,h.current)?h.current:p}else i=h.current}catch(I){throw u.current&&(I.message+="\nThe error may be correlated with this previous error:\n"+u.current.stack+"\n\n"),I}return l((function(){g.current=e,d.current=f,h.current=i,u.current=void 0})),l((function(){function e(){try{var e=n.getState(),r=g.current(e);if(t(r,h.current))return;h.current=r,d.current=e}catch(I){u.current=I}o()}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}}),[n,s]),i}(e,n,a.store,a.subscription);return Object(r.useDebugValue)(i),i}}var b,v=m(),A=n(62);b=A.unstable_batchedUpdates,o=b},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11),a=n(5),i=n(10);var o=Object(i.b)({square_:function(e){var t=Object(a.a)(e,"x","square");return r.a.runKernel("Square",{x:t},{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(s.a)(e,"a","matMul"),l=Object(s.a)(t,"b","matMul"),g=Object(o.makeTypesMatch)(c,l),d=Object(r.a)(g,2),h={a:c=d[0],b:l=d[1]},f={transposeA:n,transposeB:u};return a.a.runKernel(i.s,h,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({slice_:function(e,t,n){var o=Object(i.a)(e,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");var s={x:o},u={begin:t,size:n};return r.a.runKernel(a.Ec,s,u)}})},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n(11),a=n(36),i=n(14),o=n(37);function s(){return r.a}function u(){return r.a.memory()}function c(e,t){return r.a.tidy(e,t)}function l(e){Object(o.getTensorsInContainer)(e).forEach((function(e){return e.dispose()}))}function g(e){return r.a.keep(e)}function d(e){return r.a.setBackend(e)}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.a.registerBackend(e,t,n)}function f(){return r.a.backend}Object(i.e)((function(e){Object(a.b)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return ge})),n.d(t,"b",(function(){return ae})),n.d(t,"c",(function(){return re})),n.d(t,"d",(function(){return D})),n.d(t,"e",(function(){return ve})),n.d(t,"f",(function(){return he})),n.d(t,"g",(function(){return Ie})),n.d(t,"h",(function(){return de}));var r=n(1),a=n(9),i=n(12),o=n(13),s=n(91),u=n(101),c=n(41),l=n(189),g=n(3),d=n(21),h=n(26),f=n(16),p=n(15),I=n(2);function C(e){var t,n=new Set,r=function(e,r){var a="function"===typeof e?e(t):e;if(a!==t){var i=t;t=r?a:Object.assign({},t,a),n.forEach((function(e){return e(t,i)}))}},a=function(){return t},i={setState:r,getState:a,subscribe:function(e,r,i){return r||i?function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,o=r(t);function s(){var n=r(t);if(!i(o,n)){var a=o;e(o=n,a)}}return n.add(s),function(){return n.delete(s)}}(e,r,i):(n.add(e),function(){return n.delete(e)})},destroy:function(){return n.clear()}};return t=e(r,a,i),i}var m="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?I.useEffect:I.useLayoutEffect;var b=function(e){var t="function"===typeof e?C(e):e,n=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,a=Object(I.useReducer)((function(e){return e+1}),0),i=Object(g.a)(a,2),o=i[1],s=t.getState(),u=Object(I.useRef)(s),c=Object(I.useRef)(n),l=Object(I.useRef)(r),d=Object(I.useRef)(!1),h=Object(I.useRef)();void 0===h.current&&(h.current=n(s));var f=!1;(u.current!==s||c.current!==n||l.current!==r||d.current)&&(e=n(s),f=!r(h.current,e)),m((function(){f&&(h.current=e),u.current=s,c.current=n,l.current=r,d.current=!1}));var p=Object(I.useRef)(s);return m((function(){var e=function(){try{var e=t.getState(),n=c.current(e);l.current(h.current,n)||(u.current=e,h.current=n,o())}catch(r){d.current=!0,o()}},n=t.subscribe(e);return t.getState()!==p.current&&e(),n}),[]),f?e:h.current};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");var e=[n,t];return{next:function(){var t=e.length<=0;return{value:e.shift(),done:t}}}},n},v=n(361),A=n.n(v),y=n(360),w=n.n(y),G=n(275),B=n(211),x=n.n(B),S=[];function k(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Object(f.a)(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(x()(n,s.args)){if(i)return;if(s.error)throw s.error;if(s.response)return s.response;throw s.promise}}}catch(c){o.e(c)}finally{o.f()}var u={args:n,promise:e.apply(void 0,Object(d.a)(n)).then((function(e){return u.response=null==e||e})).catch((function(e){return u.error=null!=e?e:"unknown error"})).then((function(){a>0&&setTimeout((function(){var e=t.indexOf(u);-1!==e&&t.splice(e,1)}),a)}))};if(t.push(u),!i)throw u.promise}function Z(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(void 0===n||0===n.length)e.splice(0,e.length);else{var a=e.find((function(e){return x()(n,e.args)}));if(a){var i=e.indexOf(a);-1!==i&&e.splice(i,1)}}}function R(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return k(e,S,n,R.lifespan)}R.lifespan=0,R.clear=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Z.apply(void 0,[S].concat(t))},R.preload=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];k(e,S,n,R.lifespan,!0)},R.peek=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;return null==(r=S.find((function(e){return x()(t,e.args)})))?void 0:r.response};var N=n(282);function O(e){Object(I.useEffect)((function(){var t=e;return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[e])}function W(e,t){Object(I.useEffect)((function(){if(t){var n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),function(){window.removeEventListener("scroll",n,!0)}}}),[e,t])}function F(e){var t=[];if(!e||e===document.body)return t;var n=window.getComputedStyle(e);return[n.overflow,n.overflowX,n.overflowY].some((function(e){return"auto"===e||"scroll"===e}))&&t.push(e),[].concat(t,Object(d.a)(F(e.parentElement)))}var M=["x","y","top","bottom","left","right","width","height"],V=function(e,t){return M.every((function(n){return e[n]===t[n]}))},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1},t=e.debounce,n=e.scroll,a=e.polyfill,i=a||("undefined"===typeof window?function e(){Object(r.a)(this,e)}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");var o=Object(I.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),s=Object(g.a)(o,2),u=s[0],c=s[1],l=Object(I.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:u}),d=t?"number"===typeof t?t:t.scroll:null,h=t?"number"===typeof t?t:t.resize:null,f=Object(I.useRef)(!1);Object(I.useEffect)((function(){return f.current=!0,function(){f.current=!1}}));var p=Object(I.useMemo)((function(){var e=function(){if(l.current.element){var e=l.current.element.getBoundingClientRect(),t={left:e.left,top:e.top,width:e.width,height:e.height,bottom:e.bottom,right:e.right,x:e.x,y:e.y};Object.freeze(t),f.current&&!V(l.current.lastBounds,t)&&c(l.current.lastBounds=t)}};return[e,h?Object(N.debounce)(e,h):e,d?Object(N.debounce)(e,d):e]}),[c,d,h]),C=Object(g.a)(p,3),m=C[0],b=C[1],v=C[2];function A(){l.current.scrollContainers&&(l.current.scrollContainers.forEach((function(e){return e.removeEventListener("scroll",v,!0)})),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function y(){l.current.element&&(l.current.resizeObserver=new i(v),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach((function(e){return e.addEventListener("scroll",v,{capture:!0,passive:!0})})))}var w=function(e){e&&e!==l.current.element&&(A(),l.current.element=e,l.current.scrollContainers=F(e),y())};return W(v,Boolean(n)),O(b),Object(I.useEffect)((function(){A(),y()}),[n,v,b]),Object(I.useEffect)((function(){return A}),[]),[w,u,m]},E={obj:function(e){return e===Object(e)&&!E.arr(e)&&"function"!==typeof e},fun:function(e){return"function"===typeof e},str:function(e){return"string"===typeof e},num:function(e){return"number"===typeof e},und:function(e){return void 0===e},arr:function(e){return Array.isArray(e)},equ:function(e,t){if(typeof e!==typeof t||!!e!==!!t)return!1;if(E.str(e)||E.num(e)||E.obj(e))return e===t;if(E.arr(e)&&e==t)return!0;var n;for(n in e)if(!(n in t))return!1;for(n in t)if(e[n]!==t[n])return!1;return!E.und(n)||e===t}};function j(e){return(e.eventObject||e.object).uuid+"/"+e.index}function L(e){var t=new p.Vector3;function n(t){var n=e.getState().internal,r=t.offsetX-n.initialClick[0],a=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+a*a))}function r(e){return e.filter((function(e){return["Move","Over","Enter","Out","Leave"].some((function(t){var n;return null==(n=e.__r3f.handlers)?void 0:n["onPointer"+t]}))}))}function a(t){var n=e.getState().internal;Array.from(n.hovered.values()).forEach((function(e){if(!t.length||!t.find((function(t){return t.object===e.object&&t.index===e.index}))){var r=e.eventObject.__r3f.handlers;if(n.hovered.delete(j(e)),r){var a=Object(h.a)(Object(h.a)({},e),{},{intersections:t||[]});null==r.onPointerOut||r.onPointerOut(a),null==r.onPointerLeave||r.onPointerLeave(a)}}}))}function i(e,t){t.forEach((function(t){var n;return null==(n=t.__r3f.handlers)||null==n.onPointerMissed?void 0:n.onPointerMissed(e)}))}return{handlePointer:function(o){switch(o){case"onPointerLeave":case"onPointerCancel":return function(){return a([])};case"onLostPointerCapture":return function(t){"pointerId"in t&&e.getState().internal.capturedMap.delete(t.pointerId),a([])}}return function(s){var u=e.getState(),c=u.onPointerMissed,l=u.internal;!function(t){var n,r=e.getState(),a=r.raycaster,i=r.mouse,o=r.camera,s=r.size,u=null!=(n=null==a.computeOffsets?void 0:a.computeOffsets(t,r))?n:t,c=u.offsetX,l=u.offsetY,g=s.width,d=s.height;i.set(c/g*2-1,-l/d*2+1),a.setFromCamera(i,o)}(s);var g="onPointerMove"===o,p=function(t,n){var r=e.getState().internal;return"pointerId"in n&&r.capturedMap.has(n.pointerId)&&t.push.apply(t,Object(d.a)(r.capturedMap.get(n.pointerId).values())),t}(function(t){var n=e.getState(),r=n.raycaster,a=n.internal;if(!r.enabled)return[];var i=new Set,o=[],s=t?t(a.interaction):a.interaction,u=r.intersectObjects(s,!0).filter((function(e){var t=j(e);return!i.has(t)&&(i.add(t),!0)}));r.filter&&(u=r.filter(u,n));var c,l=Object(f.a)(u);try{for(l.s();!(c=l.n()).done;)for(var g=c.value,d=g.object;d;){var p;(null==(p=d.__r3f)?void 0:p.handlers)&&o.push(Object(h.a)(Object(h.a)({},g),{},{eventObject:d})),d=d.parent}}catch(I){l.e(I)}finally{l.f()}return o}(g?r:void 0),s);g&&a(p),function(r,i,o){var s=e.getState(),u=s.raycaster,c=s.mouse,l=s.camera,g=s.internal;r.length&&function(){var e,s=t.set(c.x,c.y,0).unproject(l),p="click"===i.type?n(i):0,I=function(e){return i.target.releasePointerCapture(e)},C={stopped:!1},m=Object(f.a)(r);try{var b=function(){var t=e.value,n=function(e){var n,r;return null!=(n=null==(r=g.capturedMap.get(e))?void 0:r.has(t.eventObject))&&n},f=function(e){g.capturedMap.has(e)?g.capturedMap.get(e).set(t.eventObject,t):g.capturedMap.set(e,new Map([[t.eventObject,t]])),i.target.setPointerCapture(e)},m={};for(var b in Object.getPrototypeOf(i)){var v=i[b];"function"!==typeof v&&(m[b]=v)}var A=Object(h.a)(Object(h.a)(Object(h.a)({},t),m),{},{spaceX:c.x,spaceY:c.y,intersections:r,stopped:C.stopped,delta:p,unprojectedPoint:s,ray:u.ray,camera:l,stopPropagation:function(){var e="pointerId"in i&&g.capturedMap.get(i.pointerId);if((!e||e.has(t.eventObject))&&(A.stopped=C.stopped=!0,g.hovered.size&&Array.from(g.hovered.values()).find((function(e){return e.eventObject===t.eventObject})))){var n=r.slice(0,r.indexOf(t));a([].concat(Object(d.a)(n),[t]))}},target:{hasPointerCapture:n,setPointerCapture:f,releasePointerCapture:I},currentTarget:{hasPointerCapture:n,setPointerCapture:f,releasePointerCapture:I},sourceEvent:i,nativeEvent:i});if(o(A),!0===C.stopped)return"break"};for(m.s();!(e=m.n()).done&&"break"!==b(););}catch(v){m.e(v)}finally{m.f()}}()}(p,s,(function(e){var t=e.eventObject,n=t.__r3f.handlers;if(n)if(g){if(n.onPointerOver||n.onPointerEnter||n.onPointerOut||n.onPointerLeave){var r=j(e),a=l.hovered.get(r);a?a.stopped&&e.stopPropagation():(l.hovered.set(r,e),null==n.onPointerOver||n.onPointerOver(e),null==n.onPointerEnter||n.onPointerEnter(e))}null==n.onPointerMove||n.onPointerMove(e)}else{var u=null==n?void 0:n[o];u&&("onClick"!==o&&"onContextMenu"!==o&&"onDoubleClick"!==o||l.initialHits.includes(t))&&(u(e),i(s,l.interaction.filter((function(e){return e!==t}))))}})),"onPointerDown"===o&&(l.initialClick=[s.offsetX,s.offsetY],l.initialHits=p.map((function(e){return e.eventObject}))),"onClick"!==o&&"onContextMenu"!==o&&"onDoubleClick"!==o||p.length||n(s)<=2&&(i(s,l.interaction),c&&c(s))}}}}var X=function(e){return e&&!!e.getState},H=function(e,t){var n,r;return{root:X(e)?e:null!=(n=null==(r=e.__r3f)?void 0:r.root)?n:t.__r3f.root,container:X(e)?e.getState().scene:e}},Y="__default",z={},K=["children","key","ref"],_={},D=function(e){_=Object(h.a)(Object(h.a)({},_),e)};function P(e,t){var n=e;return(null!=t&&t.instance||!n.__r3f)&&(n.__r3f=Object(h.a)({root:null,memoizedProps:{},objects:[]},t)),e}var U,J=function(e){return e&&e.isOrthographicCamera},Q=I.createContext(null),q=function(e,t,n,r){var a=r.gl,i=r.size,o=r.shadows,s=void 0!==o&&o,c=r.linear,l=void 0!==c&&c,g=r.flat,f=void 0!==g&&g,I=r.vr,C=void 0!==I&&I,m=r.orthographic,v=void 0!==m&&m,y=r.frameloop,w=void 0===y?"always":y,G=r.dpr,B=void 0===G?1:G,x=r.performance,S=r.clock,k=void 0===S?new p.Clock:S,Z=r.raycaster,R=r.camera,N=r.onPointerMissed;s&&(a.shadowMap.enabled=!0,"object"===typeof s?Object.assign(a.shadowMap,s):a.shadowMap.type=p.PCFSoftShadowMap),l||(f||(a.toneMapping=p.ACESFilmicToneMapping),a.outputEncoding=p.sRGBEncoding),"never"===w&&(k.stop(),k.elapsedTime=0);var O=b((function(i,o){var s=new p.Raycaster,c=Z||{},g=c.params,I=Object(u.a)(c,["params"]);e(s,Object(h.a)(Object(h.a)({enabled:!0},I),{},{params:Object(h.a)(Object(h.a)({},s.params),g)}),{});var m=R instanceof p.Camera,b=m?R:v?new p.OrthographicCamera(0,0,0,0,.1,1e3):new p.PerspectiveCamera(75,0,.1,1e3);function A(e){return Array.isArray(e)?Math.min(Math.max(e[0],window.devicePixelRatio),e[1]):e}m||(b.position.z=5,R&&e(b,R,{}),b.lookAt(0,0,0));var y=A(B),G=new p.Vector3,S=new p.Vector3;function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o().size,r=n.width,a=n.height,i=r/a,s=e.getWorldPosition(G).distanceTo(t);if(J(e))return{width:r/e.zoom,height:a/e.zoom,factor:1,distance:s,aspect:i};var u=e.fov*Math.PI/180,c=2*Math.tan(u/2)*s,l=c*(r/a);return{width:l,height:c,factor:r/l,distance:s,aspect:i}}var W=void 0,F=function(e){return i((function(t){return{performance:Object(h.a)(Object(h.a)({},t.performance),{},{current:e})}}))};return{gl:a,set:i,get:o,invalidate:function(){return t(o())},advance:function(e,t){return n(e,t,o())},linear:l,flat:f,scene:P(new p.Scene),camera:b,raycaster:s,clock:k,mouse:new p.Vector2,vr:C,frameloop:w,onPointerMissed:N,performance:Object(h.a)(Object(h.a)({current:1,min:.5,max:1,debounce:200},x),{},{regress:function(){var e=o();W&&clearTimeout(W),e.performance.current!==e.performance.min&&F(e.performance.min),W=setTimeout((function(){return F(o().performance.max)}),e.performance.debounce)}}),size:{width:0,height:0},viewport:{initialDpr:y,dpr:y,width:0,height:0,aspect:0,distance:0,factor:0,getCurrentViewport:O},setSize:function(e,t){var n={width:e,height:t};i((function(e){return{size:n,viewport:Object(h.a)(Object(h.a)({},e.viewport),O(b,S,n))}}))},setDpr:function(e){return i((function(t){return{viewport:Object(h.a)(Object(h.a)({},t.viewport),{},{dpr:A(e)})}}))},events:{connected:!1},internal:{active:!1,priority:0,frames:0,lastProps:r,interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return i((function(n){var r=n.internal;return{internal:Object(h.a)(Object(h.a)({},r),{},{priority:r.priority+(t>0?1:0),subscribers:[].concat(Object(d.a)(r.subscribers),[{ref:e,priority:t}]).sort((function(e,t){return e.priority-t.priority}))})}})),function(){i((function(n){var r=n.internal;return{internal:Object(h.a)(Object(h.a)({},r),{},{priority:r.priority-(t>0?1:0),subscribers:r.subscribers.filter((function(t){return t.ref!==e}))})}}))}}}}}));O.subscribe((function(){var e=O.getState(),t=e.camera,n=e.size,r=e.viewport;e.internal.lastProps.camera instanceof p.Camera||(J(t)?(t.left=n.width/-2,t.right=n.width/2,t.top=n.height/2,t.bottom=n.height/-2):t.aspect=n.width/n.height,t.updateProjectionMatrix(),t.updateMatrixWorld()),a.setPixelRatio(r.dpr),a.setSize(n.width,n.height)}),(function(e){return[e.viewport.dpr,e.size]}),A.a);var W=O.getState();return i&&W.setSize(i.width,i.height),O.subscribe((function(e){return t(e)})),O};function $(e,t){var n=t.length;return t.push(e),function(){t.splice(n,1)}}var ee=[],te=[],ne=[],re=function(e){return $(e,ee)},ae=function(e){return $(e,te)};function ie(e,t){for(U=0;U<e.length;U++)e[U](t)}function oe(e,t){var n=t.clock.getDelta();for("never"===t.frameloop&&"number"===typeof e&&(n=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),U=0;U<t.internal.subscribers.length;U++)t.internal.subscribers[U].ref.current(t,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function se(e){var t=L(e).handlePointer,n={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};return{connected:!1,handlers:Object.keys(n).reduce((function(e,n){return Object(h.a)(Object(h.a)({},e),{},Object(c.a)({},n,t(n)))}),{}),connect:function(t){var r,a=e.getState(),i=a.set,o=a.events;null==o.disconnect||o.disconnect(),i((function(e){return{events:Object(h.a)(Object(h.a)({},e.events),{},{connected:t})}})),Object.entries(null!=(r=null==o?void 0:o.handlers)?r:[]).forEach((function(e){var r=Object(g.a)(e,2),a=r[0],i=r[1],o=Object(g.a)(n[a],2),s=o[0],u=o[1];t.addEventListener(s,i,{passive:u})}))},disconnect:function(){var t,r=e.getState(),a=r.set,i=r.events;i.connected&&(Object.entries(null!=(t=i.handlers)?t:[]).forEach((function(e){var t=Object(g.a)(e,2),r=t[0],a=t[1];if(i&&i.connected instanceof HTMLElement){var o=Object(g.a)(n[r],1)[0];i.connected.removeEventListener(o,a)}})),a((function(e){return{events:Object(h.a)(Object(h.a)({},e.events),{},{connected:!1})}})))}}}var ue="undefined"!==typeof window?I.useLayoutEffect:I.useEffect;function ce(e){var t=e.set;return ue((function(){return t(new Promise((function(){return null}))),function(){return t(!1)}}),[]),null}var le=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={error:!1},e}return Object(a.a)(n,[{key:"componentDidCatch",value:function(e){this.props.set(e)}},{key:"render",value:function(){return this.state.error?null:this.props.children}}]),n}(I.Component);function ge(e){var t=e.children,n=e.fallback,r=e.tabIndex,a=e.resize,i=e.id,o=e.style,s=e.className,c=e.events,l=Object(u.a)(e,["children","fallback","tabIndex","resize","id","style","className","events"]),d=T(Object(h.a)({scroll:!0,debounce:{scroll:50,resize:0}},a)),f=Object(g.a)(d,2),p=f[0],C=f[1],m=I.useRef(null),b=I.useState(!1),v=Object(g.a)(b,2),A=v[0],y=v[1],w=I.useState(!1),G=Object(g.a)(w,2),B=G[0],x=G[1];if(A)throw A;if(B)throw B;return ue((function(){C.width>0&&C.height>0&&function(e,t){var n,r,a,i,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=s.gl,l=s.size,g=s.mode,d=void 0===g?me[1]:g,f=s.events,p=s.onCreated,C=Object(u.a)(s,["gl","size","mode","events","onCreated"]);l||(l={width:null!=(r=null==(a=t.parentElement)?void 0:a.clientWidth)?r:0,height:null!=(i=null==(o=t.parentElement)?void 0:o.clientHeight)?i:0});var m=Ce.get(t),b=null==m?void 0:m.fiber,v=null==m?void 0:m.store,A=null==(n=v)?void 0:n.getState();if(b&&A){var y=A.internal.lastProps;void 0===C.dpr||E.equ(y.dpr,C.dpr)||A.setDpr(C.dpr),void 0===l||E.equ(y.size,l)||A.setSize(l.width,l.height),C.linear!==y.linear&&(Se(t),b=void 0)}if(!b){var w=Be(c,t);C.vr&&(w.xr.enabled=!0,w.setAnimationLoop((function(e){return Ae(e,!0)})));var G=(v=q(Ge,ve,Ae,Object(h.a)({gl:w,size:l},C))).getState();G.get,b=we.createContainer(v,me.indexOf(d),!1,null),Ce.set(t,{fiber:b,store:v}),f&&G.set({events:f(v)})}if(v&&b)return we.updateContainer(I.createElement(xe,{store:v,element:e,onCreated:p,target:t}),b,null,(function(){})),v;throw"Error creating root!"}(I.createElement(le,{set:x},I.createElement(I.Suspense,{fallback:I.createElement(ce,{set:y})},t)),m.current,Object(h.a)(Object(h.a)({},l),{},{size:C,events:c||se}))}),[C,t]),ue((function(){var e=m.current;return function(){return Se(e)}}),[]),I.createElement("div",{ref:p,id:i,className:s,tabIndex:r,style:Object(h.a)({position:"relative",width:"100%",height:"100%",overflow:"hidden"},o)},I.createElement("canvas",{ref:m,style:{display:"block"}},n))}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1?arguments[1]:void 0,n=I.useContext(Q);if(!n)throw"R3F hooks can only be used within the Canvas component!";return n(e,t)}function he(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=I.useContext(Q).getState().internal.subscribe,r=I.useRef(e);return I.useLayoutEffect((function(){r.current=e}),[e]),I.useLayoutEffect((function(){var e=n(r,t);return function(){return e()}}),[t,n]),null}function fe(e){var t={nodes:{},materials:{}};return e&&e.traverse((function(e){e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}function pe(e,t){return function(n){var r=new n;e&&e(r);for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return Promise.all(i.map((function(e){return new Promise((function(n,a){return r.load(e,(function(e){e.scene&&Object.assign(e,fe(e.scene)),n(e)}),t,(function(t){return a("Could not load ".concat(e,": ").concat(t.message))}))}))})))}}function Ie(e,t,n,r){var a=Array.isArray(t)?t:[t],i=R.apply(void 0,[pe(n,r),e].concat(Object(d.a)(a)));return Array.isArray(t)?i:i[0]}le.getDerivedStateFromError=function(){return{error:!0}},Ie.preload=function(e,t,n){var r=Array.isArray(t)?t:[t];return R.preload.apply(R,[pe(n),e].concat(Object(d.a)(r)))};var Ce=new Map,me=["legacy","blocking","concurrent"],be=function(e){var t,n=!1;function r(a){if(n=!0,t=0,ie(ee,a),e.forEach((function(e){var n=e.store.getState();n.internal.active&&("always"===n.frameloop||n.internal.frames>0)&&(t+=oe(a,n))})),ie(te,a),t>0)return requestAnimationFrame(r);ie(ne,a),n=!1}return{loop:r,invalidate:function t(a){if(!a)return e.forEach((function(e){return t(e.store.getState())}));!a.vr&&a.internal.active&&"never"!==a.frameloop&&(a.internal.frames=Math.min(60,a.internal.frames+1),n||(n=!0,requestAnimationFrame(r)))},advance:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;n&&ie(ee,t),r?oe(t,r):e.forEach((function(e){return oe(t,e.store.getState())})),n&&ie(te,t)}}}(Ce),ve=be.invalidate,Ae=be.advance,ye=function(e){function t(e,t){var a,i,o,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=null!=(a=null==e?void 0:e.__r3f)?a:{},I=f.root,C=null!=(i=null==I||null==I.getState?void 0:I.getState())?i:{},m=[],b=[],v={},A=0;Object.entries(t).forEach((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];-1===K.indexOf(n)&&(v[n]=r)})),f.memoizedProps&&f.memoizedProps.args&&(v.args=f.memoizedProps.args),f.memoizedProps&&f.memoizedProps.attach&&(v.attach=f.memoizedProps.attach),e.__r3f&&(e.__r3f.memoizedProps=v);var y=Object.keys(t);for(A=0;A<y.length;A++)E.equ(t[y[A]],s[y[A]])&&m.push(y[A]),E.fun(t[y[A]])&&/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y[A])&&b.push(y[A]);var w=[];if(u)for(y=Object.keys(s),A=0;A<y.length;A++)t.hasOwnProperty(y[A])||w.push(y[A]);var G=[].concat(m,K);null!=(o=e.__r3f)&&o.instance&&G.push("object");var B=Object(h.a)({},t);for(y=Object.keys(B),A=0;A<y.length;A++)G.indexOf(y[A])>-1&&delete B[y[A]];var x=Object.entries(B);for(A=0;A<w.length;A++)"children"!==w[A]&&x.unshift([w[A],Y+"remove"]);if(x.length>0){if(x.forEach((function(t){var r=Object(g.a)(t,2),a=r[0],i=r[1];if(!b.includes(a)){var o,s=e,u=s[a];if(a.includes("-")){var c=a.split("-");if(!(u=c.reduce((function(e,t){return e[t]}),e))||!u.set){var h=c.reverse(),f=Object(l.a)(h),I=f[0];s=f.slice(1).reverse().reduce((function(e,t){return e[t]}),e),a=I}}if(i===Y+"remove")if(u&&u.constructor)i=new u.constructor(v.args);else if(s.constructor){var m=new s.constructor(s.__r3f.memoizedProps.args);i=m[u],m.dispose&&m.dispose()}else i=0;if(u&&u.set&&(u.copy||u instanceof p.Layers)){if(Array.isArray(i))if(u.fromArray)u.fromArray(i);else(o=u).set.apply(o,Object(d.a)(i));else if(u.copy&&i&&i.constructor&&u.constructor.name===i.constructor.name)u.copy(i);else if(void 0!==i){var A=u instanceof p.Color;!A&&u.setScalar?u.setScalar(i):u instanceof p.Layers&&i instanceof p.Layers?u.mask=i.mask:u.set(i),!C.linear&&A&&u.convertSRGBToLinear()}}else s[a]=i,!C.linear&&s[a]instanceof p.Texture&&(s[a].encoding=p.sRGBEncoding);n(e)}})),u&&I&&e.raycast&&f.handlers){f.handlers=void 0;var S=C.internal.interaction.indexOf(e);S>-1&&C.internal.interaction.splice(S,1)}b.length&&(u&&I&&e.raycast&&C.internal.interaction.push(e),f.handlers=b.reduce((function(e,n){return Object(h.a)(Object(h.a)({},e),{},Object(c.a)({},n,t[n]))}),{})),e.parent&&r(e)}}function n(e){var t,n,r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function r(e){null==e.onUpdate||e.onUpdate(e)}function a(e,n,r,a,i){var o,c=n.args,l=void 0===c?[]:c,g=Object(u.a)(n,["args"]),f="".concat(e[0].toUpperCase()).concat(e.slice(1));if(!X(r)&&i){r=function e(t){return t.return?e(t.return):t.stateNode&&t.stateNode.containerInfo}(i)}if(!r||!X(r))throw"No valid root for ".concat(f,"!");if("primitive"===e){if(void 0===g.object)throw"Primitives without 'object' are invalid!";o=P(g.object,{root:r,instance:!0})}else{var I=_[f]||p[f];if(!I)throw"".concat(f," is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively");var C=E.arr(l);o=P(C?Object(s.a)(I,Object(d.a)(l)):new I(l),{root:r,memoizedProps:{args:C&&0===l.length?null:l}})}return f.endsWith("Geometry")?g=Object(h.a)({attach:"geometry"},g):f.endsWith("Material")&&(g=Object(h.a)({attach:"material"},g)),t(o,g,{}),o}function i(e,t){var a=!1;t&&(t.attachArray?(E.arr(e[t.attachArray])||(e[t.attachArray]=[]),e[t.attachArray].push(t)):t.attachObject?(E.obj(e[t.attachObject[0]])||(e[t.attachObject[0]]={}),e[t.attachObject[0]][t.attachObject[1]]=t):t.attach&&!E.fun(t.attach)?e[t.attach]=t:t.isObject3D&&(e.add(t),a=!0),a||(e.__r3f.objects.push(t),t.parent=e),r(t),n(t))}function o(e,t,a){var o=!1;if(t){if(t.attachArray){var s=e[t.attachArray];E.arr(s)||(e[t.attachArray]=[]),s.splice(s.indexOf(a),0,t)}else{if(t.attachObject||t.attach&&!E.fun(t.attach))return o=!0,i(e,t);if(t.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});var u=e.children.filter((function(e){return e!==t})),c=u.indexOf(a);e.children=[].concat(Object(d.a)(u.slice(0,c)),[t],Object(d.a)(u.slice(c))),o=!0}}o||(e.__r3f.objects.push(t),t.parent=e),r(t),n(t)}}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&Object(d.a)(e).forEach((function(e){return I(t,e,n)}))}function I(e,t,r){if(t){var a;if(e.__r3f.objects){var i=e.__r3f.objects.length;e.__r3f.objects=e.__r3f.objects.filter((function(e){return e!==t})),e.__r3f.objects.length<i&&(t.parent=null)}if(t.attachArray)e[t.attachArray]=e[t.attachArray].filter((function(e){return e!==t}));else if(t.attachObject)delete e[t.attachObject[0]][t.attachObject[1]];else if(t.attach&&!E.fun(t.attach))e[t.attach]=null;else if(t.isObject3D){var o;e.remove(t),null!=(o=t.__r3f)&&o.root&&function(e,t){var n=e.getState().internal;n.interaction=n.interaction.filter((function(e){return e!==t})),n.initialHits=n.initialHits.filter((function(e){return e!==t})),n.hovered.forEach((function(e,r){e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}))}(t.__r3f.root,t)}var s,u=null==(a=t.__r3f)?void 0:a.instance,c=void 0===r?null!==t.dispose&&!u:r;if(!u)f(null==(s=t.__r3f)?void 0:s.objects,t,c),f(t.children,t,c);t.__r3f&&(delete t.__r3f.root,delete t.__r3f.objects,delete t.__r3f.handlers,delete t.__r3f.memoizedProps,u||delete t.__r3f),c&&t.dispose&&"Scene"!==t.type&&Object(G.unstable_runWithPriority)(G.unstable_IdlePriority,(function(){return t.dispose()})),n(e)}}function C(e,t,n,r){var o=e.parent;if(o){var s=a(t,n,e.__r3f.root);e.children&&(e.children.forEach((function(e){return i(s,e)})),e.children=[]),e.__r3f.objects.forEach((function(e){return i(s,e)})),e.__r3f.objects=[],I(o,e),i(o,s),[r,r.alternate].forEach((function(e){null!==e&&(e.stateNode=s,e.ref&&("function"===typeof e.ref?e.ref(s):e.ref.current=s))}))}}return{reconciler:w()({now:G.unstable_now,createInstance:a,removeChild:I,appendChild:i,appendInitialChild:i,insertBefore:o,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:E.fun(setTimeout)?setTimeout:void 0,cancelTimeout:E.fun(clearTimeout)?clearTimeout:void 0,setTimeout:E.fun(setTimeout)?setTimeout:void 0,clearTimeout:E.fun(clearTimeout)?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:function(e,t){var n=H(e,t),r=n.container,a=n.root;r.__r3f.root=a,i(r,t)},removeChildFromContainer:function(e,t){I(H(e,t).container,t)},insertInContainerBefore:function(e,t,n){o(H(e,t).container,t,n)},commitUpdate:function(e,n,r,a,i,o){if(e.__r3f.instance&&i.object&&i.object!==e)C(e,r,i,o);else{var s=i.args,c=void 0===s?[]:s,l=Object(u.a)(i,["args"]),d=a.args,h=void 0===d?[]:d,f=Object(u.a)(a,["args"]);c.some((function(e,t){return E.obj(e)?Object.entries(e).some((function(e){var n=Object(g.a)(e,2),r=n[0];return n[1]!==h[t][r]})):e!==h[t]}))?C(e,r,i,o):t(e,l,f,!0)}},hideInstance:function(e){e.isObject3D&&(e.visible=!1,n(e))},unhideInstance:function(e,t){(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0,n(e))},hideTextInstance:function(){throw new Error("Text is not allowed in the R3F tree.")},getPublicInstance:function(e){return e},getRootHostContext:function(e){return z},getChildHostContext:function(e){return z},createTextInstance:function(){},finalizeInitialChildren:function(e){return!!e.__r3f.handlers},commitMount:function(e){e.raycast&&e.__r3f.handlers&&e.__r3f.root.getState().internal.interaction.push(e)},prepareUpdate:function(){return z},shouldDeprioritizeSubtree:function(){return!1},prepareForCommit:function(){return null},preparePortalMount:function(){},resetAfterCommit:function(){},shouldSetTextContent:function(){return!1},clearContainer:function(){return!1}}),applyProps:t}}(),we=ye.reconciler,Ge=ye.applyProps,Be=function(e,t){return(n=e)&&n.render?e:new p.WebGLRenderer(Object(h.a)({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0},e));var n};function xe(e){var t=e.store,n=e.element,r=e.onCreated,a=e.target;return I.useEffect((function(){var e=t.getState();e.set((function(e){return{internal:Object(h.a)(Object(h.a)({},e.internal),{},{active:!0})}})),null==e.events.connect||e.events.connect(a),r&&r(e)}),[]),I.createElement(Q.Provider,{value:t},n)}function Se(e,t){var n=Ce.get(e),r=null==n?void 0:n.fiber;if(r){var a=null==n?void 0:n.store.getState();a&&(a.internal.active=!1),we.updateContainer(null,r,null,(function(){a&&setTimeout((function(){var n,r,i;null==a.events.disconnect||a.events.disconnect(),null==(n=a.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(i=a.gl)||null==i.forceContextLoss||i.forceContextLoss(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(var t in e){var n,r;null==(n=(r=t).dispose)||n.call(r),delete e[t]}}(a),Ce.delete(e),t&&t(e)}),500)}))}}we.act,E.fun(Symbol)&&Symbol.for&&Symbol.for("react.portal");we.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:"17.0.2"})},function(e,t,n){"use strict";function r(e){var t,n,a="";if("string"===typeof e||"number"===typeof e)a+=e;else if("object"===typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(a&&(a+=" "),a+=n);else for(t in e)e[t]&&(a&&(a+=" "),a+=t);return a}t.a=function(){for(var e,t,n=0,a="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(a&&(a+=" "),a+=t);return a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({neg_:function(e){var t={x:Object(i.a)(e,"x","neg")};return r.a.runKernel(a.Wb,t)}})},function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a=n(105);function i(e,t){return r.useMemo((function(){return null==e&&null==t?null:function(n){Object(a.a)(e,n),Object(a.a)(t,n)}}),[e,t])}},function(e,t,n){e.exports=n(413)()},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"i",(function(){return C})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return b}));var r=n(3),a=n(21);function i(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,s=e[3],c=[].concat(Object(a.a)(t),[s]),l=b(i);return u(e,c,n,o,r,null,null,l)}function o(e,t,n,a,i,o){var s,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=g(t),d=Object(r.a)(l,2),h=d[0],f=d[1];if("channelsLast"===c)s=[h,f,e[3],e[3]];else{if("channelsFirst"!==c)throw new Error("Unknown dataFormat ".concat(c));s=[h,f,e[1],e[1]]}return u(e,s,n,a,i,o,!1,c)}function s(e,t,n,a,i,o){var s,u,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",g=d(t),h=Object(r.a)(g,3),f=h[0],p=h[1],I=h[2];if("NDHWC"===l)u="channelsLast",s=[f,p,I,e[4],e[4]];else{if("NCDHW"!==l)throw new Error("Unknown dataFormat ".concat(l));u="channelsFirst",s=[f,p,I,e[1],e[1]]}return c(e,s,n,a,i,!1,u,o)}function u(e,t,n,a,i,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",c=-1,l=-1,d=-1,p=-1;if("channelsLast"===u){var I=Object(r.a)(e,4);c=I[0],l=I[1],d=I[2],p=I[3]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var C=Object(r.a)(e,4);c=C[0],p=C[1],l=C[2],d=C[3]}var m,b=Object(r.a)(t,4),v=b[0],A=b[1],y=b[3],w=g(n),G=Object(r.a)(w,2),B=G[0],x=G[1],S=g(a),k=Object(r.a)(S,2),Z=k[0],R=k[1],N=h(v,Z),O=h(A,R),W=f(i,l,d,B,x,N,O,o,u),F=W.padInfo,M=W.outHeight,V=W.outWidth,T=s?y*p:y;return"channelsFirst"===u?m=[c,T,M,V]:"channelsLast"===u&&(m=[c,M,V,T]),{batchSize:c,dataFormat:u,inHeight:l,inWidth:d,inChannels:p,outHeight:M,outWidth:V,outChannels:T,padInfo:F,strideHeight:B,strideWidth:x,filterHeight:v,filterWidth:A,effectiveFilterHeight:N,effectiveFilterWidth:O,dilationHeight:Z,dilationWidth:R,inShape:e,outShape:m,filterShape:t}}function c(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=arguments.length>7?arguments[7]:void 0,c=-1,l=-1,g=-1,f=-1,I=-1;if("channelsLast"===s){var C=Object(r.a)(e,5);c=C[0],l=C[1],g=C[2],f=C[3],I=C[4]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var m=Object(r.a)(e,5);c=m[0],I=m[1],l=m[2],g=m[3],f=m[4]}var b,v=Object(r.a)(t,5),A=v[0],y=v[1],w=v[2],G=v[4],B=d(n),x=Object(r.a)(B,3),S=x[0],k=x[1],Z=x[2],R=d(a),N=Object(r.a)(R,3),O=N[0],W=N[1],F=N[2],M=h(A,O),V=h(y,W),T=h(w,F),E=p(i,l,g,f,S,k,Z,M,V,T,u),j=E.padInfo,L=E.outDepth,X=E.outHeight,H=E.outWidth,Y=o?G*I:G;return"channelsFirst"===s?b=[c,Y,L,X,H]:"channelsLast"===s&&(b=[c,L,X,H,Y]),{batchSize:c,dataFormat:s,inDepth:l,inHeight:g,inWidth:f,inChannels:I,outDepth:L,outHeight:X,outWidth:H,outChannels:Y,padInfo:j,strideDepth:S,strideHeight:k,strideWidth:Z,filterDepth:A,filterHeight:y,filterWidth:w,effectiveFilterDepth:M,effectiveFilterHeight:V,effectiveFilterWidth:T,dilationDepth:O,dilationHeight:W,dilationWidth:F,inShape:e,outShape:b,filterShape:t}}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=h(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function g(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function d(e){return"number"===typeof e?[e,e,e]:e}function h(e,t){return t<=1?e:e+(e-1)*(t-1)}function f(e,t,n,r,a,i,o,s,u){var c,g,d;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=l(e,t,n));var i=e[0],o=e[1];return[I((i-t+2*r)/n+1,a),I((o-t+2*r)/n+1,a)]}([t,n],i,r,e,s);g=h[0],d=h[1]}else if("same"===e){g=Math.ceil(t/r),d=Math.ceil(n/a);var f=Math.max(0,(g-1)*r+i-t),p=Math.max(0,(d-1)*a+o-n),C=Math.floor(f/2),m=f-C,b=Math.floor(p/2);c={top:C,bottom:m,left:b,right:p-b,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},g=Math.ceil((t-i+1)/r),d=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var v="channelsLast"===u?e[1][0]:e[2][0],A="channelsLast"===u?e[1][1]:e[2][1],y="channelsLast"===u?e[2][0]:e[3][0],w="channelsLast"===u?e[2][1]:e[3][1];c={top:v,bottom:A,left:y,right:w,type:0===v&&0===A&&0===y&&0===w?"VALID":"EXPLICIT"},g=I((t-i+v+A)/r+1,s),d=I((n-o+y+w)/a+1,s)}return{padInfo:c,outHeight:g,outWidth:d}}function p(e,t,n,r,a,i,o,s,u,c,g){var d,h,f,p;if("number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var C=function(e,t,n,r,a,i){null==a&&(a=l(e,t,r));var o=e[0],s=e[1],u=e[2];return[I((o-t+2*a)/r+1,i),I((s-t+2*a)/r+1,i),I((u-t+2*a)/r+1,i),n]}([t,n,r,1],s,1,a,e,g);h=C[0],f=C[1],p=C[2]}else if("same"===e){var m=((h=Math.ceil(t/a))-1)*a+s-t,b=((f=Math.ceil(n/i))-1)*i+u-n,v=((p=Math.ceil(r/o))-1)*o+c-r,A=Math.floor(m/2),y=m-A,w=Math.floor(b/2),G=b-w,B=Math.floor(v/2);d={top:w,bottom:G,left:B,right:v-B,front:A,back:y,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-s+1)/a),f=Math.ceil((n-u+1)/i),p=Math.ceil((r-c+1)/o)}return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function I(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function C(e){var t=g(e),n=Object(r.a)(t,3),a=n[0],i=n[1],o=n[2];return 1===a&&1===i&&1===o}function m(e,t){return C(e)||C(t)}function b(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(107),u=n(10);var c=Object(u.b)({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(o.b)(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Object(i.b)(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Object(s.a)(n[0]);var u=n,c={axis:t};return r.a.runKernel(a.B,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(143),s=n(33),u=n(10);var c=Object(u.b)({where_:function(e,t,n){var u=Object(i.a)(t,"a","where"),c=Object(i.a)(n,"b","where"),l=Object(i.a)(e,"condition","where","bool"),g=Object(s.a)(Object(s.a)(l.shape,u.shape),c.shape),d={condition:Object(o.a)(l,g),t:Object(o.a)(u,g),e:Object(o.a)(c,g)};return r.a.runKernel(a.yc,d)}})},function(e,t,n){"use strict";var r=n(25),a=n(38),i=n(2),o=n.n(i),s=(n(52),n(146)),u=n.n(s),c=n(82);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.baseClasses,n=e.newClasses;e.Component;if(!n)return t;var a=Object(r.a)({},t);return Object.keys(n).forEach((function(e){n[e]&&(a[e]="".concat(t[e]," ").concat(n[e]))})),a}var g={set:function(e,t,n,r){var a=e.get(t);a||(a=new Map,e.set(t,a)),a.set(n,r)},get:function(e,t,n){var r=e.get(t);return r?r.get(n):void 0},delete:function(e,t,n){e.get(t).delete(n)}},d=n(395),h=n(506),f=-1e9;function p(){return f+=1}n(202);var I=n(498);function C(e){var t="function"===typeof e;return{create:function(n,a){var i;try{i=t?e(n):e}catch(u){throw u}if(!a||!n.overrides||!n.overrides[a])return i;var o=n.overrides[a],s=Object(r.a)({},i);return Object.keys(o).forEach((function(e){s[e]=Object(I.a)(s[e],o[e])})),s},options:{}}}var m={};function b(e,t,n){var r=e.state;if(e.stylesOptions.disableGeneration)return t||{};r.cacheClasses||(r.cacheClasses={value:null,lastProp:null,lastJSS:{}});var a=!1;return r.classes!==r.cacheClasses.lastJSS&&(r.cacheClasses.lastJSS=r.classes,a=!0),t!==r.cacheClasses.lastProp&&(r.cacheClasses.lastProp=t,a=!0),a&&(r.cacheClasses.value=l({baseClasses:r.cacheClasses.lastJSS,newClasses:t,Component:n})),r.cacheClasses.value}function v(e,t){var n=e.state,a=e.theme,i=e.stylesOptions,o=e.stylesCreator,s=e.name;if(!i.disableGeneration){var u=g.get(i.sheetsManager,o,a);u||(u={refs:0,staticSheet:null,dynamicStyles:null},g.set(i.sheetsManager,o,a,u));var d=Object(r.a)({},o.options,i,{theme:a,flip:"boolean"===typeof i.flip?i.flip:"rtl"===a.direction});d.generateId=d.serverGenerateClassName||d.generateClassName;var h=i.sheetsRegistry;if(0===u.refs){var f;i.sheetsCache&&(f=g.get(i.sheetsCache,o,a));var p=o.create(a,s);f||((f=i.jss.createStyleSheet(p,Object(r.a)({link:!1},d))).attach(),i.sheetsCache&&g.set(i.sheetsCache,o,a,f)),h&&h.add(f),u.staticSheet=f,u.dynamicStyles=Object(c.d)(p)}if(u.dynamicStyles){var I=i.jss.createStyleSheet(u.dynamicStyles,Object(r.a)({link:!0},d));I.update(t),I.attach(),n.dynamicSheet=I,n.classes=l({baseClasses:u.staticSheet.classes,newClasses:I.classes}),h&&h.add(I)}else n.classes=u.staticSheet.classes;u.refs+=1}}function A(e,t){var n=e.state;n.dynamicSheet&&n.dynamicSheet.update(t)}function y(e){var t=e.state,n=e.theme,r=e.stylesOptions,a=e.stylesCreator;if(!r.disableGeneration){var i=g.get(r.sheetsManager,a,n);i.refs-=1;var o=r.sheetsRegistry;0===i.refs&&(g.delete(r.sheetsManager,a,n),r.jss.removeStyleSheet(i.staticSheet),o&&o.remove(i.staticSheet)),t.dynamicSheet&&(r.jss.removeStyleSheet(t.dynamicSheet),o&&o.remove(t.dynamicSheet))}}function w(e,t){var n,r=o.a.useRef([]),a=o.a.useMemo((function(){return{}}),t);r.current!==a&&(r.current=a,n=e()),o.a.useEffect((function(){return function(){n&&n()}}),[a])}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.name,i=t.classNamePrefix,s=t.Component,u=t.defaultTheme,c=void 0===u?m:u,l=Object(a.a)(t,["name","classNamePrefix","Component","defaultTheme"]),g=C(e),f=n||i||"makeStyles";g.options={index:p(),name:n,meta:f,classNamePrefix:f};var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(d.a)()||c,a=Object(r.a)({},o.a.useContext(h.a),l),i=o.a.useRef(),u=o.a.useRef();w((function(){var r={name:n,state:{},stylesCreator:g,stylesOptions:a,theme:t};return v(r,e),u.current=!1,i.current=r,function(){y(r)}}),[t,g]),o.a.useEffect((function(){u.current&&A(i.current,e),u.current=!0}));var f=b(i.current,e.classes,s);return f};return I}var B=n(499),x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var i=t.defaultTheme,s=t.withTheme,c=void 0!==s&&s,l=t.name,g=Object(a.a)(t,["defaultTheme","withTheme","name"]);var h=l,f=G(e,Object(r.a)({defaultTheme:i,Component:n,name:l||n.displayName,classNamePrefix:h},g)),p=o.a.forwardRef((function(e,t){e.classes;var s,u=e.innerRef,g=Object(a.a)(e,["classes","innerRef"]),h=f(Object(r.a)({},n.defaultProps,e)),p=g;return("string"===typeof l||c)&&(s=Object(d.a)()||i,l&&(p=Object(B.a)({theme:s,name:l,props:g})),c&&!p.theme&&(p.theme=s)),o.a.createElement(n,Object(r.a)({ref:u||t,classes:h},p))}));return u()(p,n),p}},S=n(261);t.a=function(e,t){return x(e,Object(r.a)({defaultTheme:S.a},t))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(394);function a(e){if("string"!==typeof e)throw new Error(Object(r.a)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return g}));var r=n(394);function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function i(e){if(e.type)return e;if("#"===e.charAt(0))return i(function(e){e=e.substr(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla"].indexOf(n))throw new Error(Object(r.a)(3,e));var a=e.substring(t+1,e.length-1).split(",");return{type:n,values:a=a.map((function(e){return parseFloat(e)}))}}function o(e){var t=e.type,n=e.values;return-1!==t.indexOf("rgb")?n=n.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(n[1]="".concat(n[1],"%"),n[2]="".concat(n[2],"%")),"".concat(t,"(").concat(n.join(", "),")")}function s(e,t){var n=u(e),r=u(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function u(e){var t="hsl"===(e=i(e)).type?i(function(e){var t=(e=i(e)).values,n=t[0],r=t[1]/100,a=t[2]/100,s=r*Math.min(a,1-a),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return a-s*Math.max(Math.min(t-3,9-t,1),-1)},c="rgb",l=[Math.round(255*u(0)),Math.round(255*u(8)),Math.round(255*u(4))];return"hsla"===e.type&&(c+="a",l.push(t[3])),o({type:c,values:l})}(e)).values:e.values;return t=t.map((function(e){return(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function c(e,t){return e=i(e),t=a(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),e.values[3]=t,o(e)}function l(e,t){if(e=i(e),t=a(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return o(e)}function g(e,t){if(e=i(e),t=a(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;return o(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));n(21);var r=n(11),a=n(14),i=(n(5),n(19));function o(e,t){i.b(i.u(e),(function(){return"The f passed in variableGrads(f) must be a function"})),i.b(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof a.c})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var o in t=[],r.a.registeredVariables)t.push(r.a.registeredVariables[o]);var s=n?t.filter((function(e){return!e.trainable})):null,u=t.length;t=t.filter((function(e){return e.trainable})),i.b(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(u," variables is ")+"trainable."}));var c=r.a.gradients(e,t,null,!0),l=c.value,g=c.grads;i.b(g.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),i.b(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var d={};return t.forEach((function(e,t){null!=g[t]&&(d[e.name]=g[t])})),null!=s&&s.forEach((function(e){return d[e.name]=null})),{value:l,grads:d}}function s(e){return r.a.customGrad(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return mt})),n.d(t,"b",(function(){return ht})),n.d(t,"c",(function(){return ft})),n.d(t,"d",(function(){return It})),n.d(t,"e",(function(){return Ct}));var r=n(101),a=(n(91),n(21)),i=(n(16),n(12)),o=n(13),s=n(1),u=n(9),c=n(26),l=n(3),g=n(2),d=n.n(g),h=n(47),f=n(15),p=Object(g.createContext)({}),I=Object(g.createContext)(null);function C(e,t,n){var r=void 0===t?null:t,a=function(e,t){var n=atob(e);if(t){for(var r=new Uint8Array(n.length),a=0,i=n.length;a<i;++a)r[a]=n.charCodeAt(a);return String.fromCharCode.apply(null,new Uint16Array(r.buffer))}return n}(e,void 0!==n&&n),i=a.indexOf("\n",10)+1,o=a.substring(i)+(r?"//# sourceMappingURL="+r:""),s=new Blob([o],{type:"application/javascript"});return URL.createObjectURL(s)}var m=function(e,t,n){var r;return function(a){return r=r||C(e,t,n),new Worker(r,a)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLyoqCiAgICogUmVjb3JkcyB3aGF0IG9iamVjdHMgYXJlIGNvbGxpZGluZyB3aXRoIGVhY2ggb3RoZXIKICAgKi8KICAvKioKICAgKiBBIDN4MyBtYXRyaXguCiAgICogQXV0aG9yZWQgYnkge0BsaW5rIGh0dHA6Ly9naXRodWIuY29tL3NjaHRlcHBlLyBzY2h0ZXBwZX0KICAgKi8KCgogIGNsYXNzIE1hdDMgewogICAgLyoqCiAgICAgKiBBIHZlY3RvciBvZiBsZW5ndGggOSwgY29udGFpbmluZyBhbGwgbWF0cml4IGVsZW1lbnRzLgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gZWxlbWVudHMgQSB2ZWN0b3Igb2YgbGVuZ3RoIDksIGNvbnRhaW5pbmcgYWxsIG1hdHJpeCBlbGVtZW50cy4KICAgICAqLwogICAgY29uc3RydWN0b3IoZWxlbWVudHMgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF0pIHsKICAgICAgdGhpcy5lbGVtZW50cyA9IHZvaWQgMDsKICAgICAgdGhpcy5lbGVtZW50cyA9IGVsZW1lbnRzOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBtYXRyaXggdG8gaWRlbnRpdHkKICAgICAqIEB0b2RvIFNob3VsZCBwZXJoYXBzIGJlIHJlbmFtZWQgdG8gYHNldElkZW50aXR5KClgIHRvIGJlIG1vcmUgY2xlYXIuCiAgICAgKiBAdG9kbyBDcmVhdGUgYW5vdGhlciBmdW5jdGlvbiB0aGF0IGltbWVkaWF0ZWx5IGNyZWF0ZXMgYW4gaWRlbnRpdHkgbWF0cml4IGVnLiBgZXllKClgCiAgICAgKi8KCgogICAgaWRlbnRpdHkoKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gMTsKICAgICAgZVsxXSA9IDA7CiAgICAgIGVbMl0gPSAwOwogICAgICBlWzNdID0gMDsKICAgICAgZVs0XSA9IDE7CiAgICAgIGVbNV0gPSAwOwogICAgICBlWzZdID0gMDsKICAgICAgZVs3XSA9IDA7CiAgICAgIGVbOF0gPSAxOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYWxsIGVsZW1lbnRzIHRvIHplcm8KICAgICAqLwoKCiAgICBzZXRaZXJvKCkgewogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVswXSA9IDA7CiAgICAgIGVbMV0gPSAwOwogICAgICBlWzJdID0gMDsKICAgICAgZVszXSA9IDA7CiAgICAgIGVbNF0gPSAwOwogICAgICBlWzVdID0gMDsKICAgICAgZVs2XSA9IDA7CiAgICAgIGVbN10gPSAwOwogICAgICBlWzhdID0gMDsKICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF0cml4IGRpYWdvbmFsIGVsZW1lbnRzIGZyb20gYSBWZWMzCiAgICAgKi8KCgogICAgc2V0VHJhY2UodmVjdG9yKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICBlWzBdID0gdmVjdG9yLng7CiAgICAgIGVbNF0gPSB2ZWN0b3IueTsKICAgICAgZVs4XSA9IHZlY3Rvci56OwogICAgfQogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBtYXRyaXggZGlhZ29uYWwgZWxlbWVudHMKICAgICAqLwoKCiAgICBnZXRUcmFjZSh0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIGNvbnN0IGUgPSB0aGlzLmVsZW1lbnRzOwogICAgICB0YXJnZXQueCA9IGVbMF07CiAgICAgIHRhcmdldC55ID0gZVs0XTsKICAgICAgdGFyZ2V0LnogPSBlWzhdOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBNYXRyaXgtVmVjdG9yIG11bHRpcGxpY2F0aW9uCiAgICAgKiBAcGFyYW0gdiBUaGUgdmVjdG9yIHRvIG11bHRpcGx5IHdpdGgKICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwsIHRhcmdldCB0byBzYXZlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgdm11bHQodiwgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgY29uc3QgeCA9IHYueDsKICAgICAgY29uc3QgeSA9IHYueTsKICAgICAgY29uc3QgeiA9IHYuejsKICAgICAgdGFyZ2V0LnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7CiAgICAgIHRhcmdldC55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6OwogICAgICB0YXJnZXQueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTWF0cml4LXNjYWxhciBtdWx0aXBsaWNhdGlvbgogICAgICovCgoKICAgIHNtdWx0KHMpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSAqPSBzOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIE1hdHJpeCBtdWx0aXBsaWNhdGlvbgogICAgICogQHBhcmFtIG1hdHJpeCBNYXRyaXggdG8gbXVsdGlwbHkgd2l0aCBmcm9tIGxlZnQgc2lkZS4KICAgICAqLwoKCiAgICBtbXVsdChtYXRyaXgsIHRhcmdldCA9IG5ldyBNYXQzKCkpIHsKICAgICAgY29uc3QgQSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IEIgPSBtYXRyaXguZWxlbWVudHM7CiAgICAgIGNvbnN0IFQgPSB0YXJnZXQuZWxlbWVudHM7CiAgICAgIGNvbnN0IGExMSA9IEFbMF0sCiAgICAgICAgICAgIGExMiA9IEFbMV0sCiAgICAgICAgICAgIGExMyA9IEFbMl0sCiAgICAgICAgICAgIGEyMSA9IEFbM10sCiAgICAgICAgICAgIGEyMiA9IEFbNF0sCiAgICAgICAgICAgIGEyMyA9IEFbNV0sCiAgICAgICAgICAgIGEzMSA9IEFbNl0sCiAgICAgICAgICAgIGEzMiA9IEFbN10sCiAgICAgICAgICAgIGEzMyA9IEFbOF07CiAgICAgIGNvbnN0IGIxMSA9IEJbMF0sCiAgICAgICAgICAgIGIxMiA9IEJbMV0sCiAgICAgICAgICAgIGIxMyA9IEJbMl0sCiAgICAgICAgICAgIGIyMSA9IEJbM10sCiAgICAgICAgICAgIGIyMiA9IEJbNF0sCiAgICAgICAgICAgIGIyMyA9IEJbNV0sCiAgICAgICAgICAgIGIzMSA9IEJbNl0sCiAgICAgICAgICAgIGIzMiA9IEJbN10sCiAgICAgICAgICAgIGIzMyA9IEJbOF07CiAgICAgIFRbMF0gPSBhMTEgKiBiMTEgKyBhMTIgKiBiMjEgKyBhMTMgKiBiMzE7CiAgICAgIFRbMV0gPSBhMTEgKiBiMTIgKyBhMTIgKiBiMjIgKyBhMTMgKiBiMzI7CiAgICAgIFRbMl0gPSBhMTEgKiBiMTMgKyBhMTIgKiBiMjMgKyBhMTMgKiBiMzM7CiAgICAgIFRbM10gPSBhMjEgKiBiMTEgKyBhMjIgKiBiMjEgKyBhMjMgKiBiMzE7CiAgICAgIFRbNF0gPSBhMjEgKiBiMTIgKyBhMjIgKiBiMjIgKyBhMjMgKiBiMzI7CiAgICAgIFRbNV0gPSBhMjEgKiBiMTMgKyBhMjIgKiBiMjMgKyBhMjMgKiBiMzM7CiAgICAgIFRbNl0gPSBhMzEgKiBiMTEgKyBhMzIgKiBiMjEgKyBhMzMgKiBiMzE7CiAgICAgIFRbN10gPSBhMzEgKiBiMTIgKyBhMzIgKiBiMjIgKyBhMzMgKiBiMzI7CiAgICAgIFRbOF0gPSBhMzEgKiBiMTMgKyBhMzIgKiBiMjMgKyBhMzMgKiBiMzM7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNjYWxlIGVhY2ggY29sdW1uIG9mIHRoZSBtYXRyaXgKICAgICAqLwoKCiAgICBzY2FsZSh2ZWN0b3IsIHRhcmdldCA9IG5ldyBNYXQzKCkpIHsKICAgICAgY29uc3QgZSA9IHRoaXMuZWxlbWVudHM7CiAgICAgIGNvbnN0IHQgPSB0YXJnZXQuZWxlbWVudHM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gMzsgaSsrKSB7CiAgICAgICAgdFszICogaSArIDBdID0gdmVjdG9yLnggKiBlWzMgKiBpICsgMF07CiAgICAgICAgdFszICogaSArIDFdID0gdmVjdG9yLnkgKiBlWzMgKiBpICsgMV07CiAgICAgICAgdFszICogaSArIDJdID0gdmVjdG9yLnogKiBlWzMgKiBpICsgMl07CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNvbHZlIEF4PWIKICAgICAqIEBwYXJhbSBiIFRoZSByaWdodCBoYW5kIHNpZGUKICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwuIFRhcmdldCB2ZWN0b3IgdG8gc2F2ZSBpbi4KICAgICAqIEByZXR1cm4gVGhlIHNvbHV0aW9uIHgKICAgICAqIEB0b2RvIHNob3VsZCByZXVzZSBhcnJheXMKICAgICAqLwoKCiAgICBzb2x2ZShiLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIC8vIENvbnN0cnVjdCBlcXVhdGlvbnMKICAgICAgY29uc3QgbnIgPSAzOyAvLyBudW0gcm93cwoKICAgICAgY29uc3QgbmMgPSA0OyAvLyBudW0gY29scwoKICAgICAgY29uc3QgZXFucyA9IFtdOwogICAgICBsZXQgaTsKICAgICAgbGV0IGo7CgogICAgICBmb3IgKGkgPSAwOyBpIDwgbnIgKiBuYzsgaSsrKSB7CiAgICAgICAgZXFucy5wdXNoKDApOwogICAgICB9CgogICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgZm9yIChqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgZXFuc1tpICsgbmMgKiBqXSA9IHRoaXMuZWxlbWVudHNbaSArIDMgKiBqXTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGVxbnNbMyArIDQgKiAwXSA9IGIueDsKICAgICAgZXFuc1szICsgNCAqIDFdID0gYi55OwogICAgICBlcW5zWzMgKyA0ICogMl0gPSBiLno7IC8vIENvbXB1dGUgcmlnaHQgdXBwZXIgdHJpYW5ndWxhciB2ZXJzaW9uIG9mIHRoZSBtYXRyaXggLSBHYXVzcyBlbGltaW5hdGlvbgoKICAgICAgbGV0IG4gPSAzOwogICAgICBjb25zdCBrID0gbjsKICAgICAgbGV0IG5wOwogICAgICBjb25zdCBrcCA9IDQ7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaWduZSggaSApID0gbGlnbmUoIGkgKSArIGxpZ25lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaWduZSggayApID0gbGlnbmUoIGsgKSAtIG11bHRpcGxpZXIgKiBsaWduZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gR2V0IHRoZSBzb2x1dGlvbgoKCiAgICAgIHRhcmdldC56ID0gZXFuc1syICogbmMgKyAzXSAvIGVxbnNbMiAqIG5jICsgMl07CiAgICAgIHRhcmdldC55ID0gKGVxbnNbMSAqIG5jICsgM10gLSBlcW5zWzEgKiBuYyArIDJdICogdGFyZ2V0LnopIC8gZXFuc1sxICogbmMgKyAxXTsKICAgICAgdGFyZ2V0LnggPSAoZXFuc1swICogbmMgKyAzXSAtIGVxbnNbMCAqIG5jICsgMl0gKiB0YXJnZXQueiAtIGVxbnNbMCAqIG5jICsgMV0gKiB0YXJnZXQueSkgLyBlcW5zWzAgKiBuYyArIDBdOwoKICAgICAgaWYgKGlzTmFOKHRhcmdldC54KSB8fCBpc05hTih0YXJnZXQueSkgfHwgaXNOYU4odGFyZ2V0LnopIHx8IHRhcmdldC54ID09PSBJbmZpbml0eSB8fCB0YXJnZXQueSA9PT0gSW5maW5pdHkgfHwgdGFyZ2V0LnogPT09IEluZmluaXR5KSB7CiAgICAgICAgdGhyb3cgIkNvdWxkIG5vdCBzb2x2ZSBlcXVhdGlvbiEgR290IHg9WyIgKyB0YXJnZXQudG9TdHJpbmcoKSArICJdLCBiPVsiICsgYi50b1N0cmluZygpICsgIl0sIEE9WyIgKyB0aGlzLnRvU3RyaW5nKCkgKyAiXSI7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlbGVtZW50IGluIHRoZSBtYXRyaXggYnkgaW5kZXguIEluZGV4IHN0YXJ0cyBhdCAwLCBub3QgMSEhIQogICAgICogQHBhcmFtIHZhbHVlIElmIHByb3ZpZGVkLCB0aGUgbWF0cml4IGVsZW1lbnQgd2lsbCBiZSBzZXQgdG8gdGhpcyB2YWx1ZS4KICAgICAqLwoKCiAgICBlKHJvdywgY29sdW1uLCB2YWx1ZSkgewogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRzW2NvbHVtbiArIDMgKiByb3ddOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNldCB2YWx1ZQogICAgICAgIHRoaXMuZWxlbWVudHNbY29sdW1uICsgMyAqIHJvd10gPSB2YWx1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb3B5IGFub3RoZXIgbWF0cml4IGludG8gdGhpcyBtYXRyaXggb2JqZWN0LgogICAgICovCgoKICAgIGNvcHkobWF0cml4KSB7CiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF0cml4LmVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGhpcy5lbGVtZW50c1tpXSA9IG1hdHJpeC5lbGVtZW50c1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFJldHVybnMgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG1hdHJpeC4KICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgbGV0IHIgPSAnJzsKICAgICAgY29uc3Qgc2VwID0gJywnOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICByICs9IHRoaXMuZWxlbWVudHNbaV0gKyBzZXA7CiAgICAgIH0KCiAgICAgIHJldHVybiByOwogICAgfQogICAgLyoqCiAgICAgKiByZXZlcnNlIHRoZSBtYXRyaXgKICAgICAqIEBwYXJhbSB0YXJnZXQgVGFyZ2V0IG1hdHJpeCB0byBzYXZlIGluLgogICAgICogQHJldHVybiBUaGUgc29sdXRpb24geAogICAgICovCgoKICAgIHJldmVyc2UodGFyZ2V0ID0gbmV3IE1hdDMoKSkgewogICAgICAvLyBDb25zdHJ1Y3QgZXF1YXRpb25zCiAgICAgIGNvbnN0IG5yID0gMzsgLy8gbnVtIHJvd3MKCiAgICAgIGNvbnN0IG5jID0gNjsgLy8gbnVtIGNvbHMKCiAgICAgIGNvbnN0IGVxbnMgPSByZXZlcnNlX2VxbnM7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsKICAgICAgICBmb3IgKGogPSAwOyBqIDwgMzsgaisrKSB7CiAgICAgICAgICBlcW5zW2kgKyBuYyAqIGpdID0gdGhpcy5lbGVtZW50c1tpICsgMyAqIGpdOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZXFuc1szICsgNiAqIDBdID0gMTsKICAgICAgZXFuc1szICsgNiAqIDFdID0gMDsKICAgICAgZXFuc1szICsgNiAqIDJdID0gMDsKICAgICAgZXFuc1s0ICsgNiAqIDBdID0gMDsKICAgICAgZXFuc1s0ICsgNiAqIDFdID0gMTsKICAgICAgZXFuc1s0ICsgNiAqIDJdID0gMDsKICAgICAgZXFuc1s1ICsgNiAqIDBdID0gMDsKICAgICAgZXFuc1s1ICsgNiAqIDFdID0gMDsKICAgICAgZXFuc1s1ICsgNiAqIDJdID0gMTsgLy8gQ29tcHV0ZSByaWdodCB1cHBlciB0cmlhbmd1bGFyIHZlcnNpb24gb2YgdGhlIG1hdHJpeCAtIEdhdXNzIGVsaW1pbmF0aW9uCgogICAgICBsZXQgbiA9IDM7CiAgICAgIGNvbnN0IGsgPSBuOwogICAgICBsZXQgbnA7CiAgICAgIGNvbnN0IGtwID0gbmM7IC8vIG51bSByb3dzCgogICAgICBsZXQgcDsKCiAgICAgIGRvIHsKICAgICAgICBpID0gayAtIG47CgogICAgICAgIGlmIChlcW5zW2kgKyBuYyAqIGldID09PSAwKSB7CiAgICAgICAgICAvLyB0aGUgcGl2b3QgaXMgbnVsbCwgc3dhcCBsaW5lcwogICAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBrOyBqKyspIHsKICAgICAgICAgICAgaWYgKGVxbnNbaSArIG5jICogal0gIT09IDApIHsKICAgICAgICAgICAgICBucCA9IGtwOwoKICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAvLyBkbyBsaW5lKCBpICkgPSBsaW5lKCBpICkgKyBsaW5lKCBrICkKICAgICAgICAgICAgICAgIHAgPSBrcCAtIG5wOwogICAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBpXSArPSBlcW5zW3AgKyBuYyAqIGpdOwogICAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKGVxbnNbaSArIG5jICogaV0gIT09IDApIHsKICAgICAgICAgIGZvciAoaiA9IGkgKyAxOyBqIDwgazsgaisrKSB7CiAgICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgICAgbnAgPSBrcDsKCiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAvLyBkbyBsaW5lKCBrICkgPSBsaW5lKCBrICkgLSBtdWx0aXBsaWVyICogbGluZSggaSApCiAgICAgICAgICAgICAgcCA9IGtwIC0gbnA7CiAgICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IHAgPD0gaSA/IDAgOiBlcW5zW3AgKyBuYyAqIGpdIC0gZXFuc1twICsgbmMgKiBpXSAqIG11bHRpcGxpZXI7CiAgICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSB3aGlsZSAoLS1uKTsgLy8gZWxpbWluYXRlIHRoZSB1cHBlciBsZWZ0IHRyaWFuZ2xlIG9mIHRoZSBtYXRyaXgKCgogICAgICBpID0gMjsKCiAgICAgIGRvIHsKICAgICAgICBqID0gaSAtIDE7CgogICAgICAgIGRvIHsKICAgICAgICAgIGNvbnN0IG11bHRpcGxpZXIgPSBlcW5zW2kgKyBuYyAqIGpdIC8gZXFuc1tpICsgbmMgKiBpXTsKICAgICAgICAgIG5wID0gbmM7CgogICAgICAgICAgZG8gewogICAgICAgICAgICBwID0gbmMgLSBucDsKICAgICAgICAgICAgZXFuc1twICsgbmMgKiBqXSA9IGVxbnNbcCArIG5jICogal0gLSBlcW5zW3AgKyBuYyAqIGldICogbXVsdGlwbGllcjsKICAgICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICAgIH0gd2hpbGUgKGotLSk7CiAgICAgIH0gd2hpbGUgKC0taSk7IC8vIG9wZXJhdGlvbnMgb24gdGhlIGRpYWdvbmFsCgoKICAgICAgaSA9IDI7CgogICAgICBkbyB7CiAgICAgICAgY29uc3QgbXVsdGlwbGllciA9IDEgLyBlcW5zW2kgKyBuYyAqIGldOwogICAgICAgIG5wID0gbmM7CgogICAgICAgIGRvIHsKICAgICAgICAgIHAgPSBuYyAtIG5wOwogICAgICAgICAgZXFuc1twICsgbmMgKiBpXSA9IGVxbnNbcCArIG5jICogaV0gKiBtdWx0aXBsaWVyOwogICAgICAgIH0gd2hpbGUgKC0tbnApOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgaSA9IDI7CgogICAgICBkbyB7CiAgICAgICAgaiA9IDI7CgogICAgICAgIGRvIHsKICAgICAgICAgIHAgPSBlcW5zW25yICsgaiArIG5jICogaV07CgogICAgICAgICAgaWYgKGlzTmFOKHApIHx8IHAgPT09IEluZmluaXR5KSB7CiAgICAgICAgICAgIHRocm93ICJDb3VsZCBub3QgcmV2ZXJzZSEgQT1bIiArIHRoaXMudG9TdHJpbmcoKSArICJdIjsKICAgICAgICAgIH0KCiAgICAgICAgICB0YXJnZXQuZShpLCBqLCBwKTsKICAgICAgICB9IHdoaWxlIChqLS0pOwogICAgICB9IHdoaWxlIChpLS0pOwoKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBtYXRyaXggZnJvbSBhIHF1YXRlcmlvbgogICAgICovCgoKICAgIHNldFJvdGF0aW9uRnJvbVF1YXRlcm5pb24ocSkgewogICAgICBjb25zdCB4ID0gcS54OwogICAgICBjb25zdCB5ID0gcS55OwogICAgICBjb25zdCB6ID0gcS56OwogICAgICBjb25zdCB3ID0gcS53OwogICAgICBjb25zdCB4MiA9IHggKyB4OwogICAgICBjb25zdCB5MiA9IHkgKyB5OwogICAgICBjb25zdCB6MiA9IHogKyB6OwogICAgICBjb25zdCB4eCA9IHggKiB4MjsKICAgICAgY29uc3QgeHkgPSB4ICogeTI7CiAgICAgIGNvbnN0IHh6ID0geCAqIHoyOwogICAgICBjb25zdCB5eSA9IHkgKiB5MjsKICAgICAgY29uc3QgeXogPSB5ICogejI7CiAgICAgIGNvbnN0IHp6ID0geiAqIHoyOwogICAgICBjb25zdCB3eCA9IHcgKiB4MjsKICAgICAgY29uc3Qgd3kgPSB3ICogeTI7CiAgICAgIGNvbnN0IHd6ID0gdyAqIHoyOwogICAgICBjb25zdCBlID0gdGhpcy5lbGVtZW50czsKICAgICAgZVszICogMCArIDBdID0gMSAtICh5eSArIHp6KTsKICAgICAgZVszICogMCArIDFdID0geHkgLSB3ejsKICAgICAgZVszICogMCArIDJdID0geHogKyB3eTsKICAgICAgZVszICogMSArIDBdID0geHkgKyB3ejsKICAgICAgZVszICogMSArIDFdID0gMSAtICh4eCArIHp6KTsKICAgICAgZVszICogMSArIDJdID0geXogLSB3eDsKICAgICAgZVszICogMiArIDBdID0geHogLSB3eTsKICAgICAgZVszICogMiArIDFdID0geXogKyB3eDsKICAgICAgZVszICogMiArIDJdID0gMSAtICh4eCArIHl5KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIFRyYW5zcG9zZSB0aGUgbWF0cml4CiAgICAgKiBAcGFyYW0gdGFyZ2V0IE9wdGlvbmFsLiBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0LgogICAgICogQHJldHVybiBUaGUgdGFyZ2V0IE1hdDMsIG9yIGEgbmV3IE1hdDMgaWYgdGFyZ2V0IHdhcyBvbWl0dGVkLgogICAgICovCgoKICAgIHRyYW5zcG9zZSh0YXJnZXQgPSBuZXcgTWF0MygpKSB7CiAgICAgIGNvbnN0IE0gPSB0aGlzLmVsZW1lbnRzOwogICAgICBjb25zdCBUID0gdGFyZ2V0LmVsZW1lbnRzOwogICAgICBsZXQgdG1wOyAvL1NldCBkaWFnb25hbHMKCiAgICAgIFRbMF0gPSBNWzBdOwogICAgICBUWzRdID0gTVs0XTsKICAgICAgVFs4XSA9IE1bOF07CiAgICAgIHRtcCA9IE1bMV07CiAgICAgIFRbMV0gPSBNWzNdOwogICAgICBUWzNdID0gdG1wOwogICAgICB0bXAgPSBNWzJdOwogICAgICBUWzJdID0gTVs2XTsKICAgICAgVFs2XSA9IHRtcDsKICAgICAgdG1wID0gTVs1XTsKICAgICAgVFs1XSA9IE1bN107CiAgICAgIFRbN10gPSB0bXA7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogIH0KCiAgY29uc3QgcmV2ZXJzZV9lcW5zID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogIC8qKgogICAqIDMtZGltZW5zaW9uYWwgdmVjdG9yCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgdiA9IG5ldyBWZWMzKDEsIDIsIDMpCiAgICogICAgIGNvbnNvbGUubG9nKCd4PScgKyB2LngpIC8vIHg9MQogICAqLwoKICBjbGFzcyBWZWMzIHsKICAgIGNvbnN0cnVjdG9yKHggPSAwLjAsIHkgPSAwLjAsIHogPSAwLjApIHsKICAgICAgdGhpcy54ID0gdm9pZCAwOwogICAgICB0aGlzLnkgPSB2b2lkIDA7CiAgICAgIHRoaXMueiA9IHZvaWQgMDsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgIH0KICAgIC8qKgogICAgICogVmVjdG9yIGNyb3NzIHByb2R1Y3QKICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwgdGFyZ2V0IHRvIHNhdmUgaW4uCiAgICAgKi8KCgogICAgY3Jvc3ModmVjdG9yLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIGNvbnN0IHZ4ID0gdmVjdG9yLng7CiAgICAgIGNvbnN0IHZ5ID0gdmVjdG9yLnk7CiAgICAgIGNvbnN0IHZ6ID0gdmVjdG9yLno7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geSAqIHZ6IC0geiAqIHZ5OwogICAgICB0YXJnZXQueSA9IHogKiB2eCAtIHggKiB2ejsKICAgICAgdGFyZ2V0LnogPSB4ICogdnkgLSB5ICogdng7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgdmVjdG9ycycgMyBlbGVtZW50cwogICAgICovCgoKICAgIHNldCh4LCB5LCB6KSB7CiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMueiA9IHo7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYWxsIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB0byB6ZXJvLgogICAgICovCgoKICAgIHNldFplcm8oKSB7CiAgICAgIHRoaXMueCA9IHRoaXMueSA9IHRoaXMueiA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIFZlY3RvciBhZGRpdGlvbgogICAgICovCgoKICAgIHZhZGQodmVjdG9yLCB0YXJnZXQpIHsKICAgICAgaWYgKHRhcmdldCkgewogICAgICAgIHRhcmdldC54ID0gdmVjdG9yLnggKyB0aGlzLng7CiAgICAgICAgdGFyZ2V0LnkgPSB2ZWN0b3IueSArIHRoaXMueTsKICAgICAgICB0YXJnZXQueiA9IHZlY3Rvci56ICsgdGhpcy56OwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLnggKyB2ZWN0b3IueCwgdGhpcy55ICsgdmVjdG9yLnksIHRoaXMueiArIHZlY3Rvci56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBWZWN0b3Igc3VidHJhY3Rpb24KICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwgdGFyZ2V0IHRvIHNhdmUgaW4uCiAgICAgKi8KCgogICAgdnN1Yih2ZWN0b3IsIHRhcmdldCkgewogICAgICBpZiAodGFyZ2V0KSB7CiAgICAgICAgdGFyZ2V0LnggPSB0aGlzLnggLSB2ZWN0b3IueDsKICAgICAgICB0YXJnZXQueSA9IHRoaXMueSAtIHZlY3Rvci55OwogICAgICAgIHRhcmdldC56ID0gdGhpcy56IC0gdmVjdG9yLno7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG5ldyBWZWMzKHRoaXMueCAtIHZlY3Rvci54LCB0aGlzLnkgLSB2ZWN0b3IueSwgdGhpcy56IC0gdmVjdG9yLnopOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgY3Jvc3MgcHJvZHVjdCBtYXRyaXggYV9jcm9zcyBmcm9tIGEgdmVjdG9yLCBzdWNoIHRoYXQgYSB4IGIgPSBhX2Nyb3NzICogYiA9IGMKICAgICAqCiAgICAgKiBTZWUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyL1REQkQyNC9WVDA2L2xlY3R1cmVzL0xlY3R1cmU2LnBkZiBVbWXDpSBVbml2ZXJzaXR5IExlY3R1cmV9CiAgICAgKi8KCgogICAgY3Jvc3NtYXQoKSB7CiAgICAgIHJldHVybiBuZXcgTWF0MyhbMCwgLXRoaXMueiwgdGhpcy55LCB0aGlzLnosIDAsIC10aGlzLngsIC10aGlzLnksIHRoaXMueCwgMF0pOwogICAgfQogICAgLyoqCiAgICAgKiBOb3JtYWxpemUgdGhlIHZlY3Rvci4gTm90ZSB0aGF0IHRoaXMgY2hhbmdlcyB0aGUgdmFsdWVzIGluIHRoZSB2ZWN0b3IuCiAgICAgICogQHJldHVybiBSZXR1cm5zIHRoZSBub3JtIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBub3JtYWxpemUoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IG4gPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuID4gMC4wKSB7CiAgICAgICAgY29uc3QgaW52TiA9IDEgLyBuOwogICAgICAgIHRoaXMueCAqPSBpbnZOOwogICAgICAgIHRoaXMueSAqPSBpbnZOOwogICAgICAgIHRoaXMueiAqPSBpbnZOOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIE1ha2Ugc29tZXRoaW5nIHVwCiAgICAgICAgdGhpcy54ID0gMDsKICAgICAgICB0aGlzLnkgPSAwOwogICAgICAgIHRoaXMueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiBuOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHZlcnNpb24gb2YgdGhpcyB2ZWN0b3IgdGhhdCBpcyBvZiBsZW5ndGggMS4KICAgICAqIEBwYXJhbSB0YXJnZXQgT3B0aW9uYWwgdGFyZ2V0IHRvIHNhdmUgaW4KICAgICAqIEByZXR1cm4gUmV0dXJucyB0aGUgdW5pdCB2ZWN0b3IKICAgICAqLwoKCiAgICB1bml0KHRhcmdldCA9IG5ldyBWZWMzKCkpIHsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgbGV0IG5pbnYgPSBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKCiAgICAgIGlmIChuaW52ID4gMC4wKSB7CiAgICAgICAgbmludiA9IDEuMCAvIG5pbnY7CiAgICAgICAgdGFyZ2V0LnggPSB4ICogbmludjsKICAgICAgICB0YXJnZXQueSA9IHkgKiBuaW52OwogICAgICAgIHRhcmdldC56ID0geiAqIG5pbnY7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGFyZ2V0LnggPSAxOwogICAgICAgIHRhcmdldC55ID0gMDsKICAgICAgICB0YXJnZXQueiA9IDA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgbGVuZ3RoIG9mIHRoZSB2ZWN0b3IKICAgICAqLwoKCiAgICBsZW5ndGgoKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoeCAqIHggKyB5ICogeSArIHogKiB6KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBzcXVhcmVkIGxlbmd0aCBvZiB0aGUgdmVjdG9yLgogICAgICovCgoKICAgIGxlbmd0aFNxdWFyZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmRvdCh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGRpc3RhbmNlIGZyb20gdGhpcyBwb2ludCB0byBhbm90aGVyIHBvaW50CiAgICAgKi8KCgogICAgZGlzdGFuY2VUbyhwKSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIGNvbnN0IHB4ID0gcC54OwogICAgICBjb25zdCBweSA9IHAueTsKICAgICAgY29uc3QgcHogPSBwLno7CiAgICAgIHJldHVybiBNYXRoLnNxcnQoKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHNxdWFyZWQgZGlzdGFuY2UgZnJvbSB0aGlzIHBvaW50IHRvIGFub3RoZXIgcG9pbnQKICAgICAqLwoKCiAgICBkaXN0YW5jZVNxdWFyZWQocCkgewogICAgICBjb25zdCB4ID0gdGhpcy54OwogICAgICBjb25zdCB5ID0gdGhpcy55OwogICAgICBjb25zdCB6ID0gdGhpcy56OwogICAgICBjb25zdCBweCA9IHAueDsKICAgICAgY29uc3QgcHkgPSBwLnk7CiAgICAgIGNvbnN0IHB6ID0gcC56OwogICAgICByZXR1cm4gKHB4IC0geCkgKiAocHggLSB4KSArIChweSAtIHkpICogKHB5IC0geSkgKyAocHogLSB6KSAqIChweiAtIHopOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSBhbGwgdGhlIGNvbXBvbmVudHMgb2YgdGhlIHZlY3RvciB3aXRoIGEgc2NhbGFyLgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdmVjdG9yIHRvIHNhdmUgdGhlIHJlc3VsdCBpbi4KICAgICAqLwoKCiAgICBzY2FsZShzY2FsYXIsIHRhcmdldCA9IG5ldyBWZWMzKCkpIHsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgdGFyZ2V0LnggPSBzY2FsYXIgKiB4OwogICAgICB0YXJnZXQueSA9IHNjYWxhciAqIHk7CiAgICAgIHRhcmdldC56ID0gc2NhbGFyICogejsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgdGhlIHZlY3RvciB3aXRoIGFuIG90aGVyIHZlY3RvciwgY29tcG9uZW50LXdpc2UuCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB2ZWN0b3IgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIHZtdWwodmVjdG9yLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRhcmdldC54ID0gdmVjdG9yLnggKiB0aGlzLng7CiAgICAgIHRhcmdldC55ID0gdmVjdG9yLnkgKiB0aGlzLnk7CiAgICAgIHRhcmdldC56ID0gdmVjdG9yLnogKiB0aGlzLno7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIFNjYWxlIGEgdmVjdG9yIGFuZCBhZGQgaXQgdG8gdGhpcyB2ZWN0b3IuIFNhdmUgdGhlIHJlc3VsdCBpbiAidGFyZ2V0Ii4gKHRhcmdldCA9IHRoaXMgKyB2ZWN0b3IgKiBzY2FsYXIpCiAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB2ZWN0b3IgdG8gc2F2ZSB0aGUgcmVzdWx0IGluLgogICAgICovCgoKICAgIGFkZFNjYWxlZFZlY3RvcihzY2FsYXIsIHZlY3RvciwgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICB0YXJnZXQueCA9IHRoaXMueCArIHNjYWxhciAqIHZlY3Rvci54OwogICAgICB0YXJnZXQueSA9IHRoaXMueSArIHNjYWxhciAqIHZlY3Rvci55OwogICAgICB0YXJnZXQueiA9IHRoaXMueiArIHNjYWxhciAqIHZlY3Rvci56OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBDYWxjdWxhdGUgZG90IHByb2R1Y3QKICAgICAqIEBwYXJhbSB2ZWN0b3IKICAgICAqLwoKCiAgICBkb3QodmVjdG9yKSB7CiAgICAgIHJldHVybiB0aGlzLnggKiB2ZWN0b3IueCArIHRoaXMueSAqIHZlY3Rvci55ICsgdGhpcy56ICogdmVjdG9yLno7CiAgICB9CgogICAgaXNaZXJvKCkgewogICAgICByZXR1cm4gdGhpcy54ID09PSAwICYmIHRoaXMueSA9PT0gMCAmJiB0aGlzLnogPT09IDA7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgdGhlIHZlY3RvciBwb2ludCBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uLgogICAgICogQHBhcmFtIHRhcmdldCBPcHRpb25hbCB0YXJnZXQgdG8gc2F2ZSBpbgogICAgICovCgoKICAgIG5lZ2F0ZSh0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRhcmdldC54ID0gLXRoaXMueDsKICAgICAgdGFyZ2V0LnkgPSAtdGhpcy55OwogICAgICB0YXJnZXQueiA9IC10aGlzLno7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdHdvIGFydGlmaWNpYWwgdGFuZ2VudHMgdG8gdGhlIHZlY3RvcgogICAgICogQHBhcmFtIHQxIFZlY3RvciBvYmplY3QgdG8gc2F2ZSB0aGUgZmlyc3QgdGFuZ2VudCBpbgogICAgICogQHBhcmFtIHQyIFZlY3RvciBvYmplY3QgdG8gc2F2ZSB0aGUgc2Vjb25kIHRhbmdlbnQgaW4KICAgICAqLwoKCiAgICB0YW5nZW50cyh0MSwgdDIpIHsKICAgICAgY29uc3Qgbm9ybSA9IHRoaXMubGVuZ3RoKCk7CgogICAgICBpZiAobm9ybSA+IDAuMCkgewogICAgICAgIGNvbnN0IG4gPSBWZWMzX3RhbmdlbnRzX247CiAgICAgICAgY29uc3QgaW5vcm0gPSAxIC8gbm9ybTsKICAgICAgICBuLnNldCh0aGlzLnggKiBpbm9ybSwgdGhpcy55ICogaW5vcm0sIHRoaXMueiAqIGlub3JtKTsKICAgICAgICBjb25zdCByYW5kVmVjID0gVmVjM190YW5nZW50c19yYW5kVmVjOwoKICAgICAgICBpZiAoTWF0aC5hYnMobi54KSA8IDAuOSkgewogICAgICAgICAgcmFuZFZlYy5zZXQoMSwgMCwgMCk7CiAgICAgICAgICBuLmNyb3NzKHJhbmRWZWMsIHQxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmFuZFZlYy5zZXQoMCwgMSwgMCk7CiAgICAgICAgICBuLmNyb3NzKHJhbmRWZWMsIHQxKTsKICAgICAgICB9CgogICAgICAgIG4uY3Jvc3ModDEsIHQyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUaGUgbm9ybWFsIGxlbmd0aCBpcyB6ZXJvLCBtYWtlIHNvbWV0aGluZyB1cAogICAgICAgIHQxLnNldCgxLCAwLCAwKTsKICAgICAgICB0Mi5zZXQoMCwgMSwgMCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29udmVydHMgdG8gYSBtb3JlIHJlYWRhYmxlIGZvcm1hdAogICAgICovCgoKICAgIHRvU3RyaW5nKCkgewogICAgICByZXR1cm4gdGhpcy54ICsgIiwiICsgdGhpcy55ICsgIiwiICsgdGhpcy56OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0cyB0byBhbiBhcnJheQogICAgICovCgoKICAgIHRvQXJyYXkoKSB7CiAgICAgIHJldHVybiBbdGhpcy54LCB0aGlzLnksIHRoaXMuel07CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyB2ZWN0b3IuCiAgICAgKi8KCgogICAgY29weSh2ZWN0b3IpIHsKICAgICAgdGhpcy54ID0gdmVjdG9yLng7CiAgICAgIHRoaXMueSA9IHZlY3Rvci55OwogICAgICB0aGlzLnogPSB2ZWN0b3IuejsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIERvIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0d28gdmVjdG9ycwogICAgICogQHBhcmFtIHQgQSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLiAwIHdpbGwgbWFrZSB0aGlzIGZ1bmN0aW9uIHJldHVybiB1LCBhbmQgMSB3aWxsIG1ha2UgaXQgcmV0dXJuIHYuIE51bWJlcnMgaW4gYmV0d2VlbiB3aWxsIGdlbmVyYXRlIGEgdmVjdG9yIGluIGJldHdlZW4gdGhlbS4KICAgICAqLwoKCiAgICBsZXJwKHZlY3RvciwgdCwgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IHggPSB0aGlzLng7CiAgICAgIGNvbnN0IHkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHogPSB0aGlzLno7CiAgICAgIHRhcmdldC54ID0geCArICh2ZWN0b3IueCAtIHgpICogdDsKICAgICAgdGFyZ2V0LnkgPSB5ICsgKHZlY3Rvci55IC0geSkgKiB0OwogICAgICB0YXJnZXQueiA9IHogKyAodmVjdG9yLnogLSB6KSAqIHQ7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgdmVjdG9yIGVxdWFscyBpcyBhbG1vc3QgZXF1YWwgdG8gYW5vdGhlciBvbmUuCiAgICAgKi8KCgogICAgYWxtb3N0RXF1YWxzKHZlY3RvciwgcHJlY2lzaW9uID0gMWUtNikgewogICAgICBpZiAoTWF0aC5hYnModGhpcy54IC0gdmVjdG9yLngpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueSAtIHZlY3Rvci55KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnogLSB2ZWN0b3IueikgPiBwcmVjaXNpb24pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhIHZlY3RvciBpcyBhbG1vc3QgemVybwogICAgICovCgoKICAgIGFsbW9zdFplcm8ocHJlY2lzaW9uID0gMWUtNikgewogICAgICBpZiAoTWF0aC5hYnModGhpcy54KSA+IHByZWNpc2lvbiB8fCBNYXRoLmFicyh0aGlzLnkpID4gcHJlY2lzaW9uIHx8IE1hdGguYWJzKHRoaXMueikgPiBwcmVjaXNpb24pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgdmVjdG9yIGlzIGFudGktcGFyYWxsZWwgdG8gYW5vdGhlciB2ZWN0b3IuCiAgICAgKiBAcGFyYW0gcHJlY2lzaW9uIFNldCB0byB6ZXJvIGZvciBleGFjdCBjb21wYXJpc29ucwogICAgICovCgoKICAgIGlzQW50aXBhcmFsbGVsVG8odmVjdG9yLCBwcmVjaXNpb24pIHsKICAgICAgdGhpcy5uZWdhdGUoYW50aXBfbmVnKTsKICAgICAgcmV0dXJuIGFudGlwX25lZy5hbG1vc3RFcXVhbHModmVjdG9yLCBwcmVjaXNpb24pOwogICAgfQogICAgLyoqCiAgICAgKiBDbG9uZSB0aGUgdmVjdG9yCiAgICAgKi8KCgogICAgY2xvbmUoKSB7CiAgICAgIHJldHVybiBuZXcgVmVjMyh0aGlzLngsIHRoaXMueSwgdGhpcy56KTsKICAgIH0KCiAgfQoKICBWZWMzLlpFUk8gPSB2b2lkIDA7CiAgVmVjMy5VTklUX1ggPSB2b2lkIDA7CiAgVmVjMy5VTklUX1kgPSB2b2lkIDA7CiAgVmVjMy5VTklUX1ogPSB2b2lkIDA7CiAgVmVjMy5aRVJPID0gbmV3IFZlYzMoMCwgMCwgMCk7CiAgVmVjMy5VTklUX1ggPSBuZXcgVmVjMygxLCAwLCAwKTsKICBWZWMzLlVOSVRfWSA9IG5ldyBWZWMzKDAsIDEsIDApOwogIFZlYzMuVU5JVF9aID0gbmV3IFZlYzMoMCwgMCwgMSk7CiAgY29uc3QgVmVjM190YW5nZW50c19uID0gbmV3IFZlYzMoKTsKICBjb25zdCBWZWMzX3RhbmdlbnRzX3JhbmRWZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFudGlwX25lZyA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQXhpcyBhbGlnbmVkIGJvdW5kaW5nIGJveCBjbGFzcy4KICAgKi8KCiAgY2xhc3MgQUFCQiB7CiAgICAvKioKICAgICAqIFRoZSBsb3dlciBib3VuZCBvZiB0aGUgYm91bmRpbmcgYm94CiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB1cHBlciBib3VuZCBvZiB0aGUgYm91bmRpbmcgYm94CiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkgewogICAgICB0aGlzLmxvd2VyQm91bmQgPSB2b2lkIDA7CiAgICAgIHRoaXMudXBwZXJCb3VuZCA9IHZvaWQgMDsKICAgICAgdGhpcy5sb3dlckJvdW5kID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy51cHBlckJvdW5kID0gbmV3IFZlYzMoKTsKCiAgICAgIGlmIChvcHRpb25zLmxvd2VyQm91bmQpIHsKICAgICAgICB0aGlzLmxvd2VyQm91bmQuY29weShvcHRpb25zLmxvd2VyQm91bmQpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy51cHBlckJvdW5kKSB7CiAgICAgICAgdGhpcy51cHBlckJvdW5kLmNvcHkob3B0aW9ucy51cHBlckJvdW5kKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIEFBQkIgYm91bmRzIGZyb20gYSBzZXQgb2YgcG9pbnRzLgogICAgICogQHBhcmFtIHBvaW50cyBBbiBhcnJheSBvZiBWZWMzJ3MuCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdAogICAgICovCgoKICAgIHNldEZyb21Qb2ludHMocG9pbnRzLCBwb3NpdGlvbiwgcXVhdGVybmlvbiwgc2tpblNpemUpIHsKICAgICAgY29uc3QgbCA9IHRoaXMubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHRoaXMudXBwZXJCb3VuZDsKICAgICAgY29uc3QgcSA9IHF1YXRlcm5pb247IC8vIFNldCB0byB0aGUgZmlyc3QgcG9pbnQKCiAgICAgIGwuY29weShwb2ludHNbMF0pOwoKICAgICAgaWYgKHEpIHsKICAgICAgICBxLnZtdWx0KGwsIGwpOwogICAgICB9CgogICAgICB1LmNvcHkobCk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBwID0gcG9pbnRzW2ldOwoKICAgICAgICBpZiAocSkgewogICAgICAgICAgcS52bXVsdChwLCB0bXAkMSk7CiAgICAgICAgICBwID0gdG1wJDE7CiAgICAgICAgfQoKICAgICAgICBpZiAocC54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSBwLng7CiAgICAgICAgfQoKICAgICAgICBpZiAocC54IDwgbC54KSB7CiAgICAgICAgICBsLnggPSBwLng7CiAgICAgICAgfQoKICAgICAgICBpZiAocC55ID4gdS55KSB7CiAgICAgICAgICB1LnkgPSBwLnk7CiAgICAgICAgfQoKICAgICAgICBpZiAocC55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSBwLnk7CiAgICAgICAgfQoKICAgICAgICBpZiAocC56ID4gdS56KSB7CiAgICAgICAgICB1LnogPSBwLno7CiAgICAgICAgfQoKICAgICAgICBpZiAocC56IDwgbC56KSB7CiAgICAgICAgICBsLnogPSBwLno7CiAgICAgICAgfQogICAgICB9IC8vIEFkZCBvZmZzZXQKCgogICAgICBpZiAocG9zaXRpb24pIHsKICAgICAgICBwb3NpdGlvbi52YWRkKGwsIGwpOwogICAgICAgIHBvc2l0aW9uLnZhZGQodSwgdSk7CiAgICAgIH0KCiAgICAgIGlmIChza2luU2l6ZSkgewogICAgICAgIGwueCAtPSBza2luU2l6ZTsKICAgICAgICBsLnkgLT0gc2tpblNpemU7CiAgICAgICAgbC56IC09IHNraW5TaXplOwogICAgICAgIHUueCArPSBza2luU2l6ZTsKICAgICAgICB1LnkgKz0gc2tpblNpemU7CiAgICAgICAgdS56ICs9IHNraW5TaXplOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ29weSBib3VuZHMgZnJvbSBhbiBBQUJCIHRvIHRoaXMgQUFCQgogICAgICogQHBhcmFtIGFhYmIgU291cmNlIHRvIGNvcHkgZnJvbQogICAgICogQHJldHVybiBUaGUgdGhpcyBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkKICAgICAqLwoKCiAgICBjb3B5KGFhYmIpIHsKICAgICAgdGhpcy5sb3dlckJvdW5kLmNvcHkoYWFiYi5sb3dlckJvdW5kKTsKICAgICAgdGhpcy51cHBlckJvdW5kLmNvcHkoYWFiYi51cHBlckJvdW5kKTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENsb25lIGFuIEFBQkIKICAgICAqLwoKCiAgICBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyBBQUJCKCkuY29weSh0aGlzKTsKICAgIH0KICAgIC8qKgogICAgICogRXh0ZW5kIHRoaXMgQUFCQiBzbyB0aGF0IGl0IGNvdmVycyB0aGUgZ2l2ZW4gQUFCQiB0b28uCiAgICAgKi8KCgogICAgZXh0ZW5kKGFhYmIpIHsKICAgICAgdGhpcy5sb3dlckJvdW5kLnggPSBNYXRoLm1pbih0aGlzLmxvd2VyQm91bmQueCwgYWFiYi5sb3dlckJvdW5kLngpOwogICAgICB0aGlzLnVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRoaXMudXBwZXJCb3VuZC54LCBhYWJiLnVwcGVyQm91bmQueCk7CiAgICAgIHRoaXMubG93ZXJCb3VuZC55ID0gTWF0aC5taW4odGhpcy5sb3dlckJvdW5kLnksIGFhYmIubG93ZXJCb3VuZC55KTsKICAgICAgdGhpcy51cHBlckJvdW5kLnkgPSBNYXRoLm1heCh0aGlzLnVwcGVyQm91bmQueSwgYWFiYi51cHBlckJvdW5kLnkpOwogICAgICB0aGlzLmxvd2VyQm91bmQueiA9IE1hdGgubWluKHRoaXMubG93ZXJCb3VuZC56LCBhYWJiLmxvd2VyQm91bmQueik7CiAgICAgIHRoaXMudXBwZXJCb3VuZC56ID0gTWF0aC5tYXgodGhpcy51cHBlckJvdW5kLnosIGFhYmIudXBwZXJCb3VuZC56KTsKICAgIH0KICAgIC8qKgogICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBBQUJCIG92ZXJsYXBzIHRoaXMgQUFCQi4KICAgICAqLwoKCiAgICBvdmVybGFwcyhhYWJiKSB7CiAgICAgIGNvbnN0IGwxID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1MSA9IHRoaXMudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbDIgPSBhYWJiLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUyID0gYWFiYi51cHBlckJvdW5kOyAvLyAgICAgIGwyICAgICAgICB1MgogICAgICAvLyAgICAgIHwtLS0tLS0tLS18CiAgICAgIC8vIHwtLS0tLS0tLXwKICAgICAgLy8gbDEgICAgICAgdTEKCiAgICAgIGNvbnN0IG92ZXJsYXBzWCA9IGwyLnggPD0gdTEueCAmJiB1MS54IDw9IHUyLnggfHwgbDEueCA8PSB1Mi54ICYmIHUyLnggPD0gdTEueDsKICAgICAgY29uc3Qgb3ZlcmxhcHNZID0gbDIueSA8PSB1MS55ICYmIHUxLnkgPD0gdTIueSB8fCBsMS55IDw9IHUyLnkgJiYgdTIueSA8PSB1MS55OwogICAgICBjb25zdCBvdmVybGFwc1ogPSBsMi56IDw9IHUxLnogJiYgdTEueiA8PSB1Mi56IHx8IGwxLnogPD0gdTIueiAmJiB1Mi56IDw9IHUxLno7CiAgICAgIHJldHVybiBvdmVybGFwc1ggJiYgb3ZlcmxhcHNZICYmIG92ZXJsYXBzWjsKICAgIH0gLy8gTW9zdGx5IGZvciBkZWJ1Z2dpbmcKCgogICAgdm9sdW1lKCkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICByZXR1cm4gKHUueCAtIGwueCkgKiAodS55IC0gbC55KSAqICh1LnogLSBsLnopOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIEFBQkIgaXMgZnVsbHkgY29udGFpbmVkIGluIHRoaXMgQUFCQi4KICAgICAqLwoKCiAgICBjb250YWlucyhhYWJiKSB7CiAgICAgIGNvbnN0IGwxID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1MSA9IHRoaXMudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbDIgPSBhYWJiLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUyID0gYWFiYi51cHBlckJvdW5kOyAvLyAgICAgIGwyICAgICAgICB1MgogICAgICAvLyAgICAgIHwtLS0tLS0tLS18CiAgICAgIC8vIHwtLS0tLS0tLS0tLS0tLS18CiAgICAgIC8vIGwxICAgICAgICAgICAgICB1MQoKICAgICAgcmV0dXJuIGwxLnggPD0gbDIueCAmJiB1MS54ID49IHUyLnggJiYgbDEueSA8PSBsMi55ICYmIHUxLnkgPj0gdTIueSAmJiBsMS56IDw9IGwyLnogJiYgdTEueiA+PSB1Mi56OwogICAgfQoKICAgIGdldENvcm5lcnMoYSwgYiwgYywgZCwgZSwgZiwgZywgaCkgewogICAgICBjb25zdCBsID0gdGhpcy5sb3dlckJvdW5kOwogICAgICBjb25zdCB1ID0gdGhpcy51cHBlckJvdW5kOwogICAgICBhLmNvcHkobCk7CiAgICAgIGIuc2V0KHUueCwgbC55LCBsLnopOwogICAgICBjLnNldCh1LngsIHUueSwgbC56KTsKICAgICAgZC5zZXQobC54LCB1LnksIHUueik7CiAgICAgIGUuc2V0KHUueCwgbC55LCB1LnopOwogICAgICBmLnNldChsLngsIHUueSwgbC56KTsKICAgICAgZy5zZXQobC54LCBsLnksIHUueik7CiAgICAgIGguY29weSh1KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSByZXByZXNlbnRhdGlvbiBvZiBhbiBBQUJCIGluIGFub3RoZXIgZnJhbWUuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiBBQUJCIG9iamVjdC4KICAgICAqLwoKCiAgICB0b0xvY2FsRnJhbWUoZnJhbWUsIHRhcmdldCkgewogICAgICBjb25zdCBjb3JuZXJzID0gdHJhbnNmb3JtSW50b0ZyYW1lX2Nvcm5lcnM7CiAgICAgIGNvbnN0IGEgPSBjb3JuZXJzWzBdOwogICAgICBjb25zdCBiID0gY29ybmVyc1sxXTsKICAgICAgY29uc3QgYyA9IGNvcm5lcnNbMl07CiAgICAgIGNvbnN0IGQgPSBjb3JuZXJzWzNdOwogICAgICBjb25zdCBlID0gY29ybmVyc1s0XTsKICAgICAgY29uc3QgZiA9IGNvcm5lcnNbNV07CiAgICAgIGNvbnN0IGcgPSBjb3JuZXJzWzZdOwogICAgICBjb25zdCBoID0gY29ybmVyc1s3XTsgLy8gR2V0IGNvcm5lcnMgaW4gY3VycmVudCBmcmFtZQoKICAgICAgdGhpcy5nZXRDb3JuZXJzKGEsIGIsIGMsIGQsIGUsIGYsIGcsIGgpOyAvLyBUcmFuc2Zvcm0gdGhlbSB0byBuZXcgbG9jYWwgZnJhbWUKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSA4OyBpKyspIHsKICAgICAgICBjb25zdCBjb3JuZXIgPSBjb3JuZXJzW2ldOwogICAgICAgIGZyYW1lLnBvaW50VG9Mb2NhbChjb3JuZXIsIGNvcm5lcik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQuc2V0RnJvbVBvaW50cyhjb3JuZXJzKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSByZXByZXNlbnRhdGlvbiBvZiBhbiBBQUJCIGluIHRoZSBnbG9iYWwgZnJhbWUuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiBBQUJCIG9iamVjdC4KICAgICAqLwoKCiAgICB0b1dvcmxkRnJhbWUoZnJhbWUsIHRhcmdldCkgewogICAgICBjb25zdCBjb3JuZXJzID0gdHJhbnNmb3JtSW50b0ZyYW1lX2Nvcm5lcnM7CiAgICAgIGNvbnN0IGEgPSBjb3JuZXJzWzBdOwogICAgICBjb25zdCBiID0gY29ybmVyc1sxXTsKICAgICAgY29uc3QgYyA9IGNvcm5lcnNbMl07CiAgICAgIGNvbnN0IGQgPSBjb3JuZXJzWzNdOwogICAgICBjb25zdCBlID0gY29ybmVyc1s0XTsKICAgICAgY29uc3QgZiA9IGNvcm5lcnNbNV07CiAgICAgIGNvbnN0IGcgPSBjb3JuZXJzWzZdOwogICAgICBjb25zdCBoID0gY29ybmVyc1s3XTsgLy8gR2V0IGNvcm5lcnMgaW4gY3VycmVudCBmcmFtZQoKICAgICAgdGhpcy5nZXRDb3JuZXJzKGEsIGIsIGMsIGQsIGUsIGYsIGcsIGgpOyAvLyBUcmFuc2Zvcm0gdGhlbSB0byBuZXcgbG9jYWwgZnJhbWUKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSA4OyBpKyspIHsKICAgICAgICBjb25zdCBjb3JuZXIgPSBjb3JuZXJzW2ldOwogICAgICAgIGZyYW1lLnBvaW50VG9Xb3JsZChjb3JuZXIsIGNvcm5lcik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0YXJnZXQuc2V0RnJvbVBvaW50cyhjb3JuZXJzKTsKICAgIH0KICAgIC8qKgogICAgICogQ2hlY2sgaWYgdGhlIEFBQkIgaXMgaGl0IGJ5IGEgcmF5LgogICAgICovCgoKICAgIG92ZXJsYXBzUmF5KHJheSkgewogICAgICBjb25zdCB7CiAgICAgICAgZGlyZWN0aW9uLAogICAgICAgIGZyb20KICAgICAgfSA9IHJheTsgLy8gY29uc3QgdCA9IDAKICAgICAgLy8gcmF5LmRpcmVjdGlvbiBpcyB1bml0IGRpcmVjdGlvbiB2ZWN0b3Igb2YgcmF5CgogICAgICBjb25zdCBkaXJGcmFjWCA9IDEgLyBkaXJlY3Rpb24ueDsKICAgICAgY29uc3QgZGlyRnJhY1kgPSAxIC8gZGlyZWN0aW9uLnk7CiAgICAgIGNvbnN0IGRpckZyYWNaID0gMSAvIGRpcmVjdGlvbi56OyAvLyB0aGlzLmxvd2VyQm91bmQgaXMgdGhlIGNvcm5lciBvZiBBQUJCIHdpdGggbWluaW1hbCBjb29yZGluYXRlcyAtIGxlZnQgYm90dG9tLCBydCBpcyBtYXhpbWFsIGNvcm5lcgoKICAgICAgY29uc3QgdDEgPSAodGhpcy5sb3dlckJvdW5kLnggLSBmcm9tLngpICogZGlyRnJhY1g7CiAgICAgIGNvbnN0IHQyID0gKHRoaXMudXBwZXJCb3VuZC54IC0gZnJvbS54KSAqIGRpckZyYWNYOwogICAgICBjb25zdCB0MyA9ICh0aGlzLmxvd2VyQm91bmQueSAtIGZyb20ueSkgKiBkaXJGcmFjWTsKICAgICAgY29uc3QgdDQgPSAodGhpcy51cHBlckJvdW5kLnkgLSBmcm9tLnkpICogZGlyRnJhY1k7CiAgICAgIGNvbnN0IHQ1ID0gKHRoaXMubG93ZXJCb3VuZC56IC0gZnJvbS56KSAqIGRpckZyYWNaOwogICAgICBjb25zdCB0NiA9ICh0aGlzLnVwcGVyQm91bmQueiAtIGZyb20ueikgKiBkaXJGcmFjWjsgLy8gY29uc3QgdG1pbiA9IE1hdGgubWF4KE1hdGgubWF4KE1hdGgubWluKHQxLCB0MiksIE1hdGgubWluKHQzLCB0NCkpKTsKICAgICAgLy8gY29uc3QgdG1heCA9IE1hdGgubWluKE1hdGgubWluKE1hdGgubWF4KHQxLCB0MiksIE1hdGgubWF4KHQzLCB0NCkpKTsKCiAgICAgIGNvbnN0IHRtaW4gPSBNYXRoLm1heChNYXRoLm1heChNYXRoLm1pbih0MSwgdDIpLCBNYXRoLm1pbih0MywgdDQpKSwgTWF0aC5taW4odDUsIHQ2KSk7CiAgICAgIGNvbnN0IHRtYXggPSBNYXRoLm1pbihNYXRoLm1pbihNYXRoLm1heCh0MSwgdDIpLCBNYXRoLm1heCh0MywgdDQpKSwgTWF0aC5tYXgodDUsIHQ2KSk7IC8vIGlmIHRtYXggPCAwLCByYXkgKGxpbmUpIGlzIGludGVyc2VjdGluZyBBQUJCLCBidXQgd2hvbGUgQUFCQiBpcyBiZWhpbmcgdXMKCiAgICAgIGlmICh0bWF4IDwgMCkgewogICAgICAgIC8vdCA9IHRtYXg7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIGlmIHRtaW4gPiB0bWF4LCByYXkgZG9lc24ndCBpbnRlcnNlY3QgQUFCQgoKCiAgICAgIGlmICh0bWluID4gdG1heCkgewogICAgICAgIC8vdCA9IHRtYXg7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgfQoKICBjb25zdCB0bXAkMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdHJhbnNmb3JtSW50b0ZyYW1lX2Nvcm5lcnMgPSBbbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKSwgbmV3IFZlYzMoKV07CiAgLyoqCiAgICogQ29sbGlzaW9uICJtYXRyaXgiLgogICAqIEl0J3MgYWN0dWFsbHkgYSB0cmlhbmd1bGFyLXNoYXBlZCBhcnJheSBvZiB3aGV0aGVyIHR3byBib2RpZXMgYXJlIHRvdWNoaW5nIHRoaXMgc3RlcCwgZm9yIHJlZmVyZW5jZSBuZXh0IHN0ZXAKICAgKi8KCiAgY2xhc3MgQXJyYXlDb2xsaXNpb25NYXRyaXggewogICAgLyoqCiAgICAgKiBUaGUgbWF0cml4IHN0b3JhZ2UuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLm1hdHJpeCA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRyaXggPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFuIGVsZW1lbnQKICAgICAqLwoKCiAgICBnZXQoYmksIGJqKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5tYXRyaXhbKGkgKiAoaSArIDEpID4+IDEpICsgaiAtIDFdOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgYW4gZWxlbWVudAogICAgICovCgoKICAgIHNldChiaSwgYmosIHZhbHVlKSB7CiAgICAgIGxldCB7CiAgICAgICAgaW5kZXg6IGkKICAgICAgfSA9IGJpOwogICAgICBsZXQgewogICAgICAgIGluZGV4OiBqCiAgICAgIH0gPSBiajsKCiAgICAgIGlmIChqID4gaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICB0aGlzLm1hdHJpeFsoaSAqIChpICsgMSkgPj4gMSkgKyBqIC0gMV0gPSB2YWx1ZSA/IDEgOiAwOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBlbGVtZW50cyB0byB6ZXJvCiAgICAgKi8KCgogICAgcmVzZXQoKSB7CiAgICAgIGZvciAobGV0IGkgPSAwLCBsID0gdGhpcy5tYXRyaXgubGVuZ3RoOyBpICE9PSBsOyBpKyspIHsKICAgICAgICB0aGlzLm1hdHJpeFtpXSA9IDA7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0cyB0aGUgbWF4IG51bWJlciBvZiBvYmplY3RzCiAgICAgKi8KCgogICAgc2V0TnVtT2JqZWN0cyhuKSB7CiAgICAgIHRoaXMubWF0cml4Lmxlbmd0aCA9IG4gKiAobiAtIDEpID4+IDE7CiAgICB9CgogIH0KICAvKioKICAgKiBCYXNlIGNsYXNzIGZvciBvYmplY3RzIHRoYXQgZGlzcGF0Y2hlcyBldmVudHMuCiAgICovCgoKICBjbGFzcyBFdmVudFRhcmdldCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5fbGlzdGVuZXJzID0gdm9pZCAwOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYW4gZXZlbnQgbGlzdGVuZXIKICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0ge307CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIGxpc3RlbmVyc1t0eXBlXSA9IFtdOwogICAgICB9CgogICAgICBpZiAoIWxpc3RlbmVyc1t0eXBlXS5pbmNsdWRlcyhsaXN0ZW5lcikpIHsKICAgICAgICBsaXN0ZW5lcnNbdHlwZV0ucHVzaChsaXN0ZW5lcik7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiBhbiBldmVudCBsaXN0ZW5lciBpcyBhZGRlZAogICAgICovCgoKICAgIGhhc0V2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CgogICAgICBpZiAobGlzdGVuZXJzW3R5cGVdICE9PSB1bmRlZmluZWQgJiYgbGlzdGVuZXJzW3R5cGVdLmluY2x1ZGVzKGxpc3RlbmVyKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGFueSBldmVudCBsaXN0ZW5lciBvZiB0aGUgZ2l2ZW4gdHlwZSBpcyBhZGRlZAogICAgICovCgoKICAgIGhhc0FueUV2ZW50TGlzdGVuZXIodHlwZSkgewogICAgICBpZiAodGhpcy5fbGlzdGVuZXJzID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKICAgICAgcmV0dXJuIGxpc3RlbmVyc1t0eXBlXSAhPT0gdW5kZWZpbmVkOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYW4gZXZlbnQgbGlzdGVuZXIKICAgICAqIEByZXR1cm4gVGhlIHNlbGYgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpIHsKICAgICAgaWYgKHRoaXMuX2xpc3RlbmVycyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgIH0KCiAgICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyczsKCiAgICAgIGlmIChsaXN0ZW5lcnNbdHlwZV0gPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBjb25zdCBpbmRleCA9IGxpc3RlbmVyc1t0eXBlXS5pbmRleE9mKGxpc3RlbmVyKTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICBsaXN0ZW5lcnNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEVtaXQgYW4gZXZlbnQuCiAgICAgKiBAcmV0dXJuIFRoZSBzZWxmIG9iamVjdCwgZm9yIGNoYWluYWJpbGl0eS4KICAgICAqLwoKCiAgICBkaXNwYXRjaEV2ZW50KGV2ZW50KSB7CiAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLl9saXN0ZW5lcnM7CiAgICAgIGNvbnN0IGxpc3RlbmVyQXJyYXkgPSBsaXN0ZW5lcnNbZXZlbnQudHlwZV07CgogICAgICBpZiAobGlzdGVuZXJBcnJheSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZXZlbnQudGFyZ2V0ID0gdGhpczsKCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBsaXN0ZW5lckFycmF5Lmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgbGlzdGVuZXJBcnJheVtpXS5jYWxsKHRoaXMsIGV2ZW50KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICB9CiAgLyoqCiAgICogQSBRdWF0ZXJuaW9uIGRlc2NyaWJlcyBhIHJvdGF0aW9uIGluIDNEIHNwYWNlLiBUaGUgUXVhdGVybmlvbiBpcyBtYXRoZW1hdGljYWxseSBkZWZpbmVkIGFzIFEgPSB4KmkgKyB5KmogKyB6KmsgKyB3LCB3aGVyZSAoaSxqLGspIGFyZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9ycy4gKHgseSx6KSBjYW4gYmUgc2VlbiBhcyBhIHZlY3RvciByZWxhdGVkIHRvIHRoZSBheGlzIG9mIHJvdGF0aW9uLCB3aGlsZSB0aGUgcmVhbCBtdWx0aXBsaWVyLCB3LCBpcyByZWxhdGVkIHRvIHRoZSBhbW91bnQgb2Ygcm90YXRpb24uCiAgICogQHBhcmFtIHggTXVsdGlwbGllciBvZiB0aGUgaW1hZ2luYXJ5IGJhc2lzIHZlY3RvciBpLgogICAqIEBwYXJhbSB5IE11bHRpcGxpZXIgb2YgdGhlIGltYWdpbmFyeSBiYXNpcyB2ZWN0b3Igai4KICAgKiBAcGFyYW0geiBNdWx0aXBsaWVyIG9mIHRoZSBpbWFnaW5hcnkgYmFzaXMgdmVjdG9yIGsuCiAgICogQHBhcmFtIHcgTXVsdGlwbGllciBvZiB0aGUgcmVhbCBwYXJ0LgogICAqIEBzZWUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9RdWF0ZXJuaW9uCiAgICovCgoKICBjbGFzcyBRdWF0ZXJuaW9uIHsKICAgIGNvbnN0cnVjdG9yKHggPSAwLCB5ID0gMCwgeiA9IDAsIHcgPSAxKSB7CiAgICAgIHRoaXMueCA9IHZvaWQgMDsKICAgICAgdGhpcy55ID0gdm9pZCAwOwogICAgICB0aGlzLnogPSB2b2lkIDA7CiAgICAgIHRoaXMudyA9IHZvaWQgMDsKICAgICAgdGhpcy54ID0geDsKICAgICAgdGhpcy55ID0geTsKICAgICAgdGhpcy56ID0gejsKICAgICAgdGhpcy53ID0gdzsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSB2YWx1ZSBvZiB0aGUgcXVhdGVybmlvbi4KICAgICAqLwoKCiAgICBzZXQoeCwgeSwgeiwgdykgewogICAgICB0aGlzLnggPSB4OwogICAgICB0aGlzLnkgPSB5OwogICAgICB0aGlzLnogPSB6OwogICAgICB0aGlzLncgPSB3OwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhIHJlYWRhYmxlIGZvcm1hdAogICAgICogQHJldHVybiAieCx5LHosdyIKICAgICAqLwoKCiAgICB0b1N0cmluZygpIHsKICAgICAgcmV0dXJuIHRoaXMueCArICIsIiArIHRoaXMueSArICIsIiArIHRoaXMueiArICIsIiArIHRoaXMudzsKICAgIH0KICAgIC8qKgogICAgICogQ29udmVydCB0byBhbiBBcnJheQogICAgICogQHJldHVybiBbeCwgeSwgeiwgd10KICAgICAqLwoKCiAgICB0b0FycmF5KCkgewogICAgICByZXR1cm4gW3RoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMud107CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiBjb21wb25lbnRzIGdpdmVuIGFuIGF4aXMgYW5kIGFuIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgc2V0RnJvbUF4aXNBbmdsZSh2ZWN0b3IsIGFuZ2xlKSB7CiAgICAgIGNvbnN0IHMgPSBNYXRoLnNpbihhbmdsZSAqIDAuNSk7CiAgICAgIHRoaXMueCA9IHZlY3Rvci54ICogczsKICAgICAgdGhpcy55ID0gdmVjdG9yLnkgKiBzOwogICAgICB0aGlzLnogPSB2ZWN0b3IueiAqIHM7CiAgICAgIHRoaXMudyA9IE1hdGguY29zKGFuZ2xlICogMC41KTsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnRzIHRoZSBxdWF0ZXJuaW9uIHRvIFsgYXhpcywgYW5nbGUgXSByZXByZXNlbnRhdGlvbi4KICAgICAqIEBwYXJhbSB0YXJnZXRBeGlzIEEgdmVjdG9yIG9iamVjdCB0byByZXVzZSBmb3Igc3RvcmluZyB0aGUgYXhpcy4KICAgICAqIEByZXR1cm4gQW4gYXJyYXksIGZpcnN0IGVsZW1lbnQgaXMgdGhlIGF4aXMgYW5kIHRoZSBzZWNvbmQgaXMgdGhlIGFuZ2xlIGluIHJhZGlhbnMuCiAgICAgKi8KCgogICAgdG9BeGlzQW5nbGUodGFyZ2V0QXhpcyA9IG5ldyBWZWMzKCkpIHsKICAgICAgdGhpcy5ub3JtYWxpemUoKTsgLy8gaWYgdz4xIGFjb3MgYW5kIHNxcnQgd2lsbCBwcm9kdWNlIGVycm9ycywgdGhpcyBjYW50IGhhcHBlbiBpZiBxdWF0ZXJuaW9uIGlzIG5vcm1hbGlzZWQKCiAgICAgIGNvbnN0IGFuZ2xlID0gMiAqIE1hdGguYWNvcyh0aGlzLncpOwogICAgICBjb25zdCBzID0gTWF0aC5zcXJ0KDEgLSB0aGlzLncgKiB0aGlzLncpOyAvLyBhc3N1bWluZyBxdWF0ZXJuaW9uIG5vcm1hbGlzZWQgdGhlbiB3IGlzIGxlc3MgdGhhbiAxLCBzbyB0ZXJtIGFsd2F5cyBwb3NpdGl2ZS4KCiAgICAgIGlmIChzIDwgMC4wMDEpIHsKICAgICAgICAvLyB0ZXN0IHRvIGF2b2lkIGRpdmlkZSBieSB6ZXJvLCBzIGlzIGFsd2F5cyBwb3NpdGl2ZSBkdWUgdG8gc3FydAogICAgICAgIC8vIGlmIHMgY2xvc2UgdG8gemVybyB0aGVuIGRpcmVjdGlvbiBvZiBheGlzIG5vdCBpbXBvcnRhbnQKICAgICAgICB0YXJnZXRBeGlzLnggPSB0aGlzLng7IC8vIGlmIGl0IGlzIGltcG9ydGFudCB0aGF0IGF4aXMgaXMgbm9ybWFsaXNlZCB0aGVuIHJlcGxhY2Ugd2l0aCB4PTE7IHk9ej0wOwoKICAgICAgICB0YXJnZXRBeGlzLnkgPSB0aGlzLnk7CiAgICAgICAgdGFyZ2V0QXhpcy56ID0gdGhpcy56OwogICAgICB9IGVsc2UgewogICAgICAgIHRhcmdldEF4aXMueCA9IHRoaXMueCAvIHM7IC8vIG5vcm1hbGlzZSBheGlzCgogICAgICAgIHRhcmdldEF4aXMueSA9IHRoaXMueSAvIHM7CiAgICAgICAgdGFyZ2V0QXhpcy56ID0gdGhpcy56IC8gczsKICAgICAgfQoKICAgICAgcmV0dXJuIFt0YXJnZXRBeGlzLCBhbmdsZV07CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgcXVhdGVybmlvbiB2YWx1ZSBnaXZlbiB0d28gdmVjdG9ycy4gVGhlIHJlc3VsdGluZyByb3RhdGlvbiB3aWxsIGJlIHRoZSBuZWVkZWQgcm90YXRpb24gdG8gcm90YXRlIHUgdG8gdi4KICAgICAqLwoKCiAgICBzZXRGcm9tVmVjdG9ycyh1LCB2KSB7CiAgICAgIGlmICh1LmlzQW50aXBhcmFsbGVsVG8odikpIHsKICAgICAgICBjb25zdCB0MSA9IHNmdl90MTsKICAgICAgICBjb25zdCB0MiA9IHNmdl90MjsKICAgICAgICB1LnRhbmdlbnRzKHQxLCB0Mik7CiAgICAgICAgdGhpcy5zZXRGcm9tQXhpc0FuZ2xlKHQxLCBNYXRoLlBJKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBhID0gdS5jcm9zcyh2KTsKICAgICAgICB0aGlzLnggPSBhLng7CiAgICAgICAgdGhpcy55ID0gYS55OwogICAgICAgIHRoaXMueiA9IGEuejsKICAgICAgICB0aGlzLncgPSBNYXRoLnNxcnQodS5sZW5ndGgoKSAqKiAyICogdi5sZW5ndGgoKSAqKiAyKSArIHUuZG90KHYpOwogICAgICAgIHRoaXMubm9ybWFsaXplKCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB0aGUgcXVhdGVybmlvbiB3aXRoIGFuIG90aGVyIHF1YXRlcm5pb24uCiAgICAgKi8KCgogICAgbXVsdChxdWF0LCB0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpKSB7CiAgICAgIGNvbnN0IGF4ID0gdGhpcy54OwogICAgICBjb25zdCBheSA9IHRoaXMueTsKICAgICAgY29uc3QgYXogPSB0aGlzLno7CiAgICAgIGNvbnN0IGF3ID0gdGhpcy53OwogICAgICBjb25zdCBieCA9IHF1YXQueDsKICAgICAgY29uc3QgYnkgPSBxdWF0Lnk7CiAgICAgIGNvbnN0IGJ6ID0gcXVhdC56OwogICAgICBjb25zdCBidyA9IHF1YXQudzsKICAgICAgdGFyZ2V0LnggPSBheCAqIGJ3ICsgYXcgKiBieCArIGF5ICogYnogLSBheiAqIGJ5OwogICAgICB0YXJnZXQueSA9IGF5ICogYncgKyBhdyAqIGJ5ICsgYXogKiBieCAtIGF4ICogYno7CiAgICAgIHRhcmdldC56ID0gYXogKiBidyArIGF3ICogYnogKyBheCAqIGJ5IC0gYXkgKiBieDsKICAgICAgdGFyZ2V0LncgPSBhdyAqIGJ3IC0gYXggKiBieCAtIGF5ICogYnkgLSBheiAqIGJ6OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGludmVyc2UgcXVhdGVybmlvbiByb3RhdGlvbi4KICAgICAqLwoKCiAgICBpbnZlcnNlKHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCkpIHsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKICAgICAgdGhpcy5jb25qdWdhdGUodGFyZ2V0KTsKICAgICAgY29uc3QgaW5vcm0yID0gMSAvICh4ICogeCArIHkgKiB5ICsgeiAqIHogKyB3ICogdyk7CiAgICAgIHRhcmdldC54ICo9IGlub3JtMjsKICAgICAgdGFyZ2V0LnkgKj0gaW5vcm0yOwogICAgICB0YXJnZXQueiAqPSBpbm9ybTI7CiAgICAgIHRhcmdldC53ICo9IGlub3JtMjsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBxdWF0ZXJuaW9uIGNvbmp1Z2F0ZQogICAgICovCgoKICAgIGNvbmp1Z2F0ZSh0YXJnZXQgPSBuZXcgUXVhdGVybmlvbigpKSB7CiAgICAgIHRhcmdldC54ID0gLXRoaXMueDsKICAgICAgdGFyZ2V0LnkgPSAtdGhpcy55OwogICAgICB0YXJnZXQueiA9IC10aGlzLno7CiAgICAgIHRhcmdldC53ID0gdGhpcy53OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBOb3JtYWxpemUgdGhlIHF1YXRlcm5pb24uIE5vdGUgdGhhdCB0aGlzIGNoYW5nZXMgdGhlIHZhbHVlcyBvZiB0aGUgcXVhdGVybmlvbi4KICAgICAqLwoKCiAgICBub3JtYWxpemUoKSB7CiAgICAgIGxldCBsID0gTWF0aC5zcXJ0KHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMueiArIHRoaXMudyAqIHRoaXMudyk7CgogICAgICBpZiAobCA9PT0gMCkgewogICAgICAgIHRoaXMueCA9IDA7CiAgICAgICAgdGhpcy55ID0gMDsKICAgICAgICB0aGlzLnogPSAwOwogICAgICAgIHRoaXMudyA9IDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbCA9IDEgLyBsOwogICAgICAgIHRoaXMueCAqPSBsOwogICAgICAgIHRoaXMueSAqPSBsOwogICAgICAgIHRoaXMueiAqPSBsOwogICAgICAgIHRoaXMudyAqPSBsOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogQXBwcm94aW1hdGlvbiBvZiBxdWF0ZXJuaW9uIG5vcm1hbGl6YXRpb24uIFdvcmtzIGJlc3Qgd2hlbiBxdWF0IGlzIGFscmVhZHkgYWxtb3N0LW5vcm1hbGl6ZWQuCiAgICAgKiBAYXV0aG9yIHVucGhhc2VkLCBodHRwczovL2dpdGh1Yi5jb20vdW5waGFzZWQKICAgICAqLwoKCiAgICBub3JtYWxpemVGYXN0KCkgewogICAgICBjb25zdCBmID0gKDMuMCAtICh0aGlzLnggKiB0aGlzLnggKyB0aGlzLnkgKiB0aGlzLnkgKyB0aGlzLnogKiB0aGlzLnogKyB0aGlzLncgKiB0aGlzLncpKSAvIDIuMDsKCiAgICAgIGlmIChmID09PSAwKSB7CiAgICAgICAgdGhpcy54ID0gMDsKICAgICAgICB0aGlzLnkgPSAwOwogICAgICAgIHRoaXMueiA9IDA7CiAgICAgICAgdGhpcy53ID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnggKj0gZjsKICAgICAgICB0aGlzLnkgKj0gZjsKICAgICAgICB0aGlzLnogKj0gZjsKICAgICAgICB0aGlzLncgKj0gZjsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIE11bHRpcGx5IHRoZSBxdWF0ZXJuaW9uIGJ5IGEgdmVjdG9yCiAgICAgKi8KCgogICAgdm11bHQodiwgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCB4ID0gdi54OwogICAgICBjb25zdCB5ID0gdi55OwogICAgICBjb25zdCB6ID0gdi56OwogICAgICBjb25zdCBxeCA9IHRoaXMueDsKICAgICAgY29uc3QgcXkgPSB0aGlzLnk7CiAgICAgIGNvbnN0IHF6ID0gdGhpcy56OwogICAgICBjb25zdCBxdyA9IHRoaXMudzsgLy8gcSp2CgogICAgICBjb25zdCBpeCA9IHF3ICogeCArIHF5ICogeiAtIHF6ICogeTsKICAgICAgY29uc3QgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7CiAgICAgIGNvbnN0IGl6ID0gcXcgKiB6ICsgcXggKiB5IC0gcXkgKiB4OwogICAgICBjb25zdCBpdyA9IC1xeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7CiAgICAgIHRhcmdldC54ID0gaXggKiBxdyArIGl3ICogLXF4ICsgaXkgKiAtcXogLSBpeiAqIC1xeTsKICAgICAgdGFyZ2V0LnkgPSBpeSAqIHF3ICsgaXcgKiAtcXkgKyBpeiAqIC1xeCAtIGl4ICogLXF6OwogICAgICB0YXJnZXQueiA9IGl6ICogcXcgKyBpdyAqIC1xeiArIGl4ICogLXF5IC0gaXkgKiAtcXg7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKioKICAgICAqIENvcGllcyB2YWx1ZSBvZiBzb3VyY2UgdG8gdGhpcyBxdWF0ZXJuaW9uLgogICAgICogQHJldHVybiB0aGlzCiAgICAgKi8KCgogICAgY29weShxdWF0KSB7CiAgICAgIHRoaXMueCA9IHF1YXQueDsKICAgICAgdGhpcy55ID0gcXVhdC55OwogICAgICB0aGlzLnogPSBxdWF0Lno7CiAgICAgIHRoaXMudyA9IHF1YXQudzsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgdGhlIHF1YXRlcm5pb24gdG8gZXVsZXIgYW5nbGUgcmVwcmVzZW50YXRpb24uIE9yZGVyOiBZWlgsIGFzIHRoaXMgcGFnZSBkZXNjcmliZXM6IGh0dHBzOi8vd3d3LmV1Y2xpZGVhbnNwYWNlLmNvbS9tYXRocy9zdGFuZGFyZHMvaW5kZXguaHRtCiAgICAgKiBAcGFyYW0gb3JkZXIgVGhyZWUtY2hhcmFjdGVyIHN0cmluZywgZGVmYXVsdHMgdG8gIllaWCIKICAgICAqLwoKCiAgICB0b0V1bGVyKHRhcmdldCwgb3JkZXIgPSAnWVpYJykgewogICAgICBsZXQgaGVhZGluZzsKICAgICAgbGV0IGF0dGl0dWRlOwogICAgICBsZXQgYmFuazsKICAgICAgY29uc3QgeCA9IHRoaXMueDsKICAgICAgY29uc3QgeSA9IHRoaXMueTsKICAgICAgY29uc3QgeiA9IHRoaXMuejsKICAgICAgY29uc3QgdyA9IHRoaXMudzsKCiAgICAgIHN3aXRjaCAob3JkZXIpIHsKICAgICAgICBjYXNlICdZWlgnOgogICAgICAgICAgY29uc3QgdGVzdCA9IHggKiB5ICsgeiAqIHc7CgogICAgICAgICAgaWYgKHRlc3QgPiAwLjQ5OSkgewogICAgICAgICAgICAvLyBzaW5ndWxhcml0eSBhdCBub3J0aCBwb2xlCiAgICAgICAgICAgIGhlYWRpbmcgPSAyICogTWF0aC5hdGFuMih4LCB3KTsKICAgICAgICAgICAgYXR0aXR1ZGUgPSBNYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRlc3QgPCAtMC40OTkpIHsKICAgICAgICAgICAgLy8gc2luZ3VsYXJpdHkgYXQgc291dGggcG9sZQogICAgICAgICAgICBoZWFkaW5nID0gLTIgKiBNYXRoLmF0YW4yKHgsIHcpOwogICAgICAgICAgICBhdHRpdHVkZSA9IC1NYXRoLlBJIC8gMjsKICAgICAgICAgICAgYmFuayA9IDA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGhlYWRpbmcgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBjb25zdCBzcXggPSB4ICogeDsKICAgICAgICAgICAgY29uc3Qgc3F5ID0geSAqIHk7CiAgICAgICAgICAgIGNvbnN0IHNxeiA9IHogKiB6OwogICAgICAgICAgICBoZWFkaW5nID0gTWF0aC5hdGFuMigyICogeSAqIHcgLSAyICogeCAqIHosIDEgLSAyICogc3F5IC0gMiAqIHNxeik7IC8vIEhlYWRpbmcKCiAgICAgICAgICAgIGF0dGl0dWRlID0gTWF0aC5hc2luKDIgKiB0ZXN0KTsgLy8gYXR0aXR1ZGUKCiAgICAgICAgICAgIGJhbmsgPSBNYXRoLmF0YW4yKDIgKiB4ICogdyAtIDIgKiB5ICogeiwgMSAtIDIgKiBzcXggLSAyICogc3F6KTsgLy8gYmFuawogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFdWxlciBvcmRlciAiICsgb3JkZXIgKyAiIG5vdCBzdXBwb3J0ZWQgeWV0LiIpOwogICAgICB9CgogICAgICB0YXJnZXQueSA9IGhlYWRpbmc7CiAgICAgIHRhcmdldC56ID0gYXR0aXR1ZGU7CiAgICAgIHRhcmdldC54ID0gYmFuazsKICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIG9yZGVyIFRoZSBvcmRlciB0byBhcHBseSBhbmdsZXM6ICdYWVonIG9yICdZWFonIG9yIGFueSBvdGhlciBjb21iaW5hdGlvbi4KICAgICAqCiAgICAgKiBTZWUge0BsaW5rIGh0dHBzOi8vd3d3Lm1hdGh3b3Jrcy5jb20vbWF0bGFiY2VudHJhbC9maWxlZXhjaGFuZ2UvMjA2OTYtZnVuY3Rpb24tdG8tY29udmVydC1iZXR3ZWVuLWRjbS1ldWxlci1hbmdsZXMtcXVhdGVybmlvbnMtYW5kLWV1bGVyLXZlY3RvcnMgTWF0aFdvcmtzfSByZWZlcmVuY2UKICAgICAqLwoKCiAgICBzZXRGcm9tRXVsZXIoeCwgeSwgeiwgb3JkZXIgPSAnWFlaJykgewogICAgICBjb25zdCBjMSA9IE1hdGguY29zKHggLyAyKTsKICAgICAgY29uc3QgYzIgPSBNYXRoLmNvcyh5IC8gMik7CiAgICAgIGNvbnN0IGMzID0gTWF0aC5jb3MoeiAvIDIpOwogICAgICBjb25zdCBzMSA9IE1hdGguc2luKHggLyAyKTsKICAgICAgY29uc3QgczIgPSBNYXRoLnNpbih5IC8gMik7CiAgICAgIGNvbnN0IHMzID0gTWF0aC5zaW4oeiAvIDIpOwoKICAgICAgaWYgKG9yZGVyID09PSAnWFlaJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyArIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzICsgczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyAtIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1lYWicpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzIC0gczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgKyBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdaWFknKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyArIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzOwogICAgICB9IGVsc2UgaWYgKG9yZGVyID09PSAnWllYJykgewogICAgICAgIHRoaXMueCA9IHMxICogYzIgKiBjMyAtIGMxICogczIgKiBzMzsKICAgICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgKyBzMSAqIGMyICogczM7CiAgICAgICAgdGhpcy56ID0gYzEgKiBjMiAqIHMzIC0gczEgKiBzMiAqIGMzOwogICAgICAgIHRoaXMudyA9IGMxICogYzIgKiBjMyArIHMxICogczIgKiBzMzsKICAgICAgfSBlbHNlIGlmIChvcmRlciA9PT0gJ1laWCcpIHsKICAgICAgICB0aGlzLnggPSBzMSAqIGMyICogYzMgKyBjMSAqIHMyICogczM7CiAgICAgICAgdGhpcy55ID0gYzEgKiBzMiAqIGMzICsgczEgKiBjMiAqIHMzOwogICAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyAtIHMxICogczIgKiBjMzsKICAgICAgICB0aGlzLncgPSBjMSAqIGMyICogYzMgLSBzMSAqIHMyICogczM7CiAgICAgIH0gZWxzZSBpZiAob3JkZXIgPT09ICdYWlknKSB7CiAgICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzIC0gYzEgKiBzMiAqIHMzOwogICAgICAgIHRoaXMueSA9IGMxICogczIgKiBjMyAtIHMxICogYzIgKiBzMzsKICAgICAgICB0aGlzLnogPSBjMSAqIGMyICogczMgKyBzMSAqIHMyICogYzM7CiAgICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzICsgczEgKiBzMiAqIHMzOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgICBjbG9uZSgpIHsKICAgICAgcmV0dXJuIG5ldyBRdWF0ZXJuaW9uKHRoaXMueCwgdGhpcy55LCB0aGlzLnosIHRoaXMudyk7CiAgICB9CiAgICAvKioKICAgICAqIFBlcmZvcm1zIGEgc3BoZXJpY2FsIGxpbmVhciBpbnRlcnBvbGF0aW9uIGJldHdlZW4gdHdvIHF1YXQKICAgICAqCiAgICAgKiBAcGFyYW0gdG9RdWF0IHNlY29uZCBvcGVyYW5kCiAgICAgKiBAcGFyYW0gdCBpbnRlcnBvbGF0aW9uIGFtb3VudCBiZXR3ZWVuIHRoZSBzZWxmIHF1YXRlcm5pb24gYW5kIHRvUXVhdAogICAgICogQHBhcmFtIHRhcmdldCBBIHF1YXRlcm5pb24gdG8gc3RvcmUgdGhlIHJlc3VsdCBpbi4gSWYgbm90IHByb3ZpZGVkLCBhIG5ldyBvbmUgd2lsbCBiZSBjcmVhdGVkLgogICAgICogQHJldHVybnMge1F1YXRlcm5pb259IFRoZSAidGFyZ2V0IiBvYmplY3QKICAgICAqLwoKCiAgICBzbGVycCh0b1F1YXQsIHQsIHRhcmdldCA9IG5ldyBRdWF0ZXJuaW9uKCkpIHsKICAgICAgY29uc3QgYXggPSB0aGlzLng7CiAgICAgIGNvbnN0IGF5ID0gdGhpcy55OwogICAgICBjb25zdCBheiA9IHRoaXMuejsKICAgICAgY29uc3QgYXcgPSB0aGlzLnc7CiAgICAgIGxldCBieCA9IHRvUXVhdC54OwogICAgICBsZXQgYnkgPSB0b1F1YXQueTsKICAgICAgbGV0IGJ6ID0gdG9RdWF0Lno7CiAgICAgIGxldCBidyA9IHRvUXVhdC53OwogICAgICBsZXQgb21lZ2E7CiAgICAgIGxldCBjb3NvbTsKICAgICAgbGV0IHNpbm9tOwogICAgICBsZXQgc2NhbGUwOwogICAgICBsZXQgc2NhbGUxOyAvLyBjYWxjIGNvc2luZQoKICAgICAgY29zb20gPSBheCAqIGJ4ICsgYXkgKiBieSArIGF6ICogYnogKyBhdyAqIGJ3OyAvLyBhZGp1c3Qgc2lnbnMgKGlmIG5lY2Vzc2FyeSkKCiAgICAgIGlmIChjb3NvbSA8IDAuMCkgewogICAgICAgIGNvc29tID0gLWNvc29tOwogICAgICAgIGJ4ID0gLWJ4OwogICAgICAgIGJ5ID0gLWJ5OwogICAgICAgIGJ6ID0gLWJ6OwogICAgICAgIGJ3ID0gLWJ3OwogICAgICB9IC8vIGNhbGN1bGF0ZSBjb2VmZmljaWVudHMKCgogICAgICBpZiAoMS4wIC0gY29zb20gPiAwLjAwMDAwMSkgewogICAgICAgIC8vIHN0YW5kYXJkIGNhc2UgKHNsZXJwKQogICAgICAgIG9tZWdhID0gTWF0aC5hY29zKGNvc29tKTsKICAgICAgICBzaW5vbSA9IE1hdGguc2luKG9tZWdhKTsKICAgICAgICBzY2FsZTAgPSBNYXRoLnNpbigoMS4wIC0gdCkgKiBvbWVnYSkgLyBzaW5vbTsKICAgICAgICBzY2FsZTEgPSBNYXRoLnNpbih0ICogb21lZ2EpIC8gc2lub207CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIHF1YXRlcm5pb25zIGFyZSB2ZXJ5IGNsb3NlCiAgICAgICAgLy8gIC4uLiBzbyB3ZSBjYW4gZG8gYSBsaW5lYXIgaW50ZXJwb2xhdGlvbgogICAgICAgIHNjYWxlMCA9IDEuMCAtIHQ7CiAgICAgICAgc2NhbGUxID0gdDsKICAgICAgfSAvLyBjYWxjdWxhdGUgZmluYWwgdmFsdWVzCgoKICAgICAgdGFyZ2V0LnggPSBzY2FsZTAgKiBheCArIHNjYWxlMSAqIGJ4OwogICAgICB0YXJnZXQueSA9IHNjYWxlMCAqIGF5ICsgc2NhbGUxICogYnk7CiAgICAgIHRhcmdldC56ID0gc2NhbGUwICogYXogKyBzY2FsZTEgKiBiejsKICAgICAgdGFyZ2V0LncgPSBzY2FsZTAgKiBhdyArIHNjYWxlMSAqIGJ3OwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBSb3RhdGUgYW4gYWJzb2x1dGUgb3JpZW50YXRpb24gcXVhdGVybmlvbiBnaXZlbiBhbiBhbmd1bGFyIHZlbG9jaXR5IGFuZCBhIHRpbWUgc3RlcC4KICAgICAqLwoKCiAgICBpbnRlZ3JhdGUoYW5ndWxhclZlbG9jaXR5LCBkdCwgYW5ndWxhckZhY3RvciwgdGFyZ2V0ID0gbmV3IFF1YXRlcm5pb24oKSkgewogICAgICBjb25zdCBheCA9IGFuZ3VsYXJWZWxvY2l0eS54ICogYW5ndWxhckZhY3Rvci54LAogICAgICAgICAgICBheSA9IGFuZ3VsYXJWZWxvY2l0eS55ICogYW5ndWxhckZhY3Rvci55LAogICAgICAgICAgICBheiA9IGFuZ3VsYXJWZWxvY2l0eS56ICogYW5ndWxhckZhY3Rvci56LAogICAgICAgICAgICBieCA9IHRoaXMueCwKICAgICAgICAgICAgYnkgPSB0aGlzLnksCiAgICAgICAgICAgIGJ6ID0gdGhpcy56LAogICAgICAgICAgICBidyA9IHRoaXMudzsKICAgICAgY29uc3QgaGFsZl9kdCA9IGR0ICogMC41OwogICAgICB0YXJnZXQueCArPSBoYWxmX2R0ICogKGF4ICogYncgKyBheSAqIGJ6IC0gYXogKiBieSk7CiAgICAgIHRhcmdldC55ICs9IGhhbGZfZHQgKiAoYXkgKiBidyArIGF6ICogYnggLSBheCAqIGJ6KTsKICAgICAgdGFyZ2V0LnogKz0gaGFsZl9kdCAqIChheiAqIGJ3ICsgYXggKiBieSAtIGF5ICogYngpOwogICAgICB0YXJnZXQudyArPSBoYWxmX2R0ICogKC1heCAqIGJ4IC0gYXkgKiBieSAtIGF6ICogYnopOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICB9CgogIGNvbnN0IHNmdl90MSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc2Z2X3QyID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBUaGUgYXZhaWxhYmxlIHNoYXBlIHR5cGVzLgogICAqLwoKICBjb25zdCBTSEFQRV9UWVBFUyA9IHsKICAgIC8qKiBTUEhFUkUgKi8KICAgIFNQSEVSRTogMSwKCiAgICAvKiogUExBTkUgKi8KICAgIFBMQU5FOiAyLAoKICAgIC8qKiBCT1ggKi8KICAgIEJPWDogNCwKCiAgICAvKiogQ09NUE9VTkQgKi8KICAgIENPTVBPVU5EOiA4LAoKICAgIC8qKiBDT05WRVhQT0xZSEVEUk9OICovCiAgICBDT05WRVhQT0xZSEVEUk9OOiAxNiwKCiAgICAvKiogSEVJR0hURklFTEQgKi8KICAgIEhFSUdIVEZJRUxEOiAzMiwKCiAgICAvKiogUEFSVElDTEUgKi8KICAgIFBBUlRJQ0xFOiA2NCwKCiAgICAvKiogQ1lMSU5ERVIgKi8KICAgIENZTElOREVSOiAxMjgsCgogICAgLyoqIFRSSU1FU0ggKi8KICAgIFRSSU1FU0g6IDI1NgogIH07CiAgLyoqCiAgICogU2hhcGVUeXBlCiAgICovCgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIHNoYXBlcwogICAqLwoKICBjbGFzcyBTaGFwZSB7CiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIFNoYXBlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgdHlwZSBvZiB0aGlzIHNoYXBlLiBNdXN0IGJlIHNldCB0byBhbiBpbnQgPiAwIGJ5IHN1YmNsYXNzZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBsb2NhbCBib3VuZGluZyBzcGhlcmUgcmFkaXVzIG9mIHRoaXMgc2hhcGUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZC4KICAgICAqIEBkZWZhdWx0IHRydWUKICAgICAqLwoKICAgIC8qKgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBPcHRpb25hbCBtYXRlcmlhbCBvZiB0aGUgc2hhcGUgdGhhdCByZWd1bGF0ZXMgY29udGFjdCBwcm9wZXJ0aWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYm9keSB0byB3aGljaCB0aGUgc2hhcGUgaXMgYWRkZWQgdG8uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCB0aGUgU2hhcGUgdHlwZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkgewogICAgICB0aGlzLmlkID0gdm9pZCAwOwogICAgICB0aGlzLnR5cGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uUmVzcG9uc2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IHZvaWQgMDsKICAgICAgdGhpcy5ib2R5ID0gdm9pZCAwOwogICAgICB0aGlzLmlkID0gU2hhcGUuaWRDb3VudGVyKys7CiAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZSB8fCAwOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gMDsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IG9wdGlvbnMuY29sbGlzaW9uUmVzcG9uc2UgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyR3JvdXAgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyR3JvdXAgOiAxOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA6IC0xOwogICAgICB0aGlzLm1hdGVyaWFsID0gb3B0aW9ucy5tYXRlcmlhbCA/IG9wdGlvbnMubWF0ZXJpYWwgOiBudWxsOwogICAgICB0aGlzLmJvZHkgPSBudWxsOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgYm91bmRpbmcgc3BoZXJlIHJhZGl1cy4KICAgICAqIFRoZSByZXN1bHQgaXMgc3RvcmVkIGluIHRoZSBwcm9wZXJ0eSBgLmJvdW5kaW5nU3BoZXJlUmFkaXVzYAogICAgICovCgoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aHJvdyAiY29tcHV0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICIgKyB0aGlzLnR5cGU7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdm9sdW1lIG9mIHRoaXMgc2hhcGUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHRocm93ICJ2b2x1bWUoKSBub3QgaW1wbGVtZW50ZWQgZm9yIHNoYXBlIHR5cGUgIiArIHRoaXMudHlwZTsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlcyB0aGUgaW5lcnRpYSBpbiB0aGUgbG9jYWwgZnJhbWUgZm9yIHRoaXMgc2hhcGUuCiAgICAgKiBAc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGlzdF9vZl9tb21lbnRzX29mX2luZXJ0aWEKICAgICAqLwoKCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0KSB7CiAgICAgIHRocm93ICJjYWxjdWxhdGVMb2NhbEluZXJ0aWEoKSBub3QgaW1wbGVtZW50ZWQgZm9yIHNoYXBlIHR5cGUgIiArIHRoaXMudHlwZTsKICAgIH0KICAgIC8qKgogICAgICogQHRvZG8gdXNlIGFic3RyYWN0IGZvciB0aGVzZSBraW5kIG9mIG1ldGhvZHMKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICB0aHJvdyAiY2FsY3VsYXRlV29ybGRBQUJCKCkgbm90IGltcGxlbWVudGVkIGZvciBzaGFwZSB0eXBlICIgKyB0aGlzLnR5cGU7CiAgICB9CgogIH0KCiAgU2hhcGUuaWRDb3VudGVyID0gMDsKICBTaGFwZS50eXBlcyA9IFNIQVBFX1RZUEVTOwogIC8qKgogICAqIFRyYW5zZm9ybWF0aW9uIHV0aWxpdGllcy4KICAgKi8KCiAgY2xhc3MgVHJhbnNmb3JtIHsKICAgIC8qKgogICAgICogcG9zaXRpb24KICAgICAqLwoKICAgIC8qKgogICAgICogcXVhdGVybmlvbgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgdGhpcy5wb3NpdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gdm9pZCAwOwogICAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnBvc2l0aW9uKSB7CiAgICAgICAgdGhpcy5wb3NpdGlvbi5jb3B5KG9wdGlvbnMucG9zaXRpb24pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5xdWF0ZXJuaW9uKSB7CiAgICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSBnbG9iYWwgcG9pbnQgaW4gbG9jYWwgdHJhbnNmb3JtIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbCh3b3JsZFBvaW50LCByZXN1bHQpIHsKICAgICAgcmV0dXJuIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0aGlzLnBvc2l0aW9uLCB0aGlzLnF1YXRlcm5pb24sIHdvcmxkUG9pbnQsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIGxvY2FsIHBvaW50IGluIGdsb2JhbCB0cmFuc2Zvcm0gY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgcG9pbnRUb1dvcmxkKGxvY2FsUG9pbnQsIHJlc3VsdCkgewogICAgICByZXR1cm4gVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRoaXMucG9zaXRpb24sIHRoaXMucXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0KTsKICAgIH0KICAgIC8qKgogICAgICogdmVjdG9yVG9Xb3JsZEZyYW1lCiAgICAgKi8KCgogICAgdmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsVmVjdG9yLCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFZlY3RvciwgcmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0KICAgIC8qKgogICAgICogcG9pbnRUb0xvY2FsRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXRlcm5pb24sIHdvcmxkUG9pbnQsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgd29ybGRQb2ludC52c3ViKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICBxdWF0ZXJuaW9uLmNvbmp1Z2F0ZSh0bXBRdWF0JDEpOwogICAgICB0bXBRdWF0JDEudm11bHQocmVzdWx0LCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBwb2ludFRvV29ybGRGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyBwb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdGVybmlvbiwgbG9jYWxQb2ludCwgcmVzdWx0ID0gbmV3IFZlYzMoKSkgewogICAgICBxdWF0ZXJuaW9uLnZtdWx0KGxvY2FsUG9pbnQsIHJlc3VsdCk7CiAgICAgIHJlc3VsdC52YWRkKHBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiB2ZWN0b3JUb1dvcmxkRnJhbWUKICAgICAqLwoKCiAgICBzdGF0aWMgdmVjdG9yVG9Xb3JsZEZyYW1lKHF1YXRlcm5pb24sIGxvY2FsVmVjdG9yLCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHF1YXRlcm5pb24udm11bHQobG9jYWxWZWN0b3IsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIHZlY3RvclRvTG9jYWxGcmFtZQogICAgICovCgoKICAgIHN0YXRpYyB2ZWN0b3JUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXRlcm5pb24sIHdvcmxkVmVjdG9yLCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHF1YXRlcm5pb24udyAqPSAtMTsKICAgICAgcXVhdGVybmlvbi52bXVsdCh3b3JsZFZlY3RvciwgcmVzdWx0KTsKICAgICAgcXVhdGVybmlvbi53ICo9IC0xOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CgogIGNvbnN0IHRtcFF1YXQkMSA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgLyoqCiAgICogQSBzZXQgb2YgcG9seWdvbnMgZGVzY3JpYmluZyBhIGNvbnZleCBzaGFwZS4KICAgKgogICAqIFRoZSBzaGFwZSBNVVNUIGJlIGNvbnZleCBmb3IgdGhlIGNvZGUgdG8gd29yayBwcm9wZXJseS4gTm8gcG9seWdvbnMgbWF5IGJlIGNvcGxhbmFyIChjb250YWluZWQKICAgKiBpbiB0aGUgc2FtZSAzRCBwbGFuZSksIGluc3RlYWQgdGhlc2Ugc2hvdWxkIGJlIG1lcmdlZCBpbnRvIG9uZSBwb2x5Z29uLgogICAqCiAgICogQGF1dGhvciBxaWFvIC8gaHR0cHM6Ly9naXRodWIuY29tL3FpYW8gKG9yaWdpbmFsIGF1dGhvciwgc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9xaWFvL3RocmVlLmpzL2NvbW1pdC84NTAyNmYwYzc2OWU0MDAwMTQ4YTY3ZDQ1YTllOWI5YzUxMDg4MzZmKQogICAqIEBhdXRob3Igc2NodGVwcGUgLyBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUKICAgKiBAc2VlIGh0dHBzOi8vd3d3LmFsdGRldmJsb2dhZGF5LmNvbS8yMDExLzA1LzEzL2NvbnRhY3QtZ2VuZXJhdGlvbi1iZXR3ZWVuLTNkLWNvbnZleC1tZXNoZXMvCiAgICoKICAgKiBAdG9kbyBNb3ZlIHRoZSBjbGlwcGluZyBmdW5jdGlvbnMgdG8gQ29udGFjdEdlbmVyYXRvcj8KICAgKiBAdG9kbyBBdXRvbWF0aWNhbGx5IG1lcmdlIGNvcGxhbmFyIHBvbHlnb25zIGluIGNvbnN0cnVjdG9yLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGNvbnZleFNoYXBlID0gbmV3IENBTk5PTi5Db252ZXhQb2x5aGVkcm9uKHsgdmVydGljZXMsIGZhY2VzIH0pCiAgICogICAgIGNvbnN0IGNvbnZleEJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAxLCBzaGFwZTogY29udmV4U2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShjb252ZXhCb2R5KQogICAqLwoKICBjbGFzcyBDb252ZXhQb2x5aGVkcm9uIGV4dGVuZHMgU2hhcGUgewogICAgLyoqIHZlcnRpY2VzICovCgogICAgLyoqCiAgICAgKiBBcnJheSBvZiBpbnRlZ2VyIGFycmF5cywgaW5kaWNhdGluZyB3aGljaCB2ZXJ0aWNlcyBlYWNoIGZhY2UgY29uc2lzdHMgb2YKICAgICAqLwoKICAgIC8qKiBmYWNlTm9ybWFscyAqLwoKICAgIC8qKiB3b3JsZFZlcnRpY2VzICovCgogICAgLyoqIHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSAqLwoKICAgIC8qKiB3b3JsZEZhY2VOb3JtYWxzICovCgogICAgLyoqIHdvcmxkRmFjZU5vcm1hbHNOZWVkc1VwZGF0ZSAqLwoKICAgIC8qKgogICAgICogSWYgZ2l2ZW4sIHRoZXNlIGxvY2FsbHkgZGVmaW5lZCwgbm9ybWFsaXplZCBheGVzIGFyZSB0aGUgb25seSBvbmVzIGJlaW5nIGNoZWNrZWQgd2hlbiBkb2luZyBzZXBhcmF0aW5nIGF4aXMgY2hlY2suCiAgICAgKi8KCiAgICAvKiogdW5pcXVlRWRnZXMgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSB2ZXJ0aWNlcyBBbiBhcnJheSBvZiBWZWMzJ3MKICAgICAqIEBwYXJhbSBmYWNlcyBBcnJheSBvZiBpbnRlZ2VyIGFycmF5cywgZGVzY3JpYmluZyB3aGljaCB2ZXJ0aWNlcyB0aGF0IGlzIGluY2x1ZGVkIGluIGVhY2ggZmFjZS4KICAgICAqLwogICAgY29uc3RydWN0b3IocHJvcHMgPSB7fSkgewogICAgICBjb25zdCB7CiAgICAgICAgdmVydGljZXMgPSBbXSwKICAgICAgICBmYWNlcyA9IFtdLAogICAgICAgIG5vcm1hbHMgPSBbXSwKICAgICAgICBheGVzLAogICAgICAgIGJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgIH0gPSBwcm9wczsKICAgICAgc3VwZXIoewogICAgICAgIHR5cGU6IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04KICAgICAgfSk7CiAgICAgIHRoaXMudmVydGljZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuZmFjZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGRWZXJ0aWNlcyA9IHZvaWQgMDsKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IHZvaWQgMDsKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB2b2lkIDA7CiAgICAgIHRoaXMudW5pcXVlQXhlcyA9IHZvaWQgMDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IHZvaWQgMDsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IHZlcnRpY2VzOwogICAgICB0aGlzLmZhY2VzID0gZmFjZXM7CiAgICAgIHRoaXMuZmFjZU5vcm1hbHMgPSBub3JtYWxzOwoKICAgICAgaWYgKHRoaXMuZmFjZU5vcm1hbHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhpcy5jb21wdXRlTm9ybWFscygpOwogICAgICB9CgogICAgICBpZiAoIWJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSBib3VuZGluZ1NwaGVyZVJhZGl1czsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzID0gW107IC8vIFdvcmxkIHRyYW5zZm9ybWVkIHZlcnNpb24gb2YgLnZlcnRpY2VzCgogICAgICB0aGlzLndvcmxkVmVydGljZXNOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFscyA9IFtdOyAvLyBXb3JsZCB0cmFuc2Zvcm1lZCB2ZXJzaW9uIG9mIC5mYWNlTm9ybWFscwoKICAgICAgdGhpcy53b3JsZEZhY2VOb3JtYWxzTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLnVuaXF1ZUF4ZXMgPSBheGVzID8gYXhlcy5zbGljZSgpIDogbnVsbDsKICAgICAgdGhpcy51bmlxdWVFZGdlcyA9IFtdOwogICAgICB0aGlzLmNvbXB1dGVFZGdlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB1bmlxdWVFZGdlcwogICAgICovCgoKICAgIGNvbXB1dGVFZGdlcygpIHsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IGVkZ2VzID0gdGhpcy51bmlxdWVFZGdlczsKICAgICAgZWRnZXMubGVuZ3RoID0gMDsKICAgICAgY29uc3QgZWRnZSA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbaV07CiAgICAgICAgY29uc3QgbnVtVmVydGljZXMgPSBmYWNlLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IG51bVZlcnRpY2VzOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGsgPSAoaiArIDEpICUgbnVtVmVydGljZXM7CiAgICAgICAgICB2ZXJ0aWNlc1tmYWNlW2pdXS52c3ViKHZlcnRpY2VzW2ZhY2Vba11dLCBlZGdlKTsKICAgICAgICAgIGVkZ2Uubm9ybWFsaXplKCk7CiAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGxldCBwID0gMDsgcCAhPT0gZWRnZXMubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgaWYgKGVkZ2VzW3BdLmFsbW9zdEVxdWFscyhlZGdlKSB8fCBlZGdlc1twXS5hbG1vc3RFcXVhbHMoZWRnZSkpIHsKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgIGVkZ2VzLnB1c2goZWRnZS5jbG9uZSgpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFscyBvZiB0aGUgZmFjZXMuCiAgICAgKiBXaWxsIHJldXNlIGV4aXN0aW5nIFZlYzMgb2JqZWN0cyBpbiB0aGUgYGZhY2VOb3JtYWxzYCBhcnJheSBpZiB0aGV5IGV4aXN0LgogICAgICovCgoKICAgIGNvbXB1dGVOb3JtYWxzKCkgewogICAgICB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aCA9IHRoaXMuZmFjZXMubGVuZ3RoOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZmFjZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBDaGVjayBzbyBhbGwgdmVydGljZXMgZXhpc3RzIGZvciB0aGlzIGZhY2UKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICghdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldW2pdXSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIlZlcnRleCAiICsgdGhpcy5mYWNlc1tpXVtqXSArICIgbm90IGZvdW5kISIpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgbiA9IHRoaXMuZmFjZU5vcm1hbHNbaV0gfHwgbmV3IFZlYzMoKTsKICAgICAgICB0aGlzLmdldEZhY2VOb3JtYWwoaSwgbik7CiAgICAgICAgbi5uZWdhdGUobik7CiAgICAgICAgdGhpcy5mYWNlTm9ybWFsc1tpXSA9IG47CiAgICAgICAgY29uc3QgdmVydGV4ID0gdGhpcy52ZXJ0aWNlc1t0aGlzLmZhY2VzW2ldWzBdXTsKCiAgICAgICAgaWYgKG4uZG90KHZlcnRleCkgPCAwKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCIuZmFjZU5vcm1hbHNbIiArIGkgKyAiXSA9IFZlYzMoIiArIG4udG9TdHJpbmcoKSArICIpIGxvb2tzIGxpa2UgaXQgcG9pbnRzIGludG8gdGhlIHNoYXBlPyBUaGUgdmVydGljZXMgZm9sbG93LiBNYWtlIHN1cmUgdGhleSBhcmUgb3JkZXJlZCBDQ1cgYXJvdW5kIHRoZSBub3JtYWwsIHVzaW5nIHRoZSByaWdodCBoYW5kIHJ1bGUuIik7CgogICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmZhY2VzW2ldLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiLnZlcnRpY2VzWyIgKyB0aGlzLmZhY2VzW2ldW2pdICsgIl0gPSBWZWMzKCIgKyB0aGlzLnZlcnRpY2VzW3RoaXMuZmFjZXNbaV1bal1dLnRvU3RyaW5nKCkgKyAiKSIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWwgb2YgYSBmYWNlIGZyb20gaXRzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgZ2V0RmFjZU5vcm1hbChpLCB0YXJnZXQpIHsKICAgICAgY29uc3QgZiA9IHRoaXMuZmFjZXNbaV07CiAgICAgIGNvbnN0IHZhID0gdGhpcy52ZXJ0aWNlc1tmWzBdXTsKICAgICAgY29uc3QgdmIgPSB0aGlzLnZlcnRpY2VzW2ZbMV1dOwogICAgICBjb25zdCB2YyA9IHRoaXMudmVydGljZXNbZlsyXV07CiAgICAgIENvbnZleFBvbHloZWRyb24uY29tcHV0ZU5vcm1hbCh2YSwgdmIsIHZjLCB0YXJnZXQpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgZmFjZSBub3JtYWwgZ2l2ZW4gMyB2ZXJ0aWNlcwogICAgICovCgoKICAgIHN0YXRpYyBjb21wdXRlTm9ybWFsKHZhLCB2YiwgdmMsIHRhcmdldCkgewogICAgICBjb25zdCBjYiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICAgICAgdmIudnN1Yih2YSwgYWIpOwogICAgICB2Yy52c3ViKHZiLCBjYik7CiAgICAgIGNiLmNyb3NzKGFiLCB0YXJnZXQpOwoKICAgICAgaWYgKCF0YXJnZXQuaXNaZXJvKCkpIHsKICAgICAgICB0YXJnZXQubm9ybWFsaXplKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQHBhcmFtIG1pbkRpc3QgQ2xhbXAgZGlzdGFuY2UKICAgICAqIEBwYXJhbSByZXN1bHQgVGhlIGFuIGFycmF5IG9mIGNvbnRhY3QgcG9pbnQgb2JqZWN0cywgc2VlIGNsaXBGYWNlQWdhaW5zdEh1bGwKICAgICAqLwoKCiAgICBjbGlwQWdhaW5zdEh1bGwocG9zQSwgcXVhdEEsIGh1bGxCLCBwb3NCLCBxdWF0Qiwgc2VwYXJhdGluZ05vcm1hbCwgbWluRGlzdCwgbWF4RGlzdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IFdvcmxkTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgbGV0IGNsb3Nlc3RGYWNlQiA9IC0xOwogICAgICBsZXQgZG1heCA9IC1OdW1iZXIuTUFYX1ZBTFVFOwoKICAgICAgZm9yIChsZXQgZmFjZSA9IDA7IGZhY2UgPCBodWxsQi5mYWNlcy5sZW5ndGg7IGZhY2UrKykgewogICAgICAgIFdvcmxkTm9ybWFsLmNvcHkoaHVsbEIuZmFjZU5vcm1hbHNbZmFjZV0pOwogICAgICAgIHF1YXRCLnZtdWx0KFdvcmxkTm9ybWFsLCBXb3JsZE5vcm1hbCk7CiAgICAgICAgY29uc3QgZCA9IFdvcmxkTm9ybWFsLmRvdChzZXBhcmF0aW5nTm9ybWFsKTsKCiAgICAgICAgaWYgKGQgPiBkbWF4KSB7CiAgICAgICAgICBkbWF4ID0gZDsKICAgICAgICAgIGNsb3Nlc3RGYWNlQiA9IGZhY2U7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB3b3JsZFZlcnRzQjEgPSBbXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaHVsbEIuZmFjZXNbY2xvc2VzdEZhY2VCXS5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBodWxsQi52ZXJ0aWNlc1todWxsQi5mYWNlc1tjbG9zZXN0RmFjZUJdW2ldXTsKICAgICAgICBjb25zdCB3b3JsZGIgPSBuZXcgVmVjMygpOwogICAgICAgIHdvcmxkYi5jb3B5KGIpOwogICAgICAgIHF1YXRCLnZtdWx0KHdvcmxkYiwgd29ybGRiKTsKICAgICAgICBwb3NCLnZhZGQod29ybGRiLCB3b3JsZGIpOwogICAgICAgIHdvcmxkVmVydHNCMS5wdXNoKHdvcmxkYik7CiAgICAgIH0KCiAgICAgIGlmIChjbG9zZXN0RmFjZUIgPj0gMCkgewogICAgICAgIHRoaXMuY2xpcEZhY2VBZ2FpbnN0SHVsbChzZXBhcmF0aW5nTm9ybWFsLCBwb3NBLCBxdWF0QSwgd29ybGRWZXJ0c0IxLCBtaW5EaXN0LCBtYXhEaXN0LCByZXN1bHQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZpbmQgdGhlIHNlcGFyYXRpbmcgYXhpcyBiZXR3ZWVuIHRoaXMgaHVsbCBhbmQgYW5vdGhlcgogICAgICogQHBhcmFtIHRhcmdldCBUaGUgdGFyZ2V0IHZlY3RvciB0byBzYXZlIHRoZSBheGlzIGluCiAgICAgKiBAcmV0dXJuIFJldHVybnMgZmFsc2UgaWYgYSBzZXBhcmF0aW9uIGlzIGZvdW5kLCBlbHNlIHRydWUKICAgICAqLwoKCiAgICBmaW5kU2VwYXJhdGluZ0F4aXMoaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0QiwgdGFyZ2V0LCBmYWNlTGlzdEEsIGZhY2VMaXN0QikgewogICAgICBjb25zdCBmYWNlQU5vcm1hbFdTMyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IFdvcmxkbm9ybWFsMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGRlbHRhQyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkRWRnZTAgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCB3b3JsZEVkZ2UxID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgQ3Jvc3MgPSBuZXcgVmVjMygpOwogICAgICBsZXQgZG1pbiA9IE51bWJlci5NQVhfVkFMVUU7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKCiAgICAgIGlmICghaHVsbEEudW5pcXVlQXhlcykgewogICAgICAgIGNvbnN0IG51bUZhY2VzQSA9IGZhY2VMaXN0QSA/IGZhY2VMaXN0QS5sZW5ndGggOiBodWxsQS5mYWNlcy5sZW5ndGg7IC8vIFRlc3QgZmFjZSBub3JtYWxzIGZyb20gaHVsbEEKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1GYWNlc0E7IGkrKykgewogICAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdEEgPyBmYWNlTGlzdEFbaV0gOiBpOyAvLyBHZXQgd29ybGQgZmFjZSBub3JtYWwKCiAgICAgICAgICBmYWNlQU5vcm1hbFdTMy5jb3B5KGh1bGxBLmZhY2VOb3JtYWxzW2ZpXSk7CiAgICAgICAgICBxdWF0QS52bXVsdChmYWNlQU5vcm1hbFdTMywgZmFjZUFOb3JtYWxXUzMpOwogICAgICAgICAgY29uc3QgZCA9IGh1bGxBLnRlc3RTZXBBeGlzKGZhY2VBTm9ybWFsV1MzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKTsKCiAgICAgICAgICBpZiAoZCA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChkIDwgZG1pbikgewogICAgICAgICAgICBkbWluID0gZDsKICAgICAgICAgICAgdGFyZ2V0LmNvcHkoZmFjZUFOb3JtYWxXUzMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUZXN0IHVuaXF1ZSBheGVzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IGh1bGxBLnVuaXF1ZUF4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIC8vIEdldCB3b3JsZCBheGlzCiAgICAgICAgICBxdWF0QS52bXVsdChodWxsQS51bmlxdWVBeGVzW2ldLCBmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICBjb25zdCBkID0gaHVsbEEudGVzdFNlcEF4aXMoZmFjZUFOb3JtYWxXUzMsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShmYWNlQU5vcm1hbFdTMyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWh1bGxCLnVuaXF1ZUF4ZXMpIHsKICAgICAgICAvLyBUZXN0IGZhY2Ugbm9ybWFscyBmcm9tIGh1bGxCCiAgICAgICAgY29uc3QgbnVtRmFjZXNCID0gZmFjZUxpc3RCID8gZmFjZUxpc3RCLmxlbmd0aCA6IGh1bGxCLmZhY2VzLmxlbmd0aDsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1GYWNlc0I7IGkrKykgewogICAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdEIgPyBmYWNlTGlzdEJbaV0gOiBpOwogICAgICAgICAgV29ybGRub3JtYWwxLmNvcHkoaHVsbEIuZmFjZU5vcm1hbHNbZmldKTsKICAgICAgICAgIHF1YXRCLnZtdWx0KFdvcmxkbm9ybWFsMSwgV29ybGRub3JtYWwxKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhXb3JsZG5vcm1hbDEsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShXb3JsZG5vcm1hbDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUZXN0IHVuaXF1ZSBheGVzIGluIEIKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gaHVsbEIudW5pcXVlQXhlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdEIudm11bHQoaHVsbEIudW5pcXVlQXhlc1tpXSwgV29ybGRub3JtYWwxKTsKICAgICAgICAgIGNvbnN0IGQgPSBodWxsQS50ZXN0U2VwQXhpcyhXb3JsZG5vcm1hbDEsIGh1bGxCLCBwb3NBLCBxdWF0QSwgcG9zQiwgcXVhdEIpOwoKICAgICAgICAgIGlmIChkID09PSBmYWxzZSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGQgPCBkbWluKSB7CiAgICAgICAgICAgIGRtaW4gPSBkOwogICAgICAgICAgICB0YXJnZXQuY29weShXb3JsZG5vcm1hbDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLyBUZXN0IGVkZ2VzCgoKICAgICAgZm9yIChsZXQgZTAgPSAwOyBlMCAhPT0gaHVsbEEudW5pcXVlRWRnZXMubGVuZ3RoOyBlMCsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIGVkZ2UKICAgICAgICBxdWF0QS52bXVsdChodWxsQS51bmlxdWVFZGdlc1tlMF0sIHdvcmxkRWRnZTApOwoKICAgICAgICBmb3IgKGxldCBlMSA9IDA7IGUxICE9PSBodWxsQi51bmlxdWVFZGdlcy5sZW5ndGg7IGUxKyspIHsKICAgICAgICAgIC8vIEdldCB3b3JsZCBlZGdlIDIKICAgICAgICAgIHF1YXRCLnZtdWx0KGh1bGxCLnVuaXF1ZUVkZ2VzW2UxXSwgd29ybGRFZGdlMSk7CiAgICAgICAgICB3b3JsZEVkZ2UwLmNyb3NzKHdvcmxkRWRnZTEsIENyb3NzKTsKCiAgICAgICAgICBpZiAoIUNyb3NzLmFsbW9zdFplcm8oKSkgewogICAgICAgICAgICBDcm9zcy5ub3JtYWxpemUoKTsKICAgICAgICAgICAgY29uc3QgZGlzdCA9IGh1bGxBLnRlc3RTZXBBeGlzKENyb3NzLCBodWxsQiwgcG9zQSwgcXVhdEEsIHBvc0IsIHF1YXRCKTsKCiAgICAgICAgICAgIGlmIChkaXN0ID09PSBmYWxzZSkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGRpc3QgPCBkbWluKSB7CiAgICAgICAgICAgICAgZG1pbiA9IGRpc3Q7CiAgICAgICAgICAgICAgdGFyZ2V0LmNvcHkoQ3Jvc3MpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBwb3NCLnZzdWIocG9zQSwgZGVsdGFDKTsKCiAgICAgIGlmIChkZWx0YUMuZG90KHRhcmdldCkgPiAwLjApIHsKICAgICAgICB0YXJnZXQubmVnYXRlKHRhcmdldCk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBUZXN0IHNlcGFyYXRpbmcgYXhpcyBhZ2FpbnN0IHR3byBodWxscy4gQm90aCBodWxscyBhcmUgcHJvamVjdGVkIG9udG8gdGhlIGF4aXMgYW5kIHRoZSBvdmVybGFwIHNpemUgaXMgcmV0dXJuZWQgaWYgdGhlcmUgaXMgb25lLgogICAgICogQHJldHVybiBUaGUgb3ZlcmxhcCBkZXB0aCwgb3IgRkFMU0UgaWYgbm8gcGVuZXRyYXRpb24uCiAgICAgKi8KCgogICAgdGVzdFNlcEF4aXMoYXhpcywgaHVsbEIsIHBvc0EsIHF1YXRBLCBwb3NCLCBxdWF0QikgewogICAgICBjb25zdCBodWxsQSA9IHRoaXM7CiAgICAgIENvbnZleFBvbHloZWRyb24ucHJvamVjdChodWxsQSwgYXhpcywgcG9zQSwgcXVhdEEsIG1heG1pbkEpOwogICAgICBDb252ZXhQb2x5aGVkcm9uLnByb2plY3QoaHVsbEIsIGF4aXMsIHBvc0IsIHF1YXRCLCBtYXhtaW5CKTsKICAgICAgY29uc3QgbWF4QSA9IG1heG1pbkFbMF07CiAgICAgIGNvbnN0IG1pbkEgPSBtYXhtaW5BWzFdOwogICAgICBjb25zdCBtYXhCID0gbWF4bWluQlswXTsKICAgICAgY29uc3QgbWluQiA9IG1heG1pbkJbMV07CgogICAgICBpZiAobWF4QSA8IG1pbkIgfHwgbWF4QiA8IG1pbkEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIFNlcGFyYXRlZAogICAgICB9CgogICAgICBjb25zdCBkMCA9IG1heEEgLSBtaW5COwogICAgICBjb25zdCBkMSA9IG1heEIgLSBtaW5BOwogICAgICBjb25zdCBkZXB0aCA9IGQwIDwgZDEgPyBkMCA6IGQxOwogICAgICByZXR1cm4gZGVwdGg7CiAgICB9CiAgICAvKioKICAgICAqIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYQogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQpIHsKICAgICAgLy8gQXBwcm94aW1hdGUgd2l0aCBib3ggaW5lcnRpYQogICAgICAvLyBFeGFjdCBpbmVydGlhIGNhbGN1bGF0aW9uIGlzIG92ZXJraWxsLCBidXQgc2VlIGh0dHA6Ly9nZW9tZXRyaWN0b29scy5jb20vRG9jdW1lbnRhdGlvbi9Qb2x5aGVkcmFsTWFzc1Byb3BlcnRpZXMucGRmIGZvciB0aGUgY29ycmVjdCB3YXkgdG8gZG8gaXQKICAgICAgY29uc3QgYWFiYm1heCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGFhYmJtaW4gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoYWFiYm1pbiwgYWFiYm1heCk7CiAgICAgIGNvbnN0IHggPSBhYWJibWF4LnggLSBhYWJibWluLng7CiAgICAgIGNvbnN0IHkgPSBhYWJibWF4LnkgLSBhYWJibWluLnk7CiAgICAgIGNvbnN0IHogPSBhYWJibWF4LnogLSBhYWJibWluLno7CiAgICAgIHRhcmdldC54ID0gMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB6ICogMiAqIHopOwogICAgICB0YXJnZXQueSA9IDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHggKiAyICogeCk7CiAgICB9CiAgICAvKioKICAgICAqIEBwYXJhbSBmYWNlX2kgSW5kZXggb2YgdGhlIGZhY2UKICAgICAqLwoKCiAgICBnZXRQbGFuZUNvbnN0YW50T2ZGYWNlKGZhY2VfaSkgewogICAgICBjb25zdCBmID0gdGhpcy5mYWNlc1tmYWNlX2ldOwogICAgICBjb25zdCBuID0gdGhpcy5mYWNlTm9ybWFsc1tmYWNlX2ldOwogICAgICBjb25zdCB2ID0gdGhpcy52ZXJ0aWNlc1tmWzBdXTsKICAgICAgY29uc3QgYyA9IC1uLmRvdCh2KTsKICAgICAgcmV0dXJuIGM7CiAgICB9CiAgICAvKioKICAgICAqIENsaXAgYSBmYWNlIGFnYWluc3QgYSBodWxsLgogICAgICogQHBhcmFtIHdvcmxkVmVydHNCMSBBbiBhcnJheSBvZiBWZWMzIHdpdGggdmVydGljZXMgaW4gdGhlIHdvcmxkIGZyYW1lLgogICAgICogQHBhcmFtIG1pbkRpc3QgRGlzdGFuY2UgY2xhbXBpbmcKICAgICAqIEBwYXJhbSBBcnJheSByZXN1bHQgQXJyYXkgdG8gc3RvcmUgcmVzdWx0aW5nIGNvbnRhY3QgcG9pbnRzIGluLiBXaWxsIGJlIG9iamVjdHMgd2l0aCBwcm9wZXJ0aWVzOiBwb2ludCwgZGVwdGgsIG5vcm1hbC4gVGhlc2UgYXJlIHJlcHJlc2VudGVkIGluIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICovCgoKICAgIGNsaXBGYWNlQWdhaW5zdEh1bGwoc2VwYXJhdGluZ05vcm1hbCwgcG9zQSwgcXVhdEEsIHdvcmxkVmVydHNCMSwgbWluRGlzdCwgbWF4RGlzdCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IGZhY2VBTm9ybWFsV1MgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBlZGdlMCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IFdvcmxkRWRnZTAgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCB3b3JsZFBsYW5lQW5vcm1hbDEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBwbGFuZU5vcm1hbFdTMSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHdvcmxkQTEgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBsb2NhbFBsYW5lTm9ybWFsID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGxhbmVOb3JtYWxXUyA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGh1bGxBID0gdGhpczsKICAgICAgY29uc3Qgd29ybGRWZXJ0c0IyID0gW107CiAgICAgIGNvbnN0IHBWdHhJbiA9IHdvcmxkVmVydHNCMTsKICAgICAgY29uc3QgcFZ0eE91dCA9IHdvcmxkVmVydHNCMjsKICAgICAgbGV0IGNsb3Nlc3RGYWNlQSA9IC0xOwogICAgICBsZXQgZG1pbiA9IE51bWJlci5NQVhfVkFMVUU7IC8vIEZpbmQgdGhlIGZhY2Ugd2l0aCBub3JtYWwgY2xvc2VzdCB0byB0aGUgc2VwYXJhdGluZyBheGlzCgogICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IGh1bGxBLmZhY2VzLmxlbmd0aDsgZmFjZSsrKSB7CiAgICAgICAgZmFjZUFOb3JtYWxXUy5jb3B5KGh1bGxBLmZhY2VOb3JtYWxzW2ZhY2VdKTsKICAgICAgICBxdWF0QS52bXVsdChmYWNlQU5vcm1hbFdTLCBmYWNlQU5vcm1hbFdTKTsKICAgICAgICBjb25zdCBkID0gZmFjZUFOb3JtYWxXUy5kb3Qoc2VwYXJhdGluZ05vcm1hbCk7CgogICAgICAgIGlmIChkIDwgZG1pbikgewogICAgICAgICAgZG1pbiA9IGQ7CiAgICAgICAgICBjbG9zZXN0RmFjZUEgPSBmYWNlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGNsb3Nlc3RGYWNlQSA8IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gR2V0IHRoZSBmYWNlIGFuZCBjb25zdHJ1Y3QgY29ubmVjdGVkIGZhY2VzCgoKICAgICAgY29uc3QgcG9seUEgPSBodWxsQS5mYWNlc1tjbG9zZXN0RmFjZUFdOwogICAgICBwb2x5QS5jb25uZWN0ZWRGYWNlcyA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBodWxsQS5mYWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaHVsbEEuZmFjZXNbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGlmICgKICAgICAgICAgIC8qIFNoYXJpbmcgYSB2ZXJ0ZXgqLwogICAgICAgICAgcG9seUEuaW5kZXhPZihodWxsQS5mYWNlc1tpXVtqXSkgIT09IC0xICYmCiAgICAgICAgICAvKiBOb3QgdGhlIG9uZSB3ZSBhcmUgbG9va2luZyBmb3IgY29ubmVjdGlvbnMgZnJvbSAqLwogICAgICAgICAgaSAhPT0gY2xvc2VzdEZhY2VBICYmCiAgICAgICAgICAvKiBOb3QgYWxyZWFkeSBhZGRlZCAqLwogICAgICAgICAgcG9seUEuY29ubmVjdGVkRmFjZXMuaW5kZXhPZihpKSA9PT0gLTEpIHsKICAgICAgICAgICAgcG9seUEuY29ubmVjdGVkRmFjZXMucHVzaChpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8gQ2xpcCB0aGUgcG9seWdvbiB0byB0aGUgYmFjayBvZiB0aGUgcGxhbmVzIG9mIGFsbCBmYWNlcyBvZiBodWxsIEEsCiAgICAgIC8vIHRoYXQgYXJlIGFkamFjZW50IHRvIHRoZSB3aXRuZXNzIGZhY2UKCgogICAgICBjb25zdCBudW1WZXJ0aWNlc0EgPSBwb2x5QS5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVZlcnRpY2VzQTsgaSsrKSB7CiAgICAgICAgY29uc3QgYSA9IGh1bGxBLnZlcnRpY2VzW3BvbHlBW2ldXTsKICAgICAgICBjb25zdCBiID0gaHVsbEEudmVydGljZXNbcG9seUFbKGkgKyAxKSAlIG51bVZlcnRpY2VzQV1dOwogICAgICAgIGEudnN1YihiLCBlZGdlMCk7CiAgICAgICAgV29ybGRFZGdlMC5jb3B5KGVkZ2UwKTsKICAgICAgICBxdWF0QS52bXVsdChXb3JsZEVkZ2UwLCBXb3JsZEVkZ2UwKTsKICAgICAgICBwb3NBLnZhZGQoV29ybGRFZGdlMCwgV29ybGRFZGdlMCk7CiAgICAgICAgd29ybGRQbGFuZUFub3JtYWwxLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tjbG9zZXN0RmFjZUFdKTsKICAgICAgICBxdWF0QS52bXVsdCh3b3JsZFBsYW5lQW5vcm1hbDEsIHdvcmxkUGxhbmVBbm9ybWFsMSk7CiAgICAgICAgcG9zQS52YWRkKHdvcmxkUGxhbmVBbm9ybWFsMSwgd29ybGRQbGFuZUFub3JtYWwxKTsKICAgICAgICBXb3JsZEVkZ2UwLmNyb3NzKHdvcmxkUGxhbmVBbm9ybWFsMSwgcGxhbmVOb3JtYWxXUzEpOwogICAgICAgIHBsYW5lTm9ybWFsV1MxLm5lZ2F0ZShwbGFuZU5vcm1hbFdTMSk7CiAgICAgICAgd29ybGRBMS5jb3B5KGEpOwogICAgICAgIHF1YXRBLnZtdWx0KHdvcmxkQTEsIHdvcmxkQTEpOwogICAgICAgIHBvc0EudmFkZCh3b3JsZEExLCB3b3JsZEExKTsKICAgICAgICBjb25zdCBvdGhlckZhY2UgPSBwb2x5QS5jb25uZWN0ZWRGYWNlc1tpXTsKICAgICAgICBsb2NhbFBsYW5lTm9ybWFsLmNvcHkodGhpcy5mYWNlTm9ybWFsc1tvdGhlckZhY2VdKTsKICAgICAgICBjb25zdCBsb2NhbFBsYW5lRXEgPSB0aGlzLmdldFBsYW5lQ29uc3RhbnRPZkZhY2Uob3RoZXJGYWNlKTsKICAgICAgICBwbGFuZU5vcm1hbFdTLmNvcHkobG9jYWxQbGFuZU5vcm1hbCk7CiAgICAgICAgcXVhdEEudm11bHQocGxhbmVOb3JtYWxXUywgcGxhbmVOb3JtYWxXUyk7CiAgICAgICAgY29uc3QgcGxhbmVFcVdTID0gbG9jYWxQbGFuZUVxIC0gcGxhbmVOb3JtYWxXUy5kb3QocG9zQSk7IC8vIENsaXAgZmFjZSBhZ2FpbnN0IG91ciBjb25zdHJ1Y3RlZCBwbGFuZQoKICAgICAgICB0aGlzLmNsaXBGYWNlQWdhaW5zdFBsYW5lKHBWdHhJbiwgcFZ0eE91dCwgcGxhbmVOb3JtYWxXUywgcGxhbmVFcVdTKTsgLy8gVGhyb3cgYXdheSBhbGwgY2xpcHBlZCBwb2ludHMsIGJ1dCBzYXZlIHRoZSByZW1haW5pbmcgdW50aWwgbmV4dCBjbGlwCgogICAgICAgIHdoaWxlIChwVnR4SW4ubGVuZ3RoKSB7CiAgICAgICAgICBwVnR4SW4uc2hpZnQoKTsKICAgICAgICB9CgogICAgICAgIHdoaWxlIChwVnR4T3V0Lmxlbmd0aCkgewogICAgICAgICAgcFZ0eEluLnB1c2gocFZ0eE91dC5zaGlmdCgpKTsKICAgICAgICB9CiAgICAgIH0gLy8gb25seSBrZWVwIGNvbnRhY3QgcG9pbnRzIHRoYXQgYXJlIGJlaGluZCB0aGUgd2l0bmVzcyBmYWNlCgoKICAgICAgbG9jYWxQbGFuZU5vcm1hbC5jb3B5KHRoaXMuZmFjZU5vcm1hbHNbY2xvc2VzdEZhY2VBXSk7CiAgICAgIGNvbnN0IGxvY2FsUGxhbmVFcSA9IHRoaXMuZ2V0UGxhbmVDb25zdGFudE9mRmFjZShjbG9zZXN0RmFjZUEpOwogICAgICBwbGFuZU5vcm1hbFdTLmNvcHkobG9jYWxQbGFuZU5vcm1hbCk7CiAgICAgIHF1YXRBLnZtdWx0KHBsYW5lTm9ybWFsV1MsIHBsYW5lTm9ybWFsV1MpOwogICAgICBjb25zdCBwbGFuZUVxV1MgPSBsb2NhbFBsYW5lRXEgLSBwbGFuZU5vcm1hbFdTLmRvdChwb3NBKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcFZ0eEluLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgbGV0IGRlcHRoID0gcGxhbmVOb3JtYWxXUy5kb3QocFZ0eEluW2ldKSArIHBsYW5lRXFXUzsgLy8gPz8/CgogICAgICAgIGlmIChkZXB0aCA8PSBtaW5EaXN0KSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiY2xhbXBlZDogZGVwdGg9IiArIGRlcHRoICsgIiB0byBtaW5EaXN0PSIgKyBtaW5EaXN0KTsKICAgICAgICAgIGRlcHRoID0gbWluRGlzdDsKICAgICAgICB9CgogICAgICAgIGlmIChkZXB0aCA8PSBtYXhEaXN0KSB7CiAgICAgICAgICBjb25zdCBwb2ludCA9IHBWdHhJbltpXTsKCiAgICAgICAgICBpZiAoZGVwdGggPD0gMWUtNikgewogICAgICAgICAgICBjb25zdCBwID0gewogICAgICAgICAgICAgIHBvaW50LAogICAgICAgICAgICAgIG5vcm1hbDogcGxhbmVOb3JtYWxXUywKICAgICAgICAgICAgICBkZXB0aAogICAgICAgICAgICB9OwogICAgICAgICAgICByZXN1bHQucHVzaChwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogQ2xpcCBhIGZhY2UgaW4gYSBodWxsIGFnYWluc3QgdGhlIGJhY2sgb2YgYSBwbGFuZS4KICAgICAqIEBwYXJhbSBwbGFuZUNvbnN0YW50IFRoZSBjb25zdGFudCBpbiB0aGUgbWF0aGVtYXRpY2FsIHBsYW5lIGVxdWF0aW9uCiAgICAgKi8KCgogICAgY2xpcEZhY2VBZ2FpbnN0UGxhbmUoaW5WZXJ0aWNlcywgb3V0VmVydGljZXMsIHBsYW5lTm9ybWFsLCBwbGFuZUNvbnN0YW50KSB7CiAgICAgIGxldCBuX2RvdF9maXJzdDsKICAgICAgbGV0IG5fZG90X2xhc3Q7CiAgICAgIGNvbnN0IG51bVZlcnRzID0gaW5WZXJ0aWNlcy5sZW5ndGg7CgogICAgICBpZiAobnVtVmVydHMgPCAyKSB7CiAgICAgICAgcmV0dXJuIG91dFZlcnRpY2VzOwogICAgICB9CgogICAgICBsZXQgZmlyc3RWZXJ0ZXggPSBpblZlcnRpY2VzW2luVmVydGljZXMubGVuZ3RoIC0gMV07CiAgICAgIGxldCBsYXN0VmVydGV4ID0gaW5WZXJ0aWNlc1swXTsKICAgICAgbl9kb3RfZmlyc3QgPSBwbGFuZU5vcm1hbC5kb3QoZmlyc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgIGZvciAobGV0IHZpID0gMDsgdmkgPCBudW1WZXJ0czsgdmkrKykgewogICAgICAgIGxhc3RWZXJ0ZXggPSBpblZlcnRpY2VzW3ZpXTsKICAgICAgICBuX2RvdF9sYXN0ID0gcGxhbmVOb3JtYWwuZG90KGxhc3RWZXJ0ZXgpICsgcGxhbmVDb25zdGFudDsKCiAgICAgICAgaWYgKG5fZG90X2ZpcnN0IDwgMCkgewogICAgICAgICAgaWYgKG5fZG90X2xhc3QgPCAwKSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kIDwgMCwgc28gb3V0cHV0IGxhc3RWZXJ0ZXgKICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIG5ld3YuY29weShsYXN0VmVydGV4KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIFN0YXJ0IDwgMCwgZW5kID49IDAsIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24KICAgICAgICAgICAgY29uc3QgbmV3diA9IG5ldyBWZWMzKCk7CiAgICAgICAgICAgIGZpcnN0VmVydGV4LmxlcnAobGFzdFZlcnRleCwgbl9kb3RfZmlyc3QgLyAobl9kb3RfZmlyc3QgLSBuX2RvdF9sYXN0KSwgbmV3dik7CiAgICAgICAgICAgIG91dFZlcnRpY2VzLnB1c2gobmV3dik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChuX2RvdF9sYXN0IDwgMCkgewogICAgICAgICAgICAvLyBTdGFydCA+PSAwLCBlbmQgPCAwIHNvIG91dHB1dCBpbnRlcnNlY3Rpb24gYW5kIGVuZAogICAgICAgICAgICBjb25zdCBuZXd2ID0gbmV3IFZlYzMoKTsKICAgICAgICAgICAgZmlyc3RWZXJ0ZXgubGVycChsYXN0VmVydGV4LCBuX2RvdF9maXJzdCAvIChuX2RvdF9maXJzdCAtIG5fZG90X2xhc3QpLCBuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChuZXd2KTsKICAgICAgICAgICAgb3V0VmVydGljZXMucHVzaChsYXN0VmVydGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZpcnN0VmVydGV4ID0gbGFzdFZlcnRleDsKICAgICAgICBuX2RvdF9maXJzdCA9IG5fZG90X2xhc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXRWZXJ0aWNlczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgLndvcmxkVmVydGljZXNgIGFuZCBzZXRzIGAud29ybGRWZXJ0aWNlc05lZWRzVXBkYXRlYCB0byBmYWxzZS4KICAgICAqLwoKCiAgICBjb21wdXRlV29ybGRWZXJ0aWNlcyhwb3NpdGlvbiwgcXVhdCkgewogICAgICB3aGlsZSAodGhpcy53b3JsZFZlcnRpY2VzLmxlbmd0aCA8IHRoaXMudmVydGljZXMubGVuZ3RoKSB7CiAgICAgICAgdGhpcy53b3JsZFZlcnRpY2VzLnB1c2gobmV3IFZlYzMoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3Qgd29ybGRWZXJ0cyA9IHRoaXMud29ybGRWZXJ0aWNlczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSB0aGlzLnZlcnRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcXVhdC52bXVsdCh2ZXJ0c1tpXSwgd29ybGRWZXJ0c1tpXSk7CiAgICAgICAgcG9zaXRpb24udmFkZCh3b3JsZFZlcnRzW2ldLCB3b3JsZFZlcnRzW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmJtaW4sIGFhYmJtYXgpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBhYWJibWluLnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgYWFiYm1heC5zZXQoLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFLCAtTnVtYmVyLk1BWF9WQUxVRSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gdmVydGljZXNbaV07CgogICAgICAgIGlmICh2LnggPCBhYWJibWluLngpIHsKICAgICAgICAgIGFhYmJtaW4ueCA9IHYueDsKICAgICAgICB9IGVsc2UgaWYgKHYueCA+IGFhYmJtYXgueCkgewogICAgICAgICAgYWFiYm1heC54ID0gdi54OwogICAgICAgIH0KCiAgICAgICAgaWYgKHYueSA8IGFhYmJtaW4ueSkgewogICAgICAgICAgYWFiYm1pbi55ID0gdi55OwogICAgICAgIH0gZWxzZSBpZiAodi55ID4gYWFiYm1heC55KSB7CiAgICAgICAgICBhYWJibWF4LnkgPSB2Lnk7CiAgICAgICAgfQoKICAgICAgICBpZiAodi56IDwgYWFiYm1pbi56KSB7CiAgICAgICAgICBhYWJibWluLnogPSB2Lno7CiAgICAgICAgfSBlbHNlIGlmICh2LnogPiBhYWJibWF4LnopIHsKICAgICAgICAgIGFhYmJtYXgueiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyBgd29ybGRWZXJ0aWNlc2AgYW5kIHNldHMgYHdvcmxkVmVydGljZXNOZWVkc1VwZGF0ZWAgdG8gZmFsc2UuCiAgICAgKi8KCgogICAgY29tcHV0ZVdvcmxkRmFjZU5vcm1hbHMocXVhdCkgewogICAgICBjb25zdCBOID0gdGhpcy5mYWNlTm9ybWFscy5sZW5ndGg7CgogICAgICB3aGlsZSAodGhpcy53b3JsZEZhY2VOb3JtYWxzLmxlbmd0aCA8IE4pIHsKICAgICAgICB0aGlzLndvcmxkRmFjZU5vcm1hbHMucHVzaChuZXcgVmVjMygpKTsKICAgICAgfQoKICAgICAgY29uc3Qgbm9ybWFscyA9IHRoaXMuZmFjZU5vcm1hbHM7CiAgICAgIGNvbnN0IHdvcmxkTm9ybWFscyA9IHRoaXMud29ybGRGYWNlTm9ybWFsczsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBxdWF0LnZtdWx0KG5vcm1hbHNbaV0sIHdvcmxkTm9ybWFsc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBub3JtMiA9IHZlcnRzW2ldLmxlbmd0aFNxdWFyZWQoKTsKCiAgICAgICAgaWYgKG5vcm0yID4gbWF4MikgewogICAgICAgICAgbWF4MiA9IG5vcm0yOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IE1hdGguc3FydChtYXgyKTsKICAgIH0KICAgIC8qKgogICAgICogY2FsY3VsYXRlV29ybGRBQUJCCiAgICAgKi8KCgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgY29uc3QgdmVydHMgPSB0aGlzLnZlcnRpY2VzOwogICAgICBsZXQgbWlueDsKICAgICAgbGV0IG1pbnk7CiAgICAgIGxldCBtaW56OwogICAgICBsZXQgbWF4eDsKICAgICAgbGV0IG1heHk7CiAgICAgIGxldCBtYXh6OwogICAgICBsZXQgdGVtcFdvcmxkVmVydGV4ID0gbmV3IFZlYzMoKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmVydHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB0ZW1wV29ybGRWZXJ0ZXguY29weSh2ZXJ0c1tpXSk7CiAgICAgICAgcXVhdC52bXVsdCh0ZW1wV29ybGRWZXJ0ZXgsIHRlbXBXb3JsZFZlcnRleCk7CiAgICAgICAgcG9zLnZhZGQodGVtcFdvcmxkVmVydGV4LCB0ZW1wV29ybGRWZXJ0ZXgpOwogICAgICAgIGNvbnN0IHYgPSB0ZW1wV29ybGRWZXJ0ZXg7CgogICAgICAgIGlmIChtaW54ID09PSB1bmRlZmluZWQgfHwgdi54IDwgbWlueCkgewogICAgICAgICAgbWlueCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh4ID09PSB1bmRlZmluZWQgfHwgdi54ID4gbWF4eCkgewogICAgICAgICAgbWF4eCA9IHYueDsKICAgICAgICB9CgogICAgICAgIGlmIChtaW55ID09PSB1bmRlZmluZWQgfHwgdi55IDwgbWlueSkgewogICAgICAgICAgbWlueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh5ID09PSB1bmRlZmluZWQgfHwgdi55ID4gbWF4eSkgewogICAgICAgICAgbWF4eSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmIChtaW56ID09PSB1bmRlZmluZWQgfHwgdi56IDwgbWlueikgewogICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICB9CgogICAgICAgIGlmIChtYXh6ID09PSB1bmRlZmluZWQgfHwgdi56ID4gbWF4eikgewogICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbi5zZXQobWlueCwgbWlueSwgbWlueik7CiAgICAgIG1heC5zZXQobWF4eCwgbWF4eSwgbWF4eik7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSBjb252ZXggdm9sdW1lCiAgICAgKi8KCgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gNC4wICogTWF0aC5QSSAqIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgLyAzLjA7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBhdmVyYWdlIG9mIGFsbCB0aGUgdmVydGljZXMgcG9zaXRpb25zCiAgICAgKi8KCgogICAgZ2V0QXZlcmFnZVBvaW50TG9jYWwodGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZlcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGFyZ2V0LnZhZGQodmVydHNbaV0sIHRhcmdldCk7CiAgICAgIH0KCiAgICAgIHRhcmdldC5zY2FsZSgxIC8gdmVydHMubGVuZ3RoLCB0YXJnZXQpOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQogICAgLyoqCiAgICAgKiBUcmFuc2Zvcm0gYWxsIGxvY2FsIHBvaW50cy4gV2lsbCBjaGFuZ2UgdGhlIC52ZXJ0aWNlcwogICAgICovCgoKICAgIHRyYW5zZm9ybUFsbFBvaW50cyhvZmZzZXQsIHF1YXQpIHsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICBjb25zdCB2ZXJ0cyA9IHRoaXMudmVydGljZXM7IC8vIEFwcGx5IHJvdGF0aW9uCgogICAgICBpZiAocXVhdCkgewogICAgICAgIC8vIFJvdGF0ZSB2ZXJ0aWNlcwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdmVydHNbaV07CiAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgIH0gLy8gUm90YXRlIGZhY2Ugbm9ybWFscwoKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZhY2VOb3JtYWxzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBjb25zdCB2ID0gdGhpcy5mYWNlTm9ybWFsc1tpXTsKICAgICAgICAgIHF1YXQudm11bHQodiwgdik7CiAgICAgICAgfQogICAgICAgIC8qCiAgICAgICAgICAgICAgLy8gUm90YXRlIGVkZ2VzCiAgICAgICAgICAgICAgZm9yKGxldCBpPTA7IGk8dGhpcy51bmlxdWVFZGdlcy5sZW5ndGg7IGkrKyl7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHYgPSB0aGlzLnVuaXF1ZUVkZ2VzW2ldOwogICAgICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsdik7CiAgICAgICAgICAgICAgfSovCgogICAgICB9IC8vIEFwcGx5IG9mZnNldAoKCiAgICAgIGlmIChvZmZzZXQpIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ldOwogICAgICAgICAgdi52YWRkKG9mZnNldCwgdik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrcyB3aGV0aGVyIHAgaXMgaW5zaWRlIHRoZSBwb2x5aGVkcmEuIE11c3QgYmUgaW4gbG9jYWwgY29vcmRzLgogICAgICogVGhlIHBvaW50IGxpZXMgb3V0c2lkZSBvZiB0aGUgY29udmV4IGh1bGwgb2YgdGhlIG90aGVyIHBvaW50cyBpZiBhbmQgb25seSBpZiB0aGUgZGlyZWN0aW9uCiAgICAgKiBvZiBhbGwgdGhlIHZlY3RvcnMgZnJvbSBpdCB0byB0aG9zZSBvdGhlciBwb2ludHMgYXJlIG9uIGxlc3MgdGhhbiBvbmUgaGFsZiBvZiBhIHNwaGVyZSBhcm91bmQgaXQuCiAgICAgKiBAcGFyYW0gcCBBIHBvaW50IGdpdmVuIGluIGxvY2FsIGNvb3JkaW5hdGVzCiAgICAgKi8KCgogICAgcG9pbnRJc0luc2lkZShwKSB7CiAgICAgIGNvbnN0IHZlcnRzID0gdGhpcy52ZXJ0aWNlczsKICAgICAgY29uc3QgZmFjZXMgPSB0aGlzLmZhY2VzOwogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5mYWNlTm9ybWFsczsKICAgICAgY29uc3QgcG9pbnRJbnNpZGUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldEF2ZXJhZ2VQb2ludExvY2FsKHBvaW50SW5zaWRlKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mYWNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBuID0gbm9ybWFsc1tpXTsKICAgICAgICBjb25zdCB2ID0gdmVydHNbZmFjZXNbaV1bMF1dOyAvLyBXZSBvbmx5IG5lZWQgb25lIHBvaW50IGluIHRoZSBmYWNlCiAgICAgICAgLy8gVGhpcyBkb3QgcHJvZHVjdCBkZXRlcm1pbmVzIHdoaWNoIHNpZGUgb2YgdGhlIGVkZ2UgdGhlIHBvaW50IGlzCgogICAgICAgIGNvbnN0IHZUb1AgPSBuZXcgVmVjMygpOwogICAgICAgIHAudnN1Yih2LCB2VG9QKTsKICAgICAgICBjb25zdCByMSA9IG4uZG90KHZUb1ApOwogICAgICAgIGNvbnN0IHZUb1BvaW50SW5zaWRlID0gbmV3IFZlYzMoKTsKICAgICAgICBwb2ludEluc2lkZS52c3ViKHYsIHZUb1BvaW50SW5zaWRlKTsKICAgICAgICBjb25zdCByMiA9IG4uZG90KHZUb1BvaW50SW5zaWRlKTsKCiAgICAgICAgaWYgKHIxIDwgMCAmJiByMiA+IDAgfHwgcjEgPiAwICYmIHIyIDwgMCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBFbmNvdW50ZXJlZCBzb21lIG90aGVyIHNpZ24uIEV4aXQuCiAgICAgICAgfQogICAgICB9IC8vIElmIHdlIGdvdCBoZXJlLCBhbGwgZG90IHByb2R1Y3RzIHdlcmUgb2YgdGhlIHNhbWUgc2lnbi4KCgogICAgICByZXR1cm4gLTE7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBtYXggYW5kIG1pbiBkb3QgcHJvZHVjdCBvZiBhIGNvbnZleCBodWxsIGF0IHBvc2l0aW9uIChwb3MscXVhdCkgcHJvamVjdGVkIG9udG8gYW4gYXhpcy4KICAgICAqIFJlc3VsdHMgYXJlIHNhdmVkIGluIHRoZSBhcnJheSBtYXhtaW4uCiAgICAgKiBAcGFyYW0gcmVzdWx0IHJlc3VsdFswXSBhbmQgcmVzdWx0WzFdIHdpbGwgYmUgc2V0IHRvIG1heGltdW0gYW5kIG1pbmltdW0sIHJlc3BlY3RpdmVseS4KICAgICAqLwoKCiAgICBzdGF0aWMgcHJvamVjdChzaGFwZSwgYXhpcywgcG9zLCBxdWF0LCByZXN1bHQpIHsKICAgICAgY29uc3QgbiA9IHNoYXBlLnZlcnRpY2VzLmxlbmd0aDsKICAgICAgY29uc3QgbG9jYWxBeGlzID0gcHJvamVjdF9sb2NhbEF4aXM7CiAgICAgIGxldCBtYXggPSAwOwogICAgICBsZXQgbWluID0gMDsKICAgICAgY29uc3QgbG9jYWxPcmlnaW4gPSBwcm9qZWN0X2xvY2FsT3JpZ2luOwogICAgICBjb25zdCB2cyA9IHNoYXBlLnZlcnRpY2VzOwogICAgICBsb2NhbE9yaWdpbi5zZXRaZXJvKCk7IC8vIFRyYW5zZm9ybSB0aGUgYXhpcyB0byBsb2NhbAoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3MsIHF1YXQsIGF4aXMsIGxvY2FsQXhpcyk7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3MsIHF1YXQsIGxvY2FsT3JpZ2luLCBsb2NhbE9yaWdpbik7CiAgICAgIGNvbnN0IGFkZCA9IGxvY2FsT3JpZ2luLmRvdChsb2NhbEF4aXMpOwogICAgICBtaW4gPSBtYXggPSB2c1swXS5kb3QobG9jYWxBeGlzKTsKCiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgY29uc3QgdmFsID0gdnNbaV0uZG90KGxvY2FsQXhpcyk7CgogICAgICAgIGlmICh2YWwgPiBtYXgpIHsKICAgICAgICAgIG1heCA9IHZhbDsKICAgICAgICB9CgogICAgICAgIGlmICh2YWwgPCBtaW4pIHsKICAgICAgICAgIG1pbiA9IHZhbDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1pbiAtPSBhZGQ7CiAgICAgIG1heCAtPSBhZGQ7CgogICAgICBpZiAobWluID4gbWF4KSB7CiAgICAgICAgLy8gSW5jb25zaXN0ZW50IC0gc3dhcAogICAgICAgIGNvbnN0IHRlbXAgPSBtaW47CiAgICAgICAgbWluID0gbWF4OwogICAgICAgIG1heCA9IHRlbXA7CiAgICAgIH0gLy8gT3V0cHV0CgoKICAgICAgcmVzdWx0WzBdID0gbWF4OwogICAgICByZXN1bHRbMV0gPSBtaW47CiAgICB9CgogIH0KCiAgY29uc3QgbWF4bWluQSA9IFtdOwogIGNvbnN0IG1heG1pbkIgPSBbXTsKICBjb25zdCBwcm9qZWN0X2xvY2FsQXhpcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcHJvamVjdF9sb2NhbE9yaWdpbiA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQSAzZCBib3ggc2hhcGUuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc2l6ZSA9IDEKICAgKiAgICAgY29uc3QgaGFsZkV4dGVudHMgPSBuZXcgQ0FOTk9OLlZlYzMoc2l6ZSwgc2l6ZSwgc2l6ZSkKICAgKiAgICAgY29uc3QgYm94U2hhcGUgPSBuZXcgQ0FOTk9OLkJveChoYWxmRXh0ZW50cykKICAgKiAgICAgY29uc3QgYm94Qm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBib3hTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJveEJvZHkpCiAgICovCgogIGNsYXNzIEJveCBleHRlbmRzIFNoYXBlIHsKICAgIC8qKgogICAgICogVGhlIGhhbGYgZXh0ZW50cyBvZiB0aGUgYm94LgogICAgICovCgogICAgLyoqCiAgICAgKiBVc2VkIGJ5IHRoZSBjb250YWN0IGdlbmVyYXRvciB0byBtYWtlIGNvbnRhY3RzIHdpdGggb3RoZXIgY29udmV4IHBvbHloZWRyYSBmb3IgZXhhbXBsZS4KICAgICAqLwogICAgY29uc3RydWN0b3IoaGFsZkV4dGVudHMpIHsKICAgICAgc3VwZXIoewogICAgICAgIHR5cGU6IFNoYXBlLnR5cGVzLkJPWAogICAgICB9KTsKICAgICAgdGhpcy5oYWxmRXh0ZW50cyA9IHZvaWQgMDsKICAgICAgdGhpcy5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaGFsZkV4dGVudHMgPSBoYWxmRXh0ZW50czsKICAgICAgdGhpcy5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24gPSBudWxsOwogICAgICB0aGlzLnVwZGF0ZUNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbigpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZXMgdGhlIGxvY2FsIGNvbnZleCBwb2x5aGVkcm9uIHJlcHJlc2VudGF0aW9uIHVzZWQgZm9yIHNvbWUgY29sbGlzaW9ucy4KICAgICAqLwoKCiAgICB1cGRhdGVDb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24oKSB7CiAgICAgIGNvbnN0IHN4ID0gdGhpcy5oYWxmRXh0ZW50cy54OwogICAgICBjb25zdCBzeSA9IHRoaXMuaGFsZkV4dGVudHMueTsKICAgICAgY29uc3Qgc3ogPSB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICAgIGNvbnN0IFYgPSBWZWMzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IFtuZXcgVigtc3gsIC1zeSwgLXN6KSwgbmV3IFYoc3gsIC1zeSwgLXN6KSwgbmV3IFYoc3gsIHN5LCAtc3opLCBuZXcgVigtc3gsIHN5LCAtc3opLCBuZXcgVigtc3gsIC1zeSwgc3opLCBuZXcgVihzeCwgLXN5LCBzeiksIG5ldyBWKHN4LCBzeSwgc3opLCBuZXcgVigtc3gsIHN5LCBzeildOwogICAgICBjb25zdCBmYWNlcyA9IFtbMywgMiwgMSwgMF0sIC8vIC16CiAgICAgIFs0LCA1LCA2LCA3XSwgLy8gK3oKICAgICAgWzUsIDQsIDAsIDFdLCAvLyAteQogICAgICBbMiwgMywgNywgNl0sIC8vICt5CiAgICAgIFswLCA0LCA3LCAzXSwgLy8gLXgKICAgICAgWzEsIDIsIDYsIDVdIC8vICt4CiAgICAgIF07CiAgICAgIGNvbnN0IGF4ZXMgPSBbbmV3IFYoMCwgMCwgMSksIG5ldyBWKDAsIDEsIDApLCBuZXcgVigxLCAwLCAwKV07CiAgICAgIGNvbnN0IGggPSBuZXcgQ29udmV4UG9seWhlZHJvbih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24gPSBoOwogICAgICBoLm1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbDsKICAgIH0KICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHRoZSBpbmVydGlhIG9mIHRoZSBib3guCiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCA9IG5ldyBWZWMzKCkpIHsKICAgICAgQm94LmNhbGN1bGF0ZUluZXJ0aWEodGhpcy5oYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KTsKICAgICAgcmV0dXJuIHRhcmdldDsKICAgIH0KCiAgICBzdGF0aWMgY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgbWFzcywgdGFyZ2V0KSB7CiAgICAgIGNvbnN0IGUgPSBoYWxmRXh0ZW50czsKICAgICAgdGFyZ2V0LnggPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnkgPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS54ICogMiAqIGUueCArIDIgKiBlLnogKiAyICogZS56KTsKICAgICAgdGFyZ2V0LnogPSAxLjAgLyAxMi4wICogbWFzcyAqICgyICogZS55ICogMiAqIGUueSArIDIgKiBlLnggKiAyICogZS54KTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBib3ggNiBzaWRlIG5vcm1hbHMKICAgICAqIEBwYXJhbSBzaXhUYXJnZXRWZWN0b3JzIEFuIGFycmF5IG9mIDYgdmVjdG9ycywgdG8gc3RvcmUgdGhlIHJlc3VsdGluZyBzaWRlIG5vcm1hbHMgaW4uCiAgICAgKiBAcGFyYW0gcXVhdCBPcmllbnRhdGlvbiB0byBhcHBseSB0byB0aGUgbm9ybWFsIHZlY3RvcnMuIElmIG5vdCBwcm92aWRlZCwgdGhlIHZlY3RvcnMgd2lsbCBiZSBpbiByZXNwZWN0IHRvIHRoZSBsb2NhbCBmcmFtZS4KICAgICAqLwoKCiAgICBnZXRTaWRlTm9ybWFscyhzaXhUYXJnZXRWZWN0b3JzLCBxdWF0KSB7CiAgICAgIGNvbnN0IHNpZGVzID0gc2l4VGFyZ2V0VmVjdG9yczsKICAgICAgY29uc3QgZXggPSB0aGlzLmhhbGZFeHRlbnRzOwogICAgICBzaWRlc1swXS5zZXQoZXgueCwgMCwgMCk7CiAgICAgIHNpZGVzWzFdLnNldCgwLCBleC55LCAwKTsKICAgICAgc2lkZXNbMl0uc2V0KDAsIDAsIGV4LnopOwogICAgICBzaWRlc1szXS5zZXQoLWV4LngsIDAsIDApOwogICAgICBzaWRlc1s0XS5zZXQoMCwgLWV4LnksIDApOwogICAgICBzaWRlc1s1XS5zZXQoMCwgMCwgLWV4LnopOwoKICAgICAgaWYgKHF1YXQgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBzaWRlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgcXVhdC52bXVsdChzaWRlc1tpXSwgc2lkZXNbaV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNpZGVzOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSB2b2x1bWUgb2YgdGhlIGJveC4KICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA4LjAgKiB0aGlzLmhhbGZFeHRlbnRzLnggKiB0aGlzLmhhbGZFeHRlbnRzLnkgKiB0aGlzLmhhbGZFeHRlbnRzLno7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzCiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLmhhbGZFeHRlbnRzLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBmb3JFYWNoV29ybGRDb3JuZXIKICAgICAqLwoKCiAgICBmb3JFYWNoV29ybGRDb3JuZXIocG9zLCBxdWF0LCBjYWxsYmFjaykgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgY29uc3QgY29ybmVycyA9IFtbZS54LCBlLnksIGUuel0sIFstZS54LCBlLnksIGUuel0sIFstZS54LCAtZS55LCBlLnpdLCBbLWUueCwgLWUueSwgLWUuel0sIFtlLngsIC1lLnksIC1lLnpdLCBbZS54LCBlLnksIC1lLnpdLCBbLWUueCwgZS55LCAtZS56XSwgW2UueCwgLWUueSwgZS56XV07CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvcm5lcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICB3b3JsZENvcm5lclRlbXBQb3Muc2V0KGNvcm5lcnNbaV1bMF0sIGNvcm5lcnNbaV1bMV0sIGNvcm5lcnNbaV1bMl0pOwogICAgICAgIHF1YXQudm11bHQod29ybGRDb3JuZXJUZW1wUG9zLCB3b3JsZENvcm5lclRlbXBQb3MpOwogICAgICAgIHBvcy52YWRkKHdvcmxkQ29ybmVyVGVtcFBvcywgd29ybGRDb3JuZXJUZW1wUG9zKTsKICAgICAgICBjYWxsYmFjayh3b3JsZENvcm5lclRlbXBQb3MueCwgd29ybGRDb3JuZXJUZW1wUG9zLnksIHdvcmxkQ29ybmVyVGVtcFBvcy56KTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCBlID0gdGhpcy5oYWxmRXh0ZW50czsKICAgICAgd29ybGRDb3JuZXJzVGVtcFswXS5zZXQoZS54LCBlLnksIGUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbMV0uc2V0KC1lLngsIGUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFsyXS5zZXQoLWUueCwgLWUueSwgZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFszXS5zZXQoLWUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNF0uc2V0KGUueCwgLWUueSwgLWUueik7CiAgICAgIHdvcmxkQ29ybmVyc1RlbXBbNV0uc2V0KGUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs2XS5zZXQoLWUueCwgZS55LCAtZS56KTsKICAgICAgd29ybGRDb3JuZXJzVGVtcFs3XS5zZXQoZS54LCAtZS55LCBlLnopOwogICAgICBjb25zdCB3YyA9IHdvcmxkQ29ybmVyc1RlbXBbMF07CiAgICAgIHF1YXQudm11bHQod2MsIHdjKTsKICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgbWF4LmNvcHkod2MpOwogICAgICBtaW4uY29weSh3Yyk7CgogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IDg7IGkrKykgewogICAgICAgIGNvbnN0IHdjID0gd29ybGRDb3JuZXJzVGVtcFtpXTsKICAgICAgICBxdWF0LnZtdWx0KHdjLCB3Yyk7CiAgICAgICAgcG9zLnZhZGQod2MsIHdjKTsKICAgICAgICBjb25zdCB4ID0gd2MueDsKICAgICAgICBjb25zdCB5ID0gd2MueTsKICAgICAgICBjb25zdCB6ID0gd2MuejsKCiAgICAgICAgaWYgKHggPiBtYXgueCkgewogICAgICAgICAgbWF4LnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPiBtYXgueSkgewogICAgICAgICAgbWF4LnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPiBtYXgueikgewogICAgICAgICAgbWF4LnogPSB6OwogICAgICAgIH0KCiAgICAgICAgaWYgKHggPCBtaW4ueCkgewogICAgICAgICAgbWluLnggPSB4OwogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCBtaW4ueSkgewogICAgICAgICAgbWluLnkgPSB5OwogICAgICAgIH0KCiAgICAgICAgaWYgKHogPCBtaW4ueikgewogICAgICAgICAgbWluLnogPSB6OwogICAgICAgIH0KICAgICAgfSAvLyBHZXQgZWFjaCBheGlzIG1heAogICAgICAvLyBtaW4uc2V0KEluZmluaXR5LEluZmluaXR5LEluZmluaXR5KTsKICAgICAgLy8gbWF4LnNldCgtSW5maW5pdHksLUluZmluaXR5LC1JbmZpbml0eSk7CiAgICAgIC8vIHRoaXMuZm9yRWFjaFdvcmxkQ29ybmVyKHBvcyxxdWF0LGZ1bmN0aW9uKHgseSx6KXsKICAgICAgLy8gICAgIGlmKHggPiBtYXgueCl7CiAgICAgIC8vICAgICAgICAgbWF4LnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA+IG1heC55KXsKICAgICAgLy8gICAgICAgICBtYXgueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6ID4gbWF4LnopewogICAgICAvLyAgICAgICAgIG1heC56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gICAgIGlmKHggPCBtaW4ueCl7CiAgICAgIC8vICAgICAgICAgbWluLnggPSB4OwogICAgICAvLyAgICAgfQogICAgICAvLyAgICAgaWYoeSA8IG1pbi55KXsKICAgICAgLy8gICAgICAgICBtaW4ueSA9IHk7CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgICBpZih6IDwgbWluLnopewogICAgICAvLyAgICAgICAgIG1pbi56ID0gejsKICAgICAgLy8gICAgIH0KICAgICAgLy8gfSk7CgogICAgfQoKICB9CgogIGNvbnN0IHdvcmxkQ29ybmVyVGVtcFBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgd29ybGRDb3JuZXJzVGVtcCA9IFtuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpLCBuZXcgVmVjMygpXTsKICAvKioKICAgKiBCT0RZX1RZUEVTCiAgICovCgogIGNvbnN0IEJPRFlfVFlQRVMgPSB7CiAgICAvKiogRFlOQU1JQyAqLwogICAgRFlOQU1JQzogMSwKCiAgICAvKiogU1RBVElDICovCiAgICBTVEFUSUM6IDIsCgogICAgLyoqIEtJTkVNQVRJQyAqLwogICAgS0lORU1BVElDOiA0CiAgfTsKICAvKioKICAgKiBCb2R5VHlwZQogICAqLwoKICAvKioKICAgKiBCT0RZX1NMRUVQX1NUQVRFUwogICAqLwoKICBjb25zdCBCT0RZX1NMRUVQX1NUQVRFUyA9IHsKICAgIC8qKiBBV0FLRSAqLwogICAgQVdBS0U6IDAsCgogICAgLyoqIFNMRUVQWSAqLwogICAgU0xFRVBZOiAxLAoKICAgIC8qKiBTTEVFUElORyAqLwogICAgU0xFRVBJTkc6IDIKICB9OwogIC8qKgogICAqIEJvZHlTbGVlcFN0YXRlCiAgICovCgogIC8qKgogICAqIEJhc2UgY2xhc3MgZm9yIGFsbCBib2R5IHR5cGVzLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IHNoYXBlID0gbmV3IENBTk5PTi5TcGhlcmUoMSkKICAgKiAgICAgY29uc3QgYm9keSA9IG5ldyBDQU5OT04uQm9keSh7CiAgICogICAgICAgbWFzczogMSwKICAgKiAgICAgICBzaGFwZSwKICAgKiAgICAgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShib2R5KQogICAqLwoKICBjbGFzcyBCb2R5IGV4dGVuZHMgRXZlbnRUYXJnZXQgewogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIHR3byBib2RpZXMgY29sbGlkZS4gVGhpcyBldmVudCBpcyBkaXNwYXRjaGVkIG9uIGVhY2gKICAgICAqIG9mIHRoZSB0d28gYm9kaWVzIGludm9sdmVkIGluIHRoZSBjb2xsaXNpb24uCiAgICAgKiBAZXZlbnQgY29sbGlkZQogICAgICogQHBhcmFtIGJvZHkgVGhlIGJvZHkgdGhhdCB3YXMgaW52b2x2ZWQgaW4gdGhlIGNvbGxpc2lvbi4KICAgICAqIEBwYXJhbSBjb250YWN0IFRoZSBkZXRhaWxzIG9mIHRoZSBjb2xsaXNpb24uCiAgICAgKi8KCiAgICAvKioKICAgICAqIEEgZHluYW1pYyBib2R5IGlzIGZ1bGx5IHNpbXVsYXRlZC4gQ2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHRoZSB1c2VyLCBidXQgbm9ybWFsbHkgdGhleSBtb3ZlIGFjY29yZGluZyB0byBmb3JjZXMuIEEgZHluYW1pYyBib2R5IGNhbiBjb2xsaWRlIHdpdGggYWxsIGJvZHkgdHlwZXMuIEEgZHluYW1pYyBib2R5IGFsd2F5cyBoYXMgZmluaXRlLCBub24temVybyBtYXNzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIHN0YXRpYyBib2R5IGRvZXMgbm90IG1vdmUgZHVyaW5nIHNpbXVsYXRpb24gYW5kIGJlaGF2ZXMgYXMgaWYgaXQgaGFzIGluZmluaXRlIG1hc3MuIFN0YXRpYyBib2RpZXMgY2FuIGJlIG1vdmVkIG1hbnVhbGx5IGJ5IHNldHRpbmcgdGhlIHBvc2l0aW9uIG9mIHRoZSBib2R5LiBUaGUgdmVsb2NpdHkgb2YgYSBzdGF0aWMgYm9keSBpcyBhbHdheXMgemVyby4gU3RhdGljIGJvZGllcyBkbyBub3QgY29sbGlkZSB3aXRoIG90aGVyIHN0YXRpYyBvciBraW5lbWF0aWMgYm9kaWVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBBIGtpbmVtYXRpYyBib2R5IG1vdmVzIHVuZGVyIHNpbXVsYXRpb24gYWNjb3JkaW5nIHRvIGl0cyB2ZWxvY2l0eS4gVGhleSBkbyBub3QgcmVzcG9uZCB0byBmb3JjZXMuIFRoZXkgY2FuIGJlIG1vdmVkIG1hbnVhbGx5LCBidXQgbm9ybWFsbHkgYSBraW5lbWF0aWMgYm9keSBpcyBtb3ZlZCBieSBzZXR0aW5nIGl0cyB2ZWxvY2l0eS4gQSBraW5lbWF0aWMgYm9keSBiZWhhdmVzIGFzIGlmIGl0IGhhcyBpbmZpbml0ZSBtYXNzLiBLaW5lbWF0aWMgYm9kaWVzIGRvIG5vdCBjb2xsaWRlIHdpdGggb3RoZXIgc3RhdGljIG9yIGtpbmVtYXRpYyBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFXQUtFCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNMRUVQWQogICAgICovCgogICAgLyoqCiAgICAgKiBTTEVFUElORwogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgc2xlZXBpbmcgYm9keSBoYXMgd29rZW4gdXAuCiAgICAgKiBAZXZlbnQgd2FrZXVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBnb25lIGluIHRvIHRoZSBzbGVlcHkgc3RhdGUuCiAgICAgKiBAZXZlbnQgc2xlZXB5CiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3BhdGNoZWQgYWZ0ZXIgYSBib2R5IGhhcyBmYWxsZW4gYXNsZWVwLgogICAgICogQGV2ZW50IHNsZWVwCiAgICAgKi8KCiAgICAvKioKICAgICAqIElkZW50aWZpZXIgb2YgdGhlIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBvc2l0aW9uIG9mIGJvZHkgaW4gV29ybGQuYm9kaWVzLiBVcGRhdGVkIGJ5IFdvcmxkIGFuZCB1c2VkIGluIEFycmF5Q29sbGlzaW9uTWF0cml4LgogICAgICovCgogICAgLyoqCiAgICAgKiBSZWZlcmVuY2UgdG8gdGhlIHdvcmxkIHRoZSBib2R5IGlzIGxpdmluZyBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQ2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyB1c2VkIEJFRk9SRSBzdGVwcGluZyB0aGUgc3lzdGVtLiBVc2UgaXQgdG8gYXBwbHkgZm9yY2VzLCBmb3IgZXhhbXBsZS4gSW5zaWRlIHRoZSBmdW5jdGlvbiwgInRoaXMiIHdpbGwgcmVmZXIgdG8gdGhpcyBCb2R5IG9iamVjdC4gRGVwcmVjYXRlZCAtIHVzZSBXb3JsZCBldmVudHMgaW5zdGVhZC4KICAgICAqIEBkZXByZWNhdGVkIFVzZSBXb3JsZCBldmVudHMgaW5zdGVhZAogICAgICovCgogICAgLyoqCiAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiB0aGF0IGlzIHVzZWQgQUZURVIgc3RlcHBpbmcgdGhlIHN5c3RlbS4gSW5zaWRlIHRoZSBmdW5jdGlvbiwgInRoaXMiIHdpbGwgcmVmZXIgdG8gdGhpcyBCb2R5IG9iamVjdC4gRGVwcmVjYXRlZCAtIHVzZSBXb3JsZCBldmVudHMgaW5zdGVhZC4KICAgICAqIEBkZXByZWNhdGVkIFVzZSBXb3JsZCBldmVudHMgaW5zdGVhZAogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgY29sbGlzaW9uIGdyb3VwIHRoZSBib2R5IGJlbG9uZ3MgdG8uCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBjb2xsaXNpb24gZ3JvdXAgdGhlIGJvZHkgY2FuIGNvbGxpZGUgd2l0aC4KICAgICAqIEBkZWZhdWx0IC0xCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZXRoZXIgdG8gcHJvZHVjZSBjb250YWN0IGZvcmNlcyB3aGVuIGluIGNvbnRhY3Qgd2l0aCBvdGhlciBib2RpZXMuIE5vdGUgdGhhdCBjb250YWN0cyB3aWxsIGJlIGdlbmVyYXRlZCwgYnV0IHRoZXkgd2lsbCBiZSBkaXNhYmxlZCAtIGkuZS4gImNvbGxpZGUiIGV2ZW50cyB3aWxsIGJlIHJhaXNlZCwgYnV0IGZvcmNlcyB3aWxsIG5vdCBiZSBhbHRlcmVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjZSBwb3NpdGlvbiBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogSW50ZXJwb2xhdGVkIHBvc2l0aW9uIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBJbml0aWFsIHBvc2l0aW9uIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjZSB2ZWxvY2l0eSBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogSW5pdGlhbCB2ZWxvY2l0eSBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogTGluZWFyIGZvcmNlIG9uIHRoZSBib2R5IGluIHdvcmxkIHNwYWNlLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgbWFzcyBvZiB0aGUgYm9keS4KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHBoeXNpY3MgbWF0ZXJpYWwgb2YgdGhlIGJvZHkuIEl0IGRlZmluZXMgdGhlIGJvZHkgaW50ZXJhY3Rpb24gd2l0aCBvdGhlciBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEhvdyBtdWNoIHRvIGRhbXAgdGhlIGJvZHkgdmVsb2NpdHkgZWFjaCBzdGVwLiBJdCBjYW4gZ28gZnJvbSAwIHRvIDEuCiAgICAgKiBAZGVmYXVsdCAwLjAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIE9uZSBvZjogYEJvZHkuRFlOQU1JQ2AsIGBCb2R5LlNUQVRJQ2AgYW5kIGBCb2R5LktJTkVNQVRJQ2AuCiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRydWUsIHRoZSBib2R5IHdpbGwgYXV0b21hdGljYWxseSBmYWxsIHRvIHNsZWVwLgogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBDdXJyZW50IHNsZWVwIHN0YXRlLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiB0aGUgc3BlZWQgKHRoZSBub3JtIG9mIHRoZSB2ZWxvY2l0eSkgaXMgc21hbGxlciB0aGFuIHRoaXMgdmFsdWUsIHRoZSBib2R5IGlzIGNvbnNpZGVyZWQgc2xlZXB5LgogICAgICogQGRlZmF1bHQgMC4xCiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSBib2R5IGhhcyBiZWVuIHNsZWVweSBmb3IgdGhpcyBzbGVlcFRpbWVMaW1pdCBzZWNvbmRzLCBpdCBpcyBjb25zaWRlcmVkIHNsZWVwaW5nLgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBXb3JsZCBzcGFjZSByb3RhdGlvbmFsIGZvcmNlIG9uIHRoZSBib2R5LCBhcm91bmQgY2VudGVyIG9mIG1hc3MuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIHNwYWNlIG9yaWVudGF0aW9uIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBJbml0aWFsIHF1YXRlcm5pb24gb2YgdGhlIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEludGVycG9sYXRlZCBvcmllbnRhdGlvbiBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogQW5ndWxhciB2ZWxvY2l0eSBvZiB0aGUgYm9keSwgaW4gd29ybGQgc3BhY2UuIFRoaW5rIG9mIHRoZSBhbmd1bGFyIHZlbG9jaXR5IGFzIGEgdmVjdG9yLCB3aGljaCB0aGUgYm9keSByb3RhdGVzIGFyb3VuZC4gVGhlIGxlbmd0aCBvZiB0aGlzIHZlY3RvciBkZXRlcm1pbmVzIGhvdyBmYXN0IChpbiByYWRpYW5zIHBlciBzZWNvbmQpIHRoZSBib2R5IHJvdGF0ZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEluaXRpYWwgYW5ndWxhciB2ZWxvY2l0eSBvZiB0aGUgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogTGlzdCBvZiBTaGFwZXMgdGhhdCBoYXZlIGJlZW4gYWRkZWQgdG8gdGhlIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBvc2l0aW9uIG9mIGVhY2ggU2hhcGUgaW4gdGhlIGJvZHksIGdpdmVuIGluIGxvY2FsIEJvZHkgc3BhY2UuCiAgICAgKi8KCiAgICAvKioKICAgICAqIE9yaWVudGF0aW9uIG9mIGVhY2ggU2hhcGUsIGdpdmVuIGluIGxvY2FsIEJvZHkgc3BhY2UuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBpbmVydGlhIG9mIHRoZSBib2R5LgogICAgICovCgogICAgLyoqCiAgICAgKiBTZXQgdG8gdHJ1ZSBpZiB5b3UgZG9uJ3Qgd2FudCB0aGUgYm9keSB0byByb3RhdGUuIE1ha2Ugc3VyZSB0byBydW4gLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCkgaWYgeW91IGNoYW5nZSB0aGlzIGFmdGVyIHRoZSBib2R5IGNyZWF0aW9uLgogICAgICogQGRlZmF1bHQgZmFsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG11Y2ggdG8gZGFtcCB0aGUgYm9keSBhbmd1bGFyIHZlbG9jaXR5IGVhY2ggc3RlcC4gSXQgY2FuIGdvIGZyb20gMCB0byAxLgogICAgICogQGRlZmF1bHQgMC4wMQogICAgICovCgogICAgLyoqCiAgICAgKiBVc2UgdGhpcyBwcm9wZXJ0eSB0byBsaW1pdCB0aGUgbW90aW9uIGFsb25nIGFueSB3b3JsZCBheGlzLiAoMSwxLDEpIHdpbGwgYWxsb3cgbW90aW9uIGFsb25nIGFsbCBheGVzIHdoaWxlICgwLDAsMCkgYWxsb3dzIG5vbmUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFVzZSB0aGlzIHByb3BlcnR5IHRvIGxpbWl0IHRoZSByb3RhdGlvbmFsIG1vdGlvbiBhbG9uZyBhbnkgd29ybGQgYXhpcy4gKDEsMSwxKSB3aWxsIGFsbG93IHJvdGF0aW9uIGFsb25nIGFsbCBheGVzIHdoaWxlICgwLDAsMCkgYWxsb3dzIG5vbmUuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIHNwYWNlIGJvdW5kaW5nIGJveCBvZiB0aGUgYm9keSBhbmQgaXRzIHNoYXBlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogSW5kaWNhdGVzIGlmIHRoZSBBQUJCIG5lZWRzIHRvIGJlIHVwZGF0ZWQgYmVmb3JlIHVzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVG90YWwgYm91bmRpbmcgcmFkaXVzIG9mIHRoZSBCb2R5IGluY2x1ZGluZyBpdHMgc2hhcGVzLCByZWxhdGl2ZSB0byBib2R5LnBvc2l0aW9uLgogICAgICovCgogICAgLyoqCiAgICAgKiBXaGVuIHRydWUgdGhlIGJvZHkgYmVoYXZlcyBsaWtlIGEgdHJpZ2dlci4gSXQgZG9lcyBub3QgY29sbGlkZQogICAgICogd2l0aCBvdGhlciBib2RpZXMgYnV0IGNvbGxpc2lvbiBldmVudHMgYXJlIHN0aWxsIHRyaWdnZXJlZC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkgewogICAgICBzdXBlcigpOwogICAgICB0aGlzLmlkID0gdm9pZCAwOwogICAgICB0aGlzLmluZGV4ID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkID0gdm9pZCAwOwogICAgICB0aGlzLnByZVN0ZXAgPSB2b2lkIDA7CiAgICAgIHRoaXMucG9zdFN0ZXAgPSB2b2lkIDA7CiAgICAgIHRoaXMudmxhbWJkYSA9IHZvaWQgMDsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IHZvaWQgMDsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdm9pZCAwOwogICAgICB0aGlzLmNvbGxpc2lvblJlc3BvbnNlID0gdm9pZCAwOwogICAgICB0aGlzLnBvc2l0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaW5pdFBvc2l0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnZlbG9jaXR5ID0gdm9pZCAwOwogICAgICB0aGlzLmluaXRWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5mb3JjZSA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXNzID0gdm9pZCAwOwogICAgICB0aGlzLmludk1hc3MgPSB2b2lkIDA7CiAgICAgIHRoaXMubWF0ZXJpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMubGluZWFyRGFtcGluZyA9IHZvaWQgMDsKICAgICAgdGhpcy50eXBlID0gdm9pZCAwOwogICAgICB0aGlzLmFsbG93U2xlZXAgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xlZXBTdGF0ZSA9IHZvaWQgMDsKICAgICAgdGhpcy5zbGVlcFNwZWVkTGltaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xlZXBUaW1lTGltaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB2b2lkIDA7CiAgICAgIHRoaXMud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHZvaWQgMDsKICAgICAgdGhpcy50b3JxdWUgPSB2b2lkIDA7CiAgICAgIHRoaXMucXVhdGVybmlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5wcmV2aW91c1F1YXRlcm5pb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUXVhdGVybmlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW5pdEFuZ3VsYXJWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5zaGFwZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzID0gdm9pZCAwOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLmluZXJ0aWEgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW52SW5lcnRpYSA9IHZvaWQgMDsKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdm9pZCAwOwogICAgICB0aGlzLmludkluZXJ0aWFTb2x2ZSA9IHZvaWQgMDsKICAgICAgdGhpcy5pbnZJbmVydGlhV29ybGRTb2x2ZSA9IHZvaWQgMDsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLmFuZ3VsYXJEYW1waW5nID0gdm9pZCAwOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IHZvaWQgMDsKICAgICAgdGhpcy5hbmd1bGFyRmFjdG9yID0gdm9pZCAwOwogICAgICB0aGlzLmFhYmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdm9pZCAwOwogICAgICB0aGlzLmJvdW5kaW5nUmFkaXVzID0gdm9pZCAwOwogICAgICB0aGlzLndsYW1iZGEgPSB2b2lkIDA7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gdm9pZCAwOwogICAgICB0aGlzLmlkID0gQm9keS5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5pbmRleCA9IC0xOwogICAgICB0aGlzLndvcmxkID0gbnVsbDsKICAgICAgdGhpcy5wcmVTdGVwID0gbnVsbDsKICAgICAgdGhpcy5wb3N0U3RlcCA9IG51bGw7CiAgICAgIHRoaXMudmxhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrID0gdHlwZW9mIG9wdGlvbnMuY29sbGlzaW9uRmlsdGVyTWFzayA9PT0gJ251bWJlcicgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgOiAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlID09PSAnYm9vbGVhbicgPyBvcHRpb25zLmNvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKICAgICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaW50ZXJwb2xhdGVkUG9zaXRpb24gPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmluaXRQb3NpdGlvbiA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5wb3NpdGlvbikgewogICAgICAgIHRoaXMucG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLnByZXZpb3VzUG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFBvc2l0aW9uLmNvcHkob3B0aW9ucy5wb3NpdGlvbik7CiAgICAgICAgdGhpcy5pbml0UG9zaXRpb24uY29weShvcHRpb25zLnBvc2l0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy52ZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy52ZWxvY2l0eSkgewogICAgICAgIHRoaXMudmVsb2NpdHkuY29weShvcHRpb25zLnZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0VmVsb2NpdHkgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmZvcmNlID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgbWFzcyA9IHR5cGVvZiBvcHRpb25zLm1hc3MgPT09ICdudW1iZXInID8gb3B0aW9ucy5tYXNzIDogMDsKICAgICAgdGhpcy5tYXNzID0gbWFzczsKICAgICAgdGhpcy5pbnZNYXNzID0gbWFzcyA+IDAgPyAxLjAgLyBtYXNzIDogMDsKICAgICAgdGhpcy5tYXRlcmlhbCA9IG9wdGlvbnMubWF0ZXJpYWwgfHwgbnVsbDsKICAgICAgdGhpcy5saW5lYXJEYW1waW5nID0gdHlwZW9mIG9wdGlvbnMubGluZWFyRGFtcGluZyA9PT0gJ251bWJlcicgPyBvcHRpb25zLmxpbmVhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLnR5cGUgPSBtYXNzIDw9IDAuMCA/IEJvZHkuU1RBVElDIDogQm9keS5EWU5BTUlDOwoKICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnR5cGUgPT09IHR5cGVvZiBCb2R5LlNUQVRJQykgewogICAgICAgIHRoaXMudHlwZSA9IG9wdGlvbnMudHlwZTsKICAgICAgfQoKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdHlwZW9mIG9wdGlvbnMuYWxsb3dTbGVlcCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFsbG93U2xlZXAgOiB0cnVlOwogICAgICB0aGlzLnNsZWVwU3RhdGUgPSBCb2R5LkFXQUtFOwogICAgICB0aGlzLnNsZWVwU3BlZWRMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLnNsZWVwU3BlZWRMaW1pdCA6IDAuMTsKICAgICAgdGhpcy5zbGVlcFRpbWVMaW1pdCA9IHR5cGVvZiBvcHRpb25zLnNsZWVwVGltZUxpbWl0ICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuc2xlZXBUaW1lTGltaXQgOiAxOwogICAgICB0aGlzLnRpbWVMYXN0U2xlZXB5ID0gMDsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgIHRoaXMudG9ycXVlID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5xdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbml0UXVhdGVybmlvbiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgdGhpcy5pbnRlcnBvbGF0ZWRRdWF0ZXJuaW9uID0gbmV3IFF1YXRlcm5pb24oKTsKCiAgICAgIGlmIChvcHRpb25zLnF1YXRlcm5pb24pIHsKICAgICAgICB0aGlzLnF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMuaW5pdFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICAgIHRoaXMucHJldmlvdXNRdWF0ZXJuaW9uLmNvcHkob3B0aW9ucy5xdWF0ZXJuaW9uKTsKICAgICAgICB0aGlzLmludGVycG9sYXRlZFF1YXRlcm5pb24uY29weShvcHRpb25zLnF1YXRlcm5pb24pOwogICAgICB9CgogICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7CgogICAgICBpZiAob3B0aW9ucy5hbmd1bGFyVmVsb2NpdHkpIHsKICAgICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5jb3B5KG9wdGlvbnMuYW5ndWxhclZlbG9jaXR5KTsKICAgICAgfQoKICAgICAgdGhpcy5pbml0QW5ndWxhclZlbG9jaXR5ID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5zaGFwZXMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9mZnNldHMgPSBbXTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucyA9IFtdOwogICAgICB0aGlzLmluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWEgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZCA9IG5ldyBNYXQzKCk7CiAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gMDsKICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlID0gbmV3IE1hdDMoKTsKICAgICAgdGhpcy5maXhlZFJvdGF0aW9uID0gdHlwZW9mIG9wdGlvbnMuZml4ZWRSb3RhdGlvbiAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmZpeGVkUm90YXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy5hbmd1bGFyRGFtcGluZyA9IHR5cGVvZiBvcHRpb25zLmFuZ3VsYXJEYW1waW5nICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5ndWxhckRhbXBpbmcgOiAwLjAxOwogICAgICB0aGlzLmxpbmVhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMubGluZWFyRmFjdG9yKSB7CiAgICAgICAgdGhpcy5saW5lYXJGYWN0b3IuY29weShvcHRpb25zLmxpbmVhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYW5ndWxhckZhY3RvciA9IG5ldyBWZWMzKDEsIDEsIDEpOwoKICAgICAgaWYgKG9wdGlvbnMuYW5ndWxhckZhY3RvcikgewogICAgICAgIHRoaXMuYW5ndWxhckZhY3Rvci5jb3B5KG9wdGlvbnMuYW5ndWxhckZhY3Rvcik7CiAgICAgIH0KCiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IDA7CiAgICAgIHRoaXMud2xhbWJkYSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuaXNUcmlnZ2VyID0gQm9vbGVhbihvcHRpb25zLmlzVHJpZ2dlcik7CgogICAgICBpZiAob3B0aW9ucy5zaGFwZSkgewogICAgICAgIHRoaXMuYWRkU2hhcGUob3B0aW9ucy5zaGFwZSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgIH0KICAgIC8qKgogICAgICogV2FrZSB0aGUgYm9keSB1cC4KICAgICAqLwoKCiAgICB3YWtlVXAoKSB7CiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHRoaXMuc2xlZXBTdGF0ZTsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5BV0FLRTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CgogICAgICBpZiAocHJldlN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkud2FrZXVwRXZlbnQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEZvcmNlIGJvZHkgc2xlZXAKICAgICAqLwoKCiAgICBzbGVlcCgpIHsKICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUElORzsKICAgICAgdGhpcy52ZWxvY2l0eS5zZXQoMCwgMCwgMCk7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIENhbGxlZCBldmVyeSB0aW1lc3RlcCB0byB1cGRhdGUgaW50ZXJuYWwgc2xlZXAgdGltZXIgYW5kIGNoYW5nZSBzbGVlcCBzdGF0ZSBpZiBuZWVkZWQuCiAgICAgKiBAcGFyYW0gdGltZSBUaGUgd29ybGQgdGltZSBpbiBzZWNvbmRzCiAgICAgKi8KCgogICAgc2xlZXBUaWNrKHRpbWUpIHsKICAgICAgaWYgKHRoaXMuYWxsb3dTbGVlcCkgewogICAgICAgIGNvbnN0IHNsZWVwU3RhdGUgPSB0aGlzLnNsZWVwU3RhdGU7CiAgICAgICAgY29uc3Qgc3BlZWRTcXVhcmVkID0gdGhpcy52ZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCkgKyB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5sZW5ndGhTcXVhcmVkKCk7CiAgICAgICAgY29uc3Qgc3BlZWRMaW1pdFNxdWFyZWQgPSB0aGlzLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5BV0FLRSAmJiBzcGVlZFNxdWFyZWQgPCBzcGVlZExpbWl0U3F1YXJlZCkgewogICAgICAgICAgdGhpcy5zbGVlcFN0YXRlID0gQm9keS5TTEVFUFk7IC8vIFNsZWVweQoKICAgICAgICAgIHRoaXMudGltZUxhc3RTbGVlcHkgPSB0aW1lOwogICAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KEJvZHkuc2xlZXB5RXZlbnQpOwogICAgICAgIH0gZWxzZSBpZiAoc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUFkgJiYgc3BlZWRTcXVhcmVkID4gc3BlZWRMaW1pdFNxdWFyZWQpIHsKICAgICAgICAgIHRoaXMud2FrZVVwKCk7IC8vIFdha2UgdXAKICAgICAgICB9IGVsc2UgaWYgKHNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBZICYmIHRpbWUgLSB0aGlzLnRpbWVMYXN0U2xlZXB5ID4gdGhpcy5zbGVlcFRpbWVMaW1pdCkgewogICAgICAgICAgdGhpcy5zbGVlcCgpOyAvLyBTbGVlcGluZwoKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChCb2R5LnNsZWVwRXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBJZiB0aGUgYm9keSBpcyBzbGVlcGluZywgaXQgc2hvdWxkIGJlIGltbW92YWJsZSAvIGhhdmUgaW5maW5pdGUgbWFzcyBkdXJpbmcgc29sdmUuIFdlIHNvbHZlIGl0IGJ5IGhhdmluZyBhIHNlcGFyYXRlICJzb2x2ZSBtYXNzIi4KICAgICAqLwoKCiAgICB1cGRhdGVTb2x2ZU1hc3NQcm9wZXJ0aWVzKCkgewogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HIHx8IHRoaXMudHlwZSA9PT0gQm9keS5LSU5FTUFUSUMpIHsKICAgICAgICB0aGlzLmludk1hc3NTb2x2ZSA9IDA7CiAgICAgICAgdGhpcy5pbnZJbmVydGlhU29sdmUuc2V0WmVybygpOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVdvcmxkU29sdmUuc2V0WmVybygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaW52TWFzc1NvbHZlID0gdGhpcy5pbnZNYXNzOwogICAgICAgIHRoaXMuaW52SW5lcnRpYVNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhKTsKICAgICAgICB0aGlzLmludkluZXJ0aWFXb3JsZFNvbHZlLmNvcHkodGhpcy5pbnZJbmVydGlhV29ybGQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCBwb2ludCB0byBsb2NhbCBib2R5IGZyYW1lLgogICAgICovCgoKICAgIHBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkUG9pbnQsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgd29ybGRQb2ludC52c3ViKHRoaXMucG9zaXRpb24sIHJlc3VsdCk7CiAgICAgIHRoaXMucXVhdGVybmlvbi5jb25qdWdhdGUoKS52bXVsdChyZXN1bHQsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIENvbnZlcnQgYSB3b3JsZCB2ZWN0b3IgdG8gbG9jYWwgYm9keSBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb0xvY2FsRnJhbWUod29ybGRWZWN0b3IsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvbmp1Z2F0ZSgpLnZtdWx0KHdvcmxkVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICBwb2ludFRvV29ybGRGcmFtZShsb2NhbFBvaW50LCByZXN1bHQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRoaXMucXVhdGVybmlvbi52bXVsdChsb2NhbFBvaW50LCByZXN1bHQpOwogICAgICByZXN1bHQudmFkZCh0aGlzLnBvc2l0aW9uLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBDb252ZXJ0IGEgbG9jYWwgYm9keSBwb2ludCB0byB3b3JsZCBmcmFtZS4KICAgICAqLwoKCiAgICB2ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxWZWN0b3IsIHJlc3VsdCA9IG5ldyBWZWMzKCkpIHsKICAgICAgdGhpcy5xdWF0ZXJuaW9uLnZtdWx0KGxvY2FsVmVjdG9yLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSBzaGFwZSB0byB0aGUgYm9keSB3aXRoIGEgbG9jYWwgb2Zmc2V0IGFuZCBvcmllbnRhdGlvbi4KICAgICAqIEByZXR1cm4gVGhlIGJvZHkgb2JqZWN0LCBmb3IgY2hhaW5hYmlsaXR5LgogICAgICovCgoKICAgIGFkZFNoYXBlKHNoYXBlLCBfb2Zmc2V0LCBfb3JpZW50YXRpb24pIHsKICAgICAgY29uc3Qgb2Zmc2V0ID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3Qgb3JpZW50YXRpb24gPSBuZXcgUXVhdGVybmlvbigpOwoKICAgICAgaWYgKF9vZmZzZXQpIHsKICAgICAgICBvZmZzZXQuY29weShfb2Zmc2V0KTsKICAgICAgfQoKICAgICAgaWYgKF9vcmllbnRhdGlvbikgewogICAgICAgIG9yaWVudGF0aW9uLmNvcHkoX29yaWVudGF0aW9uKTsKICAgICAgfQoKICAgICAgdGhpcy5zaGFwZXMucHVzaChzaGFwZSk7CiAgICAgIHRoaXMuc2hhcGVPZmZzZXRzLnB1c2gob2Zmc2V0KTsKICAgICAgdGhpcy5zaGFwZU9yaWVudGF0aW9ucy5wdXNoKG9yaWVudGF0aW9uKTsKICAgICAgdGhpcy51cGRhdGVNYXNzUHJvcGVydGllcygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nUmFkaXVzKCk7CiAgICAgIHRoaXMuYWFiYk5lZWRzVXBkYXRlID0gdHJ1ZTsKICAgICAgc2hhcGUuYm9keSA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYSBzaGFwZSBmcm9tIHRoZSBib2R5LgogICAgICogQHJldHVybiBUaGUgYm9keSBvYmplY3QsIGZvciBjaGFpbmFiaWxpdHkuCiAgICAgKi8KCgogICAgcmVtb3ZlU2hhcGUoc2hhcGUpIHsKICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNoYXBlcy5pbmRleE9mKHNoYXBlKTsKCiAgICAgIGlmIChpbmRleCA9PT0gLTEpIHsKICAgICAgICBjb25zb2xlLndhcm4oJ1NoYXBlIGRvZXMgbm90IGJlbG9uZyB0byB0aGUgYm9keScpOwogICAgICAgIHJldHVybiB0aGlzOwogICAgICB9CgogICAgICB0aGlzLnNoYXBlcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLnNoYXBlT2Zmc2V0cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLnNoYXBlT3JpZW50YXRpb25zLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMudXBkYXRlTWFzc1Byb3BlcnRpZXMoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1JhZGl1cygpOwogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IHRydWU7CiAgICAgIHNoYXBlLmJvZHkgPSBudWxsOwogICAgICByZXR1cm4gdGhpczsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBib3VuZGluZyByYWRpdXMgb2YgdGhlIGJvZHkuIFNob3VsZCBiZSBkb25lIGlmIGFueSBvZiB0aGUgc2hhcGVzIGFyZSBjaGFuZ2VkLgogICAgICovCgoKICAgIHVwZGF0ZUJvdW5kaW5nUmFkaXVzKCkgewogICAgICBjb25zdCBzaGFwZXMgPSB0aGlzLnNoYXBlczsKICAgICAgY29uc3Qgc2hhcGVPZmZzZXRzID0gdGhpcy5zaGFwZU9mZnNldHM7CiAgICAgIGNvbnN0IE4gPSBzaGFwZXMubGVuZ3RoOwogICAgICBsZXQgcmFkaXVzID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZSA9IHNoYXBlc1tpXTsKICAgICAgICBzaGFwZS51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgICAgIGNvbnN0IG9mZnNldCA9IHNoYXBlT2Zmc2V0c1tpXS5sZW5ndGgoKTsKICAgICAgICBjb25zdCByID0gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXM7CgogICAgICAgIGlmIChvZmZzZXQgKyByID4gcmFkaXVzKSB7CiAgICAgICAgICByYWRpdXMgPSBvZmZzZXQgKyByOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5ib3VuZGluZ1JhZGl1cyA9IHJhZGl1czsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgLmFhYmIKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICBjb25zdCBzaGFwZXMgPSB0aGlzLnNoYXBlczsKICAgICAgY29uc3Qgc2hhcGVPZmZzZXRzID0gdGhpcy5zaGFwZU9mZnNldHM7CiAgICAgIGNvbnN0IHNoYXBlT3JpZW50YXRpb25zID0gdGhpcy5zaGFwZU9yaWVudGF0aW9uczsKICAgICAgY29uc3QgTiA9IHNoYXBlcy5sZW5ndGg7CiAgICAgIGNvbnN0IG9mZnNldCA9IHRtcFZlYzsKICAgICAgY29uc3Qgb3JpZW50YXRpb24gPSB0bXBRdWF0OwogICAgICBjb25zdCBib2R5UXVhdCA9IHRoaXMucXVhdGVybmlvbjsKICAgICAgY29uc3QgYWFiYiA9IHRoaXMuYWFiYjsKICAgICAgY29uc3Qgc2hhcGVBQUJCID0gdXBkYXRlQUFCQl9zaGFwZUFBQkI7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3Qgc2hhcGUgPSBzaGFwZXNbaV07IC8vIEdldCBzaGFwZSB3b3JsZCBwb3NpdGlvbgoKICAgICAgICBib2R5UXVhdC52bXVsdChzaGFwZU9mZnNldHNbaV0sIG9mZnNldCk7CiAgICAgICAgb2Zmc2V0LnZhZGQodGhpcy5wb3NpdGlvbiwgb2Zmc2V0KTsgLy8gR2V0IHNoYXBlIHdvcmxkIHF1YXRlcm5pb24KCiAgICAgICAgYm9keVF1YXQubXVsdChzaGFwZU9yaWVudGF0aW9uc1tpXSwgb3JpZW50YXRpb24pOyAvLyBHZXQgc2hhcGUgQUFCQgoKICAgICAgICBzaGFwZS5jYWxjdWxhdGVXb3JsZEFBQkIob2Zmc2V0LCBvcmllbnRhdGlvbiwgc2hhcGVBQUJCLmxvd2VyQm91bmQsIHNoYXBlQUFCQi51cHBlckJvdW5kKTsKCiAgICAgICAgaWYgKGkgPT09IDApIHsKICAgICAgICAgIGFhYmIuY29weShzaGFwZUFBQkIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhYWJiLmV4dGVuZChzaGFwZUFBQkIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5hYWJiTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIGAuaW5lcnRpYVdvcmxkYCBhbmQgYC5pbnZJbmVydGlhV29ybGRgCiAgICAgKi8KCgogICAgdXBkYXRlSW5lcnRpYVdvcmxkKGZvcmNlKSB7CiAgICAgIGNvbnN0IEkgPSB0aGlzLmludkluZXJ0aWE7CiAgICAgIGlmIChJLnggPT09IEkueSAmJiBJLnkgPT09IEkueiAmJiAhZm9yY2UpIDtlbHNlIHsKICAgICAgICBjb25zdCBtMSA9IHVpd19tMTsKICAgICAgICBjb25zdCBtMiA9IHVpd19tMjsKICAgICAgICBtMS5zZXRSb3RhdGlvbkZyb21RdWF0ZXJuaW9uKHRoaXMucXVhdGVybmlvbik7CiAgICAgICAgbTEudHJhbnNwb3NlKG0yKTsKICAgICAgICBtMS5zY2FsZShJLCBtMSk7CiAgICAgICAgbTEubW11bHQobTIsIHRoaXMuaW52SW5lcnRpYVdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBmb3JjZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFwcGx5aW5nIGZvcmNlIHRoaXMgd2F5IHdpbGwgYWRkIHRvIEJvZHkuZm9yY2UgYW5kIEJvZHkudG9ycXVlLgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBhbW91bnQgb2YgZm9yY2UgdG8gYWRkLgogICAgICogQHBhcmFtIHJlbGF0aXZlUG9pbnQgQSBwb2ludCByZWxhdGl2ZSB0byB0aGUgY2VudGVyIG9mIG1hc3MgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5Rm9yY2UoZm9yY2UsIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpKSB7CiAgICAgIC8vIE5lZWRlZD8KICAgICAgaWYgKHRoaXMudHlwZSAhPT0gQm9keS5EWU5BTUlDKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5zbGVlcFN0YXRlID09PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgdGhpcy53YWtlVXAoKTsKICAgICAgfSAvLyBDb21wdXRlIHByb2R1Y2VkIHJvdGF0aW9uYWwgZm9yY2UKCgogICAgICBjb25zdCByb3RGb3JjZSA9IEJvZHlfYXBwbHlGb3JjZV9yb3RGb3JjZTsKICAgICAgcmVsYXRpdmVQb2ludC5jcm9zcyhmb3JjZSwgcm90Rm9yY2UpOyAvLyBBZGQgbGluZWFyIGZvcmNlCgogICAgICB0aGlzLmZvcmNlLnZhZGQoZm9yY2UsIHRoaXMuZm9yY2UpOyAvLyBBZGQgcm90YXRpb25hbCBmb3JjZQoKICAgICAgdGhpcy50b3JxdWUudmFkZChyb3RGb3JjZSwgdGhpcy50b3JxdWUpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSBmb3JjZSB0byBhIGxvY2FsIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIGZvcmNlIFRoZSBmb3JjZSB2ZWN0b3IgdG8gYXBwbHksIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgYm9keSBmcmFtZS4KICAgICAqIEBwYXJhbSBsb2NhbFBvaW50IEEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkgdG8gYXBwbHkgdGhlIGZvcmNlIG9uLgogICAgICovCgoKICAgIGFwcGx5TG9jYWxGb3JjZShsb2NhbEZvcmNlLCBsb2NhbFBvaW50ID0gbmV3IFZlYzMoKSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkRm9yY2UgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV93b3JsZEZvcmNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxGb3JjZV9yZWxhdGl2ZVBvaW50V29ybGQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEZvcmNlLCB3b3JsZEZvcmNlKTsKICAgICAgdGhpcy52ZWN0b3JUb1dvcmxkRnJhbWUobG9jYWxQb2ludCwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgICAgdGhpcy5hcHBseUZvcmNlKHdvcmxkRm9yY2UsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IHRvcnF1ZSB0byB0aGUgYm9keS4KICAgICAqIEBwYXJhbSB0b3JxdWUgVGhlIGFtb3VudCBvZiB0b3JxdWUgdG8gYWRkLgogICAgICovCgoKICAgIGFwcGx5VG9ycXVlKHRvcnF1ZSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICB0aGlzLndha2VVcCgpOwogICAgICB9IC8vIEFkZCByb3RhdGlvbmFsIGZvcmNlCgoKICAgICAgdGhpcy50b3JxdWUudmFkZCh0b3JxdWUsIHRoaXMudG9ycXVlKTsKICAgIH0KICAgIC8qKgogICAgICogQXBwbHkgaW1wdWxzZSB0byBhIHBvaW50IG9mIHRoZSBib2R5LiBUaGlzIGNvdWxkIGZvciBleGFtcGxlIGJlIGEgcG9pbnQgb24gdGhlIEJvZHkgc3VyZmFjZS4KICAgICAqIEFuIGltcHVsc2UgaXMgYSBmb3JjZSBhZGRlZCB0byBhIGJvZHkgZHVyaW5nIGEgc2hvcnQgcGVyaW9kIG9mIHRpbWUgKGltcHVsc2UgPSBmb3JjZSAqIHRpbWUpLgogICAgICogSW1wdWxzZXMgd2lsbCBiZSBhZGRlZCB0byBCb2R5LnZlbG9jaXR5IGFuZCBCb2R5LmFuZ3VsYXJWZWxvY2l0eS4KICAgICAqIEBwYXJhbSBpbXB1bHNlIFRoZSBhbW91bnQgb2YgaW1wdWxzZSB0byBhZGQuCiAgICAgKiBAcGFyYW0gcmVsYXRpdmVQb2ludCBBIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlJbXB1bHNlKGltcHVsc2UsIHJlbGF0aXZlUG9pbnQgPSBuZXcgVmVjMygpKSB7CiAgICAgIGlmICh0aGlzLnR5cGUgIT09IEJvZHkuRFlOQU1JQykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgewogICAgICAgIHRoaXMud2FrZVVwKCk7CiAgICAgIH0gLy8gQ29tcHV0ZSBwb2ludCBwb3NpdGlvbiByZWxhdGl2ZSB0byB0aGUgYm9keSBjZW50ZXIKCgogICAgICBjb25zdCByID0gcmVsYXRpdmVQb2ludDsgLy8gQ29tcHV0ZSBwcm9kdWNlZCBjZW50cmFsIGltcHVsc2UgdmVsb2NpdHkKCiAgICAgIGNvbnN0IHZlbG8gPSBCb2R5X2FwcGx5SW1wdWxzZV92ZWxvOwogICAgICB2ZWxvLmNvcHkoaW1wdWxzZSk7CiAgICAgIHZlbG8uc2NhbGUodGhpcy5pbnZNYXNzLCB2ZWxvKTsgLy8gQWRkIGxpbmVhciBpbXB1bHNlCgogICAgICB0aGlzLnZlbG9jaXR5LnZhZGQodmVsbywgdGhpcy52ZWxvY2l0eSk7IC8vIENvbXB1dGUgcHJvZHVjZWQgcm90YXRpb25hbCBpbXB1bHNlIHZlbG9jaXR5CgogICAgICBjb25zdCByb3RWZWxvID0gQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbzsKICAgICAgci5jcm9zcyhpbXB1bHNlLCByb3RWZWxvKTsKICAgICAgLyoKICAgICAgIHJvdFZlbG8ueCAqPSB0aGlzLmludkluZXJ0aWEueDsKICAgICAgIHJvdFZlbG8ueSAqPSB0aGlzLmludkluZXJ0aWEueTsKICAgICAgIHJvdFZlbG8ueiAqPSB0aGlzLmludkluZXJ0aWEuejsKICAgICAgICovCgogICAgICB0aGlzLmludkluZXJ0aWFXb3JsZC52bXVsdChyb3RWZWxvLCByb3RWZWxvKTsgLy8gQWRkIHJvdGF0aW9uYWwgSW1wdWxzZQoKICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkudmFkZChyb3RWZWxvLCB0aGlzLmFuZ3VsYXJWZWxvY2l0eSk7CiAgICB9CiAgICAvKioKICAgICAqIEFwcGx5IGxvY2FsbHktZGVmaW5lZCBpbXB1bHNlIHRvIGEgbG9jYWwgcG9pbnQgaW4gdGhlIGJvZHkuCiAgICAgKiBAcGFyYW0gZm9yY2UgVGhlIGZvcmNlIHZlY3RvciB0byBhcHBseSwgZGVmaW5lZCBsb2NhbGx5IGluIHRoZSBib2R5IGZyYW1lLgogICAgICogQHBhcmFtIGxvY2FsUG9pbnQgQSBsb2NhbCBwb2ludCBpbiB0aGUgYm9keSB0byBhcHBseSB0aGUgZm9yY2Ugb24uCiAgICAgKi8KCgogICAgYXBwbHlMb2NhbEltcHVsc2UobG9jYWxJbXB1bHNlLCBsb2NhbFBvaW50ID0gbmV3IFZlYzMoKSkgewogICAgICBpZiAodGhpcy50eXBlICE9PSBCb2R5LkRZTkFNSUMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IHdvcmxkSW1wdWxzZSA9IEJvZHlfYXBwbHlMb2NhbEltcHVsc2Vfd29ybGRJbXB1bHNlOwogICAgICBjb25zdCByZWxhdGl2ZVBvaW50V29ybGQgPSBCb2R5X2FwcGx5TG9jYWxJbXB1bHNlX3JlbGF0aXZlUG9pbnQ7IC8vIFRyYW5zZm9ybSB0aGUgZm9yY2UgdmVjdG9yIHRvIHdvcmxkIHNwYWNlCgogICAgICB0aGlzLnZlY3RvclRvV29ybGRGcmFtZShsb2NhbEltcHVsc2UsIHdvcmxkSW1wdWxzZSk7CiAgICAgIHRoaXMudmVjdG9yVG9Xb3JsZEZyYW1lKGxvY2FsUG9pbnQsIHJlbGF0aXZlUG9pbnRXb3JsZCk7CiAgICAgIHRoaXMuYXBwbHlJbXB1bHNlKHdvcmxkSW1wdWxzZSwgcmVsYXRpdmVQb2ludFdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogU2hvdWxkIGJlIGNhbGxlZCB3aGVuZXZlciB5b3UgY2hhbmdlIHRoZSBib2R5IHNoYXBlIG9yIG1hc3MuCiAgICAgKi8KCgogICAgdXBkYXRlTWFzc1Byb3BlcnRpZXMoKSB7CiAgICAgIGNvbnN0IGhhbGZFeHRlbnRzID0gQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50czsKICAgICAgdGhpcy5pbnZNYXNzID0gdGhpcy5tYXNzID4gMCA/IDEuMCAvIHRoaXMubWFzcyA6IDA7CiAgICAgIGNvbnN0IEkgPSB0aGlzLmluZXJ0aWE7CiAgICAgIGNvbnN0IGZpeGVkID0gdGhpcy5maXhlZFJvdGF0aW9uOyAvLyBBcHByb3hpbWF0ZSB3aXRoIEFBQkIgYm94CgogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgaGFsZkV4dGVudHMuc2V0KCh0aGlzLmFhYmIudXBwZXJCb3VuZC54IC0gdGhpcy5hYWJiLmxvd2VyQm91bmQueCkgLyAyLCAodGhpcy5hYWJiLnVwcGVyQm91bmQueSAtIHRoaXMuYWFiYi5sb3dlckJvdW5kLnkpIC8gMiwgKHRoaXMuYWFiYi51cHBlckJvdW5kLnogLSB0aGlzLmFhYmIubG93ZXJCb3VuZC56KSAvIDIpOwogICAgICBCb3guY2FsY3VsYXRlSW5lcnRpYShoYWxmRXh0ZW50cywgdGhpcy5tYXNzLCBJKTsKICAgICAgdGhpcy5pbnZJbmVydGlhLnNldChJLnggPiAwICYmICFmaXhlZCA/IDEuMCAvIEkueCA6IDAsIEkueSA+IDAgJiYgIWZpeGVkID8gMS4wIC8gSS55IDogMCwgSS56ID4gMCAmJiAhZml4ZWQgPyAxLjAgLyBJLnogOiAwKTsKICAgICAgdGhpcy51cGRhdGVJbmVydGlhV29ybGQodHJ1ZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB3b3JsZCB2ZWxvY2l0eSBvZiBhIHBvaW50IGluIHRoZSBib2R5LgogICAgICogQHBhcmFtIHdvcmxkUG9pbnQKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqIEByZXR1cm4gVGhlIHJlc3VsdCB2ZWN0b3IuCiAgICAgKi8KCgogICAgZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod29ybGRQb2ludCwgcmVzdWx0KSB7CiAgICAgIGNvbnN0IHIgPSBuZXcgVmVjMygpOwogICAgICB3b3JsZFBvaW50LnZzdWIodGhpcy5wb3NpdGlvbiwgcik7CiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LmNyb3NzKHIsIHJlc3VsdCk7CiAgICAgIHRoaXMudmVsb2NpdHkudmFkZChyZXN1bHQsIHJlc3VsdCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIE1vdmUgdGhlIGJvZHkgZm9yd2FyZCBpbiB0aW1lLgogICAgICogQHBhcmFtIGR0IFRpbWUgc3RlcAogICAgICogQHBhcmFtIHF1YXROb3JtYWxpemUgU2V0IHRvIHRydWUgdG8gbm9ybWFsaXplIHRoZSBib2R5IHF1YXRlcm5pb24KICAgICAqIEBwYXJhbSBxdWF0Tm9ybWFsaXplRmFzdCBJZiB0aGUgcXVhdGVybmlvbiBzaG91bGQgYmUgbm9ybWFsaXplZCB1c2luZyAiZmFzdCIgcXVhdGVybmlvbiBub3JtYWxpemF0aW9uCiAgICAgKi8KCgogICAgaW50ZWdyYXRlKGR0LCBxdWF0Tm9ybWFsaXplLCBxdWF0Tm9ybWFsaXplRmFzdCkgewogICAgICAvLyBTYXZlIHByZXZpb3VzIHBvc2l0aW9uCiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbi5jb3B5KHRoaXMucG9zaXRpb24pOwogICAgICB0aGlzLnByZXZpb3VzUXVhdGVybmlvbi5jb3B5KHRoaXMucXVhdGVybmlvbik7CgogICAgICBpZiAoISh0aGlzLnR5cGUgPT09IEJvZHkuRFlOQU1JQyB8fCB0aGlzLnR5cGUgPT09IEJvZHkuS0lORU1BVElDKSB8fCB0aGlzLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpIHsKICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCB2ZWxvID0gdGhpcy52ZWxvY2l0eTsKICAgICAgY29uc3QgYW5ndWxhclZlbG8gPSB0aGlzLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgY29uc3QgcG9zID0gdGhpcy5wb3NpdGlvbjsKICAgICAgY29uc3QgZm9yY2UgPSB0aGlzLmZvcmNlOwogICAgICBjb25zdCB0b3JxdWUgPSB0aGlzLnRvcnF1ZTsKICAgICAgY29uc3QgcXVhdCA9IHRoaXMucXVhdGVybmlvbjsKICAgICAgY29uc3QgaW52TWFzcyA9IHRoaXMuaW52TWFzczsKICAgICAgY29uc3QgaW52SW5lcnRpYSA9IHRoaXMuaW52SW5lcnRpYVdvcmxkOwogICAgICBjb25zdCBsaW5lYXJGYWN0b3IgPSB0aGlzLmxpbmVhckZhY3RvcjsKICAgICAgY29uc3QgaU1kdCA9IGludk1hc3MgKiBkdDsKICAgICAgdmVsby54ICs9IGZvcmNlLnggKiBpTWR0ICogbGluZWFyRmFjdG9yLng7CiAgICAgIHZlbG8ueSArPSBmb3JjZS55ICogaU1kdCAqIGxpbmVhckZhY3Rvci55OwogICAgICB2ZWxvLnogKz0gZm9yY2UueiAqIGlNZHQgKiBsaW5lYXJGYWN0b3IuejsKICAgICAgY29uc3QgZSA9IGludkluZXJ0aWEuZWxlbWVudHM7CiAgICAgIGNvbnN0IGFuZ3VsYXJGYWN0b3IgPSB0aGlzLmFuZ3VsYXJGYWN0b3I7CiAgICAgIGNvbnN0IHR4ID0gdG9ycXVlLnggKiBhbmd1bGFyRmFjdG9yLng7CiAgICAgIGNvbnN0IHR5ID0gdG9ycXVlLnkgKiBhbmd1bGFyRmFjdG9yLnk7CiAgICAgIGNvbnN0IHR6ID0gdG9ycXVlLnogKiBhbmd1bGFyRmFjdG9yLno7CiAgICAgIGFuZ3VsYXJWZWxvLnggKz0gZHQgKiAoZVswXSAqIHR4ICsgZVsxXSAqIHR5ICsgZVsyXSAqIHR6KTsKICAgICAgYW5ndWxhclZlbG8ueSArPSBkdCAqIChlWzNdICogdHggKyBlWzRdICogdHkgKyBlWzVdICogdHopOwogICAgICBhbmd1bGFyVmVsby56ICs9IGR0ICogKGVbNl0gKiB0eCArIGVbN10gKiB0eSArIGVbOF0gKiB0eik7IC8vIFVzZSBuZXcgdmVsb2NpdHkgIC0gbGVhcCBmcm9nCgogICAgICBwb3MueCArPSB2ZWxvLnggKiBkdDsKICAgICAgcG9zLnkgKz0gdmVsby55ICogZHQ7CiAgICAgIHBvcy56ICs9IHZlbG8ueiAqIGR0OwogICAgICBxdWF0LmludGVncmF0ZSh0aGlzLmFuZ3VsYXJWZWxvY2l0eSwgZHQsIHRoaXMuYW5ndWxhckZhY3RvciwgcXVhdCk7CgogICAgICBpZiAocXVhdE5vcm1hbGl6ZSkgewogICAgICAgIGlmIChxdWF0Tm9ybWFsaXplRmFzdCkgewogICAgICAgICAgcXVhdC5ub3JtYWxpemVGYXN0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHF1YXQubm9ybWFsaXplKCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmFhYmJOZWVkc1VwZGF0ZSA9IHRydWU7IC8vIFVwZGF0ZSB3b3JsZCBpbmVydGlhCgogICAgICB0aGlzLnVwZGF0ZUluZXJ0aWFXb3JsZCgpOwogICAgfQoKICB9CgogIEJvZHkuaWRDb3VudGVyID0gMDsKICBCb2R5LkNPTExJREVfRVZFTlRfTkFNRSA9ICdjb2xsaWRlJzsKICBCb2R5LkRZTkFNSUMgPSBCT0RZX1RZUEVTLkRZTkFNSUM7CiAgQm9keS5TVEFUSUMgPSBCT0RZX1RZUEVTLlNUQVRJQzsKICBCb2R5LktJTkVNQVRJQyA9IEJPRFlfVFlQRVMuS0lORU1BVElDOwogIEJvZHkuQVdBS0UgPSBCT0RZX1NMRUVQX1NUQVRFUy5BV0FLRTsKICBCb2R5LlNMRUVQWSA9IEJPRFlfU0xFRVBfU1RBVEVTLlNMRUVQWTsKICBCb2R5LlNMRUVQSU5HID0gQk9EWV9TTEVFUF9TVEFURVMuU0xFRVBJTkc7CiAgQm9keS53YWtldXBFdmVudCA9IHsKICAgIHR5cGU6ICd3YWtldXAnCiAgfTsKICBCb2R5LnNsZWVweUV2ZW50ID0gewogICAgdHlwZTogJ3NsZWVweScKICB9OwogIEJvZHkuc2xlZXBFdmVudCA9IHsKICAgIHR5cGU6ICdzbGVlcCcKICB9OwogIGNvbnN0IHRtcFZlYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wUXVhdCA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgdXBkYXRlQUFCQl9zaGFwZUFBQkIgPSBuZXcgQUFCQigpOwogIGNvbnN0IHVpd19tMSA9IG5ldyBNYXQzKCk7CiAgY29uc3QgdWl3X20yID0gbmV3IE1hdDMoKTsKICBjb25zdCBCb2R5X2FwcGx5Rm9yY2Vfcm90Rm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3dvcmxkRm9yY2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEZvcmNlX3JlbGF0aXZlUG9pbnRXb3JsZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2VfdmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUltcHVsc2Vfcm90VmVsbyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV9hcHBseUxvY2FsSW1wdWxzZV93b3JsZEltcHVsc2UgPSBuZXcgVmVjMygpOwogIGNvbnN0IEJvZHlfYXBwbHlMb2NhbEltcHVsc2VfcmVsYXRpdmVQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQm9keV91cGRhdGVNYXNzUHJvcGVydGllc19oYWxmRXh0ZW50cyA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQmFzZSBjbGFzcyBmb3IgYnJvYWRwaGFzZSBpbXBsZW1lbnRhdGlvbnMKICAgKiBAYXV0aG9yIHNjaHRlcHBlCiAgICovCgogIGNsYXNzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBUaGUgd29ybGQgdG8gc2VhcmNoIGZvciBjb2xsaXNpb25zIGluLgogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgdGhlIGJyb2FkcGhhc2UgdXNlcyBib3VuZGluZyBib3hlcyBmb3IgaW50ZXJzZWN0aW9uIHRlc3RzLCBlbHNlIGl0IHVzZXMgYm91bmRpbmcgc3BoZXJlcy4KICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIHRydWUgaWYgdGhlIG9iamVjdHMgaW4gdGhlIHdvcmxkIG1vdmVkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy53b3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy51c2VCb3VuZGluZ0JveGVzID0gdm9pZCAwOwogICAgICB0aGlzLmRpcnR5ID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkID0gbnVsbDsKICAgICAgdGhpcy51c2VCb3VuZGluZ0JveGVzID0gZmFsc2U7CiAgICAgIHRoaXMuZGlydHkgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNvbGxpc2lvbiBwYWlycyBmcm9tIHRoZSB3b3JsZAogICAgICogQHBhcmFtIHdvcmxkIFRoZSB3b3JsZCB0byBzZWFyY2ggaW4KICAgICAqIEBwYXJhbSBwMSBFbXB0eSBhcnJheSB0byBiZSBmaWxsZWQgd2l0aCBib2R5IG9iamVjdHMKICAgICAqIEBwYXJhbSBwMiBFbXB0eSBhcnJheSB0byBiZSBmaWxsZWQgd2l0aCBib2R5IG9iamVjdHMKICAgICAqLwoKCiAgICBjb2xsaXNpb25QYWlycyh3b3JsZCwgcDEsIHAyKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY29sbGlzaW9uUGFpcnMgbm90IGltcGxlbWVudGVkIGZvciB0aGlzIEJyb2FkUGhhc2UgY2xhc3MhJyk7CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIGEgYm9keSBwYWlyIG5lZWRzIHRvIGJlIGludGVyc2VjdGlvbiB0ZXN0ZWQgYXQgYWxsLgogICAgICovCgoKICAgIG5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJvZHlBLCBib2R5QikgewogICAgICAvLyBDaGVjayBjb2xsaXNpb24gZmlsdGVyIG1hc2tzCiAgICAgIGlmICgoYm9keUEuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5Qi5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCB8fCAoYm9keUIuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5QS5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBDaGVjayB0eXBlcwoKCiAgICAgIGlmICgoKGJvZHlBLnR5cGUgJiBCb2R5LlNUQVRJQykgIT09IDAgfHwgYm9keUEuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORykgJiYgKChib2R5Qi50eXBlICYgQm9keS5TVEFUSUMpICE9PSAwIHx8IGJvZHlCLnNsZWVwU3RhdGUgPT09IEJvZHkuU0xFRVBJTkcpKSB7CiAgICAgICAgLy8gQm90aCBib2RpZXMgYXJlIHN0YXRpYyBvciBzbGVlcGluZy4gU2tpcC4KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgdm9sdW1lcyBvZiB0d28gYm9kaWVzIGludGVyc2VjdC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3Rpb25UZXN0KGJvZHlBLCBib2R5QiwgcGFpcnMxLCBwYWlyczIpIHsKICAgICAgaWYgKHRoaXMudXNlQm91bmRpbmdCb3hlcykgewogICAgICAgIHRoaXMuZG9Cb3VuZGluZ0JveEJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kb0JvdW5kaW5nU3BoZXJlQnJvYWRwaGFzZShib2R5QSwgYm9keUIsIHBhaXJzMSwgcGFpcnMyKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgc3BoZXJlcyBvZiB0d28gYm9kaWVzIGFyZSBpbnRlcnNlY3RpbmcuCiAgICAgKiBAcGFyYW0gcGFpcnMxIGJvZHlBIGlzIGFwcGVuZGVkIHRvIHRoaXMgYXJyYXkgaWYgaW50ZXJzZWN0aW9uCiAgICAgKiBAcGFyYW0gcGFpcnMyIGJvZHlCIGlzIGFwcGVuZGVkIHRvIHRoaXMgYXJyYXkgaWYgaW50ZXJzZWN0aW9uCiAgICAgKi8KCgogICAgZG9Cb3VuZGluZ1NwaGVyZUJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMikgewogICAgICBjb25zdCByID0gQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yOwogICAgICBib2R5Qi5wb3NpdGlvbi52c3ViKGJvZHlBLnBvc2l0aW9uLCByKTsKICAgICAgY29uc3QgYm91bmRpbmdSYWRpdXNTdW0yID0gKGJvZHlBLmJvdW5kaW5nUmFkaXVzICsgYm9keUIuYm91bmRpbmdSYWRpdXMpICoqIDI7CiAgICAgIGNvbnN0IG5vcm0yID0gci5sZW5ndGhTcXVhcmVkKCk7CgogICAgICBpZiAobm9ybTIgPCBib3VuZGluZ1JhZGl1c1N1bTIpIHsKICAgICAgICBwYWlyczEucHVzaChib2R5QSk7CiAgICAgICAgcGFpcnMyLnB1c2goYm9keUIpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENoZWNrIGlmIHRoZSBib3VuZGluZyBib3hlcyBvZiB0d28gYm9kaWVzIGFyZSBpbnRlcnNlY3RpbmcuCiAgICAgKi8KCgogICAgZG9Cb3VuZGluZ0JveEJyb2FkcGhhc2UoYm9keUEsIGJvZHlCLCBwYWlyczEsIHBhaXJzMikgewogICAgICBpZiAoYm9keUEuYWFiYk5lZWRzVXBkYXRlKSB7CiAgICAgICAgYm9keUEudXBkYXRlQUFCQigpOwogICAgICB9CgogICAgICBpZiAoYm9keUIuYWFiYk5lZWRzVXBkYXRlKSB7CiAgICAgICAgYm9keUIudXBkYXRlQUFCQigpOwogICAgICB9IC8vIENoZWNrIEFBQkIgLyBBQUJCCgoKICAgICAgaWYgKGJvZHlBLmFhYmIub3ZlcmxhcHMoYm9keUIuYWFiYikpIHsKICAgICAgICBwYWlyczEucHVzaChib2R5QSk7CiAgICAgICAgcGFpcnMyLnB1c2goYm9keUIpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJlbW92ZXMgZHVwbGljYXRlIHBhaXJzIGZyb20gdGhlIHBhaXIgYXJyYXlzLgogICAgICovCgoKICAgIG1ha2VQYWlyc1VuaXF1ZShwYWlyczEsIHBhaXJzMikgewogICAgICBjb25zdCB0ID0gQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfdGVtcDsKICAgICAgY29uc3QgcDEgPSBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV9wMTsKICAgICAgY29uc3QgcDIgPSBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV9wMjsKICAgICAgY29uc3QgTiA9IHBhaXJzMS5sZW5ndGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgcDFbaV0gPSBwYWlyczFbaV07CiAgICAgICAgcDJbaV0gPSBwYWlyczJbaV07CiAgICAgIH0KCiAgICAgIHBhaXJzMS5sZW5ndGggPSAwOwogICAgICBwYWlyczIubGVuZ3RoID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBpZDEgPSBwMVtpXS5pZDsKICAgICAgICBjb25zdCBpZDIgPSBwMltpXS5pZDsKICAgICAgICBjb25zdCBrZXkgPSBpZDEgPCBpZDIgPyBpZDEgKyAiLCIgKyBpZDIgOiBpZDIgKyAiLCIgKyBpZDE7CiAgICAgICAgdFtrZXldID0gaTsKICAgICAgICB0LmtleXMucHVzaChrZXkpOwogICAgICB9CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gdC5rZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3Qga2V5ID0gdC5rZXlzLnBvcCgpOwogICAgICAgIGNvbnN0IHBhaXJJbmRleCA9IHRba2V5XTsKICAgICAgICBwYWlyczEucHVzaChwMVtwYWlySW5kZXhdKTsKICAgICAgICBwYWlyczIucHVzaChwMltwYWlySW5kZXhdKTsKICAgICAgICBkZWxldGUgdFtrZXldOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFRvIGJlIGltcGxlbWVudGVkIGJ5IHN1YmNhc3NlcwogICAgICovCgoKICAgIHNldFdvcmxkKHdvcmxkKSB7fQogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRpbmcgc3BoZXJlcyBvZiB0d28gYm9kaWVzIG92ZXJsYXAuCiAgICAgKi8KCgogICAgc3RhdGljIGJvdW5kaW5nU3BoZXJlQ2hlY2soYm9keUEsIGJvZHlCKSB7CiAgICAgIGNvbnN0IGRpc3QgPSBuZXcgVmVjMygpOyAvLyBic2NfZGlzdDsKCiAgICAgIGJvZHlBLnBvc2l0aW9uLnZzdWIoYm9keUIucG9zaXRpb24sIGRpc3QpOwogICAgICBjb25zdCBzYSA9IGJvZHlBLnNoYXBlc1swXTsKICAgICAgY29uc3Qgc2IgPSBib2R5Qi5zaGFwZXNbMF07CiAgICAgIHJldHVybiBNYXRoLnBvdyhzYS5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIHNiLmJvdW5kaW5nU3BoZXJlUmFkaXVzLCAyKSA+IGRpc3QubGVuZ3RoU3F1YXJlZCgpOwogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiB0aGUgQUFCQi4KICAgICAqLwoKCiAgICBhYWJiUXVlcnkod29ybGQsIGFhYmIsIHJlc3VsdCkgewogICAgICBjb25zb2xlLndhcm4oJy5hYWJiUXVlcnkgaXMgbm90IGltcGxlbWVudGVkIGluIHRoaXMgQnJvYWRwaGFzZSBzdWJjbGFzcy4nKTsKICAgICAgcmV0dXJuIFtdOwogICAgfQoKICB9IC8vIFRlbXAgb2JqZWN0cwoKCiAgY29uc3QgQnJvYWRwaGFzZV9jb2xsaXNpb25QYWlyc19yID0gbmV3IFZlYzMoKTsKICBjb25zdCBCcm9hZHBoYXNlX21ha2VQYWlyc1VuaXF1ZV90ZW1wID0gewogICAga2V5czogW10KICB9OwogIGNvbnN0IEJyb2FkcGhhc2VfbWFrZVBhaXJzVW5pcXVlX3AxID0gW107CiAgY29uc3QgQnJvYWRwaGFzZV9tYWtlUGFpcnNVbmlxdWVfcDIgPSBbXTsKCiAgbmV3IFZlYzMoKTsKICAvKioKICAgKiBOYWl2ZSBicm9hZHBoYXNlIGltcGxlbWVudGF0aW9uLCB1c2VkIGluIGxhY2sgb2YgYmV0dGVyIG9uZXMuCiAgICoKICAgKiBUaGUgbmFpdmUgYnJvYWRwaGFzZSBsb29rcyBhdCBhbGwgcG9zc2libGUgcGFpcnMgd2l0aG91dCByZXN0cmljdGlvbiwgdGhlcmVmb3JlIGl0IGhhcyBjb21wbGV4aXR5IE5eMiBfKHdoaWNoIGlzIGJhZClfCiAgICovCgogIGNsYXNzIE5haXZlQnJvYWRwaGFzZSBleHRlbmRzIEJyb2FkcGhhc2UgewogICAgLyoqCiAgICAgKiBAdG9kbyBSZW1vdmUgdXNlbGVzcyBjb25zdHJ1Y3RvcgogICAgICovCiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgc3VwZXIoKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGFsbCB0aGUgY29sbGlzaW9uIHBhaXJzIGluIHRoZSBwaHlzaWNzIHdvcmxkCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHBhaXJzMSwgcGFpcnMyKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgbiA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGxldCBiaTsKICAgICAgbGV0IGJqOyAvLyBOYWl2ZSBOXjIgZnR3IQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IG47IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBpOyBqKyspIHsKICAgICAgICAgIGJpID0gYm9kaWVzW2ldOwogICAgICAgICAgYmogPSBib2RpZXNbal07CgogICAgICAgICAgaWYgKCF0aGlzLm5lZWRCcm9hZHBoYXNlQ29sbGlzaW9uKGJpLCBiaikpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcGFpcnMxLCBwYWlyczIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0ID0gW10pIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3JsZC5ib2RpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBiID0gd29ybGQuYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYi5hYWJiTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIGIudXBkYXRlQUFCQigpOwogICAgICAgIH0gLy8gVWdseSBoYWNrIHVudGlsIEJvZHkgZ2V0cyBhYWJiCgoKICAgICAgICBpZiAoYi5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICByZXN1bHQucHVzaChiKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CgogIH0KICAvKioKICAgKiBTdG9yYWdlIGZvciBSYXkgY2FzdGluZyBkYXRhCiAgICovCgoKICBjbGFzcyBSYXljYXN0UmVzdWx0IHsKICAgIC8qKgogICAgICogcmF5RnJvbVdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIHJheVRvV29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGl0Tm9ybWFsV29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogaGl0UG9pbnRXb3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBoYXNIaXQKICAgICAqLwoKICAgIC8qKgogICAgICogc2hhcGUKICAgICAqLwoKICAgIC8qKgogICAgICogYm9keQogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgaW5kZXggb2YgdGhlIGhpdCB0cmlhbmdsZSwgaWYgdGhlIGhpdCBzaGFwZSB3YXMgYSB0cmltZXNoCiAgICAgKi8KCiAgICAvKioKICAgICAqIERpc3RhbmNlIHRvIHRoZSBoaXQuIFdpbGwgYmUgc2V0IHRvIC0xIGlmIHRoZXJlIHdhcyBubyBoaXQKICAgICAqLwoKICAgIC8qKgogICAgICogSWYgdGhlIHJheSBzaG91bGQgc3RvcCB0cmF2ZXJzaW5nIHRoZSBib2RpZXMKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMucmF5RnJvbVdvcmxkID0gdm9pZCAwOwogICAgICB0aGlzLnJheVRvV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuaGl0UG9pbnRXb3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy5oYXNIaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2hhcGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9keSA9IHZvaWQgMDsKICAgICAgdGhpcy5oaXRGYWNlSW5kZXggPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2hvdWxkU3RvcCA9IHZvaWQgMDsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnJheVRvV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmhpdE5vcm1hbFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5oYXNIaXQgPSBmYWxzZTsKICAgICAgdGhpcy5zaGFwZSA9IG51bGw7CiAgICAgIHRoaXMuYm9keSA9IG51bGw7CiAgICAgIHRoaXMuaGl0RmFjZUluZGV4ID0gLTE7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSAtMTsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIFJlc2V0IGFsbCByZXN1bHQgZGF0YS4KICAgICAqLwoKCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5yYXlGcm9tV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLnJheVRvV29ybGQuc2V0WmVybygpOwogICAgICB0aGlzLmhpdE5vcm1hbFdvcmxkLnNldFplcm8oKTsKICAgICAgdGhpcy5oaXRQb2ludFdvcmxkLnNldFplcm8oKTsKICAgICAgdGhpcy5oYXNIaXQgPSBmYWxzZTsKICAgICAgdGhpcy5zaGFwZSA9IG51bGw7CiAgICAgIHRoaXMuYm9keSA9IG51bGw7CiAgICAgIHRoaXMuaGl0RmFjZUluZGV4ID0gLTE7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSAtMTsKICAgICAgdGhpcy5zaG91bGRTdG9wID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIGFib3J0CiAgICAgKi8KCgogICAgYWJvcnQoKSB7CiAgICAgIHRoaXMuc2hvdWxkU3RvcCA9IHRydWU7CiAgICB9CiAgICAvKioKICAgICAqIFNldCByZXN1bHQgZGF0YS4KICAgICAqLwoKCiAgICBzZXQocmF5RnJvbVdvcmxkLCByYXlUb1dvcmxkLCBoaXROb3JtYWxXb3JsZCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKSB7CiAgICAgIHRoaXMucmF5RnJvbVdvcmxkLmNvcHkocmF5RnJvbVdvcmxkKTsKICAgICAgdGhpcy5yYXlUb1dvcmxkLmNvcHkocmF5VG9Xb3JsZCk7CiAgICAgIHRoaXMuaGl0Tm9ybWFsV29ybGQuY29weShoaXROb3JtYWxXb3JsZCk7CiAgICAgIHRoaXMuaGl0UG9pbnRXb3JsZC5jb3B5KGhpdFBvaW50V29ybGQpOwogICAgICB0aGlzLnNoYXBlID0gc2hhcGU7CiAgICAgIHRoaXMuYm9keSA9IGJvZHk7CiAgICAgIHRoaXMuZGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgIH0KCiAgfQoKICBsZXQgX1NoYXBlJHR5cGVzJFNQSEVSRSwgX1NoYXBlJHR5cGVzJFBMQU5FLCBfU2hhcGUkdHlwZXMkQk9YLCBfU2hhcGUkdHlwZXMkQ1lMSU5ERVIsIF9TaGFwZSR0eXBlcyRDT05WRVhQTywgX1NoYXBlJHR5cGVzJEhFSUdIVEZJLCBfU2hhcGUkdHlwZXMkVFJJTUVTSDsKICAvKioKICAgKiBSQVlfTU9ERVMKICAgKi8KCgogIGNvbnN0IFJBWV9NT0RFUyA9IHsKICAgIC8qKiBDTE9TRVNUICovCiAgICBDTE9TRVNUOiAxLAoKICAgIC8qKiBBTlkgKi8KICAgIEFOWTogMiwKCiAgICAvKiogQUxMICovCiAgICBBTEw6IDQKICB9OwogIC8qKgogICAqIFJheU1vZGUKICAgKi8KCiAgX1NoYXBlJHR5cGVzJFNQSEVSRSA9IFNoYXBlLnR5cGVzLlNQSEVSRTsKICBfU2hhcGUkdHlwZXMkUExBTkUgPSBTaGFwZS50eXBlcy5QTEFORTsKICBfU2hhcGUkdHlwZXMkQk9YID0gU2hhcGUudHlwZXMuQk9YOwogIF9TaGFwZSR0eXBlcyRDWUxJTkRFUiA9IFNoYXBlLnR5cGVzLkNZTElOREVSOwogIF9TaGFwZSR0eXBlcyRDT05WRVhQTyA9IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST047CiAgX1NoYXBlJHR5cGVzJEhFSUdIVEZJID0gU2hhcGUudHlwZXMuSEVJR0hURklFTEQ7CiAgX1NoYXBlJHR5cGVzJFRSSU1FU0ggPSBTaGFwZS50eXBlcy5UUklNRVNIOwogIC8qKgogICAqIEEgbGluZSBpbiAzRCBzcGFjZSB0aGF0IGludGVyc2VjdHMgYm9kaWVzIGFuZCByZXR1cm4gcG9pbnRzLgogICAqLwoKICBjbGFzcyBSYXkgewogICAgLyoqCiAgICAgKiBmcm9tCiAgICAgKi8KCiAgICAvKioKICAgICAqIHRvCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRpcmVjdGlvbgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgcHJlY2lzaW9uIG9mIHRoZSByYXkuIFVzZWQgd2hlbiBjaGVja2luZyBwYXJhbGxlbGl0eSBldGMuCiAgICAgKiBAZGVmYXVsdCAwLjAwMDEKICAgICAqLwoKICAgIC8qKgogICAgICogU2V0IHRvIGBmYWxzZWAgaWYgeW91IGRvbid0IHdhbnQgdGhlIFJheSB0byB0YWtlIGBjb2xsaXNpb25SZXNwb25zZWAgZmxhZ3MgaW50byBhY2NvdW50IG9uIGJvZGllcyBhbmQgc2hhcGVzLgogICAgICogQGRlZmF1bHQgdHJ1ZQogICAgICovCgogICAgLyoqCiAgICAgKiBJZiBzZXQgdG8gYHRydWVgLCB0aGUgcmF5IHNraXBzIGFueSBoaXRzIHdpdGggbm9ybWFsLmRvdChyYXlEaXJlY3Rpb24pIDwgMC4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbkZpbHRlck1hc2sKICAgICAqIEBkZWZhdWx0IC0xCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNvbGxpc2lvbkZpbHRlckdyb3VwCiAgICAgKiBAZGVmYXVsdCAtMQogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgaW50ZXJzZWN0aW9uIG1vZGUuIFNob3VsZCBiZSBSYXkuQU5ZLCBSYXkuQUxMIG9yIFJheS5DTE9TRVNULgogICAgICogQGRlZmF1bHQgUkFZLkFOWQogICAgICovCgogICAgLyoqCiAgICAgKiBDdXJyZW50IHJlc3VsdCBvYmplY3QuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdpbGwgYmUgc2V0IHRvIGB0cnVlYCBkdXJpbmcgaW50ZXJzZWN0V29ybGQoKSBpZiB0aGUgcmF5IGhpdCBhbnl0aGluZy4KICAgICAqLwoKICAgIC8qKgogICAgICogVXNlci1wcm92aWRlZCByZXN1bHQgY2FsbGJhY2suIFdpbGwgYmUgdXNlZCBpZiBtb2RlIGlzIFJheS5BTEwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIENMT1NFU1QKICAgICAqLwoKICAgIC8qKgogICAgICogQU5ZCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFMTAogICAgICovCiAgICBnZXQgW19TaGFwZSR0eXBlcyRTUEhFUkVdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0U3BoZXJlOwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJFBMQU5FXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFBsYW5lOwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJEJPWF0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RCb3g7CiAgICB9CgogICAgZ2V0IFtfU2hhcGUkdHlwZXMkQ1lMSU5ERVJdKCkgewogICAgICByZXR1cm4gdGhpcy5faW50ZXJzZWN0Q29udmV4OwogICAgfQoKICAgIGdldCBbX1NoYXBlJHR5cGVzJENPTlZFWFBPXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRIRUlHSFRGSV0oKSB7CiAgICAgIHJldHVybiB0aGlzLl9pbnRlcnNlY3RIZWlnaHRmaWVsZDsKICAgIH0KCiAgICBnZXQgW19TaGFwZSR0eXBlcyRUUklNRVNIXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdFRyaW1lc2g7CiAgICB9CgogICAgY29uc3RydWN0b3IoZnJvbSA9IG5ldyBWZWMzKCksIHRvID0gbmV3IFZlYzMoKSkgewogICAgICB0aGlzLmZyb20gPSB2b2lkIDA7CiAgICAgIHRoaXMudG8gPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnByZWNpc2lvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5jaGVja0NvbGxpc2lvblJlc3BvbnNlID0gdm9pZCAwOwogICAgICB0aGlzLnNraXBCYWNrZmFjZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHZvaWQgMDsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IHZvaWQgMDsKICAgICAgdGhpcy5tb2RlID0gdm9pZCAwOwogICAgICB0aGlzLnJlc3VsdCA9IHZvaWQgMDsKICAgICAgdGhpcy5oYXNIaXQgPSB2b2lkIDA7CiAgICAgIHRoaXMuY2FsbGJhY2sgPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJvbSA9IGZyb20uY2xvbmUoKTsKICAgICAgdGhpcy50byA9IHRvLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5wcmVjaXNpb24gPSAwLjAwMDE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRydWU7CiAgICAgIHRoaXMuc2tpcEJhY2tmYWNlcyA9IGZhbHNlOwogICAgICB0aGlzLmNvbGxpc2lvbkZpbHRlck1hc2sgPSAtMTsKICAgICAgdGhpcy5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IC0xOwogICAgICB0aGlzLm1vZGUgPSBSYXkuQU5ZOwogICAgICB0aGlzLnJlc3VsdCA9IG5ldyBSYXljYXN0UmVzdWx0KCk7CiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CgogICAgICB0aGlzLmNhbGxiYWNrID0gcmVzdWx0ID0+IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBEbyBpdGVyc2VjdGlvbiBhZ2FpbnN0IGFsbCBib2RpZXMgaW4gdGhlIGdpdmVuIFdvcmxkLgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSByYXkgaGl0IGFueXRoaW5nLCBvdGhlcndpc2UgZmFsc2UuCiAgICAgKi8KCgogICAgaW50ZXJzZWN0V29ybGQod29ybGQsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlIHx8IFJheS5BTlk7CiAgICAgIHRoaXMucmVzdWx0ID0gb3B0aW9ucy5yZXN1bHQgfHwgbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy5za2lwQmFja2ZhY2VzID0gISFvcHRpb25zLnNraXBCYWNrZmFjZXM7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyTWFzayA9IHR5cGVvZiBvcHRpb25zLmNvbGxpc2lvbkZpbHRlck1hc2sgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJNYXNrIDogLTE7CiAgICAgIHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgPSB0eXBlb2Ygb3B0aW9ucy5jb2xsaXNpb25GaWx0ZXJHcm91cCAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmNvbGxpc2lvbkZpbHRlckdyb3VwIDogLTE7CiAgICAgIHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHR5cGVvZiBvcHRpb25zLmNoZWNrQ29sbGlzaW9uUmVzcG9uc2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5jaGVja0NvbGxpc2lvblJlc3BvbnNlIDogdHJ1ZTsKCiAgICAgIGlmIChvcHRpb25zLmZyb20pIHsKICAgICAgICB0aGlzLmZyb20uY29weShvcHRpb25zLmZyb20pOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy50bykgewogICAgICAgIHRoaXMudG8uY29weShvcHRpb25zLnRvKTsKICAgICAgfQoKICAgICAgdGhpcy5jYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2sgfHwgKCgpID0+IHt9KTsKCiAgICAgIHRoaXMuaGFzSGl0ID0gZmFsc2U7CiAgICAgIHRoaXMucmVzdWx0LnJlc2V0KCk7CiAgICAgIHRoaXMudXBkYXRlRGlyZWN0aW9uKCk7CiAgICAgIHRoaXMuZ2V0QUFCQih0bXBBQUJCJDEpOwogICAgICB0bXBBcnJheS5sZW5ndGggPSAwOwogICAgICB3b3JsZC5icm9hZHBoYXNlLmFhYmJRdWVyeSh3b3JsZCwgdG1wQUFCQiQxLCB0bXBBcnJheSk7CiAgICAgIHRoaXMuaW50ZXJzZWN0Qm9kaWVzKHRtcEFycmF5KTsKICAgICAgcmV0dXJuIHRoaXMuaGFzSGl0OwogICAgfQogICAgLyoqCiAgICAgKiBTaG9vdCBhIHJheSBhdCBhIGJvZHksIGdldCBiYWNrIGluZm9ybWF0aW9uIGFib3V0IHRoZSBoaXQuCiAgICAgKiBAZGVwcmVjYXRlZCBAcGFyYW0gcmVzdWx0IHNldCB0aGUgcmVzdWx0IHByb3BlcnR5IG9mIHRoZSBSYXkgaW5zdGVhZC4KICAgICAqLwoKCiAgICBpbnRlcnNlY3RCb2R5KGJvZHksIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgY29uc3QgY2hlY2tDb2xsaXNpb25SZXNwb25zZSA9IHRoaXMuY2hlY2tDb2xsaXNpb25SZXNwb25zZTsKCiAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFib2R5LmNvbGxpc2lvblJlc3BvbnNlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoKHRoaXMuY29sbGlzaW9uRmlsdGVyR3JvdXAgJiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2spID09PSAwIHx8IChib2R5LmNvbGxpc2lvbkZpbHRlckdyb3VwICYgdGhpcy5jb2xsaXNpb25GaWx0ZXJNYXNrKSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgeGkgPSBpbnRlcnNlY3RCb2R5X3hpOwogICAgICBjb25zdCBxaSA9IGludGVyc2VjdEJvZHlfcWk7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IGJvZHkuc2hhcGVzLmxlbmd0aDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHNoYXBlID0gYm9keS5zaGFwZXNbaV07CgogICAgICAgIGlmIChjaGVja0NvbGxpc2lvblJlc3BvbnNlICYmICFzaGFwZS5jb2xsaXNpb25SZXNwb25zZSkgewogICAgICAgICAgY29udGludWU7IC8vIFNraXAKICAgICAgICB9CgogICAgICAgIGJvZHkucXVhdGVybmlvbi5tdWx0KGJvZHkuc2hhcGVPcmllbnRhdGlvbnNbaV0sIHFpKTsKICAgICAgICBib2R5LnF1YXRlcm5pb24udm11bHQoYm9keS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICB4aS52YWRkKGJvZHkucG9zaXRpb24sIHhpKTsKICAgICAgICB0aGlzLmludGVyc2VjdFNoYXBlKHNoYXBlLCBxaSwgeGksIGJvZHkpOwoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFNob290IGEgcmF5IGF0IGFuIGFycmF5IGJvZGllcywgZ2V0IGJhY2sgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhpdC4KICAgICAqIEBwYXJhbSBib2RpZXMgQW4gYXJyYXkgb2YgQm9keSBvYmplY3RzLgogICAgICogQGRlcHJlY2F0ZWQgQHBhcmFtIHJlc3VsdCBzZXQgdGhlIHJlc3VsdCBwcm9wZXJ0eSBvZiB0aGUgUmF5IGluc3RlYWQuCiAgICAgKgogICAgICovCgoKICAgIGludGVyc2VjdEJvZGllcyhib2RpZXMsIHJlc3VsdCkgewogICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgICAgdGhpcy51cGRhdGVEaXJlY3Rpb24oKTsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBib2RpZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpIDwgbDsgaSsrKSB7CiAgICAgICAgdGhpcy5pbnRlcnNlY3RCb2R5KGJvZGllc1tpXSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlcyB0aGUgZGlyZWN0aW9uIHZlY3Rvci4KICAgICAqLwoKCiAgICB1cGRhdGVEaXJlY3Rpb24oKSB7CiAgICAgIHRoaXMudG8udnN1Yih0aGlzLmZyb20sIHRoaXMuZGlyZWN0aW9uKTsKICAgICAgdGhpcy5kaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICB9CgogICAgaW50ZXJzZWN0U2hhcGUoc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5KSB7CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207IC8vIENoZWNraW5nIGJvdW5kaW5nU3BoZXJlCgogICAgICBjb25zdCBkaXN0YW5jZSA9IGRpc3RhbmNlRnJvbUludGVyc2VjdGlvbihmcm9tLCB0aGlzLmRpcmVjdGlvbiwgcG9zaXRpb24pOwoKICAgICAgaWYgKGRpc3RhbmNlID4gc2hhcGUuYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnN0IGludGVyc2VjdE1ldGhvZCA9IHRoaXNbc2hhcGUudHlwZV07CgogICAgICBpZiAoaW50ZXJzZWN0TWV0aG9kKSB7CiAgICAgICAgaW50ZXJzZWN0TWV0aG9kLmNhbGwodGhpcywgc2hhcGUsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCBzaGFwZSk7CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Qm94KGJveCwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2ludGVyc2VjdENvbnZleChib3guY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSk7CiAgICB9CgogICAgX2ludGVyc2VjdFBsYW5lKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBjb25zdCBmcm9tID0gdGhpcy5mcm9tOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOyAvLyBHZXQgcGxhbmUgbm9ybWFsCgogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IG5ldyBWZWMzKDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KHdvcmxkTm9ybWFsLCB3b3JsZE5vcm1hbCk7CiAgICAgIGNvbnN0IGxlbiA9IG5ldyBWZWMzKCk7CiAgICAgIGZyb20udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb0Zyb20gPSBsZW4uZG90KHdvcmxkTm9ybWFsKTsKICAgICAgdG8udnN1Yihwb3NpdGlvbiwgbGVuKTsKICAgICAgY29uc3QgcGxhbmVUb1RvID0gbGVuLmRvdCh3b3JsZE5vcm1hbCk7CgogICAgICBpZiAocGxhbmVUb0Zyb20gKiBwbGFuZVRvVG8gPiAwKSB7CiAgICAgICAgLy8gImZyb20iIGFuZCAidG8iIGFyZSBvbiB0aGUgc2FtZSBzaWRlIG9mIHRoZSBwbGFuZS4uLiBiYWlsIG91dAogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGZyb20uZGlzdGFuY2VUbyh0bykgPCBwbGFuZVRvRnJvbSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3Qgbl9kb3RfZGlyID0gd29ybGROb3JtYWwuZG90KGRpcmVjdGlvbik7CgogICAgICBpZiAoTWF0aC5hYnMobl9kb3RfZGlyKSA8IHRoaXMucHJlY2lzaW9uKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwbGFuZVBvaW50VG9Gcm9tID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgZGlyX3NjYWxlZF93aXRoX3QgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBoaXRQb2ludFdvcmxkID0gbmV3IFZlYzMoKTsKICAgICAgZnJvbS52c3ViKHBvc2l0aW9uLCBwbGFuZVBvaW50VG9Gcm9tKTsKICAgICAgY29uc3QgdCA9IC13b3JsZE5vcm1hbC5kb3QocGxhbmVQb2ludFRvRnJvbSkgLyBuX2RvdF9kaXI7CiAgICAgIGRpcmVjdGlvbi5zY2FsZSh0LCBkaXJfc2NhbGVkX3dpdGhfdCk7CiAgICAgIGZyb20udmFkZChkaXJfc2NhbGVkX3dpdGhfdCwgaGl0UG9pbnRXb3JsZCk7CiAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKHdvcmxkTm9ybWFsLCBoaXRQb2ludFdvcmxkLCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgd29ybGQgQUFCQiBvZiB0aGUgcmF5LgogICAgICovCgoKICAgIGdldEFBQkIoYWFiYikgewogICAgICBjb25zdCB7CiAgICAgICAgbG93ZXJCb3VuZCwKICAgICAgICB1cHBlckJvdW5kCiAgICAgIH0gPSBhYWJiOwogICAgICBjb25zdCB0byA9IHRoaXMudG87CiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGxvd2VyQm91bmQueCA9IE1hdGgubWluKHRvLngsIGZyb20ueCk7CiAgICAgIGxvd2VyQm91bmQueSA9IE1hdGgubWluKHRvLnksIGZyb20ueSk7CiAgICAgIGxvd2VyQm91bmQueiA9IE1hdGgubWluKHRvLnosIGZyb20ueik7CiAgICAgIHVwcGVyQm91bmQueCA9IE1hdGgubWF4KHRvLngsIGZyb20ueCk7CiAgICAgIHVwcGVyQm91bmQueSA9IE1hdGgubWF4KHRvLnksIGZyb20ueSk7CiAgICAgIHVwcGVyQm91bmQueiA9IE1hdGgubWF4KHRvLnosIGZyb20ueik7CiAgICB9CgogICAgX2ludGVyc2VjdEhlaWdodGZpZWxkKHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSkgewogICAgICBzaGFwZS5kYXRhOwogICAgICBzaGFwZS5lbGVtZW50U2l6ZTsgLy8gQ29udmVydCB0aGUgcmF5IHRvIGxvY2FsIGhlaWdodGZpZWxkIGNvb3JkaW5hdGVzCgogICAgICBjb25zdCBsb2NhbFJheSA9IGludGVyc2VjdEhlaWdodGZpZWxkX2xvY2FsUmF5OyAvL25ldyBSYXkodGhpcy5mcm9tLCB0aGlzLnRvKTsKCiAgICAgIGxvY2FsUmF5LmZyb20uY29weSh0aGlzLmZyb20pOwogICAgICBsb2NhbFJheS50by5jb3B5KHRoaXMudG8pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LmZyb20sIGxvY2FsUmF5LmZyb20pOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUocG9zaXRpb24sIHF1YXQsIGxvY2FsUmF5LnRvLCBsb2NhbFJheS50byk7CiAgICAgIGxvY2FsUmF5LnVwZGF0ZURpcmVjdGlvbigpOyAvLyBHZXQgdGhlIGluZGV4IG9mIHRoZSBkYXRhIHBvaW50cyB0byB0ZXN0IGFnYWluc3QKCiAgICAgIGNvbnN0IGluZGV4ID0gaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXg7CiAgICAgIGxldCBpTWluWDsKICAgICAgbGV0IGlNaW5ZOwogICAgICBsZXQgaU1heFg7CiAgICAgIGxldCBpTWF4WTsgLy8gU2V0IHRvIG1heAoKICAgICAgaU1pblggPSBpTWluWSA9IDA7CiAgICAgIGlNYXhYID0gaU1heFkgPSBzaGFwZS5kYXRhLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGFhYmIgPSBuZXcgQUFCQigpOwogICAgICBsb2NhbFJheS5nZXRBQUJCKGFhYmIpOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi5sb3dlckJvdW5kLngsIGFhYmIubG93ZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNaW5YID0gTWF0aC5tYXgoaU1pblgsIGluZGV4WzBdKTsKICAgICAgaU1pblkgPSBNYXRoLm1heChpTWluWSwgaW5kZXhbMV0pOwogICAgICBzaGFwZS5nZXRJbmRleE9mUG9zaXRpb24oYWFiYi51cHBlckJvdW5kLngsIGFhYmIudXBwZXJCb3VuZC55LCBpbmRleCwgdHJ1ZSk7CiAgICAgIGlNYXhYID0gTWF0aC5taW4oaU1heFgsIGluZGV4WzBdICsgMSk7CiAgICAgIGlNYXhZID0gTWF0aC5taW4oaU1heFksIGluZGV4WzFdICsgMSk7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPCBpTWF4WDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IGlNaW5ZOyBqIDwgaU1heFk7IGorKykgewogICAgICAgICAgaWYgKHRoaXMucmVzdWx0LnNob3VsZFN0b3ApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHNoYXBlLmdldEFhYmJBdEluZGV4KGksIGosIGFhYmIpOwoKICAgICAgICAgIGlmICghYWFiYi5vdmVybGFwc1JheShsb2NhbFJheSkpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9IC8vIExvd2VyIHRyaWFuZ2xlCgoKICAgICAgICAgIHNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShwb3NpdGlvbiwgcXVhdCwgc2hhcGUucGlsbGFyT2Zmc2V0LCB3b3JsZFBpbGxhck9mZnNldCk7CgogICAgICAgICAgdGhpcy5faW50ZXJzZWN0Q29udmV4KHNoYXBlLnBpbGxhckNvbnZleCwgcXVhdCwgd29ybGRQaWxsYXJPZmZzZXQsIGJvZHksIHJlcG9ydGVkU2hhcGUsIGludGVyc2VjdENvbnZleE9wdGlvbnMpOwoKICAgICAgICAgIGlmICh0aGlzLnJlc3VsdC5zaG91bGRTdG9wKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgc2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIHNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIHRoaXMuX2ludGVyc2VjdENvbnZleChzaGFwZS5waWxsYXJDb252ZXgsIHF1YXQsIHdvcmxkUGlsbGFyT2Zmc2V0LCBib2R5LCByZXBvcnRlZFNoYXBlLCBpbnRlcnNlY3RDb252ZXhPcHRpb25zKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0U3BoZXJlKHNwaGVyZSwgcXVhdCwgcG9zaXRpb24sIGJvZHksIHJlcG9ydGVkU2hhcGUpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCByID0gc3BoZXJlLnJhZGl1czsKICAgICAgY29uc3QgYSA9ICh0by54IC0gZnJvbS54KSAqKiAyICsgKHRvLnkgLSBmcm9tLnkpICoqIDIgKyAodG8ueiAtIGZyb20ueikgKiogMjsKICAgICAgY29uc3QgYiA9IDIgKiAoKHRvLnggLSBmcm9tLngpICogKGZyb20ueCAtIHBvc2l0aW9uLngpICsgKHRvLnkgLSBmcm9tLnkpICogKGZyb20ueSAtIHBvc2l0aW9uLnkpICsgKHRvLnogLSBmcm9tLnopICogKGZyb20ueiAtIHBvc2l0aW9uLnopKTsKICAgICAgY29uc3QgYyA9IChmcm9tLnggLSBwb3NpdGlvbi54KSAqKiAyICsgKGZyb20ueSAtIHBvc2l0aW9uLnkpICoqIDIgKyAoZnJvbS56IC0gcG9zaXRpb24ueikgKiogMiAtIHIgKiogMjsKICAgICAgY29uc3QgZGVsdGEgPSBiICoqIDIgLSA0ICogYSAqIGM7CiAgICAgIGNvbnN0IGludGVyc2VjdGlvblBvaW50ID0gUmF5X2ludGVyc2VjdFNwaGVyZV9pbnRlcnNlY3Rpb25Qb2ludDsKICAgICAgY29uc3Qgbm9ybWFsID0gUmF5X2ludGVyc2VjdFNwaGVyZV9ub3JtYWw7CgogICAgICBpZiAoZGVsdGEgPCAwKSB7CiAgICAgICAgLy8gTm8gaW50ZXJzZWN0aW9uCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKGRlbHRhID09PSAwKSB7CiAgICAgICAgLy8gc2luZ2xlIGludGVyc2VjdGlvbiBwb2ludAogICAgICAgIGZyb20ubGVycCh0bywgZGVsdGEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICBpbnRlcnNlY3Rpb25Qb2ludC52c3ViKHBvc2l0aW9uLCBub3JtYWwpOwogICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgZDEgPSAoLWIgLSBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CiAgICAgICAgY29uc3QgZDIgPSAoLWIgKyBNYXRoLnNxcnQoZGVsdGEpKSAvICgyICogYSk7CgogICAgICAgIGlmIChkMSA+PSAwICYmIGQxIDw9IDEpIHsKICAgICAgICAgIGZyb20ubGVycCh0bywgZDEsIGludGVyc2VjdGlvblBvaW50KTsKICAgICAgICAgIGludGVyc2VjdGlvblBvaW50LnZzdWIocG9zaXRpb24sIG5vcm1hbCk7CiAgICAgICAgICBub3JtYWwubm9ybWFsaXplKCk7CiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdGlvblBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCAtMSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5yZXN1bHQuc2hvdWxkU3RvcCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKGQyID49IDAgJiYgZDIgPD0gMSkgewogICAgICAgICAgZnJvbS5sZXJwKHRvLCBkMiwgaW50ZXJzZWN0aW9uUG9pbnQpOwogICAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQudnN1Yihwb3NpdGlvbiwgbm9ybWFsKTsKICAgICAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgICAgIHRoaXMucmVwb3J0SW50ZXJzZWN0aW9uKG5vcm1hbCwgaW50ZXJzZWN0aW9uUG9pbnQsIHJlcG9ydGVkU2hhcGUsIGJvZHksIC0xKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBfaW50ZXJzZWN0Q29udmV4KHNoYXBlLCBxdWF0LCBwb3NpdGlvbiwgYm9keSwgcmVwb3J0ZWRTaGFwZSwgb3B0aW9ucykgewogICAgICBjb25zdCBub3JtYWwgPSBpbnRlcnNlY3RDb252ZXhfbm9ybWFsOwogICAgICBjb25zdCB2ZWN0b3IgPSBpbnRlcnNlY3RDb252ZXhfdmVjdG9yOwogICAgICBjb25zdCBmYWNlTGlzdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5mYWNlTGlzdCB8fCBudWxsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgZmFjZXMgPSBzaGFwZS5mYWNlczsKICAgICAgY29uc3QgdmVydGljZXMgPSBzaGFwZS52ZXJ0aWNlczsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNoYXBlLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBkaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbjsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBmcm9tVG9EaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyh0byk7CiAgICAgIGNvbnN0IE5mYWNlcyA9IGZhY2VMaXN0ID8gZmFjZUxpc3QubGVuZ3RoIDogZmFjZXMubGVuZ3RoOwogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGogPSAwOyAhcmVzdWx0LnNob3VsZFN0b3AgJiYgaiA8IE5mYWNlczsgaisrKSB7CiAgICAgICAgY29uc3QgZmkgPSBmYWNlTGlzdCA/IGZhY2VMaXN0W2pdIDogajsKICAgICAgICBjb25zdCBmYWNlID0gZmFjZXNbZmldOwogICAgICAgIGNvbnN0IGZhY2VOb3JtYWwgPSBub3JtYWxzW2ZpXTsKICAgICAgICBjb25zdCBxID0gcXVhdDsKICAgICAgICBjb25zdCB4ID0gcG9zaXRpb247IC8vIGRldGVybWluZSBpZiByYXkgaW50ZXJzZWN0cyB0aGUgcGxhbmUgb2YgdGhlIGZhY2UKICAgICAgICAvLyBub3RlOiB0aGlzIHdvcmtzIHJlZ2FyZGxlc3Mgb2YgdGhlIGRpcmVjdGlvbiBvZiB0aGUgZmFjZSBub3JtYWwKICAgICAgICAvLyBHZXQgcGxhbmUgcG9pbnQgaW4gd29ybGQgY29vcmRpbmF0ZXMuLi4KCiAgICAgICAgdmVjdG9yLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQodmVjdG9yLCB2ZWN0b3IpOwogICAgICAgIHZlY3Rvci52YWRkKHgsIHZlY3Rvcik7IC8vIC4uLmJ1dCBtYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSByYXkgZnJvbS4gV2UnbGwgZml4IHRoaXMgbGF0ZXIuCgogICAgICAgIHZlY3Rvci52c3ViKGZyb20sIHZlY3Rvcik7IC8vIEdldCBwbGFuZSBub3JtYWwKCiAgICAgICAgcS52bXVsdChmYWNlTm9ybWFsLCBub3JtYWwpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBkaXJlY3Rpb24uZG90KG5vcm1hbCk7IC8vIEJhaWwgb3V0IGlmIHJheSBhbmQgcGxhbmUgYXJlIHBhcmFsbGVsCgogICAgICAgIGlmIChNYXRoLmFicyhkb3QpIDwgdGhpcy5wcmVjaXNpb24pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKCiAgICAgICAgY29uc3Qgc2NhbGFyID0gbm9ybWFsLmRvdCh2ZWN0b3IpIC8gZG90OyAvLyBpZiBuZWdhdGl2ZSBkaXN0YW5jZSwgdGhlbiBwbGFuZSBpcyBiZWhpbmQgcmF5CgogICAgICAgIGlmIChzY2FsYXIgPCAwKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IC8vIGlmIChkb3QgPCAwKSB7CiAgICAgICAgLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGRpcmVjdGlvbi5zY2FsZShzY2FsYXIsIGludGVyc2VjdFBvaW50KTsKICAgICAgICBpbnRlcnNlY3RQb2ludC52YWRkKGZyb20sIGludGVyc2VjdFBvaW50KTsgLy8gYSBpcyB0aGUgcG9pbnQgd2UgY29tcGFyZSBwb2ludHMgYiBhbmQgYyB3aXRoLgoKICAgICAgICBhLmNvcHkodmVydGljZXNbZmFjZVswXV0pOwogICAgICAgIHEudm11bHQoYSwgYSk7CiAgICAgICAgeC52YWRkKGEsIGEpOwoKICAgICAgICBmb3IgKGxldCBpID0gMTsgIXJlc3VsdC5zaG91bGRTdG9wICYmIGkgPCBmYWNlLmxlbmd0aCAtIDE7IGkrKykgewogICAgICAgICAgLy8gVHJhbnNmb3JtIDMgdmVydGljZXMgdG8gd29ybGQgY29vcmRzCiAgICAgICAgICBiLmNvcHkodmVydGljZXNbZmFjZVtpXV0pOwogICAgICAgICAgYy5jb3B5KHZlcnRpY2VzW2ZhY2VbaSArIDFdXSk7CiAgICAgICAgICBxLnZtdWx0KGIsIGIpOwogICAgICAgICAgcS52bXVsdChjLCBjKTsKICAgICAgICAgIHgudmFkZChiLCBiKTsKICAgICAgICAgIHgudmFkZChjLCBjKTsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gaW50ZXJzZWN0UG9pbnQuZGlzdGFuY2VUbyhmcm9tKTsKCiAgICAgICAgICBpZiAoIShSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBhLCBiLCBjKSB8fCBSYXkucG9pbnRJblRyaWFuZ2xlKGludGVyc2VjdFBvaW50LCBiLCBhLCBjKSkgfHwgZGlzdGFuY2UgPiBmcm9tVG9EaXN0YW5jZSkgewogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGludGVyc2VjdFBvaW50LCByZXBvcnRlZFNoYXBlLCBib2R5LCBmaSk7CiAgICAgICAgfSAvLyB9CgogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE9wdGltaXplIGJ5IHRyYW5zZm9ybWluZyB0aGUgd29ybGQgdG8gbG9jYWwgc3BhY2UgZmlyc3QuCiAgICAgKiBAdG9kbyBVc2UgT2N0cmVlIGxvb2t1cAogICAgICovCgoKICAgIF9pbnRlcnNlY3RUcmltZXNoKG1lc2gsIHF1YXQsIHBvc2l0aW9uLCBib2R5LCByZXBvcnRlZFNoYXBlLCBvcHRpb25zKSB7CiAgICAgIGNvbnN0IG5vcm1hbCA9IGludGVyc2VjdFRyaW1lc2hfbm9ybWFsOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlczsKICAgICAgY29uc3QgdHJlZVRyYW5zZm9ybSA9IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybTsKICAgICAgY29uc3QgdmVjdG9yID0gaW50ZXJzZWN0Q29udmV4X3ZlY3RvcjsKICAgICAgY29uc3QgbG9jYWxEaXJlY3Rpb24gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRGlyZWN0aW9uOwogICAgICBjb25zdCBsb2NhbEZyb20gPSBpbnRlcnNlY3RUcmltZXNoX2xvY2FsRnJvbTsKICAgICAgY29uc3QgbG9jYWxUbyA9IGludGVyc2VjdFRyaW1lc2hfbG9jYWxUbzsKICAgICAgY29uc3Qgd29ybGRJbnRlcnNlY3RQb2ludCA9IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludDsKICAgICAgY29uc3Qgd29ybGROb3JtYWwgPSBpbnRlcnNlY3RUcmltZXNoX3dvcmxkTm9ybWFsOyAvLyBDaGVja2luZyBmYWNlcwoKICAgICAgY29uc3QgaW5kaWNlcyA9IG1lc2guaW5kaWNlczsKICAgICAgbWVzaC52ZXJ0aWNlczsgLy8gY29uc3Qgbm9ybWFscyA9IG1lc2guZmFjZU5vcm1hbHMKCiAgICAgIGNvbnN0IGZyb20gPSB0aGlzLmZyb207CiAgICAgIGNvbnN0IHRvID0gdGhpcy50bzsKICAgICAgY29uc3QgZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb247CiAgICAgIHRyZWVUcmFuc2Zvcm0ucG9zaXRpb24uY29weShwb3NpdGlvbik7CiAgICAgIHRyZWVUcmFuc2Zvcm0ucXVhdGVybmlvbi5jb3B5KHF1YXQpOyAvLyBUcmFuc2Zvcm0gcmF5IHRvIGxvY2FsIHNwYWNlIQoKICAgICAgVHJhbnNmb3JtLnZlY3RvclRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZGlyZWN0aW9uLCBsb2NhbERpcmVjdGlvbik7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShwb3NpdGlvbiwgcXVhdCwgZnJvbSwgbG9jYWxGcm9tKTsKICAgICAgVHJhbnNmb3JtLnBvaW50VG9Mb2NhbEZyYW1lKHBvc2l0aW9uLCBxdWF0LCB0bywgbG9jYWxUbyk7CiAgICAgIGxvY2FsVG8ueCAqPSBtZXNoLnNjYWxlLng7CiAgICAgIGxvY2FsVG8ueSAqPSBtZXNoLnNjYWxlLnk7CiAgICAgIGxvY2FsVG8ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsRnJvbS54ICo9IG1lc2guc2NhbGUueDsKICAgICAgbG9jYWxGcm9tLnkgKj0gbWVzaC5zY2FsZS55OwogICAgICBsb2NhbEZyb20ueiAqPSBtZXNoLnNjYWxlLno7CiAgICAgIGxvY2FsVG8udnN1Yihsb2NhbEZyb20sIGxvY2FsRGlyZWN0aW9uKTsKICAgICAgbG9jYWxEaXJlY3Rpb24ubm9ybWFsaXplKCk7CiAgICAgIGNvbnN0IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCA9IGxvY2FsRnJvbS5kaXN0YW5jZVNxdWFyZWQobG9jYWxUbyk7CiAgICAgIG1lc2gudHJlZS5yYXlRdWVyeSh0aGlzLCB0cmVlVHJhbnNmb3JtLCB0cmlhbmdsZXMpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB0cmlhbmdsZXMubGVuZ3RoOyAhdGhpcy5yZXN1bHQuc2hvdWxkU3RvcCAmJiBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCB0cmlhbmdsZXNJbmRleCA9IHRyaWFuZ2xlc1tpXTsKICAgICAgICBtZXNoLmdldE5vcm1hbCh0cmlhbmdsZXNJbmRleCwgbm9ybWFsKTsgLy8gZGV0ZXJtaW5lIGlmIHJheSBpbnRlcnNlY3RzIHRoZSBwbGFuZSBvZiB0aGUgZmFjZQogICAgICAgIC8vIG5vdGU6IHRoaXMgd29ya3MgcmVnYXJkbGVzcyBvZiB0aGUgZGlyZWN0aW9uIG9mIHRoZSBmYWNlIG5vcm1hbAogICAgICAgIC8vIEdldCBwbGFuZSBwb2ludCBpbiB3b3JsZCBjb29yZGluYXRlcy4uLgoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogM10sIGEpOyAvLyAuLi5idXQgbWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgcmF5IGZyb20uIFdlJ2xsIGZpeCB0aGlzIGxhdGVyLgoKICAgICAgICBhLnZzdWIobG9jYWxGcm9tLCB2ZWN0b3IpOyAvLyBJZiB0aGlzIGRvdCBwcm9kdWN0IGlzIG5lZ2F0aXZlLCB3ZSBoYXZlIHNvbWV0aGluZyBpbnRlcmVzdGluZwoKICAgICAgICBjb25zdCBkb3QgPSBsb2NhbERpcmVjdGlvbi5kb3Qobm9ybWFsKTsgLy8gQmFpbCBvdXQgaWYgcmF5IGFuZCBwbGFuZSBhcmUgcGFyYWxsZWwKICAgICAgICAvLyBpZiAoTWF0aC5hYnMoIGRvdCApIDwgdGhpcy5wcmVjaXNpb24pewogICAgICAgIC8vICAgICBjb250aW51ZTsKICAgICAgICAvLyB9CiAgICAgICAgLy8gY2FsYyBkaXN0YW5jZSB0byBwbGFuZQoKICAgICAgICBjb25zdCBzY2FsYXIgPSBub3JtYWwuZG90KHZlY3RvcikgLyBkb3Q7IC8vIGlmIG5lZ2F0aXZlIGRpc3RhbmNlLCB0aGVuIHBsYW5lIGlzIGJlaGluZCByYXkKCiAgICAgICAgaWYgKHNjYWxhciA8IDApIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0gLy8gSW50ZXJzZWN0aW9uIHBvaW50IGlzIGZyb20gKyBkaXJlY3Rpb24gKiBzY2FsYXIKCgogICAgICAgIGxvY2FsRGlyZWN0aW9uLnNjYWxlKHNjYWxhciwgaW50ZXJzZWN0UG9pbnQpOwogICAgICAgIGludGVyc2VjdFBvaW50LnZhZGQobG9jYWxGcm9tLCBpbnRlcnNlY3RQb2ludCk7IC8vIEdldCB0cmlhbmdsZSB2ZXJ0aWNlcwoKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDFdLCBiKTsKICAgICAgICBtZXNoLmdldFZlcnRleChpbmRpY2VzW3RyaWFuZ2xlc0luZGV4ICogMyArIDJdLCBjKTsKICAgICAgICBjb25zdCBzcXVhcmVkRGlzdGFuY2UgPSBpbnRlcnNlY3RQb2ludC5kaXN0YW5jZVNxdWFyZWQobG9jYWxGcm9tKTsKCiAgICAgICAgaWYgKCEoUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYiwgYSwgYykgfHwgUmF5LnBvaW50SW5UcmlhbmdsZShpbnRlcnNlY3RQb2ludCwgYSwgYiwgYykpIHx8IHNxdWFyZWREaXN0YW5jZSA+IGZyb21Ub0Rpc3RhbmNlU3F1YXJlZCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSAvLyB0cmFuc2Zvcm0gaW50ZXJzZWN0cG9pbnQgYW5kIG5vcm1hbCB0byB3b3JsZAoKCiAgICAgICAgVHJhbnNmb3JtLnZlY3RvclRvV29ybGRGcmFtZShxdWF0LCBub3JtYWwsIHdvcmxkTm9ybWFsKTsKICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zaXRpb24sIHF1YXQsIGludGVyc2VjdFBvaW50LCB3b3JsZEludGVyc2VjdFBvaW50KTsKICAgICAgICB0aGlzLnJlcG9ydEludGVyc2VjdGlvbih3b3JsZE5vcm1hbCwgd29ybGRJbnRlcnNlY3RQb2ludCwgcmVwb3J0ZWRTaGFwZSwgYm9keSwgdHJpYW5nbGVzSW5kZXgpOwogICAgICB9CgogICAgICB0cmlhbmdsZXMubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogQHJldHVybiBUcnVlIGlmIHRoZSBpbnRlcnNlY3Rpb25zIHNob3VsZCBjb250aW51ZQogICAgICovCgoKICAgIHJlcG9ydEludGVyc2VjdGlvbihub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBoaXRGYWNlSW5kZXgpIHsKICAgICAgY29uc3QgZnJvbSA9IHRoaXMuZnJvbTsKICAgICAgY29uc3QgdG8gPSB0aGlzLnRvOwogICAgICBjb25zdCBkaXN0YW5jZSA9IGZyb20uZGlzdGFuY2VUbyhoaXRQb2ludFdvcmxkKTsKICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5yZXN1bHQ7IC8vIFNraXAgYmFjayBmYWNlcz8KCiAgICAgIGlmICh0aGlzLnNraXBCYWNrZmFjZXMgJiYgbm9ybWFsLmRvdCh0aGlzLmRpcmVjdGlvbikgPiAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByZXN1bHQuaGl0RmFjZUluZGV4ID0gdHlwZW9mIGhpdEZhY2VJbmRleCAhPT0gJ3VuZGVmaW5lZCcgPyBoaXRGYWNlSW5kZXggOiAtMTsKCiAgICAgIHN3aXRjaCAodGhpcy5tb2RlKSB7CiAgICAgICAgY2FzZSBSYXkuQUxMOgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0LnNldChmcm9tLCB0bywgbm9ybWFsLCBoaXRQb2ludFdvcmxkLCBzaGFwZSwgYm9keSwgZGlzdGFuY2UpOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICB0aGlzLmNhbGxiYWNrKHJlc3VsdCk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQ0xPU0VTVDoKICAgICAgICAgIC8vIFN0b3JlIGlmIGNsb3NlciB0aGFuIGN1cnJlbnQgY2xvc2VzdAogICAgICAgICAgaWYgKGRpc3RhbmNlIDwgcmVzdWx0LmRpc3RhbmNlIHx8ICFyZXN1bHQuaGFzSGl0KSB7CiAgICAgICAgICAgIHRoaXMuaGFzSGl0ID0gdHJ1ZTsKICAgICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnJvbSwgdG8sIG5vcm1hbCwgaGl0UG9pbnRXb3JsZCwgc2hhcGUsIGJvZHksIGRpc3RhbmNlKTsKICAgICAgICAgIH0KCiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBSYXkuQU5ZOgogICAgICAgICAgLy8gUmVwb3J0IGFuZCBzdG9wLgogICAgICAgICAgdGhpcy5oYXNIaXQgPSB0cnVlOwogICAgICAgICAgcmVzdWx0Lmhhc0hpdCA9IHRydWU7CiAgICAgICAgICByZXN1bHQuc2V0KGZyb20sIHRvLCBub3JtYWwsIGhpdFBvaW50V29ybGQsIHNoYXBlLCBib2R5LCBkaXN0YW5jZSk7CiAgICAgICAgICByZXN1bHQuc2hvdWxkU3RvcCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBBcyBwZXIgIkJhcnljZW50cmljIFRlY2huaXF1ZSIgYXMgbmFtZWQKICAgICAqIHtAbGluayBodHRwczovL3d3dy5ibGFja3Bhd24uY29tL3RleHRzL3BvaW50aW5wb2x5L2RlZmF1bHQuaHRtbCBoZXJlfSBidXQgd2l0aG91dCB0aGUgZGl2aXNpb24KICAgICAqLwoKCiAgICBzdGF0aWMgcG9pbnRJblRyaWFuZ2xlKHAsIGEsIGIsIGMpIHsKICAgICAgYy52c3ViKGEsIHYwKTsKICAgICAgYi52c3ViKGEsIHYxKTsKICAgICAgcC52c3ViKGEsIHYyKTsKICAgICAgY29uc3QgZG90MDAgPSB2MC5kb3QodjApOwogICAgICBjb25zdCBkb3QwMSA9IHYwLmRvdCh2MSk7CiAgICAgIGNvbnN0IGRvdDAyID0gdjAuZG90KHYyKTsKICAgICAgY29uc3QgZG90MTEgPSB2MS5kb3QodjEpOwogICAgICBjb25zdCBkb3QxMiA9IHYxLmRvdCh2Mik7CiAgICAgIGxldCB1OwogICAgICBsZXQgdjsKICAgICAgcmV0dXJuICh1ID0gZG90MTEgKiBkb3QwMiAtIGRvdDAxICogZG90MTIpID49IDAgJiYgKHYgPSBkb3QwMCAqIGRvdDEyIC0gZG90MDEgKiBkb3QwMikgPj0gMCAmJiB1ICsgdiA8IGRvdDAwICogZG90MTEgLSBkb3QwMSAqIGRvdDAxOwogICAgfQoKICB9CgogIFJheS5DTE9TRVNUID0gUkFZX01PREVTLkNMT1NFU1Q7CiAgUmF5LkFOWSA9IFJBWV9NT0RFUy5BTlk7CiAgUmF5LkFMTCA9IFJBWV9NT0RFUy5BTEw7CiAgY29uc3QgdG1wQUFCQiQxID0gbmV3IEFBQkIoKTsKICBjb25zdCB0bXBBcnJheSA9IFtdOwogIGNvbnN0IHYxID0gbmV3IFZlYzMoKTsKICBjb25zdCB2MiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Qm9keV94aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Qm9keV9xaSA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgaW50ZXJzZWN0UG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGEgPSBuZXcgVmVjMygpOwogIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGMgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdENvbnZleE9wdGlvbnMgPSB7CiAgICBmYWNlTGlzdDogWzBdCiAgfTsKICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfbG9jYWxSYXkgPSBuZXcgUmF5KCk7CiAgY29uc3QgaW50ZXJzZWN0SGVpZ2h0ZmllbGRfaW5kZXggPSBbXTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX2ludGVyc2VjdGlvblBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBSYXlfaW50ZXJzZWN0U3BoZXJlX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0Q29udmV4X3ZlY3RvciA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0VHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbG9jYWxEaXJlY3Rpb24gPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfbG9jYWxGcm9tID0gbmV3IFZlYzMoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX2xvY2FsVG8gPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfd29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfd29ybGRJbnRlcnNlY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgbmV3IEFBQkIoKTsKICBjb25zdCBpbnRlcnNlY3RUcmltZXNoX3RyaWFuZ2xlcyA9IFtdOwogIGNvbnN0IGludGVyc2VjdFRyaW1lc2hfdHJlZVRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCB2MCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgaW50ZXJzZWN0ID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gZGlzdGFuY2VGcm9tSW50ZXJzZWN0aW9uKGZyb20sIGRpcmVjdGlvbiwgcG9zaXRpb24pIHsKICAgIC8vIHYwIGlzIHZlY3RvciBmcm9tIGZyb20gdG8gcG9zaXRpb24KICAgIHBvc2l0aW9uLnZzdWIoZnJvbSwgdjApOwogICAgY29uc3QgZG90ID0gdjAuZG90KGRpcmVjdGlvbik7IC8vIGludGVyc2VjdCA9IGRpcmVjdGlvbipkb3QgKyBmcm9tCgogICAgZGlyZWN0aW9uLnNjYWxlKGRvdCwgaW50ZXJzZWN0KTsKICAgIGludGVyc2VjdC52YWRkKGZyb20sIGludGVyc2VjdCk7CiAgICBjb25zdCBkaXN0YW5jZSA9IHBvc2l0aW9uLmRpc3RhbmNlVG8oaW50ZXJzZWN0KTsKICAgIHJldHVybiBkaXN0YW5jZTsKICB9CiAgLyoqCiAgICogU3dlZXAgYW5kIHBydW5lIGJyb2FkcGhhc2UgYWxvbmcgb25lIGF4aXMuCiAgICovCgoKICBjbGFzcyBTQVBCcm9hZHBoYXNlIGV4dGVuZHMgQnJvYWRwaGFzZSB7CiAgICAvKioKICAgICAqIExpc3Qgb2YgYm9kaWVzIGN1cnJlbnRseSBpbiB0aGUgYnJvYWRwaGFzZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHdvcmxkIHRvIHNlYXJjaCBpbi4KICAgICAqLwoKICAgIC8qKgogICAgICogQXhpcyB0byBzb3J0IHRoZSBib2RpZXMgYWxvbmcuCiAgICAgKiBTZXQgdG8gMCBmb3IgeCBheGlzLCBhbmQgMSBmb3IgeSBheGlzLgogICAgICogRm9yIGJlc3QgcGVyZm9ybWFuY2UsIHBpY2sgdGhlIGF4aXMgd2hlcmUgYm9kaWVzIGFyZSBtb3N0IGRpc3RyaWJ1dGVkLgogICAgICovCgogICAgLyoqCiAgICAgKiBDaGVjayBpZiB0aGUgYm91bmRzIG9mIHR3byBib2RpZXMgb3ZlcmxhcCwgYWxvbmcgdGhlIGdpdmVuIFNBUCBheGlzLgogICAgICovCiAgICBzdGF0aWMgY2hlY2tCb3VuZHMoYmksIGJqLCBheGlzSW5kZXgpIHsKICAgICAgbGV0IGJpUG9zOwogICAgICBsZXQgYmpQb3M7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAwKSB7CiAgICAgICAgYmlQb3MgPSBiaS5wb3NpdGlvbi54OwogICAgICAgIGJqUG9zID0gYmoucG9zaXRpb24ueDsKICAgICAgfSBlbHNlIGlmIChheGlzSW5kZXggPT09IDEpIHsKICAgICAgICBiaVBvcyA9IGJpLnBvc2l0aW9uLnk7CiAgICAgICAgYmpQb3MgPSBiai5wb3NpdGlvbi55OwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGJpUG9zID0gYmkucG9zaXRpb24uejsKICAgICAgICBialBvcyA9IGJqLnBvc2l0aW9uLno7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJpID0gYmkuYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIHJqID0gYmouYm91bmRpbmdSYWRpdXMsCiAgICAgICAgICAgIGJvdW5kQTIgPSBiaVBvcyArIHJpLAogICAgICAgICAgICBib3VuZEIxID0gYmpQb3MgLSByajsKICAgICAgcmV0dXJuIGJvdW5kQjEgPCBib3VuZEEyOwogICAgfSAvLyBOb3RlOiB0aGVzZSBhcmUgaWRlbnRpY2FsLCBzYXZlIGZvciB4L3kveiBsb3dlcmJvdW5kCgogICAgLyoqCiAgICAgKiBpbnNlcnRpb25Tb3J0WAogICAgICovCgoKICAgIHN0YXRpYyBpbnNlcnRpb25Tb3J0WChhKSB7CiAgICAgIGZvciAobGV0IGkgPSAxLCBsID0gYS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjb25zdCB2ID0gYVtpXTsKICAgICAgICBsZXQgajsKCiAgICAgICAgZm9yIChqID0gaSAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgICBpZiAoYVtqXS5hYWJiLmxvd2VyQm91bmQueCA8PSB2LmFhYmIubG93ZXJCb3VuZC54KSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGFbaiArIDFdID0gYVtqXTsKICAgICAgICB9CgogICAgICAgIGFbaiArIDFdID0gdjsKICAgICAgfQoKICAgICAgcmV0dXJuIGE7CiAgICB9CiAgICAvKioKICAgICAqIGluc2VydGlvblNvcnRZCiAgICAgKi8KCgogICAgc3RhdGljIGluc2VydGlvblNvcnRZKGEpIHsKICAgICAgZm9yIChsZXQgaSA9IDEsIGwgPSBhLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIGNvbnN0IHYgPSBhW2ldOwogICAgICAgIGxldCBqOwoKICAgICAgICBmb3IgKGogPSBpIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgIGlmIChhW2pdLmFhYmIubG93ZXJCb3VuZC55IDw9IHYuYWFiYi5sb3dlckJvdW5kLnkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgYVtqICsgMV0gPSBhW2pdOwogICAgICAgIH0KCiAgICAgICAgYVtqICsgMV0gPSB2OwogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH0KICAgIC8qKgogICAgICogaW5zZXJ0aW9uU29ydFoKICAgICAqLwoKCiAgICBzdGF0aWMgaW5zZXJ0aW9uU29ydFooYSkgewogICAgICBmb3IgKGxldCBpID0gMSwgbCA9IGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IGFbaV07CiAgICAgICAgbGV0IGo7CgogICAgICAgIGZvciAoaiA9IGkgLSAxOyBqID49IDA7IGotLSkgewogICAgICAgICAgaWYgKGFbal0uYWFiYi5sb3dlckJvdW5kLnogPD0gdi5hYWJiLmxvd2VyQm91bmQueikgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBhW2ogKyAxXSA9IGFbal07CiAgICAgICAgfQoKICAgICAgICBhW2ogKyAxXSA9IHY7CiAgICAgIH0KCiAgICAgIHJldHVybiBhOwogICAgfQoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHN1cGVyKCk7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gdm9pZCAwOwogICAgICB0aGlzLl9hZGRCb2R5SGFuZGxlciA9IHZvaWQgMDsKICAgICAgdGhpcy5fcmVtb3ZlQm9keUhhbmRsZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0xpc3QgPSBbXTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICAgIHRoaXMuYXhpc0luZGV4ID0gMDsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwoKICAgICAgdGhpcy5fYWRkQm9keUhhbmRsZXIgPSBldmVudCA9PiB7CiAgICAgICAgYXhpc0xpc3QucHVzaChldmVudC5ib2R5KTsKICAgICAgfTsKCiAgICAgIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyID0gZXZlbnQgPT4gewogICAgICAgIGNvbnN0IGlkeCA9IGF4aXNMaXN0LmluZGV4T2YoZXZlbnQuYm9keSk7CgogICAgICAgIGlmIChpZHggIT09IC0xKSB7CiAgICAgICAgICBheGlzTGlzdC5zcGxpY2UoaWR4LCAxKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAod29ybGQpIHsKICAgICAgICB0aGlzLnNldFdvcmxkKHdvcmxkKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDaGFuZ2UgdGhlIHdvcmxkCiAgICAgKi8KCgogICAgc2V0V29ybGQod29ybGQpIHsKICAgICAgLy8gQ2xlYXIgdGhlIG9sZCBheGlzIGFycmF5CiAgICAgIHRoaXMuYXhpc0xpc3QubGVuZ3RoID0gMDsgLy8gQWRkIGFsbCBib2RpZXMgZnJvbSB0aGUgbmV3IHdvcmxkCgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmxkLmJvZGllcy5sZW5ndGg7IGkrKykgewogICAgICAgIHRoaXMuYXhpc0xpc3QucHVzaCh3b3JsZC5ib2RpZXNbaV0pOwogICAgICB9IC8vIFJlbW92ZSBvbGQgaGFuZGxlcnMsIGlmIGFueQoKCiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FkZEJvZHknLCB0aGlzLl9hZGRCb2R5SGFuZGxlcik7CiAgICAgIHdvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3JlbW92ZUJvZHknLCB0aGlzLl9yZW1vdmVCb2R5SGFuZGxlcik7IC8vIEFkZCBoYW5kbGVycyB0byB1cGRhdGUgdGhlIGxpc3Qgb2YgYm9kaWVzLgoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYWRkQm9keScsIHRoaXMuX2FkZEJvZHlIYW5kbGVyKTsKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncmVtb3ZlQm9keScsIHRoaXMuX3JlbW92ZUJvZHlIYW5kbGVyKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmRpcnR5ID0gdHJ1ZTsKICAgIH0KICAgIC8qKgogICAgICogQ29sbGVjdCBhbGwgY29sbGlzaW9uIHBhaXJzCiAgICAgKi8KCgogICAgY29sbGlzaW9uUGFpcnMod29ybGQsIHAxLCBwMikgewogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBOID0gYm9kaWVzLmxlbmd0aDsKICAgICAgY29uc3QgYXhpc0luZGV4ID0gdGhpcy5heGlzSW5kZXg7CiAgICAgIGxldCBpOwogICAgICBsZXQgajsKCiAgICAgIGlmICh0aGlzLmRpcnR5KSB7CiAgICAgICAgdGhpcy5zb3J0TGlzdCgpOwogICAgICAgIHRoaXMuZGlydHkgPSBmYWxzZTsKICAgICAgfSAvLyBMb29rIHRocm91Z2ggdGhlIGxpc3QKCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgZm9yIChqID0gaSArIDE7IGogPCBOOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGJqID0gYm9kaWVzW2pdOwoKICAgICAgICAgIGlmICghdGhpcy5uZWVkQnJvYWRwaGFzZUNvbGxpc2lvbihiaSwgYmopKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghU0FQQnJvYWRwaGFzZS5jaGVja0JvdW5kcyhiaSwgYmosIGF4aXNJbmRleCkpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5pbnRlcnNlY3Rpb25UZXN0KGJpLCBiaiwgcDEsIHAyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzb3J0TGlzdCgpIHsKICAgICAgY29uc3QgYXhpc0xpc3QgPSB0aGlzLmF4aXNMaXN0OwogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgY29uc3QgTiA9IGF4aXNMaXN0Lmxlbmd0aDsgLy8gVXBkYXRlIEFBQkJzCgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBheGlzTGlzdFtpXTsKCiAgICAgICAgaWYgKGJpLmFhYmJOZWVkc1VwZGF0ZSkgewogICAgICAgICAgYmkudXBkYXRlQUFCQigpOwogICAgICAgIH0KICAgICAgfSAvLyBTb3J0IHRoZSBsaXN0CgoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMCkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFgoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMSkgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFkoYXhpc0xpc3QpOwogICAgICB9IGVsc2UgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIFNBUEJyb2FkcGhhc2UuaW5zZXJ0aW9uU29ydFooYXhpc0xpc3QpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIHRoZSB2YXJpYW5jZSBvZiB0aGUgYm9keSBwb3NpdGlvbnMgYW5kIGVzdGltYXRlcyB0aGUgYmVzdCBheGlzIHRvIHVzZS4KICAgICAqIFdpbGwgYXV0b21hdGljYWxseSBzZXQgcHJvcGVydHkgYGF4aXNJbmRleGAuCiAgICAgKi8KCgogICAgYXV0b0RldGVjdEF4aXMoKSB7CiAgICAgIGxldCBzdW1YID0gMDsKICAgICAgbGV0IHN1bVgyID0gMDsKICAgICAgbGV0IHN1bVkgPSAwOwogICAgICBsZXQgc3VtWTIgPSAwOwogICAgICBsZXQgc3VtWiA9IDA7CiAgICAgIGxldCBzdW1aMiA9IDA7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYXhpc0xpc3Q7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwogICAgICBjb25zdCBpbnZOID0gMSAvIE47CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBjZW50ZXJYID0gYi5wb3NpdGlvbi54OwogICAgICAgIHN1bVggKz0gY2VudGVyWDsKICAgICAgICBzdW1YMiArPSBjZW50ZXJYICogY2VudGVyWDsKICAgICAgICBjb25zdCBjZW50ZXJZID0gYi5wb3NpdGlvbi55OwogICAgICAgIHN1bVkgKz0gY2VudGVyWTsKICAgICAgICBzdW1ZMiArPSBjZW50ZXJZICogY2VudGVyWTsKICAgICAgICBjb25zdCBjZW50ZXJaID0gYi5wb3NpdGlvbi56OwogICAgICAgIHN1bVogKz0gY2VudGVyWjsKICAgICAgICBzdW1aMiArPSBjZW50ZXJaICogY2VudGVyWjsKICAgICAgfQoKICAgICAgY29uc3QgdmFyaWFuY2VYID0gc3VtWDIgLSBzdW1YICogc3VtWCAqIGludk47CiAgICAgIGNvbnN0IHZhcmlhbmNlWSA9IHN1bVkyIC0gc3VtWSAqIHN1bVkgKiBpbnZOOwogICAgICBjb25zdCB2YXJpYW5jZVogPSBzdW1aMiAtIHN1bVogKiBzdW1aICogaW52TjsKCiAgICAgIGlmICh2YXJpYW5jZVggPiB2YXJpYW5jZVkpIHsKICAgICAgICBpZiAodmFyaWFuY2VYID4gdmFyaWFuY2VaKSB7CiAgICAgICAgICB0aGlzLmF4aXNJbmRleCA9IDA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodmFyaWFuY2VZID4gdmFyaWFuY2VaKSB7CiAgICAgICAgdGhpcy5heGlzSW5kZXggPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYXhpc0luZGV4ID0gMjsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZXR1cm5zIGFsbCB0aGUgYm9kaWVzIHdpdGhpbiBhbiBBQUJCLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSB0byBzdG9yZSByZXN1bHRpbmcgYm9kaWVzIGluLgogICAgICovCgoKICAgIGFhYmJRdWVyeSh3b3JsZCwgYWFiYiwgcmVzdWx0ID0gW10pIHsKICAgICAgaWYgKHRoaXMuZGlydHkpIHsKICAgICAgICB0aGlzLnNvcnRMaXN0KCk7CiAgICAgICAgdGhpcy5kaXJ0eSA9IGZhbHNlOwogICAgICB9CgogICAgICBjb25zdCBheGlzSW5kZXggPSB0aGlzLmF4aXNJbmRleDsKICAgICAgbGV0IGF4aXMgPSAneCc7CgogICAgICBpZiAoYXhpc0luZGV4ID09PSAxKSB7CiAgICAgICAgYXhpcyA9ICd5JzsKICAgICAgfQoKICAgICAgaWYgKGF4aXNJbmRleCA9PT0gMikgewogICAgICAgIGF4aXMgPSAneic7CiAgICAgIH0KCiAgICAgIGNvbnN0IGF4aXNMaXN0ID0gdGhpcy5heGlzTGlzdDsKICAgICAgYWFiYi5sb3dlckJvdW5kW2F4aXNdOwogICAgICBhYWJiLnVwcGVyQm91bmRbYXhpc107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF4aXNMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgYiA9IGF4aXNMaXN0W2ldOwoKICAgICAgICBpZiAoYi5hYWJiTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIGIudXBkYXRlQUFCQigpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGIuYWFiYi5vdmVybGFwcyhhYWJiKSkgewogICAgICAgICAgcmVzdWx0LnB1c2goYik7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQoKICB9CgogIGNsYXNzIFV0aWxzIHsKICAgIC8qKgogICAgICogRXh0ZW5kIGFuIG9wdGlvbnMgb2JqZWN0IHdpdGggZGVmYXVsdCB2YWx1ZXMuCiAgICAgKiBAcGFyYW0gb3B0aW9ucyBUaGUgb3B0aW9ucyBvYmplY3QuIE1heSBiZSBmYWxzeTogaW4gdGhpcyBjYXNlLCBhIG5ldyBvYmplY3QgaXMgY3JlYXRlZCBhbmQgcmV0dXJuZWQuCiAgICAgKiBAcGFyYW0gZGVmYXVsdHMgQW4gb2JqZWN0IGNvbnRhaW5pbmcgZGVmYXVsdCB2YWx1ZXMuCiAgICAgKiBAcmV0dXJuIFRoZSBtb2RpZmllZCBvcHRpb25zIG9iamVjdC4KICAgICAqLwogICAgc3RhdGljIGRlZmF1bHRzKG9wdGlvbnMgPSB7fSwgZGVmYXVsdHMpIHsKICAgICAgZm9yIChsZXQga2V5IGluIGRlZmF1bHRzKSB7CiAgICAgICAgaWYgKCEoa2V5IGluIG9wdGlvbnMpKSB7CiAgICAgICAgICBvcHRpb25zW2tleV0gPSBkZWZhdWx0c1trZXldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG9wdGlvbnM7CiAgICB9CgogIH0KICAvKioKICAgKiBDb25zdHJhaW50IGJhc2UgY2xhc3MKICAgKi8KCgogIGNsYXNzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBFcXVhdGlvbnMgdG8gYmUgc29sdmVkIGluIHRoaXMgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogQm9keSBBLgogICAgICovCgogICAgLyoqCiAgICAgKiBCb2R5IEIuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byBmYWxzZSBpZiB5b3UgZG9uJ3Qgd2FudCB0aGUgYm9kaWVzIHRvIGNvbGxpZGUgd2hlbiB0aGV5IGFyZSBjb25uZWN0ZWQuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyA9IHt9KSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLmJvZHlBID0gdm9pZCAwOwogICAgICB0aGlzLmJvZHlCID0gdm9pZCAwOwogICAgICB0aGlzLmlkID0gdm9pZCAwOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSB2b2lkIDA7CiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgY29sbGlkZUNvbm5lY3RlZDogdHJ1ZSwKICAgICAgICB3YWtlVXBCb2RpZXM6IHRydWUKICAgICAgfSk7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gW107CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmlkID0gQ29uc3RyYWludC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5jb2xsaWRlQ29ubmVjdGVkID0gb3B0aW9ucy5jb2xsaWRlQ29ubmVjdGVkOwoKICAgICAgaWYgKG9wdGlvbnMud2FrZVVwQm9kaWVzKSB7CiAgICAgICAgaWYgKGJvZHlBKSB7CiAgICAgICAgICBib2R5QS53YWtlVXAoKTsKICAgICAgICB9CgogICAgICAgIGlmIChib2R5QikgewogICAgICAgICAgYm9keUIud2FrZVVwKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSBhbGwgdGhlIGVxdWF0aW9ucyB3aXRoIGRhdGEuCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICB0aHJvdyBuZXcgRXJyb3IoJ21ldGhvZCB1cGRhdGUoKSBub3QgaW1wbG1lbWVudGVkIGluIHRoaXMgQ29uc3RyYWludCBzdWJjbGFzcyEnKTsKICAgIH0KICAgIC8qKgogICAgICogRW5hYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGVuYWJsZSgpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVxcy5sZW5ndGg7IGkrKykgewogICAgICAgIGVxc1tpXS5lbmFibGVkID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBEaXNhYmxlcyBhbGwgZXF1YXRpb25zIGluIHRoZSBjb25zdHJhaW50LgogICAgICovCgoKICAgIGRpc2FibGUoKSB7CiAgICAgIGNvbnN0IGVxcyA9IHRoaXMuZXF1YXRpb25zOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlcXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlcXNbaV0uZW5hYmxlZCA9IGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KCiAgQ29uc3RyYWludC5pZENvdW50ZXIgPSAwOwogIC8qKgogICAqIEFuIGVsZW1lbnQgY29udGFpbmluZyA2IGVudHJpZXMsIDMgc3BhdGlhbCBhbmQgMyByb3RhdGlvbmFsIGRlZ3JlZXMgb2YgZnJlZWRvbS4KICAgKi8KCiAgY2xhc3MgSmFjb2JpYW5FbGVtZW50IHsKICAgIC8qKgogICAgICogc3BhdGlhbAogICAgICovCgogICAgLyoqCiAgICAgKiByb3RhdGlvbmFsCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLnNwYXRpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMucm90YXRpb25hbCA9IHZvaWQgMDsKICAgICAgdGhpcy5zcGF0aWFsID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5yb3RhdGlvbmFsID0gbmV3IFZlYzMoKTsKICAgIH0KICAgIC8qKgogICAgICogTXVsdGlwbHkgd2l0aCBvdGhlciBKYWNvYmlhbkVsZW1lbnQKICAgICAqLwoKCiAgICBtdWx0aXBseUVsZW1lbnQoZWxlbWVudCkgewogICAgICByZXR1cm4gZWxlbWVudC5zcGF0aWFsLmRvdCh0aGlzLnNwYXRpYWwpICsgZWxlbWVudC5yb3RhdGlvbmFsLmRvdCh0aGlzLnJvdGF0aW9uYWwpOwogICAgfQogICAgLyoqCiAgICAgKiBNdWx0aXBseSB3aXRoIHR3byB2ZWN0b3JzCiAgICAgKi8KCgogICAgbXVsdGlwbHlWZWN0b3JzKHNwYXRpYWwsIHJvdGF0aW9uYWwpIHsKICAgICAgcmV0dXJuIHNwYXRpYWwuZG90KHRoaXMuc3BhdGlhbCkgKyByb3RhdGlvbmFsLmRvdCh0aGlzLnJvdGF0aW9uYWwpOwogICAgfQoKICB9CiAgLyoqCiAgICogRXF1YXRpb24gYmFzZSBjbGFzcy4KICAgKgogICAqIGBhYCwgYGJgIGFuZCBgZXBzYCBhcmUge0BsaW5rIGh0dHBzOi8vd3d3OC5jcy51bXUuc2Uva3Vyc2VyLzVEVjA1OC9WVDE1L2xlY3R1cmVzL1NQT09LbGFibm90ZXMucGRmIFNQT09LfSBwYXJhbWV0ZXJzIHRoYXQgZGVmYXVsdCB0byBgMC4wYC4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vc2NodGVwcGUvY2Fubm9uLmpzL2lzc3Vlcy8yMzgjaXNzdWVjb21tZW50LTE0NzE3MjMyNyB0aGlzIGV4Y2hhbmdlfSBmb3IgbW9yZSBkZXRhaWxzIG9uIENhbm5vbidzIHBoeXNpY3MgaW1wbGVtZW50YXRpb24uCiAgICovCgoKICBjbGFzcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIE1pbmltdW0gKHJlYWQ6IG5lZ2F0aXZlIG1heCkgZm9yY2UgdG8gYmUgYXBwbGllZCBieSB0aGUgY29uc3RyYWludC4KICAgICAqLwoKICAgIC8qKgogICAgICogTWF4aW11bSAocmVhZDogcG9zaXRpdmUgbWF4KSBmb3JjZSB0byBiZSBhcHBsaWVkIGJ5IHRoZSBjb25zdHJhaW50LgogICAgICovCgogICAgLyoqCiAgICAgKiBTUE9PSyBwYXJhbWV0ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogU1BPT0sgcGFyYW1ldGVyCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNQT09LIHBhcmFtZXRlcgogICAgICovCgogICAgLyoqCiAgICAgKiBBIG51bWJlciwgcHJvcG9ydGlvbmFsIHRvIHRoZSBmb3JjZSBhZGRlZCB0byB0aGUgYm9kaWVzLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihiaSwgYmosIG1pbkZvcmNlID0gLTFlNiwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgdGhpcy5pZCA9IHZvaWQgMDsKICAgICAgdGhpcy5taW5Gb3JjZSA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXhGb3JjZSA9IHZvaWQgMDsKICAgICAgdGhpcy5iaSA9IHZvaWQgMDsKICAgICAgdGhpcy5iaiA9IHZvaWQgMDsKICAgICAgdGhpcy5zaSA9IHZvaWQgMDsKICAgICAgdGhpcy5zaiA9IHZvaWQgMDsKICAgICAgdGhpcy5hID0gdm9pZCAwOwogICAgICB0aGlzLmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuZXBzID0gdm9pZCAwOwogICAgICB0aGlzLmphY29iaWFuRWxlbWVudEEgPSB2b2lkIDA7CiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QiA9IHZvaWQgMDsKICAgICAgdGhpcy5lbmFibGVkID0gdm9pZCAwOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMuaWQgPSBFcXVhdGlvbi5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5taW5Gb3JjZSA9IG1pbkZvcmNlOwogICAgICB0aGlzLm1heEZvcmNlID0gbWF4Rm9yY2U7CiAgICAgIHRoaXMuYmkgPSBiaTsKICAgICAgdGhpcy5iaiA9IGJqOwogICAgICB0aGlzLmEgPSAwLjA7IC8vIFNQT09LIHBhcmFtZXRlcgoKICAgICAgdGhpcy5iID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuZXBzID0gMC4wOyAvLyBTUE9PSyBwYXJhbWV0ZXIKCiAgICAgIHRoaXMuamFjb2JpYW5FbGVtZW50QSA9IG5ldyBKYWNvYmlhbkVsZW1lbnQoKTsKICAgICAgdGhpcy5qYWNvYmlhbkVsZW1lbnRCID0gbmV3IEphY29iaWFuRWxlbWVudCgpOwogICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlOwogICAgICB0aGlzLm11bHRpcGxpZXIgPSAwOwogICAgICB0aGlzLnNldFNwb29rUGFyYW1zKDFlNywgNCwgMSAvIDYwKTsgLy8gU2V0IHR5cGljYWwgc3Bvb2sgcGFyYW1zCiAgICB9CiAgICAvKioKICAgICAqIFJlY2FsY3VsYXRlcyBhLCBiLCBhbmQgZXBzLgogICAgICoKICAgICAqIFRoZSBFcXVhdGlvbiBjb25zdHJ1Y3RvciBzZXRzIHR5cGljYWwgU1BPT0sgcGFyYW1ldGVycyBhcyBzdWNoOgogICAgICogKiBgc3RpZmZuZXNzYCA9IDFlNwogICAgICogKiBgcmVsYXhhdGlvbmAgPSA0CiAgICAgKiAqIGB0aW1lU3RlcGA9IDEgLyA2MCwgX25vdGUgdGhlIGhhcmRjb2RlZCByZWZyZXNoIHJhdGUuXwogICAgICovCgoKICAgIHNldFNwb29rUGFyYW1zKHN0aWZmbmVzcywgcmVsYXhhdGlvbiwgdGltZVN0ZXApIHsKICAgICAgY29uc3QgZCA9IHJlbGF4YXRpb247CiAgICAgIGNvbnN0IGsgPSBzdGlmZm5lc3M7CiAgICAgIGNvbnN0IGggPSB0aW1lU3RlcDsKICAgICAgdGhpcy5hID0gNC4wIC8gKGggKiAoMSArIDQgKiBkKSk7CiAgICAgIHRoaXMuYiA9IDQuMCAqIGQgLyAoMSArIDQgKiBkKTsKICAgICAgdGhpcy5lcHMgPSA0LjAgLyAoaCAqIGggKiBrICogKDEgKyA0ICogZCkpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyB0aGUgcmlnaHQgaGFuZCBzaWRlIG9mIHRoZSBTUE9PSyBlcXVhdGlvbgogICAgICovCgoKICAgIGNvbXB1dGVCKGEsIGIsIGgpIHsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHcSA9IHRoaXMuY29tcHV0ZUdxKCk7CiAgICAgIGNvbnN0IEdpTWYgPSB0aGlzLmNvbXB1dGVHaU1mKCk7CiAgICAgIHJldHVybiAtR3EgKiBhIC0gR1cgKiBiIC0gR2lNZiAqIGg7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqcSwgd2hlcmUgcSBhcmUgdGhlIGdlbmVyYWxpemVkIGJvZHkgY29vcmRpbmF0ZXMKICAgICAqLwoKCiAgICBjb21wdXRlR3EoKSB7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHhpID0gYmkucG9zaXRpb247CiAgICAgIGNvbnN0IHhqID0gYmoucG9zaXRpb247CiAgICAgIHJldHVybiBHQS5zcGF0aWFsLmRvdCh4aSkgKyBHQi5zcGF0aWFsLmRvdCh4aik7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGVzIEcqVywgd2hlcmUgVyBhcmUgdGhlIGJvZHkgdmVsb2NpdGllcwogICAgICovCgoKICAgIGNvbXB1dGVHVygpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgdmkgPSBiaS52ZWxvY2l0eTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2kgPSBiaS5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGNvbnN0IHdqID0gYmouYW5ndWxhclZlbG9jaXR5OwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKHZpLCB3aSkgKyBHQi5tdWx0aXBseVZlY3RvcnModmosIHdqKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZXMgRypXbGFtYmRhLCB3aGVyZSBXIGFyZSB0aGUgYm9keSB2ZWxvY2l0aWVzCiAgICAgKi8KCgogICAgY29tcHV0ZUdXbGFtYmRhKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB2aSA9IGJpLnZsYW1iZGE7CiAgICAgIGNvbnN0IHZqID0gYmoudmxhbWJkYTsKICAgICAgY29uc3Qgd2kgPSBiaS53bGFtYmRhOwogICAgICBjb25zdCB3aiA9IGJqLndsYW1iZGE7CiAgICAgIHJldHVybiBHQS5tdWx0aXBseVZlY3RvcnModmksIHdpKSArIEdCLm11bHRpcGx5VmVjdG9ycyh2aiwgd2opOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpmLCB3aGVyZSBNIGlzIHRoZSBtYXNzIG1hdHJpeCB3aXRoIGRpYWdvbmFsIGJsb2NrcyBmb3IgZWFjaCBib2R5LCBhbmQgZiBhcmUgdGhlIGZvcmNlcyBvbiB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGNvbXB1dGVHaU1mKCkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCBmaSA9IGJpLmZvcmNlOwogICAgICBjb25zdCB0aSA9IGJpLnRvcnF1ZTsKICAgICAgY29uc3QgZmogPSBiai5mb3JjZTsKICAgICAgY29uc3QgdGogPSBiai50b3JxdWU7CiAgICAgIGNvbnN0IGludk1hc3NpID0gYmkuaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZNYXNzaiA9IGJqLmludk1hc3NTb2x2ZTsKICAgICAgZmkuc2NhbGUoaW52TWFzc2ksIGlNZmkpOwogICAgICBmai5zY2FsZShpbnZNYXNzaiwgaU1maik7CiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KHRpLCBpbnZJaV92bXVsdF90YXVpKTsKICAgICAgYmouaW52SW5lcnRpYVdvcmxkU29sdmUudm11bHQodGosIGludklqX3ZtdWx0X3RhdWopOwogICAgICByZXR1cm4gR0EubXVsdGlwbHlWZWN0b3JzKGlNZmksIGludklpX3ZtdWx0X3RhdWkpICsgR0IubXVsdGlwbHlWZWN0b3JzKGlNZmosIGludklqX3ZtdWx0X3RhdWopOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlcyBHKmludihNKSpHJwogICAgICovCgoKICAgIGNvbXB1dGVHaU1HdCgpIHsKICAgICAgY29uc3QgR0EgPSB0aGlzLmphY29iaWFuRWxlbWVudEE7CiAgICAgIGNvbnN0IEdCID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRCOwogICAgICBjb25zdCBiaSA9IHRoaXMuYmk7CiAgICAgIGNvbnN0IGJqID0gdGhpcy5iajsKICAgICAgY29uc3QgaW52TWFzc2kgPSBiaS5pbnZNYXNzU29sdmU7CiAgICAgIGNvbnN0IGludk1hc3NqID0gYmouaW52TWFzc1NvbHZlOwogICAgICBjb25zdCBpbnZJaSA9IGJpLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBjb25zdCBpbnZJaiA9IGJqLmludkluZXJ0aWFXb3JsZFNvbHZlOwogICAgICBsZXQgcmVzdWx0ID0gaW52TWFzc2kgKyBpbnZNYXNzajsKICAgICAgaW52SWkudm11bHQoR0Eucm90YXRpb25hbCwgdG1wKTsKICAgICAgcmVzdWx0ICs9IHRtcC5kb3QoR0Eucm90YXRpb25hbCk7CiAgICAgIGludklqLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRtcCk7CiAgICAgIHJlc3VsdCArPSB0bXAuZG90KEdCLnJvdGF0aW9uYWwpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgY29uc3RyYWludCB2ZWxvY2l0eSB0byB0aGUgYm9kaWVzLgogICAgICovCgoKICAgIGFkZFRvV2xhbWJkYShkZWx0YWxhbWJkYSkgewogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IGJpID0gdGhpcy5iaTsKICAgICAgY29uc3QgYmogPSB0aGlzLmJqOwogICAgICBjb25zdCB0ZW1wID0gYWRkVG9XbGFtYmRhX3RlbXA7IC8vIEFkZCB0byBsaW5lYXIgdmVsb2NpdHkKICAgICAgLy8gdl9sYW1iZGEgKz0gaW52KE0pICogZGVsdGFfbGFtYmEgKiBHCgogICAgICBiaS52bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihiaS5pbnZNYXNzU29sdmUgKiBkZWx0YWxhbWJkYSwgR0Euc3BhdGlhbCwgYmkudmxhbWJkYSk7CiAgICAgIGJqLnZsYW1iZGEuYWRkU2NhbGVkVmVjdG9yKGJqLmludk1hc3NTb2x2ZSAqIGRlbHRhbGFtYmRhLCBHQi5zcGF0aWFsLCBiai52bGFtYmRhKTsgLy8gQWRkIHRvIGFuZ3VsYXIgdmVsb2NpdHkKCiAgICAgIGJpLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdBLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiaS53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmkud2xhbWJkYSk7CiAgICAgIGJqLmludkluZXJ0aWFXb3JsZFNvbHZlLnZtdWx0KEdCLnJvdGF0aW9uYWwsIHRlbXApOwogICAgICBiai53bGFtYmRhLmFkZFNjYWxlZFZlY3RvcihkZWx0YWxhbWJkYSwgdGVtcCwgYmoud2xhbWJkYSk7CiAgICB9CiAgICAvKioKICAgICAqIENvbXB1dGUgdGhlIGRlbm9taW5hdG9yIHBhcnQgb2YgdGhlIFNQT09LIGVxdWF0aW9uOiBDID0gRyppbnYoTSkqRycgKyBlcHMKICAgICAqLwoKCiAgICBjb21wdXRlQygpIHsKICAgICAgcmV0dXJuIHRoaXMuY29tcHV0ZUdpTUd0KCkgKyB0aGlzLmVwczsKICAgIH0KCiAgfQoKICBFcXVhdGlvbi5pZENvdW50ZXIgPSAwOwogIGNvbnN0IGlNZmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGlNZmogPSBuZXcgVmVjMygpOwogIGNvbnN0IGludklpX3ZtdWx0X3RhdWkgPSBuZXcgVmVjMygpOwogIGNvbnN0IGludklqX3ZtdWx0X3RhdWogPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYWRkVG9XbGFtYmRhX3RlbXAgPSBuZXcgVmVjMygpOwogIC8qKgogICAqIENvbnRhY3Qvbm9uLXBlbmV0cmF0aW9uIGNvbnN0cmFpbnQgZXF1YXRpb24KICAgKi8KCiAgY2xhc3MgQ29udGFjdEVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiAiYm91bmNpbmVzcyI6IHUxID0gLWUqdTAKICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQtb3JpZW50ZWQgdmVjdG9yIHRoYXQgZ29lcyBmcm9tIHRoZSBjZW50ZXIgb2YgYmkgdG8gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkLW9yaWVudGVkIHZlY3RvciB0aGF0IHN0YXJ0cyBpbiBib2R5IGogcG9zaXRpb24gYW5kIGdvZXMgdG8gdGhlIGNvbnRhY3QgcG9pbnQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIENvbnRhY3Qgbm9ybWFsLCBwb2ludGluZyBvdXQgb2YgYm9keSBpLgogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG1heEZvcmNlID0gMWU2KSB7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgMCwgbWF4Rm9yY2UpOwogICAgICB0aGlzLnJlc3RpdHV0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnJpID0gdm9pZCAwOwogICAgICB0aGlzLnJqID0gdm9pZCAwOwogICAgICB0aGlzLm5pID0gdm9pZCAwOwogICAgICB0aGlzLnJlc3RpdHV0aW9uID0gMC4wOwogICAgICB0aGlzLnJpID0gbmV3IFZlYzMoKTsKICAgICAgdGhpcy5yaiA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMubmkgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgY29uc3QgYmkgPSB0aGlzLmJpOwogICAgICBjb25zdCBiaiA9IHRoaXMuYmo7CiAgICAgIGNvbnN0IHJpID0gdGhpcy5yaTsKICAgICAgY29uc3QgcmogPSB0aGlzLnJqOwogICAgICBjb25zdCByaXhuID0gQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAxOwogICAgICBjb25zdCByanhuID0gQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB2aSA9IGJpLnZlbG9jaXR5OwogICAgICBjb25zdCB3aSA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgYmkuZm9yY2U7CiAgICAgIGJpLnRvcnF1ZTsKICAgICAgY29uc3QgdmogPSBiai52ZWxvY2l0eTsKICAgICAgY29uc3Qgd2ogPSBiai5hbmd1bGFyVmVsb2NpdHk7CiAgICAgIGJqLmZvcmNlOwogICAgICBiai50b3JxdWU7CiAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjID0gQ29udGFjdEVxdWF0aW9uX2NvbXB1dGVCX3RlbXAzOwogICAgICBjb25zdCBHQSA9IHRoaXMuamFjb2JpYW5FbGVtZW50QTsKICAgICAgY29uc3QgR0IgPSB0aGlzLmphY29iaWFuRWxlbWVudEI7CiAgICAgIGNvbnN0IG4gPSB0aGlzLm5pOyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKG4sIHJpeG4pOwogICAgICByai5jcm9zcyhuLCByanhuKTsgLy8gZyA9IHhqK3JqIC0oeGkrcmkpCiAgICAgIC8vIEcgPSBbIC1uaSAgLXJpeG4gIG5pICByanhuIF0KCiAgICAgIG4ubmVnYXRlKEdBLnNwYXRpYWwpOwogICAgICByaXhuLm5lZ2F0ZShHQS5yb3RhdGlvbmFsKTsKICAgICAgR0Iuc3BhdGlhbC5jb3B5KG4pOwogICAgICBHQi5yb3RhdGlvbmFsLmNvcHkocmp4bik7IC8vIENhbGN1bGF0ZSB0aGUgcGVuZXRyYXRpb24gdmVjdG9yCgogICAgICBwZW5ldHJhdGlvblZlYy5jb3B5KGJqLnBvc2l0aW9uKTsKICAgICAgcGVuZXRyYXRpb25WZWMudmFkZChyaiwgcGVuZXRyYXRpb25WZWMpOwogICAgICBwZW5ldHJhdGlvblZlYy52c3ViKGJpLnBvc2l0aW9uLCBwZW5ldHJhdGlvblZlYyk7CiAgICAgIHBlbmV0cmF0aW9uVmVjLnZzdWIocmksIHBlbmV0cmF0aW9uVmVjKTsKICAgICAgY29uc3QgZyA9IG4uZG90KHBlbmV0cmF0aW9uVmVjKTsgLy8gQ29tcHV0ZSBpdGVyYXRpb24KCiAgICAgIGNvbnN0IGVQbHVzT25lID0gdGhpcy5yZXN0aXR1dGlvbiArIDE7CiAgICAgIGNvbnN0IEdXID0gZVBsdXNPbmUgKiB2ai5kb3QobikgLSBlUGx1c09uZSAqIHZpLmRvdChuKSArIHdqLmRvdChyanhuKSAtIHdpLmRvdChyaXhuKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBjdXJyZW50IHJlbGF0aXZlIHZlbG9jaXR5IGluIHRoZSBjb250YWN0IHBvaW50LgogICAgICovCgoKICAgIGdldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWwoKSB7CiAgICAgIGNvbnN0IHZpID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfdmk7CiAgICAgIGNvbnN0IHZqID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfdmo7CiAgICAgIGNvbnN0IHhpID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGk7CiAgICAgIGNvbnN0IHhqID0gQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGo7CiAgICAgIGNvbnN0IHJlbFZlbCA9IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3JlbFZlbDsKICAgICAgdGhpcy5iaS5wb3NpdGlvbi52YWRkKHRoaXMucmksIHhpKTsKICAgICAgdGhpcy5iai5wb3NpdGlvbi52YWRkKHRoaXMucmosIHhqKTsKICAgICAgdGhpcy5iaS5nZXRWZWxvY2l0eUF0V29ybGRQb2ludCh4aSwgdmkpOwogICAgICB0aGlzLmJqLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KHhqLCB2aik7CiAgICAgIHZpLnZzdWIodmosIHJlbFZlbCk7CiAgICAgIHJldHVybiB0aGlzLm5pLmRvdChyZWxWZWwpOwogICAgfQoKICB9CgogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9jb21wdXRlQl90ZW1wMSA9IG5ldyBWZWMzKCk7IC8vIFRlbXAgdmVjdG9ycwoKICBjb25zdCBDb250YWN0RXF1YXRpb25fY29tcHV0ZUJfdGVtcDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9jb21wdXRlQl90ZW1wMyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfdmkgPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3ZqID0gbmV3IFZlYzMoKTsKICBjb25zdCBDb250YWN0RXF1YXRpb25fZ2V0SW1wYWN0VmVsb2NpdHlBbG9uZ05vcm1hbF94aSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgQ29udGFjdEVxdWF0aW9uX2dldEltcGFjdFZlbG9jaXR5QWxvbmdOb3JtYWxfeGogPSBuZXcgVmVjMygpOwogIGNvbnN0IENvbnRhY3RFcXVhdGlvbl9nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsX3JlbFZlbCA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQ29ubmVjdHMgdHdvIGJvZGllcyBhdCBnaXZlbiBvZmZzZXQgcG9pbnRzLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IGJvZHlBID0gbmV3IEJvZHkoeyBtYXNzOiAxIH0pCiAgICogICAgIGNvbnN0IGJvZHlCID0gbmV3IEJvZHkoeyBtYXNzOiAxIH0pCiAgICogICAgIGJvZHlBLnBvc2l0aW9uLnNldCgtMSwgMCwgMCkKICAgKiAgICAgYm9keUIucG9zaXRpb24uc2V0KDEsIDAsIDApCiAgICogICAgIGJvZHlBLmFkZFNoYXBlKHNoYXBlQSkKICAgKiAgICAgYm9keUIuYWRkU2hhcGUoc2hhcGVCKQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJvZHlBKQogICAqICAgICB3b3JsZC5hZGRCb2R5KGJvZHlCKQogICAqICAgICBjb25zdCBsb2NhbFBpdm90QSA9IG5ldyBWZWMzKDEsIDAsIDApCiAgICogICAgIGNvbnN0IGxvY2FsUGl2b3RCID0gbmV3IFZlYzMoLTEsIDAsIDApCiAgICogICAgIGNvbnN0IGNvbnN0cmFpbnQgPSBuZXcgUG9pbnRUb1BvaW50Q29uc3RyYWludChib2R5QSwgbG9jYWxQaXZvdEEsIGJvZHlCLCBsb2NhbFBpdm90QikKICAgKiAgICAgd29ybGQuYWRkQ29uc3RyYWludChjb25zdHJhaW50KQogICAqLwoKICBjbGFzcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IGV4dGVuZHMgQ29uc3RyYWludCB7CiAgICAvKioKICAgICAqIFBpdm90LCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUEuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFBpdm90LCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUIuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBwaXZvdEEgVGhlIHBvaW50IHJlbGF0aXZlIHRvIHRoZSBjZW50ZXIgb2YgbWFzcyBvZiBib2R5QSB3aGljaCBib2R5QSBpcyBjb25zdHJhaW5lZCB0by4KICAgICAqIEBwYXJhbSBib2R5QiBCb2R5IHRoYXQgd2lsbCBiZSBjb25zdHJhaW5lZCBpbiBhIHNpbWlsYXIgd2F5IHRvIHRoZSBzYW1lIHBvaW50IGFzIGJvZHlBLiBXZSB3aWxsIHRoZXJlZm9yZSBnZXQgYSBsaW5rIGJldHdlZW4gYm9keUEgYW5kIGJvZHlCLiBJZiBub3Qgc3BlY2lmaWVkLCBib2R5QSB3aWxsIGJlIGNvbnN0cmFpbmVkIHRvIGEgc3RhdGljIHBvaW50LgogICAgICogQHBhcmFtIHBpdm90QiBUaGUgcG9pbnQgcmVsYXRpdmUgdG8gdGhlIGNlbnRlciBvZiBtYXNzIG9mIGJvZHlCIHdoaWNoIGJvZHlCIGlzIGNvbnN0cmFpbmVkIHRvLgogICAgICogQHBhcmFtIG1heEZvcmNlIFRoZSBtYXhpbXVtIGZvcmNlIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQgdG8gY29uc3RyYWluIHRoZSBib2RpZXMuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBwaXZvdEEgPSBuZXcgVmVjMygpLCBib2R5QiwgcGl2b3RCID0gbmV3IFZlYzMoKSwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCKTsKICAgICAgdGhpcy5waXZvdEEgPSB2b2lkIDA7CiAgICAgIHRoaXMucGl2b3RCID0gdm9pZCAwOwogICAgICB0aGlzLmVxdWF0aW9uWCA9IHZvaWQgMDsKICAgICAgdGhpcy5lcXVhdGlvblkgPSB2b2lkIDA7CiAgICAgIHRoaXMuZXF1YXRpb25aID0gdm9pZCAwOwogICAgICB0aGlzLnBpdm90QSA9IHBpdm90QS5jbG9uZSgpOwogICAgICB0aGlzLnBpdm90QiA9IHBpdm90Qi5jbG9uZSgpOwogICAgICBjb25zdCB4ID0gdGhpcy5lcXVhdGlvblggPSBuZXcgQ29udGFjdEVxdWF0aW9uKGJvZHlBLCBib2R5Qik7CiAgICAgIGNvbnN0IHkgPSB0aGlzLmVxdWF0aW9uWSA9IG5ldyBDb250YWN0RXF1YXRpb24oYm9keUEsIGJvZHlCKTsKICAgICAgY29uc3QgeiA9IHRoaXMuZXF1YXRpb25aID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOyAvLyBFcXVhdGlvbnMgdG8gYmUgZmVkIHRvIHRoZSBzb2x2ZXIKCiAgICAgIHRoaXMuZXF1YXRpb25zLnB1c2goeCwgeSwgeik7IC8vIE1ha2UgdGhlIGVxdWF0aW9ucyBiaWRpcmVjdGlvbmFsCgogICAgICB4Lm1pbkZvcmNlID0geS5taW5Gb3JjZSA9IHoubWluRm9yY2UgPSAtbWF4Rm9yY2U7CiAgICAgIHgubWF4Rm9yY2UgPSB5Lm1heEZvcmNlID0gei5tYXhGb3JjZSA9IG1heEZvcmNlOwogICAgICB4Lm5pLnNldCgxLCAwLCAwKTsKICAgICAgeS5uaS5zZXQoMCwgMSwgMCk7CiAgICAgIHoubmkuc2V0KDAsIDAsIDEpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHggPSB0aGlzLmVxdWF0aW9uWDsKICAgICAgY29uc3QgeSA9IHRoaXMuZXF1YXRpb25ZOwogICAgICBjb25zdCB6ID0gdGhpcy5lcXVhdGlvblo7IC8vIFJvdGF0ZSB0aGUgcGl2b3RzIHRvIHdvcmxkIHNwYWNlCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KHRoaXMucGl2b3RBLCB4LnJpKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdCh0aGlzLnBpdm90QiwgeC5yaik7CiAgICAgIHkucmkuY29weSh4LnJpKTsKICAgICAgeS5yai5jb3B5KHgucmopOwogICAgICB6LnJpLmNvcHkoeC5yaSk7CiAgICAgIHoucmouY29weSh4LnJqKTsKICAgIH0KCiAgfQogIC8qKgogICAqIENvbmUgZXF1YXRpb24uIFdvcmtzIHRvIGtlZXAgdGhlIGdpdmVuIGJvZHkgd29ybGQgdmVjdG9ycyBhbGlnbmVkLCBvciB0aWx0ZWQgd2l0aGluIGEgZ2l2ZW4gYW5nbGUgZnJvbSBlYWNoIG90aGVyLgogICAqLwoKCiAgY2xhc3MgQ29uZUVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBMb2NhbCBheGlzIGluIEEKICAgICAqLwoKICAgIC8qKgogICAgICogTG9jYWwgYXhpcyBpbiBCCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSAiY29uZSBhbmdsZSIgdG8ga2VlcAogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMgPSB7fSkgewogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0IgPSB2b2lkIDA7CiAgICAgIHRoaXMuYW5nbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMuYW5nbGUgPSB0eXBlb2Ygb3B0aW9ucy5hbmdsZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmFuZ2xlIDogMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMjsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDI7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBUaGUgYW5nbGUgYmV0d2VlbiB0d28gdmVjdG9yIGlzOgogICAgICAvLyBjb3ModGhldGEpID0gYSAqIGIgLyAobGVuZ3RoKGEpICogbGVuZ3RoKGIpID0geyBsZW4oYSkgPSBsZW4oYikgPSAxIH0gPSBhICogYgogICAgICAvLyBnID0gYSAqIGIKICAgICAgLy8gZ2RvdCA9IChiIHggYSkgKiB3aSArIChhIHggYikgKiB3agogICAgICAvLyBHID0gWzAgYnhhIDAgYXhiXQogICAgICAvLyBXID0gW3ZpIHdpIHZqIHdqXQoKICAgICAgR0Eucm90YXRpb25hbC5jb3B5KG5qeG5pKTsKICAgICAgR0Iucm90YXRpb25hbC5jb3B5KG5peG5qKTsKICAgICAgY29uc3QgZyA9IE1hdGguY29zKHRoaXMuYW5nbGUpIC0gbmkuZG90KG5qKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLWcgKiBhIC0gR1cgKiBiIC0gaCAqIEdpTWY7CiAgICAgIHJldHVybiBCOwogICAgfQoKICB9CgogIGNvbnN0IHRtcFZlYzEkMiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdG1wVmVjMiQyID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBSb3RhdGlvbmFsIGNvbnN0cmFpbnQuIFdvcmtzIHRvIGtlZXAgdGhlIGxvY2FsIHZlY3RvcnMgb3J0aG9nb25hbCB0byBlYWNoIG90aGVyIGluIHdvcmxkIHNwYWNlLgogICAqLwoKICBjbGFzcyBSb3RhdGlvbmFsRXF1YXRpb24gZXh0ZW5kcyBFcXVhdGlvbiB7CiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQgb3JpZW50ZWQgcm90YXRpb25hbCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBtYXhBbmdsZQogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMgPSB7fSkgewogICAgICBjb25zdCBtYXhGb3JjZSA9IHR5cGVvZiBvcHRpb25zLm1heEZvcmNlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMubWF4Rm9yY2UgOiAxZTY7CiAgICAgIHN1cGVyKGJvZHlBLCBib2R5QiwgLW1heEZvcmNlLCBtYXhGb3JjZSk7CiAgICAgIHRoaXMuYXhpc0EgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0IgPSB2b2lkIDA7CiAgICAgIHRoaXMubWF4QW5nbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMCwgMSwgMCk7CiAgICAgIHRoaXMubWF4QW5nbGUgPSBNYXRoLlBJIC8gMjsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIGNvbnN0IGEgPSB0aGlzLmE7CiAgICAgIGNvbnN0IGIgPSB0aGlzLmI7CiAgICAgIGNvbnN0IG5pID0gdGhpcy5heGlzQTsKICAgICAgY29uc3QgbmogPSB0aGlzLmF4aXNCOwogICAgICBjb25zdCBuaXhuaiA9IHRtcFZlYzEkMTsKICAgICAgY29uc3Qgbmp4bmkgPSB0bXBWZWMyJDE7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gQ2FsdWNsYXRlIGNyb3NzIHByb2R1Y3RzCgogICAgICBuaS5jcm9zcyhuaiwgbml4bmopOwogICAgICBuai5jcm9zcyhuaSwgbmp4bmkpOyAvLyBnID0gbmkgKiBuagogICAgICAvLyBnZG90ID0gKG5qIHggbmkpICogd2kgKyAobmkgeCBuaikgKiB3agogICAgICAvLyBHID0gWzAgbmp4bmkgMCBuaXhual0KICAgICAgLy8gVyA9IFt2aSB3aSB2aiB3al0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShuanhuaSk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShuaXhuaik7CiAgICAgIGNvbnN0IGcgPSBNYXRoLmNvcyh0aGlzLm1heEFuZ2xlKSAtIG5pLmRvdChuaik7CiAgICAgIGNvbnN0IEdXID0gdGhpcy5jb21wdXRlR1coKTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1nICogYSAtIEdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQoKICBjb25zdCB0bXBWZWMxJDEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzIkMSA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQSBDb25lIFR3aXN0IGNvbnN0cmFpbnQsIHVzZWZ1bCBmb3IgcmFnZG9sbHMuCiAgICovCgogIGNsYXNzIENvbmVUd2lzdENvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogVGhlIGF4aXMgZGlyZWN0aW9uIGZvciB0aGUgY29uc3RyYWludCBvZiB0aGUgYm9keSBBLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYXhpcyBkaXJlY3Rpb24gZm9yIHRoZSBjb25zdHJhaW50IG9mIHRoZSBib2R5IEIuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBhcGVydHVyZSBhbmdsZSBvZiB0aGUgY29uZS4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHR3aXN0IGFuZ2xlIG9mIHRoZSBqb2ludC4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zID0ge30pIHsKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gdm9pZCAwOwogICAgICB0aGlzLmF4aXNCID0gdm9pZCAwOwogICAgICB0aGlzLmFuZ2xlID0gdm9pZCAwOwogICAgICB0aGlzLnR3aXN0QW5nbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29uZUVxdWF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnR3aXN0RXF1YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgdGhpcy5heGlzQiA9IG9wdGlvbnMuYXhpc0IgPyBvcHRpb25zLmF4aXNCLmNsb25lKCkgOiBuZXcgVmVjMygpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgdGhpcy5hbmdsZSA9IHR5cGVvZiBvcHRpb25zLmFuZ2xlICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuYW5nbGUgOiAwOwogICAgICBjb25zdCBjID0gdGhpcy5jb25lRXF1YXRpb24gPSBuZXcgQ29uZUVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHQgPSB0aGlzLnR3aXN0RXF1YXRpb24gPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIHRoaXMudHdpc3RBbmdsZSA9IHR5cGVvZiBvcHRpb25zLnR3aXN0QW5nbGUgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy50d2lzdEFuZ2xlIDogMDsgLy8gTWFrZSB0aGUgY29uZSBlcXVhdGlvbiBwdXNoIHRoZSBib2RpZXMgdG93YXJkIHRoZSBjb25lIGF4aXMsIG5vdCBvdXR3YXJkCgogICAgICBjLm1heEZvcmNlID0gMDsKICAgICAgYy5taW5Gb3JjZSA9IC1tYXhGb3JjZTsgLy8gTWFrZSB0aGUgdHdpc3QgZXF1YXRpb24gYWRkIHRvcnF1ZSB0b3dhcmQgdGhlIGluaXRpYWwgcG9zaXRpb24KCiAgICAgIHQubWF4Rm9yY2UgPSAwOwogICAgICB0Lm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGMsIHQpOwogICAgfQoKICAgIHVwZGF0ZSgpIHsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IGNvbmUgPSB0aGlzLmNvbmVFcXVhdGlvbjsKICAgICAgY29uc3QgdHdpc3QgPSB0aGlzLnR3aXN0RXF1YXRpb247CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBVcGRhdGUgdGhlIGF4ZXMgdG8gdGhlIGNvbmUgY29uc3RyYWludAoKICAgICAgYm9keUEudmVjdG9yVG9Xb3JsZEZyYW1lKHRoaXMuYXhpc0EsIGNvbmUuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy5heGlzQiwgY29uZS5heGlzQik7IC8vIFVwZGF0ZSB0aGUgd29ybGQgYXhlcyBpbiB0aGUgdHdpc3QgY29uc3RyYWludAoKICAgICAgdGhpcy5heGlzQS50YW5nZW50cyh0d2lzdC5heGlzQSwgdHdpc3QuYXhpc0EpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodHdpc3QuYXhpc0EsIHR3aXN0LmF4aXNBKTsKICAgICAgdGhpcy5heGlzQi50YW5nZW50cyh0d2lzdC5heGlzQiwgdHdpc3QuYXhpc0IpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodHdpc3QuYXhpc0IsIHR3aXN0LmF4aXNCKTsKICAgICAgY29uZS5hbmdsZSA9IHRoaXMuYW5nbGU7CiAgICAgIHR3aXN0Lm1heEFuZ2xlID0gdGhpcy50d2lzdEFuZ2xlOwogICAgfQoKICB9CiAgLyoqCiAgICogQ29uc3RyYWlucyB0d28gYm9kaWVzIHRvIGJlIGF0IGEgY29uc3RhbnQgZGlzdGFuY2UgZnJvbSBlYWNoIG90aGVycyBjZW50ZXIgb2YgbWFzcy4KICAgKi8KCgogIGNsYXNzIERpc3RhbmNlQ29uc3RyYWludCBleHRlbmRzIENvbnN0cmFpbnQgewogICAgLyoqCiAgICAgKiBUaGUgZGlzdGFuY2UgdG8ga2VlcC4gSWYgdW5kZWZpbmVkLCBpdCB3aWxsIGJlIHNldCB0byB0aGUgY3VycmVudCBkaXN0YW5jZSBiZXR3ZWVuIGJvZHlBIGFuZCBib2R5QgogICAgICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gZGlzdGFuY2UgVGhlIGRpc3RhbmNlIHRvIGtlZXAuIElmIHVuZGVmaW5lZCwgaXQgd2lsbCBiZSBzZXQgdG8gdGhlIGN1cnJlbnQgZGlzdGFuY2UgYmV0d2VlbiBib2R5QSBhbmQgYm9keUIuCiAgICAgKiBAcGFyYW0gbWF4Rm9yY2UgVGhlIG1heGltdW0gZm9yY2UgdGhhdCBzaG91bGQgYmUgYXBwbGllZCB0byBjb25zdHJhaW4gdGhlIGJvZGllcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBkaXN0YW5jZSwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCKTsKICAgICAgdGhpcy5kaXN0YW5jZSA9IHZvaWQgMDsKICAgICAgdGhpcy5kaXN0YW5jZUVxdWF0aW9uID0gdm9pZCAwOwoKICAgICAgaWYgKHR5cGVvZiBkaXN0YW5jZSA9PT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICBkaXN0YW5jZSA9IGJvZHlBLnBvc2l0aW9uLmRpc3RhbmNlVG8oYm9keUIucG9zaXRpb24pOwogICAgICB9CgogICAgICB0aGlzLmRpc3RhbmNlID0gZGlzdGFuY2U7CiAgICAgIGNvbnN0IGVxID0gdGhpcy5kaXN0YW5jZUVxdWF0aW9uID0gbmV3IENvbnRhY3RFcXVhdGlvbihib2R5QSwgYm9keUIpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKGVxKTsgLy8gTWFrZSBpdCBiaWRpcmVjdGlvbmFsCgogICAgICBlcS5taW5Gb3JjZSA9IC1tYXhGb3JjZTsKICAgICAgZXEubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgIH0KICAgIC8qKgogICAgICogdXBkYXRlCiAgICAgKi8KCgogICAgdXBkYXRlKCkgewogICAgICBjb25zdCBib2R5QSA9IHRoaXMuYm9keUE7CiAgICAgIGNvbnN0IGJvZHlCID0gdGhpcy5ib2R5QjsKICAgICAgY29uc3QgZXEgPSB0aGlzLmRpc3RhbmNlRXF1YXRpb247CiAgICAgIGNvbnN0IGhhbGZEaXN0ID0gdGhpcy5kaXN0YW5jZSAqIDAuNTsKICAgICAgY29uc3Qgbm9ybWFsID0gZXEubmk7CiAgICAgIGJvZHlCLnBvc2l0aW9uLnZzdWIoYm9keUEucG9zaXRpb24sIG5vcm1hbCk7CiAgICAgIG5vcm1hbC5ub3JtYWxpemUoKTsKICAgICAgbm9ybWFsLnNjYWxlKGhhbGZEaXN0LCBlcS5yaSk7CiAgICAgIG5vcm1hbC5zY2FsZSgtaGFsZkRpc3QsIGVxLnJqKTsKICAgIH0KCiAgfQogIC8qKgogICAqIExvY2sgY29uc3RyYWludC4gV2lsbCByZW1vdmUgYWxsIGRlZ3JlZXMgb2YgZnJlZWRvbSBiZXR3ZWVuIHRoZSBib2RpZXMuCiAgICovCgoKICBjbGFzcyBMb2NrQ29uc3RyYWludCBleHRlbmRzIFBvaW50VG9Qb2ludENvbnN0cmFpbnQgewogICAgY29uc3RydWN0b3IoYm9keUEsIGJvZHlCLCBvcHRpb25zID0ge30pIHsKICAgICAgY29uc3QgbWF4Rm9yY2UgPSB0eXBlb2Ygb3B0aW9ucy5tYXhGb3JjZSAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLm1heEZvcmNlIDogMWU2OyAvLyBTZXQgcGl2b3QgcG9pbnQgaW4gYmV0d2VlbgoKICAgICAgY29uc3QgcGl2b3RBID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgaGFsZldheSA9IG5ldyBWZWMzKCk7CiAgICAgIGJvZHlBLnBvc2l0aW9uLnZhZGQoYm9keUIucG9zaXRpb24sIGhhbGZXYXkpOwogICAgICBoYWxmV2F5LnNjYWxlKDAuNSwgaGFsZldheSk7CiAgICAgIGJvZHlCLnBvaW50VG9Mb2NhbEZyYW1lKGhhbGZXYXksIHBpdm90Qik7CiAgICAgIGJvZHlBLnBvaW50VG9Mb2NhbEZyYW1lKGhhbGZXYXksIHBpdm90QSk7IC8vIFRoZSBwb2ludC10by1wb2ludCBjb25zdHJhaW50IHdpbGwga2VlcCBhIHBvaW50IHNoYXJlZCBiZXR3ZWVuIHRoZSBib2RpZXMKCiAgICAgIHN1cGVyKGJvZHlBLCBwaXZvdEEsIGJvZHlCLCBwaXZvdEIsIG1heEZvcmNlKTsgLy8gU3RvcmUgaW5pdGlhbCByb3RhdGlvbiBvZiB0aGUgYm9kaWVzIGFzIHVuaXQgdmVjdG9ycyBpbiB0aGUgbG9jYWwgYm9keSBzcGFjZXMKCiAgICAgIHRoaXMueEEgPSB2b2lkIDA7CiAgICAgIHRoaXMueEIgPSB2b2lkIDA7CiAgICAgIHRoaXMueUEgPSB2b2lkIDA7CiAgICAgIHRoaXMueUIgPSB2b2lkIDA7CiAgICAgIHRoaXMuekEgPSB2b2lkIDA7CiAgICAgIHRoaXMuekIgPSB2b2lkIDA7CiAgICAgIHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IHZvaWQgMDsKICAgICAgdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gdm9pZCAwOwogICAgICB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjMgPSB2b2lkIDA7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy54QSA9IGJvZHlBLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWCk7CiAgICAgIHRoaXMueEIgPSBib2R5Qi52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1gpOwogICAgICB0aGlzLnlBID0gYm9keUEudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9ZKTsKICAgICAgdGhpcy55QiA9IGJvZHlCLnZlY3RvclRvTG9jYWxGcmFtZShWZWMzLlVOSVRfWSk7CiAgICAgIHRoaXMuekEgPSBib2R5QS52ZWN0b3JUb0xvY2FsRnJhbWUoVmVjMy5VTklUX1opOwogICAgICB0aGlzLnpCID0gYm9keUIudmVjdG9yVG9Mb2NhbEZyYW1lKFZlYzMuVU5JVF9aKTsgLy8gLi4uYW5kIHRoZSBmb2xsb3dpbmcgcm90YXRpb25hbCBlcXVhdGlvbnMgd2lsbCBrZWVwIGFsbCByb3RhdGlvbmFsIERPRidzIGluIHBsYWNlCgogICAgICBjb25zdCByMSA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMSA9IG5ldyBSb3RhdGlvbmFsRXF1YXRpb24oYm9keUEsIGJvZHlCLCBvcHRpb25zKTsKICAgICAgY29uc3QgcjIgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjIgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHIzID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24zID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICB0aGlzLmVxdWF0aW9ucy5wdXNoKHIxLCByMiwgcjMpOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICB0aGlzLm1vdG9yRXF1YXRpb247CiAgICAgIGNvbnN0IHIxID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24xOwogICAgICBjb25zdCByMiA9IHRoaXMucm90YXRpb25hbEVxdWF0aW9uMjsKICAgICAgY29uc3QgcjMgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjM7CiAgICAgIHN1cGVyLnVwZGF0ZSgpOyAvLyBUaGVzZSB2ZWN0b3IgcGFpcnMgbXVzdCBiZSBvcnRob2dvbmFsCgogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QSwgcjEuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QiwgcjEuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy55QSwgcjIuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QiwgcjIuYXhpc0IpOwogICAgICBib2R5QS52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy56QSwgcjMuYXhpc0EpOwogICAgICBib2R5Qi52ZWN0b3JUb1dvcmxkRnJhbWUodGhpcy54QiwgcjMuYXhpc0IpOwogICAgfQoKICB9CiAgLyoqCiAgICogUm90YXRpb25hbCBtb3RvciBjb25zdHJhaW50LiBUcmllcyB0byBrZWVwIHRoZSByZWxhdGl2ZSBhbmd1bGFyIHZlbG9jaXR5IG9mIHRoZSBib2RpZXMgdG8gYSBnaXZlbiB2YWx1ZS4KICAgKi8KCgogIGNsYXNzIFJvdGF0aW9uYWxNb3RvckVxdWF0aW9uIGV4dGVuZHMgRXF1YXRpb24gewogICAgLyoqCiAgICAgKiBXb3JsZCBvcmllbnRlZCByb3RhdGlvbmFsIGF4aXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdvcmxkIG9yaWVudGVkIHJvdGF0aW9uYWwgYXhpcy4KICAgICAqLwoKICAgIC8qKgogICAgICogTW90b3IgdmVsb2NpdHkuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5QiwgbWF4Rm9yY2UgPSAxZTYpIHsKICAgICAgc3VwZXIoYm9keUEsIGJvZHlCLCAtbWF4Rm9yY2UsIG1heEZvcmNlKTsKICAgICAgdGhpcy5heGlzQSA9IHZvaWQgMDsKICAgICAgdGhpcy5heGlzQiA9IHZvaWQgMDsKICAgICAgdGhpcy50YXJnZXRWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5heGlzQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMuYXhpc0IgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnRhcmdldFZlbG9jaXR5ID0gMDsKICAgIH0KCiAgICBjb21wdXRlQihoKSB7CiAgICAgIHRoaXMuYTsKICAgICAgY29uc3QgYiA9IHRoaXMuYjsKICAgICAgdGhpcy5iaTsKICAgICAgdGhpcy5iajsKICAgICAgY29uc3QgYXhpc0EgPSB0aGlzLmF4aXNBOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0I7CiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsgLy8gZyA9IDAKICAgICAgLy8gZ2RvdCA9IGF4aXNBICogd2kgLSBheGlzQiAqIHdqCiAgICAgIC8vIGdkb3QgPSBHICogVyA9IEcgKiBbdmkgd2kgdmogd2pdCiAgICAgIC8vID0+CiAgICAgIC8vIEcgPSBbMCBheGlzQSAwIC1heGlzQl0KCiAgICAgIEdBLnJvdGF0aW9uYWwuY29weShheGlzQSk7CiAgICAgIGF4aXNCLm5lZ2F0ZShHQi5yb3RhdGlvbmFsKTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpIC0gdGhpcy50YXJnZXRWZWxvY2l0eTsKICAgICAgY29uc3QgR2lNZiA9IHRoaXMuY29tcHV0ZUdpTWYoKTsKICAgICAgY29uc3QgQiA9IC1HVyAqIGIgLSBoICogR2lNZjsKICAgICAgcmV0dXJuIEI7CiAgICB9CgogIH0KICAvKioKICAgKiBIaW5nZSBjb25zdHJhaW50LiBUaGluayBvZiBpdCBhcyBhIGRvb3IgaGluZ2UuIEl0IHRyaWVzIHRvIGtlZXAgdGhlIGRvb3IgaW4gdGhlIGNvcnJlY3QgcGxhY2UgYW5kIHdpdGggdGhlIGNvcnJlY3Qgb3JpZW50YXRpb24uCiAgICovCgoKICBjbGFzcyBIaW5nZUNvbnN0cmFpbnQgZXh0ZW5kcyBQb2ludFRvUG9pbnRDb25zdHJhaW50IHsKICAgIC8qKgogICAgICogUm90YXRpb24gYXhpcywgZGVmaW5lZCBsb2NhbGx5IGluIGJvZHlBLgogICAgICovCgogICAgLyoqCiAgICAgKiBSb3RhdGlvbiBheGlzLCBkZWZpbmVkIGxvY2FsbHkgaW4gYm9keUIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyA9IHt9KSB7CiAgICAgIGNvbnN0IG1heEZvcmNlID0gdHlwZW9mIG9wdGlvbnMubWF4Rm9yY2UgIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhGb3JjZSA6IDFlNjsKICAgICAgY29uc3QgcGl2b3RBID0gb3B0aW9ucy5waXZvdEEgPyBvcHRpb25zLnBpdm90QS5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcGl2b3RCID0gb3B0aW9ucy5waXZvdEIgPyBvcHRpb25zLnBpdm90Qi5jbG9uZSgpIDogbmV3IFZlYzMoKTsKICAgICAgc3VwZXIoYm9keUEsIHBpdm90QSwgYm9keUIsIHBpdm90QiwgbWF4Rm9yY2UpOwogICAgICB0aGlzLmF4aXNBID0gdm9pZCAwOwogICAgICB0aGlzLmF4aXNCID0gdm9pZCAwOwogICAgICB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSB2b2lkIDA7CiAgICAgIHRoaXMucm90YXRpb25hbEVxdWF0aW9uMiA9IHZvaWQgMDsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uID0gdm9pZCAwOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0EgPSBvcHRpb25zLmF4aXNBID8gb3B0aW9ucy5heGlzQS5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNBLm5vcm1hbGl6ZSgpOwogICAgICBjb25zdCBheGlzQiA9IHRoaXMuYXhpc0IgPSBvcHRpb25zLmF4aXNCID8gb3B0aW9ucy5heGlzQi5jbG9uZSgpIDogbmV3IFZlYzMoMSwgMCwgMCk7CiAgICAgIGF4aXNCLm5vcm1hbGl6ZSgpOwogICAgICB0aGlzLmNvbGxpZGVDb25uZWN0ZWQgPSAhIW9wdGlvbnMuY29sbGlkZUNvbm5lY3RlZDsKICAgICAgY29uc3Qgcm90YXRpb25hbDEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjEgPSBuZXcgUm90YXRpb25hbEVxdWF0aW9uKGJvZHlBLCBib2R5Qiwgb3B0aW9ucyk7CiAgICAgIGNvbnN0IHJvdGF0aW9uYWwyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yID0gbmV3IFJvdGF0aW9uYWxFcXVhdGlvbihib2R5QSwgYm9keUIsIG9wdGlvbnMpOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbiA9IG5ldyBSb3RhdGlvbmFsTW90b3JFcXVhdGlvbihib2R5QSwgYm9keUIsIG1heEZvcmNlKTsKICAgICAgbW90b3IuZW5hYmxlZCA9IGZhbHNlOyAvLyBOb3QgZW5hYmxlZCBieSBkZWZhdWx0CiAgICAgIC8vIEVxdWF0aW9ucyB0byBiZSBmZWQgdG8gdGhlIHNvbHZlcgoKICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChyb3RhdGlvbmFsMSwgcm90YXRpb25hbDIsIG1vdG9yKTsKICAgIH0KICAgIC8qKgogICAgICogZW5hYmxlTW90b3IKICAgICAqLwoKCiAgICBlbmFibGVNb3RvcigpIHsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLmVuYWJsZWQgPSB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBkaXNhYmxlTW90b3IKICAgICAqLwoKCiAgICBkaXNhYmxlTW90b3IoKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi5lbmFibGVkID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIHNldE1vdG9yU3BlZWQKICAgICAqLwoKCiAgICBzZXRNb3RvclNwZWVkKHNwZWVkKSB7CiAgICAgIHRoaXMubW90b3JFcXVhdGlvbi50YXJnZXRWZWxvY2l0eSA9IHNwZWVkOwogICAgfQogICAgLyoqCiAgICAgKiBzZXRNb3Rvck1heEZvcmNlCiAgICAgKi8KCgogICAgc2V0TW90b3JNYXhGb3JjZShtYXhGb3JjZSkgewogICAgICB0aGlzLm1vdG9yRXF1YXRpb24ubWF4Rm9yY2UgPSBtYXhGb3JjZTsKICAgICAgdGhpcy5tb3RvckVxdWF0aW9uLm1pbkZvcmNlID0gLW1heEZvcmNlOwogICAgfQogICAgLyoqCiAgICAgKiB1cGRhdGUKICAgICAqLwoKCiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IGJvZHlBID0gdGhpcy5ib2R5QTsKICAgICAgY29uc3QgYm9keUIgPSB0aGlzLmJvZHlCOwogICAgICBjb25zdCBtb3RvciA9IHRoaXMubW90b3JFcXVhdGlvbjsKICAgICAgY29uc3QgcjEgPSB0aGlzLnJvdGF0aW9uYWxFcXVhdGlvbjE7CiAgICAgIGNvbnN0IHIyID0gdGhpcy5yb3RhdGlvbmFsRXF1YXRpb24yOwogICAgICBjb25zdCB3b3JsZEF4aXNBID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxOwogICAgICBjb25zdCB3b3JsZEF4aXNCID0gSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMyOwogICAgICBjb25zdCBheGlzQSA9IHRoaXMuYXhpc0E7CiAgICAgIGNvbnN0IGF4aXNCID0gdGhpcy5heGlzQjsKICAgICAgc3VwZXIudXBkYXRlKCk7IC8vIEdldCB3b3JsZCBheGVzCgogICAgICBib2R5QS5xdWF0ZXJuaW9uLnZtdWx0KGF4aXNBLCB3b3JsZEF4aXNBKTsKICAgICAgYm9keUIucXVhdGVybmlvbi52bXVsdChheGlzQiwgd29ybGRBeGlzQik7CiAgICAgIHdvcmxkQXhpc0EudGFuZ2VudHMocjEuYXhpc0EsIHIyLmF4aXNBKTsKICAgICAgcjEuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKICAgICAgcjIuYXhpc0IuY29weSh3b3JsZEF4aXNCKTsKCiAgICAgIGlmICh0aGlzLm1vdG9yRXF1YXRpb24uZW5hYmxlZCkgewogICAgICAgIGJvZHlBLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQSwgbW90b3IuYXhpc0EpOwogICAgICAgIGJvZHlCLnF1YXRlcm5pb24udm11bHQodGhpcy5heGlzQiwgbW90b3IuYXhpc0IpOwogICAgICB9CiAgICB9CgogIH0KCiAgY29uc3QgSGluZ2VDb25zdHJhaW50X3VwZGF0ZV90bXBWZWMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBIaW5nZUNvbnN0cmFpbnRfdXBkYXRlX3RtcFZlYzIgPSBuZXcgVmVjMygpOwogIC8qKgogICAqIENvbnN0cmFpbnMgdGhlIHNsaXBwaW5nIGluIGEgY29udGFjdCBhbG9uZyBhIHRhbmdlbnQKICAgKi8KCiAgY2xhc3MgRnJpY3Rpb25FcXVhdGlvbiBleHRlbmRzIEVxdWF0aW9uIHsKICAgIC8vIFRhbmdlbnQKCiAgICAvKioKICAgICAqIEBwYXJhbSBzbGlwRm9yY2Ugc2hvdWxkIGJlICstRl9mcmljdGlvbiA9ICstbXUgKiBGX25vcm1hbCA9ICstbXUgKiBtICogZwogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIHNsaXBGb3JjZSkgewogICAgICBzdXBlcihib2R5QSwgYm9keUIsIC1zbGlwRm9yY2UsIHNsaXBGb3JjZSk7CiAgICAgIHRoaXMucmkgPSB2b2lkIDA7CiAgICAgIHRoaXMucmogPSB2b2lkIDA7CiAgICAgIHRoaXMudCA9IHZvaWQgMDsKICAgICAgdGhpcy5yaSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMucmogPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnQgPSBuZXcgVmVjMygpOwogICAgfQoKICAgIGNvbXB1dGVCKGgpIHsKICAgICAgdGhpcy5hOwogICAgICBjb25zdCBiID0gdGhpcy5iOwogICAgICB0aGlzLmJpOwogICAgICB0aGlzLmJqOwogICAgICBjb25zdCByaSA9IHRoaXMucmk7CiAgICAgIGNvbnN0IHJqID0gdGhpcy5yajsKICAgICAgY29uc3Qgcml4dCA9IEZyaWN0aW9uRXF1YXRpb25fY29tcHV0ZUJfdGVtcDE7CiAgICAgIGNvbnN0IHJqeHQgPSBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyOwogICAgICBjb25zdCB0ID0gdGhpcy50OyAvLyBDYWx1Y2xhdGUgY3Jvc3MgcHJvZHVjdHMKCiAgICAgIHJpLmNyb3NzKHQsIHJpeHQpOwogICAgICByai5jcm9zcyh0LCByanh0KTsgLy8gRyA9IFstdCAtcml4dCB0IHJqeHRdCiAgICAgIC8vIEFuZCByZW1lbWJlciwgdGhpcyBpcyBhIHB1cmUgdmVsb2NpdHkgY29uc3RyYWludCwgZyBpcyBhbHdheXMgemVybyEKCiAgICAgIGNvbnN0IEdBID0gdGhpcy5qYWNvYmlhbkVsZW1lbnRBOwogICAgICBjb25zdCBHQiA9IHRoaXMuamFjb2JpYW5FbGVtZW50QjsKICAgICAgdC5uZWdhdGUoR0Euc3BhdGlhbCk7CiAgICAgIHJpeHQubmVnYXRlKEdBLnJvdGF0aW9uYWwpOwogICAgICBHQi5zcGF0aWFsLmNvcHkodCk7CiAgICAgIEdCLnJvdGF0aW9uYWwuY29weShyanh0KTsKICAgICAgY29uc3QgR1cgPSB0aGlzLmNvbXB1dGVHVygpOwogICAgICBjb25zdCBHaU1mID0gdGhpcy5jb21wdXRlR2lNZigpOwogICAgICBjb25zdCBCID0gLUdXICogYiAtIGggKiBHaU1mOwogICAgICByZXR1cm4gQjsKICAgIH0KCiAgfQoKICBjb25zdCBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAxID0gbmV3IFZlYzMoKTsKICBjb25zdCBGcmljdGlvbkVxdWF0aW9uX2NvbXB1dGVCX3RlbXAyID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBEZWZpbmVzIHdoYXQgaGFwcGVucyB3aGVuIHR3byBtYXRlcmlhbHMgbWVldC4KICAgKiBAdG9kbyBSZWZhY3RvciBtYXRlcmlhbHMgdG8gbWF0ZXJpYWxBIGFuZCBtYXRlcmlhbEIKICAgKi8KCiAgY2xhc3MgQ29udGFjdE1hdGVyaWFsIHsKICAgIC8qKgogICAgICogSWRlbnRpZmllciBvZiB0aGlzIG1hdGVyaWFsLgogICAgICovCgogICAgLyoqCiAgICAgKiBQYXJ0aWNpcGF0aW5nIG1hdGVyaWFscy4KICAgICAqLwoKICAgIC8qKgogICAgICogRnJpY3Rpb24gY29lZmZpY2llbnQuCiAgICAgKiBAZGVmYXVsdCAwLjMKICAgICAqLwoKICAgIC8qKgogICAgICogUmVzdGl0dXRpb24gY29lZmZpY2llbnQuCiAgICAgKiBAZGVmYXVsdCAwLjMKICAgICAqLwoKICAgIC8qKgogICAgICogU3RpZmZuZXNzIG9mIHRoZSBwcm9kdWNlZCBjb250YWN0IGVxdWF0aW9ucy4KICAgICAqIEBkZWZhdWx0IDFlNwogICAgICovCgogICAgLyoqCiAgICAgKiBSZWxheGF0aW9uIHRpbWUgb2YgdGhlIHByb2R1Y2VkIGNvbnRhY3QgZXF1YXRpb25zLgogICAgICogQGRlZmF1bHQgMwogICAgICovCgogICAgLyoqCiAgICAgKiBTdGlmZm5lc3Mgb2YgdGhlIHByb2R1Y2VkIGZyaWN0aW9uIGVxdWF0aW9ucy4KICAgICAqIEBkZWZhdWx0IDFlNwogICAgICovCgogICAgLyoqCiAgICAgKiBSZWxheGF0aW9uIHRpbWUgb2YgdGhlIHByb2R1Y2VkIGZyaWN0aW9uIGVxdWF0aW9ucwogICAgICogQGRlZmF1bHQgMwogICAgICovCiAgICBjb25zdHJ1Y3RvcihtMSwgbTIsIG9wdGlvbnMpIHsKICAgICAgdGhpcy5pZCA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJpY3Rpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMucmVzdGl0dXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzID0gdm9pZCAwOwogICAgICB0aGlzLmNvbnRhY3RFcXVhdGlvblJlbGF4YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcyA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiA9IHZvaWQgMDsKICAgICAgb3B0aW9ucyA9IFV0aWxzLmRlZmF1bHRzKG9wdGlvbnMsIHsKICAgICAgICBmcmljdGlvbjogMC4zLAogICAgICAgIHJlc3RpdHV0aW9uOiAwLjMsCiAgICAgICAgY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzOiAxZTcsCiAgICAgICAgY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbjogMywKICAgICAgICBmcmljdGlvbkVxdWF0aW9uU3RpZmZuZXNzOiAxZTcsCiAgICAgICAgZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb246IDMKICAgICAgfSk7CiAgICAgIHRoaXMuaWQgPSBDb250YWN0TWF0ZXJpYWwuaWRDb3VudGVyKys7CiAgICAgIHRoaXMubWF0ZXJpYWxzID0gW20xLCBtMl07CiAgICAgIHRoaXMuZnJpY3Rpb24gPSBvcHRpb25zLmZyaWN0aW9uOwogICAgICB0aGlzLnJlc3RpdHV0aW9uID0gb3B0aW9ucy5yZXN0aXR1dGlvbjsKICAgICAgdGhpcy5jb250YWN0RXF1YXRpb25TdGlmZm5lc3MgPSBvcHRpb25zLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzczsKICAgICAgdGhpcy5jb250YWN0RXF1YXRpb25SZWxheGF0aW9uID0gb3B0aW9ucy5jb250YWN0RXF1YXRpb25SZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3MgPSBvcHRpb25zLmZyaWN0aW9uRXF1YXRpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24gPSBvcHRpb25zLmZyaWN0aW9uRXF1YXRpb25SZWxheGF0aW9uOwogICAgfQoKICB9CgogIENvbnRhY3RNYXRlcmlhbC5pZENvdW50ZXIgPSAwOwogIC8qKgogICAqIERlZmluZXMgYSBwaHlzaWNzIG1hdGVyaWFsLgogICAqLwoKICBjbGFzcyBNYXRlcmlhbCB7CiAgICAvKioKICAgICAqIE1hdGVyaWFsIG5hbWUuCiAgICAgKiBJZiBvcHRpb25zIGlzIGEgc3RyaW5nLCBuYW1lIHdpbGwgYmUgc2V0IHRvIHRoYXQgc3RyaW5nLgogICAgICogQHRvZG8gRGVwcmVjYXRlIHRoaXMKICAgICAqLwoKICAgIC8qKiBNYXRlcmlhbCBpZC4gKi8KCiAgICAvKioKICAgICAqIEZyaWN0aW9uIGZvciB0aGlzIG1hdGVyaWFsLgogICAgICogSWYgbm9uLW5lZ2F0aXZlLCBpdCB3aWxsIGJlIHVzZWQgaW5zdGVhZCBvZiB0aGUgZnJpY3Rpb24gZ2l2ZW4gYnkgQ29udGFjdE1hdGVyaWFscy4gSWYgdGhlcmUncyBubyBtYXRjaGluZyBDb250YWN0TWF0ZXJpYWwsIHRoZSB2YWx1ZSBmcm9tIGBkZWZhdWx0Q29udGFjdE1hdGVyaWFsYCBpbiB0aGUgV29ybGQgd2lsbCBiZSB1c2VkLgogICAgICovCgogICAgLyoqCiAgICAgKiBSZXN0aXR1dGlvbiBmb3IgdGhpcyBtYXRlcmlhbC4KICAgICAqIElmIG5vbi1uZWdhdGl2ZSwgaXQgd2lsbCBiZSB1c2VkIGluc3RlYWQgb2YgdGhlIHJlc3RpdHV0aW9uIGdpdmVuIGJ5IENvbnRhY3RNYXRlcmlhbHMuIElmIHRoZXJlJ3Mgbm8gbWF0Y2hpbmcgQ29udGFjdE1hdGVyaWFsLCB0aGUgdmFsdWUgZnJvbSBgZGVmYXVsdENvbnRhY3RNYXRlcmlhbGAgaW4gdGhlIFdvcmxkIHdpbGwgYmUgdXNlZC4KICAgICAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7CiAgICAgIHRoaXMubmFtZSA9IHZvaWQgMDsKICAgICAgdGhpcy5pZCA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHZvaWQgMDsKICAgICAgbGV0IG5hbWUgPSAnJzsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4CgogICAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgLy9jb25zb2xlLndhcm4oYFBhc3NpbmcgYSBzdHJpbmcgdG8gTWF0ZXJpYWxPcHRpb25zIGlzIGRlcHJlY2F0ZWQsIGFuZCBoYXMgbm8gZWZmZWN0YCkKICAgICAgICBuYW1lID0gb3B0aW9uczsKICAgICAgICBvcHRpb25zID0ge307CiAgICAgIH0KCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMuaWQgPSBNYXRlcmlhbC5pZENvdW50ZXIrKzsKICAgICAgdGhpcy5mcmljdGlvbiA9IHR5cGVvZiBvcHRpb25zLmZyaWN0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuZnJpY3Rpb24gOiAtMTsKICAgICAgdGhpcy5yZXN0aXR1dGlvbiA9IHR5cGVvZiBvcHRpb25zLnJlc3RpdHV0aW9uICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMucmVzdGl0dXRpb24gOiAtMTsKICAgIH0KCiAgfQoKICBNYXRlcmlhbC5pZENvdW50ZXIgPSAwOwogIC8qKgogICAqIEEgc3ByaW5nLCBjb25uZWN0aW5nIHR3byBib2RpZXMuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3Qgc3ByaW5nID0gbmV3IFNwcmluZyhib3hCb2R5LCBzcGhlcmVCb2R5LCB7CiAgICogICAgICAgcmVzdExlbmd0aDogMCwKICAgKiAgICAgICBzdGlmZm5lc3M6IDUwLAogICAqICAgICAgIGRhbXBpbmc6IDEsCiAgICogICAgIH0pCiAgICoKICAgKiAgICAgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCiAgICogICAgIHdvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgKGV2ZW50KSA9PiB7CiAgICogICAgICAgc3ByaW5nLmFwcGx5Rm9yY2UoKQogICAqICAgICB9KQogICAqLwoKICBjbGFzcyBTcHJpbmcgewogICAgLyoqCiAgICAgKiBSZXN0IGxlbmd0aCBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+IDAuCiAgICAgKiBAZGVmYXVsdCAxCiAgICAgKi8KCiAgICAvKioKICAgICAqIFN0aWZmbmVzcyBvZiB0aGUgc3ByaW5nLiBBIG51bWJlciA+PSAwLgogICAgICogQGRlZmF1bHQgMTAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIERhbXBpbmcgb2YgdGhlIHNwcmluZy4gQSBudW1iZXIgPj0gMC4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogRmlyc3QgY29ubmVjdGVkIGJvZHkuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNlY29uZCBjb25uZWN0ZWQgYm9keS4KICAgICAqLwoKICAgIC8qKgogICAgICogQW5jaG9yIGZvciBib2R5QSBpbiBsb2NhbCBib2R5QSBjb29yZGluYXRlcy4KICAgICAqIFdoZXJlIHRvIGhvb2sgdGhlIHNwcmluZyB0byBib2R5IEEsIGluIGxvY2FsIGJvZHkgY29vcmRpbmF0ZXMuCiAgICAgKiBAZGVmYXVsdCBuZXcgVmVjMygpCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFuY2hvciBmb3IgYm9keUIgaW4gbG9jYWwgYm9keUIgY29vcmRpbmF0ZXMuCiAgICAgKiBXaGVyZSB0byBob29rIHRoZSBzcHJpbmcgdG8gYm9keSBCLCBpbiBsb2NhbCBib2R5IGNvb3JkaW5hdGVzLgogICAgICogQGRlZmF1bHQgbmV3IFZlYzMoKQogICAgICovCiAgICBjb25zdHJ1Y3Rvcihib2R5QSwgYm9keUIsIG9wdGlvbnMgPSB7fSkgewogICAgICB0aGlzLnJlc3RMZW5ndGggPSB2b2lkIDA7CiAgICAgIHRoaXMuc3RpZmZuZXNzID0gdm9pZCAwOwogICAgICB0aGlzLmRhbXBpbmcgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9keUEgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9keUIgPSB2b2lkIDA7CiAgICAgIHRoaXMubG9jYWxBbmNob3JBID0gdm9pZCAwOwogICAgICB0aGlzLmxvY2FsQW5jaG9yQiA9IHZvaWQgMDsKICAgICAgdGhpcy5yZXN0TGVuZ3RoID0gdHlwZW9mIG9wdGlvbnMucmVzdExlbmd0aCA9PT0gJ251bWJlcicgPyBvcHRpb25zLnJlc3RMZW5ndGggOiAxOwogICAgICB0aGlzLnN0aWZmbmVzcyA9IG9wdGlvbnMuc3RpZmZuZXNzIHx8IDEwMDsKICAgICAgdGhpcy5kYW1waW5nID0gb3B0aW9ucy5kYW1waW5nIHx8IDE7CiAgICAgIHRoaXMuYm9keUEgPSBib2R5QTsKICAgICAgdGhpcy5ib2R5QiA9IGJvZHlCOwogICAgICB0aGlzLmxvY2FsQW5jaG9yQSA9IG5ldyBWZWMzKCk7CiAgICAgIHRoaXMubG9jYWxBbmNob3JCID0gbmV3IFZlYzMoKTsKCiAgICAgIGlmIChvcHRpb25zLmxvY2FsQW5jaG9yQSkgewogICAgICAgIHRoaXMubG9jYWxBbmNob3JBLmNvcHkob3B0aW9ucy5sb2NhbEFuY2hvckEpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5sb2NhbEFuY2hvckIpIHsKICAgICAgICB0aGlzLmxvY2FsQW5jaG9yQi5jb3B5KG9wdGlvbnMubG9jYWxBbmNob3JCKTsKICAgICAgfQoKICAgICAgaWYgKG9wdGlvbnMud29ybGRBbmNob3JBKSB7CiAgICAgICAgdGhpcy5zZXRXb3JsZEFuY2hvckEob3B0aW9ucy53b3JsZEFuY2hvckEpOwogICAgICB9CgogICAgICBpZiAob3B0aW9ucy53b3JsZEFuY2hvckIpIHsKICAgICAgICB0aGlzLnNldFdvcmxkQW5jaG9yQihvcHRpb25zLndvcmxkQW5jaG9yQik7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBhbmNob3IgcG9pbnQgb24gYm9keSBBLCB1c2luZyB3b3JsZCBjb29yZGluYXRlcy4KICAgICAqLwoKCiAgICBzZXRXb3JsZEFuY2hvckEod29ybGRBbmNob3JBKSB7CiAgICAgIHRoaXMuYm9keUEucG9pbnRUb0xvY2FsRnJhbWUod29ybGRBbmNob3JBLCB0aGlzLmxvY2FsQW5jaG9yQSk7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgYW5jaG9yIHBvaW50IG9uIGJvZHkgQiwgdXNpbmcgd29ybGQgY29vcmRpbmF0ZXMuCiAgICAgKi8KCgogICAgc2V0V29ybGRBbmNob3JCKHdvcmxkQW5jaG9yQikgewogICAgICB0aGlzLmJvZHlCLnBvaW50VG9Mb2NhbEZyYW1lKHdvcmxkQW5jaG9yQiwgdGhpcy5sb2NhbEFuY2hvckIpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEEsIGluIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgdmVjdG9yIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgZ2V0V29ybGRBbmNob3JBKHJlc3VsdCkgewogICAgICB0aGlzLmJvZHlBLnBvaW50VG9Xb3JsZEZyYW1lKHRoaXMubG9jYWxBbmNob3JBLCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGFuY2hvciBwb2ludCBvbiBib2R5IEIsIGluIHdvcmxkIGNvb3JkaW5hdGVzLgogICAgICogQHBhcmFtIHJlc3VsdCBUaGUgdmVjdG9yIHRvIHN0b3JlIHRoZSByZXN1bHQgaW4uCiAgICAgKi8KCgogICAgZ2V0V29ybGRBbmNob3JCKHJlc3VsdCkgewogICAgICB0aGlzLmJvZHlCLnBvaW50VG9Xb3JsZEZyYW1lKHRoaXMubG9jYWxBbmNob3JCLCByZXN1bHQpOwogICAgfQogICAgLyoqCiAgICAgKiBBcHBseSB0aGUgc3ByaW5nIGZvcmNlIHRvIHRoZSBjb25uZWN0ZWQgYm9kaWVzLgogICAgICovCgoKICAgIGFwcGx5Rm9yY2UoKSB7CiAgICAgIGNvbnN0IGsgPSB0aGlzLnN0aWZmbmVzczsKICAgICAgY29uc3QgZCA9IHRoaXMuZGFtcGluZzsKICAgICAgY29uc3QgbCA9IHRoaXMucmVzdExlbmd0aDsKICAgICAgY29uc3QgYm9keUEgPSB0aGlzLmJvZHlBOwogICAgICBjb25zdCBib2R5QiA9IHRoaXMuYm9keUI7CiAgICAgIGNvbnN0IHIgPSBhcHBseUZvcmNlX3I7CiAgICAgIGNvbnN0IHJfdW5pdCA9IGFwcGx5Rm9yY2Vfcl91bml0OwogICAgICBjb25zdCB1ID0gYXBwbHlGb3JjZV91OwogICAgICBjb25zdCBmID0gYXBwbHlGb3JjZV9mOwogICAgICBjb25zdCB0bXAgPSBhcHBseUZvcmNlX3RtcDsKICAgICAgY29uc3Qgd29ybGRBbmNob3JBID0gYXBwbHlGb3JjZV93b3JsZEFuY2hvckE7CiAgICAgIGNvbnN0IHdvcmxkQW5jaG9yQiA9IGFwcGx5Rm9yY2Vfd29ybGRBbmNob3JCOwogICAgICBjb25zdCByaSA9IGFwcGx5Rm9yY2Vfcmk7CiAgICAgIGNvbnN0IHJqID0gYXBwbHlGb3JjZV9yajsKICAgICAgY29uc3QgcmlfeF9mID0gYXBwbHlGb3JjZV9yaV94X2Y7CiAgICAgIGNvbnN0IHJqX3hfZiA9IGFwcGx5Rm9yY2VfcmpfeF9mOyAvLyBHZXQgd29ybGQgYW5jaG9ycwoKICAgICAgdGhpcy5nZXRXb3JsZEFuY2hvckEod29ybGRBbmNob3JBKTsKICAgICAgdGhpcy5nZXRXb3JsZEFuY2hvckIod29ybGRBbmNob3JCKTsgLy8gR2V0IG9mZnNldCBwb2ludHMKCiAgICAgIHdvcmxkQW5jaG9yQS52c3ViKGJvZHlBLnBvc2l0aW9uLCByaSk7CiAgICAgIHdvcmxkQW5jaG9yQi52c3ViKGJvZHlCLnBvc2l0aW9uLCByaik7IC8vIENvbXB1dGUgZGlzdGFuY2UgdmVjdG9yIGJldHdlZW4gd29ybGQgYW5jaG9yIHBvaW50cwoKICAgICAgd29ybGRBbmNob3JCLnZzdWIod29ybGRBbmNob3JBLCByKTsKICAgICAgY29uc3QgcmxlbiA9IHIubGVuZ3RoKCk7CiAgICAgIHJfdW5pdC5jb3B5KHIpOwogICAgICByX3VuaXQubm9ybWFsaXplKCk7IC8vIENvbXB1dGUgcmVsYXRpdmUgdmVsb2NpdHkgb2YgdGhlIGFuY2hvciBwb2ludHMsIHUKCiAgICAgIGJvZHlCLnZlbG9jaXR5LnZzdWIoYm9keUEudmVsb2NpdHksIHUpOyAvLyBBZGQgcm90YXRpb25hbCB2ZWxvY2l0eQoKICAgICAgYm9keUIuYW5ndWxhclZlbG9jaXR5LmNyb3NzKHJqLCB0bXApOwogICAgICB1LnZhZGQodG1wLCB1KTsKICAgICAgYm9keUEuYW5ndWxhclZlbG9jaXR5LmNyb3NzKHJpLCB0bXApOwogICAgICB1LnZzdWIodG1wLCB1KTsgLy8gRiA9IC0gayAqICggeCAtIEwgKSAtIEQgKiAoIHUgKQoKICAgICAgcl91bml0LnNjYWxlKC1rICogKHJsZW4gLSBsKSAtIGQgKiB1LmRvdChyX3VuaXQpLCBmKTsgLy8gQWRkIGZvcmNlcyB0byBib2RpZXMKCiAgICAgIGJvZHlBLmZvcmNlLnZzdWIoZiwgYm9keUEuZm9yY2UpOwogICAgICBib2R5Qi5mb3JjZS52YWRkKGYsIGJvZHlCLmZvcmNlKTsgLy8gQW5ndWxhciBmb3JjZQoKICAgICAgcmkuY3Jvc3MoZiwgcmlfeF9mKTsKICAgICAgcmouY3Jvc3MoZiwgcmpfeF9mKTsKICAgICAgYm9keUEudG9ycXVlLnZzdWIocmlfeF9mLCBib2R5QS50b3JxdWUpOwogICAgICBib2R5Qi50b3JxdWUudmFkZChyal94X2YsIGJvZHlCLnRvcnF1ZSk7CiAgICB9CgogIH0KCiAgY29uc3QgYXBwbHlGb3JjZV9yID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3JfdW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV91ID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX2YgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2Vfd29ybGRBbmNob3JBID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3dvcmxkQW5jaG9yQiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yaSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yaiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXBwbHlGb3JjZV9yaV94X2YgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFwcGx5Rm9yY2VfcmpfeF9mID0gbmV3IFZlYzMoKTsKICBjb25zdCBhcHBseUZvcmNlX3RtcCA9IG5ldyBWZWMzKCk7CiAgLyoqCiAgICogV2hlZWxJbmZvCiAgICovCgogIGNsYXNzIFdoZWVsSW5mbyB7CiAgICAvKioKICAgICAqIE1heCB0cmF2ZWwgZGlzdGFuY2Ugb2YgdGhlIHN1c3BlbnNpb24sIGluIG1ldGVycy4KICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogU3BlZWQgdG8gYXBwbHkgdG8gdGhlIHdoZWVsIHJvdGF0aW9uIHdoZW4gdGhlIHdoZWVsIGlzIHNsaWRpbmcuCiAgICAgKiBAZGVmYXVsdCAtMC4xCiAgICAgKi8KCiAgICAvKioKICAgICAqIElmIHRoZSBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkIHNob3VsZCBiZSB1c2VkLgogICAgICogQGRlZmF1bHQgZmFsc2UKICAgICAqLwoKICAgIC8qKgogICAgICogc2xpZGluZwogICAgICovCgogICAgLyoqCiAgICAgKiBDb25uZWN0aW9uIHBvaW50LCBkZWZpbmVkIGxvY2FsbHkgaW4gdGhlIGNoYXNzaXMgYm9keSBmcmFtZS4KICAgICAqLwoKICAgIC8qKgogICAgICogY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRpcmVjdGlvbkxvY2FsCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRpcmVjdGlvbldvcmxkCiAgICAgKi8KCiAgICAvKioKICAgICAqIGF4bGVMb2NhbAogICAgICovCgogICAgLyoqCiAgICAgKiBheGxlV29ybGQKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblJlc3RMZW5ndGgKICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbk1heExlbmd0aAogICAgICogQGRlZmF1bHQgMgogICAgICovCgogICAgLyoqCiAgICAgKiByYWRpdXMKICAgICAqIEBkZWZhdWx0IDEKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvblN0aWZmbmVzcwogICAgICogQGRlZmF1bHQgMTAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRhbXBpbmdDb21wcmVzc2lvbgogICAgICogQGRlZmF1bHQgMTAKICAgICAqLwoKICAgIC8qKgogICAgICogZGFtcGluZ1JlbGF4YXRpb24KICAgICAqIEBkZWZhdWx0IDEwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGZyaWN0aW9uU2xpcAogICAgICogQGRlZmF1bHQgMTAuNQogICAgICovCgogICAgLyoqIGZvcndhcmRBY2NlbGVyYXRpb24gKi8KCiAgICAvKiogc2lkZUFjY2VsZXJhdGlvbiAqLwoKICAgIC8qKgogICAgICogc3RlZXJpbmcKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogUm90YXRpb24gdmFsdWUsIGluIHJhZGlhbnMuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIGRlbHRhUm90YXRpb24KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogcm9sbEluZmx1ZW5jZQogICAgICogQGRlZmF1bHQgMC4wMQogICAgICovCgogICAgLyoqCiAgICAgKiBtYXhTdXNwZW5zaW9uRm9yY2UKICAgICAqLwoKICAgIC8qKgogICAgICogZW5naW5lRm9yY2UKICAgICAqLwoKICAgIC8qKgogICAgICogYnJha2UKICAgICAqLwoKICAgIC8qKgogICAgICogaXNGcm9udFdoZWVsCiAgICAgKiBAZGVmYXVsdCB0cnVlCiAgICAgKi8KCiAgICAvKioKICAgICAqIGNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbgogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBzdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eQogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBzdXNwZW5zaW9uRm9yY2UKICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc2xpcEluZm8KICAgICAqLwoKICAgIC8qKgogICAgICogc2tpZEluZm8KICAgICAqIEBkZWZhdWx0IDAKICAgICAqLwoKICAgIC8qKgogICAgICogc3VzcGVuc2lvbkxlbmd0aAogICAgICogQGRlZmF1bHQgMAogICAgICovCgogICAgLyoqCiAgICAgKiBzaWRlSW1wdWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBmb3J3YXJkSW1wdWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgcmVzdWx0IGZyb20gcmF5Y2FzdGluZy4KICAgICAqLwoKICAgIC8qKgogICAgICogV2hlZWwgd29ybGQgdHJhbnNmb3JtLgogICAgICovCgogICAgLyoqCiAgICAgKiBpc0luQ29udGFjdAogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgdGhpcy5tYXhTdXNwZW5zaW9uVHJhdmVsID0gdm9pZCAwOwogICAgICB0aGlzLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgPSB2b2lkIDA7CiAgICAgIHRoaXMudXNlQ3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IHZvaWQgMDsKICAgICAgdGhpcy5zbGlkaW5nID0gdm9pZCAwOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCA9IHZvaWQgMDsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSB2b2lkIDA7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gdm9pZCAwOwogICAgICB0aGlzLmF4bGVXb3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uUmVzdExlbmd0aCA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gdm9pZCAwOwogICAgICB0aGlzLnJhZGl1cyA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uU3RpZmZuZXNzID0gdm9pZCAwOwogICAgICB0aGlzLmRhbXBpbmdDb21wcmVzc2lvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5kYW1waW5nUmVsYXhhdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvblNsaXAgPSB2b2lkIDA7CiAgICAgIHRoaXMuZm9yd2FyZEFjY2VsZXJhdGlvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5zaWRlQWNjZWxlcmF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLnN0ZWVyaW5nID0gdm9pZCAwOwogICAgICB0aGlzLnJvdGF0aW9uID0gdm9pZCAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMucm9sbEluZmx1ZW5jZSA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXhTdXNwZW5zaW9uRm9yY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuYnJha2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuaXNGcm9udFdoZWVsID0gdm9pZCAwOwogICAgICB0aGlzLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHZvaWQgMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xpcEluZm8gPSB2b2lkIDA7CiAgICAgIHRoaXMuc2tpZEluZm8gPSB2b2lkIDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IHZvaWQgMDsKICAgICAgdGhpcy5zaWRlSW1wdWxzZSA9IHZvaWQgMDsKICAgICAgdGhpcy5mb3J3YXJkSW1wdWxzZSA9IHZvaWQgMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkVHJhbnNmb3JtID0gdm9pZCAwOwogICAgICB0aGlzLmlzSW5Db250YWN0ID0gdm9pZCAwOwogICAgICBvcHRpb25zID0gVXRpbHMuZGVmYXVsdHMob3B0aW9ucywgewogICAgICAgIGNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbDogbmV3IFZlYzMoKSwKICAgICAgICBjaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uTG9jYWw6IG5ldyBWZWMzKCksCiAgICAgICAgZGlyZWN0aW9uV29ybGQ6IG5ldyBWZWMzKCksCiAgICAgICAgYXhsZUxvY2FsOiBuZXcgVmVjMygpLAogICAgICAgIGF4bGVXb3JsZDogbmV3IFZlYzMoKSwKICAgICAgICBzdXNwZW5zaW9uUmVzdExlbmd0aDogMSwKICAgICAgICBzdXNwZW5zaW9uTWF4TGVuZ3RoOiAyLAogICAgICAgIHJhZGl1czogMSwKICAgICAgICBzdXNwZW5zaW9uU3RpZmZuZXNzOiAxMDAsCiAgICAgICAgZGFtcGluZ0NvbXByZXNzaW9uOiAxMCwKICAgICAgICBkYW1waW5nUmVsYXhhdGlvbjogMTAsCiAgICAgICAgZnJpY3Rpb25TbGlwOiAxMC41LAogICAgICAgIGZvcndhcmRBY2NlbGVyYXRpb246IDEsCiAgICAgICAgc2lkZUFjY2VsZXJhdGlvbjogMSwKICAgICAgICBzdGVlcmluZzogMCwKICAgICAgICByb3RhdGlvbjogMCwKICAgICAgICBkZWx0YVJvdGF0aW9uOiAwLAogICAgICAgIHJvbGxJbmZsdWVuY2U6IDAuMDEsCiAgICAgICAgbWF4U3VzcGVuc2lvbkZvcmNlOiBOdW1iZXIuTUFYX1ZBTFVFLAogICAgICAgIGlzRnJvbnRXaGVlbDogdHJ1ZSwKICAgICAgICBjbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb246IDEsCiAgICAgICAgc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHk6IDAsCiAgICAgICAgc3VzcGVuc2lvbkZvcmNlOiAwLAogICAgICAgIHNsaXBJbmZvOiAwLAogICAgICAgIHNraWRJbmZvOiAwLAogICAgICAgIHN1c3BlbnNpb25MZW5ndGg6IDAsCiAgICAgICAgbWF4U3VzcGVuc2lvblRyYXZlbDogMSwKICAgICAgICB1c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiBmYWxzZSwKICAgICAgICBjdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOiAtMC4xCiAgICAgIH0pOwogICAgICB0aGlzLm1heFN1c3BlbnNpb25UcmF2ZWwgPSBvcHRpb25zLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgIHRoaXMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZCA9IG9wdGlvbnMuY3VzdG9tU2xpZGluZ1JvdGF0aW9uYWxTcGVlZDsKICAgICAgdGhpcy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkID0gb3B0aW9ucy51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkOwogICAgICB0aGlzLnNsaWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwgPSBvcHRpb25zLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbC5jbG9uZSgpOwogICAgICB0aGlzLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZCA9IG9wdGlvbnMuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uTG9jYWwgPSBvcHRpb25zLmRpcmVjdGlvbkxvY2FsLmNsb25lKCk7CiAgICAgIHRoaXMuZGlyZWN0aW9uV29ybGQgPSBvcHRpb25zLmRpcmVjdGlvbldvcmxkLmNsb25lKCk7CiAgICAgIHRoaXMuYXhsZUxvY2FsID0gb3B0aW9ucy5heGxlTG9jYWwuY2xvbmUoKTsKICAgICAgdGhpcy5heGxlV29ybGQgPSBvcHRpb25zLmF4bGVXb3JsZC5jbG9uZSgpOwogICAgICB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgdGhpcy5zdXNwZW5zaW9uTWF4TGVuZ3RoID0gb3B0aW9ucy5zdXNwZW5zaW9uTWF4TGVuZ3RoOwogICAgICB0aGlzLnJhZGl1cyA9IG9wdGlvbnMucmFkaXVzOwogICAgICB0aGlzLnN1c3BlbnNpb25TdGlmZm5lc3MgPSBvcHRpb25zLnN1c3BlbnNpb25TdGlmZm5lc3M7CiAgICAgIHRoaXMuZGFtcGluZ0NvbXByZXNzaW9uID0gb3B0aW9ucy5kYW1waW5nQ29tcHJlc3Npb247CiAgICAgIHRoaXMuZGFtcGluZ1JlbGF4YXRpb24gPSBvcHRpb25zLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICB0aGlzLmZyaWN0aW9uU2xpcCA9IG9wdGlvbnMuZnJpY3Rpb25TbGlwOwogICAgICB0aGlzLmZvcndhcmRBY2NlbGVyYXRpb24gPSBvcHRpb25zLmZvcndhcmRBY2NlbGVyYXRpb247CiAgICAgIHRoaXMuc2lkZUFjY2VsZXJhdGlvbiA9IG9wdGlvbnMuc2lkZUFjY2VsZXJhdGlvbjsKICAgICAgdGhpcy5zdGVlcmluZyA9IDA7CiAgICAgIHRoaXMucm90YXRpb24gPSAwOwogICAgICB0aGlzLmRlbHRhUm90YXRpb24gPSAwOwogICAgICB0aGlzLnJvbGxJbmZsdWVuY2UgPSBvcHRpb25zLnJvbGxJbmZsdWVuY2U7CiAgICAgIHRoaXMubWF4U3VzcGVuc2lvbkZvcmNlID0gb3B0aW9ucy5tYXhTdXNwZW5zaW9uRm9yY2U7CiAgICAgIHRoaXMuZW5naW5lRm9yY2UgPSAwOwogICAgICB0aGlzLmJyYWtlID0gMDsKICAgICAgdGhpcy5pc0Zyb250V2hlZWwgPSBvcHRpb25zLmlzRnJvbnRXaGVlbDsKICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxOwogICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgdGhpcy5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICB0aGlzLnNsaXBJbmZvID0gMDsKICAgICAgdGhpcy5za2lkSW5mbyA9IDA7CiAgICAgIHRoaXMuc3VzcGVuc2lvbkxlbmd0aCA9IDA7CiAgICAgIHRoaXMuc2lkZUltcHVsc2UgPSAwOwogICAgICB0aGlzLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgdGhpcy5yYXljYXN0UmVzdWx0ID0gbmV3IFJheWNhc3RSZXN1bHQoKTsKICAgICAgdGhpcy53b3JsZFRyYW5zZm9ybSA9IG5ldyBUcmFuc2Zvcm0oKTsKICAgICAgdGhpcy5pc0luQ29udGFjdCA9IGZhbHNlOwogICAgfQoKICAgIHVwZGF0ZVdoZWVsKGNoYXNzaXMpIHsKICAgICAgY29uc3QgcmF5Y2FzdFJlc3VsdCA9IHRoaXMucmF5Y2FzdFJlc3VsdDsKCiAgICAgIGlmICh0aGlzLmlzSW5Db250YWN0KSB7CiAgICAgICAgY29uc3QgcHJvamVjdCA9IHJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHJheWNhc3RSZXN1bHQuZGlyZWN0aW9uV29ybGQpOwogICAgICAgIHJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXMucG9zaXRpb24sIHJlbHBvcyk7CiAgICAgICAgY2hhc3Npcy5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChyZWxwb3MsIGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKICAgICAgICBjb25zdCBwcm9qVmVsID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZC5kb3QoY2hhc3Npc192ZWxvY2l0eV9hdF9jb250YWN0UG9pbnQpOwoKICAgICAgICBpZiAocHJvamVjdCA+PSAtMC4xKSB7CiAgICAgICAgICB0aGlzLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjAgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gcHJvamVjdDsKICAgICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSBwcm9qVmVsICogaW52OwogICAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE5vdCBpbiBjb250YWN0IDogcG9zaXRpb24gd2hlZWwgaW4gYSBuaWNlIChyZXN0IGxlbmd0aCkgcG9zaXRpb24KICAgICAgICByYXljYXN0UmVzdWx0LnN1c3BlbnNpb25MZW5ndGggPSB0aGlzLnN1c3BlbnNpb25SZXN0TGVuZ3RoOwogICAgICAgIHRoaXMuc3VzcGVuc2lvblJlbGF0aXZlVmVsb2NpdHkgPSAwLjA7CiAgICAgICAgcmF5Y2FzdFJlc3VsdC5kaXJlY3Rpb25Xb3JsZC5zY2FsZSgtMSwgcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZCk7CiAgICAgICAgdGhpcy5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KICAgIH0KCiAgfQoKICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcmVscG9zID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBWZWhpY2xlIGhlbHBlciBjbGFzcyB0aGF0IGNhc3RzIHJheXMgZnJvbSB0aGUgd2hlZWwgcG9zaXRpb25zIHRvd2FyZHMgdGhlIGdyb3VuZCBhbmQgYXBwbGllcyBmb3JjZXMuCiAgICovCgogIGNsYXNzIFJheWNhc3RWZWhpY2xlIHsKICAgIC8qKiBUaGUgY2FyIGNoYXNzaXMgYm9keS4gKi8KCiAgICAvKiogVGhlIHdoZWVscy4gKi8KCiAgICAvKiogV2lsbCBiZSBzZXQgdG8gdHJ1ZSBpZiB0aGUgY2FyIGlzIHNsaWRpbmcuICovCgogICAgLyoqIEluZGV4IG9mIHRoZSByaWdodCBheGlzLiB4PTAsIHk9MSwgej0yICovCgogICAgLyoqIEluZGV4IG9mIHRoZSBmb3J3YXJkIGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogSW5kZXggb2YgdGhlIHVwIGF4aXMuIHg9MCwgeT0xLCB6PTIgKi8KCiAgICAvKiogVGhlIGNvbnN0cmFpbnRzLiAqLwoKICAgIC8qKiBPcHRpb25hbCBwcmUtc3RlcCBjYWxsYmFjay4gKi8KCiAgICAvKiogTnVtYmVyIG9mIHdoZWVscyBvbiB0aGUgZ3JvdW5kLiAqLwogICAgY29uc3RydWN0b3Iob3B0aW9ucykgewogICAgICB0aGlzLmNoYXNzaXNCb2R5ID0gdm9pZCAwOwogICAgICB0aGlzLndoZWVsSW5mb3MgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2xpZGluZyA9IHZvaWQgMDsKICAgICAgdGhpcy53b3JsZCA9IHZvaWQgMDsKICAgICAgdGhpcy5pbmRleFJpZ2h0QXhpcyA9IHZvaWQgMDsKICAgICAgdGhpcy5pbmRleEZvcndhcmRBeGlzID0gdm9pZCAwOwogICAgICB0aGlzLmluZGV4VXBBeGlzID0gdm9pZCAwOwogICAgICB0aGlzLmNvbnN0cmFpbnRzID0gdm9pZCAwOwogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9IHZvaWQgMDsKICAgICAgdGhpcy5jdXJyZW50VmVoaWNsZVNwZWVkS21Ib3VyID0gdm9pZCAwOwogICAgICB0aGlzLm51bVdoZWVsc09uR3JvdW5kID0gdm9pZCAwOwogICAgICB0aGlzLmNoYXNzaXNCb2R5ID0gb3B0aW9ucy5jaGFzc2lzQm9keTsKICAgICAgdGhpcy53aGVlbEluZm9zID0gW107CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwogICAgICB0aGlzLndvcmxkID0gbnVsbDsKICAgICAgdGhpcy5pbmRleFJpZ2h0QXhpcyA9IHR5cGVvZiBvcHRpb25zLmluZGV4UmlnaHRBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhSaWdodEF4aXMgOiAyOwogICAgICB0aGlzLmluZGV4Rm9yd2FyZEF4aXMgPSB0eXBlb2Ygb3B0aW9ucy5pbmRleEZvcndhcmRBeGlzICE9PSAndW5kZWZpbmVkJyA/IG9wdGlvbnMuaW5kZXhGb3J3YXJkQXhpcyA6IDA7CiAgICAgIHRoaXMuaW5kZXhVcEF4aXMgPSB0eXBlb2Ygb3B0aW9ucy5pbmRleFVwQXhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBvcHRpb25zLmluZGV4VXBBeGlzIDogMTsKICAgICAgdGhpcy5jb25zdHJhaW50cyA9IFtdOwoKICAgICAgdGhpcy5wcmVTdGVwQ2FsbGJhY2sgPSAoKSA9PiB7fTsKCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDA7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwogICAgfQogICAgLyoqCiAgICAgKiBBZGQgYSB3aGVlbC4gRm9yIGluZm9ybWF0aW9uIGFib3V0IHRoZSBvcHRpb25zLCBzZWUgYFdoZWVsSW5mb2AuCiAgICAgKi8KCgogICAgYWRkV2hlZWwob3B0aW9ucyA9IHt9KSB7CiAgICAgIGNvbnN0IGluZm8gPSBuZXcgV2hlZWxJbmZvKG9wdGlvbnMpOwogICAgICBjb25zdCBpbmRleCA9IHRoaXMud2hlZWxJbmZvcy5sZW5ndGg7CiAgICAgIHRoaXMud2hlZWxJbmZvcy5wdXNoKGluZm8pOwogICAgICByZXR1cm4gaW5kZXg7CiAgICB9CiAgICAvKioKICAgICAqIFNldCB0aGUgc3RlZXJpbmcgdmFsdWUgb2YgYSB3aGVlbC4KICAgICAqLwoKCiAgICBzZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KSB7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB3aGVlbC5zdGVlcmluZyA9IHZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIHdoZWVsIGZvcmNlIHRvIGFwcGx5IG9uIG9uZSBvZiB0aGUgd2hlZWxzIGVhY2ggdGltZSBzdGVwCiAgICAgKi8KCgogICAgYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uZW5naW5lRm9yY2UgPSB2YWx1ZTsKICAgIH0KICAgIC8qKgogICAgICogU2V0IHRoZSBicmFraW5nIGZvcmNlIG9mIGEgd2hlZWwKICAgICAqLwoKCiAgICBzZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCkgewogICAgICB0aGlzLndoZWVsSW5mb3Nbd2hlZWxJbmRleF0uYnJha2UgPSBicmFrZTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIHRoZSB2ZWhpY2xlIGluY2x1ZGluZyBpdHMgY29uc3RyYWludHMgdG8gdGhlIHdvcmxkLgogICAgICovCgoKICAgIGFkZFRvV29ybGQod29ybGQpIHsKICAgICAgd29ybGQuYWRkQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CgogICAgICB0aGlzLnByZVN0ZXBDYWxsYmFjayA9ICgpID0+IHsKICAgICAgICB0aGF0LnVwZGF0ZVZlaGljbGUod29ybGQuZHQpOwogICAgICB9OwoKICAgICAgd29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgb25lIG9mIHRoZSB3aGVlbCBheGxlcywgd29ybGQtb3JpZW50ZWQuCiAgICAgKi8KCgogICAgZ2V0VmVoaWNsZUF4aXNXb3JsZChheGlzSW5kZXgsIHJlc3VsdCkgewogICAgICByZXN1bHQuc2V0KGF4aXNJbmRleCA9PT0gMCA/IDEgOiAwLCBheGlzSW5kZXggPT09IDEgPyAxIDogMCwgYXhpc0luZGV4ID09PSAyID8gMSA6IDApOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnZlY3RvclRvV29ybGRGcmFtZShyZXN1bHQsIHJlc3VsdCk7CiAgICB9CgogICAgdXBkYXRlVmVoaWNsZSh0aW1lU3RlcCkgewogICAgICBjb25zdCB3aGVlbEluZm9zID0gdGhpcy53aGVlbEluZm9zOwogICAgICBjb25zdCBudW1XaGVlbHMgPSB3aGVlbEluZm9zLmxlbmd0aDsKICAgICAgY29uc3QgY2hhc3Npc0JvZHkgPSB0aGlzLmNoYXNzaXNCb2R5OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm0oaSk7CiAgICAgIH0KCiAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciA9IDMuNiAqIGNoYXNzaXNCb2R5LnZlbG9jaXR5Lmxlbmd0aCgpOwogICAgICBjb25zdCBmb3J3YXJkV29ybGQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLmdldFZlaGljbGVBeGlzV29ybGQodGhpcy5pbmRleEZvcndhcmRBeGlzLCBmb3J3YXJkV29ybGQpOwoKICAgICAgaWYgKGZvcndhcmRXb3JsZC5kb3QoY2hhc3Npc0JvZHkudmVsb2NpdHkpIDwgMCkgewogICAgICAgIHRoaXMuY3VycmVudFZlaGljbGVTcGVlZEttSG91ciAqPSAtMTsKICAgICAgfSAvLyBzaW11bGF0ZSBzdXNwZW5zaW9uCgoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIHRoaXMuY2FzdFJheSh3aGVlbEluZm9zW2ldKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVTdXNwZW5zaW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaW1wdWxzZSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgLy9hcHBseSBzdXNwZW5zaW9uIGZvcmNlCiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOwogICAgICAgIGxldCBzdXNwZW5zaW9uRm9yY2UgPSB3aGVlbC5zdXNwZW5zaW9uRm9yY2U7CgogICAgICAgIGlmIChzdXNwZW5zaW9uRm9yY2UgPiB3aGVlbC5tYXhTdXNwZW5zaW9uRm9yY2UpIHsKICAgICAgICAgIHN1c3BlbnNpb25Gb3JjZSA9IHdoZWVsLm1heFN1c3BlbnNpb25Gb3JjZTsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUoc3VzcGVuc2lvbkZvcmNlICogdGltZVN0ZXAsIGltcHVsc2UpOwogICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGNoYXNzaXNCb2R5LnBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNoYXNzaXNCb2R5LmFwcGx5SW1wdWxzZShpbXB1bHNlLCByZWxwb3MpOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZUZyaWN0aW9uKHRpbWVTdGVwKTsKICAgICAgY29uc3QgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGZ3ZCA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IHZlbCA9IG5ldyBWZWMzKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVdoZWVsczsgaSsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW2ldOyAvL2NvbnN0IHJlbHBvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgLy93aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQudnN1YihjaGFzc2lzQm9keS5wb3NpdGlvbiwgcmVscG9zKTsKCiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCB2ZWwpOyAvLyBIYWNrIHRvIGdldCB0aGUgcm90YXRpb24gaW4gdGhlIGNvcnJlY3QgZGlyZWN0aW9uCgogICAgICAgIGxldCBtID0gMTsKCiAgICAgICAgc3dpdGNoICh0aGlzLmluZGV4VXBBeGlzKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIG0gPSAtMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIHRoaXMuZ2V0VmVoaWNsZUF4aXNXb3JsZCh0aGlzLmluZGV4Rm9yd2FyZEF4aXMsIGZ3ZCk7CiAgICAgICAgICBjb25zdCBwcm9qID0gZndkLmRvdCh3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuc2NhbGUocHJvaiwgaGl0Tm9ybWFsV29ybGRTY2FsZWRXaXRoUHJvaik7CiAgICAgICAgICBmd2QudnN1YihoaXROb3JtYWxXb3JsZFNjYWxlZFdpdGhQcm9qLCBmd2QpOwogICAgICAgICAgY29uc3QgcHJvajIgPSBmd2QuZG90KHZlbCk7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gbSAqIHByb2oyICogdGltZVN0ZXAgLyB3aGVlbC5yYWRpdXM7CiAgICAgICAgfQoKICAgICAgICBpZiAoKHdoZWVsLnNsaWRpbmcgfHwgIXdoZWVsLmlzSW5Db250YWN0KSAmJiB3aGVlbC5lbmdpbmVGb3JjZSAhPT0gMCAmJiB3aGVlbC51c2VDdXN0b21TbGlkaW5nUm90YXRpb25hbFNwZWVkKSB7CiAgICAgICAgICAvLyBBcHBseSBjdXN0b20gcm90YXRpb24gd2hlbiBhY2NlbGVyYXRpbmcgYW5kIHNsaWRpbmcKICAgICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gPSAod2hlZWwuZW5naW5lRm9yY2UgPiAwID8gMSA6IC0xKSAqIHdoZWVsLmN1c3RvbVNsaWRpbmdSb3RhdGlvbmFsU3BlZWQgKiB0aW1lU3RlcDsKICAgICAgICB9IC8vIExvY2sgd2hlZWxzCgoKICAgICAgICBpZiAoTWF0aC5hYnMod2hlZWwuYnJha2UpID4gTWF0aC5hYnMod2hlZWwuZW5naW5lRm9yY2UpKSB7CiAgICAgICAgICB3aGVlbC5kZWx0YVJvdGF0aW9uID0gMDsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnJvdGF0aW9uICs9IHdoZWVsLmRlbHRhUm90YXRpb247IC8vIFVzZSB0aGUgb2xkIHZhbHVlCgogICAgICAgIHdoZWVsLmRlbHRhUm90YXRpb24gKj0gMC45OTsgLy8gZGFtcGluZyBvZiByb3RhdGlvbiB3aGVuIG5vdCBpbiBjb250YWN0CiAgICAgIH0KICAgIH0KCiAgICB1cGRhdGVTdXNwZW5zaW9uKGRlbHRhVGltZSkgewogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGNoYXNzaXNNYXNzID0gY2hhc3Npc0JvZHkubWFzczsKICAgICAgY29uc3Qgd2hlZWxJbmZvcyA9IHRoaXMud2hlZWxJbmZvczsKICAgICAgY29uc3QgbnVtV2hlZWxzID0gd2hlZWxJbmZvcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCB3X2l0ID0gMDsgd19pdCA8IG51bVdoZWVsczsgd19pdCsrKSB7CiAgICAgICAgY29uc3Qgd2hlZWwgPSB3aGVlbEluZm9zW3dfaXRdOwoKICAgICAgICBpZiAod2hlZWwuaXNJbkNvbnRhY3QpIHsKICAgICAgICAgIGxldCBmb3JjZTsgLy8gU3ByaW5nCgogICAgICAgICAgY29uc3Qgc3VzcF9sZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aDsKICAgICAgICAgIGNvbnN0IGN1cnJlbnRfbGVuZ3RoID0gd2hlZWwuc3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICAgIGNvbnN0IGxlbmd0aF9kaWZmID0gc3VzcF9sZW5ndGggLSBjdXJyZW50X2xlbmd0aDsKICAgICAgICAgIGZvcmNlID0gd2hlZWwuc3VzcGVuc2lvblN0aWZmbmVzcyAqIGxlbmd0aF9kaWZmICogd2hlZWwuY2xpcHBlZEludkNvbnRhY3REb3RTdXNwZW5zaW9uOyAvLyBEYW1wZXIKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWRfcmVsX3ZlbCA9IHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5OwogICAgICAgICAgbGV0IHN1c3BfZGFtcGluZzsKCiAgICAgICAgICBpZiAocHJvamVjdGVkX3JlbF92ZWwgPCAwKSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdDb21wcmVzc2lvbjsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHN1c3BfZGFtcGluZyA9IHdoZWVsLmRhbXBpbmdSZWxheGF0aW9uOwogICAgICAgICAgfQoKICAgICAgICAgIGZvcmNlIC09IHN1c3BfZGFtcGluZyAqIHByb2plY3RlZF9yZWxfdmVsOwogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkZvcmNlID0gZm9yY2UgKiBjaGFzc2lzTWFzczsKCiAgICAgICAgICBpZiAod2hlZWwuc3VzcGVuc2lvbkZvcmNlIDwgMCkgewogICAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uRm9yY2UgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHZlaGljbGUgaW5jbHVkaW5nIGl0cyBjb25zdHJhaW50cyBmcm9tIHRoZSB3b3JsZC4KICAgICAqLwoKCiAgICByZW1vdmVGcm9tV29ybGQod29ybGQpIHsKICAgICAgdGhpcy5jb25zdHJhaW50czsKICAgICAgd29ybGQucmVtb3ZlQm9keSh0aGlzLmNoYXNzaXNCb2R5KTsKICAgICAgd29ybGQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJlU3RlcCcsIHRoaXMucHJlU3RlcENhbGxiYWNrKTsKICAgICAgdGhpcy53b3JsZCA9IG51bGw7CiAgICB9CgogICAgY2FzdFJheSh3aGVlbCkgewogICAgICBjb25zdCByYXl2ZWN0b3IgPSBjYXN0UmF5X3JheXZlY3RvcjsKICAgICAgY29uc3QgdGFyZ2V0ID0gY2FzdFJheV90YXJnZXQ7CiAgICAgIHRoaXMudXBkYXRlV2hlZWxUcmFuc2Zvcm1Xb3JsZCh3aGVlbCk7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgbGV0IGRlcHRoID0gLTE7CiAgICAgIGNvbnN0IHJheWxlbiA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwucmFkaXVzOwogICAgICB3aGVlbC5kaXJlY3Rpb25Xb3JsZC5zY2FsZShyYXlsZW4sIHJheXZlY3Rvcik7CiAgICAgIGNvbnN0IHNvdXJjZSA9IHdoZWVsLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRXb3JsZDsKICAgICAgc291cmNlLnZhZGQocmF5dmVjdG9yLCB0YXJnZXQpOwogICAgICBjb25zdCByYXljYXN0UmVzdWx0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdDsKICAgICAgcmF5Y2FzdFJlc3VsdC5yZXNldCgpOyAvLyBUdXJuIG9mZiByYXkgY29sbGlzaW9uIHdpdGggdGhlIGNoYXNzaXMgdGVtcG9yYXJpbHkKCiAgICAgIGNvbnN0IG9sZFN0YXRlID0gY2hhc3Npc0JvZHkuY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gZmFsc2U7IC8vIENhc3QgcmF5IGFnYWluc3Qgd29ybGQKCiAgICAgIHRoaXMud29ybGQucmF5VGVzdChzb3VyY2UsIHRhcmdldCwgcmF5Y2FzdFJlc3VsdCk7CiAgICAgIGNoYXNzaXNCb2R5LmNvbGxpc2lvblJlc3BvbnNlID0gb2xkU3RhdGU7CiAgICAgIGNvbnN0IG9iamVjdCA9IHJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5ncm91bmRPYmplY3QgPSAwOwoKICAgICAgaWYgKG9iamVjdCkgewogICAgICAgIGRlcHRoID0gcmF5Y2FzdFJlc3VsdC5kaXN0YW5jZTsKICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkID0gcmF5Y2FzdFJlc3VsdC5oaXROb3JtYWxXb3JsZDsKICAgICAgICB3aGVlbC5pc0luQ29udGFjdCA9IHRydWU7CiAgICAgICAgY29uc3QgaGl0RGlzdGFuY2UgPSByYXljYXN0UmVzdWx0LmRpc3RhbmNlOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSBoaXREaXN0YW5jZSAtIHdoZWVsLnJhZGl1czsgLy8gY2xhbXAgb24gbWF4IHN1c3BlbnNpb24gdHJhdmVsCgogICAgICAgIGNvbnN0IG1pblN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCAtIHdoZWVsLm1heFN1c3BlbnNpb25UcmF2ZWw7CiAgICAgICAgY29uc3QgbWF4U3VzcGVuc2lvbkxlbmd0aCA9IHdoZWVsLnN1c3BlbnNpb25SZXN0TGVuZ3RoICsgd2hlZWwubWF4U3VzcGVuc2lvblRyYXZlbDsKCiAgICAgICAgaWYgKHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPCBtaW5TdXNwZW5zaW9uTGVuZ3RoKSB7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID0gbWluU3VzcGVuc2lvbkxlbmd0aDsKICAgICAgICB9CgogICAgICAgIGlmICh3aGVlbC5zdXNwZW5zaW9uTGVuZ3RoID4gbWF4U3VzcGVuc2lvbkxlbmd0aCkgewogICAgICAgICAgd2hlZWwuc3VzcGVuc2lvbkxlbmd0aCA9IG1heFN1c3BlbnNpb25MZW5ndGg7CiAgICAgICAgICB3aGVlbC5yYXljYXN0UmVzdWx0LnJlc2V0KCk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBkZW5vbWluYXRvciA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgICBjb25zdCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCA9IG5ldyBWZWMzKCk7CiAgICAgICAgY2hhc3Npc0JvZHkuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBjaGFzc2lzX3ZlbG9jaXR5X2F0X2NvbnRhY3RQb2ludCk7CiAgICAgICAgY29uc3QgcHJvalZlbCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQuZG90KGNoYXNzaXNfdmVsb2NpdHlfYXRfY29udGFjdFBvaW50KTsKCiAgICAgICAgaWYgKGRlbm9taW5hdG9yID49IC0wLjEpIHsKICAgICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMDsKICAgICAgICAgIHdoZWVsLmNsaXBwZWRJbnZDb250YWN0RG90U3VzcGVuc2lvbiA9IDEgLyAwLjE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGludiA9IC0xIC8gZGVub21pbmF0b3I7CiAgICAgICAgICB3aGVlbC5zdXNwZW5zaW9uUmVsYXRpdmVWZWxvY2l0eSA9IHByb2pWZWwgKiBpbnY7CiAgICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSBpbnY7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vcHV0IHdoZWVsIGluZm8gYXMgaW4gcmVzdCBwb3NpdGlvbgogICAgICAgIHdoZWVsLnN1c3BlbnNpb25MZW5ndGggPSB3aGVlbC5zdXNwZW5zaW9uUmVzdExlbmd0aCArIDAgKiB3aGVlbC5tYXhTdXNwZW5zaW9uVHJhdmVsOwogICAgICAgIHdoZWVsLnN1c3BlbnNpb25SZWxhdGl2ZVZlbG9jaXR5ID0gMC4wOwogICAgICAgIHdoZWVsLmRpcmVjdGlvbldvcmxkLnNjYWxlKC0xLCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdE5vcm1hbFdvcmxkKTsKICAgICAgICB3aGVlbC5jbGlwcGVkSW52Q29udGFjdERvdFN1c3BlbnNpb24gPSAxLjA7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXB0aDsKICAgIH0KCiAgICB1cGRhdGVXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsKSB7CiAgICAgIHdoZWVsLmlzSW5Db250YWN0ID0gZmFsc2U7CiAgICAgIGNvbnN0IGNoYXNzaXNCb2R5ID0gdGhpcy5jaGFzc2lzQm9keTsKICAgICAgY2hhc3Npc0JvZHkucG9pbnRUb1dvcmxkRnJhbWUod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludExvY2FsLCB3aGVlbC5jaGFzc2lzQ29ubmVjdGlvblBvaW50V29ybGQpOwogICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUod2hlZWwuZGlyZWN0aW9uTG9jYWwsIHdoZWVsLmRpcmVjdGlvbldvcmxkKTsKICAgICAgY2hhc3Npc0JvZHkudmVjdG9yVG9Xb3JsZEZyYW1lKHdoZWVsLmF4bGVMb2NhbCwgd2hlZWwuYXhsZVdvcmxkKTsKICAgIH0KICAgIC8qKgogICAgICogVXBkYXRlIG9uZSBvZiB0aGUgd2hlZWwgdHJhbnNmb3JtLgogICAgICogTm90ZSB3aGVuIHJlbmRlcmluZyB3aGVlbHM6IGR1cmluZyBlYWNoIHN0ZXAsIHdoZWVsIHRyYW5zZm9ybXMgYXJlIHVwZGF0ZWQgQkVGT1JFIHRoZSBjaGFzc2lzOyBpZS4gdGhlaXIgcG9zaXRpb24gYmVjb21lcyBpbnZhbGlkIGFmdGVyIHRoZSBzdGVwLiBUaHVzIHdoZW4geW91IHJlbmRlciB3aGVlbHMsIHlvdSBtdXN0IHVwZGF0ZSB3aGVlbCB0cmFuc2Zvcm1zIGJlZm9yZSByZW5kZXJpbmcgdGhlbS4gU2VlIHJheWNhc3RWZWhpY2xlIGRlbW8gZm9yIGFuIGV4YW1wbGUuCiAgICAgKiBAcGFyYW0gd2hlZWxJbmRleCBUaGUgd2hlZWwgaW5kZXggdG8gdXBkYXRlLgogICAgICovCgoKICAgIHVwZGF0ZVdoZWVsVHJhbnNmb3JtKHdoZWVsSW5kZXgpIHsKICAgICAgY29uc3QgdXAgPSB0bXBWZWM0OwogICAgICBjb25zdCByaWdodCA9IHRtcFZlYzU7CiAgICAgIGNvbnN0IGZ3ZCA9IHRtcFZlYzY7CiAgICAgIGNvbnN0IHdoZWVsID0gdGhpcy53aGVlbEluZm9zW3doZWVsSW5kZXhdOwogICAgICB0aGlzLnVwZGF0ZVdoZWVsVHJhbnNmb3JtV29ybGQod2hlZWwpOwogICAgICB3aGVlbC5kaXJlY3Rpb25Mb2NhbC5zY2FsZSgtMSwgdXApOwogICAgICByaWdodC5jb3B5KHdoZWVsLmF4bGVMb2NhbCk7CiAgICAgIHVwLmNyb3NzKHJpZ2h0LCBmd2QpOwogICAgICBmd2Qubm9ybWFsaXplKCk7CiAgICAgIHJpZ2h0Lm5vcm1hbGl6ZSgpOyAvLyBSb3RhdGUgYXJvdW5kIHN0ZWVyaW5nIG92ZXIgdGhlIHdoZWVsQXhsZQoKICAgICAgY29uc3Qgc3RlZXJpbmcgPSB3aGVlbC5zdGVlcmluZzsKICAgICAgY29uc3Qgc3RlZXJpbmdPcm4gPSBuZXcgUXVhdGVybmlvbigpOwogICAgICBzdGVlcmluZ09ybi5zZXRGcm9tQXhpc0FuZ2xlKHVwLCBzdGVlcmluZyk7CiAgICAgIGNvbnN0IHJvdGF0aW5nT3JuID0gbmV3IFF1YXRlcm5pb24oKTsKICAgICAgcm90YXRpbmdPcm4uc2V0RnJvbUF4aXNBbmdsZShyaWdodCwgd2hlZWwucm90YXRpb24pOyAvLyBXb3JsZCByb3RhdGlvbiBvZiB0aGUgd2hlZWwKCiAgICAgIGNvbnN0IHEgPSB3aGVlbC53b3JsZFRyYW5zZm9ybS5xdWF0ZXJuaW9uOwogICAgICB0aGlzLmNoYXNzaXNCb2R5LnF1YXRlcm5pb24ubXVsdChzdGVlcmluZ09ybiwgcSk7CiAgICAgIHEubXVsdChyb3RhdGluZ09ybiwgcSk7CiAgICAgIHEubm9ybWFsaXplKCk7IC8vIHdvcmxkIHBvc2l0aW9uIG9mIHRoZSB3aGVlbAoKICAgICAgY29uc3QgcCA9IHdoZWVsLndvcmxkVHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICBwLmNvcHkod2hlZWwuZGlyZWN0aW9uV29ybGQpOwogICAgICBwLnNjYWxlKHdoZWVsLnN1c3BlbnNpb25MZW5ndGgsIHApOwogICAgICBwLnZhZGQod2hlZWwuY2hhc3Npc0Nvbm5lY3Rpb25Qb2ludFdvcmxkLCBwKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSB3b3JsZCB0cmFuc2Zvcm0gb2Ygb25lIG9mIHRoZSB3aGVlbHMKICAgICAqLwoKCiAgICBnZXRXaGVlbFRyYW5zZm9ybVdvcmxkKHdoZWVsSW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMud2hlZWxJbmZvc1t3aGVlbEluZGV4XS53b3JsZFRyYW5zZm9ybTsKICAgIH0KCiAgICB1cGRhdGVGcmljdGlvbih0aW1lU3RlcCkgewogICAgICBjb25zdCBzdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2ogPSB1cGRhdGVGcmljdGlvbl9zdXJmTm9ybWFsV1Nfc2NhbGVkX3Byb2o7IC8vY2FsY3VsYXRlIHRoZSBpbXB1bHNlLCBzbyB0aGF0IHRoZSB3aGVlbHMgZG9uJ3QgbW92ZSBzaWRld2FyZHMKCiAgICAgIGNvbnN0IHdoZWVsSW5mb3MgPSB0aGlzLndoZWVsSW5mb3M7CiAgICAgIGNvbnN0IG51bVdoZWVscyA9IHdoZWVsSW5mb3MubGVuZ3RoOwogICAgICBjb25zdCBjaGFzc2lzQm9keSA9IHRoaXMuY2hhc3Npc0JvZHk7CiAgICAgIGNvbnN0IGZvcndhcmRXUyA9IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUzsKICAgICAgY29uc3QgYXhsZSA9IHVwZGF0ZUZyaWN0aW9uX2F4bGU7CiAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQgPSAwOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHRoaXMubnVtV2hlZWxzT25Hcm91bmQrKzsKICAgICAgICB9CgogICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5mb3J3YXJkSW1wdWxzZSA9IDA7CgogICAgICAgIGlmICghZm9yd2FyZFdTW2ldKSB7CiAgICAgICAgICBmb3J3YXJkV1NbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFheGxlW2ldKSB7CiAgICAgICAgICBheGxlW2ldID0gbmV3IFZlYzMoKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgZ3JvdW5kT2JqZWN0ID0gd2hlZWwucmF5Y2FzdFJlc3VsdC5ib2R5OwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBheGxlaSA9IGF4bGVbaV07CiAgICAgICAgICBjb25zdCB3aGVlbFRyYW5zID0gdGhpcy5nZXRXaGVlbFRyYW5zZm9ybVdvcmxkKGkpOyAvLyBHZXQgd29ybGQgYXhsZQoKICAgICAgICAgIHdoZWVsVHJhbnMudmVjdG9yVG9Xb3JsZEZyYW1lKGRpcmVjdGlvbnNbdGhpcy5pbmRleFJpZ2h0QXhpc10sIGF4bGVpKTsKICAgICAgICAgIGNvbnN0IHN1cmZOb3JtYWxXUyA9IHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0Tm9ybWFsV29ybGQ7CiAgICAgICAgICBjb25zdCBwcm9qID0gYXhsZWkuZG90KHN1cmZOb3JtYWxXUyk7CiAgICAgICAgICBzdXJmTm9ybWFsV1Muc2NhbGUocHJvaiwgc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qKTsKICAgICAgICAgIGF4bGVpLnZzdWIoc3VyZk5vcm1hbFdTX3NjYWxlZF9wcm9qLCBheGxlaSk7CiAgICAgICAgICBheGxlaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHN1cmZOb3JtYWxXUy5jcm9zcyhheGxlaSwgZm9yd2FyZFdTW2ldKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5ub3JtYWxpemUoKTsKICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbChjaGFzc2lzQm9keSwgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLCBncm91bmRPYmplY3QsIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZCwgYXhsZWkpOwogICAgICAgICAgd2hlZWwuc2lkZUltcHVsc2UgKj0gc2lkZUZyaWN0aW9uU3RpZmZuZXNzMjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnN0IHNpZGVGYWN0b3IgPSAxOwogICAgICBjb25zdCBmd2RGYWN0b3IgPSAwLjU7CiAgICAgIHRoaXMuc2xpZGluZyA9IGZhbHNlOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1XaGVlbHM7IGkrKykgewogICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICBjb25zdCBncm91bmRPYmplY3QgPSB3aGVlbC5yYXljYXN0UmVzdWx0LmJvZHk7CiAgICAgICAgbGV0IHJvbGxpbmdGcmljdGlvbiA9IDA7CiAgICAgICAgd2hlZWwuc2xpcEluZm8gPSAxOwoKICAgICAgICBpZiAoZ3JvdW5kT2JqZWN0KSB7CiAgICAgICAgICBjb25zdCBkZWZhdWx0Um9sbGluZ0ZyaWN0aW9uSW1wdWxzZSA9IDA7CiAgICAgICAgICBjb25zdCBtYXhJbXB1bHNlID0gd2hlZWwuYnJha2UgPyB3aGVlbC5icmFrZSA6IGRlZmF1bHRSb2xsaW5nRnJpY3Rpb25JbXB1bHNlOyAvLyBidFdoZWVsQ29udGFjdFBvaW50IGNvbnRhY3RQdChjaGFzc2lzQm9keSxncm91bmRPYmplY3Qsd2hlZWxJbmZyYXljYXN0SW5mby5oaXRQb2ludFdvcmxkLGZvcndhcmRXU1t3aGVlbF0sbWF4SW1wdWxzZSk7CiAgICAgICAgICAvLyByb2xsaW5nRnJpY3Rpb24gPSBjYWxjUm9sbGluZ0ZyaWN0aW9uKGNvbnRhY3RQdCk7CgogICAgICAgICAgcm9sbGluZ0ZyaWN0aW9uID0gY2FsY1JvbGxpbmdGcmljdGlvbihjaGFzc2lzQm9keSwgZ3JvdW5kT2JqZWN0LCB3aGVlbC5yYXljYXN0UmVzdWx0LmhpdFBvaW50V29ybGQsIGZvcndhcmRXU1tpXSwgbWF4SW1wdWxzZSk7CiAgICAgICAgICByb2xsaW5nRnJpY3Rpb24gKz0gd2hlZWwuZW5naW5lRm9yY2UgKiB0aW1lU3RlcDsgLy8gcm9sbGluZ0ZyaWN0aW9uID0gMDsKCiAgICAgICAgICBjb25zdCBmYWN0b3IgPSBtYXhJbXB1bHNlIC8gcm9sbGluZ0ZyaWN0aW9uOwogICAgICAgICAgd2hlZWwuc2xpcEluZm8gKj0gZmFjdG9yOwogICAgICAgIH0gLy9zd2l0Y2ggYmV0d2VlbiBhY3RpdmUgcm9sbGluZyAodGhyb3R0bGUpLCBicmFraW5nIGFuZCBub24tYWN0aXZlIHJvbGxpbmcgZnJpY3Rpb24gKG50aHJvdHRsZS9icmVhaykKCgogICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlID0gMDsKICAgICAgICB3aGVlbC5za2lkSW5mbyA9IDE7CgogICAgICAgIGlmIChncm91bmRPYmplY3QpIHsKICAgICAgICAgIHdoZWVsLnNraWRJbmZvID0gMTsKICAgICAgICAgIGNvbnN0IG1heGltcCA9IHdoZWVsLnN1c3BlbnNpb25Gb3JjZSAqIHRpbWVTdGVwICogd2hlZWwuZnJpY3Rpb25TbGlwOwogICAgICAgICAgY29uc3QgbWF4aW1wU2lkZSA9IG1heGltcDsKICAgICAgICAgIGNvbnN0IG1heGltcFNxdWFyZWQgPSBtYXhpbXAgKiBtYXhpbXBTaWRlOwogICAgICAgICAgd2hlZWwuZm9yd2FyZEltcHVsc2UgPSByb2xsaW5nRnJpY3Rpb247IC8vd2hlZWxJbmZvLmVuZ2luZUZvcmNlKiB0aW1lU3RlcDsKCiAgICAgICAgICBjb25zdCB4ID0gd2hlZWwuZm9yd2FyZEltcHVsc2UgKiBmd2RGYWN0b3IgLyB3aGVlbC5mb3J3YXJkQWNjZWxlcmF0aW9uOwogICAgICAgICAgY29uc3QgeSA9IHdoZWVsLnNpZGVJbXB1bHNlICogc2lkZUZhY3RvciAvIHdoZWVsLnNpZGVBY2NlbGVyYXRpb247CiAgICAgICAgICBjb25zdCBpbXB1bHNlU3F1YXJlZCA9IHggKiB4ICsgeSAqIHk7CiAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKGltcHVsc2VTcXVhcmVkID4gbWF4aW1wU3F1YXJlZCkgewogICAgICAgICAgICB0aGlzLnNsaWRpbmcgPSB0cnVlOwogICAgICAgICAgICB3aGVlbC5zbGlkaW5nID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgZmFjdG9yID0gbWF4aW1wIC8gTWF0aC5zcXJ0KGltcHVsc2VTcXVhcmVkKTsKICAgICAgICAgICAgd2hlZWwuc2tpZEluZm8gKj0gZmFjdG9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKHRoaXMuc2xpZGluZykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHdoZWVsID0gd2hlZWxJbmZvc1tpXTsKCiAgICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgICAgaWYgKHdoZWVsLnNraWRJbmZvIDwgMSkgewogICAgICAgICAgICAgIHdoZWVsLmZvcndhcmRJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICAgIHdoZWVsLnNpZGVJbXB1bHNlICo9IHdoZWVsLnNraWRJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGFwcGx5IHRoZSBpbXB1bHNlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtV2hlZWxzOyBpKyspIHsKICAgICAgICBjb25zdCB3aGVlbCA9IHdoZWVsSW5mb3NbaV07CiAgICAgICAgY29uc3QgcmVsX3BvcyA9IG5ldyBWZWMzKCk7CiAgICAgICAgd2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkLnZzdWIoY2hhc3Npc0JvZHkucG9zaXRpb24sIHJlbF9wb3MpOyAvLyBjYW5ub25zIGFwcGx5aW1wdWxzZSBpcyB1c2luZyB3b3JsZCBjb29yZCBmb3IgdGhlIHBvc2l0aW9uCiAgICAgICAgLy9yZWxfcG9zLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgaWYgKHdoZWVsLmZvcndhcmRJbXB1bHNlICE9PSAwKSB7CiAgICAgICAgICBjb25zdCBpbXB1bHNlID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGZvcndhcmRXU1tpXS5zY2FsZSh3aGVlbC5mb3J3YXJkSW1wdWxzZSwgaW1wdWxzZSk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2UoaW1wdWxzZSwgcmVsX3Bvcyk7CiAgICAgICAgfQoKICAgICAgICBpZiAod2hlZWwuc2lkZUltcHVsc2UgIT09IDApIHsKICAgICAgICAgIGNvbnN0IGdyb3VuZE9iamVjdCA9IHdoZWVsLnJheWNhc3RSZXN1bHQuYm9keTsKICAgICAgICAgIGNvbnN0IHJlbF9wb3MyID0gbmV3IFZlYzMoKTsKICAgICAgICAgIHdoZWVsLnJheWNhc3RSZXN1bHQuaGl0UG9pbnRXb3JsZC52c3ViKGdyb3VuZE9iamVjdC5wb3NpdGlvbiwgcmVsX3BvczIpOyAvL3JlbF9wb3MyLmNvcHkod2hlZWwucmF5Y2FzdFJlc3VsdC5oaXRQb2ludFdvcmxkKTsKCiAgICAgICAgICBjb25zdCBzaWRlSW1wID0gbmV3IFZlYzMoKTsKICAgICAgICAgIGF4bGVbaV0uc2NhbGUod2hlZWwuc2lkZUltcHVsc2UsIHNpZGVJbXApOyAvLyBTY2FsZSB0aGUgcmVsYXRpdmUgcG9zaXRpb24gaW4gdGhlIHVwIGRpcmVjdGlvbiB3aXRoIHJvbGxJbmZsdWVuY2UuCiAgICAgICAgICAvLyBJZiByb2xsSW5mbHVlbmNlIGlzIDEsIHRoZSBpbXB1bHNlIHdpbGwgYmUgYXBwbGllZCBvbiB0aGUgaGl0UG9pbnQgKGVhc3kgdG8gcm9sbCBvdmVyKSwgaWYgaXQgaXMgemVybyBpdCB3aWxsIGJlIGFwcGxpZWQgaW4gdGhlIHNhbWUgcGxhbmUgYXMgdGhlIGNlbnRlciBvZiBtYXNzIChub3QgZWFzeSB0byByb2xsIG92ZXIpLgoKICAgICAgICAgIGNoYXNzaXNCb2R5LnZlY3RvclRvTG9jYWxGcmFtZShyZWxfcG9zLCByZWxfcG9zKTsKICAgICAgICAgIHJlbF9wb3NbJ3h5eidbdGhpcy5pbmRleFVwQXhpc11dICo9IHdoZWVsLnJvbGxJbmZsdWVuY2U7CiAgICAgICAgICBjaGFzc2lzQm9keS52ZWN0b3JUb1dvcmxkRnJhbWUocmVsX3BvcywgcmVsX3Bvcyk7CiAgICAgICAgICBjaGFzc2lzQm9keS5hcHBseUltcHVsc2Uoc2lkZUltcCwgcmVsX3Bvcyk7IC8vYXBwbHkgZnJpY3Rpb24gaW1wdWxzZSBvbiB0aGUgZ3JvdW5kCgogICAgICAgICAgc2lkZUltcC5zY2FsZSgtMSwgc2lkZUltcCk7CiAgICAgICAgICBncm91bmRPYmplY3QuYXBwbHlJbXB1bHNlKHNpZGVJbXAsIHJlbF9wb3MyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgfQoKICBjb25zdCB0bXBWZWM0ID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWM1ID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBWZWM2ID0gbmV3IFZlYzMoKTsKICBuZXcgUmF5KCk7CiAgY29uc3QgY2FzdFJheV9yYXl2ZWN0b3IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhc3RSYXlfdGFyZ2V0ID0gbmV3IFZlYzMoKTsKICBjb25zdCBkaXJlY3Rpb25zID0gW25ldyBWZWMzKDEsIDAsIDApLCBuZXcgVmVjMygwLCAxLCAwKSwgbmV3IFZlYzMoMCwgMCwgMSldOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX3N1cmZOb3JtYWxXU19zY2FsZWRfcHJvaiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdXBkYXRlRnJpY3Rpb25fYXhsZSA9IFtdOwogIGNvbnN0IHVwZGF0ZUZyaWN0aW9uX2ZvcndhcmRXUyA9IFtdOwogIGNvbnN0IHNpZGVGcmljdGlvblN0aWZmbmVzczIgPSAxOwogIGNvbnN0IGNhbGNSb2xsaW5nRnJpY3Rpb25fdmVsMSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwyID0gbmV3IFZlYzMoKTsKICBjb25zdCBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbCA9IG5ldyBWZWMzKCk7CgogIGZ1bmN0aW9uIGNhbGNSb2xsaW5nRnJpY3Rpb24oYm9keTAsIGJvZHkxLCBmcmljdGlvblBvc1dvcmxkLCBmcmljdGlvbkRpcmVjdGlvbldvcmxkLCBtYXhJbXB1bHNlKSB7CiAgICBsZXQgajEgPSAwOwogICAgY29uc3QgY29udGFjdFBvc1dvcmxkID0gZnJpY3Rpb25Qb3NXb3JsZDsgLy8gY29uc3QgcmVsX3BvczEgPSBuZXcgVmVjMygpOwogICAgLy8gY29uc3QgcmVsX3BvczIgPSBuZXcgVmVjMygpOwoKICAgIGNvbnN0IHZlbDEgPSBjYWxjUm9sbGluZ0ZyaWN0aW9uX3ZlbDE7CiAgICBjb25zdCB2ZWwyID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWwyOwogICAgY29uc3QgdmVsID0gY2FsY1JvbGxpbmdGcmljdGlvbl92ZWw7IC8vIGNvbnRhY3RQb3NXb3JsZC52c3ViKGJvZHkwLnBvc2l0aW9uLCByZWxfcG9zMSk7CiAgICAvLyBjb250YWN0UG9zV29ybGQudnN1Yihib2R5MS5wb3NpdGlvbiwgcmVsX3BvczIpOwoKICAgIGJvZHkwLmdldFZlbG9jaXR5QXRXb3JsZFBvaW50KGNvbnRhY3RQb3NXb3JsZCwgdmVsMSk7CiAgICBib2R5MS5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChjb250YWN0UG9zV29ybGQsIHZlbDIpOwogICAgdmVsMS52c3ViKHZlbDIsIHZlbCk7CiAgICBjb25zdCB2cmVsID0gZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZC5kb3QodmVsKTsKICAgIGNvbnN0IGRlbm9tMCA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3IoYm9keTAsIGZyaWN0aW9uUG9zV29ybGQsIGZyaWN0aW9uRGlyZWN0aW9uV29ybGQpOwogICAgY29uc3QgZGVub20xID0gY29tcHV0ZUltcHVsc2VEZW5vbWluYXRvcihib2R5MSwgZnJpY3Rpb25Qb3NXb3JsZCwgZnJpY3Rpb25EaXJlY3Rpb25Xb3JsZCk7CiAgICBjb25zdCByZWxheGF0aW9uID0gMTsKICAgIGNvbnN0IGphY0RpYWdBQkludiA9IHJlbGF4YXRpb24gLyAoZGVub20wICsgZGVub20xKTsgLy8gY2FsY3VsYXRlIGogdGhhdCBtb3ZlcyB1cyB0byB6ZXJvIHJlbGF0aXZlIHZlbG9jaXR5CgogICAgajEgPSAtdnJlbCAqIGphY0RpYWdBQkludjsKCiAgICBpZiAobWF4SW1wdWxzZSA8IGoxKSB7CiAgICAgIGoxID0gbWF4SW1wdWxzZTsKICAgIH0KCiAgICBpZiAoajEgPCAtbWF4SW1wdWxzZSkgewogICAgICBqMSA9IC1tYXhJbXB1bHNlOwogICAgfQoKICAgIHJldHVybiBqMTsKICB9CgogIGNvbnN0IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfcjAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfYzAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfdmVjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX20gPSBuZXcgVmVjMygpOwoKICBmdW5jdGlvbiBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yKGJvZHksIHBvcywgbm9ybWFsKSB7CiAgICBjb25zdCByMCA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfcjA7CiAgICBjb25zdCBjMCA9IGNvbXB1dGVJbXB1bHNlRGVub21pbmF0b3JfYzA7CiAgICBjb25zdCB2ZWMgPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX3ZlYzsKICAgIGNvbnN0IG0gPSBjb21wdXRlSW1wdWxzZURlbm9taW5hdG9yX207CiAgICBwb3MudnN1Yihib2R5LnBvc2l0aW9uLCByMCk7CiAgICByMC5jcm9zcyhub3JtYWwsIGMwKTsKICAgIGJvZHkuaW52SW5lcnRpYVdvcmxkLnZtdWx0KGMwLCBtKTsKICAgIG0uY3Jvc3MocjAsIHZlYyk7CiAgICByZXR1cm4gYm9keS5pbnZNYXNzICsgbm9ybWFsLmRvdCh2ZWMpOwogIH0KCiAgY29uc3QgcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwxID0gbmV3IFZlYzMoKTsKICBjb25zdCByZXNvbHZlU2luZ2xlQmlsYXRlcmFsX3ZlbDIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsID0gbmV3IFZlYzMoKTsgLy8gYmlsYXRlcmFsIGNvbnN0cmFpbnQgYmV0d2VlbiB0d28gZHluYW1pYyBvYmplY3RzCgogIGZ1bmN0aW9uIHJlc29sdmVTaW5nbGVCaWxhdGVyYWwoYm9keTEsIHBvczEsIGJvZHkyLCBwb3MyLCBub3JtYWwpIHsKICAgIGNvbnN0IG5vcm1hbExlblNxciA9IG5vcm1hbC5sZW5ndGhTcXVhcmVkKCk7CgogICAgaWYgKG5vcm1hbExlblNxciA+IDEuMSkgewogICAgICByZXR1cm4gMDsgLy8gbm8gaW1wdWxzZQogICAgfSAvLyBjb25zdCByZWxfcG9zMSA9IG5ldyBWZWMzKCk7CiAgICAvLyBjb25zdCByZWxfcG9zMiA9IG5ldyBWZWMzKCk7CiAgICAvLyBwb3MxLnZzdWIoYm9keTEucG9zaXRpb24sIHJlbF9wb3MxKTsKICAgIC8vIHBvczIudnN1Yihib2R5Mi5wb3NpdGlvbiwgcmVsX3BvczIpOwoKCiAgICBjb25zdCB2ZWwxID0gcmVzb2x2ZVNpbmdsZUJpbGF0ZXJhbF92ZWwxOwogICAgY29uc3QgdmVsMiA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsMjsKICAgIGNvbnN0IHZlbCA9IHJlc29sdmVTaW5nbGVCaWxhdGVyYWxfdmVsOwogICAgYm9keTEuZ2V0VmVsb2NpdHlBdFdvcmxkUG9pbnQocG9zMSwgdmVsMSk7CiAgICBib2R5Mi5nZXRWZWxvY2l0eUF0V29ybGRQb2ludChwb3MyLCB2ZWwyKTsKICAgIHZlbDEudnN1Yih2ZWwyLCB2ZWwpOwogICAgY29uc3QgcmVsX3ZlbCA9IG5vcm1hbC5kb3QodmVsKTsKICAgIGNvbnN0IGNvbnRhY3REYW1waW5nID0gMC4yOwogICAgY29uc3QgbWFzc1Rlcm0gPSAxIC8gKGJvZHkxLmludk1hc3MgKyBib2R5Mi5pbnZNYXNzKTsKICAgIGNvbnN0IGltcHVsc2UgPSAtY29udGFjdERhbXBpbmcgKiByZWxfdmVsICogbWFzc1Rlcm07CiAgICByZXR1cm4gaW1wdWxzZTsKICB9CiAgLyoqCiAgICogU3BoZXJpY2FsIHNoYXBlCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzID0gMQogICAqICAgICBjb25zdCBzcGhlcmVTaGFwZSA9IG5ldyBDQU5OT04uU3BoZXJlKHJhZGl1cykKICAgKiAgICAgY29uc3Qgc3BoZXJlQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBzcGhlcmVTaGFwZSB9KQogICAqICAgICB3b3JsZC5hZGRCb2R5KHNwaGVyZUJvZHkpCiAgICovCgoKICBjbGFzcyBTcGhlcmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKioKICAgICAqIFRoZSByYWRpdXMgb2YgdGhlIHNwaGVyZS4KICAgICAqLwoKICAgIC8qKgogICAgICoKICAgICAqIEBwYXJhbSByYWRpdXMgVGhlIHJhZGl1cyBvZiB0aGUgc3BoZXJlLCBhIG5vbi1uZWdhdGl2ZSBudW1iZXIuCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKHJhZGl1cykgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuU1BIRVJFCiAgICAgIH0pOwogICAgICB0aGlzLnJhZGl1cyA9IHZvaWQgMDsKICAgICAgdGhpcy5yYWRpdXMgPSByYWRpdXMgIT09IHVuZGVmaW5lZCA/IHJhZGl1cyA6IDEuMDsKCiAgICAgIGlmICh0aGlzLnJhZGl1cyA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBzcGhlcmUgcmFkaXVzIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYSAqLwoKCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICBjb25zdCBJID0gMi4wICogbWFzcyAqIHRoaXMucmFkaXVzICogdGhpcy5yYWRpdXMgLyA1LjA7CiAgICAgIHRhcmdldC54ID0gSTsKICAgICAgdGFyZ2V0LnkgPSBJOwogICAgICB0YXJnZXQueiA9IEk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CiAgICAvKiogdm9sdW1lICovCgoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuIDQuMCAqIE1hdGguUEkgKiBNYXRoLnBvdyh0aGlzLnJhZGl1cywgMykgLyAzLjA7CiAgICB9CgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB0aGlzLnJhZGl1czsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICBjb25zdCByID0gdGhpcy5yYWRpdXM7CiAgICAgIGNvbnN0IGF4ZXMgPSBbJ3gnLCAneScsICd6J107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF4ZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBheCA9IGF4ZXNbaV07CiAgICAgICAgbWluW2F4XSA9IHBvc1theF0gLSByOwogICAgICAgIG1heFtheF0gPSBwb3NbYXhdICsgcjsKICAgICAgfQogICAgfQoKICB9CgogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKCiAgbmV3IFZlYzMoKTsgLy8gVGVtcCB2ZWN0b3JzIGZvciBjYWxjdWxhdGlvbgoKICBuZXcgVmVjMygpOyAvLyBSZWxhdGl2ZSB2ZWxvY2l0eQoKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgbmV3IFZlYzMoKTsKICBuZXcgVmVjMygpOwogIG5ldyBWZWMzKCk7CiAgLyoqCiAgICogQ3lsaW5kZXIgY2xhc3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcmFkaXVzVG9wID0gMC41CiAgICogICAgIGNvbnN0IHJhZGl1c0JvdHRvbSA9IDAuNQogICAqICAgICBjb25zdCBoZWlnaHQgPSAyCiAgICogICAgIGNvbnN0IG51bVNlZ21lbnRzID0gMTIKICAgKiAgICAgY29uc3QgY3lsaW5kZXJTaGFwZSA9IG5ldyBDQU5OT04uQ3lsaW5kZXIocmFkaXVzVG9wLCByYWRpdXNCb3R0b20sIGhlaWdodCwgbnVtU2VnbWVudHMpCiAgICogICAgIGNvbnN0IGN5bGluZGVyQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IG1hc3M6IDEsIHNoYXBlOiBjeWxpbmRlclNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoY3lsaW5kZXJCb2R5KQogICAqLwoKICBjbGFzcyBDeWxpbmRlciBleHRlbmRzIENvbnZleFBvbHloZWRyb24gewogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuICovCgogICAgLyoqIFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLiAqLwoKICAgIC8qKiBUaGUgbnVtYmVyIG9mIHNlZ21lbnRzIHRvIGJ1aWxkIHRoZSBjeWxpbmRlciBvdXQgb2YuICovCgogICAgLyoqCiAgICAgKiBAcGFyYW0gcmFkaXVzVG9wIFRoZSByYWRpdXMgb2YgdGhlIHRvcCBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gcmFkaXVzQm90dG9tIFRoZSByYWRpdXMgb2YgdGhlIGJvdHRvbSBvZiB0aGUgQ3lsaW5kZXIuCiAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIEN5bGluZGVyLgogICAgICogQHBhcmFtIG51bVNlZ21lbnRzIFRoZSBudW1iZXIgb2Ygc2VnbWVudHMgdG8gYnVpbGQgdGhlIGN5bGluZGVyIG91dCBvZi4KICAgICAqLwogICAgY29uc3RydWN0b3IocmFkaXVzVG9wID0gMSwgcmFkaXVzQm90dG9tID0gMSwgaGVpZ2h0ID0gMSwgbnVtU2VnbWVudHMgPSA4KSB7CiAgICAgIGlmIChyYWRpdXNUb3AgPCAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY3lsaW5kZXIgcmFkaXVzVG9wIGNhbm5vdCBiZSBuZWdhdGl2ZS4nKTsKICAgICAgfQoKICAgICAgaWYgKHJhZGl1c0JvdHRvbSA8IDApIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjeWxpbmRlciByYWRpdXNCb3R0b20gY2Fubm90IGJlIG5lZ2F0aXZlLicpOwogICAgICB9CgogICAgICBjb25zdCBOID0gbnVtU2VnbWVudHM7CiAgICAgIGNvbnN0IHZlcnRpY2VzID0gW107CiAgICAgIGNvbnN0IGF4ZXMgPSBbXTsKICAgICAgY29uc3QgZmFjZXMgPSBbXTsKICAgICAgY29uc3QgYm90dG9tZmFjZSA9IFtdOwogICAgICBjb25zdCB0b3BmYWNlID0gW107CiAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zOwogICAgICBjb25zdCBzaW4gPSBNYXRoLnNpbjsgLy8gRmlyc3QgYm90dG9tIHBvaW50CgogICAgICB2ZXJ0aWNlcy5wdXNoKG5ldyBWZWMzKC1yYWRpdXNCb3R0b20gKiBzaW4oMCksIC1oZWlnaHQgKiAwLjUsIHJhZGl1c0JvdHRvbSAqIGNvcygwKSkpOwogICAgICBib3R0b21mYWNlLnB1c2goMCk7IC8vIEZpcnN0IHRvcCBwb2ludAoKICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzVG9wICogc2luKDApLCBoZWlnaHQgKiAwLjUsIHJhZGl1c1RvcCAqIGNvcygwKSkpOwogICAgICB0b3BmYWNlLnB1c2goMSk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykgewogICAgICAgIGNvbnN0IHRoZXRhID0gMiAqIE1hdGguUEkgLyBOICogKGkgKyAxKTsKICAgICAgICBjb25zdCB0aGV0YU4gPSAyICogTWF0aC5QSSAvIE4gKiAoaSArIDAuNSk7CgogICAgICAgIGlmIChpIDwgTiAtIDEpIHsKICAgICAgICAgIC8vIEJvdHRvbQogICAgICAgICAgdmVydGljZXMucHVzaChuZXcgVmVjMygtcmFkaXVzQm90dG9tICogc2luKHRoZXRhKSwgLWhlaWdodCAqIDAuNSwgcmFkaXVzQm90dG9tICogY29zKHRoZXRhKSkpOwogICAgICAgICAgYm90dG9tZmFjZS5wdXNoKDIgKiBpICsgMik7IC8vIFRvcAoKICAgICAgICAgIHZlcnRpY2VzLnB1c2gobmV3IFZlYzMoLXJhZGl1c1RvcCAqIHNpbih0aGV0YSksIGhlaWdodCAqIDAuNSwgcmFkaXVzVG9wICogY29zKHRoZXRhKSkpOwogICAgICAgICAgdG9wZmFjZS5wdXNoKDIgKiBpICsgMyk7IC8vIEZhY2UKCiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAyICogaSArIDMsIDIgKiBpICsgMl0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmYWNlcy5wdXNoKFsyICogaSwgMiAqIGkgKyAxLCAxLCAwXSk7IC8vIENvbm5lY3QKICAgICAgICB9IC8vIEF4aXM6IHdlIGNhbiBjdXQgb2ZmIGhhbGYgb2YgdGhlbSBpZiB3ZSBoYXZlIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzCgoKICAgICAgICBpZiAoTiAlIDIgPT09IDEgfHwgaSA8IE4gLyAyKSB7CiAgICAgICAgICBheGVzLnB1c2gobmV3IFZlYzMoLXNpbih0aGV0YU4pLCAwLCBjb3ModGhldGFOKSkpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmFjZXMucHVzaChib3R0b21mYWNlKTsKICAgICAgYXhlcy5wdXNoKG5ldyBWZWMzKDAsIDEsIDApKTsgLy8gUmVvcmRlciB0b3AgZmFjZQoKICAgICAgY29uc3QgdGVtcCA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3BmYWNlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdGVtcC5wdXNoKHRvcGZhY2VbdG9wZmFjZS5sZW5ndGggLSBpIC0gMV0pOwogICAgICB9CgogICAgICBmYWNlcy5wdXNoKHRlbXApOwogICAgICBzdXBlcih7CiAgICAgICAgdmVydGljZXMsCiAgICAgICAgZmFjZXMsCiAgICAgICAgYXhlcwogICAgICB9KTsKICAgICAgdGhpcy5yYWRpdXNUb3AgPSB2b2lkIDA7CiAgICAgIHRoaXMucmFkaXVzQm90dG9tID0gdm9pZCAwOwogICAgICB0aGlzLmhlaWdodCA9IHZvaWQgMDsKICAgICAgdGhpcy5udW1TZWdtZW50cyA9IHZvaWQgMDsKICAgICAgdGhpcy50eXBlID0gU2hhcGUudHlwZXMuQ1lMSU5ERVI7CiAgICAgIHRoaXMucmFkaXVzVG9wID0gcmFkaXVzVG9wOwogICAgICB0aGlzLnJhZGl1c0JvdHRvbSA9IHJhZGl1c0JvdHRvbTsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMubnVtU2VnbWVudHMgPSBudW1TZWdtZW50czsKICAgIH0KCiAgfQogIC8qKgogICAqIFBhcnRpY2xlIHNoYXBlLgogICAqIEBleGFtcGxlCiAgICogICAgIGNvbnN0IHBhcnRpY2xlU2hhcGUgPSBuZXcgQ0FOTk9OLlBhcnRpY2xlKCkKICAgKiAgICAgY29uc3QgcGFydGljbGVCb2R5ID0gbmV3IENBTk5PTi5Cb2R5KHsgbWFzczogMSwgc2hhcGU6IHBhcnRpY2xlU2hhcGUgfSkKICAgKiAgICAgd29ybGQuYWRkQm9keShwYXJ0aWNsZUJvZHkpCiAgICovCgoKICBjbGFzcyBQYXJ0aWNsZSBleHRlbmRzIFNoYXBlIHsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcih7CiAgICAgICAgdHlwZTogU2hhcGUudHlwZXMuUEFSVElDTEUKICAgICAgfSk7CiAgICB9CiAgICAvKioKICAgICAqIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYQogICAgICovCgoKICAgIGNhbGN1bGF0ZUxvY2FsSW5lcnRpYShtYXNzLCB0YXJnZXQgPSBuZXcgVmVjMygpKSB7CiAgICAgIHRhcmdldC5zZXQoMCwgMCwgMCk7CiAgICAgIHJldHVybiB0YXJnZXQ7CiAgICB9CgogICAgdm9sdW1lKCkgewogICAgICByZXR1cm4gMDsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyA9IDA7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gR2V0IGVhY2ggYXhpcyBtYXgKICAgICAgbWluLmNvcHkocG9zKTsKICAgICAgbWF4LmNvcHkocG9zKTsKICAgIH0KCiAgfQogIC8qKgogICAqIEEgcGxhbmUsIGZhY2luZyBpbiB0aGUgWiBkaXJlY3Rpb24uIFRoZSBwbGFuZSBoYXMgaXRzIHN1cmZhY2UgYXQgej0wIGFuZCBldmVyeXRoaW5nIGJlbG93IHo9MCBpcyBhc3N1bWVkIHRvIGJlIHNvbGlkIHBsYW5lLiBUbyBtYWtlIHRoZSBwbGFuZSBmYWNlIGluIHNvbWUgb3RoZXIgZGlyZWN0aW9uIHRoYW4geiwgeW91IG11c3QgcHV0IGl0IGluc2lkZSBhIEJvZHkgYW5kIHJvdGF0ZSB0aGF0IGJvZHkuIFNlZSB0aGUgZGVtb3MuCiAgICogQGV4YW1wbGUKICAgKiAgICAgY29uc3QgcGxhbmVTaGFwZSA9IG5ldyBDQU5OT04uUGxhbmUoKQogICAqICAgICBjb25zdCBwbGFuZUJvZHkgPSBuZXcgQ0FOTk9OLkJvZHkoeyBtYXNzOiAwLCBzaGFwZTogIHBsYW5lU2hhcGUgfSkKICAgKiAgICAgcGxhbmVCb2R5LnF1YXRlcm5pb24uc2V0RnJvbUV1bGVyKC1NYXRoLlBJIC8gMiwgMCwgMCkgLy8gbWFrZSBpdCBmYWNlIHVwCiAgICogICAgIHdvcmxkLmFkZEJvZHkocGxhbmVCb2R5KQogICAqLwoKCiAgY2xhc3MgUGxhbmUgZXh0ZW5kcyBTaGFwZSB7CiAgICAvKiogd29ybGROb3JtYWwgKi8KCiAgICAvKiogd29ybGROb3JtYWxOZWVkc1VwZGF0ZSAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5QTEFORQogICAgICB9KTsgLy8gV29ybGQgb3JpZW50ZWQgbm9ybWFsCgogICAgICB0aGlzLndvcmxkTm9ybWFsID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkTm9ybWFsTmVlZHNVcGRhdGUgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm91bmRpbmdTcGhlcmVSYWRpdXMgPSB2b2lkIDA7CiAgICAgIHRoaXMud29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLndvcmxkTm9ybWFsTmVlZHNVcGRhdGUgPSB0cnVlOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KICAgIC8qKiBjb21wdXRlV29ybGROb3JtYWwgKi8KCgogICAgY29tcHV0ZVdvcmxkTm9ybWFsKHF1YXQpIHsKICAgICAgY29uc3QgbiA9IHRoaXMud29ybGROb3JtYWw7CiAgICAgIG4uc2V0KDAsIDAsIDEpOwogICAgICBxdWF0LnZtdWx0KG4sIG4pOwogICAgICB0aGlzLndvcmxkTm9ybWFsTmVlZHNVcGRhdGUgPSBmYWxzZTsKICAgIH0KCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgcGxhbmUgaXMgaW5maW5pdGUuLi4KICAgICAgICBOdW1iZXIuTUFYX1ZBTFVFCiAgICAgICk7CiAgICB9CgogICAgY2FsY3VsYXRlV29ybGRBQUJCKHBvcywgcXVhdCwgbWluLCBtYXgpIHsKICAgICAgLy8gVGhlIHBsYW5lIEFBQkIgaXMgaW5maW5pdGUsIGV4Y2VwdCBpZiB0aGUgbm9ybWFsIGlzIHBvaW50aW5nIGFsb25nIGFueSBheGlzCiAgICAgIHRlbXBOb3JtYWwuc2V0KDAsIDAsIDEpOyAvLyBEZWZhdWx0IHBsYW5lIG5vcm1hbCBpcyB6CgogICAgICBxdWF0LnZtdWx0KHRlbXBOb3JtYWwsIHRlbXBOb3JtYWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBOdW1iZXIuTUFYX1ZBTFVFOwogICAgICBtaW4uc2V0KC1tYXhWYWwsIC1tYXhWYWwsIC1tYXhWYWwpOwogICAgICBtYXguc2V0KG1heFZhbCwgbWF4VmFsLCBtYXhWYWwpOwoKICAgICAgaWYgKHRlbXBOb3JtYWwueCA9PT0gMSkgewogICAgICAgIG1heC54ID0gcG9zLng7CiAgICAgIH0gZWxzZSBpZiAodGVtcE5vcm1hbC54ID09PSAtMSkgewogICAgICAgIG1pbi54ID0gcG9zLng7CiAgICAgIH0KCiAgICAgIGlmICh0ZW1wTm9ybWFsLnkgPT09IDEpIHsKICAgICAgICBtYXgueSA9IHBvcy55OwogICAgICB9IGVsc2UgaWYgKHRlbXBOb3JtYWwueSA9PT0gLTEpIHsKICAgICAgICBtaW4ueSA9IHBvcy55OwogICAgICB9CgogICAgICBpZiAodGVtcE5vcm1hbC56ID09PSAxKSB7CiAgICAgICAgbWF4LnogPSBwb3MuejsKICAgICAgfSBlbHNlIGlmICh0ZW1wTm9ybWFsLnogPT09IC0xKSB7CiAgICAgICAgbWluLnogPSBwb3MuejsKICAgICAgfQogICAgfQoKICAgIHVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCkgewogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTnVtYmVyLk1BWF9WQUxVRTsKICAgIH0KCiAgfQoKICBjb25zdCB0ZW1wTm9ybWFsID0gbmV3IFZlYzMoKTsKICAvKioKICAgKiBIZWlnaHRmaWVsZCBzaGFwZSBjbGFzcy4gSGVpZ2h0IGRhdGEgaXMgZ2l2ZW4gYXMgYW4gYXJyYXkuIFRoZXNlIGRhdGEgcG9pbnRzIGFyZSBzcHJlYWQgb3V0IGV2ZW5seSB3aXRoIGEgZ2l2ZW4gZGlzdGFuY2UuCiAgICogQHRvZG8gU2hvdWxkIGJlIHBvc3NpYmxlIHRvIHVzZSBhbG9uZyBhbGwgYXhlcywgbm90IGp1c3QgeQogICAqIEB0b2RvIHNob3VsZCBiZSBwb3NzaWJsZSB0byBzY2FsZSBhbG9uZyBhbGwgYXhlcwogICAqIEB0b2RvIFJlZmFjdG9yIGVsZW1lbnRTaXplIHRvIGVsZW1lbnRTaXplWCBhbmQgZWxlbWVudFNpemVZCiAgICoKICAgKiBAZXhhbXBsZQogICAqICAgICAvLyBHZW5lcmF0ZSBzb21lIGhlaWdodCBkYXRhICh5LXZhbHVlcykuCiAgICogICAgIGNvbnN0IGRhdGEgPSBbXQogICAqICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwMDA7IGkrKykgewogICAqICAgICAgICAgY29uc3QgeSA9IDAuNSAqIE1hdGguY29zKDAuMiAqIGkpCiAgICogICAgICAgICBkYXRhLnB1c2goeSkKICAgKiAgICAgfQogICAqCiAgICogICAgIC8vIENyZWF0ZSB0aGUgaGVpZ2h0ZmllbGQgc2hhcGUKICAgKiAgICAgY29uc3QgaGVpZ2h0ZmllbGRTaGFwZSA9IG5ldyBDQU5OT04uSGVpZ2h0ZmllbGQoZGF0YSwgewogICAqICAgICAgICAgZWxlbWVudFNpemU6IDEgLy8gRGlzdGFuY2UgYmV0d2VlbiB0aGUgZGF0YSBwb2ludHMgaW4gWCBhbmQgWSBkaXJlY3Rpb25zCiAgICogICAgIH0pCiAgICogICAgIGNvbnN0IGhlaWdodGZpZWxkQm9keSA9IG5ldyBDQU5OT04uQm9keSh7IHNoYXBlOiBoZWlnaHRmaWVsZFNoYXBlIH0pCiAgICogICAgIHdvcmxkLmFkZEJvZHkoaGVpZ2h0ZmllbGRCb2R5KQogICAqLwoKICBjbGFzcyBIZWlnaHRmaWVsZCBleHRlbmRzIFNoYXBlIHsKICAgIC8qKgogICAgICogQW4gYXJyYXkgb2YgbnVtYmVycywgb3IgaGVpZ2h0IHZhbHVlcywgdGhhdCBhcmUgc3ByZWFkIG91dCBhbG9uZyB0aGUgeCBheGlzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYXggdmFsdWUgb2YgdGhlIGRhdGEgcG9pbnRzIGluIHRoZSBkYXRhIGFycmF5LgogICAgICovCgogICAgLyoqCiAgICAgKiBNaW5pbXVtIHZhbHVlIG9mIHRoZSBkYXRhIHBvaW50cyBpbiB0aGUgZGF0YSBhcnJheS4KICAgICAqLwoKICAgIC8qKgogICAgICogV29ybGQgc3BhY2luZyBiZXR3ZWVuIHRoZSBkYXRhIHBvaW50cyBpbiBYIGFuZCBZIGRpcmVjdGlvbi4KICAgICAqIEB0b2RvIGVsZW1lbnRTaXplWCBhbmQgWQogICAgICogQGRlZmF1bHQgMQogICAgICovCgogICAgLyoqCiAgICAgKiBAZGVmYXVsdCB0cnVlCiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBkYXRhIEFuIGFycmF5IG9mIG51bWJlcnMsIG9yIGhlaWdodCB2YWx1ZXMsIHRoYXQgYXJlIHNwcmVhZCBvdXQgYWxvbmcgdGhlIHggYXhpcy4KICAgICAqLwogICAgY29uc3RydWN0b3IoZGF0YSwgb3B0aW9ucyA9IHt9KSB7CiAgICAgIG9wdGlvbnMgPSBVdGlscy5kZWZhdWx0cyhvcHRpb25zLCB7CiAgICAgICAgbWF4VmFsdWU6IG51bGwsCiAgICAgICAgbWluVmFsdWU6IG51bGwsCiAgICAgICAgZWxlbWVudFNpemU6IDEKICAgICAgfSk7CiAgICAgIHN1cGVyKHsKICAgICAgICB0eXBlOiBTaGFwZS50eXBlcy5IRUlHSFRGSUVMRAogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gdm9pZCAwOwogICAgICB0aGlzLm1heFZhbHVlID0gdm9pZCAwOwogICAgICB0aGlzLm1pblZhbHVlID0gdm9pZCAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gdm9pZCAwOwogICAgICB0aGlzLmNhY2hlRW5hYmxlZCA9IHZvaWQgMDsKICAgICAgdGhpcy5waWxsYXJDb252ZXggPSB2b2lkIDA7CiAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gdm9pZCAwOwogICAgICB0aGlzLl9jYWNoZWRQaWxsYXJzID0gdm9pZCAwOwogICAgICB0aGlzLmRhdGEgPSBkYXRhOwogICAgICB0aGlzLm1heFZhbHVlID0gb3B0aW9ucy5tYXhWYWx1ZTsKICAgICAgdGhpcy5taW5WYWx1ZSA9IG9wdGlvbnMubWluVmFsdWU7CiAgICAgIHRoaXMuZWxlbWVudFNpemUgPSBvcHRpb25zLmVsZW1lbnRTaXplOwoKICAgICAgaWYgKG9wdGlvbnMubWluVmFsdWUgPT09IG51bGwpIHsKICAgICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLm1heFZhbHVlID09PSBudWxsKSB7CiAgICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB9CgogICAgICB0aGlzLmNhY2hlRW5hYmxlZCA9IHRydWU7CiAgICAgIHRoaXMucGlsbGFyQ29udmV4ID0gbmV3IENvbnZleFBvbHloZWRyb24oKTsKICAgICAgdGhpcy5waWxsYXJPZmZzZXQgPSBuZXcgVmVjMygpOwogICAgICB0aGlzLnVwZGF0ZUJvdW5kaW5nU3BoZXJlUmFkaXVzKCk7IC8vICJpX2pfaXNVcHBlciIgPT4geyBjb252ZXg6IC4uLiwgb2Zmc2V0OiAuLi4gfQogICAgICAvLyBmb3IgZXhhbXBsZToKICAgICAgLy8gX2NhY2hlZFBpbGxhcnNbIjBfMl8xIl0KCiAgICAgIHRoaXMuX2NhY2hlZFBpbGxhcnMgPSB7fTsKICAgIH0KICAgIC8qKgogICAgICogQ2FsbCB3aGVuZXZlciB5b3UgY2hhbmdlIHRoZSBkYXRhIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZSgpIHsKICAgICAgdGhpcy5fY2FjaGVkUGlsbGFycyA9IHt9OwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGBtaW5WYWx1ZWAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVNaW5WYWx1ZSgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgbGV0IG1pblZhbHVlID0gZGF0YVswXVswXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IGRhdGFbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmICh2IDwgbWluVmFsdWUpIHsKICAgICAgICAgICAgbWluVmFsdWUgPSB2OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5taW5WYWx1ZSA9IG1pblZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGBtYXhWYWx1ZWAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVNYXhWYWx1ZSgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgbGV0IG1heFZhbHVlID0gZGF0YVswXVswXTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IGRhdGFbaV0ubGVuZ3RoOyBqKyspIHsKICAgICAgICAgIGNvbnN0IHYgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmICh2ID4gbWF4VmFsdWUpIHsKICAgICAgICAgICAgbWF4VmFsdWUgPSB2OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5tYXhWYWx1ZSA9IG1heFZhbHVlOwogICAgfQogICAgLyoqCiAgICAgKiBTZXQgdGhlIGhlaWdodCB2YWx1ZSBhdCBhbiBpbmRleC4gRG9uJ3QgZm9yZ2V0IHRvIHVwZGF0ZSBtYXhWYWx1ZSBhbmQgbWluVmFsdWUgYWZ0ZXIgeW91J3JlIGRvbmUuCiAgICAgKi8KCgogICAgc2V0SGVpZ2h0VmFsdWVBdEluZGV4KHhpLCB5aSwgdmFsdWUpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgZGF0YVt4aV1beWldID0gdmFsdWU7IC8vIEludmFsaWRhdGUgY2FjaGUKCiAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGZhbHNlKTsKCiAgICAgIGlmICh4aSA+IDApIHsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGkgLSAxLCB5aSwgdHJ1ZSk7CiAgICAgICAgdGhpcy5jbGVhckNhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpIC0gMSwgeWksIGZhbHNlKTsKICAgICAgfQoKICAgICAgaWYgKHlpID4gMCkgewogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWkgLSAxLCB0cnVlKTsKICAgICAgICB0aGlzLmNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpIC0gMSwgZmFsc2UpOwogICAgICB9CgogICAgICBpZiAoeWkgPiAwICYmIHhpID4gMCkgewogICAgICAgIHRoaXMuY2xlYXJDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSAtIDEsIHlpIC0gMSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogR2V0IG1heC9taW4gaW4gYSByZWN0YW5nbGUgaW4gdGhlIG1hdHJpeCBkYXRhCiAgICAgKiBAcGFyYW0gcmVzdWx0IEFuIGFycmF5IHRvIHN0b3JlIHRoZSByZXN1bHRzIGluLgogICAgICogQHJldHVybiBUaGUgcmVzdWx0IGFycmF5LCBpZiBpdCB3YXMgcGFzc2VkIGluLiBNaW5pbXVtIHdpbGwgYmUgYXQgcG9zaXRpb24gMCBhbmQgbWF4IGF0IDEuCiAgICAgKi8KCgogICAgZ2V0UmVjdE1pbk1heChpTWluWCwgaU1pblksIGlNYXhYLCBpTWF4WSwgcmVzdWx0ID0gW10pIHsKICAgICAgLy8gR2V0IG1heCBhbmQgbWluIG9mIHRoZSBkYXRhCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7IC8vIFNldCBmaXJzdCB2YWx1ZQoKICAgICAgbGV0IG1heCA9IHRoaXMubWluVmFsdWU7CgogICAgICBmb3IgKGxldCBpID0gaU1pblg7IGkgPD0gaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8PSBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBoZWlnaHQgPSBkYXRhW2ldW2pdOwoKICAgICAgICAgIGlmIChoZWlnaHQgPiBtYXgpIHsKICAgICAgICAgICAgbWF4ID0gaGVpZ2h0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmVzdWx0WzBdID0gdGhpcy5taW5WYWx1ZTsKICAgICAgcmVzdWx0WzFdID0gbWF4OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGluZGV4IG9mIGEgbG9jYWwgcG9zaXRpb24gb24gdGhlIGhlaWdodGZpZWxkLiBUaGUgaW5kZXhlcyBpbmRpY2F0ZSB0aGUgcmVjdGFuZ2xlcywgc28gaWYgeW91ciB0ZXJyYWluIGlzIG1hZGUgb2YgTiB4IE4gaGVpZ2h0IGRhdGEgcG9pbnRzLCB5b3Ugd2lsbCBoYXZlIHJlY3RhbmdsZSBpbmRleGVzIHJhbmdpbmcgZnJvbSAwIHRvIE4tMS4KICAgICAqIEBwYXJhbSByZXN1bHQgVHdvLWVsZW1lbnQgYXJyYXkKICAgICAqIEBwYXJhbSBjbGFtcCBJZiB0aGUgcG9zaXRpb24gc2hvdWxkIGJlIGNsYW1wZWQgdG8gdGhlIGhlaWdodGZpZWxkIGVkZ2UuCiAgICAgKi8KCgogICAgZ2V0SW5kZXhPZlBvc2l0aW9uKHgsIHksIHJlc3VsdCwgY2xhbXApIHsKICAgICAgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CiAgICAgIGNvbnN0IHcgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBsZXQgeGkgPSBNYXRoLmZsb29yKHggLyB3KTsKICAgICAgbGV0IHlpID0gTWF0aC5mbG9vcih5IC8gdyk7CiAgICAgIHJlc3VsdFswXSA9IHhpOwogICAgICByZXN1bHRbMV0gPSB5aTsKCiAgICAgIGlmIChjbGFtcCkgewogICAgICAgIC8vIENsYW1wIGluZGV4IHRvIGVkZ2VzCiAgICAgICAgaWYgKHhpIDwgMCkgewogICAgICAgICAgeGkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHlpIDwgMCkgewogICAgICAgICAgeWkgPSAwOwogICAgICAgIH0KCiAgICAgICAgaWYgKHhpID49IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgeGkgPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICBpZiAoeWkgPj0gZGF0YVswXS5sZW5ndGggLSAxKSB7CiAgICAgICAgICB5aSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CiAgICAgIH0gLy8gQmFpbCBvdXQgaWYgd2UgYXJlIG91dCBvZiB0aGUgdGVycmFpbgoKCiAgICAgIGlmICh4aSA8IDAgfHwgeWkgPCAwIHx8IHhpID49IGRhdGEubGVuZ3RoIC0gMSB8fCB5aSA+PSBkYXRhWzBdLmxlbmd0aCAtIDEpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGdldFRyaWFuZ2xlQXQoeCwgeSwgZWRnZUNsYW1wLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGlkeCA9IGdldEhlaWdodEF0X2lkeDsKICAgICAgdGhpcy5nZXRJbmRleE9mUG9zaXRpb24oeCwgeSwgaWR4LCBlZGdlQ2xhbXApOwogICAgICBsZXQgeGkgPSBpZHhbMF07CiAgICAgIGxldCB5aSA9IGlkeFsxXTsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKCiAgICAgIGlmIChlZGdlQ2xhbXApIHsKICAgICAgICB4aSA9IE1hdGgubWluKGRhdGEubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeGkpKTsKICAgICAgICB5aSA9IE1hdGgubWluKGRhdGFbMF0ubGVuZ3RoIC0gMiwgTWF0aC5tYXgoMCwgeWkpKTsKICAgICAgfQoKICAgICAgY29uc3QgZWxlbWVudFNpemUgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICBjb25zdCBsb3dlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtIHhpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtIHlpKSAqKiAyOwogICAgICBjb25zdCB1cHBlckRpc3QyID0gKHggLyBlbGVtZW50U2l6ZSAtICh4aSArIDEpKSAqKiAyICsgKHkgLyBlbGVtZW50U2l6ZSAtICh5aSArIDEpKSAqKiAyOwogICAgICBjb25zdCB1cHBlciA9IGxvd2VyRGlzdDIgPiB1cHBlckRpc3QyOwogICAgICB0aGlzLmdldFRyaWFuZ2xlKHhpLCB5aSwgdXBwZXIsIGEsIGIsIGMpOwogICAgICByZXR1cm4gdXBwZXI7CiAgICB9CgogICAgZ2V0Tm9ybWFsQXQoeCwgeSwgZWRnZUNsYW1wLCByZXN1bHQpIHsKICAgICAgY29uc3QgYSA9IGdldE5vcm1hbEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXROb3JtYWxBdF9iOwogICAgICBjb25zdCBjID0gZ2V0Tm9ybWFsQXRfYzsKICAgICAgY29uc3QgZTAgPSBnZXROb3JtYWxBdF9lMDsKICAgICAgY29uc3QgZTEgPSBnZXROb3JtYWxBdF9lMTsKICAgICAgdGhpcy5nZXRUcmlhbmdsZUF0KHgsIHksIGVkZ2VDbGFtcCwgYSwgYiwgYyk7CiAgICAgIGIudnN1YihhLCBlMCk7CiAgICAgIGMudnN1YihhLCBlMSk7CiAgICAgIGUwLmNyb3NzKGUxLCByZXN1bHQpOwogICAgICByZXN1bHQubm9ybWFsaXplKCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBBQUJCIG9mIGEgc3F1YXJlIGluIHRoZSBoZWlnaHRmaWVsZAogICAgICogQHBhcmFtIHhpCiAgICAgKiBAcGFyYW0geWkKICAgICAqIEBwYXJhbSByZXN1bHQKICAgICAqLwoKCiAgICBnZXRBYWJiQXRJbmRleCh4aSwgeWksIHsKICAgICAgbG93ZXJCb3VuZCwKICAgICAgdXBwZXJCb3VuZAogICAgfSkgewogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CiAgICAgIGxvd2VyQm91bmQuc2V0KHhpICogZWxlbWVudFNpemUsIHlpICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpXSk7CiAgICAgIHVwcGVyQm91bmQuc2V0KCh4aSArIDEpICogZWxlbWVudFNpemUsICh5aSArIDEpICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdKTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IHRoZSBoZWlnaHQgaW4gdGhlIGhlaWdodGZpZWxkIGF0IGEgZ2l2ZW4gcG9zaXRpb24KICAgICAqLwoKCiAgICBnZXRIZWlnaHRBdCh4LCB5LCBlZGdlQ2xhbXApIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3QgYSA9IGdldEhlaWdodEF0X2E7CiAgICAgIGNvbnN0IGIgPSBnZXRIZWlnaHRBdF9iOwogICAgICBjb25zdCBjID0gZ2V0SGVpZ2h0QXRfYzsKICAgICAgY29uc3QgaWR4ID0gZ2V0SGVpZ2h0QXRfaWR4OwogICAgICB0aGlzLmdldEluZGV4T2ZQb3NpdGlvbih4LCB5LCBpZHgsIGVkZ2VDbGFtcCk7CiAgICAgIGxldCB4aSA9IGlkeFswXTsKICAgICAgbGV0IHlpID0gaWR4WzFdOwoKICAgICAgaWYgKGVkZ2VDbGFtcCkgewogICAgICAgIHhpID0gTWF0aC5taW4oZGF0YS5sZW5ndGggLSAyLCBNYXRoLm1heCgwLCB4aSkpOwogICAgICAgIHlpID0gTWF0aC5taW4oZGF0YVswXS5sZW5ndGggLSAyLCBNYXRoLm1heCgwLCB5aSkpOwogICAgICB9CgogICAgICBjb25zdCB1cHBlciA9IHRoaXMuZ2V0VHJpYW5nbGVBdCh4LCB5LCBlZGdlQ2xhbXAsIGEsIGIsIGMpOwogICAgICBiYXJ5Y2VudHJpY1dlaWdodHMoeCwgeSwgYS54LCBhLnksIGIueCwgYi55LCBjLngsIGMueSwgZ2V0SGVpZ2h0QXRfd2VpZ2h0cyk7CiAgICAgIGNvbnN0IHcgPSBnZXRIZWlnaHRBdF93ZWlnaHRzOwoKICAgICAgaWYgKHVwcGVyKSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgcmV0dXJuIGRhdGFbeGkgKyAxXVt5aSArIDFdICogdy54ICsgZGF0YVt4aV1beWkgKyAxXSAqIHcueSArIGRhdGFbeGkgKyAxXVt5aV0gKiB3Lno7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgcmV0dXJuIGRhdGFbeGldW3lpXSAqIHcueCArIGRhdGFbeGkgKyAxXVt5aV0gKiB3LnkgKyBkYXRhW3hpXVt5aSArIDFdICogdy56OwogICAgICB9CiAgICB9CgogICAgZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpIHsKICAgICAgcmV0dXJuIHhpICsgIl8iICsgeWkgKyAiXyIgKyAoZ2V0VXBwZXJUcmlhbmdsZSA/IDEgOiAwKTsKICAgIH0KCiAgICBnZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpIHsKICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlZFBpbGxhcnNbdGhpcy5nZXRDYWNoZUNvbnZleFRyaWFuZ2xlUGlsbGFyS2V5KHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSldOwogICAgfQoKICAgIHNldENhY2hlZENvbnZleFRyaWFuZ2xlUGlsbGFyKHhpLCB5aSwgZ2V0VXBwZXJUcmlhbmdsZSwgY29udmV4LCBvZmZzZXQpIHsKICAgICAgdGhpcy5fY2FjaGVkUGlsbGFyc1t0aGlzLmdldENhY2hlQ29udmV4VHJpYW5nbGVQaWxsYXJLZXkoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKV0gPSB7CiAgICAgICAgY29udmV4LAogICAgICAgIG9mZnNldAogICAgICB9OwogICAgfQoKICAgIGNsZWFyQ2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIGRlbGV0ZSB0aGlzLl9jYWNoZWRQaWxsYXJzW3RoaXMuZ2V0Q2FjaGVDb252ZXhUcmlhbmdsZVBpbGxhcktleSh4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUpXTsKICAgIH0KICAgIC8qKgogICAgICogR2V0IGEgdHJpYW5nbGUgZnJvbSB0aGUgaGVpZ2h0ZmllbGQKICAgICAqLwoKCiAgICBnZXRUcmlhbmdsZSh4aSwgeWksIHVwcGVyLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IGVsZW1lbnRTaXplID0gdGhpcy5lbGVtZW50U2l6ZTsKCiAgICAgIGlmICh1cHBlcikgewogICAgICAgIC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwogICAgICAgIGEuc2V0KCh4aSArIDEpICogZWxlbWVudFNpemUsICh5aSArIDEpICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aSArIDFdKTsKICAgICAgICBiLnNldCh4aSAqIGVsZW1lbnRTaXplLCAoeWkgKyAxKSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdKTsKICAgICAgICBjLnNldCgoeGkgKyAxKSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpICsgMV1beWldKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBUb3AgdHJpYW5nbGUgdmVydHMKICAgICAgICBhLnNldCh4aSAqIGVsZW1lbnRTaXplLCB5aSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aV0pOwogICAgICAgIGIuc2V0KCh4aSArIDEpICogZWxlbWVudFNpemUsIHlpICogZWxlbWVudFNpemUsIGRhdGFbeGkgKyAxXVt5aV0pOwogICAgICAgIGMuc2V0KHhpICogZWxlbWVudFNpemUsICh5aSArIDEpICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpICsgMV0pOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHRyaWFuZ2xlIGluIHRoZSB0ZXJyYWluIGluIHRoZSBmb3JtIG9mIGEgdHJpYW5ndWxhciBjb252ZXggc2hhcGUuCiAgICAgKi8KCgogICAgZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKSB7CiAgICAgIGxldCByZXN1bHQgPSB0aGlzLnBpbGxhckNvbnZleDsKICAgICAgbGV0IG9mZnNldFJlc3VsdCA9IHRoaXMucGlsbGFyT2Zmc2V0OwoKICAgICAgaWYgKHRoaXMuY2FjaGVFbmFibGVkKSB7CiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZ2V0Q2FjaGVkQ29udmV4VHJpYW5nbGVQaWxsYXIoeGksIHlpLCBnZXRVcHBlclRyaWFuZ2xlKTsKCiAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgIHRoaXMucGlsbGFyQ29udmV4ID0gZGF0YS5jb252ZXg7CiAgICAgICAgICB0aGlzLnBpbGxhck9mZnNldCA9IGRhdGEub2Zmc2V0OwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0ID0gbmV3IENvbnZleFBvbHloZWRyb24oKTsKICAgICAgICBvZmZzZXRSZXN1bHQgPSBuZXcgVmVjMygpOwogICAgICAgIHRoaXMucGlsbGFyQ29udmV4ID0gcmVzdWx0OwogICAgICAgIHRoaXMucGlsbGFyT2Zmc2V0ID0gb2Zmc2V0UmVzdWx0OwogICAgICB9CgogICAgICBjb25zdCBkYXRhID0gdGhpcy5kYXRhOwogICAgICBjb25zdCBlbGVtZW50U2l6ZSA9IHRoaXMuZWxlbWVudFNpemU7CiAgICAgIGNvbnN0IGZhY2VzID0gcmVzdWx0LmZhY2VzOyAvLyBSZXVzZSB2ZXJ0cyBpZiBwb3NzaWJsZQoKICAgICAgcmVzdWx0LnZlcnRpY2VzLmxlbmd0aCA9IDY7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDY7IGkrKykgewogICAgICAgIGlmICghcmVzdWx0LnZlcnRpY2VzW2ldKSB7CiAgICAgICAgICByZXN1bHQudmVydGljZXNbaV0gPSBuZXcgVmVjMygpOwogICAgICAgIH0KICAgICAgfSAvLyBSZXVzZSBmYWNlcyBpZiBwb3NzaWJsZQoKCiAgICAgIGZhY2VzLmxlbmd0aCA9IDU7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDU7IGkrKykgewogICAgICAgIGlmICghZmFjZXNbaV0pIHsKICAgICAgICAgIGZhY2VzW2ldID0gW107CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zdCB2ZXJ0cyA9IHJlc3VsdC52ZXJ0aWNlczsKICAgICAgY29uc3QgaCA9IChNYXRoLm1pbihkYXRhW3hpXVt5aV0sIGRhdGFbeGkgKyAxXVt5aV0sIGRhdGFbeGldW3lpICsgMV0sIGRhdGFbeGkgKyAxXVt5aSArIDFdKSAtIHRoaXMubWluVmFsdWUpIC8gMiArIHRoaXMubWluVmFsdWU7CgogICAgICBpZiAoIWdldFVwcGVyVHJpYW5nbGUpIHsKICAgICAgICAvLyBDZW50ZXIgb2YgdGhlIHRyaWFuZ2xlIHBpbGxhciAtIGFsbCBwb2x5Z29ucyBhcmUgZ2l2ZW4gcmVsYXRpdmUgdG8gdGhpcyBvbmUKICAgICAgICBvZmZzZXRSZXN1bHQuc2V0KCh4aSArIDAuMjUpICogZWxlbWVudFNpemUsIC8vIHNvcnQgb2YgY2VudGVyIG9mIGEgdHJpYW5nbGUKICAgICAgICAoeWkgKyAwLjI1KSAqIGVsZW1lbnRTaXplLCBoIC8vIHZlcnRpY2FsIGNlbnRlcgogICAgICAgICk7IC8vIFRvcCB0cmlhbmdsZSB2ZXJ0cwoKICAgICAgICB2ZXJ0c1swXS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aV1beWldIC0gaCk7CiAgICAgICAgdmVydHNbMV0uc2V0KDAuNzUgKiBlbGVtZW50U2l6ZSwgLTAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSAtIGgpOwogICAgICAgIHZlcnRzWzJdLnNldCgtMC4yNSAqIGVsZW1lbnRTaXplLCAwLjc1ICogZWxlbWVudFNpemUsIGRhdGFbeGldW3lpICsgMV0gLSBoKTsgLy8gYm90dG9tIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzNdLnNldCgtMC4yNSAqIGVsZW1lbnRTaXplLCAtMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s0XS5zZXQoMC43NSAqIGVsZW1lbnRTaXplLCAtMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s1XS5zZXQoLTAuMjUgKiBlbGVtZW50U2l6ZSwgMC43NSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsgLy8gdG9wIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzBdWzBdID0gMDsKICAgICAgICBmYWNlc1swXVsxXSA9IDE7CiAgICAgICAgZmFjZXNbMF1bMl0gPSAyOyAvLyBib3R0b20gdHJpYW5nbGUKCiAgICAgICAgZmFjZXNbMV1bMF0gPSA1OwogICAgICAgIGZhY2VzWzFdWzFdID0gNDsKICAgICAgICBmYWNlc1sxXVsyXSA9IDM7IC8vIC14IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzJdWzBdID0gMDsKICAgICAgICBmYWNlc1syXVsxXSA9IDI7CiAgICAgICAgZmFjZXNbMl1bMl0gPSA1OwogICAgICAgIGZhY2VzWzJdWzNdID0gMzsgLy8gLXkgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbM11bMF0gPSAxOwogICAgICAgIGZhY2VzWzNdWzFdID0gMDsKICAgICAgICBmYWNlc1szXVsyXSA9IDM7CiAgICAgICAgZmFjZXNbM11bM10gPSA0OyAvLyAreHkgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbNF1bMF0gPSA0OwogICAgICAgIGZhY2VzWzRdWzFdID0gNTsKICAgICAgICBmYWNlc1s0XVsyXSA9IDI7CiAgICAgICAgZmFjZXNbNF1bM10gPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIENlbnRlciBvZiB0aGUgdHJpYW5nbGUgcGlsbGFyIC0gYWxsIHBvbHlnb25zIGFyZSBnaXZlbiByZWxhdGl2ZSB0byB0aGlzIG9uZQogICAgICAgIG9mZnNldFJlc3VsdC5zZXQoKHhpICsgMC43NSkgKiBlbGVtZW50U2l6ZSwgLy8gc29ydCBvZiBjZW50ZXIgb2YgYSB0cmlhbmdsZQogICAgICAgICh5aSArIDAuNzUpICogZWxlbWVudFNpemUsIGggLy8gdmVydGljYWwgY2VudGVyCiAgICAgICAgKTsgLy8gVG9wIHRyaWFuZ2xlIHZlcnRzCgogICAgICAgIHZlcnRzWzBdLnNldCgwLjI1ICogZWxlbWVudFNpemUsIDAuMjUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpICsgMV0gLSBoKTsKICAgICAgICB2ZXJ0c1sxXS5zZXQoLTAuNzUgKiBlbGVtZW50U2l6ZSwgMC4yNSAqIGVsZW1lbnRTaXplLCBkYXRhW3hpXVt5aSArIDFdIC0gaCk7CiAgICAgICAgdmVydHNbMl0uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgLTAuNzUgKiBlbGVtZW50U2l6ZSwgZGF0YVt4aSArIDFdW3lpXSAtIGgpOyAvLyBib3R0b20gdHJpYW5nbGUgdmVydHMKCiAgICAgICAgdmVydHNbM10uc2V0KDAuMjUgKiBlbGVtZW50U2l6ZSwgMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s0XS5zZXQoLTAuNzUgKiBlbGVtZW50U2l6ZSwgMC4yNSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsKICAgICAgICB2ZXJ0c1s1XS5zZXQoMC4yNSAqIGVsZW1lbnRTaXplLCAtMC43NSAqIGVsZW1lbnRTaXplLCAtTWF0aC5hYnMoaCkgLSAxKTsgLy8gVG9wIHRyaWFuZ2xlCgogICAgICAgIGZhY2VzWzBdWzBdID0gMDsKICAgICAgICBmYWNlc1swXVsxXSA9IDE7CiAgICAgICAgZmFjZXNbMF1bMl0gPSAyOyAvLyBib3R0b20gdHJpYW5nbGUKCiAgICAgICAgZmFjZXNbMV1bMF0gPSA1OwogICAgICAgIGZhY2VzWzFdWzFdID0gNDsKICAgICAgICBmYWNlc1sxXVsyXSA9IDM7IC8vICt4IGZhY2luZyBxdWFkCgogICAgICAgIGZhY2VzWzJdWzBdID0gMjsKICAgICAgICBmYWNlc1syXVsxXSA9IDU7CiAgICAgICAgZmFjZXNbMl1bMl0gPSAzOwogICAgICAgIGZhY2VzWzJdWzNdID0gMDsgLy8gK3kgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbM11bMF0gPSAzOwogICAgICAgIGZhY2VzWzNdWzFdID0gNDsKICAgICAgICBmYWNlc1szXVsyXSA9IDE7CiAgICAgICAgZmFjZXNbM11bM10gPSAwOyAvLyAteHkgZmFjaW5nIHF1YWQKCiAgICAgICAgZmFjZXNbNF1bMF0gPSAxOwogICAgICAgIGZhY2VzWzRdWzFdID0gNDsKICAgICAgICBmYWNlc1s0XVsyXSA9IDU7CiAgICAgICAgZmFjZXNbNF1bM10gPSAyOwogICAgICB9CgogICAgICByZXN1bHQuY29tcHV0ZU5vcm1hbHMoKTsKICAgICAgcmVzdWx0LmNvbXB1dGVFZGdlcygpOwogICAgICByZXN1bHQudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy5zZXRDYWNoZWRDb252ZXhUcmlhbmdsZVBpbGxhcih4aSwgeWksIGdldFVwcGVyVHJpYW5nbGUsIHJlc3VsdCwgb2Zmc2V0UmVzdWx0KTsKICAgIH0KCiAgICBjYWxjdWxhdGVMb2NhbEluZXJ0aWEobWFzcywgdGFyZ2V0ID0gbmV3IFZlYzMoKSkgewogICAgICB0YXJnZXQuc2V0KDAsIDAsIDApOwogICAgICByZXR1cm4gdGFyZ2V0OwogICAgfQoKICAgIHZvbHVtZSgpIHsKICAgICAgcmV0dXJuICgvLyBUaGUgdGVycmFpbiBpcyBpbmZpbml0ZQogICAgICAgIE51bWJlci5NQVhfVkFMVUUKICAgICAgKTsKICAgIH0KCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKiogQFRPRE8gZG8gaXQgcHJvcGVybHkgKi8KICAgICAgbWluLnNldCgtTnVtYmVyLk1BWF9WQUxVRSwgLU51bWJlci5NQVhfVkFMVUUsIC1OdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgbWF4LnNldChOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFLCBOdW1iZXIuTUFYX1ZBTFVFKTsKICAgIH0KCiAgICB1cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpIHsKICAgICAgLy8gVXNlIHRoZSBib3VuZGluZyBib3ggb2YgdGhlIG1pbi9tYXggdmFsdWVzCiAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLmRhdGE7CiAgICAgIGNvbnN0IHMgPSB0aGlzLmVsZW1lbnRTaXplOwogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gbmV3IFZlYzMoZGF0YS5sZW5ndGggKiBzLCBkYXRhWzBdLmxlbmd0aCAqIHMsIE1hdGgubWF4KE1hdGguYWJzKHRoaXMubWF4VmFsdWUpLCBNYXRoLmFicyh0aGlzLm1pblZhbHVlKSkpLmxlbmd0aCgpOwogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIHRoZSBoZWlnaHQgdmFsdWVzIGZyb20gYW4gaW1hZ2UuIEN1cnJlbnRseSBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyLgogICAgICovCgoKICAgIHNldEhlaWdodHNGcm9tSW1hZ2UoaW1hZ2UsIHNjYWxlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICB4LAogICAgICAgIHosCiAgICAgICAgeQogICAgICB9ID0gc2NhbGU7CiAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICBjb250ZXh0LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7CiAgICAgIGNvbnN0IGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpOwogICAgICBjb25zdCBtYXRyaXggPSB0aGlzLmRhdGE7CiAgICAgIG1hdHJpeC5sZW5ndGggPSAwOwogICAgICB0aGlzLmVsZW1lbnRTaXplID0gTWF0aC5hYnMoeCkgLyBpbWFnZURhdGEud2lkdGg7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGltYWdlRGF0YS5oZWlnaHQ7IGkrKykgewogICAgICAgIGNvbnN0IHJvdyA9IFtdOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGltYWdlRGF0YS53aWR0aDsgaisrKSB7CiAgICAgICAgICBjb25zdCBhID0gaW1hZ2VEYXRhLmRhdGFbKGkgKiBpbWFnZURhdGEuaGVpZ2h0ICsgaikgKiA0XTsKICAgICAgICAgIGNvbnN0IGIgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAxXTsKICAgICAgICAgIGNvbnN0IGMgPSBpbWFnZURhdGEuZGF0YVsoaSAqIGltYWdlRGF0YS5oZWlnaHQgKyBqKSAqIDQgKyAyXTsKICAgICAgICAgIGNvbnN0IGhlaWdodCA9IChhICsgYiArIGMpIC8gNCAvIDI1NSAqIHo7CgogICAgICAgICAgaWYgKHggPCAwKSB7CiAgICAgICAgICAgIHJvdy5wdXNoKGhlaWdodCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByb3cudW5zaGlmdChoZWlnaHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHkgPCAwKSB7CiAgICAgICAgICBtYXRyaXgudW5zaGlmdChyb3cpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBtYXRyaXgucHVzaChyb3cpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVNYXhWYWx1ZSgpOwogICAgICB0aGlzLnVwZGF0ZU1pblZhbHVlKCk7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICB9CgogIH0KCiAgY29uc3QgZ2V0SGVpZ2h0QXRfaWR4ID0gW107CiAgY29uc3QgZ2V0SGVpZ2h0QXRfd2VpZ2h0cyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0SGVpZ2h0QXRfYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0SGVpZ2h0QXRfYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0SGVpZ2h0QXRfYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfYSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfYiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfYyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0Tm9ybWFsQXRfZTAgPSBuZXcgVmVjMygpOwogIGNvbnN0IGdldE5vcm1hbEF0X2UxID0gbmV3IFZlYzMoKTsgLy8gZnJvbSBodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CYXJ5Y2VudHJpY19jb29yZGluYXRlX3N5c3RlbQoKICBmdW5jdGlvbiBiYXJ5Y2VudHJpY1dlaWdodHMoeCwgeSwgYXgsIGF5LCBieCwgYnksIGN4LCBjeSwgcmVzdWx0KSB7CiAgICByZXN1bHQueCA9ICgoYnkgLSBjeSkgKiAoeCAtIGN4KSArIChjeCAtIGJ4KSAqICh5IC0gY3kpKSAvICgoYnkgLSBjeSkgKiAoYXggLSBjeCkgKyAoY3ggLSBieCkgKiAoYXkgLSBjeSkpOwogICAgcmVzdWx0LnkgPSAoKGN5IC0gYXkpICogKHggLSBjeCkgKyAoYXggLSBjeCkgKiAoeSAtIGN5KSkgLyAoKGJ5IC0gY3kpICogKGF4IC0gY3gpICsgKGN4IC0gYngpICogKGF5IC0gY3kpKTsKICAgIHJlc3VsdC56ID0gMSAtIHJlc3VsdC54IC0gcmVzdWx0Lnk7CiAgfQogIC8qKgogICAqIE9jdHJlZU5vZGUKICAgKi8KCgogIGNsYXNzIE9jdHJlZU5vZGUgewogICAgLyoqIFRoZSByb290IG5vZGUgKi8KCiAgICAvKiogQm91bmRhcnkgb2YgdGhpcyBub2RlICovCgogICAgLyoqIENvbnRhaW5lZCBkYXRhIGF0IHRoZSBjdXJyZW50IG5vZGUgbGV2ZWwgKi8KCiAgICAvKiogQ2hpbGRyZW4gdG8gdGhpcyBub2RlICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgdGhpcy5yb290ID0gdm9pZCAwOwogICAgICB0aGlzLmFhYmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGF0YSA9IHZvaWQgMDsKICAgICAgdGhpcy5jaGlsZHJlbiA9IHZvaWQgMDsKICAgICAgdGhpcy5yb290ID0gb3B0aW9ucy5yb290IHx8IG51bGw7CiAgICAgIHRoaXMuYWFiYiA9IG9wdGlvbnMuYWFiYiA/IG9wdGlvbnMuYWFiYi5jbG9uZSgpIDogbmV3IEFBQkIoKTsKICAgICAgdGhpcy5kYXRhID0gW107CiAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTsKICAgIH0KICAgIC8qKgogICAgICogcmVzZXQKICAgICAqLwoKCiAgICByZXNldCgpIHsKICAgICAgdGhpcy5jaGlsZHJlbi5sZW5ndGggPSB0aGlzLmRhdGEubGVuZ3RoID0gMDsKICAgIH0KICAgIC8qKgogICAgICogSW5zZXJ0IGRhdGEgaW50byB0aGlzIG5vZGUKICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBzdWNjZXNzZnVsLCBvdGhlcndpc2UgZmFsc2UKICAgICAqLwoKCiAgICBpbnNlcnQoYWFiYiwgZWxlbWVudERhdGEsIGxldmVsID0gMCkgewogICAgICBjb25zdCBub2RlRGF0YSA9IHRoaXMuZGF0YTsgLy8gSWdub3JlIG9iamVjdHMgdGhhdCBkbyBub3QgYmVsb25nIGluIHRoaXMgbm9kZQoKICAgICAgaWYgKCF0aGlzLmFhYmIuY29udGFpbnMoYWFiYikpIHsKICAgICAgICByZXR1cm4gZmFsc2U7IC8vIG9iamVjdCBjYW5ub3QgYmUgYWRkZWQKICAgICAgfQoKICAgICAgY29uc3QgY2hpbGRyZW4gPSB0aGlzLmNoaWxkcmVuOwogICAgICBjb25zdCBtYXhEZXB0aCA9IHRoaXMubWF4RGVwdGggfHwgdGhpcy5yb290Lm1heERlcHRoOwoKICAgICAgaWYgKGxldmVsIDwgbWF4RGVwdGgpIHsKICAgICAgICAvLyBTdWJkaXZpZGUgaWYgdGhlcmUgYXJlIG5vIGNoaWxkcmVuIHlldAogICAgICAgIGxldCBzdWJkaXZpZGVkID0gZmFsc2U7CgogICAgICAgIGlmICghY2hpbGRyZW4ubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLnN1YmRpdmlkZSgpOwogICAgICAgICAgc3ViZGl2aWRlZCA9IHRydWU7CiAgICAgICAgfSAvLyBhZGQgdG8gd2hpY2hldmVyIG5vZGUgd2lsbCBhY2NlcHQgaXQKCgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSA4OyBpKyspIHsKICAgICAgICAgIGlmIChjaGlsZHJlbltpXS5pbnNlcnQoYWFiYiwgZWxlbWVudERhdGEsIGxldmVsICsgMSkpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoc3ViZGl2aWRlZCkgewogICAgICAgICAgLy8gTm8gY2hpbGRyZW4gYWNjZXB0ZWQhIE1pZ2h0IGFzIHdlbGwganVzdCByZW1vdmUgZW0gc2luY2UgdGhleSBjb250YWluIG5vbmUKICAgICAgICAgIGNoaWxkcmVuLmxlbmd0aCA9IDA7CiAgICAgICAgfQogICAgICB9IC8vIFRvbyBkZWVwLCBvciBjaGlsZHJlbiBkaWRudCB3YW50IGl0LiBhZGQgaXQgaW4gY3VycmVudCBub2RlCgoKICAgICAgbm9kZURhdGEucHVzaChlbGVtZW50RGF0YSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqCiAgICAgKiBDcmVhdGUgOCBlcXVhbGx5IHNpemVkIGNoaWxkcmVuIG5vZGVzIGFuZCBwdXQgdGhlbSBpbiB0aGUgYGNoaWxkcmVuYCBhcnJheS4KICAgICAqLwoKCiAgICBzdWJkaXZpZGUoKSB7CiAgICAgIGNvbnN0IGFhYmIgPSB0aGlzLmFhYmI7CiAgICAgIGNvbnN0IGwgPSBhYWJiLmxvd2VyQm91bmQ7CiAgICAgIGNvbnN0IHUgPSBhYWJiLnVwcGVyQm91bmQ7CiAgICAgIGNvbnN0IGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbjsKICAgICAgY2hpbGRyZW4ucHVzaChuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMCwgMCwgMCkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDEsIDAsIDApCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygxLCAxLCAwKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMSwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDEsIDEpCiAgICAgICAgfSkKICAgICAgfSksIG5ldyBPY3RyZWVOb2RlKHsKICAgICAgICBhYWJiOiBuZXcgQUFCQih7CiAgICAgICAgICBsb3dlckJvdW5kOiBuZXcgVmVjMygwLCAwLCAxKQogICAgICAgIH0pCiAgICAgIH0pLCBuZXcgT2N0cmVlTm9kZSh7CiAgICAgICAgYWFiYjogbmV3IEFBQkIoewogICAgICAgICAgbG93ZXJCb3VuZDogbmV3IFZlYzMoMSwgMCwgMSkKICAgICAgICB9KQogICAgICB9KSwgbmV3IE9jdHJlZU5vZGUoewogICAgICAgIGFhYmI6IG5ldyBBQUJCKHsKICAgICAgICAgIGxvd2VyQm91bmQ6IG5ldyBWZWMzKDAsIDEsIDApCiAgICAgICAgfSkKICAgICAgfSkpOwogICAgICB1LnZzdWIobCwgaGFsZkRpYWdvbmFsKTsKICAgICAgaGFsZkRpYWdvbmFsLnNjYWxlKDAuNSwgaGFsZkRpYWdvbmFsKTsKICAgICAgY29uc3Qgcm9vdCA9IHRoaXMucm9vdCB8fCB0aGlzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IDg7IGkrKykgewogICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07IC8vIFNldCBjdXJyZW50IG5vZGUgYXMgcm9vdAoKICAgICAgICBjaGlsZC5yb290ID0gcm9vdDsgLy8gQ29tcHV0ZSBib3VuZHMKCiAgICAgICAgY29uc3QgbG93ZXJCb3VuZCA9IGNoaWxkLmFhYmIubG93ZXJCb3VuZDsKICAgICAgICBsb3dlckJvdW5kLnggKj0gaGFsZkRpYWdvbmFsLng7CiAgICAgICAgbG93ZXJCb3VuZC55ICo9IGhhbGZEaWFnb25hbC55OwogICAgICAgIGxvd2VyQm91bmQueiAqPSBoYWxmRGlhZ29uYWwuejsKICAgICAgICBsb3dlckJvdW5kLnZhZGQobCwgbG93ZXJCb3VuZCk7IC8vIFVwcGVyIGJvdW5kIGlzIGFsd2F5cyBsb3dlciBib3VuZCArIGhhbGZEaWFnb25hbAoKICAgICAgICBsb3dlckJvdW5kLnZhZGQoaGFsZkRpYWdvbmFsLCBjaGlsZC5hYWJiLnVwcGVyQm91bmQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbGwgZGF0YSwgcG90ZW50aWFsbHkgd2l0aGluIGFuIEFBQkIKICAgICAqIEByZXR1cm4gVGhlICJyZXN1bHQiIG9iamVjdAogICAgICovCgoKICAgIGFhYmJRdWVyeShhYWJiLCByZXN1bHQpIHsKICAgICAgdGhpcy5kYXRhOyAvLyBhYm9ydCBpZiB0aGUgcmFuZ2UgZG9lcyBub3QgaW50ZXJzZWN0IHRoaXMgbm9kZQogICAgICAvLyBpZiAoIXRoaXMuYWFiYi5vdmVybGFwcyhhYWJiKSl7CiAgICAgIC8vICAgICByZXR1cm4gcmVzdWx0OwogICAgICAvLyB9CiAgICAgIC8vIEFkZCBvYmplY3RzIGF0IHRoaXMgbGV2ZWwKICAgICAgLy8gQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkocmVzdWx0LCBub2RlRGF0YSk7CiAgICAgIC8vIEFkZCBjaGlsZCBkYXRhCiAgICAgIC8vIEB0b2RvIHVud3JhcCByZWN1cnNpb24gaW50byBhIHF1ZXVlIC8gbG9vcCwgdGhhdCdzIGZhc3RlciBpbiBKUwoKICAgICAgdGhpcy5jaGlsZHJlbjsgLy8gZm9yIChsZXQgaSA9IDAsIE4gPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgIC8vICAgICBjaGlsZHJlbltpXS5hYWJiUXVlcnkoYWFiYiwgcmVzdWx0KTsKICAgICAgLy8gfQoKICAgICAgY29uc3QgcXVldWUgPSBbdGhpc107CgogICAgICB3aGlsZSAocXVldWUubGVuZ3RoKSB7CiAgICAgICAgY29uc3Qgbm9kZSA9IHF1ZXVlLnBvcCgpOwoKICAgICAgICBpZiAobm9kZS5hYWJiLm92ZXJsYXBzKGFhYmIpKSB7CiAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShyZXN1bHQsIG5vZGUuZGF0YSk7CiAgICAgICAgfQoKICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShxdWV1ZSwgbm9kZS5jaGlsZHJlbik7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbGwgZGF0YSwgcG90ZW50aWFsbHkgaW50ZXJzZWN0ZWQgYnkgYSByYXkuCiAgICAgKiBAcmV0dXJuIFRoZSAicmVzdWx0IiBvYmplY3QKICAgICAqLwoKCiAgICByYXlRdWVyeShyYXksIHRyZWVUcmFuc2Zvcm0sIHJlc3VsdCkgewogICAgICAvLyBVc2UgYWFiYiBxdWVyeSBmb3Igbm93LgoKICAgICAgLyoqIEB0b2RvIGltcGxlbWVudCByZWFsIHJheSBxdWVyeSB3aGljaCBuZWVkcyBsZXNzIGxvb2t1cHMgKi8KICAgICAgcmF5LmdldEFBQkIodG1wQUFCQik7CiAgICAgIHRtcEFBQkIudG9Mb2NhbEZyYW1lKHRyZWVUcmFuc2Zvcm0sIHRtcEFBQkIpOwogICAgICB0aGlzLmFhYmJRdWVyeSh0bXBBQUJCLCByZXN1bHQpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfQogICAgLyoqCiAgICAgKiByZW1vdmVFbXB0eU5vZGVzCiAgICAgKi8KCgogICAgcmVtb3ZlRW1wdHlOb2RlcygpIHsKICAgICAgZm9yIChsZXQgaSA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICB0aGlzLmNoaWxkcmVuW2ldLnJlbW92ZUVtcHR5Tm9kZXMoKTsKCiAgICAgICAgaWYgKCF0aGlzLmNoaWxkcmVuW2ldLmNoaWxkcmVuLmxlbmd0aCAmJiAhdGhpcy5jaGlsZHJlbltpXS5kYXRhLmxlbmd0aCkgewogICAgICAgICAgdGhpcy5jaGlsZHJlbi5zcGxpY2UoaSwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogIH0KICAvKioKICAgKiBPY3RyZWUKICAgKi8KCgogIGNsYXNzIE9jdHJlZSBleHRlbmRzIE9jdHJlZU5vZGUgewogICAgLyoqCiAgICAgKiBNYXhpbXVtIHN1YmRpdmlzaW9uIGRlcHRoCiAgICAgKiBAZGVmYXVsdCA4CiAgICAgKi8KCiAgICAvKioKICAgICAqIEBwYXJhbSBhYWJiIFRoZSB0b3RhbCBBQUJCIG9mIHRoZSB0cmVlCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKGFhYmIsIG9wdGlvbnMgPSB7fSkgewogICAgICBzdXBlcih7CiAgICAgICAgcm9vdDogbnVsbCwKICAgICAgICBhYWJiCiAgICAgIH0pOwogICAgICB0aGlzLm1heERlcHRoID0gdm9pZCAwOwogICAgICB0aGlzLm1heERlcHRoID0gdHlwZW9mIG9wdGlvbnMubWF4RGVwdGggIT09ICd1bmRlZmluZWQnID8gb3B0aW9ucy5tYXhEZXB0aCA6IDg7CiAgICB9CgogIH0KCiAgY29uc3QgaGFsZkRpYWdvbmFsID0gbmV3IFZlYzMoKTsKICBjb25zdCB0bXBBQUJCID0gbmV3IEFBQkIoKTsKICAvKioKICAgKiBUcmltZXNoLgogICAqIEBleGFtcGxlCiAgICogICAgIC8vIEhvdyB0byBtYWtlIGEgbWVzaCB3aXRoIGEgc2luZ2xlIHRyaWFuZ2xlCiAgICogICAgIGNvbnN0IHZlcnRpY2VzID0gWwogICAqICAgICAgICAgMCwgMCwgMCwgLy8gdmVydGV4IDAKICAgKiAgICAgICAgIDEsIDAsIDAsIC8vIHZlcnRleCAxCiAgICogICAgICAgICAwLCAxLCAwICAvLyB2ZXJ0ZXggMgogICAqICAgICBdCiAgICogICAgIGNvbnN0IGluZGljZXMgPSBbCiAgICogICAgICAgICAwLCAxLCAyICAvLyB0cmlhbmdsZSAwCiAgICogICAgIF0KICAgKiAgICAgY29uc3QgdHJpbWVzaFNoYXBlID0gbmV3IENBTk5PTi5UcmltZXNoKHZlcnRpY2VzLCBpbmRpY2VzKQogICAqLwoKICBjbGFzcyBUcmltZXNoIGV4dGVuZHMgU2hhcGUgewogICAgLyoqCiAgICAgKiB2ZXJ0aWNlcwogICAgICovCgogICAgLyoqCiAgICAgKiBBcnJheSBvZiBpbnRlZ2VycywgaW5kaWNhdGluZyB3aGljaCB2ZXJ0aWNlcyBlYWNoIHRyaWFuZ2xlIGNvbnNpc3RzIG9mLiBUaGUgbGVuZ3RoIG9mIHRoaXMgYXJyYXkgaXMgdGh1cyAzIHRpbWVzIHRoZSBudW1iZXIgb2YgdHJpYW5nbGVzLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgbm9ybWFscyBkYXRhLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgbG9jYWwgQUFCQiBvZiB0aGUgbWVzaC4KICAgICAqLwoKICAgIC8qKgogICAgICogUmVmZXJlbmNlcyB0byB2ZXJ0ZXggcGFpcnMsIG1ha2luZyB1cCBhbGwgdW5pcXVlIGVkZ2VzIGluIHRoZSB0cmltZXNoLgogICAgICovCgogICAgLyoqCiAgICAgKiBMb2NhbCBzY2FsaW5nIG9mIHRoZSBtZXNoLiBVc2UgLnNldFNjYWxlKCkgdG8gc2V0IGl0LgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgaW5kZXhlZCB0cmlhbmdsZXMuIFVzZSAudXBkYXRlVHJlZSgpIHRvIHVwZGF0ZSBpdC4KICAgICAqLwogICAgY29uc3RydWN0b3IodmVydGljZXMsIGluZGljZXMpIHsKICAgICAgc3VwZXIoewogICAgICAgIHR5cGU6IFNoYXBlLnR5cGVzLlRSSU1FU0gKICAgICAgfSk7CiAgICAgIHRoaXMudmVydGljZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuaW5kaWNlcyA9IHZvaWQgMDsKICAgICAgdGhpcy5ub3JtYWxzID0gdm9pZCAwOwogICAgICB0aGlzLmFhYmIgPSB2b2lkIDA7CiAgICAgIHRoaXMuZWRnZXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuc2NhbGUgPSB2b2lkIDA7CiAgICAgIHRoaXMudHJlZSA9IHZvaWQgMDsKICAgICAgdGhpcy52ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkodmVydGljZXMpOwogICAgICB0aGlzLmluZGljZXMgPSBuZXcgSW50MTZBcnJheShpbmRpY2VzKTsKICAgICAgdGhpcy5ub3JtYWxzID0gbmV3IEZsb2F0MzJBcnJheShpbmRpY2VzLmxlbmd0aCk7CiAgICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7CiAgICAgIHRoaXMuZWRnZXMgPSBudWxsOwogICAgICB0aGlzLnNjYWxlID0gbmV3IFZlYzMoMSwgMSwgMSk7CiAgICAgIHRoaXMudHJlZSA9IG5ldyBPY3RyZWUoKTsKICAgICAgdGhpcy51cGRhdGVFZGdlcygpOwogICAgICB0aGlzLnVwZGF0ZU5vcm1hbHMoKTsKICAgICAgdGhpcy51cGRhdGVBQUJCKCk7CiAgICAgIHRoaXMudXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKTsKICAgICAgdGhpcy51cGRhdGVUcmVlKCk7CiAgICB9CiAgICAvKioKICAgICAqIHVwZGF0ZVRyZWUKICAgICAqLwoKCiAgICB1cGRhdGVUcmVlKCkgewogICAgICBjb25zdCB0cmVlID0gdGhpcy50cmVlOwogICAgICB0cmVlLnJlc2V0KCk7CiAgICAgIHRyZWUuYWFiYi5jb3B5KHRoaXMuYWFiYik7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsgLy8gVGhlIGxvY2FsIG1lc2ggQUFCQiBpcyBzY2FsZWQsIGJ1dCB0aGUgb2N0cmVlIEFBQkIgc2hvdWxkIGJlIHVuc2NhbGVkCgogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIubG93ZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC54ICo9IDEgLyBzY2FsZS54OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC55ICo9IDEgLyBzY2FsZS55OwogICAgICB0cmVlLmFhYmIudXBwZXJCb3VuZC56ICo9IDEgLyBzY2FsZS56OyAvLyBJbnNlcnQgYWxsIHRyaWFuZ2xlcwoKICAgICAgY29uc3QgdHJpYW5nbGVBQUJCID0gbmV3IEFBQkIoKTsKICAgICAgY29uc3QgYSA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IGIgPSBuZXcgVmVjMygpOwogICAgICBjb25zdCBjID0gbmV3IFZlYzMoKTsKICAgICAgY29uc3QgcG9pbnRzID0gW2EsIGIsIGNdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy90aGlzLmdldFRyaWFuZ2xlVmVydGljZXMoaSwgYSwgYiwgYyk7CiAgICAgICAgLy8gR2V0IHVuc2NhbGVkIHRyaWFuZ2xlIHZlcnRzCiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzXSwgYSk7CgogICAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDFdLCBiKTsKCiAgICAgICAgdGhpcy5fZ2V0VW5zY2FsZWRWZXJ0ZXgodGhpcy5pbmRpY2VzW2kzICsgMl0sIGMpOwoKICAgICAgICB0cmlhbmdsZUFBQkIuc2V0RnJvbVBvaW50cyhwb2ludHMpOwogICAgICAgIHRyZWUuaW5zZXJ0KHRyaWFuZ2xlQUFCQiwgaSk7CiAgICAgIH0KCiAgICAgIHRyZWUucmVtb3ZlRW1wdHlOb2RlcygpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdHJpYW5nbGVzIGluIGEgbG9jYWwgQUFCQiBmcm9tIHRoZSB0cmltZXNoLgogICAgICogQHBhcmFtIHJlc3VsdCBBbiBhcnJheSBvZiBpbnRlZ2VycywgcmVmZXJlbmNpbmcgdGhlIHF1ZXJpZWQgdHJpYW5nbGVzLgogICAgICovCgoKICAgIGdldFRyaWFuZ2xlc0luQUFCQihhYWJiLCByZXN1bHQpIHsKICAgICAgdW5zY2FsZWRBQUJCLmNvcHkoYWFiYik7IC8vIFNjYWxlIGl0IHRvIGxvY2FsCgogICAgICBjb25zdCBzY2FsZSA9IHRoaXMuc2NhbGU7CiAgICAgIGNvbnN0IGlzeCA9IHNjYWxlLng7CiAgICAgIGNvbnN0IGlzeSA9IHNjYWxlLnk7CiAgICAgIGNvbnN0IGlzeiA9IHNjYWxlLno7CiAgICAgIGNvbnN0IGwgPSB1bnNjYWxlZEFBQkIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IHVuc2NhbGVkQUFCQi51cHBlckJvdW5kOwogICAgICBsLnggLz0gaXN4OwogICAgICBsLnkgLz0gaXN5OwogICAgICBsLnogLz0gaXN6OwogICAgICB1LnggLz0gaXN4OwogICAgICB1LnkgLz0gaXN5OwogICAgICB1LnogLz0gaXN6OwogICAgICByZXR1cm4gdGhpcy50cmVlLmFhYmJRdWVyeSh1bnNjYWxlZEFBQkIsIHJlc3VsdCk7CiAgICB9CiAgICAvKioKICAgICAqIHNldFNjYWxlCiAgICAgKi8KCgogICAgc2V0U2NhbGUoc2NhbGUpIHsKICAgICAgY29uc3Qgd2FzVW5pZm9ybSA9IHRoaXMuc2NhbGUueCA9PT0gdGhpcy5zY2FsZS55ICYmIHRoaXMuc2NhbGUueSA9PT0gdGhpcy5zY2FsZS56OwogICAgICBjb25zdCBpc1VuaWZvcm0gPSBzY2FsZS54ID09PSBzY2FsZS55ICYmIHNjYWxlLnkgPT09IHNjYWxlLno7CgogICAgICBpZiAoISh3YXNVbmlmb3JtICYmIGlzVW5pZm9ybSkpIHsKICAgICAgICAvLyBOb24tdW5pZm9ybSBzY2FsaW5nLiBOZWVkIHRvIHVwZGF0ZSBub3JtYWxzLgogICAgICAgIHRoaXMudXBkYXRlTm9ybWFscygpOwogICAgICB9CgogICAgICB0aGlzLnNjYWxlLmNvcHkoc2NhbGUpOwogICAgICB0aGlzLnVwZGF0ZUFBQkIoKTsKICAgICAgdGhpcy51cGRhdGVCb3VuZGluZ1NwaGVyZVJhZGl1cygpOwogICAgfQogICAgLyoqCiAgICAgKiBDb21wdXRlIHRoZSBub3JtYWxzIG9mIHRoZSBmYWNlcy4gV2lsbCBzYXZlIGluIHRoZSBgLm5vcm1hbHNgIGFycmF5LgogICAgICovCgoKICAgIHVwZGF0ZU5vcm1hbHMoKSB7CiAgICAgIGNvbnN0IG4gPSBjb21wdXRlTm9ybWFsc19uOyAvLyBHZW5lcmF0ZSBub3JtYWxzCgogICAgICBjb25zdCBub3JtYWxzID0gdGhpcy5ub3JtYWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIHRoaXMuZ2V0VmVydGV4KGEsIHZhKTsKICAgICAgICB0aGlzLmdldFZlcnRleChiLCB2Yik7CiAgICAgICAgdGhpcy5nZXRWZXJ0ZXgoYywgdmMpOwogICAgICAgIFRyaW1lc2guY29tcHV0ZU5vcm1hbCh2YiwgdmEsIHZjLCBuKTsKICAgICAgICBub3JtYWxzW2kzXSA9IG4ueDsKICAgICAgICBub3JtYWxzW2kzICsgMV0gPSBuLnk7CiAgICAgICAgbm9ybWFsc1tpMyArIDJdID0gbi56OwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgYC5lZGdlc2AgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVFZGdlcygpIHsKICAgICAgY29uc3QgZWRnZXMgPSB7fTsKCiAgICAgIGNvbnN0IGFkZCA9IChhLCBiKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gYSA8IGIgPyBhICsgIl8iICsgYiA6IGIgKyAiXyIgKyBhOwogICAgICAgIGVkZ2VzW2tleV0gPSB0cnVlOwogICAgICB9OwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgY29uc3QgaTMgPSBpICogMzsKICAgICAgICBjb25zdCBhID0gdGhpcy5pbmRpY2VzW2kzXTsKICAgICAgICBjb25zdCBiID0gdGhpcy5pbmRpY2VzW2kzICsgMV07CiAgICAgICAgY29uc3QgYyA9IHRoaXMuaW5kaWNlc1tpMyArIDJdOwogICAgICAgIGFkZChhLCBiKTsKICAgICAgICBhZGQoYiwgYyk7CiAgICAgICAgYWRkKGMsIGEpOwogICAgICB9CgogICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoZWRnZXMpOwogICAgICB0aGlzLmVkZ2VzID0gbmV3IEludDE2QXJyYXkoa2V5cy5sZW5ndGggKiAyKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IGluZGljZXMgPSBrZXlzW2ldLnNwbGl0KCdfJyk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaV0gPSBwYXJzZUludChpbmRpY2VzWzBdLCAxMCk7CiAgICAgICAgdGhpcy5lZGdlc1syICogaSArIDFdID0gcGFyc2VJbnQoaW5kaWNlc1sxXSwgMTApOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBlZGdlIHZlcnRleAogICAgICogQHBhcmFtIGZpcnN0T3JTZWNvbmQgMCBvciAxLCBkZXBlbmRpbmcgb24gd2hpY2ggb25lIG9mIHRoZSB2ZXJ0aWNlcyB5b3UgbmVlZC4KICAgICAqIEBwYXJhbSB2ZXJ0ZXhTdG9yZSBXaGVyZSB0byBzdG9yZSB0aGUgcmVzdWx0CiAgICAgKi8KCgogICAgZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIGZpcnN0T3JTZWNvbmQsIHZlcnRleFN0b3JlKSB7CiAgICAgIGNvbnN0IHZlcnRleEluZGV4ID0gdGhpcy5lZGdlc1tlZGdlSW5kZXggKiAyICsgKGZpcnN0T3JTZWNvbmQgPyAxIDogMCldOwogICAgICB0aGlzLmdldFZlcnRleCh2ZXJ0ZXhJbmRleCwgdmVydGV4U3RvcmUpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgYSB2ZWN0b3IgYWxvbmcgYW4gZWRnZS4KICAgICAqLwoKCiAgICBnZXRFZGdlVmVjdG9yKGVkZ2VJbmRleCwgdmVjdG9yU3RvcmUpIHsKICAgICAgY29uc3QgdmEgPSBnZXRFZGdlVmVjdG9yX3ZhOwogICAgICBjb25zdCB2YiA9IGdldEVkZ2VWZWN0b3JfdmI7CiAgICAgIHRoaXMuZ2V0RWRnZVZlcnRleChlZGdlSW5kZXgsIDAsIHZhKTsKICAgICAgdGhpcy5nZXRFZGdlVmVydGV4KGVkZ2VJbmRleCwgMSwgdmIpOwogICAgICB2Yi52c3ViKHZhLCB2ZWN0b3JTdG9yZSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBmYWNlIG5vcm1hbCBnaXZlbiAzIHZlcnRpY2VzCiAgICAgKi8KCgogICAgc3RhdGljIGNvbXB1dGVOb3JtYWwodmEsIHZiLCB2YywgdGFyZ2V0KSB7CiAgICAgIHZiLnZzdWIodmEsIGFiKTsKICAgICAgdmMudnN1Yih2YiwgY2IpOwogICAgICBjYi5jcm9zcyhhYiwgdGFyZ2V0KTsKCiAgICAgIGlmICghdGFyZ2V0LmlzWmVybygpKSB7CiAgICAgICAgdGFyZ2V0Lm5vcm1hbGl6ZSgpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEdldCB2ZXJ0ZXggaS4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRWZXJ0ZXgoaSwgb3V0KSB7CiAgICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zY2FsZTsKCiAgICAgIHRoaXMuX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCk7CgogICAgICBvdXQueCAqPSBzY2FsZS54OwogICAgICBvdXQueSAqPSBzY2FsZS55OwogICAgICBvdXQueiAqPSBzY2FsZS56OwogICAgICByZXR1cm4gb3V0OwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgcmF3IHZlcnRleCBpCiAgICAgKiBAcmV0dXJuIFRoZSAib3V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgX2dldFVuc2NhbGVkVmVydGV4KGksIG91dCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIHJldHVybiBvdXQuc2V0KHZlcnRpY2VzW2kzXSwgdmVydGljZXNbaTMgKyAxXSwgdmVydGljZXNbaTMgKyAyXSk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhIHZlcnRleCBmcm9tIHRoZSB0cmltZXNoLHRyYW5zZm9ybWVkIGJ5IHRoZSBnaXZlbiBwb3NpdGlvbiBhbmQgcXVhdGVybmlvbi4KICAgICAqIEByZXR1cm4gVGhlICJvdXQiIHZlY3RvciBvYmplY3QKICAgICAqLwoKCiAgICBnZXRXb3JsZFZlcnRleChpLCBwb3MsIHF1YXQsIG91dCkgewogICAgICB0aGlzLmdldFZlcnRleChpLCBvdXQpOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUocG9zLCBxdWF0LCBvdXQsIG91dCk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgICAvKioKICAgICAqIEdldCB0aGUgdGhyZWUgdmVydGljZXMgZm9yIHRyaWFuZ2xlIGkuCiAgICAgKi8KCgogICAgZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCBhLCBiLCBjKSB7CiAgICAgIGNvbnN0IGkzID0gaSAqIDM7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpM10sIGEpOwogICAgICB0aGlzLmdldFZlcnRleCh0aGlzLmluZGljZXNbaTMgKyAxXSwgYik7CiAgICAgIHRoaXMuZ2V0VmVydGV4KHRoaXMuaW5kaWNlc1tpMyArIDJdLCBjKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbm9ybWFsIG9mIHRyaWFuZ2xlIGkuCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgZ2V0Tm9ybWFsKGksIHRhcmdldCkgewogICAgICBjb25zdCBpMyA9IGkgKiAzOwogICAgICByZXR1cm4gdGFyZ2V0LnNldCh0aGlzLm5vcm1hbHNbaTNdLCB0aGlzLm5vcm1hbHNbaTMgKyAxXSwgdGhpcy5ub3JtYWxzW2kzICsgMl0pOwogICAgfQogICAgLyoqCiAgICAgKiBAcmV0dXJuIFRoZSAidGFyZ2V0IiB2ZWN0b3Igb2JqZWN0CiAgICAgKi8KCgogICAgY2FsY3VsYXRlTG9jYWxJbmVydGlhKG1hc3MsIHRhcmdldCkgewogICAgICAvLyBBcHByb3hpbWF0ZSB3aXRoIGJveCBpbmVydGlhCiAgICAgIC8vIEV4YWN0IGluZXJ0aWEgY2FsY3VsYXRpb24gaXMgb3ZlcmtpbGwsIGJ1dCBzZWUgaHR0cDovL2dlb21ldHJpY3Rvb2xzLmNvbS9Eb2N1bWVudGF0aW9uL1BvbHloZWRyYWxNYXNzUHJvcGVydGllcy5wZGYgZm9yIHRoZSBjb3JyZWN0IHdheSB0byBkbyBpdAogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIoY2xpX2FhYmIpOwogICAgICBjb25zdCB4ID0gY2xpX2FhYmIudXBwZXJCb3VuZC54IC0gY2xpX2FhYmIubG93ZXJCb3VuZC54OwogICAgICBjb25zdCB5ID0gY2xpX2FhYmIudXBwZXJCb3VuZC55IC0gY2xpX2FhYmIubG93ZXJCb3VuZC55OwogICAgICBjb25zdCB6ID0gY2xpX2FhYmIudXBwZXJCb3VuZC56IC0gY2xpX2FhYmIubG93ZXJCb3VuZC56OwogICAgICByZXR1cm4gdGFyZ2V0LnNldCgxLjAgLyAxMi4wICogbWFzcyAqICgyICogeSAqIDIgKiB5ICsgMiAqIHogKiAyICogeiksIDEuMCAvIDEyLjAgKiBtYXNzICogKDIgKiB4ICogMiAqIHggKyAyICogeiAqIDIgKiB6KSwgMS4wIC8gMTIuMCAqIG1hc3MgKiAoMiAqIHkgKiAyICogeSArIDIgKiB4ICogMiAqIHgpKTsKICAgIH0KICAgIC8qKgogICAgICogQ29tcHV0ZSB0aGUgbG9jYWwgQUFCQiBmb3IgdGhlIHRyaW1lc2gKICAgICAqLwoKCiAgICBjb21wdXRlTG9jYWxBQUJCKGFhYmIpIHsKICAgICAgY29uc3QgbCA9IGFhYmIubG93ZXJCb3VuZDsKICAgICAgY29uc3QgdSA9IGFhYmIudXBwZXJCb3VuZDsKICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoOwogICAgICB0aGlzLnZlcnRpY2VzOwogICAgICBjb25zdCB2ID0gY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQ7CiAgICAgIHRoaXMuZ2V0VmVydGV4KDAsIHYpOwogICAgICBsLmNvcHkodik7CiAgICAgIHUuY29weSh2KTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBuOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKCiAgICAgICAgaWYgKHYueCA8IGwueCkgewogICAgICAgICAgbC54ID0gdi54OwogICAgICAgIH0gZWxzZSBpZiAodi54ID4gdS54KSB7CiAgICAgICAgICB1LnggPSB2Lng7CiAgICAgICAgfQoKICAgICAgICBpZiAodi55IDwgbC55KSB7CiAgICAgICAgICBsLnkgPSB2Lnk7CiAgICAgICAgfSBlbHNlIGlmICh2LnkgPiB1LnkpIHsKICAgICAgICAgIHUueSA9IHYueTsKICAgICAgICB9CgogICAgICAgIGlmICh2LnogPCBsLnopIHsKICAgICAgICAgIGwueiA9IHYuejsKICAgICAgICB9IGVsc2UgaWYgKHYueiA+IHUueikgewogICAgICAgICAgdS56ID0gdi56OwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBVcGRhdGUgdGhlIGAuYWFiYmAgcHJvcGVydHkKICAgICAqLwoKCiAgICB1cGRhdGVBQUJCKCkgewogICAgICB0aGlzLmNvbXB1dGVMb2NhbEFBQkIodGhpcy5hYWJiKTsKICAgIH0KICAgIC8qKgogICAgICogV2lsbCB1cGRhdGUgdGhlIGAuYm91bmRpbmdTcGhlcmVSYWRpdXNgIHByb3BlcnR5CiAgICAgKi8KCgogICAgdXBkYXRlQm91bmRpbmdTcGhlcmVSYWRpdXMoKSB7CiAgICAgIC8vIEFzc3VtZSBwb2ludHMgYXJlIGRpc3RyaWJ1dGVkIHdpdGggbG9jYWwgKDAsMCwwKSBhcyBjZW50ZXIKICAgICAgbGV0IG1heDIgPSAwOwogICAgICBjb25zdCB2ZXJ0aWNlcyA9IHRoaXMudmVydGljZXM7CiAgICAgIGNvbnN0IHYgPSBuZXcgVmVjMygpOwoKICAgICAgZm9yIChsZXQgaSA9IDAsIE4gPSB2ZXJ0aWNlcy5sZW5ndGggLyAzOyBpICE9PSBOOyBpKyspIHsKICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICBjb25zdCBub3JtMiA9IHYubGVuZ3RoU3F1YXJlZCgpOwoKICAgICAgICBpZiAobm9ybTIgPiBtYXgyKSB7CiAgICAgICAgICBtYXgyID0gbm9ybTI7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmJvdW5kaW5nU3BoZXJlUmFkaXVzID0gTWF0aC5zcXJ0KG1heDIpOwogICAgfQogICAgLyoqCiAgICAgKiBjYWxjdWxhdGVXb3JsZEFBQkIKICAgICAqLwoKCiAgICBjYWxjdWxhdGVXb3JsZEFBQkIocG9zLCBxdWF0LCBtaW4sIG1heCkgewogICAgICAvKgogICAgICAgICAgY29uc3QgbiA9IHRoaXMudmVydGljZXMubGVuZ3RoIC8gMywKICAgICAgICAgICAgICB2ZXJ0cyA9IHRoaXMudmVydGljZXM7CiAgICAgICAgICBjb25zdCBtaW54LG1pbnksbWlueixtYXh4LG1heHksbWF4ejsKICAgICAgICAgICBjb25zdCB2ID0gdGVtcFdvcmxkVmVydGV4OwogICAgICAgICAgZm9yKGxldCBpPTA7IGk8bjsgaSsrKXsKICAgICAgICAgICAgICB0aGlzLmdldFZlcnRleChpLCB2KTsKICAgICAgICAgICAgICBxdWF0LnZtdWx0KHYsIHYpOwogICAgICAgICAgICAgIHBvcy52YWRkKHYsIHYpOwogICAgICAgICAgICAgIGlmICh2LnggPCBtaW54IHx8IG1pbng9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtaW54ID0gdi54OwogICAgICAgICAgICAgIH0gZWxzZSBpZih2LnggPiBtYXh4IHx8IG1heHg9PT11bmRlZmluZWQpewogICAgICAgICAgICAgICAgICBtYXh4ID0gdi54OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgaWYgKHYueSA8IG1pbnkgfHwgbWlueT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1pbnkgPSB2Lnk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmKHYueSA+IG1heHkgfHwgbWF4eT09PXVuZGVmaW5lZCl7CiAgICAgICAgICAgICAgICAgIG1heHkgPSB2Lnk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBpZiAodi56IDwgbWlueiB8fCBtaW56PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWlueiA9IHYuejsKICAgICAgICAgICAgICB9IGVsc2UgaWYodi56ID4gbWF4eiB8fCBtYXh6PT09dW5kZWZpbmVkKXsKICAgICAgICAgICAgICAgICAgbWF4eiA9IHYuejsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBtaW4uc2V0KG1pbngsbWlueSxtaW56KTsKICAgICAgICAgIG1heC5zZXQobWF4eCxtYXh5LG1heHopOwogICAgICAgICAgKi8KICAgICAgLy8gRmFzdGVyIGFwcHJveGltYXRpb24gdXNpbmcgbG9jYWwgQUFCQgogICAgICBjb25zdCBmcmFtZSA9IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZTsKICAgICAgY29uc3QgcmVzdWx0ID0gY2FsY3VsYXRlV29ybGRBQUJCX2FhYmI7CiAgICAgIGZyYW1lLnBvc2l0aW9uID0gcG9zOwogICAgICBmcmFtZS5xdWF0ZXJuaW9uID0gcXVhdDsKICAgICAgdGhpcy5hYWJiLnRvV29ybGRGcmFtZShmcmFtZSwgcmVzdWx0KTsKICAgICAgbWluLmNvcHkocmVzdWx0Lmxvd2VyQm91bmQpOwogICAgICBtYXguY29weShyZXN1bHQudXBwZXJCb3VuZCk7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhcHByb3hpbWF0ZSB2b2x1bWUKICAgICAqLwoKCiAgICB2b2x1bWUoKSB7CiAgICAgIHJldHVybiA0LjAgKiBNYXRoLlBJICogdGhpcy5ib3VuZGluZ1NwaGVyZVJhZGl1cyAvIDMuMDsKICAgIH0KICAgIC8qKgogICAgICogQ3JlYXRlIGEgVHJpbWVzaCBpbnN0YW5jZSwgc2hhcGVkIGFzIGEgdG9ydXMuCiAgICAgKi8KCgogICAgc3RhdGljIGNyZWF0ZVRvcnVzKHJhZGl1cyA9IDEsIHR1YmUgPSAwLjUsIHJhZGlhbFNlZ21lbnRzID0gOCwgdHVidWxhclNlZ21lbnRzID0gNiwgYXJjID0gTWF0aC5QSSAqIDIpIHsKICAgICAgY29uc3QgdmVydGljZXMgPSBbXTsKICAgICAgY29uc3QgaW5kaWNlcyA9IFtdOwoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPD0gcmFkaWFsU2VnbWVudHM7IGorKykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHR1YnVsYXJTZWdtZW50czsgaSsrKSB7CiAgICAgICAgICBjb25zdCB1ID0gaSAvIHR1YnVsYXJTZWdtZW50cyAqIGFyYzsKICAgICAgICAgIGNvbnN0IHYgPSBqIC8gcmFkaWFsU2VnbWVudHMgKiBNYXRoLlBJICogMjsKICAgICAgICAgIGNvbnN0IHggPSAocmFkaXVzICsgdHViZSAqIE1hdGguY29zKHYpKSAqIE1hdGguY29zKHUpOwogICAgICAgICAgY29uc3QgeSA9IChyYWRpdXMgKyB0dWJlICogTWF0aC5jb3ModikpICogTWF0aC5zaW4odSk7CiAgICAgICAgICBjb25zdCB6ID0gdHViZSAqIE1hdGguc2luKHYpOwogICAgICAgICAgdmVydGljZXMucHVzaCh4LCB5LCB6KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGZvciAobGV0IGogPSAxOyBqIDw9IHJhZGlhbFNlZ21lbnRzOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSB0dWJ1bGFyU2VnbWVudHM7IGkrKykgewogICAgICAgICAgY29uc3QgYSA9ICh0dWJ1bGFyU2VnbWVudHMgKyAxKSAqIGogKyBpIC0gMTsKICAgICAgICAgIGNvbnN0IGIgPSAodHVidWxhclNlZ21lbnRzICsgMSkgKiAoaiAtIDEpICsgaSAtIDE7CiAgICAgICAgICBjb25zdCBjID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogKGogLSAxKSArIGk7CiAgICAgICAgICBjb25zdCBkID0gKHR1YnVsYXJTZWdtZW50cyArIDEpICogaiArIGk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYSwgYiwgZCk7CiAgICAgICAgICBpbmRpY2VzLnB1c2goYiwgYywgZCk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbmV3IFRyaW1lc2godmVydGljZXMsIGluZGljZXMpOwogICAgfQoKICB9CgogIGNvbnN0IGNvbXB1dGVOb3JtYWxzX24gPSBuZXcgVmVjMygpOwogIGNvbnN0IHVuc2NhbGVkQUFCQiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgZ2V0RWRnZVZlY3Rvcl92YiA9IG5ldyBWZWMzKCk7CiAgY29uc3QgY2IgPSBuZXcgVmVjMygpOwogIGNvbnN0IGFiID0gbmV3IFZlYzMoKTsKICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHZjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjbGlfYWFiYiA9IG5ldyBBQUJCKCk7CiAgY29uc3QgY29tcHV0ZUxvY2FsQUFCQl93b3JsZFZlcnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNhbGN1bGF0ZVdvcmxkQUFCQl9mcmFtZSA9IG5ldyBUcmFuc2Zvcm0oKTsKICBjb25zdCBjYWxjdWxhdGVXb3JsZEFBQkJfYWFiYiA9IG5ldyBBQUJCKCk7CiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBzb2x2ZXIgYmFzZSBjbGFzcy4KICAgKi8KCiAgY2xhc3MgU29sdmVyIHsKICAgIC8qKgogICAgICogQWxsIGVxdWF0aW9ucyB0byBiZSBzb2x2ZWQKICAgICAqLwoKICAgIC8qKgogICAgICogQHRvZG8gcmVtb3ZlIHVzZWxlc3MgY29uc3RydWN0b3IKICAgICAqLwogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMuZXF1YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLmVxdWF0aW9ucyA9IFtdOwogICAgfQogICAgLyoqCiAgICAgKiBTaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gc3ViY2xhc3NlcyEKICAgICAqIEB0b2RvIHVzZSBhYnN0cmFjdAogICAgICogQHJldHVybiBudW1iZXIgb2YgaXRlcmF0aW9ucyBwZXJmb3JtZWQKICAgICAqLwoKCiAgICBzb2x2ZShkdCwgd29ybGQpIHsKICAgICAgcmV0dXJuICgvLyBTaG91bGQgcmV0dXJuIHRoZSBudW1iZXIgb2YgaXRlcmF0aW9ucyBkb25lIQogICAgICAgIDAKICAgICAgKTsKICAgIH0KICAgIC8qKgogICAgICogQWRkIGFuIGVxdWF0aW9uCiAgICAgKi8KCgogICAgYWRkRXF1YXRpb24oZXEpIHsKICAgICAgaWYgKGVxLmVuYWJsZWQgJiYgIWVxLmJpLmlzVHJpZ2dlciAmJiAhZXEuYmouaXNUcmlnZ2VyKSB7CiAgICAgICAgdGhpcy5lcXVhdGlvbnMucHVzaChlcSk7CiAgICAgIH0KICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlIGFuIGVxdWF0aW9uCiAgICAgKi8KCgogICAgcmVtb3ZlRXF1YXRpb24oZXEpIHsKICAgICAgY29uc3QgZXFzID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IGkgPSBlcXMuaW5kZXhPZihlcSk7CgogICAgICBpZiAoaSAhPT0gLTEpIHsKICAgICAgICBlcXMuc3BsaWNlKGksIDEpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhbGwgZXF1YXRpb25zCiAgICAgKi8KCgogICAgcmVtb3ZlQWxsRXF1YXRpb25zKCkgewogICAgICB0aGlzLmVxdWF0aW9ucy5sZW5ndGggPSAwOwogICAgfQoKICB9CiAgLyoqCiAgICogQ29uc3RyYWludCBlcXVhdGlvbiBHYXVzcy1TZWlkZWwgc29sdmVyLgogICAqIEB0b2RvIFRoZSBzcG9vayBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzcGVjaWZpZWQgZm9yIGVhY2ggY29uc3RyYWludCwgbm90IGdsb2JhbGx5LgogICAqIEBzZWUgaHR0cHM6Ly93d3c4LmNzLnVtdS5zZS9rdXJzZXIvNURWMDU4L1ZUMDkvbGVjdHVyZXMvc3Bvb2tub3Rlcy5wZGYKICAgKi8KCgogIGNsYXNzIEdTU29sdmVyIGV4dGVuZHMgU29sdmVyIHsKICAgIC8qKgogICAgICogVGhlIG51bWJlciBvZiBzb2x2ZXIgaXRlcmF0aW9ucyBkZXRlcm1pbmVzIHF1YWxpdHkgb2YgdGhlIGNvbnN0cmFpbnRzIGluIHRoZSB3b3JsZC4KICAgICAqIFRoZSBtb3JlIGl0ZXJhdGlvbnMsIHRoZSBtb3JlIGNvcnJlY3Qgc2ltdWxhdGlvbi4gTW9yZSBpdGVyYXRpb25zIG5lZWQgbW9yZSBjb21wdXRhdGlvbnMgdGhvdWdoLiBJZiB5b3UgaGF2ZSBhIGxhcmdlIGdyYXZpdHkgZm9yY2UgaW4geW91ciB3b3JsZCwgeW91IHdpbGwgbmVlZCBtb3JlIGl0ZXJhdGlvbnMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFdoZW4gdG9sZXJhbmNlIGlzIHJlYWNoZWQsIHRoZSBzeXN0ZW0gaXMgYXNzdW1lZCB0byBiZSBjb252ZXJnZWQuCiAgICAgKi8KCiAgICAvKioKICAgICAqIEB0b2RvIHJlbW92ZSB1c2VsZXNzIGNvbnN0cnVjdG9yCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICBzdXBlcigpOwogICAgICB0aGlzLml0ZXJhdGlvbnMgPSB2b2lkIDA7CiAgICAgIHRoaXMudG9sZXJhbmNlID0gdm9pZCAwOwogICAgICB0aGlzLml0ZXJhdGlvbnMgPSAxMDsKICAgICAgdGhpcy50b2xlcmFuY2UgPSAxZS03OwogICAgfQogICAgLyoqCiAgICAgKiBTb2x2ZQogICAgICogQHJldHVybiBudW1iZXIgb2YgaXRlcmF0aW9ucyBwZXJmb3JtZWQKICAgICAqLwoKCiAgICBzb2x2ZShkdCwgd29ybGQpIHsKICAgICAgbGV0IGl0ZXIgPSAwOwogICAgICBjb25zdCBtYXhJdGVyID0gdGhpcy5pdGVyYXRpb25zOwogICAgICBjb25zdCB0b2xTcXVhcmVkID0gdGhpcy50b2xlcmFuY2UgKiB0aGlzLnRvbGVyYW5jZTsKICAgICAgY29uc3QgZXF1YXRpb25zID0gdGhpcy5lcXVhdGlvbnM7CiAgICAgIGNvbnN0IE5lcSA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgIGNvbnN0IGJvZGllcyA9IHdvcmxkLmJvZGllczsKICAgICAgY29uc3QgTmJvZGllcyA9IGJvZGllcy5sZW5ndGg7CiAgICAgIGNvbnN0IGggPSBkdDsKICAgICAgbGV0IEI7CiAgICAgIGxldCBpbnZDOwogICAgICBsZXQgZGVsdGFsYW1iZGE7CiAgICAgIGxldCBkZWx0YWxhbWJkYVRvdDsKICAgICAgbGV0IEdXbGFtYmRhOwogICAgICBsZXQgbGFtYmRhajsgLy8gVXBkYXRlIHNvbHZlIG1hc3MKCiAgICAgIGlmIChOZXEgIT09IDApIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gTmJvZGllczsgaSsrKSB7CiAgICAgICAgICBib2RpZXNbaV0udXBkYXRlU29sdmVNYXNzUHJvcGVydGllcygpOwogICAgICAgIH0KICAgICAgfSAvLyBUaGluZ3MgdGhhdCBkbyBub3QgY2hhbmdlIGR1cmluZyBpdGVyYXRpb24gY2FuIGJlIGNvbXB1dGVkIG9uY2UKCgogICAgICBjb25zdCBpbnZDcyA9IEdTU29sdmVyX3NvbHZlX2ludkNzOwogICAgICBjb25zdCBCcyA9IEdTU29sdmVyX3NvbHZlX0JzOwogICAgICBjb25zdCBsYW1iZGEgPSBHU1NvbHZlcl9zb2x2ZV9sYW1iZGE7CiAgICAgIGludkNzLmxlbmd0aCA9IE5lcTsKICAgICAgQnMubGVuZ3RoID0gTmVxOwogICAgICBsYW1iZGEubGVuZ3RoID0gTmVxOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5lcTsgaSsrKSB7CiAgICAgICAgY29uc3QgYyA9IGVxdWF0aW9uc1tpXTsKICAgICAgICBsYW1iZGFbaV0gPSAwLjA7CiAgICAgICAgQnNbaV0gPSBjLmNvbXB1dGVCKGgpOwogICAgICAgIGludkNzW2ldID0gMS4wIC8gYy5jb21wdXRlQygpOwogICAgICB9CgogICAgICBpZiAoTmVxICE9PSAwKSB7CiAgICAgICAgLy8gUmVzZXQgdmxhbWJkYQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOYm9kaWVzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgICBjb25zdCB2bGFtYmRhID0gYi52bGFtYmRhOwogICAgICAgICAgY29uc3Qgd2xhbWJkYSA9IGIud2xhbWJkYTsKICAgICAgICAgIHZsYW1iZGEuc2V0KDAsIDAsIDApOwogICAgICAgICAgd2xhbWJkYS5zZXQoMCwgMCwgMCk7CiAgICAgICAgfSAvLyBJdGVyYXRlIG92ZXIgZXF1YXRpb25zCgoKICAgICAgICBmb3IgKGl0ZXIgPSAwOyBpdGVyICE9PSBtYXhJdGVyOyBpdGVyKyspIHsKICAgICAgICAgIC8vIEFjY3VtdWxhdGUgdGhlIHRvdGFsIGVycm9yIGZvciBlYWNoIGl0ZXJhdGlvbi4KICAgICAgICAgIGRlbHRhbGFtYmRhVG90ID0gMC4wOwoKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSBOZXE7IGorKykgewogICAgICAgICAgICBjb25zdCBjID0gZXF1YXRpb25zW2pdOyAvLyBDb21wdXRlIGl0ZXJhdGlvbgoKICAgICAgICAgICAgQiA9IEJzW2pdOwogICAgICAgICAgICBpbnZDID0gaW52Q3Nbal07CiAgICAgICAgICAgIGxhbWJkYWogPSBsYW1iZGFbal07CiAgICAgICAgICAgIEdXbGFtYmRhID0gYy5jb21wdXRlR1dsYW1iZGEoKTsKICAgICAgICAgICAgZGVsdGFsYW1iZGEgPSBpbnZDICogKEIgLSBHV2xhbWJkYSAtIGMuZXBzICogbGFtYmRhaik7IC8vIENsYW1wIGlmIHdlIGFyZSBub3Qgd2l0aGluIHRoZSBtaW4vbWF4IGludGVydmFsCgogICAgICAgICAgICBpZiAobGFtYmRhaiArIGRlbHRhbGFtYmRhIDwgYy5taW5Gb3JjZSkgewogICAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gYy5taW5Gb3JjZSAtIGxhbWJkYWo7CiAgICAgICAgICAgIH0gZWxzZSBpZiAobGFtYmRhaiArIGRlbHRhbGFtYmRhID4gYy5tYXhGb3JjZSkgewogICAgICAgICAgICAgIGRlbHRhbGFtYmRhID0gYy5tYXhGb3JjZSAtIGxhbWJkYWo7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxhbWJkYVtqXSArPSBkZWx0YWxhbWJkYTsKICAgICAgICAgICAgZGVsdGFsYW1iZGFUb3QgKz0gZGVsdGFsYW1iZGEgPiAwLjAgPyBkZWx0YWxhbWJkYSA6IC1kZWx0YWxhbWJkYTsgLy8gYWJzKGRlbHRhbGFtYmRhKQoKICAgICAgICAgICAgYy5hZGRUb1dsYW1iZGEoZGVsdGFsYW1iZGEpOwogICAgICAgICAgfSAvLyBJZiB0aGUgdG90YWwgZXJyb3IgaXMgc21hbGwgZW5vdWdoIC0gc3RvcCBpdGVyYXRlCgoKICAgICAgICAgIGlmIChkZWx0YWxhbWJkYVRvdCAqIGRlbHRhbGFtYmRhVG90IDwgdG9sU3F1YXJlZCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9IC8vIEFkZCByZXN1bHQgdG8gdmVsb2NpdHkKCgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBOYm9kaWVzOyBpKyspIHsKICAgICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgICBjb25zdCB2ID0gYi52ZWxvY2l0eTsKICAgICAgICAgIGNvbnN0IHcgPSBiLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgICAgIGIudmxhbWJkYS52bXVsKGIubGluZWFyRmFjdG9yLCBiLnZsYW1iZGEpOwogICAgICAgICAgdi52YWRkKGIudmxhbWJkYSwgdik7CiAgICAgICAgICBiLndsYW1iZGEudm11bChiLmFuZ3VsYXJGYWN0b3IsIGIud2xhbWJkYSk7CiAgICAgICAgICB3LnZhZGQoYi53bGFtYmRhLCB3KTsKICAgICAgICB9IC8vIFNldCB0aGUgYC5tdWx0aXBsaWVyYCBwcm9wZXJ0eSBvZiBlYWNoIGVxdWF0aW9uCgoKICAgICAgICBsZXQgbCA9IGVxdWF0aW9ucy5sZW5ndGg7CiAgICAgICAgY29uc3QgaW52RHQgPSAxIC8gaDsKCiAgICAgICAgd2hpbGUgKGwtLSkgewogICAgICAgICAgZXF1YXRpb25zW2xdLm11bHRpcGxpZXIgPSBsYW1iZGFbbF0gKiBpbnZEdDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBpdGVyOwogICAgfQoKICB9IC8vIEp1c3QgdGVtcG9yYXJ5IG51bWJlciBob2xkZXJzIHRoYXQgd2Ugd2FudCB0byByZXVzZSBlYWNoIGl0ZXJhdGlvbi4KCgogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2xhbWJkYSA9IFtdOwogIGNvbnN0IEdTU29sdmVyX3NvbHZlX2ludkNzID0gW107CiAgY29uc3QgR1NTb2x2ZXJfc29sdmVfQnMgPSBbXTsKICAvKioKICAgKiBGb3IgcG9vbGluZyBvYmplY3RzIHRoYXQgY2FuIGJlIHJldXNlZC4KICAgKi8KCgogIGNsYXNzIFBvb2wgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMub2JqZWN0cyA9IFtdOwogICAgICB0aGlzLnR5cGUgPSBPYmplY3Q7CiAgICB9CiAgICAvKioKICAgICAqIFJlbGVhc2UgYW4gb2JqZWN0IGFmdGVyIHVzZQogICAgICovCgoKICAgIHJlbGVhc2UoLi4uYXJncykgewogICAgICBjb25zdCBOYXJncyA9IGFyZ3MubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE5hcmdzOyBpKyspIHsKICAgICAgICB0aGlzLm9iamVjdHMucHVzaChhcmdzW2ldKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CiAgICAvKioKICAgICAqIEdldCBhbiBvYmplY3QKICAgICAqLwoKCiAgICBnZXQoKSB7CiAgICAgIGlmICh0aGlzLm9iamVjdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0T2JqZWN0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMub2JqZWN0cy5wb3AoKTsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBDb25zdHJ1Y3QgYW4gb2JqZWN0LiBTaG91bGQgYmUgaW1wbGVtZW50ZWQgaW4gZWFjaCBzdWJjbGFzcy4KICAgICAqLwoKCiAgICBjb25zdHJ1Y3RPYmplY3QoKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignY29uc3RydWN0T2JqZWN0KCkgbm90IGltcGxlbWVudGVkIGluIHRoaXMgUG9vbCBzdWJjbGFzcyB5ZXQhJyk7CiAgICB9CiAgICAvKioKICAgICAqIEByZXR1cm4gU2VsZiwgZm9yIGNoYWluaW5nCiAgICAgKi8KCgogICAgcmVzaXplKHNpemUpIHsKICAgICAgY29uc3Qgb2JqZWN0cyA9IHRoaXMub2JqZWN0czsKCiAgICAgIHdoaWxlIChvYmplY3RzLmxlbmd0aCA+IHNpemUpIHsKICAgICAgICBvYmplY3RzLnBvcCgpOwogICAgICB9CgogICAgICB3aGlsZSAob2JqZWN0cy5sZW5ndGggPCBzaXplKSB7CiAgICAgICAgb2JqZWN0cy5wdXNoKHRoaXMuY29uc3RydWN0T2JqZWN0KCkpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KCiAgfQogIC8qKgogICAqIFZlYzNQb29sCiAgICovCgoKICBjbGFzcyBWZWMzUG9vbCBleHRlbmRzIFBvb2wgewogICAgY29uc3RydWN0b3IoLi4uYXJncykgewogICAgICBzdXBlciguLi5hcmdzKTsKICAgICAgdGhpcy50eXBlID0gVmVjMzsKICAgIH0KICAgIC8qKgogICAgICogQ29uc3RydWN0IGEgdmVjdG9yCiAgICAgKi8KCgogICAgY29uc3RydWN0T2JqZWN0KCkgewogICAgICByZXR1cm4gbmV3IFZlYzMoKTsKICAgIH0KCiAgfQoKICBsZXQgX0NPTExJU0lPTl9UWVBFUyRzcGhlLCBfQ09MTElTSU9OX1RZUEVTJHNwaGUyLCBfQ09MTElTSU9OX1RZUEVTJGJveEIsIF9DT0xMSVNJT05fVFlQRVMkc3BoZTMsIF9DT0xMSVNJT05fVFlQRVMkcGxhbiwgX0NPTExJU0lPTl9UWVBFUyRjb252LCBfQ09MTElTSU9OX1RZUEVTJHNwaGU0LCBfQ09MTElTSU9OX1RZUEVTJHBsYW4yLCBfQ09MTElTSU9OX1RZUEVTJGJveEMsIF9DT0xMSVNJT05fVFlQRVMkc3BoZTUsIF9DT0xMSVNJT05fVFlQRVMkYm94SCwgX0NPTExJU0lPTl9UWVBFUyRjb252MiwgX0NPTExJU0lPTl9UWVBFUyRzcGhlNiwgX0NPTExJU0lPTl9UWVBFUyRwbGFuMywgX0NPTExJU0lPTl9UWVBFUyRib3hQLCBfQ09MTElTSU9OX1RZUEVTJGNvbnYzLCBfQ09MTElTSU9OX1RZUEVTJGN5bGksIF9DT0xMSVNJT05fVFlQRVMkc3BoZTcsIF9DT0xMSVNJT05fVFlQRVMkcGxhbjQsIF9DT0xMSVNJT05fVFlQRVMkYm94QzIsIF9DT0xMSVNJT05fVFlQRVMkY29udjQsIF9DT0xMSVNJT05fVFlQRVMkaGVpZywgX0NPTExJU0lPTl9UWVBFUyRwYXJ0LCBfQ09MTElTSU9OX1RZUEVTJHNwaGU4LCBfQ09MTElTSU9OX1RZUEVTJHBsYW41OyAvLyBOYW1pbmcgcnVsZTogYmFzZWQgb2YgdGhlIG9yZGVyIGluIFNIQVBFX1RZUEVTLAogIC8vIHRoZSBmaXJzdCBwYXJ0IG9mIHRoZSBtZXRob2QgaXMgZm9ybWVkIGJ5IHRoZQogIC8vIHNoYXBlIHR5cGUgdGhhdCBjb21lcyBiZWZvcmUsIGluIHRoZSBzZWNvbmQgcGFydAogIC8vIHRoZXJlIGlzIHRoZSBzaGFwZSB0eXBlIHRoYXQgY29tZXMgYWZ0ZXIgaW4gdGhlIFNIQVBFX1RZUEVTIGxpc3QKCgogIGNvbnN0IENPTExJU0lPTl9UWVBFUyA9IHsKICAgIHNwaGVyZVNwaGVyZTogU2hhcGUudHlwZXMuU1BIRVJFLAogICAgc3BoZXJlUGxhbmU6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLlBMQU5FLAogICAgYm94Qm94OiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5CT1gsCiAgICBzcGhlcmVCb3g6IFNoYXBlLnR5cGVzLlNQSEVSRSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIHBsYW5lQm94OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkJPWCwKICAgIGNvbnZleENvbnZleDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHNwaGVyZUNvbnZleDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiwKICAgIHBsYW5lQ29udmV4OiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBib3hDb252ZXg6IFNoYXBlLnR5cGVzLkJPWCB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBzcGhlcmVIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuU1BIRVJFIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBib3hIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuSEVJR0hURklFTEQsCiAgICBjb252ZXhIZWlnaHRmaWVsZDogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkhFSUdIVEZJRUxELAogICAgc3BoZXJlUGFydGljbGU6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuU1BIRVJFLAogICAgcGxhbmVQYXJ0aWNsZTogU2hhcGUudHlwZXMuUExBTkUgfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGJveFBhcnRpY2xlOiBTaGFwZS50eXBlcy5CT1ggfCBTaGFwZS50eXBlcy5QQVJUSUNMRSwKICAgIGNvbnZleFBhcnRpY2xlOiBTaGFwZS50eXBlcy5QQVJUSUNMRSB8IFNoYXBlLnR5cGVzLkNPTlZFWFBPTFlIRURST04sCiAgICBjeWxpbmRlckN5bGluZGVyOiBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHNwaGVyZUN5bGluZGVyOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBsYW5lQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBMQU5FIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBib3hDeWxpbmRlcjogU2hhcGUudHlwZXMuQk9YIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBjb252ZXhDeWxpbmRlcjogU2hhcGUudHlwZXMuQ09OVkVYUE9MWUhFRFJPTiB8IFNoYXBlLnR5cGVzLkNZTElOREVSLAogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcjogU2hhcGUudHlwZXMuSEVJR0hURklFTEQgfCBTaGFwZS50eXBlcy5DWUxJTkRFUiwKICAgIHBhcnRpY2xlQ3lsaW5kZXI6IFNoYXBlLnR5cGVzLlBBUlRJQ0xFIHwgU2hhcGUudHlwZXMuQ1lMSU5ERVIsCiAgICBzcGhlcmVUcmltZXNoOiBTaGFwZS50eXBlcy5TUEhFUkUgfCBTaGFwZS50eXBlcy5UUklNRVNILAogICAgcGxhbmVUcmltZXNoOiBTaGFwZS50eXBlcy5QTEFORSB8IFNoYXBlLnR5cGVzLlRSSU1FU0gKICB9OwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZSA9IENPTExJU0lPTl9UWVBFUy5zcGhlcmVTcGhlcmU7CiAgX0NPTExJU0lPTl9UWVBFUyRzcGhlMiA9IENPTExJU0lPTl9UWVBFUy5zcGhlcmVQbGFuZTsKICBfQ09MTElTSU9OX1RZUEVTJGJveEIgPSBDT0xMSVNJT05fVFlQRVMuYm94Qm94OwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTMgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlQm94OwogIF9DT0xMSVNJT05fVFlQRVMkcGxhbiA9IENPTExJU0lPTl9UWVBFUy5wbGFuZUJveDsKICBfQ09MTElTSU9OX1RZUEVTJGNvbnYgPSBDT0xMSVNJT05fVFlQRVMuY29udmV4Q29udmV4OwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTQgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ29udmV4OwogIF9DT0xMSVNJT05fVFlQRVMkcGxhbjIgPSBDT0xMSVNJT05fVFlQRVMucGxhbmVDb252ZXg7CiAgX0NPTExJU0lPTl9UWVBFUyRib3hDID0gQ09MTElTSU9OX1RZUEVTLmJveENvbnZleDsKICBfQ09MTElTSU9OX1RZUEVTJHNwaGU1ID0gQ09MTElTSU9OX1RZUEVTLnNwaGVyZUhlaWdodGZpZWxkOwogIF9DT0xMSVNJT05fVFlQRVMkYm94SCA9IENPTExJU0lPTl9UWVBFUy5ib3hIZWlnaHRmaWVsZDsKICBfQ09MTElTSU9OX1RZUEVTJGNvbnYyID0gQ09MTElTSU9OX1RZUEVTLmNvbnZleEhlaWdodGZpZWxkOwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTYgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlUGFydGljbGU7CiAgX0NPTExJU0lPTl9UWVBFUyRwbGFuMyA9IENPTExJU0lPTl9UWVBFUy5wbGFuZVBhcnRpY2xlOwogIF9DT0xMSVNJT05fVFlQRVMkYm94UCA9IENPTExJU0lPTl9UWVBFUy5ib3hQYXJ0aWNsZTsKICBfQ09MTElTSU9OX1RZUEVTJGNvbnYzID0gQ09MTElTSU9OX1RZUEVTLmNvbnZleFBhcnRpY2xlOwogIF9DT0xMSVNJT05fVFlQRVMkY3lsaSA9IENPTExJU0lPTl9UWVBFUy5jeWxpbmRlckN5bGluZGVyOwogIF9DT0xMSVNJT05fVFlQRVMkc3BoZTcgPSBDT0xMSVNJT05fVFlQRVMuc3BoZXJlQ3lsaW5kZXI7CiAgX0NPTExJU0lPTl9UWVBFUyRwbGFuNCA9IENPTExJU0lPTl9UWVBFUy5wbGFuZUN5bGluZGVyOwogIF9DT0xMSVNJT05fVFlQRVMkYm94QzIgPSBDT0xMSVNJT05fVFlQRVMuYm94Q3lsaW5kZXI7CiAgX0NPTExJU0lPTl9UWVBFUyRjb252NCA9IENPTExJU0lPTl9UWVBFUy5jb252ZXhDeWxpbmRlcjsKICBfQ09MTElTSU9OX1RZUEVTJGhlaWcgPSBDT0xMSVNJT05fVFlQRVMuaGVpZ2h0ZmllbGRDeWxpbmRlcjsKICBfQ09MTElTSU9OX1RZUEVTJHBhcnQgPSBDT0xMSVNJT05fVFlQRVMucGFydGljbGVDeWxpbmRlcjsKICBfQ09MTElTSU9OX1RZUEVTJHNwaGU4ID0gQ09MTElTSU9OX1RZUEVTLnNwaGVyZVRyaW1lc2g7CiAgX0NPTExJU0lPTl9UWVBFUyRwbGFuNSA9IENPTExJU0lPTl9UWVBFUy5wbGFuZVRyaW1lc2g7CiAgLyoqCiAgICogSGVscGVyIGNsYXNzIGZvciB0aGUgV29ybGQuIEdlbmVyYXRlcyBDb250YWN0RXF1YXRpb25zLgogICAqIEB0b2RvIFNwaGVyZS1Db252ZXhQb2x5aGVkcm9uIGNvbnRhY3RzCiAgICogQHRvZG8gQ29udGFjdCByZWR1Y3Rpb24KICAgKiBAdG9kbyBzaG91bGQgbW92ZSBtZXRob2RzIHRvIHByb3RvdHlwZQogICAqLwoKICBjbGFzcyBOYXJyb3dwaGFzZSB7CiAgICAvKioKICAgICAqIEludGVybmFsIHN0b3JhZ2Ugb2YgcG9vbGVkIGNvbnRhY3QgcG9pbnRzLgogICAgICovCgogICAgLyoqCiAgICAgKiBQb29sZWQgdmVjdG9ycy4KICAgICAqLwogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGVdKCkgewogICAgICByZXR1cm4gdGhpcy5zcGhlcmVTcGhlcmU7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGUyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGxhbmU7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGJveEJdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hCb3g7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGUzXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQm94OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRwbGFuXSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVCb3g7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGNvbnZdKCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGU0XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlQ29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRwbGFuMl0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRib3hDXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94Q29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRzcGhlNV0oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZUhlaWdodGZpZWxkOwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRib3hIXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuYm94SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGNvbnYyXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4SGVpZ2h0ZmllbGQ7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGU2XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlUGFydGljbGU7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHBsYW4zXSgpIHsKICAgICAgcmV0dXJuIHRoaXMucGxhbmVQYXJ0aWNsZTsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkYm94UF0oKSB7CiAgICAgIHJldHVybiB0aGlzLmJveFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRjb252M10oKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnZleFBhcnRpY2xlOwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRjeWxpXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRzcGhlN10oKSB7CiAgICAgIHJldHVybiB0aGlzLnNwaGVyZUNvbnZleDsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkcGxhbjRdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZUNvbnZleDsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkYm94QzJdKCkgewogICAgICByZXR1cm4gdGhpcy5ib3hDb252ZXg7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJGNvbnY0XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4OwogICAgfQoKICAgIGdldCBbX0NPTExJU0lPTl9UWVBFUyRoZWlnXSgpIHsKICAgICAgcmV0dXJuIHRoaXMuaGVpZ2h0ZmllbGRDeWxpbmRlcjsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkcGFydF0oKSB7CiAgICAgIHJldHVybiB0aGlzLnBhcnRpY2xlQ3lsaW5kZXI7CiAgICB9CgogICAgZ2V0IFtfQ09MTElTSU9OX1RZUEVTJHNwaGU4XSgpIHsKICAgICAgcmV0dXJuIHRoaXMuc3BoZXJlVHJpbWVzaDsKICAgIH0KCiAgICBnZXQgW19DT0xMSVNJT05fVFlQRVMkcGxhbjVdKCkgewogICAgICByZXR1cm4gdGhpcy5wbGFuZVRyaW1lc2g7CiAgICB9IC8vIGdldCBbQ09MTElTSU9OX1RZUEVTLmNvbnZleFRyaW1lc2hdKCkgewogICAgLy8gICByZXR1cm4gdGhpcy5jb252ZXhUcmltZXNoCiAgICAvLyB9CgoKICAgIGNvbnN0cnVjdG9yKHdvcmxkKSB7CiAgICAgIHRoaXMuY29udGFjdFBvaW50UG9vbCA9IHZvaWQgMDsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUG9vbCA9IHZvaWQgMDsKICAgICAgdGhpcy5yZXN1bHQgPSB2b2lkIDA7CiAgICAgIHRoaXMuZnJpY3Rpb25SZXN1bHQgPSB2b2lkIDA7CiAgICAgIHRoaXMudjNwb29sID0gdm9pZCAwOwogICAgICB0aGlzLndvcmxkID0gdm9pZCAwOwogICAgICB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gPSB2b2lkIDA7CiAgICAgIHRoaXMuY29udGFjdFBvaW50UG9vbCA9IFtdOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25Qb29sID0gW107CiAgICAgIHRoaXMucmVzdWx0ID0gW107CiAgICAgIHRoaXMuZnJpY3Rpb25SZXN1bHQgPSBbXTsKICAgICAgdGhpcy52M3Bvb2wgPSBuZXcgVmVjM1Bvb2woKTsKICAgICAgdGhpcy53b3JsZCA9IHdvcmxkOwogICAgICB0aGlzLmN1cnJlbnRDb250YWN0TWF0ZXJpYWwgPSB3b3JsZC5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICB0aGlzLmVuYWJsZUZyaWN0aW9uUmVkdWN0aW9uID0gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIE1ha2UgYSBjb250YWN0IG9iamVjdCwgYnkgdXNpbmcgdGhlIGludGVybmFsIHBvb2wgb3IgY3JlYXRpbmcgYSBuZXcgb25lLgogICAgICovCgoKICAgIGNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgb3ZlcnJpZGVTaGFwZUEsIG92ZXJyaWRlU2hhcGVCKSB7CiAgICAgIGxldCBjOwoKICAgICAgaWYgKHRoaXMuY29udGFjdFBvaW50UG9vbC5sZW5ndGgpIHsKICAgICAgICBjID0gdGhpcy5jb250YWN0UG9pbnRQb29sLnBvcCgpOwogICAgICAgIGMuYmkgPSBiaTsKICAgICAgICBjLmJqID0gYmo7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYyA9IG5ldyBDb250YWN0RXF1YXRpb24oYmksIGJqKTsKICAgICAgfQoKICAgICAgYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CiAgICAgIGNvbnN0IGNtID0gdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsOwogICAgICBjLnJlc3RpdHV0aW9uID0gY20ucmVzdGl0dXRpb247CiAgICAgIGMuc2V0U3Bvb2tQYXJhbXMoY20uY29udGFjdEVxdWF0aW9uU3RpZmZuZXNzLCBjbS5jb250YWN0RXF1YXRpb25SZWxheGF0aW9uLCB0aGlzLndvcmxkLmR0KTsKICAgICAgY29uc3QgbWF0QSA9IHNpLm1hdGVyaWFsIHx8IGJpLm1hdGVyaWFsOwogICAgICBjb25zdCBtYXRCID0gc2oubWF0ZXJpYWwgfHwgYmoubWF0ZXJpYWw7CgogICAgICBpZiAobWF0QSAmJiBtYXRCICYmIG1hdEEucmVzdGl0dXRpb24gPj0gMCAmJiBtYXRCLnJlc3RpdHV0aW9uID49IDApIHsKICAgICAgICBjLnJlc3RpdHV0aW9uID0gbWF0QS5yZXN0aXR1dGlvbiAqIG1hdEIucmVzdGl0dXRpb247CiAgICAgIH0KCiAgICAgIGMuc2kgPSBvdmVycmlkZVNoYXBlQSB8fCBzaTsKICAgICAgYy5zaiA9IG92ZXJyaWRlU2hhcGVCIHx8IHNqOwogICAgICByZXR1cm4gYzsKICAgIH0KCiAgICBjcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KGNvbnRhY3RFcXVhdGlvbiwgb3V0QXJyYXkpIHsKICAgICAgY29uc3QgYm9keUEgPSBjb250YWN0RXF1YXRpb24uYmk7CiAgICAgIGNvbnN0IGJvZHlCID0gY29udGFjdEVxdWF0aW9uLmJqOwogICAgICBjb25zdCBzaGFwZUEgPSBjb250YWN0RXF1YXRpb24uc2k7CiAgICAgIGNvbnN0IHNoYXBlQiA9IGNvbnRhY3RFcXVhdGlvbi5zajsKICAgICAgY29uc3Qgd29ybGQgPSB0aGlzLndvcmxkOwogICAgICBjb25zdCBjbSA9IHRoaXMuY3VycmVudENvbnRhY3RNYXRlcmlhbDsgLy8gSWYgZnJpY3Rpb24gb3IgcmVzdGl0dXRpb24gd2VyZSBzcGVjaWZpZWQgaW4gdGhlIG1hdGVyaWFsLCB1c2UgdGhlbQoKICAgICAgbGV0IGZyaWN0aW9uID0gY20uZnJpY3Rpb247CiAgICAgIGNvbnN0IG1hdEEgPSBzaGFwZUEubWF0ZXJpYWwgfHwgYm9keUEubWF0ZXJpYWw7CiAgICAgIGNvbnN0IG1hdEIgPSBzaGFwZUIubWF0ZXJpYWwgfHwgYm9keUIubWF0ZXJpYWw7CgogICAgICBpZiAobWF0QSAmJiBtYXRCICYmIG1hdEEuZnJpY3Rpb24gPj0gMCAmJiBtYXRCLmZyaWN0aW9uID49IDApIHsKICAgICAgICBmcmljdGlvbiA9IG1hdEEuZnJpY3Rpb24gKiBtYXRCLmZyaWN0aW9uOwogICAgICB9CgogICAgICBpZiAoZnJpY3Rpb24gPiAwKSB7CiAgICAgICAgLy8gQ3JlYXRlIDIgdGFuZ2VudCBlcXVhdGlvbnMKICAgICAgICBjb25zdCBtdWcgPSBmcmljdGlvbiAqIHdvcmxkLmdyYXZpdHkubGVuZ3RoKCk7CiAgICAgICAgbGV0IHJlZHVjZWRNYXNzID0gYm9keUEuaW52TWFzcyArIGJvZHlCLmludk1hc3M7CgogICAgICAgIGlmIChyZWR1Y2VkTWFzcyA+IDApIHsKICAgICAgICAgIHJlZHVjZWRNYXNzID0gMSAvIHJlZHVjZWRNYXNzOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcG9vbCA9IHRoaXMuZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgY29uc3QgYzEgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihib2R5QSwgYm9keUIsIG11ZyAqIHJlZHVjZWRNYXNzKTsKICAgICAgICBjb25zdCBjMiA9IHBvb2wubGVuZ3RoID8gcG9vbC5wb3AoKSA6IG5ldyBGcmljdGlvbkVxdWF0aW9uKGJvZHlBLCBib2R5QiwgbXVnICogcmVkdWNlZE1hc3MpOwogICAgICAgIGMxLmJpID0gYzIuYmkgPSBib2R5QTsKICAgICAgICBjMS5iaiA9IGMyLmJqID0gYm9keUI7CiAgICAgICAgYzEubWluRm9yY2UgPSBjMi5taW5Gb3JjZSA9IC1tdWcgKiByZWR1Y2VkTWFzczsKICAgICAgICBjMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnICogcmVkdWNlZE1hc3M7IC8vIENvcHkgb3ZlciB0aGUgcmVsYXRpdmUgdmVjdG9ycwoKICAgICAgICBjMS5yaS5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaSk7CiAgICAgICAgYzEucmouY29weShjb250YWN0RXF1YXRpb24ucmopOwogICAgICAgIGMyLnJpLmNvcHkoY29udGFjdEVxdWF0aW9uLnJpKTsKICAgICAgICBjMi5yai5jb3B5KGNvbnRhY3RFcXVhdGlvbi5yaik7IC8vIENvbnN0cnVjdCB0YW5nZW50cwoKICAgICAgICBjb250YWN0RXF1YXRpb24ubmkudGFuZ2VudHMoYzEudCwgYzIudCk7IC8vIFNldCBzcG9vayBwYXJhbXMKCiAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIHdvcmxkLmR0KTsKICAgICAgICBjMi5zZXRTcG9va1BhcmFtcyhjbS5mcmljdGlvbkVxdWF0aW9uU3RpZmZuZXNzLCBjbS5mcmljdGlvbkVxdWF0aW9uUmVsYXhhdGlvbiwgd29ybGQuZHQpOwogICAgICAgIGMxLmVuYWJsZWQgPSBjMi5lbmFibGVkID0gY29udGFjdEVxdWF0aW9uLmVuYWJsZWQ7CiAgICAgICAgb3V0QXJyYXkucHVzaChjMSwgYzIpOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvKioKICAgICAqIFRha2UgdGhlIGF2ZXJhZ2UgTiBsYXRlc3QgY29udGFjdCBwb2ludCBvbiB0aGUgcGxhbmUuCiAgICAgKi8KCgogICAgY3JlYXRlRnJpY3Rpb25Gcm9tQXZlcmFnZShudW1Db250YWN0cykgewogICAgICAvLyBUaGUgbGFzdCBjb250YWN0RXF1YXRpb24KICAgICAgbGV0IGMgPSB0aGlzLnJlc3VsdFt0aGlzLnJlc3VsdC5sZW5ndGggLSAxXTsgLy8gQ3JlYXRlIHRoZSByZXN1bHQ6IHR3byAiYXZlcmFnZSIgZnJpY3Rpb24gZXF1YXRpb25zCgogICAgICBpZiAoIXRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChjLCB0aGlzLmZyaWN0aW9uUmVzdWx0KSB8fCBudW1Db250YWN0cyA9PT0gMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgY29uc3QgZjEgPSB0aGlzLmZyaWN0aW9uUmVzdWx0W3RoaXMuZnJpY3Rpb25SZXN1bHQubGVuZ3RoIC0gMl07CiAgICAgIGNvbnN0IGYyID0gdGhpcy5mcmljdGlvblJlc3VsdFt0aGlzLmZyaWN0aW9uUmVzdWx0Lmxlbmd0aCAtIDFdOwogICAgICBhdmVyYWdlTm9ybWFsLnNldFplcm8oKTsKICAgICAgYXZlcmFnZUNvbnRhY3RQb2ludEEuc2V0WmVybygpOwogICAgICBhdmVyYWdlQ29udGFjdFBvaW50Qi5zZXRaZXJvKCk7CiAgICAgIGNvbnN0IGJvZHlBID0gYy5iaTsKICAgICAgYy5iajsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBudW1Db250YWN0czsgaSsrKSB7CiAgICAgICAgYyA9IHRoaXMucmVzdWx0W3RoaXMucmVzdWx0Lmxlbmd0aCAtIDEgLSBpXTsKCiAgICAgICAgaWYgKGMuYmkgIT09IGJvZHlBKSB7CiAgICAgICAgICBhdmVyYWdlTm9ybWFsLnZhZGQoYy5uaSwgYXZlcmFnZU5vcm1hbCk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS52YWRkKGMucmksIGF2ZXJhZ2VDb250YWN0UG9pbnRBKTsKICAgICAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRCLnZhZGQoYy5yaiwgYXZlcmFnZUNvbnRhY3RQb2ludEIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhdmVyYWdlTm9ybWFsLnZzdWIoYy5uaSwgYXZlcmFnZU5vcm1hbCk7CiAgICAgICAgICBhdmVyYWdlQ29udGFjdFBvaW50QS52YWRkKGMucmosIGF2ZXJhZ2VDb250YWN0UG9pbnRBKTsKICAgICAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRCLnZhZGQoYy5yaSwgYXZlcmFnZUNvbnRhY3RQb2ludEIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc3QgaW52TnVtQ29udGFjdHMgPSAxIC8gbnVtQ29udGFjdHM7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRBLnNjYWxlKGludk51bUNvbnRhY3RzLCBmMS5yaSk7CiAgICAgIGF2ZXJhZ2VDb250YWN0UG9pbnRCLnNjYWxlKGludk51bUNvbnRhY3RzLCBmMS5yaik7CiAgICAgIGYyLnJpLmNvcHkoZjEucmkpOyAvLyBTaG91bGQgYmUgdGhlIHNhbWUKCiAgICAgIGYyLnJqLmNvcHkoZjEucmopOwogICAgICBhdmVyYWdlTm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICBhdmVyYWdlTm9ybWFsLnRhbmdlbnRzKGYxLnQsIGYyLnQpOyAvLyByZXR1cm4gZXE7CiAgICB9CiAgICAvKioKICAgICAqIEdlbmVyYXRlIGFsbCBjb250YWN0cyBiZXR3ZWVuIGEgbGlzdCBvZiBib2R5IHBhaXJzCiAgICAgKiBAcGFyYW0gcDEgQXJyYXkgb2YgYm9keSBpbmRpY2VzCiAgICAgKiBAcGFyYW0gcDIgQXJyYXkgb2YgYm9keSBpbmRpY2VzCiAgICAgKiBAcGFyYW0gcmVzdWx0IEFycmF5IHRvIHN0b3JlIGdlbmVyYXRlZCBjb250YWN0cwogICAgICogQHBhcmFtIG9sZGNvbnRhY3RzIE9wdGlvbmFsLiBBcnJheSBvZiByZXVzYWJsZSBjb250YWN0IG9iamVjdHMKICAgICAqLwoKCiAgICBnZXRDb250YWN0cyhwMSwgcDIsIHdvcmxkLCByZXN1bHQsIG9sZGNvbnRhY3RzLCBmcmljdGlvblJlc3VsdCwgZnJpY3Rpb25Qb29sKSB7CiAgICAgIC8vIFNhdmUgb2xkIGNvbnRhY3Qgb2JqZWN0cwogICAgICB0aGlzLmNvbnRhY3RQb2ludFBvb2wgPSBvbGRjb250YWN0czsKICAgICAgdGhpcy5mcmljdGlvbkVxdWF0aW9uUG9vbCA9IGZyaWN0aW9uUG9vbDsKICAgICAgdGhpcy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgIHRoaXMuZnJpY3Rpb25SZXN1bHQgPSBmcmljdGlvblJlc3VsdDsKICAgICAgY29uc3QgcWkgPSB0bXBRdWF0MTsKICAgICAgY29uc3QgcWogPSB0bXBRdWF0MjsKICAgICAgY29uc3QgeGkgPSB0bXBWZWMxOwogICAgICBjb25zdCB4aiA9IHRtcFZlYzI7CgogICAgICBmb3IgKGxldCBrID0gMCwgTiA9IHAxLmxlbmd0aDsgayAhPT0gTjsgaysrKSB7CiAgICAgICAgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGJvZGllcwogICAgICAgIGNvbnN0IGJpID0gcDFba107CiAgICAgICAgY29uc3QgYmogPSBwMltrXTsgLy8gR2V0IGNvbnRhY3QgbWF0ZXJpYWwKCiAgICAgICAgbGV0IGJvZHlDb250YWN0TWF0ZXJpYWwgPSBudWxsOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGJvZHlDb250YWN0TWF0ZXJpYWwgPSB3b3JsZC5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCBudWxsOwogICAgICAgIH0KCiAgICAgICAgY29uc3QganVzdFRlc3QgPSBiaS50eXBlICYgQm9keS5LSU5FTUFUSUMgJiYgYmoudHlwZSAmIEJvZHkuU1RBVElDIHx8IGJpLnR5cGUgJiBCb2R5LlNUQVRJQyAmJiBiai50eXBlICYgQm9keS5LSU5FTUFUSUMgfHwgYmkudHlwZSAmIEJvZHkuS0lORU1BVElDICYmIGJqLnR5cGUgJiBCb2R5LktJTkVNQVRJQzsKCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiaS5zaGFwZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGJpLnF1YXRlcm5pb24ubXVsdChiaS5zaGFwZU9yaWVudGF0aW9uc1tpXSwgcWkpOwogICAgICAgICAgYmkucXVhdGVybmlvbi52bXVsdChiaS5zaGFwZU9mZnNldHNbaV0sIHhpKTsKICAgICAgICAgIHhpLnZhZGQoYmkucG9zaXRpb24sIHhpKTsKICAgICAgICAgIGNvbnN0IHNpID0gYmkuc2hhcGVzW2ldOwoKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgYmouc2hhcGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIC8vIENvbXB1dGUgd29ybGQgdHJhbnNmb3JtIG9mIHNoYXBlcwogICAgICAgICAgICBiai5xdWF0ZXJuaW9uLm11bHQoYmouc2hhcGVPcmllbnRhdGlvbnNbal0sIHFqKTsKICAgICAgICAgICAgYmoucXVhdGVybmlvbi52bXVsdChiai5zaGFwZU9mZnNldHNbal0sIHhqKTsKICAgICAgICAgICAgeGoudmFkZChiai5wb3NpdGlvbiwgeGopOwogICAgICAgICAgICBjb25zdCBzaiA9IGJqLnNoYXBlc1tqXTsKCiAgICAgICAgICAgIGlmICghKHNpLmNvbGxpc2lvbkZpbHRlck1hc2sgJiBzai5jb2xsaXNpb25GaWx0ZXJHcm91cCAmJiBzai5jb2xsaXNpb25GaWx0ZXJNYXNrICYgc2kuY29sbGlzaW9uRmlsdGVyR3JvdXApKSB7CiAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpIHsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfSAvLyBHZXQgY29sbGlzaW9uIG1hdGVyaWFsCgoKICAgICAgICAgICAgbGV0IHNoYXBlQ29udGFjdE1hdGVyaWFsID0gbnVsbDsKCiAgICAgICAgICAgIGlmIChzaS5tYXRlcmlhbCAmJiBzai5tYXRlcmlhbCkgewogICAgICAgICAgICAgIHNoYXBlQ29udGFjdE1hdGVyaWFsID0gd29ybGQuZ2V0Q29udGFjdE1hdGVyaWFsKHNpLm1hdGVyaWFsLCBzai5tYXRlcmlhbCkgfHwgbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5jdXJyZW50Q29udGFjdE1hdGVyaWFsID0gc2hhcGVDb250YWN0TWF0ZXJpYWwgfHwgYm9keUNvbnRhY3RNYXRlcmlhbCB8fCB3b3JsZC5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOyAvLyBHZXQgY29udGFjdHMKCiAgICAgICAgICAgIGNvbnN0IHJlc29sdmVySW5kZXggPSBzaS50eXBlIHwgc2oudHlwZTsKICAgICAgICAgICAgY29uc3QgcmVzb2x2ZXIgPSB0aGlzW3Jlc29sdmVySW5kZXhdOwoKICAgICAgICAgICAgaWYgKHJlc29sdmVyKSB7CiAgICAgICAgICAgICAgbGV0IHJldHZhbCA9IGZhbHNlOyAvLyBUTyBETzogaW52ZXN0aWdhdGUgd2h5IHNwaGVyZVBhcnRpY2xlIGFuZCBjb252ZXhQYXJ0aWNsZQogICAgICAgICAgICAgIC8vIHJlc29sdmVycyBleHBlY3Qgc2kgYW5kIHNqIHNoYXBlcyB0byBiZSBpbiByZXZlcnNlIG9yZGVyCiAgICAgICAgICAgICAgLy8gKGkuZS4gbGFyZ2VyIGludGVnZXIgdmFsdWUgdHlwZSBmaXJzdCBpbnN0ZWFkIG9mIHNtYWxsZXIgZmlyc3QpCgogICAgICAgICAgICAgIGlmIChzaS50eXBlIDwgc2oudHlwZSkgewogICAgICAgICAgICAgICAgcmV0dmFsID0gcmVzb2x2ZXIuY2FsbCh0aGlzLCBzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHNpLCBzaiwganVzdFRlc3QpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR2YWwgPSByZXNvbHZlci5jYWxsKHRoaXMsIHNqLCBzaSwgeGosIHhpLCBxaiwgcWksIGJqLCBiaSwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBpZiAocmV0dmFsICYmIGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICAvLyBSZWdpc3RlciBvdmVybGFwCiAgICAgICAgICAgICAgICB3b3JsZC5zaGFwZU92ZXJsYXBLZWVwZXIuc2V0KHNpLmlkLCBzai5pZCk7CiAgICAgICAgICAgICAgICB3b3JsZC5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVTcGhlcmUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgcmV0dXJuIHhpLmRpc3RhbmNlU3F1YXJlZCh4aikgPCAoc2kucmFkaXVzICsgc2oucmFkaXVzKSAqKiAyOwogICAgICB9IC8vIFdlIHdpbGwgaGF2ZSBvbmx5IG9uZSBjb250YWN0IGluIHRoaXMgY2FzZQoKCiAgICAgIGNvbnN0IGNvbnRhY3RFcSA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7IC8vIENvbnRhY3Qgbm9ybWFsCgogICAgICB4ai52c3ViKHhpLCBjb250YWN0RXEubmkpOwogICAgICBjb250YWN0RXEubmkubm9ybWFsaXplKCk7IC8vIENvbnRhY3QgcG9pbnQgbG9jYXRpb25zCgogICAgICBjb250YWN0RXEucmkuY29weShjb250YWN0RXEubmkpOwogICAgICBjb250YWN0RXEucmouY29weShjb250YWN0RXEubmkpOwogICAgICBjb250YWN0RXEucmkuc2NhbGUoc2kucmFkaXVzLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmouc2NhbGUoLXNqLnJhZGl1cywgY29udGFjdEVxLnJqKTsKICAgICAgY29udGFjdEVxLnJpLnZhZGQoeGksIGNvbnRhY3RFcS5yaSk7CiAgICAgIGNvbnRhY3RFcS5yaS52c3ViKGJpLnBvc2l0aW9uLCBjb250YWN0RXEucmkpOwogICAgICBjb250YWN0RXEucmoudmFkZCh4aiwgY29udGFjdEVxLnJqKTsKICAgICAgY29udGFjdEVxLnJqLnZzdWIoYmoucG9zaXRpb24sIGNvbnRhY3RFcS5yaik7CiAgICAgIHRoaXMucmVzdWx0LnB1c2goY29udGFjdEVxKTsKICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KGNvbnRhY3RFcSwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICB9CgogICAgc3BoZXJlUGxhbmUoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gV2Ugd2lsbCBoYXZlIG9uZSBjb250YWN0IGluIHRoaXMgY2FzZQogICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsgLy8gQ29udGFjdCBub3JtYWwKCiAgICAgIHIubmkuc2V0KDAsIDAsIDEpOwogICAgICBxai52bXVsdChyLm5pLCByLm5pKTsKICAgICAgci5uaS5uZWdhdGUoci5uaSk7IC8vIGJvZHkgaSBpcyB0aGUgc3BoZXJlLCBmbGlwIG5vcm1hbAoKICAgICAgci5uaS5ub3JtYWxpemUoKTsgLy8gTmVlZGVkPwogICAgICAvLyBWZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIGNvbnRhY3QgcG9pbnQKCiAgICAgIHIubmkuc2NhbGUoc2kucmFkaXVzLCByLnJpKTsgLy8gUHJvamVjdCBkb3duIHNwaGVyZSBvbiBwbGFuZQoKICAgICAgeGkudnN1Yih4aiwgcG9pbnRfb25fcGxhbmVfdG9fc3BoZXJlKTsKICAgICAgci5uaS5zY2FsZShyLm5pLmRvdChwb2ludF9vbl9wbGFuZV90b19zcGhlcmUpLCBwbGFuZV90b19zcGhlcmVfb3J0aG8pOwogICAgICBwb2ludF9vbl9wbGFuZV90b19zcGhlcmUudnN1YihwbGFuZV90b19zcGhlcmVfb3J0aG8sIHIucmopOyAvLyBUaGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byBwbGFuZQoKICAgICAgaWYgKC1wb2ludF9vbl9wbGFuZV90b19zcGhlcmUuZG90KHIubmkpIDw9IHNpLnJhZGl1cykgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSAvLyBNYWtlIGl0IHJlbGF0aXZlIHRvIHRoZSBib2R5CgoKICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgY29uc3QgcmogPSByLnJqOwogICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfQogICAgfQoKICAgIGJveEJveChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24ubWF0ZXJpYWwgPSBzaS5tYXRlcmlhbDsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2oubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4Q29udmV4KHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbiwgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCBzaSwgc2osIGp1c3RUZXN0KTsKICAgIH0KCiAgICBzcGhlcmVCb3goc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgdjNwb29sID0gdGhpcy52M3Bvb2w7IC8vIHdlIHJlZmVyIHRvIHRoZSBib3ggYXMgYm9keSBqCgogICAgICBjb25zdCBzaWRlcyA9IHNwaGVyZUJveF9zaWRlczsKICAgICAgeGkudnN1Yih4aiwgYm94X3RvX3NwaGVyZSk7CiAgICAgIHNqLmdldFNpZGVOb3JtYWxzKHNpZGVzLCBxaik7CiAgICAgIGNvbnN0IFIgPSBzaS5yYWRpdXM7CiAgICAgIGxldCBmb3VuZCA9IGZhbHNlOyAvLyBTdG9yZSB0aGUgcmVzdWx0aW5nIHNpZGUgcGVuZXRyYXRpb24gaW5mbwoKICAgICAgY29uc3Qgc2lkZV9ucyA9IHNwaGVyZUJveF9zaWRlX25zOwogICAgICBjb25zdCBzaWRlX25zMSA9IHNwaGVyZUJveF9zaWRlX25zMTsKICAgICAgY29uc3Qgc2lkZV9uczIgPSBzcGhlcmVCb3hfc2lkZV9uczI7CiAgICAgIGxldCBzaWRlX2ggPSBudWxsOwogICAgICBsZXQgc2lkZV9wZW5ldHJhdGlvbnMgPSAwOwogICAgICBsZXQgc2lkZV9kb3QxID0gMDsKICAgICAgbGV0IHNpZGVfZG90MiA9IDA7CiAgICAgIGxldCBzaWRlX2Rpc3RhbmNlID0gbnVsbDsKCiAgICAgIGZvciAobGV0IGlkeCA9IDAsIG5zaWRlcyA9IHNpZGVzLmxlbmd0aDsgaWR4ICE9PSBuc2lkZXMgJiYgZm91bmQgPT09IGZhbHNlOyBpZHgrKykgewogICAgICAgIC8vIEdldCB0aGUgcGxhbmUgc2lkZSBub3JtYWwgKG5zKQogICAgICAgIGNvbnN0IG5zID0gc3BoZXJlQm94X25zOwogICAgICAgIG5zLmNvcHkoc2lkZXNbaWR4XSk7CiAgICAgICAgY29uc3QgaCA9IG5zLmxlbmd0aCgpOwogICAgICAgIG5zLm5vcm1hbGl6ZSgpOyAvLyBUaGUgbm9ybWFsL2Rpc3RhbmNlIGRvdCBwcm9kdWN0IHRlbGxzIHdoaWNoIHNpZGUgb2YgdGhlIHBsYW5lIHdlIGFyZQoKICAgICAgICBjb25zdCBkb3QgPSBib3hfdG9fc3BoZXJlLmRvdChucyk7CgogICAgICAgIGlmIChkb3QgPCBoICsgUiAmJiBkb3QgPiAwKSB7CiAgICAgICAgICAvLyBJbnRlcnNlY3RzIHBsYW5lLiBOb3cgY2hlY2sgdGhlIG90aGVyIHR3byBkaW1lbnNpb25zCiAgICAgICAgICBjb25zdCBuczEgPSBzcGhlcmVCb3hfbnMxOwogICAgICAgICAgY29uc3QgbnMyID0gc3BoZXJlQm94X25zMjsKICAgICAgICAgIG5zMS5jb3B5KHNpZGVzWyhpZHggKyAxKSAlIDNdKTsKICAgICAgICAgIG5zMi5jb3B5KHNpZGVzWyhpZHggKyAyKSAlIDNdKTsKICAgICAgICAgIGNvbnN0IGgxID0gbnMxLmxlbmd0aCgpOwogICAgICAgICAgY29uc3QgaDIgPSBuczIubGVuZ3RoKCk7CiAgICAgICAgICBuczEubm9ybWFsaXplKCk7CiAgICAgICAgICBuczIubm9ybWFsaXplKCk7CiAgICAgICAgICBjb25zdCBkb3QxID0gYm94X3RvX3NwaGVyZS5kb3QobnMxKTsKICAgICAgICAgIGNvbnN0IGRvdDIgPSBib3hfdG9fc3BoZXJlLmRvdChuczIpOwoKICAgICAgICAgIGlmIChkb3QxIDwgaDEgJiYgZG90MSA+IC1oMSAmJiBkb3QyIDwgaDIgJiYgZG90MiA+IC1oMikgewogICAgICAgICAgICBjb25zdCBkaXN0ID0gTWF0aC5hYnMoZG90IC0gaCAtIFIpOwoKICAgICAgICAgICAgaWYgKHNpZGVfZGlzdGFuY2UgPT09IG51bGwgfHwgZGlzdCA8IHNpZGVfZGlzdGFuY2UpIHsKICAgICAgICAgICAgICBzaWRlX2Rpc3RhbmNlID0gZGlzdDsKICAgICAgICAgICAgICBzaWRlX2RvdDEgPSBkb3QxOwogICAgICAgICAgICAgIHNpZGVfZG90MiA9IGRvdDI7CiAgICAgICAgICAgICAgc2lkZV9oID0gaDsKICAgICAgICAgICAgICBzaWRlX25zLmNvcHkobnMpOwogICAgICAgICAgICAgIHNpZGVfbnMxLmNvcHkobnMxKTsKICAgICAgICAgICAgICBzaWRlX25zMi5jb3B5KG5zMik7CiAgICAgICAgICAgICAgc2lkZV9wZW5ldHJhdGlvbnMrKzsKCiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChzaWRlX3BlbmV0cmF0aW9ucykgewogICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICBzaWRlX25zLnNjYWxlKC1SLCByLnJpKTsgLy8gU3BoZXJlIHIKCiAgICAgICAgci5uaS5jb3B5KHNpZGVfbnMpOwogICAgICAgIHIubmkubmVnYXRlKHIubmkpOyAvLyBOb3JtYWwgc2hvdWxkIGJlIG91dCBvZiBzcGhlcmUKCiAgICAgICAgc2lkZV9ucy5zY2FsZShzaWRlX2gsIHNpZGVfbnMpOwogICAgICAgIHNpZGVfbnMxLnNjYWxlKHNpZGVfZG90MSwgc2lkZV9uczEpOwogICAgICAgIHNpZGVfbnMudmFkZChzaWRlX25zMSwgc2lkZV9ucyk7CiAgICAgICAgc2lkZV9uczIuc2NhbGUoc2lkZV9kb3QyLCBzaWRlX25zMik7CiAgICAgICAgc2lkZV9ucy52YWRkKHNpZGVfbnMyLCByLnJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgci5yaS52YWRkKHhpLCByLnJpKTsKICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgIHIucmoudmFkZCh4aiwgci5yaik7CiAgICAgICAgci5yai52c3ViKGJqLnBvc2l0aW9uLCByLnJqKTsKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfSAvLyBDaGVjayBjb3JuZXJzCgoKICAgICAgbGV0IHJqID0gdjNwb29sLmdldCgpOwogICAgICBjb25zdCBzcGhlcmVfdG9fY29ybmVyID0gc3BoZXJlQm94X3NwaGVyZV90b19jb3JuZXI7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gMiAmJiAhZm91bmQ7IGorKykgewogICAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSAyICYmICFmb3VuZDsgaysrKSB7CiAgICAgICAgICBmb3IgKGxldCBsID0gMDsgbCAhPT0gMiAmJiAhZm91bmQ7IGwrKykgewogICAgICAgICAgICByai5zZXQoMCwgMCwgMCk7CgogICAgICAgICAgICBpZiAoaikgewogICAgICAgICAgICAgIHJqLnZhZGQoc2lkZXNbMF0sIHJqKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByai52c3ViKHNpZGVzWzBdLCByaik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChrKSB7CiAgICAgICAgICAgICAgcmoudmFkZChzaWRlc1sxXSwgcmopOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJqLnZzdWIoc2lkZXNbMV0sIHJqKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGwpIHsKICAgICAgICAgICAgICByai52YWRkKHNpZGVzWzJdLCByaik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcmoudnN1YihzaWRlc1syXSwgcmopOwogICAgICAgICAgICB9IC8vIFdvcmxkIHBvc2l0aW9uIG9mIGNvcm5lcgoKCiAgICAgICAgICAgIHhqLnZhZGQocmosIHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgICBzcGhlcmVfdG9fY29ybmVyLnZzdWIoeGksIHNwaGVyZV90b19jb3JuZXIpOwoKICAgICAgICAgICAgaWYgKHNwaGVyZV90b19jb3JuZXIubGVuZ3RoU3F1YXJlZCgpIDwgUiAqIFIpIHsKICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgICAgIHIucmkuY29weShzcGhlcmVfdG9fY29ybmVyKTsKICAgICAgICAgICAgICByLnJpLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuY29weShyLnJpKTsKICAgICAgICAgICAgICByLnJpLnNjYWxlKFIsIHIucmkpOwogICAgICAgICAgICAgIHIucmouY29weShyaik7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICAgICAgci5yaS52c3ViKGJpLnBvc2l0aW9uLCByLnJpKTsKICAgICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHYzcG9vbC5yZWxlYXNlKHJqKTsKICAgICAgcmogPSBudWxsOyAvLyBDaGVjayBlZGdlcwoKICAgICAgY29uc3QgZWRnZVRhbmdlbnQgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IGVkZ2VDZW50ZXIgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgIGNvbnN0IHIgPSB2M3Bvb2wuZ2V0KCk7IC8vIHIgPSBlZGdlIGNlbnRlciB0byBzcGhlcmUgY2VudGVyCgogICAgICBjb25zdCBvcnRob2dvbmFsID0gdjNwb29sLmdldCgpOwogICAgICBjb25zdCBkaXN0ID0gdjNwb29sLmdldCgpOwogICAgICBjb25zdCBOc2lkZXMgPSBzaWRlcy5sZW5ndGg7CgogICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gTnNpZGVzICYmICFmb3VuZDsgaisrKSB7CiAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgIT09IE5zaWRlcyAmJiAhZm91bmQ7IGsrKykgewogICAgICAgICAgaWYgKGogJSAzICE9PSBrICUgMykgewogICAgICAgICAgICAvLyBHZXQgZWRnZSB0YW5nZW50CiAgICAgICAgICAgIHNpZGVzW2tdLmNyb3NzKHNpZGVzW2pdLCBlZGdlVGFuZ2VudCk7CiAgICAgICAgICAgIGVkZ2VUYW5nZW50Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBzaWRlc1tqXS52YWRkKHNpZGVzW2tdLCBlZGdlQ2VudGVyKTsKICAgICAgICAgICAgci5jb3B5KHhpKTsKICAgICAgICAgICAgci52c3ViKGVkZ2VDZW50ZXIsIHIpOwogICAgICAgICAgICByLnZzdWIoeGosIHIpOwogICAgICAgICAgICBjb25zdCBvcnRob25vcm0gPSByLmRvdChlZGdlVGFuZ2VudCk7IC8vIGRpc3RhbmNlIGZyb20gZWRnZSBjZW50ZXIgdG8gc3BoZXJlIGNlbnRlciBpbiB0aGUgdGFuZ2VudCBkaXJlY3Rpb24KCiAgICAgICAgICAgIGVkZ2VUYW5nZW50LnNjYWxlKG9ydGhvbm9ybSwgb3J0aG9nb25hbCk7IC8vIFZlY3RvciBmcm9tIGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBjZW50ZXIgaW4gdGhlIHRhbmdlbnQgZGlyZWN0aW9uCiAgICAgICAgICAgIC8vIEZpbmQgdGhlIHRoaXJkIHNpZGUgb3J0aG9nb25hbCB0byB0aGlzIG9uZQoKICAgICAgICAgICAgbGV0IGwgPSAwOwoKICAgICAgICAgICAgd2hpbGUgKGwgPT09IGogJSAzIHx8IGwgPT09IGsgJSAzKSB7CiAgICAgICAgICAgICAgbCsrOwogICAgICAgICAgICB9IC8vIHZlYyBmcm9tIGVkZ2UgY2VudGVyIHRvIHNwaGVyZSBwcm9qZWN0ZWQgdG8gdGhlIHBsYW5lIG9ydGhvZ29uYWwgdG8gdGhlIGVkZ2UgdGFuZ2VudAoKCiAgICAgICAgICAgIGRpc3QuY29weSh4aSk7CiAgICAgICAgICAgIGRpc3QudnN1YihvcnRob2dvbmFsLCBkaXN0KTsKICAgICAgICAgICAgZGlzdC52c3ViKGVkZ2VDZW50ZXIsIGRpc3QpOwogICAgICAgICAgICBkaXN0LnZzdWIoeGosIGRpc3QpOyAvLyBEaXN0YW5jZXMgaW4gdGFuZ2VudCBkaXJlY3Rpb24gYW5kIGRpc3RhbmNlIGluIHRoZSBwbGFuZSBvcnRob2dvbmFsIHRvIGl0CgogICAgICAgICAgICBjb25zdCB0ZGlzdCA9IE1hdGguYWJzKG9ydGhvbm9ybSk7CiAgICAgICAgICAgIGNvbnN0IG5kaXN0ID0gZGlzdC5sZW5ndGgoKTsKCiAgICAgICAgICAgIGlmICh0ZGlzdCA8IHNpZGVzW2xdLmxlbmd0aCgpICYmIG5kaXN0IDwgUikgewogICAgICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgY29uc3QgcmVzID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICAgICAgICBlZGdlQ2VudGVyLnZhZGQob3J0aG9nb25hbCwgcmVzLnJqKTsgLy8gYm94IHJqCgogICAgICAgICAgICAgIHJlcy5yai5jb3B5KHJlcy5yaik7CiAgICAgICAgICAgICAgZGlzdC5uZWdhdGUocmVzLm5pKTsKICAgICAgICAgICAgICByZXMubmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgcmVzLnJpLmNvcHkocmVzLnJqKTsKICAgICAgICAgICAgICByZXMucmkudmFkZCh4aiwgcmVzLnJpKTsKICAgICAgICAgICAgICByZXMucmkudnN1Yih4aSwgcmVzLnJpKTsKICAgICAgICAgICAgICByZXMucmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgcmVzLnJpLnNjYWxlKFIsIHJlcy5yaSk7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgICAgIHJlcy5yaS52YWRkKHhpLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yaS52c3ViKGJpLnBvc2l0aW9uLCByZXMucmkpOwogICAgICAgICAgICAgIHJlcy5yai52YWRkKHhqLCByZXMucmopOwogICAgICAgICAgICAgIHJlcy5yai52c3ViKGJqLnBvc2l0aW9uLCByZXMucmopOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocmVzKTsKICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QocmVzLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgdjNwb29sLnJlbGVhc2UoZWRnZVRhbmdlbnQsIGVkZ2VDZW50ZXIsIHIsIG9ydGhvZ29uYWwsIGRpc3QpOwogICAgfQoKICAgIHBsYW5lQm94KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIHNqLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNqLm1hdGVyaWFsOwogICAgICBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzai5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgc2ouY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLmlkID0gc2ouaWQ7CiAgICAgIHJldHVybiB0aGlzLnBsYW5lQ29udmV4KHNpLCBzai5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24sIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHNpLCBzaiwganVzdFRlc3QpOwogICAgfQoKICAgIGNvbnZleENvbnZleChzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCwgZmFjZUxpc3RBLCBmYWNlTGlzdEIpIHsKICAgICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwoKICAgICAgaWYgKHhpLmRpc3RhbmNlVG8oeGopID4gc2kuYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzai5ib3VuZGluZ1NwaGVyZVJhZGl1cykgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHNpLmZpbmRTZXBhcmF0aW5nQXhpcyhzaiwgeGksIHFpLCB4aiwgcWosIHNlcEF4aXMsIGZhY2VMaXN0QSwgZmFjZUxpc3RCKSkgewogICAgICAgIGNvbnN0IHJlcyA9IFtdOwogICAgICAgIGNvbnN0IHEgPSBjb252ZXhDb252ZXhfcTsKICAgICAgICBzaS5jbGlwQWdhaW5zdEh1bGwoeGksIHFpLCBzaiwgeGosIHFqLCBzZXBBeGlzLCAtMTAwLCAxMDAsIHJlcyk7CiAgICAgICAgbGV0IG51bUNvbnRhY3RzID0gMDsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogIT09IHJlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgY29uc3QgcmkgPSByLnJpOwogICAgICAgICAgY29uc3QgcmogPSByLnJqOwogICAgICAgICAgc2VwQXhpcy5uZWdhdGUoci5uaSk7CiAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgICAgICAgIHEuc2NhbGUocmVzW2pdLmRlcHRoLCBxKTsKICAgICAgICAgIHJlc1tqXS5wb2ludC52YWRkKHEsIHJpKTsKICAgICAgICAgIHJqLmNvcHkocmVzW2pdLnBvaW50KTsgLy8gQ29udGFjdCBwb2ludHMgYXJlIGluIHdvcmxkIGNvb3JkaW5hdGVzLiBUcmFuc2Zvcm0gYmFjayB0byByZWxhdGl2ZQoKICAgICAgICAgIHJpLnZzdWIoeGksIHJpKTsKICAgICAgICAgIHJqLnZzdWIoeGosIHJqKTsgLy8gTWFrZSByZWxhdGl2ZSB0byBib2RpZXMKCiAgICAgICAgICByaS52YWRkKHhpLCByaSk7CiAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAgICAgICByai52YWRkKHhqLCByaik7CiAgICAgICAgICByai52c3ViKGJqLnBvc2l0aW9uLCByaik7CiAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgbnVtQ29udGFjdHMrKzsKCiAgICAgICAgICBpZiAoIXRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24pIHsKICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuZW5hYmxlRnJpY3Rpb25SZWR1Y3Rpb24gJiYgbnVtQ29udGFjdHMpIHsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25Gcm9tQXZlcmFnZShudW1Db250YWN0cyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3BoZXJlQ29udmV4KHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IHYzcG9vbCA9IHRoaXMudjNwb29sOwogICAgICB4aS52c3ViKHhqLCBjb252ZXhfdG9fc3BoZXJlKTsKICAgICAgY29uc3Qgbm9ybWFscyA9IHNqLmZhY2VOb3JtYWxzOwogICAgICBjb25zdCBmYWNlcyA9IHNqLmZhY2VzOwogICAgICBjb25zdCB2ZXJ0cyA9IHNqLnZlcnRpY2VzOwogICAgICBjb25zdCBSID0gc2kucmFkaXVzOyAvLyAgICAgcmV0dXJuOwogICAgICAvLyB9CgogICAgICBsZXQgZm91bmQgPSBmYWxzZTsgLy8gQ2hlY2sgY29ybmVycwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IHZlcnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgdiA9IHZlcnRzW2ldOyAvLyBXb3JsZCBwb3NpdGlvbiBvZiBjb3JuZXIKCiAgICAgICAgY29uc3Qgd29ybGRDb3JuZXIgPSBzcGhlcmVDb252ZXhfd29ybGRDb3JuZXI7CiAgICAgICAgcWoudm11bHQodiwgd29ybGRDb3JuZXIpOwogICAgICAgIHhqLnZhZGQod29ybGRDb3JuZXIsIHdvcmxkQ29ybmVyKTsKICAgICAgICBjb25zdCBzcGhlcmVfdG9fY29ybmVyID0gc3BoZXJlQ29udmV4X3NwaGVyZVRvQ29ybmVyOwogICAgICAgIHdvcmxkQ29ybmVyLnZzdWIoeGksIHNwaGVyZV90b19jb3JuZXIpOwoKICAgICAgICBpZiAoc3BoZXJlX3RvX2Nvcm5lci5sZW5ndGhTcXVhcmVkKCkgPCBSICogUikgewogICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgci5yaS5jb3B5KHNwaGVyZV90b19jb3JuZXIpOwogICAgICAgICAgci5yaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuY29weShyLnJpKTsKICAgICAgICAgIHIucmkuc2NhbGUoUiwgci5yaSk7CiAgICAgICAgICB3b3JsZENvcm5lci52c3ViKHhqLCByLnJqKTsgLy8gU2hvdWxkIGJlIHJlbGF0aXZlIHRvIHRoZSBib2R5LgoKICAgICAgICAgIHIucmkudmFkZCh4aSwgci5yaSk7CiAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSAvLyBDaGVjayBzaWRlIChwbGFuZSkgaW50ZXJzZWN0aW9ucwoKCiAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBmYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlcyAmJiBmb3VuZCA9PT0gZmFsc2U7IGkrKykgewogICAgICAgIGNvbnN0IG5vcm1hbCA9IG5vcm1hbHNbaV07CiAgICAgICAgY29uc3QgZmFjZSA9IGZhY2VzW2ldOyAvLyBHZXQgd29ybGQtdHJhbnNmb3JtZWQgbm9ybWFsIG9mIHRoZSBmYWNlCgogICAgICAgIGNvbnN0IHdvcmxkTm9ybWFsID0gc3BoZXJlQ29udmV4X3dvcmxkTm9ybWFsOwogICAgICAgIHFqLnZtdWx0KG5vcm1hbCwgd29ybGROb3JtYWwpOyAvLyBHZXQgYSB3b3JsZCB2ZXJ0ZXggZnJvbSB0aGUgZmFjZQoKICAgICAgICBjb25zdCB3b3JsZFBvaW50ID0gc3BoZXJlQ29udmV4X3dvcmxkUG9pbnQ7CiAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVswXV0sIHdvcmxkUG9pbnQpOwogICAgICAgIHdvcmxkUG9pbnQudmFkZCh4aiwgd29ybGRQb2ludCk7IC8vIEdldCBhIHBvaW50IG9uIHRoZSBzcGhlcmUsIGNsb3Nlc3QgdG8gdGhlIGZhY2Ugbm9ybWFsCgogICAgICAgIGNvbnN0IHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSA9IHNwaGVyZUNvbnZleF93b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmU7CiAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSk7CiAgICAgICAgeGkudmFkZCh3b3JsZFNwaGVyZVBvaW50Q2xvc2VzdFRvUGxhbmUsIHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZSk7IC8vIFZlY3RvciBmcm9tIGEgZmFjZSBwb2ludCB0byB0aGUgY2xvc2VzdCBwb2ludCBvbiB0aGUgc3BoZXJlCgogICAgICAgIGNvbnN0IHBlbmV0cmF0aW9uVmVjID0gc3BoZXJlQ29udmV4X3BlbmV0cmF0aW9uVmVjOwogICAgICAgIHdvcmxkU3BoZXJlUG9pbnRDbG9zZXN0VG9QbGFuZS52c3ViKHdvcmxkUG9pbnQsIHBlbmV0cmF0aW9uVmVjKTsgLy8gVGhlIHBlbmV0cmF0aW9uLiBOZWdhdGl2ZSB2YWx1ZSBtZWFucyBvdmVybGFwLgoKICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IHBlbmV0cmF0aW9uVmVjLmRvdCh3b3JsZE5vcm1hbCk7CiAgICAgICAgY29uc3Qgd29ybGRQb2ludFRvU3BoZXJlID0gc3BoZXJlQ29udmV4X3NwaGVyZVRvV29ybGRQb2ludDsKICAgICAgICB4aS52c3ViKHdvcmxkUG9pbnQsIHdvcmxkUG9pbnRUb1NwaGVyZSk7CgogICAgICAgIGlmIChwZW5ldHJhdGlvbiA8IDAgJiYgd29ybGRQb2ludFRvU3BoZXJlLmRvdCh3b3JsZE5vcm1hbCkgPiAwKSB7CiAgICAgICAgICAvLyBJbnRlcnNlY3RzIHBsYW5lLiBOb3cgY2hlY2sgaWYgdGhlIHNwaGVyZSBpcyBpbnNpZGUgdGhlIGZhY2UgcG9seWdvbgogICAgICAgICAgY29uc3QgZmFjZVZlcnRzID0gW107IC8vIEZhY2UgdmVydGljZXMsIGluIHdvcmxkIGNvb3JkcwoKICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOdmVydHMgPSBmYWNlLmxlbmd0aDsgaiAhPT0gTnZlcnRzOyBqKyspIHsKICAgICAgICAgICAgY29uc3Qgd29ybGRWZXJ0ZXggPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgIHFqLnZtdWx0KHZlcnRzW2ZhY2Vbal1dLCB3b3JsZFZlcnRleCk7CiAgICAgICAgICAgIHhqLnZhZGQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICAgICAgZmFjZVZlcnRzLnB1c2god29ybGRWZXJ0ZXgpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChwb2ludEluUG9seWdvbihmYWNlVmVydHMsIHdvcmxkTm9ybWFsLCB4aSkpIHsKICAgICAgICAgICAgLy8gSXMgdGhlIHNwaGVyZSBjZW50ZXIgaW4gdGhlIGZhY2UgcG9seWdvbj8KICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgIHdvcmxkTm9ybWFsLnNjYWxlKC1SLCByLnJpKTsgLy8gQ29udGFjdCBvZmZzZXQsIGZyb20gc3BoZXJlIGNlbnRlciB0byBjb250YWN0CgogICAgICAgICAgICB3b3JsZE5vcm1hbC5uZWdhdGUoci5uaSk7IC8vIE5vcm1hbCBwb2ludGluZyBvdXQgb2Ygc3BoZXJlCgogICAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvblZlYzIgPSB2M3Bvb2wuZ2V0KCk7CiAgICAgICAgICAgIHdvcmxkTm9ybWFsLnNjYWxlKC1wZW5ldHJhdGlvbiwgcGVuZXRyYXRpb25WZWMyKTsKICAgICAgICAgICAgY29uc3QgcGVuZXRyYXRpb25TcGhlcmVQb2ludCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgd29ybGROb3JtYWwuc2NhbGUoLVIsIHBlbmV0cmF0aW9uU3BoZXJlUG9pbnQpOyAvL3hpLnZzdWIoeGopLnZhZGQocGVuZXRyYXRpb25TcGhlcmVQb2ludCkudmFkZChwZW5ldHJhdGlvblZlYzIgLCByLnJqKTsKCiAgICAgICAgICAgIHhpLnZzdWIoeGosIHIucmopOwogICAgICAgICAgICByLnJqLnZhZGQocGVuZXRyYXRpb25TcGhlcmVQb2ludCwgci5yaik7CiAgICAgICAgICAgIHIucmoudmFkZChwZW5ldHJhdGlvblZlYzIsIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgICByLnJqLnZhZGQoeGosIHIucmopOwogICAgICAgICAgICByLnJqLnZzdWIoYmoucG9zaXRpb24sIHIucmopOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoYmkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgICB2M3Bvb2wucmVsZWFzZShwZW5ldHJhdGlvblZlYzIpOwogICAgICAgICAgICB2M3Bvb2wucmVsZWFzZShwZW5ldHJhdGlvblNwaGVyZVBvaW50KTsKICAgICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOyAvLyBSZWxlYXNlIHdvcmxkIHZlcnRpY2VzCgogICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgTmZhY2V2ZXJ0cyA9IGZhY2VWZXJ0cy5sZW5ndGg7IGogIT09IE5mYWNldmVydHM7IGorKykgewogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybjsgLy8gV2Ugb25seSBleHBlY3QgKm9uZSogZmFjZSBjb250YWN0CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyBFZGdlPwogICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiAhPT0gZmFjZS5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIC8vIEdldCB0d28gd29ybGQgdHJhbnNmb3JtZWQgdmVydGljZXMKICAgICAgICAgICAgICBjb25zdCB2MSA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICBjb25zdCB2MiA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICBxai52bXVsdCh2ZXJ0c1tmYWNlWyhqICsgMSkgJSBmYWNlLmxlbmd0aF1dLCB2MSk7CiAgICAgICAgICAgICAgcWoudm11bHQodmVydHNbZmFjZVsoaiArIDIpICUgZmFjZS5sZW5ndGhdXSwgdjIpOwogICAgICAgICAgICAgIHhqLnZhZGQodjEsIHYxKTsKICAgICAgICAgICAgICB4ai52YWRkKHYyLCB2Mik7IC8vIENvbnN0cnVjdCBlZGdlIHZlY3RvcgoKICAgICAgICAgICAgICBjb25zdCBlZGdlID0gc3BoZXJlQ29udmV4X2VkZ2U7CiAgICAgICAgICAgICAgdjIudnN1Yih2MSwgZWRnZSk7IC8vIENvbnN0cnVjdCB0aGUgc2FtZSB2ZWN0b3IsIGJ1dCBub3JtYWxpemVkCgogICAgICAgICAgICAgIGNvbnN0IGVkZ2VVbml0ID0gc3BoZXJlQ29udmV4X2VkZ2VVbml0OwogICAgICAgICAgICAgIGVkZ2UudW5pdChlZGdlVW5pdCk7IC8vIHAgaXMgeGkgcHJvamVjdGVkIG9udG8gdGhlIGVkZ2UKCiAgICAgICAgICAgICAgY29uc3QgcCA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICBjb25zdCB2MV90b194aSA9IHYzcG9vbC5nZXQoKTsKICAgICAgICAgICAgICB4aS52c3ViKHYxLCB2MV90b194aSk7CiAgICAgICAgICAgICAgY29uc3QgZG90ID0gdjFfdG9feGkuZG90KGVkZ2VVbml0KTsKICAgICAgICAgICAgICBlZGdlVW5pdC5zY2FsZShkb3QsIHApOwogICAgICAgICAgICAgIHAudmFkZCh2MSwgcCk7IC8vIENvbXB1dGUgYSB2ZWN0b3IgZnJvbSBwIHRvIHRoZSBjZW50ZXIgb2YgdGhlIHNwaGVyZQoKICAgICAgICAgICAgICBjb25zdCB4aV90b19wID0gdjNwb29sLmdldCgpOwogICAgICAgICAgICAgIHAudnN1Yih4aSwgeGlfdG9fcCk7IC8vIENvbGxpc2lvbiBpZiB0aGUgZWRnZS1zcGhlcmUgZGlzdGFuY2UgaXMgbGVzcyB0aGFuIHRoZSByYWRpdXMKICAgICAgICAgICAgICAvLyBBTkQgaWYgcCBpcyBpbiBiZXR3ZWVuIHYxIGFuZCB2MgoKICAgICAgICAgICAgICBpZiAoZG90ID4gMCAmJiBkb3QgKiBkb3QgPCBlZGdlLmxlbmd0aFNxdWFyZWQoKSAmJiB4aV90b19wLmxlbmd0aFNxdWFyZWQoKSA8IFIgKiBSKSB7CiAgICAgICAgICAgICAgICAvLyBDb2xsaXNpb24gaWYgdGhlIGVkZ2Utc3BoZXJlIGRpc3RhbmNlIGlzIGxlc3MgdGhhbiB0aGUgcmFkaXVzCiAgICAgICAgICAgICAgICAvLyBFZGdlIGNvbnRhY3QhCiAgICAgICAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgICAgICAgICBwLnZzdWIoeGosIHIucmopOwogICAgICAgICAgICAgICAgcC52c3ViKHhpLCByLm5pKTsKICAgICAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7CiAgICAgICAgICAgICAgICByLm5pLnNjYWxlKFIsIHIucmkpOyAvLyBTaG91bGQgYmUgcmVsYXRpdmUgdG8gdGhlIGJvZHkuCgogICAgICAgICAgICAgICAgci5yai52YWRkKHhqLCByLnJqKTsKICAgICAgICAgICAgICAgIHIucmoudnN1Yihiai5wb3NpdGlvbiwgci5yaik7IC8vIFNob3VsZCBiZSByZWxhdGl2ZSB0byB0aGUgYm9keS4KCiAgICAgICAgICAgICAgICByLnJpLnZhZGQoeGksIHIucmkpOwogICAgICAgICAgICAgICAgci5yaS52c3ViKGJpLnBvc2l0aW9uLCByLnJpKTsKICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7IC8vIFJlbGVhc2Ugd29ybGQgdmVydGljZXMKCiAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMCwgTmZhY2V2ZXJ0cyA9IGZhY2VWZXJ0cy5sZW5ndGg7IGogIT09IE5mYWNldmVydHM7IGorKykgewogICAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZShmYWNlVmVydHNbal0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYyKTsKICAgICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHApOwogICAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UoeGlfdG9fcCk7CiAgICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2MV90b194aSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2M3Bvb2wucmVsZWFzZSh2MSk7CiAgICAgICAgICAgICAgdjNwb29sLnJlbGVhc2UodjIpOwogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHApOwogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHhpX3RvX3ApOwogICAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKHYxX3RvX3hpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSAvLyBSZWxlYXNlIHdvcmxkIHZlcnRpY2VzCgoKICAgICAgICAgIGZvciAobGV0IGogPSAwLCBOZmFjZXZlcnRzID0gZmFjZVZlcnRzLmxlbmd0aDsgaiAhPT0gTmZhY2V2ZXJ0czsgaisrKSB7CiAgICAgICAgICAgIHYzcG9vbC5yZWxlYXNlKGZhY2VWZXJ0c1tqXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcGxhbmVDb252ZXgocGxhbmVTaGFwZSwgY29udmV4U2hhcGUsIHBsYW5lUG9zaXRpb24sIGNvbnZleFBvc2l0aW9uLCBwbGFuZVF1YXQsIGNvbnZleFF1YXQsIHBsYW5lQm9keSwgY29udmV4Qm9keSwgc2ksIHNqLCBqdXN0VGVzdCkgewogICAgICAvLyBTaW1wbHkgcmV0dXJuIHRoZSBwb2ludHMgYmVoaW5kIHRoZSBwbGFuZS4KICAgICAgY29uc3Qgd29ybGRWZXJ0ZXggPSBwbGFuZUNvbnZleF92OwogICAgICBjb25zdCB3b3JsZE5vcm1hbCA9IHBsYW5lQ29udmV4X25vcm1hbDsKICAgICAgd29ybGROb3JtYWwuc2V0KDAsIDAsIDEpOwogICAgICBwbGFuZVF1YXQudm11bHQod29ybGROb3JtYWwsIHdvcmxkTm9ybWFsKTsgLy8gVHVybiBub3JtYWwgYWNjb3JkaW5nIHRvIHBsYW5lIG9yaWVudGF0aW9uCgogICAgICBsZXQgbnVtQ29udGFjdHMgPSAwOwogICAgICBjb25zdCByZWxwb3MgPSBwbGFuZUNvbnZleF9yZWxwb3M7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSAhPT0gY29udmV4U2hhcGUudmVydGljZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBHZXQgd29ybGQgY29udmV4IHZlcnRleAogICAgICAgIHdvcmxkVmVydGV4LmNvcHkoY29udmV4U2hhcGUudmVydGljZXNbaV0pOwogICAgICAgIGNvbnZleFF1YXQudm11bHQod29ybGRWZXJ0ZXgsIHdvcmxkVmVydGV4KTsKICAgICAgICBjb252ZXhQb3NpdGlvbi52YWRkKHdvcmxkVmVydGV4LCB3b3JsZFZlcnRleCk7CiAgICAgICAgd29ybGRWZXJ0ZXgudnN1YihwbGFuZVBvc2l0aW9uLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IHdvcmxkTm9ybWFsLmRvdChyZWxwb3MpOwoKICAgICAgICBpZiAoZG90IDw9IDAuMCkgewogICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihwbGFuZUJvZHksIGNvbnZleEJvZHksIHBsYW5lU2hhcGUsIGNvbnZleFNoYXBlLCBzaSwgc2opOyAvLyBHZXQgdmVydGV4IHBvc2l0aW9uIHByb2plY3RlZCBvbiBwbGFuZQoKICAgICAgICAgIGNvbnN0IHByb2plY3RlZCA9IHBsYW5lQ29udmV4X3Byb2plY3RlZDsKICAgICAgICAgIHdvcmxkTm9ybWFsLnNjYWxlKHdvcmxkTm9ybWFsLmRvdChyZWxwb3MpLCBwcm9qZWN0ZWQpOwogICAgICAgICAgd29ybGRWZXJ0ZXgudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7CiAgICAgICAgICBwcm9qZWN0ZWQudnN1YihwbGFuZVBvc2l0aW9uLCByLnJpKTsgLy8gRnJvbSBwbGFuZSB0byB2ZXJ0ZXggcHJvamVjdGVkIG9uIHBsYW5lCgogICAgICAgICAgci5uaS5jb3B5KHdvcmxkTm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbCBvdXQgZnJvbSBwbGFuZQogICAgICAgICAgLy8gcmogaXMgbm93IGp1c3QgdGhlIHZlY3RvciBmcm9tIHRoZSBjb252ZXggY2VudGVyIHRvIHRoZSB2ZXJ0ZXgKCiAgICAgICAgICB3b3JsZFZlcnRleC52c3ViKGNvbnZleFBvc2l0aW9uLCByLnJqKTsgLy8gTWFrZSBpdCByZWxhdGl2ZSB0byB0aGUgYm9keQoKICAgICAgICAgIHIucmkudmFkZChwbGFuZVBvc2l0aW9uLCByLnJpKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai52YWRkKGNvbnZleFBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHIucmoudnN1Yihjb252ZXhCb2R5LnBvc2l0aW9uLCByLnJqKTsKICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICBudW1Db250YWN0cysrOwoKICAgICAgICAgIGlmICghdGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbikgewogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5lbmFibGVGcmljdGlvblJlZHVjdGlvbiAmJiBudW1Db250YWN0cykgewogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25Gcm9tQXZlcmFnZShudW1Db250YWN0cyk7CiAgICAgIH0KICAgIH0KCiAgICBib3hDb252ZXgoc2ksIHNqLCB4aSwgeGosIHFpLCBxaiwgYmksIGJqLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLm1hdGVyaWFsID0gc2kubWF0ZXJpYWw7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5jb2xsaXNpb25SZXNwb25zZSA9IHNpLmNvbGxpc2lvblJlc3BvbnNlOwogICAgICByZXR1cm4gdGhpcy5jb252ZXhDb252ZXgoc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlSGVpZ2h0ZmllbGQoc3BoZXJlU2hhcGUsIGhmU2hhcGUsIHNwaGVyZVBvcywgaGZQb3MsIHNwaGVyZVF1YXQsIGhmUXVhdCwgc3BoZXJlQm9keSwgaGZCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgZGF0YSA9IGhmU2hhcGUuZGF0YTsKICAgICAgY29uc3QgcmFkaXVzID0gc3BoZXJlU2hhcGUucmFkaXVzOwogICAgICBjb25zdCB3ID0gaGZTaGFwZS5lbGVtZW50U2l6ZTsKICAgICAgY29uc3Qgd29ybGRQaWxsYXJPZmZzZXQgPSBzcGhlcmVIZWlnaHRmaWVsZF90bXAyOyAvLyBHZXQgc3BoZXJlIHBvc2l0aW9uIHRvIGhlaWdodGZpZWxkIGxvY2FsIQoKICAgICAgY29uc3QgbG9jYWxTcGhlcmVQb3MgPSBzcGhlcmVIZWlnaHRmaWVsZF90bXAxOwogICAgICBUcmFuc2Zvcm0ucG9pbnRUb0xvY2FsRnJhbWUoaGZQb3MsIGhmUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgaW5kZXggb2YgdGhlIGRhdGEgcG9pbnRzIHRvIHRlc3QgYWdhaW5zdAoKICAgICAgbGV0IGlNaW5YID0gTWF0aC5mbG9vcigobG9jYWxTcGhlcmVQb3MueCAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WCA9IE1hdGguY2VpbCgobG9jYWxTcGhlcmVQb3MueCArIHJhZGl1cykgLyB3KSArIDE7CiAgICAgIGxldCBpTWluWSA9IE1hdGguZmxvb3IoKGxvY2FsU3BoZXJlUG9zLnkgLSByYWRpdXMpIC8gdykgLSAxOwogICAgICBsZXQgaU1heFkgPSBNYXRoLmNlaWwoKGxvY2FsU3BoZXJlUG9zLnkgKyByYWRpdXMpIC8gdykgKyAxOyAvLyBCYWlsIG91dCBpZiB3ZSBhcmUgb3V0IG9mIHRoZSB0ZXJyYWluCgogICAgICBpZiAoaU1heFggPCAwIHx8IGlNYXhZIDwgMCB8fCBpTWluWCA+IGRhdGEubGVuZ3RoIHx8IGlNaW5ZID4gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gQ2xhbXAgaW5kZXggdG8gZWRnZXMKCgogICAgICBpZiAoaU1pblggPCAwKSB7CiAgICAgICAgaU1pblggPSAwOwogICAgICB9CgogICAgICBpZiAoaU1heFggPCAwKSB7CiAgICAgICAgaU1heFggPSAwOwogICAgICB9CgogICAgICBpZiAoaU1pblkgPCAwKSB7CiAgICAgICAgaU1pblkgPSAwOwogICAgICB9CgogICAgICBpZiAoaU1heFkgPCAwKSB7CiAgICAgICAgaU1heFkgPSAwOwogICAgICB9CgogICAgICBpZiAoaU1pblggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWluWCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhYID49IGRhdGEubGVuZ3RoKSB7CiAgICAgICAgaU1heFggPSBkYXRhLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNYXhZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1pblkgPj0gZGF0YVswXS5sZW5ndGgpIHsKICAgICAgICBpTWluWSA9IGRhdGFbMF0ubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgY29uc3QgbWluTWF4ID0gW107CiAgICAgIGhmU2hhcGUuZ2V0UmVjdE1pbk1heChpTWluWCwgaU1pblksIGlNYXhYLCBpTWF4WSwgbWluTWF4KTsKICAgICAgY29uc3QgbWluID0gbWluTWF4WzBdOwogICAgICBjb25zdCBtYXggPSBtaW5NYXhbMV07IC8vIEJhaWwgb3V0IGlmIHdlIGNhbid0IHRvdWNoIHRoZSBib3VuZGluZyBoZWlnaHQgYm94CgogICAgICBpZiAobG9jYWxTcGhlcmVQb3MueiAtIHJhZGl1cyA+IG1heCB8fCBsb2NhbFNwaGVyZVBvcy56ICsgcmFkaXVzIDwgbWluKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdDsKCiAgICAgIGZvciAobGV0IGkgPSBpTWluWDsgaSA8IGlNYXhYOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gaU1pblk7IGogPCBpTWF4WTsgaisrKSB7CiAgICAgICAgICBjb25zdCBudW1Db250YWN0c0JlZm9yZSA9IHJlc3VsdC5sZW5ndGg7CiAgICAgICAgICBsZXQgaW50ZXJzZWN0aW5nID0gZmFsc2U7IC8vIExvd2VyIHRyaWFuZ2xlCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCBmYWxzZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUoaGZQb3MsIGhmUXVhdCwgaGZTaGFwZS5waWxsYXJPZmZzZXQsIHdvcmxkUGlsbGFyT2Zmc2V0KTsKCiAgICAgICAgICBpZiAoc3BoZXJlUG9zLmRpc3RhbmNlVG8od29ybGRQaWxsYXJPZmZzZXQpIDwgaGZTaGFwZS5waWxsYXJDb252ZXguYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzcGhlcmVTaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1cykgewogICAgICAgICAgICBpbnRlcnNlY3RpbmcgPSB0aGlzLnNwaGVyZUNvbnZleChzcGhlcmVTaGFwZSwgaGZTaGFwZS5waWxsYXJDb252ZXgsIHNwaGVyZVBvcywgd29ybGRQaWxsYXJPZmZzZXQsIHNwaGVyZVF1YXQsIGhmUXVhdCwgc3BoZXJlQm9keSwgaGZCb2R5LCBzcGhlcmVTaGFwZSwgaGZTaGFwZSwganVzdFRlc3QpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChqdXN0VGVzdCAmJiBpbnRlcnNlY3RpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9IC8vIFVwcGVyIHRyaWFuZ2xlCgoKICAgICAgICAgIGhmU2hhcGUuZ2V0Q29udmV4VHJpYW5nbGVQaWxsYXIoaSwgaiwgdHJ1ZSk7CiAgICAgICAgICBUcmFuc2Zvcm0ucG9pbnRUb1dvcmxkRnJhbWUoaGZQb3MsIGhmUXVhdCwgaGZTaGFwZS5waWxsYXJPZmZzZXQsIHdvcmxkUGlsbGFyT2Zmc2V0KTsKCiAgICAgICAgICBpZiAoc3BoZXJlUG9zLmRpc3RhbmNlVG8od29ybGRQaWxsYXJPZmZzZXQpIDwgaGZTaGFwZS5waWxsYXJDb252ZXguYm91bmRpbmdTcGhlcmVSYWRpdXMgKyBzcGhlcmVTaGFwZS5ib3VuZGluZ1NwaGVyZVJhZGl1cykgewogICAgICAgICAgICBpbnRlcnNlY3RpbmcgPSB0aGlzLnNwaGVyZUNvbnZleChzcGhlcmVTaGFwZSwgaGZTaGFwZS5waWxsYXJDb252ZXgsIHNwaGVyZVBvcywgd29ybGRQaWxsYXJPZmZzZXQsIHNwaGVyZVF1YXQsIGhmUXVhdCwgc3BoZXJlQm9keSwgaGZCb2R5LCBzcGhlcmVTaGFwZSwgaGZTaGFwZSwganVzdFRlc3QpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChqdXN0VGVzdCAmJiBpbnRlcnNlY3RpbmcpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgbnVtQ29udGFjdHMgPSByZXN1bHQubGVuZ3RoIC0gbnVtQ29udGFjdHNCZWZvcmU7CgogICAgICAgICAgaWYgKG51bUNvbnRhY3RzID4gMikgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgICAvKgogICAgICAgICAgICAvLyBTa2lwIGFsbCBidXQgMQogICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IG51bUNvbnRhY3RzIC0gMTsgaysrKSB7CiAgICAgICAgICAgICAgICByZXN1bHQucG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICovCgogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGJveEhlaWdodGZpZWxkKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNpLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4SGVpZ2h0ZmllbGQoc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4SGVpZ2h0ZmllbGQoY29udmV4U2hhcGUsIGhmU2hhcGUsIGNvbnZleFBvcywgaGZQb3MsIGNvbnZleFF1YXQsIGhmUXVhdCwgY29udmV4Qm9keSwgaGZCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3QgZGF0YSA9IGhmU2hhcGUuZGF0YTsKICAgICAgY29uc3QgdyA9IGhmU2hhcGUuZWxlbWVudFNpemU7CiAgICAgIGNvbnN0IHJhZGl1cyA9IGNvbnZleFNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzOwogICAgICBjb25zdCB3b3JsZFBpbGxhck9mZnNldCA9IGNvbnZleEhlaWdodGZpZWxkX3RtcDI7CiAgICAgIGNvbnN0IGZhY2VMaXN0ID0gY29udmV4SGVpZ2h0ZmllbGRfZmFjZUxpc3Q7IC8vIEdldCBzcGhlcmUgcG9zaXRpb24gdG8gaGVpZ2h0ZmllbGQgbG9jYWwhCgogICAgICBjb25zdCBsb2NhbENvbnZleFBvcyA9IGNvbnZleEhlaWdodGZpZWxkX3RtcDE7CiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZShoZlBvcywgaGZRdWF0LCBjb252ZXhQb3MsIGxvY2FsQ29udmV4UG9zKTsgLy8gR2V0IHRoZSBpbmRleCBvZiB0aGUgZGF0YSBwb2ludHMgdG8gdGVzdCBhZ2FpbnN0CgogICAgICBsZXQgaU1pblggPSBNYXRoLmZsb29yKChsb2NhbENvbnZleFBvcy54IC0gcmFkaXVzKSAvIHcpIC0gMTsKICAgICAgbGV0IGlNYXhYID0gTWF0aC5jZWlsKChsb2NhbENvbnZleFBvcy54ICsgcmFkaXVzKSAvIHcpICsgMTsKICAgICAgbGV0IGlNaW5ZID0gTWF0aC5mbG9vcigobG9jYWxDb252ZXhQb3MueSAtIHJhZGl1cykgLyB3KSAtIDE7CiAgICAgIGxldCBpTWF4WSA9IE1hdGguY2VpbCgobG9jYWxDb252ZXhQb3MueSArIHJhZGl1cykgLyB3KSArIDE7IC8vIEJhaWwgb3V0IGlmIHdlIGFyZSBvdXQgb2YgdGhlIHRlcnJhaW4KCiAgICAgIGlmIChpTWF4WCA8IDAgfHwgaU1heFkgPCAwIHx8IGlNaW5YID4gZGF0YS5sZW5ndGggfHwgaU1pblkgPiBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBDbGFtcCBpbmRleCB0byBlZGdlcwoKCiAgICAgIGlmIChpTWluWCA8IDApIHsKICAgICAgICBpTWluWCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WCA8IDApIHsKICAgICAgICBpTWF4WCA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA8IDApIHsKICAgICAgICBpTWluWSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWF4WSA8IDApIHsKICAgICAgICBpTWF4WSA9IDA7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWCA+PSBkYXRhLmxlbmd0aCkgewogICAgICAgIGlNaW5YID0gZGF0YS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBpZiAoaU1heFggPj0gZGF0YS5sZW5ndGgpIHsKICAgICAgICBpTWF4WCA9IGRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGlNYXhZID49IGRhdGFbMF0ubGVuZ3RoKSB7CiAgICAgICAgaU1heFkgPSBkYXRhWzBdLmxlbmd0aCAtIDE7CiAgICAgIH0KCiAgICAgIGlmIChpTWluWSA+PSBkYXRhWzBdLmxlbmd0aCkgewogICAgICAgIGlNaW5ZID0gZGF0YVswXS5sZW5ndGggLSAxOwogICAgICB9CgogICAgICBjb25zdCBtaW5NYXggPSBbXTsKICAgICAgaGZTaGFwZS5nZXRSZWN0TWluTWF4KGlNaW5YLCBpTWluWSwgaU1heFgsIGlNYXhZLCBtaW5NYXgpOwogICAgICBjb25zdCBtaW4gPSBtaW5NYXhbMF07CiAgICAgIGNvbnN0IG1heCA9IG1pbk1heFsxXTsgLy8gQmFpbCBvdXQgaWYgd2UncmUgY2FudCB0b3VjaCB0aGUgYm91bmRpbmcgaGVpZ2h0IGJveAoKICAgICAgaWYgKGxvY2FsQ29udmV4UG9zLnogLSByYWRpdXMgPiBtYXggfHwgbG9jYWxDb252ZXhQb3MueiArIHJhZGl1cyA8IG1pbikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgZm9yIChsZXQgaSA9IGlNaW5YOyBpIDwgaU1heFg7IGkrKykgewogICAgICAgIGZvciAobGV0IGogPSBpTWluWTsgaiA8IGlNYXhZOyBqKyspIHsKICAgICAgICAgIGxldCBpbnRlcnNlY3RpbmcgPSBmYWxzZTsgLy8gTG93ZXIgdHJpYW5nbGUKCiAgICAgICAgICBoZlNoYXBlLmdldENvbnZleFRyaWFuZ2xlUGlsbGFyKGksIGosIGZhbHNlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChjb252ZXhQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIGNvbnZleFNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuY29udmV4Q29udmV4KGNvbnZleFNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgY29udmV4UG9zLCB3b3JsZFBpbGxhck9mZnNldCwgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIG51bGwsIG51bGwsIGp1c3RUZXN0LCBmYWNlTGlzdCwgbnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gLy8gVXBwZXIgdHJpYW5nbGUKCgogICAgICAgICAgaGZTaGFwZS5nZXRDb252ZXhUcmlhbmdsZVBpbGxhcihpLCBqLCB0cnVlKTsKICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZShoZlBvcywgaGZRdWF0LCBoZlNoYXBlLnBpbGxhck9mZnNldCwgd29ybGRQaWxsYXJPZmZzZXQpOwoKICAgICAgICAgIGlmIChjb252ZXhQb3MuZGlzdGFuY2VUbyh3b3JsZFBpbGxhck9mZnNldCkgPCBoZlNoYXBlLnBpbGxhckNvbnZleC5ib3VuZGluZ1NwaGVyZVJhZGl1cyArIGNvbnZleFNoYXBlLmJvdW5kaW5nU3BoZXJlUmFkaXVzKSB7CiAgICAgICAgICAgIGludGVyc2VjdGluZyA9IHRoaXMuY29udmV4Q29udmV4KGNvbnZleFNoYXBlLCBoZlNoYXBlLnBpbGxhckNvbnZleCwgY29udmV4UG9zLCB3b3JsZFBpbGxhck9mZnNldCwgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIG51bGwsIG51bGwsIGp1c3RUZXN0LCBmYWNlTGlzdCwgbnVsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGp1c3RUZXN0ICYmIGludGVyc2VjdGluZykgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBzcGhlcmVQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICAvLyBUaGUgbm9ybWFsIGlzIHRoZSB1bml0IHZlY3RvciBmcm9tIHNwaGVyZSBjZW50ZXIgdG8gcGFydGljbGUgY2VudGVyCiAgICAgIGNvbnN0IG5vcm1hbCA9IHBhcnRpY2xlU3BoZXJlX25vcm1hbDsKICAgICAgbm9ybWFsLnNldCgwLCAwLCAxKTsKICAgICAgeGkudnN1Yih4aiwgbm9ybWFsKTsKICAgICAgY29uc3QgbGVuZ3RoU3F1YXJlZCA9IG5vcm1hbC5sZW5ndGhTcXVhcmVkKCk7CgogICAgICBpZiAobGVuZ3RoU3F1YXJlZCA8PSBzai5yYWRpdXMgKiBzai5yYWRpdXMpIHsKICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgciA9IHRoaXMuY3JlYXRlQ29udGFjdEVxdWF0aW9uKGJpLCBiaiwgc2ksIHNqLCByc2ksIHJzaik7CiAgICAgICAgbm9ybWFsLm5vcm1hbGl6ZSgpOwogICAgICAgIHIucmouY29weShub3JtYWwpOwogICAgICAgIHIucmouc2NhbGUoc2oucmFkaXVzLCByLnJqKTsKICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwKCiAgICAgICAgci5uaS5uZWdhdGUoci5uaSk7CiAgICAgICAgci5yaS5zZXQoMCwgMCwgMCk7IC8vIENlbnRlciBvZiBwYXJ0aWNsZQoKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfQogICAgfQoKICAgIHBsYW5lUGFydGljbGUoc2osIHNpLCB4aiwgeGksIHFqLCBxaSwgYmosIGJpLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgY29uc3Qgbm9ybWFsID0gcGFydGljbGVQbGFuZV9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIGJqLnF1YXRlcm5pb24udm11bHQobm9ybWFsLCBub3JtYWwpOyAvLyBUdXJuIG5vcm1hbCBhY2NvcmRpbmcgdG8gcGxhbmUgb3JpZW50YXRpb24KCiAgICAgIGNvbnN0IHJlbHBvcyA9IHBhcnRpY2xlUGxhbmVfcmVscG9zOwogICAgICB4aS52c3ViKGJqLnBvc2l0aW9uLCByZWxwb3MpOwogICAgICBjb25zdCBkb3QgPSBub3JtYWwuZG90KHJlbHBvcyk7CgogICAgICBpZiAoZG90IDw9IDAuMCkgewogICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oYmksIGJqLCBzaSwgc2osIHJzaSwgcnNqKTsKICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAoKICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgICAgICByLnJpLnNldCgwLCAwLCAwKTsgLy8gQ2VudGVyIG9mIHBhcnRpY2xlCiAgICAgICAgLy8gR2V0IHBhcnRpY2xlIHBvc2l0aW9uIHByb2plY3RlZCBvbiBwbGFuZQoKICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZDsKICAgICAgICBub3JtYWwuc2NhbGUobm9ybWFsLmRvdCh4aSksIHByb2plY3RlZCk7CiAgICAgICAgeGkudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vcHJvamVjdGVkLnZhZGQoYmoucG9zaXRpb24scHJvamVjdGVkKTsKICAgICAgICAvLyByaiBpcyBub3cgdGhlIHByb2plY3RlZCB3b3JsZCBwb3NpdGlvbiBtaW51cyBwbGFuZSBwb3NpdGlvbgoKICAgICAgICByLnJqLmNvcHkocHJvamVjdGVkKTsKICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgfQogICAgfQoKICAgIGJveFBhcnRpY2xlKHNpLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIHNpLmNvbnZleFBvbHloZWRyb25SZXByZXNlbnRhdGlvbi5tYXRlcmlhbCA9IHNpLm1hdGVyaWFsOwogICAgICBzaS5jb252ZXhQb2x5aGVkcm9uUmVwcmVzZW50YXRpb24uY29sbGlzaW9uUmVzcG9uc2UgPSBzaS5jb2xsaXNpb25SZXNwb25zZTsKICAgICAgcmV0dXJuIHRoaXMuY29udmV4UGFydGljbGUoc2kuY29udmV4UG9seWhlZHJvblJlcHJlc2VudGF0aW9uLCBzaiwgeGksIHhqLCBxaSwgcWosIGJpLCBiaiwgc2ksIHNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgY29udmV4UGFydGljbGUoc2osIHNpLCB4aiwgeGksIHFqLCBxaSwgYmosIGJpLCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgbGV0IHBlbmV0cmF0ZWRGYWNlSW5kZXggPSAtMTsKICAgICAgY29uc3QgcGVuZXRyYXRlZEZhY2VOb3JtYWwgPSBjb252ZXhQYXJ0aWNsZV9wZW5ldHJhdGVkRmFjZU5vcm1hbDsKICAgICAgY29uc3Qgd29ybGRQZW5ldHJhdGlvblZlYyA9IGNvbnZleFBhcnRpY2xlX3dvcmxkUGVuZXRyYXRpb25WZWM7CiAgICAgIGxldCBtaW5QZW5ldHJhdGlvbiA9IG51bGw7CiAgICAgIGNvbnN0IGxvY2FsID0gY29udmV4UGFydGljbGVfbG9jYWw7CiAgICAgIGxvY2FsLmNvcHkoeGkpOwogICAgICBsb2NhbC52c3ViKHhqLCBsb2NhbCk7IC8vIENvbnZlcnQgcG9zaXRpb24gdG8gcmVsYXRpdmUgdGhlIGNvbnZleCBvcmlnaW4KCiAgICAgIHFqLmNvbmp1Z2F0ZShjcWopOwogICAgICBjcWoudm11bHQobG9jYWwsIGxvY2FsKTsKCiAgICAgIGlmIChzai5wb2ludElzSW5zaWRlKGxvY2FsKSkgewogICAgICAgIGlmIChzai53b3JsZFZlcnRpY2VzTmVlZHNVcGRhdGUpIHsKICAgICAgICAgIHNqLmNvbXB1dGVXb3JsZFZlcnRpY2VzKHhqLCBxaik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2oud29ybGRGYWNlTm9ybWFsc05lZWRzVXBkYXRlKSB7CiAgICAgICAgICBzai5jb21wdXRlV29ybGRGYWNlTm9ybWFscyhxaik7CiAgICAgICAgfSAvLyBGb3IgZWFjaCB3b3JsZCBwb2x5Z29uIGluIHRoZSBwb2x5aGVkcmEKCgogICAgICAgIGZvciAobGV0IGkgPSAwLCBuZmFjZXMgPSBzai5mYWNlcy5sZW5ndGg7IGkgIT09IG5mYWNlczsgaSsrKSB7CiAgICAgICAgICAvLyBDb25zdHJ1Y3Qgd29ybGQgZmFjZSB2ZXJ0aWNlcwogICAgICAgICAgY29uc3QgdmVydHMgPSBbc2oud29ybGRWZXJ0aWNlc1tzai5mYWNlc1tpXVswXV1dOwogICAgICAgICAgY29uc3Qgbm9ybWFsID0gc2oud29ybGRGYWNlTm9ybWFsc1tpXTsgLy8gQ2hlY2sgaG93IG11Y2ggdGhlIHBhcnRpY2xlIHBlbmV0cmF0ZXMgdGhlIHBvbHlnb24gcGxhbmUuCgogICAgICAgICAgeGkudnN1Yih2ZXJ0c1swXSwgY29udmV4UGFydGljbGVfdmVydGV4VG9QYXJ0aWNsZSk7CiAgICAgICAgICBjb25zdCBwZW5ldHJhdGlvbiA9IC1ub3JtYWwuZG90KGNvbnZleFBhcnRpY2xlX3ZlcnRleFRvUGFydGljbGUpOwoKICAgICAgICAgIGlmIChtaW5QZW5ldHJhdGlvbiA9PT0gbnVsbCB8fCBNYXRoLmFicyhwZW5ldHJhdGlvbikgPCBNYXRoLmFicyhtaW5QZW5ldHJhdGlvbikpIHsKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG1pblBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247CiAgICAgICAgICAgIHBlbmV0cmF0ZWRGYWNlSW5kZXggPSBpOwogICAgICAgICAgICBwZW5ldHJhdGVkRmFjZU5vcm1hbC5jb3B5KG5vcm1hbCk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAocGVuZXRyYXRlZEZhY2VJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIC8vIFNldHVwIGNvbnRhY3QKICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSwgYmosIHNpLCBzaiwgcnNpLCByc2opOwogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwuc2NhbGUobWluUGVuZXRyYXRpb24sIHdvcmxkUGVuZXRyYXRpb25WZWMpOyAvLyByaiBpcyB0aGUgcGFydGljbGUgcG9zaXRpb24gcHJvamVjdGVkIHRvIHRoZSBmYWNlCgogICAgICAgICAgd29ybGRQZW5ldHJhdGlvblZlYy52YWRkKHhpLCB3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIHdvcmxkUGVuZXRyYXRpb25WZWMudnN1Yih4aiwgd29ybGRQZW5ldHJhdGlvblZlYyk7CiAgICAgICAgICByLnJqLmNvcHkod29ybGRQZW5ldHJhdGlvblZlYyk7IC8vY29uc3QgcHJvamVjdGVkVG9GYWNlID0geGkudnN1Yih4aikudmFkZCh3b3JsZFBlbmV0cmF0aW9uVmVjKTsKICAgICAgICAgIC8vcHJvamVjdGVkVG9GYWNlLmNvcHkoci5yaik7CiAgICAgICAgICAvL3FqLnZtdWx0KHIucmosci5yaik7CgogICAgICAgICAgcGVuZXRyYXRlZEZhY2VOb3JtYWwubmVnYXRlKHIubmkpOyAvLyBDb250YWN0IG5vcm1hbAoKICAgICAgICAgIHIucmkuc2V0KDAsIDAsIDApOyAvLyBDZW50ZXIgb2YgcGFydGljbGUKCiAgICAgICAgICBjb25zdCByaSA9IHIucmk7CiAgICAgICAgICBjb25zdCByaiA9IHIucmo7IC8vIE1ha2UgcmVsYXRpdmUgdG8gYm9kaWVzCgogICAgICAgICAgcmkudmFkZCh4aSwgcmkpOwogICAgICAgICAgcmkudnN1YihiaS5wb3NpdGlvbiwgcmkpOwogICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgICAgICAgcmoudnN1Yihiai5wb3NpdGlvbiwgcmopOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS53YXJuKCdQb2ludCBmb3VuZCBpbnNpZGUgY29udmV4LCBidXQgZGlkIG5vdCBmaW5kIHBlbmV0cmF0aW5nIGZhY2UhJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaGVpZ2h0ZmllbGRDeWxpbmRlcihoZlNoYXBlLCBjb252ZXhTaGFwZSwgaGZQb3MsIGNvbnZleFBvcywgaGZRdWF0LCBjb252ZXhRdWF0LCBoZkJvZHksIGNvbnZleEJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhIZWlnaHRmaWVsZChjb252ZXhTaGFwZSwgaGZTaGFwZSwgY29udmV4UG9zLCBoZlBvcywgY29udmV4UXVhdCwgaGZRdWF0LCBjb252ZXhCb2R5LCBoZkJvZHksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgcGFydGljbGVDeWxpbmRlcihzaSwgc2osIHhpLCB4aiwgcWksIHFqLCBiaSwgYmosIHJzaSwgcnNqLCBqdXN0VGVzdCkgewogICAgICByZXR1cm4gdGhpcy5jb252ZXhQYXJ0aWNsZShzaiwgc2ksIHhqLCB4aSwgcWosIHFpLCBiaiwgYmksIHJzaSwgcnNqLCBqdXN0VGVzdCk7CiAgICB9CgogICAgc3BoZXJlVHJpbWVzaChzcGhlcmVTaGFwZSwgdHJpbWVzaFNoYXBlLCBzcGhlcmVQb3MsIHRyaW1lc2hQb3MsIHNwaGVyZVF1YXQsIHRyaW1lc2hRdWF0LCBzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgcnNpLCByc2osIGp1c3RUZXN0KSB7CiAgICAgIGNvbnN0IGVkZ2VWZXJ0ZXhBID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVydGV4QTsKICAgICAgY29uc3QgZWRnZVZlcnRleEIgPSBzcGhlcmVUcmltZXNoX2VkZ2VWZXJ0ZXhCOwogICAgICBjb25zdCBlZGdlVmVjdG9yID0gc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yOwogICAgICBjb25zdCBlZGdlVmVjdG9yVW5pdCA9IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvclVuaXQ7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlUG9zID0gc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvczsKICAgICAgY29uc3QgdG1wID0gc3BoZXJlVHJpbWVzaF90bXA7CiAgICAgIGNvbnN0IGxvY2FsU3BoZXJlQUFCQiA9IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCOwogICAgICBjb25zdCB2MiA9IHNwaGVyZVRyaW1lc2hfdjI7CiAgICAgIGNvbnN0IHJlbHBvcyA9IHNwaGVyZVRyaW1lc2hfcmVscG9zOwogICAgICBjb25zdCB0cmlhbmdsZXMgPSBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlczsgLy8gQ29udmVydCBzcGhlcmUgcG9zaXRpb24gdG8gbG9jYWwgaW4gdGhlIHRyaW1lc2gKCiAgICAgIFRyYW5zZm9ybS5wb2ludFRvTG9jYWxGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgc3BoZXJlUG9zLCBsb2NhbFNwaGVyZVBvcyk7IC8vIEdldCB0aGUgYWFiYiBvZiB0aGUgc3BoZXJlIGxvY2FsbHkgaW4gdGhlIHRyaW1lc2gKCiAgICAgIGNvbnN0IHNwaGVyZVJhZGl1cyA9IHNwaGVyZVNoYXBlLnJhZGl1czsKICAgICAgbG9jYWxTcGhlcmVBQUJCLmxvd2VyQm91bmQuc2V0KGxvY2FsU3BoZXJlUG9zLnggLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnkgLSBzcGhlcmVSYWRpdXMsIGxvY2FsU3BoZXJlUG9zLnogLSBzcGhlcmVSYWRpdXMpOwogICAgICBsb2NhbFNwaGVyZUFBQkIudXBwZXJCb3VuZC5zZXQobG9jYWxTcGhlcmVQb3MueCArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueSArIHNwaGVyZVJhZGl1cywgbG9jYWxTcGhlcmVQb3MueiArIHNwaGVyZVJhZGl1cyk7CiAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZXNJbkFBQkIobG9jYWxTcGhlcmVBQUJCLCB0cmlhbmdsZXMpOyAvL2ZvciAobGV0IGkgPSAwOyBpIDwgdHJpbWVzaFNoYXBlLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB0cmlhbmdsZXMucHVzaChpKTsgLy8gQWxsCiAgICAgIC8vIFZlcnRpY2VzCgogICAgICBjb25zdCB2ID0gc3BoZXJlVHJpbWVzaF92OwogICAgICBjb25zdCByYWRpdXNTcXVhcmVkID0gc3BoZXJlU2hhcGUucmFkaXVzICogc3BoZXJlU2hhcGUucmFkaXVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmlhbmdsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgICAgdHJpbWVzaFNoYXBlLmdldFZlcnRleCh0cmltZXNoU2hhcGUuaW5kaWNlc1t0cmlhbmdsZXNbaV0gKiAzICsgal0sIHYpOyAvLyBDaGVjayB2ZXJ0ZXggb3ZlcmxhcCBpbiBzcGhlcmUKCiAgICAgICAgICB2LnZzdWIobG9jYWxTcGhlcmVQb3MsIHJlbHBvcyk7CgogICAgICAgICAgaWYgKHJlbHBvcy5sZW5ndGhTcXVhcmVkKCkgPD0gcmFkaXVzU3F1YXJlZCkgewogICAgICAgICAgICAvLyBTYWZlIHVwCiAgICAgICAgICAgIHYyLmNvcHkodik7CiAgICAgICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOwogICAgICAgICAgICB2LnZzdWIoc3BoZXJlUG9zLCByZWxwb3MpOwoKICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24oc3BoZXJlQm9keSwgdHJpbWVzaEJvZHksIHNwaGVyZVNoYXBlLCB0cmltZXNoU2hhcGUsIHJzaSwgcnNqKTsKICAgICAgICAgICAgci5uaS5jb3B5KHJlbHBvcyk7CiAgICAgICAgICAgIHIubmkubm9ybWFsaXplKCk7IC8vIHJpIGlzIHRoZSB2ZWN0b3IgZnJvbSBzcGhlcmUgY2VudGVyIHRvIHRoZSBzcGhlcmUgc3VyZmFjZQoKICAgICAgICAgICAgci5yaS5jb3B5KHIubmkpOwogICAgICAgICAgICByLnJpLnNjYWxlKHNwaGVyZVNoYXBlLnJhZGl1cywgci5yaSk7CiAgICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgIHIucmouY29weSh2KTsKICAgICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgICB0aGlzLnJlc3VsdC5wdXNoKHIpOwogICAgICAgICAgICB0aGlzLmNyZWF0ZUZyaWN0aW9uRXF1YXRpb25zRnJvbUNvbnRhY3QociwgdGhpcy5mcmljdGlvblJlc3VsdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIENoZWNrIGFsbCBlZGdlcwoKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJpYW5nbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAzOyBqKyspIHsKICAgICAgICAgIHRyaW1lc2hTaGFwZS5nZXRWZXJ0ZXgodHJpbWVzaFNoYXBlLmluZGljZXNbdHJpYW5nbGVzW2ldICogMyArIGpdLCBlZGdlVmVydGV4QSk7CiAgICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KHRyaW1lc2hTaGFwZS5pbmRpY2VzW3RyaWFuZ2xlc1tpXSAqIDMgKyAoaiArIDEpICUgM10sIGVkZ2VWZXJ0ZXhCKTsKICAgICAgICAgIGVkZ2VWZXJ0ZXhCLnZzdWIoZWRnZVZlcnRleEEsIGVkZ2VWZWN0b3IpOyAvLyBQcm9qZWN0IHNwaGVyZSBwb3NpdGlvbiB0byB0aGUgZWRnZQoKICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEIsIHRtcCk7CiAgICAgICAgICBjb25zdCBwb3NpdGlvbkFsb25nRWRnZUIgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwogICAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1YihlZGdlVmVydGV4QSwgdG1wKTsKICAgICAgICAgIGxldCBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3IpOwoKICAgICAgICAgIGlmIChwb3NpdGlvbkFsb25nRWRnZUEgPiAwICYmIHBvc2l0aW9uQWxvbmdFZGdlQiA8IDApIHsKICAgICAgICAgICAgLy8gTm93IGNoZWNrIHRoZSBvcnRob2dvbmFsIGRpc3RhbmNlIGZyb20gZWRnZSB0byBzcGhlcmUgY2VudGVyCiAgICAgICAgICAgIGxvY2FsU3BoZXJlUG9zLnZzdWIoZWRnZVZlcnRleEEsIHRtcCk7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0LmNvcHkoZWRnZVZlY3Rvcik7CiAgICAgICAgICAgIGVkZ2VWZWN0b3JVbml0Lm5vcm1hbGl6ZSgpOwogICAgICAgICAgICBwb3NpdGlvbkFsb25nRWRnZUEgPSB0bXAuZG90KGVkZ2VWZWN0b3JVbml0KTsKICAgICAgICAgICAgZWRnZVZlY3RvclVuaXQuc2NhbGUocG9zaXRpb25BbG9uZ0VkZ2VBLCB0bXApOwogICAgICAgICAgICB0bXAudmFkZChlZGdlVmVydGV4QSwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIGNlbnRlciBwb3NpdGlvbiBwcm9qZWN0ZWQgdG8gdGhlIGVkZ2UsIGRlZmluZWQgbG9jYWxseSBpbiB0aGUgdHJpbWVzaCBmcmFtZQoKICAgICAgICAgICAgY29uc3QgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgICAgIGlmIChkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICAgICAgaWYgKGp1c3RUZXN0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgICAgIHRtcC52c3ViKGxvY2FsU3BoZXJlUG9zLCByLm5pKTsKICAgICAgICAgICAgICByLm5pLm5vcm1hbGl6ZSgpOwogICAgICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZhZGQoc3BoZXJlUG9zLCByLnJpKTsKICAgICAgICAgICAgICByLnJpLnZzdWIoc3BoZXJlQm9keS5wb3NpdGlvbiwgci5yaSk7CiAgICAgICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICAgICAgdG1wLnZzdWIodHJpbWVzaEJvZHkucG9zaXRpb24sIHIucmopOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIubmksIHIubmkpOwogICAgICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgICAgIHRoaXMucmVzdWx0LnB1c2gocik7CiAgICAgICAgICAgICAgdGhpcy5jcmVhdGVGcmljdGlvbkVxdWF0aW9uc0Zyb21Db250YWN0KHIsIHRoaXMuZnJpY3Rpb25SZXN1bHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIFRyaWFuZ2xlIGZhY2VzCgoKICAgICAgY29uc3QgdmEgPSBzcGhlcmVUcmltZXNoX3ZhOwogICAgICBjb25zdCB2YiA9IHNwaGVyZVRyaW1lc2hfdmI7CiAgICAgIGNvbnN0IHZjID0gc3BoZXJlVHJpbWVzaF92YzsKICAgICAgY29uc3Qgbm9ybWFsID0gc3BoZXJlVHJpbWVzaF9ub3JtYWw7CgogICAgICBmb3IgKGxldCBpID0gMCwgTiA9IHRyaWFuZ2xlcy5sZW5ndGg7IGkgIT09IE47IGkrKykgewogICAgICAgIHRyaW1lc2hTaGFwZS5nZXRUcmlhbmdsZVZlcnRpY2VzKHRyaWFuZ2xlc1tpXSwgdmEsIHZiLCB2Yyk7CiAgICAgICAgdHJpbWVzaFNoYXBlLmdldE5vcm1hbCh0cmlhbmdsZXNbaV0sIG5vcm1hbCk7CiAgICAgICAgbG9jYWxTcGhlcmVQb3MudnN1Yih2YSwgdG1wKTsKICAgICAgICBsZXQgZGlzdCA9IHRtcC5kb3Qobm9ybWFsKTsKICAgICAgICBub3JtYWwuc2NhbGUoZGlzdCwgdG1wKTsKICAgICAgICBsb2NhbFNwaGVyZVBvcy52c3ViKHRtcCwgdG1wKTsgLy8gdG1wIGlzIG5vdyB0aGUgc3BoZXJlIHBvc2l0aW9uIHByb2plY3RlZCB0byB0aGUgdHJpYW5nbGUgcGxhbmUKCiAgICAgICAgZGlzdCA9IHRtcC5kaXN0YW5jZVRvKGxvY2FsU3BoZXJlUG9zKTsKCiAgICAgICAgaWYgKFJheS5wb2ludEluVHJpYW5nbGUodG1wLCB2YSwgdmIsIHZjKSAmJiBkaXN0IDwgc3BoZXJlU2hhcGUucmFkaXVzKSB7CiAgICAgICAgICBpZiAoanVzdFRlc3QpIHsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgbGV0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihzcGhlcmVCb2R5LCB0cmltZXNoQm9keSwgc3BoZXJlU2hhcGUsIHRyaW1lc2hTaGFwZSwgcnNpLCByc2opOwogICAgICAgICAgdG1wLnZzdWIobG9jYWxTcGhlcmVQb3MsIHIubmkpOwogICAgICAgICAgci5uaS5ub3JtYWxpemUoKTsKICAgICAgICAgIHIubmkuc2NhbGUoc3BoZXJlU2hhcGUucmFkaXVzLCByLnJpKTsKICAgICAgICAgIHIucmkudmFkZChzcGhlcmVQb3MsIHIucmkpOwogICAgICAgICAgci5yaS52c3ViKHNwaGVyZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgVHJhbnNmb3JtLnBvaW50VG9Xb3JsZEZyYW1lKHRyaW1lc2hQb3MsIHRyaW1lc2hRdWF0LCB0bXAsIHRtcCk7CiAgICAgICAgICB0bXAudnN1Yih0cmltZXNoQm9keS5wb3NpdGlvbiwgci5yaik7CiAgICAgICAgICBUcmFuc2Zvcm0udmVjdG9yVG9Xb3JsZEZyYW1lKHRyaW1lc2hRdWF0LCByLm5pLCByLm5pKTsKICAgICAgICAgIFRyYW5zZm9ybS52ZWN0b3JUb1dvcmxkRnJhbWUodHJpbWVzaFF1YXQsIHIucmksIHIucmkpOwogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRyaWFuZ2xlcy5sZW5ndGggPSAwOwogICAgfQoKICAgIHBsYW5lVHJpbWVzaChwbGFuZVNoYXBlLCB0cmltZXNoU2hhcGUsIHBsYW5lUG9zLCB0cmltZXNoUG9zLCBwbGFuZVF1YXQsIHRyaW1lc2hRdWF0LCBwbGFuZUJvZHksIHRyaW1lc2hCb2R5LCByc2ksIHJzaiwganVzdFRlc3QpIHsKICAgICAgLy8gTWFrZSBjb250YWN0cyEKICAgICAgY29uc3QgdiA9IG5ldyBWZWMzKCk7CiAgICAgIGNvbnN0IG5vcm1hbCA9IHBsYW5lVHJpbWVzaF9ub3JtYWw7CiAgICAgIG5vcm1hbC5zZXQoMCwgMCwgMSk7CiAgICAgIHBsYW5lUXVhdC52bXVsdChub3JtYWwsIG5vcm1hbCk7IC8vIFR1cm4gbm9ybWFsIGFjY29yZGluZyB0byBwbGFuZQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0cmltZXNoU2hhcGUudmVydGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAgICAgLy8gR2V0IHdvcmxkIHZlcnRleCBmcm9tIHRyaW1lc2gKICAgICAgICB0cmltZXNoU2hhcGUuZ2V0VmVydGV4KGksIHYpOyAvLyBTYWZlIHVwCgogICAgICAgIGNvbnN0IHYyID0gbmV3IFZlYzMoKTsKICAgICAgICB2Mi5jb3B5KHYpOwogICAgICAgIFRyYW5zZm9ybS5wb2ludFRvV29ybGRGcmFtZSh0cmltZXNoUG9zLCB0cmltZXNoUXVhdCwgdjIsIHYpOyAvLyBDaGVjayBwbGFuZSBzaWRlCgogICAgICAgIGNvbnN0IHJlbHBvcyA9IHBsYW5lVHJpbWVzaF9yZWxwb3M7CiAgICAgICAgdi52c3ViKHBsYW5lUG9zLCByZWxwb3MpOwogICAgICAgIGNvbnN0IGRvdCA9IG5vcm1hbC5kb3QocmVscG9zKTsKCiAgICAgICAgaWYgKGRvdCA8PSAwLjApIHsKICAgICAgICAgIGlmIChqdXN0VGVzdCkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCByID0gdGhpcy5jcmVhdGVDb250YWN0RXF1YXRpb24ocGxhbmVCb2R5LCB0cmltZXNoQm9keSwgcGxhbmVTaGFwZSwgdHJpbWVzaFNoYXBlLCByc2ksIHJzaik7CiAgICAgICAgICByLm5pLmNvcHkobm9ybWFsKTsgLy8gQ29udGFjdCBub3JtYWwgaXMgdGhlIHBsYW5lIG5vcm1hbAogICAgICAgICAgLy8gR2V0IHZlcnRleCBwb3NpdGlvbiBwcm9qZWN0ZWQgb24gcGxhbmUKCiAgICAgICAgICBjb25zdCBwcm9qZWN0ZWQgPSBwbGFuZVRyaW1lc2hfcHJvamVjdGVkOwogICAgICAgICAgbm9ybWFsLnNjYWxlKHJlbHBvcy5kb3Qobm9ybWFsKSwgcHJvamVjdGVkKTsKICAgICAgICAgIHYudnN1Yihwcm9qZWN0ZWQsIHByb2plY3RlZCk7IC8vIHJpIGlzIHRoZSBwcm9qZWN0ZWQgd29ybGQgcG9zaXRpb24gbWludXMgcGxhbmUgcG9zaXRpb24KCiAgICAgICAgICByLnJpLmNvcHkocHJvamVjdGVkKTsKICAgICAgICAgIHIucmkudnN1YihwbGFuZUJvZHkucG9zaXRpb24sIHIucmkpOwogICAgICAgICAgci5yai5jb3B5KHYpOwogICAgICAgICAgci5yai52c3ViKHRyaW1lc2hCb2R5LnBvc2l0aW9uLCByLnJqKTsgLy8gU3RvcmUgcmVzdWx0CgogICAgICAgICAgdGhpcy5yZXN1bHQucHVzaChyKTsKICAgICAgICAgIHRoaXMuY3JlYXRlRnJpY3Rpb25FcXVhdGlvbnNGcm9tQ29udGFjdChyLCB0aGlzLmZyaWN0aW9uUmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gLy8gY29udmV4VHJpbWVzaCgKICAgIC8vICAgc2k6IENvbnZleFBvbHloZWRyb24sIHNqOiBUcmltZXNoLCB4aTogVmVjMywgeGo6IFZlYzMsIHFpOiBRdWF0ZXJuaW9uLCBxajogUXVhdGVybmlvbiwKICAgIC8vICAgYmk6IEJvZHksIGJqOiBCb2R5LCByc2k/OiBTaGFwZSB8IG51bGwsIHJzaj86IFNoYXBlIHwgbnVsbCwKICAgIC8vICAgZmFjZUxpc3RBPzogbnVtYmVyW10gfCBudWxsLCBmYWNlTGlzdEI/OiBudW1iZXJbXSB8IG51bGwsCiAgICAvLyApIHsKICAgIC8vICAgY29uc3Qgc2VwQXhpcyA9IGNvbnZleENvbnZleF9zZXBBeGlzOwogICAgLy8gICBpZih4aS5kaXN0YW5jZVRvKHhqKSA+IHNpLmJvdW5kaW5nU3BoZXJlUmFkaXVzICsgc2ouYm91bmRpbmdTcGhlcmVSYWRpdXMpewogICAgLy8gICAgICAgcmV0dXJuOwogICAgLy8gICB9CiAgICAvLyAgIC8vIENvbnN0cnVjdCBhIHRlbXAgaHVsbCBmb3IgZWFjaCB0cmlhbmdsZQogICAgLy8gICBjb25zdCBodWxsQiA9IG5ldyBDb252ZXhQb2x5aGVkcm9uKCk7CiAgICAvLyAgIGh1bGxCLmZhY2VzID0gW1swLDEsMl1dOwogICAgLy8gICBjb25zdCB2YSA9IG5ldyBWZWMzKCk7CiAgICAvLyAgIGNvbnN0IHZiID0gbmV3IFZlYzMoKTsKICAgIC8vICAgY29uc3QgdmMgPSBuZXcgVmVjMygpOwogICAgLy8gICBodWxsQi52ZXJ0aWNlcyA9IFsKICAgIC8vICAgICAgIHZhLAogICAgLy8gICAgICAgdmIsCiAgICAvLyAgICAgICB2YwogICAgLy8gICBdOwogICAgLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IHNqLmluZGljZXMubGVuZ3RoIC8gMzsgaSsrKSB7CiAgICAvLyAgICAgICBjb25zdCB0cmlhbmdsZU5vcm1hbCA9IG5ldyBWZWMzKCk7CiAgICAvLyAgICAgICBzai5nZXROb3JtYWwoaSwgdHJpYW5nbGVOb3JtYWwpOwogICAgLy8gICAgICAgaHVsbEIuZmFjZU5vcm1hbHMgPSBbdHJpYW5nbGVOb3JtYWxdOwogICAgLy8gICAgICAgc2ouZ2V0VHJpYW5nbGVWZXJ0aWNlcyhpLCB2YSwgdmIsIHZjKTsKICAgIC8vICAgICAgIGxldCBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICBpZighZCl7CiAgICAvLyAgICAgICAgICAgdHJpYW5nbGVOb3JtYWwuc2NhbGUoLTEsIHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICBkID0gc2kudGVzdFNlcEF4aXModHJpYW5nbGVOb3JtYWwsIGh1bGxCLCB4aSwgcWksIHhqLCBxaik7CiAgICAvLyAgICAgICAgICAgaWYoIWQpewogICAgLy8gICAgICAgICAgICAgICBjb250aW51ZTsKICAgIC8vICAgICAgICAgICB9CiAgICAvLyAgICAgICB9CiAgICAvLyAgICAgICBjb25zdCByZXM6IENvbnZleFBvbHloZWRyb25Db250YWN0UG9pbnRbXSA9IFtdOwogICAgLy8gICAgICAgY29uc3QgcSA9IGNvbnZleENvbnZleF9xOwogICAgLy8gICAgICAgc2kuY2xpcEFnYWluc3RIdWxsKHhpLHFpLGh1bGxCLHhqLHFqLHRyaWFuZ2xlTm9ybWFsLC0xMDAsMTAwLHJlcyk7CiAgICAvLyAgICAgICBmb3IobGV0IGogPSAwOyBqICE9PSByZXMubGVuZ3RoOyBqKyspewogICAgLy8gICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLmNyZWF0ZUNvbnRhY3RFcXVhdGlvbihiaSxiaixzaSxzaixyc2kscnNqKSwKICAgIC8vICAgICAgICAgICAgICAgcmkgPSByLnJpLAogICAgLy8gICAgICAgICAgICAgICByaiA9IHIucmo7CiAgICAvLyAgICAgICAgICAgci5uaS5jb3B5KHRyaWFuZ2xlTm9ybWFsKTsKICAgIC8vICAgICAgICAgICByLm5pLm5lZ2F0ZShyLm5pKTsKICAgIC8vICAgICAgICAgICByZXNbal0ubm9ybWFsLm5lZ2F0ZShxKTsKICAgIC8vICAgICAgICAgICBxLm11bHQocmVzW2pdLmRlcHRoLCBxKTsKICAgIC8vICAgICAgICAgICByZXNbal0ucG9pbnQudmFkZChxLCByaSk7CiAgICAvLyAgICAgICAgICAgcmouY29weShyZXNbal0ucG9pbnQpOwogICAgLy8gICAgICAgICAgIC8vIENvbnRhY3QgcG9pbnRzIGFyZSBpbiB3b3JsZCBjb29yZGluYXRlcy4gVHJhbnNmb3JtIGJhY2sgdG8gcmVsYXRpdmUKICAgIC8vICAgICAgICAgICByaS52c3ViKHhpLHJpKTsKICAgIC8vICAgICAgICAgICByai52c3ViKHhqLHJqKTsKICAgIC8vICAgICAgICAgICAvLyBNYWtlIHJlbGF0aXZlIHRvIGJvZGllcwogICAgLy8gICAgICAgICAgIHJpLnZhZGQoeGksIHJpKTsKICAgIC8vICAgICAgICAgICByaS52c3ViKGJpLnBvc2l0aW9uLCByaSk7CiAgICAvLyAgICAgICAgICAgcmoudmFkZCh4aiwgcmopOwogICAgLy8gICAgICAgICAgIHJqLnZzdWIoYmoucG9zaXRpb24sIHJqKTsKICAgIC8vICAgICAgICAgICByZXN1bHQucHVzaChyKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgfQogICAgLy8gfQoKCiAgfQoKICBjb25zdCBhdmVyYWdlTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBhdmVyYWdlQ29udGFjdFBvaW50QSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgYXZlcmFnZUNvbnRhY3RQb2ludEIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFZlYzIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHRtcFF1YXQxID0gbmV3IFF1YXRlcm5pb24oKTsKICBjb25zdCB0bXBRdWF0MiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3JlbHBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVUcmltZXNoX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdjIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfZWRnZVZlcnRleEEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfZWRnZVZlcnRleEIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfZWRnZVZlY3RvciA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9lZGdlVmVjdG9yVW5pdCA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF9sb2NhbFNwaGVyZVBvcyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlVHJpbWVzaF90bXAgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdmEgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdmIgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfdmMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZVRyaW1lc2hfbG9jYWxTcGhlcmVBQUJCID0gbmV3IEFBQkIoKTsKICBjb25zdCBzcGhlcmVUcmltZXNoX3RyaWFuZ2xlcyA9IFtdOwogIGNvbnN0IHBvaW50X29uX3BsYW5lX3RvX3NwaGVyZSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVfdG9fc3BoZXJlX29ydGhvID0gbmV3IFZlYzMoKTsgLy8gU2VlIGh0dHA6Ly9idWxsZXRwaHlzaWNzLmNvbS9CdWxsZXQvQnVsbGV0RnVsbC9TcGhlcmVUcmlhbmdsZURldGVjdG9yXzhjcHBfc291cmNlLmh0bWwKCiAgY29uc3QgcG9pbnRJblBvbHlnb25fZWRnZSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcG9pbnRJblBvbHlnb25fZWRnZV94X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcG9pbnRJblBvbHlnb25fdnRwID0gbmV3IFZlYzMoKTsKCiAgZnVuY3Rpb24gcG9pbnRJblBvbHlnb24odmVydHMsIG5vcm1hbCwgcCkgewogICAgbGV0IHBvc2l0aXZlUmVzdWx0ID0gbnVsbDsKICAgIGNvbnN0IE4gPSB2ZXJ0cy5sZW5ndGg7CgogICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICBjb25zdCB2ID0gdmVydHNbaV07IC8vIEdldCBlZGdlIHRvIHRoZSBuZXh0IHZlcnRleAoKICAgICAgY29uc3QgZWRnZSA9IHBvaW50SW5Qb2x5Z29uX2VkZ2U7CiAgICAgIHZlcnRzWyhpICsgMSkgJSBOXS52c3ViKHYsIGVkZ2UpOyAvLyBHZXQgY3Jvc3MgcHJvZHVjdCBiZXR3ZWVuIHBvbHlnb24gbm9ybWFsIGFuZCB0aGUgZWRnZQoKICAgICAgY29uc3QgZWRnZV94X25vcm1hbCA9IHBvaW50SW5Qb2x5Z29uX2VkZ2VfeF9ub3JtYWw7IC8vY29uc3QgZWRnZV94X25vcm1hbCA9IG5ldyBWZWMzKCk7CgogICAgICBlZGdlLmNyb3NzKG5vcm1hbCwgZWRnZV94X25vcm1hbCk7IC8vIEdldCB2ZWN0b3IgYmV0d2VlbiBwb2ludCBhbmQgY3VycmVudCB2ZXJ0ZXgKCiAgICAgIGNvbnN0IHZlcnRleF90b19wID0gcG9pbnRJblBvbHlnb25fdnRwOwogICAgICBwLnZzdWIodiwgdmVydGV4X3RvX3ApOyAvLyBUaGlzIGRvdCBwcm9kdWN0IGRldGVybWluZXMgd2hpY2ggc2lkZSBvZiB0aGUgZWRnZSB0aGUgcG9pbnQgaXMKCiAgICAgIGNvbnN0IHIgPSBlZGdlX3hfbm9ybWFsLmRvdCh2ZXJ0ZXhfdG9fcCk7IC8vIElmIGFsbCBzdWNoIGRvdCBwcm9kdWN0cyBoYXZlIHNhbWUgc2lnbiwgd2UgYXJlIGluc2lkZSB0aGUgcG9seWdvbi4KCiAgICAgIGlmIChwb3NpdGl2ZVJlc3VsdCA9PT0gbnVsbCB8fCByID4gMCAmJiBwb3NpdGl2ZVJlc3VsdCA9PT0gdHJ1ZSB8fCByIDw9IDAgJiYgcG9zaXRpdmVSZXN1bHQgPT09IGZhbHNlKSB7CiAgICAgICAgaWYgKHBvc2l0aXZlUmVzdWx0ID09PSBudWxsKSB7CiAgICAgICAgICBwb3NpdGl2ZVJlc3VsdCA9IHIgPiAwOwogICAgICAgIH0KCiAgICAgICAgY29udGludWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBFbmNvdW50ZXJlZCBzb21lIG90aGVyIHNpZ24uIEV4aXQuCiAgICAgIH0KICAgIH0gLy8gSWYgd2UgZ290IGhlcmUsIGFsbCBkb3QgcHJvZHVjdHMgd2VyZSBvZiB0aGUgc2FtZSBzaWduLgoKCiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIGNvbnN0IGJveF90b19zcGhlcmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUJveF9ucyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zMSA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X25zMiA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X3NpZGVzID0gW25ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCksIG5ldyBWZWMzKCldOwogIGNvbnN0IHNwaGVyZUJveF9zcGhlcmVfdG9fY29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9ucyA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQm94X3NpZGVfbnMxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVCb3hfc2lkZV9uczIgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleF90b19zcGhlcmUgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9lZGdlID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfZWRnZVVuaXQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9zcGhlcmVUb0Nvcm5lciA9IG5ldyBWZWMzKCk7CiAgY29uc3Qgc3BoZXJlQ29udmV4X3dvcmxkQ29ybmVyID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGROb3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF93b3JsZFBvaW50ID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfd29ybGRTcGhlcmVQb2ludENsb3Nlc3RUb1BsYW5lID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVDb252ZXhfcGVuZXRyYXRpb25WZWMgPSBuZXcgVmVjMygpOwogIGNvbnN0IHNwaGVyZUNvbnZleF9zcGhlcmVUb1dvcmxkUG9pbnQgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X3YgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBsYW5lQ29udmV4X25vcm1hbCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGxhbmVDb252ZXhfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwbGFuZUNvbnZleF9wcm9qZWN0ZWQgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleENvbnZleF9zZXBBeGlzID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhDb252ZXhfcSA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVQbGFuZV9ub3JtYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IHBhcnRpY2xlUGxhbmVfcmVscG9zID0gbmV3IFZlYzMoKTsKICBjb25zdCBwYXJ0aWNsZVBsYW5lX3Byb2plY3RlZCA9IG5ldyBWZWMzKCk7CiAgY29uc3QgcGFydGljbGVTcGhlcmVfbm9ybWFsID0gbmV3IFZlYzMoKTsgLy8gV0lQCgogIGNvbnN0IGNxaiA9IG5ldyBRdWF0ZXJuaW9uKCk7CiAgY29uc3QgY29udmV4UGFydGljbGVfbG9jYWwgPSBuZXcgVmVjMygpOwogIGNvbnN0IGNvbnZleFBhcnRpY2xlX3BlbmV0cmF0ZWRGYWNlTm9ybWFsID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhQYXJ0aWNsZV92ZXJ0ZXhUb1BhcnRpY2xlID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhQYXJ0aWNsZV93b3JsZFBlbmV0cmF0aW9uVmVjID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhIZWlnaHRmaWVsZF90bXAxID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhIZWlnaHRmaWVsZF90bXAyID0gbmV3IFZlYzMoKTsKICBjb25zdCBjb252ZXhIZWlnaHRmaWVsZF9mYWNlTGlzdCA9IFswXTsKICBjb25zdCBzcGhlcmVIZWlnaHRmaWVsZF90bXAxID0gbmV3IFZlYzMoKTsKICBjb25zdCBzcGhlcmVIZWlnaHRmaWVsZF90bXAyID0gbmV3IFZlYzMoKTsKCiAgY2xhc3MgT3ZlcmxhcEtlZXBlciB7CiAgICAvKioKICAgICAqIEB0b2RvIFJlbW92ZSB1c2VsZXNzIGNvbnN0cnVjdG9yCiAgICAgKi8KICAgIGNvbnN0cnVjdG9yKCkgewogICAgICB0aGlzLmN1cnJlbnQgPSB2b2lkIDA7CiAgICAgIHRoaXMucHJldmlvdXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY3VycmVudCA9IFtdOwogICAgICB0aGlzLnByZXZpb3VzID0gW107CiAgICB9CiAgICAvKioKICAgICAqIGdldEtleQogICAgICovCgoKICAgIGdldEtleShpLCBqKSB7CiAgICAgIGlmIChqIDwgaSkgewogICAgICAgIGNvbnN0IHRlbXAgPSBqOwogICAgICAgIGogPSBpOwogICAgICAgIGkgPSB0ZW1wOwogICAgICB9CgogICAgICByZXR1cm4gaSA8PCAxNiB8IGo7CiAgICB9CiAgICAvKioKICAgICAqIHNldAogICAgICovCgoKICAgIHNldChpLCBqKSB7CiAgICAgIC8vIEluc2VydGlvbiBzb3J0LiBUaGlzIHdheSB0aGUgZGlmZiB3aWxsIGhhdmUgbGluZWFyIGNvbXBsZXhpdHkuCiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGksIGopOwogICAgICBjb25zdCBjdXJyZW50ID0gdGhpcy5jdXJyZW50OwogICAgICBsZXQgaW5kZXggPSAwOwoKICAgICAgd2hpbGUgKGtleSA+IGN1cnJlbnRbaW5kZXhdKSB7CiAgICAgICAgaW5kZXgrKzsKICAgICAgfQoKICAgICAgaWYgKGtleSA9PT0gY3VycmVudFtpbmRleF0pIHsKICAgICAgICByZXR1cm47IC8vIFBhaXIgd2FzIGFscmVhZHkgYWRkZWQKICAgICAgfQoKICAgICAgZm9yIChsZXQgaiA9IGN1cnJlbnQubGVuZ3RoIC0gMTsgaiA+PSBpbmRleDsgai0tKSB7CiAgICAgICAgY3VycmVudFtqICsgMV0gPSBjdXJyZW50W2pdOwogICAgICB9CgogICAgICBjdXJyZW50W2luZGV4XSA9IGtleTsKICAgIH0KICAgIC8qKgogICAgICogdGljawogICAgICovCgoKICAgIHRpY2soKSB7CiAgICAgIGNvbnN0IHRtcCA9IHRoaXMuY3VycmVudDsKICAgICAgdGhpcy5jdXJyZW50ID0gdGhpcy5wcmV2aW91czsKICAgICAgdGhpcy5wcmV2aW91cyA9IHRtcDsKICAgICAgdGhpcy5jdXJyZW50Lmxlbmd0aCA9IDA7CiAgICB9CiAgICAvKioKICAgICAqIGdldERpZmYKICAgICAqLwoKCiAgICBnZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpIHsKICAgICAgY29uc3QgYSA9IHRoaXMuY3VycmVudDsKICAgICAgY29uc3QgYiA9IHRoaXMucHJldmlvdXM7CiAgICAgIGNvbnN0IGFsID0gYS5sZW5ndGg7CiAgICAgIGNvbnN0IGJsID0gYi5sZW5ndGg7CiAgICAgIGxldCBqID0gMDsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYWw7IGkrKykgewogICAgICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgICAgIGNvbnN0IGtleUEgPSBhW2ldOwoKICAgICAgICB3aGlsZSAoa2V5QSA+IGJbal0pIHsKICAgICAgICAgIGorKzsKICAgICAgICB9CgogICAgICAgIGZvdW5kID0ga2V5QSA9PT0gYltqXTsKCiAgICAgICAgaWYgKCFmb3VuZCkgewogICAgICAgICAgdW5wYWNrQW5kUHVzaChhZGRpdGlvbnMsIGtleUEpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaiA9IDA7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJsOyBpKyspIHsKICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgICAgICBjb25zdCBrZXlCID0gYltpXTsKCiAgICAgICAgd2hpbGUgKGtleUIgPiBhW2pdKSB7CiAgICAgICAgICBqKys7CiAgICAgICAgfQoKICAgICAgICBmb3VuZCA9IGFbal0gPT09IGtleUI7CgogICAgICAgIGlmICghZm91bmQpIHsKICAgICAgICAgIHVucGFja0FuZFB1c2gocmVtb3ZhbHMsIGtleUIpOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICB9CgogIGZ1bmN0aW9uIHVucGFja0FuZFB1c2goYXJyYXksIGtleSkgewogICAgYXJyYXkucHVzaCgoa2V5ICYgMHhmZmZmMDAwMCkgPj4gMTYsIGtleSAmIDB4MDAwMGZmZmYpOwogIH0KICAvKioKICAgKiBUdXBsZURpY3Rpb25hcnkKICAgKi8KCgogIGNsYXNzIFR1cGxlRGljdGlvbmFyeSB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgdGhpcy5kYXRhID0gewogICAgICAgIGtleXM6IFtdCiAgICAgIH07CiAgICB9CiAgICAvKiogZ2V0ICovCgoKICAgIGdldChpLCBqKSB7CiAgICAgIGlmIChpID4gaikgewogICAgICAgIC8vIHN3YXAKICAgICAgICBjb25zdCB0ZW1wID0gajsKICAgICAgICBqID0gaTsKICAgICAgICBpID0gdGVtcDsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuZGF0YVtpICsgIi0iICsgal07CiAgICB9CiAgICAvKiogc2V0ICovCgoKICAgIHNldChpLCBqLCB2YWx1ZSkgewogICAgICBpZiAoaSA+IGopIHsKICAgICAgICBjb25zdCB0ZW1wID0gajsKICAgICAgICBqID0gaTsKICAgICAgICBpID0gdGVtcDsKICAgICAgfQoKICAgICAgY29uc3Qga2V5ID0gaSArICItIiArIGo7IC8vIENoZWNrIGlmIGtleSBhbHJlYWR5IGV4aXN0cwoKICAgICAgaWYgKCF0aGlzLmdldChpLCBqKSkgewogICAgICAgIHRoaXMuZGF0YS5rZXlzLnB1c2goa2V5KTsKICAgICAgfQoKICAgICAgdGhpcy5kYXRhW2tleV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKiByZXNldCAqLwoKCiAgICByZXNldCgpIHsKICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZGF0YTsKICAgICAgY29uc3Qga2V5cyA9IGRhdGEua2V5czsKCiAgICAgIHdoaWxlIChrZXlzLmxlbmd0aCA+IDApIHsKICAgICAgICBjb25zdCBrZXkgPSBrZXlzLnBvcCgpOwogICAgICAgIGRlbGV0ZSBkYXRhW2tleV07CiAgICAgIH0KICAgIH0KCiAgfQogIC8qKgogICAqIFRoZSBwaHlzaWNzIHdvcmxkCiAgICovCgoKICBjbGFzcyBXb3JsZCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgIC8qKgogICAgICogQ3VycmVudGx5IC8gbGFzdCB1c2VkIHRpbWVzdGVwLiBJcyBzZXQgdG8gLTEgaWYgbm90IGF2YWlsYWJsZS4gVGhpcyB2YWx1ZSBpcyB1cGRhdGVkIGJlZm9yZSBlYWNoIGludGVybmFsIHN0ZXAsIHdoaWNoIG1lYW5zIHRoYXQgaXQgaXMgImZyZXNoIiBpbnNpZGUgZXZlbnQgY2FsbGJhY2tzLgogICAgICovCgogICAgLyoqCiAgICAgKiBNYWtlcyBib2RpZXMgZ28gdG8gc2xlZXAgd2hlbiB0aGV5J3ZlIGJlZW4gaW5hY3RpdmUuCiAgICAgKiBAZGVmYXVsdCBmYWxzZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgdGhlIGN1cnJlbnQgY29udGFjdHMgKGluc3RhbmNlcyBvZiBDb250YWN0RXF1YXRpb24pIGluIHRoZSB3b3JsZC4KICAgICAqLwoKICAgIC8qKgogICAgICogSG93IG9mdGVuIHRvIG5vcm1hbGl6ZSBxdWF0ZXJuaW9ucy4gU2V0IHRvIDAgZm9yIGV2ZXJ5IHN0ZXAsIDEgZm9yIGV2ZXJ5IHNlY29uZCBldGMuLiBBIGxhcmdlciB2YWx1ZSBpbmNyZWFzZXMgcGVyZm9ybWFuY2UuIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBhIHNtYWxsZXIgdmFsdWUgKHplcm8gdG8gYmUgc3VyZSBub3RoaW5nIGNhbiBnbyB3cm9uZykuCiAgICAgKiBAZGVmYXVsdCAwCiAgICAgKi8KCiAgICAvKioKICAgICAqIFNldCB0byB0cnVlIHRvIHVzZSBmYXN0IHF1YXRlcm5pb24gbm9ybWFsaXphdGlvbi4gSXQgaXMgb2Z0ZW4gZW5vdWdoIGFjY3VyYXRlIHRvIHVzZS4KICAgICAqIElmIGJvZGllcyB0ZW5kIHRvIGV4cGxvZGUsIHNldCB0byBmYWxzZS4KICAgICAqIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSB3YWxsLWNsb2NrIHRpbWUgc2luY2Ugc2ltdWxhdGlvbiBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHRpbWVzdGVwcyB0YWtlbiBzaW5jZSBzdGFydC4KICAgICAqLwoKICAgIC8qKgogICAgICogRGVmYXVsdCBhbmQgbGFzdCB0aW1lc3RlcCBzaXplcy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIGdyYXZpdHkgb2YgdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBUaGUgYnJvYWRwaGFzZSBhbGdvcml0aG0gdG8gdXNlLgogICAgICogQGRlZmF1bHQgTmFpdmVCcm9hZHBoYXNlCiAgICAgKi8KCiAgICAvKioKICAgICAqIEFsbCBib2RpZXMgaW4gdGhpcyB3b3JsZAogICAgICovCgogICAgLyoqCiAgICAgKiBUcnVlIGlmIGFueSBib2RpZXMgYXJlIG5vdCBzbGVlcGluZywgZmFsc2UgaWYgZXZlcnkgYm9keSBpcyBzbGVlcGluZy4KICAgICAqLwoKICAgIC8qKgogICAgICogVGhlIHNvbHZlciBhbGdvcml0aG0gdG8gdXNlLgogICAgICogQGRlZmF1bHQgR1NTb2x2ZXIKICAgICAqLwoKICAgIC8qKgogICAgICogY29sbGlzaW9uTWF0cml4CiAgICAgKi8KCiAgICAvKioKICAgICAqIENvbGxpc2lvbk1hdHJpeCBmcm9tIHRoZSBwcmV2aW91cyBzdGVwLgogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYWRkZWQgbWF0ZXJpYWxzLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqIEB0b2RvIFJlbW92ZQogICAgICovCgogICAgLyoqCiAgICAgKiBBbGwgYWRkZWQgY29udGFjdG1hdGVyaWFscy4KICAgICAqLwoKICAgIC8qKgogICAgICogVXNlZCB0byBsb29rIHVwIGEgQ29udGFjdE1hdGVyaWFsIGdpdmVuIHR3byBpbnN0YW5jZXMgb2YgTWF0ZXJpYWwuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoZSBkZWZhdWx0IG1hdGVyaWFsIG9mIHRoZSBib2RpZXMuCiAgICAgKi8KCiAgICAvKioKICAgICAqIFRoaXMgY29udGFjdCBtYXRlcmlhbCBpcyB1c2VkIGlmIG5vIHN1aXRhYmxlIGNvbnRhY3RtYXRlcmlhbCBpcyBmb3VuZCBmb3IgYSBjb250YWN0LgogICAgICovCgogICAgLyoqCiAgICAgKiBUaW1lIGFjY3VtdWxhdG9yIGZvciBpbnRlcnBvbGF0aW9uLgogICAgICogQHNlZSBodHRwczovL2dhZmZlcm9uZ2FtZXMuY29tL2dhbWUtcGh5c2ljcy9maXgteW91ci10aW1lc3RlcC8KICAgICAqLwoKICAgIC8qKgogICAgICogRGlzcGF0Y2hlZCBhZnRlciBhIGJvZHkgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIHdvcmxkLgogICAgICovCgogICAgLyoqCiAgICAgKiBEaXNwYXRjaGVkIGFmdGVyIGEgYm9keSBoYXMgYmVlbiByZW1vdmVkIGZyb20gdGhlIHdvcmxkLgogICAgICovCiAgICBjb25zdHJ1Y3RvcihvcHRpb25zID0ge30pIHsKICAgICAgc3VwZXIoKTsKICAgICAgdGhpcy5kdCA9IHZvaWQgMDsKICAgICAgdGhpcy5hbGxvd1NsZWVwID0gdm9pZCAwOwogICAgICB0aGlzLmNvbnRhY3RzID0gdm9pZCAwOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zID0gdm9pZCAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVTa2lwID0gdm9pZCAwOwogICAgICB0aGlzLnF1YXROb3JtYWxpemVGYXN0ID0gdm9pZCAwOwogICAgICB0aGlzLnRpbWUgPSB2b2lkIDA7CiAgICAgIHRoaXMuc3RlcG51bWJlciA9IHZvaWQgMDsKICAgICAgdGhpcy5kZWZhdWx0X2R0ID0gdm9pZCAwOwogICAgICB0aGlzLm5leHRJZCA9IHZvaWQgMDsKICAgICAgdGhpcy5ncmF2aXR5ID0gdm9pZCAwOwogICAgICB0aGlzLmJyb2FkcGhhc2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuYm9kaWVzID0gdm9pZCAwOwogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IHZvaWQgMDsKICAgICAgdGhpcy5zb2x2ZXIgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29uc3RyYWludHMgPSB2b2lkIDA7CiAgICAgIHRoaXMubmFycm93cGhhc2UgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4ID0gdm9pZCAwOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzID0gdm9pZCAwOwogICAgICB0aGlzLmJvZHlPdmVybGFwS2VlcGVyID0gdm9pZCAwOwogICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlciA9IHZvaWQgMDsKICAgICAgdGhpcy5tYXRlcmlhbHMgPSB2b2lkIDA7CiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscyA9IHZvaWQgMDsKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZSA9IHZvaWQgMDsKICAgICAgdGhpcy5kZWZhdWx0TWF0ZXJpYWwgPSB2b2lkIDA7CiAgICAgIHRoaXMuZGVmYXVsdENvbnRhY3RNYXRlcmlhbCA9IHZvaWQgMDsKICAgICAgdGhpcy5kb1Byb2ZpbGluZyA9IHZvaWQgMDsKICAgICAgdGhpcy5wcm9maWxlID0gdm9pZCAwOwogICAgICB0aGlzLmFjY3VtdWxhdG9yID0gdm9pZCAwOwogICAgICB0aGlzLnN1YnN5c3RlbXMgPSB2b2lkIDA7CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50ID0gdm9pZCAwOwogICAgICB0aGlzLnJlbW92ZUJvZHlFdmVudCA9IHZvaWQgMDsKICAgICAgdGhpcy5pZFRvQm9keU1hcCA9IHZvaWQgMDsKICAgICAgdGhpcy5kdCA9IC0xOwogICAgICB0aGlzLmFsbG93U2xlZXAgPSAhIW9wdGlvbnMuYWxsb3dTbGVlcDsKICAgICAgdGhpcy5jb250YWN0cyA9IFtdOwogICAgICB0aGlzLmZyaWN0aW9uRXF1YXRpb25zID0gW107CiAgICAgIHRoaXMucXVhdE5vcm1hbGl6ZVNraXAgPSBvcHRpb25zLnF1YXROb3JtYWxpemVTa2lwICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLnF1YXROb3JtYWxpemVTa2lwIDogMDsKICAgICAgdGhpcy5xdWF0Tm9ybWFsaXplRmFzdCA9IG9wdGlvbnMucXVhdE5vcm1hbGl6ZUZhc3QgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMucXVhdE5vcm1hbGl6ZUZhc3QgOiBmYWxzZTsKICAgICAgdGhpcy50aW1lID0gMC4wOwogICAgICB0aGlzLnN0ZXBudW1iZXIgPSAwOwogICAgICB0aGlzLmRlZmF1bHRfZHQgPSAxIC8gNjA7CiAgICAgIHRoaXMubmV4dElkID0gMDsKICAgICAgdGhpcy5ncmF2aXR5ID0gbmV3IFZlYzMoKTsKCiAgICAgIGlmIChvcHRpb25zLmdyYXZpdHkpIHsKICAgICAgICB0aGlzLmdyYXZpdHkuY29weShvcHRpb25zLmdyYXZpdHkpOwogICAgICB9CgogICAgICB0aGlzLmJyb2FkcGhhc2UgPSBvcHRpb25zLmJyb2FkcGhhc2UgIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuYnJvYWRwaGFzZSA6IG5ldyBOYWl2ZUJyb2FkcGhhc2UoKTsKICAgICAgdGhpcy5ib2RpZXMgPSBbXTsKICAgICAgdGhpcy5oYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKICAgICAgdGhpcy5zb2x2ZXIgPSBvcHRpb25zLnNvbHZlciAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5zb2x2ZXIgOiBuZXcgR1NTb2x2ZXIoKTsKICAgICAgdGhpcy5jb25zdHJhaW50cyA9IFtdOwogICAgICB0aGlzLm5hcnJvd3BoYXNlID0gbmV3IE5hcnJvd3BoYXNlKHRoaXMpOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeCA9IG5ldyBBcnJheUNvbGxpc2lvbk1hdHJpeCgpOwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzID0gbmV3IEFycmF5Q29sbGlzaW9uTWF0cml4KCk7CiAgICAgIHRoaXMuYm9keU92ZXJsYXBLZWVwZXIgPSBuZXcgT3ZlcmxhcEtlZXBlcigpOwogICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlciA9IG5ldyBPdmVybGFwS2VlcGVyKCk7CiAgICAgIHRoaXMubWF0ZXJpYWxzID0gW107CiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscyA9IFtdOwogICAgICB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlID0gbmV3IFR1cGxlRGljdGlvbmFyeSgpOwogICAgICB0aGlzLmRlZmF1bHRNYXRlcmlhbCA9IG5ldyBNYXRlcmlhbCgnZGVmYXVsdCcpOwogICAgICB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWwgPSBuZXcgQ29udGFjdE1hdGVyaWFsKHRoaXMuZGVmYXVsdE1hdGVyaWFsLCB0aGlzLmRlZmF1bHRNYXRlcmlhbCwgewogICAgICAgIGZyaWN0aW9uOiAwLjMsCiAgICAgICAgcmVzdGl0dXRpb246IDAuMAogICAgICB9KTsKICAgICAgdGhpcy5kb1Byb2ZpbGluZyA9IGZhbHNlOwogICAgICB0aGlzLnByb2ZpbGUgPSB7CiAgICAgICAgc29sdmU6IDAsCiAgICAgICAgbWFrZUNvbnRhY3RDb25zdHJhaW50czogMCwKICAgICAgICBicm9hZHBoYXNlOiAwLAogICAgICAgIGludGVncmF0ZTogMCwKICAgICAgICBuYXJyb3dwaGFzZTogMAogICAgICB9OwogICAgICB0aGlzLmFjY3VtdWxhdG9yID0gMDsKICAgICAgdGhpcy5zdWJzeXN0ZW1zID0gW107CiAgICAgIHRoaXMuYWRkQm9keUV2ZW50ID0gewogICAgICAgIHR5cGU6ICdhZGRCb2R5JywKICAgICAgICBib2R5OiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMucmVtb3ZlQm9keUV2ZW50ID0gewogICAgICAgIHR5cGU6ICdyZW1vdmVCb2R5JywKICAgICAgICBib2R5OiBudWxsCiAgICAgIH07CiAgICAgIHRoaXMuaWRUb0JvZHlNYXAgPSB7fTsKICAgICAgdGhpcy5icm9hZHBoYXNlLnNldFdvcmxkKHRoaXMpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgdGhlIGNvbnRhY3QgbWF0ZXJpYWwgYmV0d2VlbiBtYXRlcmlhbHMgbTEgYW5kIG0yCiAgICAgKiBAcmV0dXJuIFRoZSBjb250YWN0IG1hdGVyaWFsIGlmIGl0IHdhcyBmb3VuZC4KICAgICAqLwoKCiAgICBnZXRDb250YWN0TWF0ZXJpYWwobTEsIG0yKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnRhY3RNYXRlcmlhbFRhYmxlLmdldChtMS5pZCwgbTIuaWQpOwogICAgfQogICAgLyoqCiAgICAgKiBHZXQgbnVtYmVyIG9mIG9iamVjdHMgaW4gdGhlIHdvcmxkLgogICAgICogQGRlcHJlY2F0ZWQKICAgICAqLwoKCiAgICBudW1PYmplY3RzKCkgewogICAgICByZXR1cm4gdGhpcy5ib2RpZXMubGVuZ3RoOwogICAgfQogICAgLyoqCiAgICAgKiBTdG9yZSBvbGQgY29sbGlzaW9uIHN0YXRlIGluZm8KICAgICAqLwoKCiAgICBjb2xsaXNpb25NYXRyaXhUaWNrKCkgewogICAgICBjb25zdCB0ZW1wID0gdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91czsKICAgICAgdGhpcy5jb2xsaXNpb25NYXRyaXhQcmV2aW91cyA9IHRoaXMuY29sbGlzaW9uTWF0cml4OwogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeCA9IHRlbXA7CiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4LnJlc2V0KCk7CiAgICAgIHRoaXMuYm9keU92ZXJsYXBLZWVwZXIudGljaygpOwogICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci50aWNrKCk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIGNvbnN0cmFpbnQgdG8gdGhlIHNpbXVsYXRpb24uCiAgICAgKi8KCgogICAgYWRkQ29uc3RyYWludChjKSB7CiAgICAgIHRoaXMuY29uc3RyYWludHMucHVzaChjKTsKICAgIH0KICAgIC8qKgogICAgICogUmVtb3ZlcyBhIGNvbnN0cmFpbnQKICAgICAqLwoKCiAgICByZW1vdmVDb25zdHJhaW50KGMpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5jb25zdHJhaW50cy5pbmRleE9mKGMpOwoKICAgICAgaWYgKGlkeCAhPT0gLTEpIHsKICAgICAgICB0aGlzLmNvbnN0cmFpbnRzLnNwbGljZShpZHgsIDEpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJheWNhc3QgdGVzdAogICAgICogQGRlcHJlY2F0ZWQgVXNlIC5yYXljYXN0QWxsLCAucmF5Y2FzdENsb3Nlc3Qgb3IgLnJheWNhc3RBbnkgaW5zdGVhZC4KICAgICAqLwoKCiAgICByYXlUZXN0KGZyb20sIHRvLCByZXN1bHQpIHsKICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFJheWNhc3RSZXN1bHQpIHsKICAgICAgICAvLyBEbyByYXljYXN0Q2xvc2VzdAogICAgICAgIHRoaXMucmF5Y2FzdENsb3Nlc3QoZnJvbSwgdG8sIHsKICAgICAgICAgIHNraXBCYWNrZmFjZXM6IHRydWUKICAgICAgICB9LCByZXN1bHQpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIERvIHJheWNhc3RBbGwKICAgICAgICB0aGlzLnJheWNhc3RBbGwoZnJvbSwgdG8sIHsKICAgICAgICAgIHNraXBCYWNrZmFjZXM6IHRydWUKICAgICAgICB9LCByZXN1bHQpOwogICAgICB9CiAgICB9CiAgICAvKioKICAgICAqIFJheSBjYXN0IGFnYWluc3QgYWxsIGJvZGllcy4gVGhlIHByb3ZpZGVkIGNhbGxiYWNrIHdpbGwgYmUgZXhlY3V0ZWQgZm9yIGVhY2ggaGl0IHdpdGggYSBSYXljYXN0UmVzdWx0IGFzIHNpbmdsZSBhcmd1bWVudC4KICAgICAqIEByZXR1cm4gVHJ1ZSBpZiBhbnkgYm9keSB3YXMgaGl0LgogICAgICovCgoKICAgIHJheWNhc3RBbGwoZnJvbSwgdG8sIG9wdGlvbnMgPSB7fSwgY2FsbGJhY2spIHsKICAgICAgb3B0aW9ucy5tb2RlID0gUmF5LkFMTDsKICAgICAgb3B0aW9ucy5mcm9tID0gZnJvbTsKICAgICAgb3B0aW9ucy50byA9IHRvOwogICAgICBvcHRpb25zLmNhbGxiYWNrID0gY2FsbGJhY2s7CiAgICAgIHJldHVybiB0bXBSYXkuaW50ZXJzZWN0V29ybGQodGhpcywgb3B0aW9ucyk7CiAgICB9CiAgICAvKioKICAgICAqIFJheSBjYXN0LCBhbmQgc3RvcCBhdCB0aGUgZmlyc3QgcmVzdWx0LiBOb3RlIHRoYXQgdGhlIG9yZGVyIGlzIHJhbmRvbSAtIGJ1dCB0aGUgbWV0aG9kIGlzIGZhc3QuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0QW55KGZyb20sIHRvLCBvcHRpb25zID0ge30sIHJlc3VsdCkgewogICAgICBvcHRpb25zLm1vZGUgPSBSYXkuQU5ZOwogICAgICBvcHRpb25zLmZyb20gPSBmcm9tOwogICAgICBvcHRpb25zLnRvID0gdG87CiAgICAgIG9wdGlvbnMucmVzdWx0ID0gcmVzdWx0OwogICAgICByZXR1cm4gdG1wUmF5LmludGVyc2VjdFdvcmxkKHRoaXMsIG9wdGlvbnMpOwogICAgfQogICAgLyoqCiAgICAgKiBSYXkgY2FzdCwgYW5kIHJldHVybiBpbmZvcm1hdGlvbiBvZiB0aGUgY2xvc2VzdCBoaXQuCiAgICAgKiBAcmV0dXJuIFRydWUgaWYgYW55IGJvZHkgd2FzIGhpdC4KICAgICAqLwoKCiAgICByYXljYXN0Q2xvc2VzdChmcm9tLCB0bywgb3B0aW9ucyA9IHt9LCByZXN1bHQpIHsKICAgICAgb3B0aW9ucy5tb2RlID0gUmF5LkNMT1NFU1Q7CiAgICAgIG9wdGlvbnMuZnJvbSA9IGZyb207CiAgICAgIG9wdGlvbnMudG8gPSB0bzsKICAgICAgb3B0aW9ucy5yZXN1bHQgPSByZXN1bHQ7CiAgICAgIHJldHVybiB0bXBSYXkuaW50ZXJzZWN0V29ybGQodGhpcywgb3B0aW9ucyk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZCBhIHJpZ2lkIGJvZHkgdG8gdGhlIHNpbXVsYXRpb24uCiAgICAgKiBAdG9kbyBJZiB0aGUgc2ltdWxhdGlvbiBoYXMgbm90IHlldCBzdGFydGVkLCB3aHkgcmVjcmV0ZSBhbmQgY29weSBhcnJheXMgZm9yIGVhY2ggYm9keT8gQWNjdW11bGF0ZSBpbiBkeW5hbWljIGFycmF5cyBpbiB0aGlzIGNhc2UuCiAgICAgKiBAdG9kbyBBZGRpbmcgYW4gYXJyYXkgb2YgYm9kaWVzIHNob3VsZCBiZSBwb3NzaWJsZS4gVGhpcyB3b3VsZCBzYXZlIHNvbWUgbG9vcHMgdG9vCiAgICAgKi8KCgogICAgYWRkQm9keShib2R5KSB7CiAgICAgIGlmICh0aGlzLmJvZGllcy5pbmNsdWRlcyhib2R5KSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYm9keS5pbmRleCA9IHRoaXMuYm9kaWVzLmxlbmd0aDsKICAgICAgdGhpcy5ib2RpZXMucHVzaChib2R5KTsKICAgICAgYm9keS53b3JsZCA9IHRoaXM7CiAgICAgIGJvZHkuaW5pdFBvc2l0aW9uLmNvcHkoYm9keS5wb3NpdGlvbik7CiAgICAgIGJvZHkuaW5pdFZlbG9jaXR5LmNvcHkoYm9keS52ZWxvY2l0eSk7CiAgICAgIGJvZHkudGltZUxhc3RTbGVlcHkgPSB0aGlzLnRpbWU7CgogICAgICBpZiAoYm9keSBpbnN0YW5jZW9mIEJvZHkpIHsKICAgICAgICBib2R5LmluaXRBbmd1bGFyVmVsb2NpdHkuY29weShib2R5LmFuZ3VsYXJWZWxvY2l0eSk7CiAgICAgICAgYm9keS5pbml0UXVhdGVybmlvbi5jb3B5KGJvZHkucXVhdGVybmlvbik7CiAgICAgIH0KCiAgICAgIHRoaXMuY29sbGlzaW9uTWF0cml4LnNldE51bU9iamVjdHModGhpcy5ib2RpZXMubGVuZ3RoKTsKICAgICAgdGhpcy5hZGRCb2R5RXZlbnQuYm9keSA9IGJvZHk7CiAgICAgIHRoaXMuaWRUb0JvZHlNYXBbYm9keS5pZF0gPSBib2R5OwogICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5hZGRCb2R5RXZlbnQpOwogICAgfQogICAgLyoqCiAgICAgKiBSZW1vdmUgYSByaWdpZCBib2R5IGZyb20gdGhlIHNpbXVsYXRpb24uCiAgICAgKi8KCgogICAgcmVtb3ZlQm9keShib2R5KSB7CiAgICAgIGJvZHkud29ybGQgPSBudWxsOwogICAgICBjb25zdCBuID0gdGhpcy5ib2RpZXMubGVuZ3RoIC0gMTsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IGlkeCA9IGJvZGllcy5pbmRleE9mKGJvZHkpOwoKICAgICAgaWYgKGlkeCAhPT0gLTEpIHsKICAgICAgICBib2RpZXMuc3BsaWNlKGlkeCwgMSk7IC8vIFRvZG86IHNob3VsZCB1c2UgYSBnYXJiYWdlIGZyZWUgbWV0aG9kCiAgICAgICAgLy8gUmVjb21wdXRlIGluZGV4CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpICE9PSBib2RpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGJvZGllc1tpXS5pbmRleCA9IGk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXROdW1PYmplY3RzKG4pOwogICAgICAgIHRoaXMucmVtb3ZlQm9keUV2ZW50LmJvZHkgPSBib2R5OwogICAgICAgIGRlbGV0ZSB0aGlzLmlkVG9Cb2R5TWFwW2JvZHkuaWRdOwogICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudCh0aGlzLnJlbW92ZUJvZHlFdmVudCk7CiAgICAgIH0KICAgIH0KCiAgICBnZXRCb2R5QnlJZChpZCkgewogICAgICByZXR1cm4gdGhpcy5pZFRvQm9keU1hcFtpZF07CiAgICB9CiAgICAvKioKICAgICAqIEB0b2RvIE1ha2UgYSBmYXN0ZXIgbWFwCiAgICAgKi8KCgogICAgZ2V0U2hhcGVCeUlkKGlkKSB7CiAgICAgIGNvbnN0IGJvZGllcyA9IHRoaXMuYm9kaWVzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2RpZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBzaGFwZXMgPSBib2RpZXNbaV0uc2hhcGVzOwoKICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHNoYXBlcy5sZW5ndGg7IGorKykgewogICAgICAgICAgY29uc3Qgc2hhcGUgPSBzaGFwZXNbal07CgogICAgICAgICAgaWYgKHNoYXBlLmlkID09PSBpZCkgewogICAgICAgICAgICByZXR1cm4gc2hhcGU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qKgogICAgICogQWRkcyBhIG1hdGVyaWFsIHRvIHRoZSBXb3JsZC4KICAgICAqIEBkZXByZWNhdGVkCiAgICAgKiBAdG9kbyBSZW1vdmUKICAgICAqLwoKCiAgICBhZGRNYXRlcmlhbChtKSB7CiAgICAgIHRoaXMubWF0ZXJpYWxzLnB1c2gobSk7CiAgICB9CiAgICAvKioKICAgICAqIEFkZHMgYSBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBXb3JsZAogICAgICovCgoKICAgIGFkZENvbnRhY3RNYXRlcmlhbChjbWF0KSB7CiAgICAgIC8vIEFkZCBjb250YWN0IG1hdGVyaWFsCiAgICAgIHRoaXMuY29udGFjdG1hdGVyaWFscy5wdXNoKGNtYXQpOyAvLyBBZGQgY3VycmVudCBjb250YWN0IG1hdGVyaWFsIHRvIHRoZSBtYXRlcmlhbCB0YWJsZQoKICAgICAgdGhpcy5jb250YWN0TWF0ZXJpYWxUYWJsZS5zZXQoY21hdC5tYXRlcmlhbHNbMF0uaWQsIGNtYXQubWF0ZXJpYWxzWzFdLmlkLCBjbWF0KTsKICAgIH0KICAgIC8qKgogICAgICogU3RlcCB0aGUgcGh5c2ljcyB3b3JsZCBmb3J3YXJkIGluIHRpbWUuCiAgICAgKgogICAgICogVGhlcmUgYXJlIHR3byBtb2Rlcy4gVGhlIHNpbXBsZSBtb2RlIGlzIGZpeGVkIHRpbWVzdGVwcGluZyB3aXRob3V0IGludGVycG9sYXRpb24uIEluIHRoaXMgY2FzZSB5b3Ugb25seSB1c2UgdGhlIGZpcnN0IGFyZ3VtZW50LiBUaGUgc2Vjb25kIGNhc2UgdXNlcyBpbnRlcnBvbGF0aW9uLiBJbiB0aGF0IHlvdSBhbHNvIHByb3ZpZGUgdGhlIHRpbWUgc2luY2UgdGhlIGZ1bmN0aW9uIHdhcyBsYXN0IHVzZWQsIGFzIHdlbGwgYXMgdGhlIG1heGltdW0gZml4ZWQgdGltZXN0ZXBzIHRvIHRha2UuCiAgICAgKgogICAgICogQHBhcmFtIGR0IFRoZSBmaXhlZCB0aW1lIHN0ZXAgc2l6ZSB0byB1c2UuCiAgICAgKiBAcGFyYW0gdGltZVNpbmNlTGFzdENhbGxlZCBUaGUgdGltZSBlbGFwc2VkIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCBjYWxsZWQuCiAgICAgKiBAcGFyYW0gbWF4U3ViU3RlcHMgTWF4aW11bSBudW1iZXIgb2YgZml4ZWQgc3RlcHMgdG8gdGFrZSBwZXIgZnVuY3Rpb24gY2FsbC4KICAgICAqIEBzZWUgaHR0cHM6Ly93ZWIuYXJjaGl2ZS5vcmcvd2ViLzIwMTgwNDI2MTU0NTMxL2h0dHA6Ly9idWxsZXRwaHlzaWNzLm9yZy9tZWRpYXdpa2ktMS41LjgvaW5kZXgucGhwL1N0ZXBwaW5nX1RoZV9Xb3JsZCNXaGF0X2RvX3RoZV9wYXJhbWV0ZXJzX3RvX2J0RHluYW1pY3NXb3JsZDo6c3RlcFNpbXVsYXRpb25fbWVhbi4zRgogICAgICogQGV4YW1wbGUKICAgICAqICAgICAvLyBmaXhlZCB0aW1lc3RlcHBpbmcgd2l0aG91dCBpbnRlcnBvbGF0aW9uCiAgICAgKiAgICAgd29ybGQuc3RlcCgxIC8gNjApCiAgICAgKi8KCgogICAgc3RlcChkdCwgdGltZVNpbmNlTGFzdENhbGxlZCwgbWF4U3ViU3RlcHMgPSAxMCkgewogICAgICBpZiAodGltZVNpbmNlTGFzdENhbGxlZCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgLy8gRml4ZWQsIHNpbXBsZSBzdGVwcGluZwogICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsgLy8gSW5jcmVtZW50IHRpbWUKCiAgICAgICAgdGhpcy50aW1lICs9IGR0OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYWNjdW11bGF0b3IgKz0gdGltZVNpbmNlTGFzdENhbGxlZDsKICAgICAgICBjb25zdCB0MCA9IHBlcmZvcm1hbmNlJDEubm93KCk7CiAgICAgICAgbGV0IHN1YnN0ZXBzID0gMDsKCiAgICAgICAgd2hpbGUgKHRoaXMuYWNjdW11bGF0b3IgPj0gZHQgJiYgc3Vic3RlcHMgPCBtYXhTdWJTdGVwcykgewogICAgICAgICAgLy8gRG8gZml4ZWQgc3RlcHMgdG8gY2F0Y2ggdXAKICAgICAgICAgIHRoaXMuaW50ZXJuYWxTdGVwKGR0KTsKICAgICAgICAgIHRoaXMuYWNjdW11bGF0b3IgLT0gZHQ7CiAgICAgICAgICBzdWJzdGVwcysrOwoKICAgICAgICAgIGlmIChwZXJmb3JtYW5jZSQxLm5vdygpIC0gdDAgPiBkdCAqIDEwMDApIHsKICAgICAgICAgICAgLy8gVGhlIGZyYW1lcmF0ZSBpcyBub3QgaW50ZXJhY3RpdmUgYW55bW9yZS4KICAgICAgICAgICAgLy8gV2UgYXJlIGJlbG93IHRoZSB0YXJnZXQgZnJhbWVyYXRlLgogICAgICAgICAgICAvLyBCZXR0ZXIgYmFpbCBvdXQuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gLy8gUmVtb3ZlIHRoZSBleGNlc3MgYWNjdW11bGF0b3IsIHNpbmNlIHdlIG1heSBub3QKICAgICAgICAvLyBoYXZlIGhhZCBlbm91Z2ggc3Vic3RlcHMgYXZhaWxhYmxlIHRvIGNhdGNoIHVwCgoKICAgICAgICB0aGlzLmFjY3VtdWxhdG9yID0gdGhpcy5hY2N1bXVsYXRvciAlIGR0OwogICAgICAgIGNvbnN0IHQgPSB0aGlzLmFjY3VtdWxhdG9yIC8gZHQ7CgogICAgICAgIGZvciAobGV0IGogPSAwOyBqICE9PSB0aGlzLmJvZGllcy5sZW5ndGg7IGorKykgewogICAgICAgICAgY29uc3QgYiA9IHRoaXMuYm9kaWVzW2pdOwogICAgICAgICAgYi5wcmV2aW91c1Bvc2l0aW9uLmxlcnAoYi5wb3NpdGlvbiwgdCwgYi5pbnRlcnBvbGF0ZWRQb3NpdGlvbik7CiAgICAgICAgICBiLnByZXZpb3VzUXVhdGVybmlvbi5zbGVycChiLnF1YXRlcm5pb24sIHQsIGIuaW50ZXJwb2xhdGVkUXVhdGVybmlvbik7CiAgICAgICAgICBiLnByZXZpb3VzUXVhdGVybmlvbi5ub3JtYWxpemUoKTsKICAgICAgICB9CgogICAgICAgIHRoaXMudGltZSArPSB0aW1lU2luY2VMYXN0Q2FsbGVkOwogICAgICB9CiAgICB9CgogICAgaW50ZXJuYWxTdGVwKGR0KSB7CiAgICAgIHRoaXMuZHQgPSBkdDsKICAgICAgY29uc3QgY29udGFjdHMgPSB0aGlzLmNvbnRhY3RzOwogICAgICBjb25zdCBwMSA9IFdvcmxkX3N0ZXBfcDE7CiAgICAgIGNvbnN0IHAyID0gV29ybGRfc3RlcF9wMjsKICAgICAgY29uc3QgTiA9IHRoaXMubnVtT2JqZWN0cygpOwogICAgICBjb25zdCBib2RpZXMgPSB0aGlzLmJvZGllczsKICAgICAgY29uc3Qgc29sdmVyID0gdGhpcy5zb2x2ZXI7CiAgICAgIGNvbnN0IGdyYXZpdHkgPSB0aGlzLmdyYXZpdHk7CiAgICAgIGNvbnN0IGRvUHJvZmlsaW5nID0gdGhpcy5kb1Byb2ZpbGluZzsKICAgICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZTsKICAgICAgY29uc3QgRFlOQU1JQyA9IEJvZHkuRFlOQU1JQzsKICAgICAgbGV0IHByb2ZpbGluZ1N0YXJ0ID0gLUluZmluaXR5OwogICAgICBjb25zdCBjb25zdHJhaW50cyA9IHRoaXMuY29uc3RyYWludHM7CiAgICAgIGNvbnN0IGZyaWN0aW9uRXF1YXRpb25Qb29sID0gV29ybGRfc3RlcF9mcmljdGlvbkVxdWF0aW9uUG9vbDsKICAgICAgZ3Jhdml0eS5sZW5ndGgoKTsKICAgICAgY29uc3QgZ3ggPSBncmF2aXR5Lng7CiAgICAgIGNvbnN0IGd5ID0gZ3Jhdml0eS55OwogICAgICBjb25zdCBneiA9IGdyYXZpdHkuejsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZSQxLm5vdygpOwogICAgICB9IC8vIEFkZCBncmF2aXR5IHRvIGFsbCBvYmplY3RzCgoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgY29uc3QgYmkgPSBib2RpZXNbaV07CgogICAgICAgIGlmIChiaS50eXBlID09PSBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgZiA9IGJpLmZvcmNlOwogICAgICAgICAgY29uc3QgbSA9IGJpLm1hc3M7CiAgICAgICAgICBmLnggKz0gbSAqIGd4OwogICAgICAgICAgZi55ICs9IG0gKiBneTsKICAgICAgICAgIGYueiArPSBtICogZ3o7CiAgICAgICAgfQogICAgICB9IC8vIFVwZGF0ZSBzdWJzeXN0ZW1zCgoKICAgICAgZm9yIChsZXQgaSA9IDAsIE5zdWJzeXN0ZW1zID0gdGhpcy5zdWJzeXN0ZW1zLmxlbmd0aDsgaSAhPT0gTnN1YnN5c3RlbXM7IGkrKykgewogICAgICAgIHRoaXMuc3Vic3lzdGVtc1tpXS51cGRhdGUoKTsKICAgICAgfSAvLyBDb2xsaXNpb24gZGV0ZWN0aW9uCgoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZSQxLm5vdygpOwogICAgICB9CgogICAgICBwMS5sZW5ndGggPSAwOyAvLyBDbGVhbiB1cCBwYWlyIGFycmF5cyBmcm9tIGxhc3Qgc3RlcAoKICAgICAgcDIubGVuZ3RoID0gMDsKICAgICAgdGhpcy5icm9hZHBoYXNlLmNvbGxpc2lvblBhaXJzKHRoaXMsIHAxLCBwMik7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLmJyb2FkcGhhc2UgPSBwZXJmb3JtYW5jZSQxLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGNvbnN0cmFpbmVkIHBhaXJzIHdpdGggY29sbGlkZUNvbm5lY3RlZCA9PSBmYWxzZQoKCiAgICAgIGxldCBOY29uc3RyYWludHMgPSBjb25zdHJhaW50cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOY29uc3RyYWludHM7IGkrKykgewogICAgICAgIGNvbnN0IGMgPSBjb25zdHJhaW50c1tpXTsKCiAgICAgICAgaWYgKCFjLmNvbGxpZGVDb25uZWN0ZWQpIHsKICAgICAgICAgIGZvciAobGV0IGogPSBwMS5sZW5ndGggLSAxOyBqID49IDA7IGogLT0gMSkgewogICAgICAgICAgICBpZiAoYy5ib2R5QSA9PT0gcDFbal0gJiYgYy5ib2R5QiA9PT0gcDJbal0gfHwgYy5ib2R5QiA9PT0gcDFbal0gJiYgYy5ib2R5QSA9PT0gcDJbal0pIHsKICAgICAgICAgICAgICBwMS5zcGxpY2UoaiwgMSk7CiAgICAgICAgICAgICAgcDIuc3BsaWNlKGosIDEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeFRpY2soKTsgLy8gR2VuZXJhdGUgY29udGFjdHMKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2UkMS5ub3coKTsKICAgICAgfQoKICAgICAgY29uc3Qgb2xkY29udGFjdHMgPSBXb3JsZF9zdGVwX29sZENvbnRhY3RzOwogICAgICBjb25zdCBOb2xkQ29udGFjdHMgPSBjb250YWN0cy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOb2xkQ29udGFjdHM7IGkrKykgewogICAgICAgIG9sZGNvbnRhY3RzLnB1c2goY29udGFjdHNbaV0pOwogICAgICB9CgogICAgICBjb250YWN0cy5sZW5ndGggPSAwOyAvLyBUcmFuc2ZlciBGcmljdGlvbkVxdWF0aW9uIGZyb20gY3VycmVudCBsaXN0IHRvIHRoZSBwb29sIGZvciByZXVzZQoKICAgICAgY29uc3QgTm9sZEZyaWN0aW9uRXF1YXRpb25zID0gdGhpcy5mcmljdGlvbkVxdWF0aW9ucy5sZW5ndGg7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOb2xkRnJpY3Rpb25FcXVhdGlvbnM7IGkrKykgewogICAgICAgIGZyaWN0aW9uRXF1YXRpb25Qb29sLnB1c2godGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoID0gMDsKICAgICAgdGhpcy5uYXJyb3dwaGFzZS5nZXRDb250YWN0cyhwMSwgcDIsIHRoaXMsIGNvbnRhY3RzLCBvbGRjb250YWN0cywgLy8gVG8gYmUgcmV1c2VkCiAgICAgIHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMsIGZyaWN0aW9uRXF1YXRpb25Qb29sKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUubmFycm93cGhhc2UgPSBwZXJmb3JtYW5jZSQxLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gTG9vcCBvdmVyIGFsbCBjb2xsaXNpb25zCgoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsaW5nU3RhcnQgPSBwZXJmb3JtYW5jZSQxLm5vdygpOwogICAgICB9IC8vIEFkZCBhbGwgZnJpY3Rpb24gZXFzCgoKICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZnJpY3Rpb25FcXVhdGlvbnMubGVuZ3RoOyBpKyspIHsKICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24odGhpcy5mcmljdGlvbkVxdWF0aW9uc1tpXSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IG5jb250YWN0cyA9IGNvbnRhY3RzLmxlbmd0aDsKCiAgICAgIGZvciAobGV0IGsgPSAwOyBrICE9PSBuY29udGFjdHM7IGsrKykgewogICAgICAgIC8vIEN1cnJlbnQgY29udGFjdAogICAgICAgIGNvbnN0IGMgPSBjb250YWN0c1trXTsgLy8gR2V0IGN1cnJlbnQgY29sbGlzaW9uIGluZGVjZXMKCiAgICAgICAgY29uc3QgYmkgPSBjLmJpOwogICAgICAgIGNvbnN0IGJqID0gYy5iajsKICAgICAgICBjb25zdCBzaSA9IGMuc2k7CiAgICAgICAgY29uc3Qgc2ogPSBjLnNqOyAvLyBHZXQgY29sbGlzaW9uIHByb3BlcnRpZXMKCiAgICAgICAgbGV0IGNtOwoKICAgICAgICBpZiAoYmkubWF0ZXJpYWwgJiYgYmoubWF0ZXJpYWwpIHsKICAgICAgICAgIGNtID0gdGhpcy5nZXRDb250YWN0TWF0ZXJpYWwoYmkubWF0ZXJpYWwsIGJqLm1hdGVyaWFsKSB8fCB0aGlzLmRlZmF1bHRDb250YWN0TWF0ZXJpYWw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNtID0gdGhpcy5kZWZhdWx0Q29udGFjdE1hdGVyaWFsOwogICAgICAgIH0gLy8gYy5lbmFibGVkID0gYmkuY29sbGlzaW9uUmVzcG9uc2UgJiYgYmouY29sbGlzaW9uUmVzcG9uc2UgJiYgc2kuY29sbGlzaW9uUmVzcG9uc2UgJiYgc2ouY29sbGlzaW9uUmVzcG9uc2U7CgoKICAgICAgICBjbS5mcmljdGlvbjsgLy8gYy5yZXN0aXR1dGlvbiA9IGNtLnJlc3RpdHV0aW9uOwogICAgICAgIC8vIElmIGZyaWN0aW9uIG9yIHJlc3RpdHV0aW9uIHdlcmUgc3BlY2lmaWVkIGluIHRoZSBtYXRlcmlhbCwgdXNlIHRoZW0KCiAgICAgICAgaWYgKGJpLm1hdGVyaWFsICYmIGJqLm1hdGVyaWFsKSB7CiAgICAgICAgICBpZiAoYmkubWF0ZXJpYWwuZnJpY3Rpb24gPj0gMCAmJiBiai5tYXRlcmlhbC5mcmljdGlvbiA+PSAwKSB7CiAgICAgICAgICAgIGJpLm1hdGVyaWFsLmZyaWN0aW9uICogYmoubWF0ZXJpYWwuZnJpY3Rpb247CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGJpLm1hdGVyaWFsLnJlc3RpdHV0aW9uID49IDAgJiYgYmoubWF0ZXJpYWwucmVzdGl0dXRpb24gPj0gMCkgewogICAgICAgICAgICBjLnJlc3RpdHV0aW9uID0gYmkubWF0ZXJpYWwucmVzdGl0dXRpb24gKiBiai5tYXRlcmlhbC5yZXN0aXR1dGlvbjsKICAgICAgICAgIH0KICAgICAgICB9IC8vIGMuc2V0U3Bvb2tQYXJhbXMoCiAgICAgICAgLy8gICAgICAgICAgIGNtLmNvbnRhY3RFcXVhdGlvblN0aWZmbmVzcywKICAgICAgICAvLyAgICAgICAgICAgY20uY29udGFjdEVxdWF0aW9uUmVsYXhhdGlvbiwKICAgICAgICAvLyAgICAgICAgICAgZHQKICAgICAgICAvLyAgICAgICApOwoKCiAgICAgICAgc29sdmVyLmFkZEVxdWF0aW9uKGMpOyAvLyAvLyBBZGQgZnJpY3Rpb24gY29uc3RyYWludCBlcXVhdGlvbgogICAgICAgIC8vIGlmKG11ID4gMCl7CiAgICAgICAgLy8gCS8vIENyZWF0ZSAyIHRhbmdlbnQgZXF1YXRpb25zCiAgICAgICAgLy8gCWNvbnN0IG11ZyA9IG11ICogZ25vcm07CiAgICAgICAgLy8gCWNvbnN0IHJlZHVjZWRNYXNzID0gKGJpLmludk1hc3MgKyBiai5pbnZNYXNzKTsKICAgICAgICAvLyAJaWYocmVkdWNlZE1hc3MgPiAwKXsKICAgICAgICAvLyAJCXJlZHVjZWRNYXNzID0gMS9yZWR1Y2VkTWFzczsKICAgICAgICAvLyAJfQogICAgICAgIC8vIAljb25zdCBwb29sID0gZnJpY3Rpb25FcXVhdGlvblBvb2w7CiAgICAgICAgLy8gCWNvbnN0IGMxID0gcG9vbC5sZW5ndGggPyBwb29sLnBvcCgpIDogbmV3IEZyaWN0aW9uRXF1YXRpb24oYmksYmosbXVnKnJlZHVjZWRNYXNzKTsKICAgICAgICAvLyAJY29uc3QgYzIgPSBwb29sLmxlbmd0aCA/IHBvb2wucG9wKCkgOiBuZXcgRnJpY3Rpb25FcXVhdGlvbihiaSxiaixtdWcqcmVkdWNlZE1hc3MpOwogICAgICAgIC8vIAl0aGlzLmZyaWN0aW9uRXF1YXRpb25zLnB1c2goYzEsIGMyKTsKICAgICAgICAvLyAJYzEuYmkgPSBjMi5iaSA9IGJpOwogICAgICAgIC8vIAljMS5iaiA9IGMyLmJqID0gYmo7CiAgICAgICAgLy8gCWMxLm1pbkZvcmNlID0gYzIubWluRm9yY2UgPSAtbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAljMS5tYXhGb3JjZSA9IGMyLm1heEZvcmNlID0gbXVnKnJlZHVjZWRNYXNzOwogICAgICAgIC8vIAkvLyBDb3B5IG92ZXIgdGhlIHJlbGF0aXZlIHZlY3RvcnMKICAgICAgICAvLyAJYzEucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzEucmouY29weShjLnJqKTsKICAgICAgICAvLyAJYzIucmkuY29weShjLnJpKTsKICAgICAgICAvLyAJYzIucmouY29weShjLnJqKTsKICAgICAgICAvLyAJLy8gQ29uc3RydWN0IHRhbmdlbnRzCiAgICAgICAgLy8gCWMubmkudGFuZ2VudHMoYzEudCwgYzIudCk7CiAgICAgICAgLy8gICAgICAgICAgIC8vIFNldCBzcG9vayBwYXJhbXMKICAgICAgICAvLyAgICAgICAgICAgYzEuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzIuc2V0U3Bvb2tQYXJhbXMoY20uZnJpY3Rpb25FcXVhdGlvblN0aWZmbmVzcywgY20uZnJpY3Rpb25FcXVhdGlvblJlbGF4YXRpb24sIGR0KTsKICAgICAgICAvLyAgICAgICAgICAgYzEuZW5hYmxlZCA9IGMyLmVuYWJsZWQgPSBjLmVuYWJsZWQ7CiAgICAgICAgLy8gCS8vIEFkZCBlcXVhdGlvbnMgdG8gc29sdmVyCiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMSk7CiAgICAgICAgLy8gCXNvbHZlci5hZGRFcXVhdGlvbihjMik7CiAgICAgICAgLy8gfQoKICAgICAgICBpZiAoYmkuYWxsb3dTbGVlcCAmJiBiaS50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmkuc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiai5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJqLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRCID0gYmoudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmouYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQiA9IGJqLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRCID49IHNwZWVkTGltaXRTcXVhcmVkQiAqIDIpIHsKICAgICAgICAgICAgYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoYmouYWxsb3dTbGVlcCAmJiBiai50eXBlID09PSBCb2R5LkRZTkFNSUMgJiYgYmouc2xlZXBTdGF0ZSA9PT0gQm9keS5TTEVFUElORyAmJiBiaS5zbGVlcFN0YXRlID09PSBCb2R5LkFXQUtFICYmIGJpLnR5cGUgIT09IEJvZHkuU1RBVElDKSB7CiAgICAgICAgICBjb25zdCBzcGVlZFNxdWFyZWRBID0gYmkudmVsb2NpdHkubGVuZ3RoU3F1YXJlZCgpICsgYmkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxdWFyZWQoKTsKICAgICAgICAgIGNvbnN0IHNwZWVkTGltaXRTcXVhcmVkQSA9IGJpLnNsZWVwU3BlZWRMaW1pdCAqKiAyOwoKICAgICAgICAgIGlmIChzcGVlZFNxdWFyZWRBID49IHNwZWVkTGltaXRTcXVhcmVkQSAqIDIpIHsKICAgICAgICAgICAgYmoud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBOb3cgd2Uga25vdyB0aGF0IGkgYW5kIGogYXJlIGluIGNvbnRhY3QuIFNldCBjb2xsaXNpb24gbWF0cml4IHN0YXRlCgoKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hdHJpeC5zZXQoYmksIGJqLCB0cnVlKTsKCiAgICAgICAgaWYgKCF0aGlzLmNvbGxpc2lvbk1hdHJpeFByZXZpb3VzLmdldChiaSwgYmopKSB7CiAgICAgICAgICAvLyBGaXJzdCBjb250YWN0IQogICAgICAgICAgLy8gV2UgcmV1c2UgdGhlIGNvbGxpZGVFdmVudCBvYmplY3QsIG90aGVyd2lzZSB3ZSB3aWxsIGVuZCB1cCBjcmVhdGluZyBuZXcgb2JqZWN0cyBmb3IgZWFjaCBuZXcgY29udGFjdCwgZXZlbiBpZiB0aGVyZSdzIG5vIGV2ZW50IGxpc3RlbmVyIGF0dGFjaGVkLgogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuYm9keSA9IGJqOwogICAgICAgICAgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQuY29udGFjdCA9IGM7CiAgICAgICAgICBiaS5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50KTsKICAgICAgICAgIFdvcmxkX3N0ZXBfY29sbGlkZUV2ZW50LmJvZHkgPSBiaTsKICAgICAgICAgIGJqLmRpc3BhdGNoRXZlbnQoV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5zZXQoYmkuaWQsIGJqLmlkKTsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5zZXQoc2kuaWQsIHNqLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5lbWl0Q29udGFjdEV2ZW50cygpOwoKICAgICAgaWYgKGRvUHJvZmlsaW5nKSB7CiAgICAgICAgcHJvZmlsZS5tYWtlQ29udGFjdENvbnN0cmFpbnRzID0gcGVyZm9ybWFuY2UkMS5ub3coKSAtIHByb2ZpbGluZ1N0YXJ0OwogICAgICAgIHByb2ZpbGluZ1N0YXJ0ID0gcGVyZm9ybWFuY2UkMS5ub3coKTsKICAgICAgfSAvLyBXYWtlIHVwIGJvZGllcwoKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkud2FrZVVwQWZ0ZXJOYXJyb3dwaGFzZSkgewogICAgICAgICAgYmkud2FrZVVwKCk7CiAgICAgICAgICBiaS53YWtlVXBBZnRlck5hcnJvd3BoYXNlID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IC8vIEFkZCB1c2VyLWFkZGVkIGNvbnN0cmFpbnRzCgoKICAgICAgTmNvbnN0cmFpbnRzID0gY29uc3RyYWludHMubGVuZ3RoOwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTmNvbnN0cmFpbnRzOyBpKyspIHsKICAgICAgICBjb25zdCBjID0gY29uc3RyYWludHNbaV07CiAgICAgICAgYy51cGRhdGUoKTsKCiAgICAgICAgZm9yIChsZXQgaiA9IDAsIE5lcSA9IGMuZXF1YXRpb25zLmxlbmd0aDsgaiAhPT0gTmVxOyBqKyspIHsKICAgICAgICAgIGNvbnN0IGVxID0gYy5lcXVhdGlvbnNbal07CiAgICAgICAgICBzb2x2ZXIuYWRkRXF1YXRpb24oZXEpOwogICAgICAgIH0KICAgICAgfSAvLyBTb2x2ZSB0aGUgY29uc3RyYWluZWQgc3lzdGVtCgoKICAgICAgc29sdmVyLnNvbHZlKGR0LCB0aGlzKTsKCiAgICAgIGlmIChkb1Byb2ZpbGluZykgewogICAgICAgIHByb2ZpbGUuc29sdmUgPSBwZXJmb3JtYW5jZSQxLm5vdygpIC0gcHJvZmlsaW5nU3RhcnQ7CiAgICAgIH0gLy8gUmVtb3ZlIGFsbCBjb250YWN0cyBmcm9tIHNvbHZlcgoKCiAgICAgIHNvbHZlci5yZW1vdmVBbGxFcXVhdGlvbnMoKTsgLy8gQXBwbHkgZGFtcGluZywgc2VlIGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9idWxsZXQvaXNzdWVzL2RldGFpbD9pZD03NCBmb3IgZGV0YWlscwoKICAgICAgY29uc3QgcG93ID0gTWF0aC5wb3c7CgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKCiAgICAgICAgaWYgKGJpLnR5cGUgJiBEWU5BTUlDKSB7CiAgICAgICAgICAvLyBPbmx5IGZvciBkeW5hbWljIGJvZGllcwogICAgICAgICAgY29uc3QgbGQgPSBwb3coMS4wIC0gYmkubGluZWFyRGFtcGluZywgZHQpOwogICAgICAgICAgY29uc3QgdiA9IGJpLnZlbG9jaXR5OwogICAgICAgICAgdi5zY2FsZShsZCwgdik7CiAgICAgICAgICBjb25zdCBhdiA9IGJpLmFuZ3VsYXJWZWxvY2l0eTsKCiAgICAgICAgICBpZiAoYXYpIHsKICAgICAgICAgICAgY29uc3QgYWQgPSBwb3coMS4wIC0gYmkuYW5ndWxhckRhbXBpbmcsIGR0KTsKICAgICAgICAgICAgYXYuc2NhbGUoYWQsIGF2KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCk7IC8vIEludm9rZSBwcmUtc3RlcCBjYWxsYmFja3MKCiAgICAgIGZvciAoaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGJpID0gYm9kaWVzW2ldOwoKICAgICAgICBpZiAoYmkucHJlU3RlcCkgewogICAgICAgICAgYmkucHJlU3RlcC5jYWxsKGJpKTsKICAgICAgICB9CiAgICAgIH0gLy8gTGVhcCBmcm9nCiAgICAgIC8vIHZuZXcgPSB2ICsgaCpmL20KICAgICAgLy8geG5ldyA9IHggKyBoKnZuZXcKCgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxpbmdTdGFydCA9IHBlcmZvcm1hbmNlJDEubm93KCk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHN0ZXBudW1iZXIgPSB0aGlzLnN0ZXBudW1iZXI7CiAgICAgIGNvbnN0IHF1YXROb3JtYWxpemUgPSBzdGVwbnVtYmVyICUgKHRoaXMucXVhdE5vcm1hbGl6ZVNraXAgKyAxKSA9PT0gMDsKICAgICAgY29uc3QgcXVhdE5vcm1hbGl6ZUZhc3QgPSB0aGlzLnF1YXROb3JtYWxpemVGYXN0OwoKICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgYm9kaWVzW2ldLmludGVncmF0ZShkdCwgcXVhdE5vcm1hbGl6ZSwgcXVhdE5vcm1hbGl6ZUZhc3QpOwogICAgICB9CgogICAgICB0aGlzLmNsZWFyRm9yY2VzKCk7CiAgICAgIHRoaXMuYnJvYWRwaGFzZS5kaXJ0eSA9IHRydWU7CgogICAgICBpZiAoZG9Qcm9maWxpbmcpIHsKICAgICAgICBwcm9maWxlLmludGVncmF0ZSA9IHBlcmZvcm1hbmNlJDEubm93KCkgLSBwcm9maWxpbmdTdGFydDsKICAgICAgfSAvLyBVcGRhdGUgc3RlcCBudW1iZXIKCgogICAgICB0aGlzLnN0ZXBudW1iZXIgKz0gMTsKICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFdvcmxkX3N0ZXBfcG9zdFN0ZXBFdmVudCk7IC8vIEludm9rZSBwb3N0LXN0ZXAgY2FsbGJhY2tzCgogICAgICBmb3IgKGkgPSAwOyBpICE9PSBOOyBpKyspIHsKICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICBjb25zdCBwb3N0U3RlcCA9IGJpLnBvc3RTdGVwOwoKICAgICAgICBpZiAocG9zdFN0ZXApIHsKICAgICAgICAgIHBvc3RTdGVwLmNhbGwoYmkpOwogICAgICAgIH0KICAgICAgfSAvLyBTbGVlcGluZyB1cGRhdGUKCgogICAgICBsZXQgaGFzQWN0aXZlQm9kaWVzID0gdHJ1ZTsKCiAgICAgIGlmICh0aGlzLmFsbG93U2xlZXApIHsKICAgICAgICBoYXNBY3RpdmVCb2RpZXMgPSBmYWxzZTsKCiAgICAgICAgZm9yIChpID0gMDsgaSAhPT0gTjsgaSsrKSB7CiAgICAgICAgICBjb25zdCBiaSA9IGJvZGllc1tpXTsKICAgICAgICAgIGJpLnNsZWVwVGljayh0aGlzLnRpbWUpOwoKICAgICAgICAgIGlmIChiaS5zbGVlcFN0YXRlICE9PSBCb2R5LlNMRUVQSU5HKSB7CiAgICAgICAgICAgIGhhc0FjdGl2ZUJvZGllcyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLmhhc0FjdGl2ZUJvZGllcyA9IGhhc0FjdGl2ZUJvZGllczsKICAgIH0KCiAgICBlbWl0Q29udGFjdEV2ZW50cygpIHsKICAgICAgY29uc3QgaGFzQmVnaW5Db250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdiZWdpbkNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignZW5kQ29udGFjdCcpOwoKICAgICAgaWYgKGhhc0JlZ2luQ29udGFjdCB8fCBoYXNFbmRDb250YWN0KSB7CiAgICAgICAgdGhpcy5ib2R5T3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5Db250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBhZGRpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAyKSB7CiAgICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IHRoaXMuZ2V0Qm9keUJ5SWQoYWRkaXRpb25zW2ldKTsKICAgICAgICAgIGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gdGhpcy5nZXRCb2R5QnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChiZWdpbkNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpbkNvbnRhY3RFdmVudC5ib2R5QSA9IGJlZ2luQ29udGFjdEV2ZW50LmJvZHlCID0gbnVsbDsKICAgICAgfQoKICAgICAgaWYgKGhhc0VuZENvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHJlbW92YWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMikgewogICAgICAgICAgZW5kQ29udGFjdEV2ZW50LmJvZHlBID0gdGhpcy5nZXRCb2R5QnlJZChyZW1vdmFsc1tpXSk7CiAgICAgICAgICBlbmRDb250YWN0RXZlbnQuYm9keUIgPSB0aGlzLmdldEJvZHlCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoZW5kQ29udGFjdEV2ZW50KTsKICAgICAgICB9CgogICAgICAgIGVuZENvbnRhY3RFdmVudC5ib2R5QSA9IGVuZENvbnRhY3RFdmVudC5ib2R5QiA9IG51bGw7CiAgICAgIH0KCiAgICAgIGFkZGl0aW9ucy5sZW5ndGggPSByZW1vdmFscy5sZW5ndGggPSAwOwogICAgICBjb25zdCBoYXNCZWdpblNoYXBlQ29udGFjdCA9IHRoaXMuaGFzQW55RXZlbnRMaXN0ZW5lcignYmVnaW5TaGFwZUNvbnRhY3QnKTsKICAgICAgY29uc3QgaGFzRW5kU2hhcGVDb250YWN0ID0gdGhpcy5oYXNBbnlFdmVudExpc3RlbmVyKCdlbmRTaGFwZUNvbnRhY3QnKTsKCiAgICAgIGlmIChoYXNCZWdpblNoYXBlQ29udGFjdCB8fCBoYXNFbmRTaGFwZUNvbnRhY3QpIHsKICAgICAgICB0aGlzLnNoYXBlT3ZlcmxhcEtlZXBlci5nZXREaWZmKGFkZGl0aW9ucywgcmVtb3ZhbHMpOwogICAgICB9CgogICAgICBpZiAoaGFzQmVnaW5TaGFwZUNvbnRhY3QpIHsKICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFkZGl0aW9ucy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKGFkZGl0aW9uc1tpXSk7CiAgICAgICAgICBjb25zdCBzaGFwZUIgPSB0aGlzLmdldFNoYXBlQnlJZChhZGRpdGlvbnNbaSArIDFdKTsKICAgICAgICAgIGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gc2hhcGVBOwogICAgICAgICAgYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gc2hhcGVBLmJvZHk7CiAgICAgICAgICBpZiAoc2hhcGVCKSBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gc2hhcGVCLmJvZHk7CiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoYmVnaW5TaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBiZWdpblNoYXBlQ29udGFjdEV2ZW50LmJvZHlBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5ib2R5QiA9IGJlZ2luU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gYmVnaW5TaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBudWxsOwogICAgICB9CgogICAgICBpZiAoaGFzRW5kU2hhcGVDb250YWN0KSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSByZW1vdmFscy5sZW5ndGg7IGkgPCBsOyBpICs9IDIpIHsKICAgICAgICAgIGNvbnN0IHNoYXBlQSA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2ldKTsKICAgICAgICAgIGNvbnN0IHNoYXBlQiA9IHRoaXMuZ2V0U2hhcGVCeUlkKHJlbW92YWxzW2kgKyAxXSk7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUEgPSBzaGFwZUE7CiAgICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5zaGFwZUIgPSBzaGFwZUI7CiAgICAgICAgICBpZiAoc2hhcGVBKSBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IHNoYXBlQS5ib2R5OwogICAgICAgICAgaWYgKHNoYXBlQikgZW5kU2hhcGVDb250YWN0RXZlbnQuYm9keUIgPSBzaGFwZUIuYm9keTsKICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChlbmRTaGFwZUNvbnRhY3RFdmVudCk7CiAgICAgICAgfQoKICAgICAgICBlbmRTaGFwZUNvbnRhY3RFdmVudC5ib2R5QSA9IGVuZFNoYXBlQ29udGFjdEV2ZW50LmJvZHlCID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVBID0gZW5kU2hhcGVDb250YWN0RXZlbnQuc2hhcGVCID0gbnVsbDsKICAgICAgfQogICAgfQogICAgLyoqCiAgICAgKiBTZXRzIGFsbCBib2R5IGZvcmNlcyBpbiB0aGUgd29ybGQgdG8gemVyby4KICAgICAqLwoKCiAgICBjbGVhckZvcmNlcygpIHsKICAgICAgY29uc3QgYm9kaWVzID0gdGhpcy5ib2RpZXM7CiAgICAgIGNvbnN0IE4gPSBib2RpZXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgIT09IE47IGkrKykgewogICAgICAgIGNvbnN0IGIgPSBib2RpZXNbaV07CiAgICAgICAgYi5mb3JjZTsKICAgICAgICBiLnRvcnF1ZTsKICAgICAgICBiLmZvcmNlLnNldCgwLCAwLCAwKTsKICAgICAgICBiLnRvcnF1ZS5zZXQoMCwgMCwgMCk7CiAgICAgIH0KICAgIH0KCiAgfSAvLyBUZW1wIHN0dWZmCgoKICBuZXcgQUFCQigpOwogIGNvbnN0IHRtcFJheSA9IG5ldyBSYXkoKTsgLy8gcGVyZm9ybWFuY2Uubm93KCkgZmFsbGJhY2sgb24gRGF0ZS5ub3coKQoKICBjb25zdCBwZXJmb3JtYW5jZSQxID0gZ2xvYmFsVGhpcy5wZXJmb3JtYW5jZSB8fCB7fTsKCiAgaWYgKCFwZXJmb3JtYW5jZSQxLm5vdykgewogICAgbGV0IG5vd09mZnNldCA9IERhdGUubm93KCk7CgogICAgaWYgKHBlcmZvcm1hbmNlJDEudGltaW5nICYmIHBlcmZvcm1hbmNlJDEudGltaW5nLm5hdmlnYXRpb25TdGFydCkgewogICAgICBub3dPZmZzZXQgPSBwZXJmb3JtYW5jZSQxLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQ7CiAgICB9CgogICAgcGVyZm9ybWFuY2UkMS5ub3cgPSAoKSA9PiBEYXRlLm5vdygpIC0gbm93T2Zmc2V0OwogIH0gLy8gUmV1c2FibGUgZXZlbnQgb2JqZWN0cyB0byBzYXZlIG1lbW9yeS4KCgogIGNvbnN0IFdvcmxkX3N0ZXBfcG9zdFN0ZXBFdmVudCA9IHsKICAgIHR5cGU6ICdwb3N0U3RlcCcKICB9OyAvLyBEaXNwYXRjaGVkIGJlZm9yZSB0aGUgd29ybGQgc3RlcHMgZm9yd2FyZCBpbiB0aW1lLgoKICBjb25zdCBXb3JsZF9zdGVwX3ByZVN0ZXBFdmVudCA9IHsKICAgIHR5cGU6ICdwcmVTdGVwJwogIH07CiAgY29uc3QgV29ybGRfc3RlcF9jb2xsaWRlRXZlbnQgPSB7CiAgICB0eXBlOiBCb2R5LkNPTExJREVfRVZFTlRfTkFNRSwKICAgIGJvZHk6IG51bGwsCiAgICBjb250YWN0OiBudWxsCiAgfTsgLy8gUG9vbHMgZm9yIHVudXNlZCBvYmplY3RzCgogIGNvbnN0IFdvcmxkX3N0ZXBfb2xkQ29udGFjdHMgPSBbXTsKICBjb25zdCBXb3JsZF9zdGVwX2ZyaWN0aW9uRXF1YXRpb25Qb29sID0gW107IC8vIFJldXNhYmxlIGFycmF5cyBmb3IgY29sbGlzaW9uIHBhaXJzCgogIGNvbnN0IFdvcmxkX3N0ZXBfcDEgPSBbXTsKICBjb25zdCBXb3JsZF9zdGVwX3AyID0gW107IC8vIFN0dWZmIGZvciBlbWl0Q29udGFjdEV2ZW50cwoKICBjb25zdCBhZGRpdGlvbnMgPSBbXTsKICBjb25zdCByZW1vdmFscyA9IFtdOwogIGNvbnN0IGJlZ2luQ29udGFjdEV2ZW50ID0gewogICAgdHlwZTogJ2JlZ2luQ29udGFjdCcsCiAgICBib2R5QTogbnVsbCwKICAgIGJvZHlCOiBudWxsCiAgfTsKICBjb25zdCBlbmRDb250YWN0RXZlbnQgPSB7CiAgICB0eXBlOiAnZW5kQ29udGFjdCcsCiAgICBib2R5QTogbnVsbCwKICAgIGJvZHlCOiBudWxsCiAgfTsKICBjb25zdCBiZWdpblNoYXBlQ29udGFjdEV2ZW50ID0gewogICAgdHlwZTogJ2JlZ2luU2hhcGVDb250YWN0JywKICAgIGJvZHlBOiBudWxsLAogICAgYm9keUI6IG51bGwsCiAgICBzaGFwZUE6IG51bGwsCiAgICBzaGFwZUI6IG51bGwKICB9OwogIGNvbnN0IGVuZFNoYXBlQ29udGFjdEV2ZW50ID0gewogICAgdHlwZTogJ2VuZFNoYXBlQ29udGFjdCcsCiAgICBib2R5QTogbnVsbCwKICAgIGJvZHlCOiBudWxsLAogICAgc2hhcGVBOiBudWxsLAogICAgc2hhcGVCOiBudWxsCiAgfTsKCiAgY29uc3QgbWFrZVZlYzMgPSAoW3gsIHksIHpdKSA9PiBuZXcgVmVjMyh4LCB5LCB6KTsKCiAgY29uc3QgcHJlcGFyZVNwaGVyZSA9IGFyZ3MgPT4gQXJyYXkuaXNBcnJheShhcmdzKSA/IGFyZ3MgOiBbYXJnc107CgogIGNvbnN0IHByZXBhcmVDb252ZXhQb2x5aGVkcm9uID0gKFt2LCBmYWNlcywgbiwgYSwgYm91bmRpbmdTcGhlcmVSYWRpdXNdKSA9PiBbewogICAgdmVydGljZXM6IHYgPyB2Lm1hcChtYWtlVmVjMykgOiB1bmRlZmluZWQsCiAgICBmYWNlcywKICAgIG5vcm1hbHM6IG4gPyBuLm1hcChtYWtlVmVjMykgOiB1bmRlZmluZWQsCiAgICBheGVzOiBhID8gYS5tYXAobWFrZVZlYzMpIDogdW5kZWZpbmVkLAogICAgYm91bmRpbmdTcGhlcmVSYWRpdXMKICB9XTsKCiAgZnVuY3Rpb24gY3JlYXRlU2hhcGUodHlwZSwgYXJncykgewogICAgc3dpdGNoICh0eXBlKSB7CiAgICAgIGNhc2UgJ0JveCc6CiAgICAgICAgcmV0dXJuIG5ldyBCb3gobmV3IFZlYzMoLi4uYXJncy5tYXAodiA9PiB2IC8gMikpKTsKICAgICAgLy8gZXh0ZW50cyA9PiBoYWxmRXh0ZW50cwoKICAgICAgY2FzZSAnQ29udmV4UG9seWhlZHJvbic6CiAgICAgICAgcmV0dXJuIG5ldyBDb252ZXhQb2x5aGVkcm9uKC4uLnByZXBhcmVDb252ZXhQb2x5aGVkcm9uKGFyZ3MpKTsKCiAgICAgIGNhc2UgJ0N5bGluZGVyJzoKICAgICAgICByZXR1cm4gbmV3IEN5bGluZGVyKC4uLmFyZ3MpOwogICAgICAvLyBbIHJhZGl1c1RvcCwgcmFkaXVzQm90dG9tLCBoZWlnaHQsIG51bVNlZ21lbnRzIF0gPSBhcmdzCgogICAgICBjYXNlICdIZWlnaHRmaWVsZCc6CiAgICAgICAgcmV0dXJuIG5ldyBIZWlnaHRmaWVsZCguLi5hcmdzKTsKICAgICAgLy8gWyBBcnJheSBkYXRhLCBvcHRpb25zOiB7bWluVmFsdWUsIG1heFZhbHVlLCBlbGVtZW50U2l6ZX0gIF0gPSBhcmdzCgogICAgICBjYXNlICdQYXJ0aWNsZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQYXJ0aWNsZSgpOwogICAgICAvLyBubyBhcmdzCgogICAgICBjYXNlICdQbGFuZSc6CiAgICAgICAgcmV0dXJuIG5ldyBQbGFuZSgpOwogICAgICAvLyBubyBhcmdzLCBpbmZpbml0ZSB4IGFuZCB5CgogICAgICBjYXNlICdTcGhlcmUnOgogICAgICAgIHJldHVybiBuZXcgU3BoZXJlKC4uLnByZXBhcmVTcGhlcmUoYXJncykpOwogICAgICAvLyByYWRpdXMgPSBhcmdzCgogICAgICBjYXNlICdUcmltZXNoJzoKICAgICAgICByZXR1cm4gbmV3IFRyaW1lc2goLi4uYXJncyk7CiAgICAgIC8vIFt2ZXJ0aWNlcywgaW5kaWNlc10gPSBhcmdzCiAgICB9CiAgfQogIC8qKgogICAqCiAgICogQHBhcmFtIHV1aWQge3N0cmluZ30KICAgKiBAcGFyYW0gcHJvcHMge0JvZHlQcm9wc30KICAgKiBAcGFyYW0gdHlwZSB7Qm9keVNoYXBlVHlwZX0KICAgKiBAcmV0dXJuIHttb2R1bGU6b2JqZWN0cy9Cb2R5LkJvZHl9CiAgICovCgoKICBjb25zdCBwcm9wc1RvQm9keSA9ICh1dWlkLCBwcm9wcywgdHlwZSkgPT4gewogICAgY29uc3QgewogICAgICBhcmdzID0gW10sCiAgICAgIHBvc2l0aW9uID0gWzAsIDAsIDBdLAogICAgICByb3RhdGlvbiA9IFswLCAwLCAwXSwKICAgICAgdmVsb2NpdHkgPSBbMCwgMCwgMF0sCiAgICAgIGFuZ3VsYXJWZWxvY2l0eSA9IFswLCAwLCAwXSwKICAgICAgbGluZWFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICBhbmd1bGFyRmFjdG9yID0gWzEsIDEsIDFdLAogICAgICB0eXBlOiBib2R5VHlwZSwKICAgICAgbWFzcywKICAgICAgbWF0ZXJpYWwsCiAgICAgIHNoYXBlcywKICAgICAgb25Db2xsaWRlLAogICAgICBjb2xsaXNpb25SZXNwb25zZSwKICAgICAgLi4uZXh0cmEKICAgIH0gPSBwcm9wczsKICAgIGNvbnN0IGJvZHkgPSBuZXcgQm9keSh7IC4uLmV4dHJhLAogICAgICBtYXNzOiBib2R5VHlwZSA9PT0gJ1N0YXRpYycgPyAwIDogbWFzcywKICAgICAgdHlwZTogYm9keVR5cGUgPyBCb2R5W2JvZHlUeXBlLnRvVXBwZXJDYXNlKCldIDogdW5kZWZpbmVkLAogICAgICBtYXRlcmlhbDogbWF0ZXJpYWwgPyBuZXcgTWF0ZXJpYWwobWF0ZXJpYWwpIDogdW5kZWZpbmVkCiAgICB9KTsKICAgIGJvZHkudXVpZCA9IHV1aWQ7CgogICAgaWYgKGNvbGxpc2lvblJlc3BvbnNlICE9PSB1bmRlZmluZWQpIHsKICAgICAgYm9keS5jb2xsaXNpb25SZXNwb25zZSA9IGNvbGxpc2lvblJlc3BvbnNlOwogICAgfQoKICAgIGlmICh0eXBlID09PSAnQ29tcG91bmQnKSB7CiAgICAgIHNoYXBlcy5mb3JFYWNoKCh7CiAgICAgICAgdHlwZSwKICAgICAgICBhcmdzLAogICAgICAgIHBvc2l0aW9uLAogICAgICAgIHJvdGF0aW9uLAogICAgICAgIG1hdGVyaWFsLAogICAgICAgIC4uLmV4dHJhCiAgICAgIH0pID0+IHsKICAgICAgICBjb25zdCBzaGFwZUJvZHkgPSBib2R5LmFkZFNoYXBlKGNyZWF0ZVNoYXBlKHR5cGUsIGFyZ3MpLCBwb3NpdGlvbiA/IG5ldyBWZWMzKC4uLnBvc2l0aW9uKSA6IHVuZGVmaW5lZCwgcm90YXRpb24gPyBuZXcgUXVhdGVybmlvbigpLnNldEZyb21FdWxlciguLi5yb3RhdGlvbikgOiB1bmRlZmluZWQpOwogICAgICAgIGlmIChtYXRlcmlhbCkgc2hhcGVCb2R5Lm1hdGVyaWFsID0gbmV3IE1hdGVyaWFsKG1hdGVyaWFsKTsKICAgICAgICBPYmplY3QuYXNzaWduKHNoYXBlQm9keSwgZXh0cmEpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGJvZHkuYWRkU2hhcGUoY3JlYXRlU2hhcGUodHlwZSwgYXJncykpOwogICAgfQoKICAgIGJvZHkucG9zaXRpb24uc2V0KHBvc2l0aW9uWzBdLCBwb3NpdGlvblsxXSwgcG9zaXRpb25bMl0pOwogICAgYm9keS5xdWF0ZXJuaW9uLnNldEZyb21FdWxlcihyb3RhdGlvblswXSwgcm90YXRpb25bMV0sIHJvdGF0aW9uWzJdKTsKICAgIGJvZHkudmVsb2NpdHkuc2V0KHZlbG9jaXR5WzBdLCB2ZWxvY2l0eVsxXSwgdmVsb2NpdHlbMl0pOwogICAgYm9keS5hbmd1bGFyVmVsb2NpdHkuc2V0KGFuZ3VsYXJWZWxvY2l0eVswXSwgYW5ndWxhclZlbG9jaXR5WzFdLCBhbmd1bGFyVmVsb2NpdHlbMl0pOwogICAgYm9keS5saW5lYXJGYWN0b3Iuc2V0KGxpbmVhckZhY3RvclswXSwgbGluZWFyRmFjdG9yWzFdLCBsaW5lYXJGYWN0b3JbMl0pOwogICAgYm9keS5hbmd1bGFyRmFjdG9yLnNldChhbmd1bGFyRmFjdG9yWzBdLCBhbmd1bGFyRmFjdG9yWzFdLCBhbmd1bGFyRmFjdG9yWzJdKTsKICAgIHJldHVybiBib2R5OwogIH07CgogIGNvbnN0IHN0YXRlID0gewogICAgYm9kaWVzOiB7fSwKICAgIHZlaGljbGVzOiB7fSwKICAgIHNwcmluZ3M6IHt9LAogICAgc3ByaW5nSW5zdGFuY2VzOiB7fSwKICAgIHJheXM6IHt9LAogICAgd29ybGQ6IG5ldyBXb3JsZCgpLAogICAgY29uZmlnOiB7CiAgICAgIHN0ZXA6IDEgLyA2MAogICAgfSwKICAgIHN1YnNjcmlwdGlvbnM6IHt9LAogICAgdGVtcFZlY3RvcjogbmV3IFZlYzMoKSwKICAgIGJvZGllc05lZWRTeW5jaW5nOiBmYWxzZSwKICAgIGxhc3RDYWxsVGltZTogdW5kZWZpbmVkCiAgfTsKCiAgZnVuY3Rpb24gc3luY0JvZGllcygpIHsKICAgIHN0YXRlLmJvZGllc05lZWRTeW5jaW5nID0gdHJ1ZTsKICAgIHN0YXRlLmJvZGllcyA9IHN0YXRlLndvcmxkLmJvZGllcy5yZWR1Y2UoKGFjYywgYm9keSkgPT4gKHsgLi4uYWNjLAogICAgICBbYm9keS51dWlkXTogYm9keQogICAgfSksIHt9KTsKICB9CgogIGZ1bmN0aW9uIGVtaXRCZWdpbkNvbnRhY3QoewogICAgYm9keUEsCiAgICBib2R5QgogIH0pIHsKICAgIGlmICghYm9keUEgfHwgIWJvZHlCKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgb3A6ICdldmVudCcsCiAgICAgIHR5cGU6ICdjb2xsaWRlQmVnaW4nLAogICAgICBib2R5QTogYm9keUEudXVpZCwKICAgICAgYm9keUI6IGJvZHlCLnV1aWQKICAgIH0pOwogIH0KCiAgZnVuY3Rpb24gZW1pdEVuZENvbnRhY3QoewogICAgYm9keUEsCiAgICBib2R5QgogIH0pIHsKICAgIGlmICghYm9keUEgfHwgIWJvZHlCKSByZXR1cm47CiAgICBzZWxmLnBvc3RNZXNzYWdlKHsKICAgICAgb3A6ICdldmVudCcsCiAgICAgIHR5cGU6ICdjb2xsaWRlRW5kJywKICAgICAgYm9keUE6IGJvZHlBLnV1aWQsCiAgICAgIGJvZHlCOiBib2R5Qi51dWlkCiAgICB9KTsKICB9CgogIHNlbGYub25tZXNzYWdlID0gZSA9PiB7CiAgICBjb25zdCB7CiAgICAgIG9wLAogICAgICB1dWlkLAogICAgICB0eXBlLAogICAgICBwb3NpdGlvbnMsCiAgICAgIHF1YXRlcm5pb25zLAogICAgICBwcm9wcwogICAgfSA9IGUuZGF0YTsKICAgIGNvbnN0IGJyb2FkcGhhc2VzID0gewogICAgICBOYWl2ZUJyb2FkcGhhc2UsCiAgICAgIFNBUEJyb2FkcGhhc2UKICAgIH07CgogICAgc3dpdGNoIChvcCkgewogICAgICBjYXNlICdpbml0JzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIGdyYXZpdHksCiAgICAgICAgICAgIHRvbGVyYW5jZSwKICAgICAgICAgICAgc3RlcCwKICAgICAgICAgICAgaXRlcmF0aW9ucywKICAgICAgICAgICAgYWxsb3dTbGVlcCwKICAgICAgICAgICAgYnJvYWRwaGFzZSwKICAgICAgICAgICAgYXhpc0luZGV4LAogICAgICAgICAgICBkZWZhdWx0Q29udGFjdE1hdGVyaWFsCiAgICAgICAgICB9ID0gcHJvcHM7CiAgICAgICAgICBzdGF0ZS53b3JsZC5hbGxvd1NsZWVwID0gYWxsb3dTbGVlcDsKICAgICAgICAgIHN0YXRlLndvcmxkLmdyYXZpdHkuc2V0KGdyYXZpdHlbMF0sIGdyYXZpdHlbMV0sIGdyYXZpdHlbMl0pOwogICAgICAgICAgc3RhdGUud29ybGQuc29sdmVyLnRvbGVyYW5jZSA9IHRvbGVyYW5jZTsKICAgICAgICAgIHN0YXRlLndvcmxkLnNvbHZlci5pdGVyYXRpb25zID0gaXRlcmF0aW9uczsKICAgICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UgPSBuZXcgKGJyb2FkcGhhc2VzW2Jyb2FkcGhhc2UgKyAnQnJvYWRwaGFzZSddIHx8IE5haXZlQnJvYWRwaGFzZSkoc3RhdGUud29ybGQpOwogICAgICAgICAgc3RhdGUud29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBheGlzSW5kZXggPT09IHVuZGVmaW5lZCB8fCBheGlzSW5kZXggPT09IG51bGwgPyAwIDogYXhpc0luZGV4OwogICAgICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcignYmVnaW5Db250YWN0JywgZW1pdEJlZ2luQ29udGFjdCk7CiAgICAgICAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdlbmRDb250YWN0JywgZW1pdEVuZENvbnRhY3QpOwogICAgICAgICAgT2JqZWN0LmFzc2lnbihzdGF0ZS53b3JsZC5kZWZhdWx0Q29udGFjdE1hdGVyaWFsLCBkZWZhdWx0Q29udGFjdE1hdGVyaWFsKTsKICAgICAgICAgIHN0YXRlLmNvbmZpZy5zdGVwID0gc3RlcDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3N0ZXAnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IG5vdyA9IHBlcmZvcm1hbmNlLm5vdygpIC8gMTAwMDsKCiAgICAgICAgICBpZiAoIXN0YXRlLmxhc3RDYWxsVGltZSkgewogICAgICAgICAgICBzdGF0ZS53b3JsZC5zdGVwKHN0YXRlLmNvbmZpZy5zdGVwKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnN0IHRpbWVTaW5jZUxhc3RDYWxsID0gbm93IC0gc3RhdGUubGFzdENhbGxUaW1lOwogICAgICAgICAgICBzdGF0ZS53b3JsZC5zdGVwKHN0YXRlLmNvbmZpZy5zdGVwLCB0aW1lU2luY2VMYXN0Q2FsbCk7CiAgICAgICAgICB9CgogICAgICAgICAgc3RhdGUubGFzdENhbGxUaW1lID0gbm93OwogICAgICAgICAgY29uc3QgbnVtYmVyT2ZCb2RpZXMgPSBzdGF0ZS53b3JsZC5ib2RpZXMubGVuZ3RoOwoKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZCb2RpZXM7IGkrKykgewogICAgICAgICAgICBsZXQgYiA9IHN0YXRlLndvcmxkLmJvZGllc1tpXSwKICAgICAgICAgICAgICAgIHAgPSBiLnBvc2l0aW9uLAogICAgICAgICAgICAgICAgcSA9IGIucXVhdGVybmlvbjsKICAgICAgICAgICAgcG9zaXRpb25zWzMgKiBpICsgMF0gPSBwLng7CiAgICAgICAgICAgIHBvc2l0aW9uc1szICogaSArIDFdID0gcC55OwogICAgICAgICAgICBwb3NpdGlvbnNbMyAqIGkgKyAyXSA9IHAuejsKICAgICAgICAgICAgcXVhdGVybmlvbnNbNCAqIGkgKyAwXSA9IHEueDsKICAgICAgICAgICAgcXVhdGVybmlvbnNbNCAqIGkgKyAxXSA9IHEueTsKICAgICAgICAgICAgcXVhdGVybmlvbnNbNCAqIGkgKyAyXSA9IHEuejsKICAgICAgICAgICAgcXVhdGVybmlvbnNbNCAqIGkgKyAzXSA9IHEudzsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBvYnNlcnZhdGlvbnMgPSBbXTsKCiAgICAgICAgICBmb3IgKGNvbnN0IGlkIG9mIE9iamVjdC5rZXlzKHN0YXRlLnN1YnNjcmlwdGlvbnMpKSB7CiAgICAgICAgICAgIGxldCBbdXVpZCwgdHlwZSwgdGFyZ2V0ID0gJ2JvZGllcyddID0gc3RhdGUuc3Vic2NyaXB0aW9uc1tpZF07CiAgICAgICAgICAgIGxldCBvYmplY3QgPSBzdGF0ZVt0YXJnZXRdOwogICAgICAgICAgICBpZiAoIW9iamVjdCB8fCAhb2JqZWN0W3V1aWRdKSBjb250aW51ZTsKICAgICAgICAgICAgbGV0IHZhbHVlID0gb2JqZWN0W3V1aWRdW3R5cGVdOwogICAgICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBWZWMzKSB2YWx1ZSA9IHZhbHVlLnRvQXJyYXkoKTtlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFF1YXRlcm5pb24pIHsKICAgICAgICAgICAgICB2YWx1ZS50b0V1bGVyKHN0YXRlLnRlbXBWZWN0b3IpOwogICAgICAgICAgICAgIHZhbHVlID0gc3RhdGUudGVtcFZlY3Rvci50b0FycmF5KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgb2JzZXJ2YXRpb25zLnB1c2goW2lkLCB2YWx1ZV0pOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7CiAgICAgICAgICAgIG9wOiAnZnJhbWUnLAogICAgICAgICAgICBwb3NpdGlvbnMsCiAgICAgICAgICAgIHF1YXRlcm5pb25zLAogICAgICAgICAgICBvYnNlcnZhdGlvbnMsCiAgICAgICAgICAgIGFjdGl2ZTogc3RhdGUud29ybGQuaGFzQWN0aXZlQm9kaWVzCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChzdGF0ZS5ib2RpZXNOZWVkU3luY2luZykgewogICAgICAgICAgICBtZXNzYWdlLmJvZGllcyA9IHN0YXRlLndvcmxkLmJvZGllcy5tYXAoYm9keSA9PiBib2R5LnV1aWQpOwogICAgICAgICAgICBzdGF0ZS5ib2RpZXNOZWVkU3luY2luZyA9IGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UobWVzc2FnZSwgW3Bvc2l0aW9ucy5idWZmZXIsIHF1YXRlcm5pb25zLmJ1ZmZlcl0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnYWRkQm9kaWVzJzoKICAgICAgICB7CiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHV1aWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgYm9keSA9IHByb3BzVG9Cb2R5KHV1aWRbaV0sIHByb3BzW2ldLCB0eXBlKTsKICAgICAgICAgICAgc3RhdGUud29ybGQuYWRkQm9keShib2R5KTsKICAgICAgICAgICAgaWYgKHByb3BzW2ldLm9uQ29sbGlkZSkgYm9keS5hZGRFdmVudExpc3RlbmVyKCdjb2xsaWRlJywgKHsKICAgICAgICAgICAgICB0eXBlLAogICAgICAgICAgICAgIGJvZHksCiAgICAgICAgICAgICAgdGFyZ2V0LAogICAgICAgICAgICAgIGNvbnRhY3QKICAgICAgICAgICAgfSkgPT4gewogICAgICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgICAgIG5pLAogICAgICAgICAgICAgICAgcmksCiAgICAgICAgICAgICAgICByaiwKICAgICAgICAgICAgICAgIGJpLAogICAgICAgICAgICAgICAgYmosCiAgICAgICAgICAgICAgICBpZAogICAgICAgICAgICAgIH0gPSBjb250YWN0OwogICAgICAgICAgICAgIGNvbnN0IGNvbnRhY3RQb2ludCA9IGJpLnBvc2l0aW9uLnZhZGQocmkpOwogICAgICAgICAgICAgIGNvbnN0IGNvbnRhY3ROb3JtYWwgPSBiaSA9PT0gYm9keSA/IG5pIDogbmkuc2NhbGUoLTEpOwogICAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgb3A6ICdldmVudCcsCiAgICAgICAgICAgICAgICB0eXBlLAogICAgICAgICAgICAgICAgYm9keTogYm9keS51dWlkLAogICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQudXVpZCwKICAgICAgICAgICAgICAgIGNvbnRhY3Q6IHsKICAgICAgICAgICAgICAgICAgbmk6IG5pLnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgcmk6IHJpLnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgcmo6IHJqLnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgYmk6IGJpLnV1aWQsCiAgICAgICAgICAgICAgICAgIGJqOiBiai51dWlkLAogICAgICAgICAgICAgICAgICBpbXBhY3RWZWxvY2l0eTogY29udGFjdC5nZXRJbXBhY3RWZWxvY2l0eUFsb25nTm9ybWFsKCksCiAgICAgICAgICAgICAgICAgIC8vIFdvcmxkIHBvc2l0aW9uIG9mIHRoZSBjb250YWN0CiAgICAgICAgICAgICAgICAgIGNvbnRhY3RQb2ludDogY29udGFjdFBvaW50LnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgLy8gTm9ybWFsIG9mIHRoZSBjb250YWN0LCByZWxhdGl2ZSB0byB0aGUgY29sbGlkaW5nIGJvZHkKICAgICAgICAgICAgICAgICAgY29udGFjdE5vcm1hbDogY29udGFjdE5vcm1hbC50b0FycmF5KCksCiAgICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgY29sbGlzaW9uRmlsdGVyczogewogICAgICAgICAgICAgICAgICBib2R5RmlsdGVyR3JvdXA6IGJvZHkuY29sbGlzaW9uRmlsdGVyR3JvdXAsCiAgICAgICAgICAgICAgICAgIGJvZHlGaWx0ZXJNYXNrOiBib2R5LmNvbGxpc2lvbkZpbHRlck1hc2ssCiAgICAgICAgICAgICAgICAgIHRhcmdldEZpbHRlckdyb3VwOiB0YXJnZXQuY29sbGlzaW9uRmlsdGVyR3JvdXAsCiAgICAgICAgICAgICAgICAgIHRhcmdldEZpbHRlck1hc2s6IHRhcmdldC5jb2xsaXNpb25GaWx0ZXJNYXNrCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHN5bmNCb2RpZXMoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3JlbW92ZUJvZGllcyc6CiAgICAgICAgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1dWlkLmxlbmd0aDsgaSsrKSBzdGF0ZS53b3JsZC5yZW1vdmVCb2R5KHN0YXRlLmJvZGllc1t1dWlkW2ldXSk7CgogICAgICAgICAgc3luY0JvZGllcygpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc3Vic2NyaWJlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIGlkLAogICAgICAgICAgICB0eXBlLAogICAgICAgICAgICB0YXJnZXQKICAgICAgICAgIH0gPSBwcm9wczsKICAgICAgICAgIHN0YXRlLnN1YnNjcmlwdGlvbnNbaWRdID0gW3V1aWQsIHR5cGUsIHRhcmdldF07CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICd1bnN1YnNjcmliZSc6CiAgICAgICAgewogICAgICAgICAgZGVsZXRlIHN0YXRlLnN1YnNjcmlwdGlvbnNbcHJvcHNdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc2V0UG9zaXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5wb3NpdGlvbi5zZXQocHJvcHNbMF0sIHByb3BzWzFdLCBwcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRRdWF0ZXJuaW9uJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0ucXVhdGVybmlvbi5zZXRGcm9tRXVsZXIocHJvcHNbMF0sIHByb3BzWzFdLCBwcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRWZWxvY2l0eSc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLnZlbG9jaXR5LnNldChwcm9wc1swXSwgcHJvcHNbMV0sIHByb3BzWzJdKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldEFuZ3VsYXJWZWxvY2l0eSc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFuZ3VsYXJWZWxvY2l0eS5zZXQocHJvcHNbMF0sIHByb3BzWzFdLCBwcm9wc1syXSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRMaW5lYXJGYWN0b3InOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5saW5lYXJGYWN0b3Iuc2V0KHByb3BzWzBdLCBwcm9wc1sxXSwgcHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0QW5ndWxhckZhY3Rvcic6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFuZ3VsYXJGYWN0b3Iuc2V0KHByb3BzWzBdLCBwcm9wc1sxXSwgcHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0TWFzcyc6CiAgICAgICAgLy8gYXNzdW1lIHRoYXQgYW4gdXBkYXRlIGZyb20gemVyby1tYXNzIGltcGxpZXMgYSBuZWVkIGZvciBkeW5hbWljcyBvbiBzdGF0aWMgb2JqLgogICAgICAgIGlmIChwcm9wcyAhPT0gMCAmJiBzdGF0ZS5ib2RpZXNbdXVpZF0udHlwZSA9PT0gMCkgc3RhdGUuYm9kaWVzW3V1aWRdLnR5cGUgPSAxOwogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5tYXNzID0gcHJvcHM7CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLnVwZGF0ZU1hc3NQcm9wZXJ0aWVzKCk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRMaW5lYXJEYW1waW5nJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0ubGluZWFyRGFtcGluZyA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0QW5ndWxhckRhbXBpbmcnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5hbmd1bGFyRGFtcGluZyA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0QWxsb3dTbGVlcCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFsbG93U2xlZXAgPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldFNsZWVwU3BlZWRMaW1pdCc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLnNsZWVwU3BlZWRMaW1pdCA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0U2xlZXBUaW1lTGltaXQnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5zbGVlcFRpbWVMaW1pdCA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyR3JvdXAnOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5jb2xsaXNpb25GaWx0ZXJHcm91cCA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0Q29sbGlzaW9uRmlsdGVyTWFzayc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmNvbGxpc2lvbkZpbHRlck1hc2sgPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldENvbGxpc2lvblJlc3BvbnNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uY29sbGlzaW9uUmVzcG9uc2UgPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldEZpeGVkUm90YXRpb24nOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5maXhlZFJvdGF0aW9uID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRJc1RyaWdnZXInOgogICAgICAgIHN0YXRlLmJvZGllc1t1dWlkXS5pc1RyaWdnZXIgPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldEdyYXZpdHknOgogICAgICAgIHN0YXRlLndvcmxkLmdyYXZpdHkuc2V0KHByb3BzWzBdLCBwcm9wc1sxXSwgcHJvcHNbMl0pOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0VG9sZXJhbmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5zb2x2ZXIudG9sZXJhbmNlID0gcHJvcHM7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzZXRTdGVwJzoKICAgICAgICBzdGF0ZS5jb25maWcuc3RlcCA9IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0SXRlcmF0aW9ucyc6CiAgICAgICAgc3RhdGUud29ybGQuc29sdmVyLml0ZXJhdGlvbnMgPSBwcm9wczsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldEJyb2FkcGhhc2UnOgogICAgICAgIHN0YXRlLndvcmxkLmJyb2FkcGhhc2UgPSBuZXcgKGJyb2FkcGhhc2VzW3Byb3BzICsgJ0Jyb2FkcGhhc2UnXSB8fCBOYWl2ZUJyb2FkcGhhc2UpKHN0YXRlLndvcmxkKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldEF4aXNJbmRleCc6CiAgICAgICAgc3RhdGUud29ybGQuYnJvYWRwaGFzZS5heGlzSW5kZXggPSBwcm9wcyA9PT0gdW5kZWZpbmVkIHx8IHByb3BzID09PSBudWxsID8gMCA6IHByb3BzOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnYXBwbHlGb3JjZSc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFwcGx5Rm9yY2UobmV3IFZlYzMoLi4ucHJvcHNbMF0pLCBuZXcgVmVjMyguLi5wcm9wc1sxXSkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnYXBwbHlJbXB1bHNlJzoKICAgICAgICBzdGF0ZS5ib2RpZXNbdXVpZF0uYXBwbHlJbXB1bHNlKG5ldyBWZWMzKC4uLnByb3BzWzBdKSwgbmV3IFZlYzMoLi4ucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2FwcGx5TG9jYWxGb3JjZSc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFwcGx5TG9jYWxGb3JjZShuZXcgVmVjMyguLi5wcm9wc1swXSksIG5ldyBWZWMzKC4uLnByb3BzWzFdKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdhcHBseUxvY2FsSW1wdWxzZSc6CiAgICAgICAgc3RhdGUuYm9kaWVzW3V1aWRdLmFwcGx5TG9jYWxJbXB1bHNlKG5ldyBWZWMzKC4uLnByb3BzWzBdKSwgbmV3IFZlYzMoLi4ucHJvcHNbMV0pKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2FkZENvbnN0cmFpbnQnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFtib2R5QSwgYm9keUIsIG9wdG5zXSA9IHByb3BzOwogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgcGl2b3RBLAogICAgICAgICAgICBwaXZvdEIsCiAgICAgICAgICAgIGF4aXNBLAogICAgICAgICAgICBheGlzQiwKICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgfSA9IG9wdG5zOyAvLyBpcyB0aGVyZSBhIGJldHRlciB3YXkgdG8gZW5mb3JjZSBkZWZhdWx0cz8KCiAgICAgICAgICBwaXZvdEEgPSBBcnJheS5pc0FycmF5KHBpdm90QSkgPyBuZXcgVmVjMyguLi5waXZvdEEpIDogdW5kZWZpbmVkOwogICAgICAgICAgcGl2b3RCID0gQXJyYXkuaXNBcnJheShwaXZvdEIpID8gbmV3IFZlYzMoLi4ucGl2b3RCKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIGF4aXNBID0gQXJyYXkuaXNBcnJheShheGlzQSkgPyBuZXcgVmVjMyguLi5heGlzQSkgOiB1bmRlZmluZWQ7CiAgICAgICAgICBheGlzQiA9IEFycmF5LmlzQXJyYXkoYXhpc0IpID8gbmV3IFZlYzMoLi4uYXhpc0IpIDogdW5kZWZpbmVkOwogICAgICAgICAgbGV0IGNvbnN0cmFpbnQ7CgogICAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ1BvaW50VG9Qb2ludCc6CiAgICAgICAgICAgICAgY29uc3RyYWludCA9IG5ldyBQb2ludFRvUG9pbnRDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHBpdm90QSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgcGl2b3RCLCBvcHRucy5tYXhGb3JjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICdDb25lVHdpc3QnOgogICAgICAgICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgQ29uZVR3aXN0Q29uc3RyYWludChzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICAgICAgICBwaXZvdEEsCiAgICAgICAgICAgICAgICBwaXZvdEIsCiAgICAgICAgICAgICAgICBheGlzQSwKICAgICAgICAgICAgICAgIGF4aXNCLAogICAgICAgICAgICAgICAgLi4ub3B0aW9ucwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAnSGluZ2UnOgogICAgICAgICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgSGluZ2VDb25zdHJhaW50KHN0YXRlLmJvZGllc1tib2R5QV0sIHN0YXRlLmJvZGllc1tib2R5Ql0sIHsKICAgICAgICAgICAgICAgIHBpdm90QSwKICAgICAgICAgICAgICAgIHBpdm90QiwKICAgICAgICAgICAgICAgIGF4aXNBLAogICAgICAgICAgICAgICAgYXhpc0IsCiAgICAgICAgICAgICAgICAuLi5vcHRpb25zCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICBjYXNlICdEaXN0YW5jZSc6CiAgICAgICAgICAgICAgY29uc3RyYWludCA9IG5ldyBEaXN0YW5jZUNvbnN0cmFpbnQoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgb3B0bnMuZGlzdGFuY2UsIG9wdG5zLm1heEZvcmNlKTsKICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgIGNhc2UgJ0xvY2snOgogICAgICAgICAgICAgIGNvbnN0cmFpbnQgPSBuZXcgTG9ja0NvbnN0cmFpbnQoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgb3B0bnMpOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBjb25zdHJhaW50ID0gbmV3IENvbnN0cmFpbnQoc3RhdGUuYm9kaWVzW2JvZHlBXSwgc3RhdGUuYm9kaWVzW2JvZHlCXSwgb3B0bnMpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0cmFpbnQudXVpZCA9IHV1aWQ7CiAgICAgICAgICBzdGF0ZS53b3JsZC5hZGRDb25zdHJhaW50KGNvbnN0cmFpbnQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAncmVtb3ZlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKCh7CiAgICAgICAgICB1dWlkOiB0aGlzSWQKICAgICAgICB9KSA9PiB0aGlzSWQgPT09IHV1aWQpLm1hcChjID0+IHN0YXRlLndvcmxkLnJlbW92ZUNvbnN0cmFpbnQoYykpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZW5hYmxlQ29uc3RyYWludCc6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKCh7CiAgICAgICAgICB1dWlkOiB0aGlzSWQKICAgICAgICB9KSA9PiB0aGlzSWQgPT09IHV1aWQpLm1hcChjID0+IGMuZW5hYmxlKCkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZGlzYWJsZUNvbnN0cmFpbnQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcigoewogICAgICAgICAgdXVpZDogdGhpc0lkCiAgICAgICAgfSkgPT4gdGhpc0lkID09PSB1dWlkKS5tYXAoYyA9PiBjLmRpc2FibGUoKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdlbmFibGVDb25zdHJhaW50TW90b3InOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcigoewogICAgICAgICAgdXVpZDogdGhpc0lkCiAgICAgICAgfSkgPT4gdGhpc0lkID09PSB1dWlkKS5tYXAoYyA9PiBjLmVuYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnZGlzYWJsZUNvbnN0cmFpbnRNb3Rvcic6CiAgICAgICAgc3RhdGUud29ybGQuY29uc3RyYWludHMuZmlsdGVyKCh7CiAgICAgICAgICB1dWlkOiB0aGlzSWQKICAgICAgICB9KSA9PiB0aGlzSWQgPT09IHV1aWQpLm1hcChjID0+IGMuZGlzYWJsZU1vdG9yKCkpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnc2V0Q29uc3RyYWludE1vdG9yU3BlZWQnOgogICAgICAgIHN0YXRlLndvcmxkLmNvbnN0cmFpbnRzLmZpbHRlcigoewogICAgICAgICAgdXVpZDogdGhpc0lkCiAgICAgICAgfSkgPT4gdGhpc0lkID09PSB1dWlkKS5tYXAoYyA9PiBjLnNldE1vdG9yU3BlZWQocHJvcHMpKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3NldENvbnN0cmFpbnRNb3Rvck1heEZvcmNlJzoKICAgICAgICBzdGF0ZS53b3JsZC5jb25zdHJhaW50cy5maWx0ZXIoKHsKICAgICAgICAgIHV1aWQ6IHRoaXNJZAogICAgICAgIH0pID0+IHRoaXNJZCA9PT0gdXVpZCkubWFwKGMgPT4gYy5zZXRNb3Rvck1heEZvcmNlKHByb3BzKSk7CiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdhZGRTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFtib2R5QSwgYm9keUIsIG9wdG5zXSA9IHByb3BzOwogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgd29ybGRBbmNob3JBLAogICAgICAgICAgICB3b3JsZEFuY2hvckIsCiAgICAgICAgICAgIGxvY2FsQW5jaG9yQSwKICAgICAgICAgICAgbG9jYWxBbmNob3JCLAogICAgICAgICAgICByZXN0TGVuZ3RoLAogICAgICAgICAgICBzdGlmZm5lc3MsCiAgICAgICAgICAgIGRhbXBpbmcKICAgICAgICAgIH0gPSBvcHRuczsKICAgICAgICAgIHdvcmxkQW5jaG9yQSA9IEFycmF5LmlzQXJyYXkod29ybGRBbmNob3JBKSA/IG5ldyBWZWMzKC4uLndvcmxkQW5jaG9yQSkgOiB1bmRlZmluZWQ7CiAgICAgICAgICB3b3JsZEFuY2hvckIgPSBBcnJheS5pc0FycmF5KHdvcmxkQW5jaG9yQikgPyBuZXcgVmVjMyguLi53b3JsZEFuY2hvckIpIDogdW5kZWZpbmVkOwogICAgICAgICAgbG9jYWxBbmNob3JBID0gQXJyYXkuaXNBcnJheShsb2NhbEFuY2hvckEpID8gbmV3IFZlYzMoLi4ubG9jYWxBbmNob3JBKSA6IHVuZGVmaW5lZDsKICAgICAgICAgIGxvY2FsQW5jaG9yQiA9IEFycmF5LmlzQXJyYXkobG9jYWxBbmNob3JCKSA/IG5ldyBWZWMzKC4uLmxvY2FsQW5jaG9yQikgOiB1bmRlZmluZWQ7CiAgICAgICAgICBsZXQgc3ByaW5nID0gbmV3IFNwcmluZyhzdGF0ZS5ib2RpZXNbYm9keUFdLCBzdGF0ZS5ib2RpZXNbYm9keUJdLCB7CiAgICAgICAgICAgIHdvcmxkQW5jaG9yQSwKICAgICAgICAgICAgd29ybGRBbmNob3JCLAogICAgICAgICAgICBsb2NhbEFuY2hvckEsCiAgICAgICAgICAgIGxvY2FsQW5jaG9yQiwKICAgICAgICAgICAgcmVzdExlbmd0aCwKICAgICAgICAgICAgc3RpZmZuZXNzLAogICAgICAgICAgICBkYW1waW5nCiAgICAgICAgICB9KTsKICAgICAgICAgIHNwcmluZy51dWlkID0gdXVpZDsKCiAgICAgICAgICBsZXQgcG9zdFN0ZXBTcHJpbmcgPSAoKSA9PiBzcHJpbmcuYXBwbHlGb3JjZSgpOwoKICAgICAgICAgIHN0YXRlLnNwcmluZ3NbdXVpZF0gPSBwb3N0U3RlcFNwcmluZzsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXSA9IHNwcmluZzsgLy8gQ29tcHV0ZSB0aGUgZm9yY2UgYWZ0ZXIgZWFjaCBzdGVwCgogICAgICAgICAgc3RhdGUud29ybGQuYWRkRXZlbnRMaXN0ZW5lcigncG9zdFN0ZXAnLCBzdGF0ZS5zcHJpbmdzW3V1aWRdKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3NldFNwcmluZ1N0aWZmbmVzcyc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW3V1aWRdLnN0aWZmbmVzcyA9IHByb3BzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc2V0U3ByaW5nUmVzdExlbmd0aCc6CiAgICAgICAgewogICAgICAgICAgc3RhdGUuc3ByaW5nSW5zdGFuY2VzW3V1aWRdLnJlc3RMZW5ndGggPSBwcm9wczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ3NldFNwcmluZ0RhbXBpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLnNwcmluZ0luc3RhbmNlc1t1dWlkXS5kYW1waW5nID0gcHJvcHM7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdyZW1vdmVTcHJpbmcnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUuc3ByaW5nc1t1dWlkXSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdhZGRSYXknOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgZnJvbSwKICAgICAgICAgICAgdG8sCiAgICAgICAgICAgIC4uLm9wdGlvbnMKICAgICAgICAgIH0gPSBwcm9wczsKICAgICAgICAgIGNvbnN0IHJheSA9IG5ldyBSYXkoZnJvbSA/IG5ldyBWZWMzKC4uLmZyb20pIDogdW5kZWZpbmVkLCB0byA/IG5ldyBWZWMzKC4uLnRvKSA6IHVuZGVmaW5lZCk7CiAgICAgICAgICBvcHRpb25zLm1vZGUgPSBSYXlbb3B0aW9ucy5tb2RlLnRvVXBwZXJDYXNlKCldOwogICAgICAgICAgb3B0aW9ucy5yZXN1bHQgPSBuZXcgUmF5Y2FzdFJlc3VsdCgpOwoKICAgICAgICAgIHN0YXRlLnJheXNbdXVpZF0gPSAoKSA9PiB7CiAgICAgICAgICAgIHJheS5pbnRlcnNlY3RXb3JsZChzdGF0ZS53b3JsZCwgb3B0aW9ucyk7CiAgICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgICBib2R5LAogICAgICAgICAgICAgIHNoYXBlLAogICAgICAgICAgICAgIHJheUZyb21Xb3JsZCwKICAgICAgICAgICAgICByYXlUb1dvcmxkLAogICAgICAgICAgICAgIGhpdE5vcm1hbFdvcmxkLAogICAgICAgICAgICAgIGhpdFBvaW50V29ybGQsCiAgICAgICAgICAgICAgLi4ucmVzdAogICAgICAgICAgICB9ID0gb3B0aW9ucy5yZXN1bHQ7CiAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgIG9wOiAnZXZlbnQnLAogICAgICAgICAgICAgIHR5cGU6ICdyYXloaXQnLAogICAgICAgICAgICAgIHJheTogewogICAgICAgICAgICAgICAgZnJvbSwKICAgICAgICAgICAgICAgIHRvLAogICAgICAgICAgICAgICAgZGlyZWN0aW9uOiByYXkuZGlyZWN0aW9uLnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgIGNvbGxpc2lvbkZpbHRlckdyb3VwOiByYXkuY29sbGlzaW9uRmlsdGVyR3JvdXAsCiAgICAgICAgICAgICAgICBjb2xsaXNpb25GaWx0ZXJNYXNrOiByYXkuY29sbGlzaW9uRmlsdGVyTWFzaywKICAgICAgICAgICAgICAgIHV1aWQKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGJvZHk6IGJvZHkgPyBib2R5LnV1aWQgOiBudWxsLAogICAgICAgICAgICAgIHNoYXBlOiBzaGFwZSA/IHsgLi4uc2hhcGUsCiAgICAgICAgICAgICAgICBib2R5OiBib2R5LnV1aWQKICAgICAgICAgICAgICB9IDogbnVsbCwKICAgICAgICAgICAgICByYXlGcm9tV29ybGQ6IHJheUZyb21Xb3JsZC50b0FycmF5KCksCiAgICAgICAgICAgICAgcmF5VG9Xb3JsZDogcmF5VG9Xb3JsZC50b0FycmF5KCksCiAgICAgICAgICAgICAgaGl0Tm9ybWFsV29ybGQ6IGhpdE5vcm1hbFdvcmxkLnRvQXJyYXkoKSwKICAgICAgICAgICAgICBoaXRQb2ludFdvcmxkOiBoaXRQb2ludFdvcmxkLnRvQXJyYXkoKSwKICAgICAgICAgICAgICAuLi5yZXN0CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfTsKCiAgICAgICAgICBzdGF0ZS53b3JsZC5hZGRFdmVudExpc3RlbmVyKCdwcmVTdGVwJywgc3RhdGUucmF5c1t1dWlkXSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdyZW1vdmVSYXknOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS5yYXlzW3V1aWRdKTsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5yYXlzW3V1aWRdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnYWRkUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIGNvbnN0IFtjaGFzc2lzQm9keSwgd2hlZWxzLCB3aGVlbEluZm9zLCBpbmRleEZvcndhcmRBeGlzLCBpbmRleFJpZ2h0QXhpcywgaW5kZXhVcEF4aXNdID0gcHJvcHM7CiAgICAgICAgICBjb25zdCB2ZWhpY2xlID0gbmV3IFJheWNhc3RWZWhpY2xlKHsKICAgICAgICAgICAgY2hhc3Npc0JvZHk6IHN0YXRlLmJvZGllc1tjaGFzc2lzQm9keV0sCiAgICAgICAgICAgIGluZGV4Rm9yd2FyZEF4aXM6IGluZGV4Rm9yd2FyZEF4aXMsCiAgICAgICAgICAgIGluZGV4UmlnaHRBeGlzOiBpbmRleFJpZ2h0QXhpcywKICAgICAgICAgICAgaW5kZXhVcEF4aXM6IGluZGV4VXBBeGlzCiAgICAgICAgICB9KTsKICAgICAgICAgIHZlaGljbGUud29ybGQgPSBzdGF0ZS53b3JsZDsKCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdoZWVsSW5mb3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3Qgd2hlZWxJbmZvID0gd2hlZWxJbmZvc1tpXTsKICAgICAgICAgICAgd2hlZWxJbmZvLmRpcmVjdGlvbkxvY2FsID0gbmV3IFZlYzMoLi4ud2hlZWxJbmZvLmRpcmVjdGlvbkxvY2FsKTsKICAgICAgICAgICAgd2hlZWxJbmZvLmNoYXNzaXNDb25uZWN0aW9uUG9pbnRMb2NhbCA9IG5ldyBWZWMzKC4uLndoZWVsSW5mby5jaGFzc2lzQ29ubmVjdGlvblBvaW50TG9jYWwpOwogICAgICAgICAgICB3aGVlbEluZm8uYXhsZUxvY2FsID0gbmV3IFZlYzMoLi4ud2hlZWxJbmZvLmF4bGVMb2NhbCk7CiAgICAgICAgICAgIHZlaGljbGUuYWRkV2hlZWwod2hlZWxJbmZvKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2ZWhpY2xlLnByZVN0ZXAgPSAoKSA9PiB7CiAgICAgICAgICAgIHN0YXRlLnZlaGljbGVzW3V1aWRdLnVwZGF0ZVZlaGljbGUoc3RhdGUud29ybGQuZHQpOwogICAgICAgICAgfTsKCiAgICAgICAgICB2ZWhpY2xlLnBvc3RTdGVwID0gKCkgPT4gewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlLnZlaGljbGVzW3V1aWRdLndoZWVsSW5mb3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICBzdGF0ZS52ZWhpY2xlc1t1dWlkXS51cGRhdGVXaGVlbFRyYW5zZm9ybShpKTsKICAgICAgICAgICAgICBjb25zdCB0ID0gc3RhdGUudmVoaWNsZXNbdXVpZF0ud2hlZWxJbmZvc1tpXS53b3JsZFRyYW5zZm9ybTsKICAgICAgICAgICAgICBjb25zdCB3aGVlbEJvZHkgPSBzdGF0ZS5ib2RpZXNbd2hlZWxzW2ldXTsKICAgICAgICAgICAgICB3aGVlbEJvZHkucG9zaXRpb24uY29weSh0LnBvc2l0aW9uKTsKICAgICAgICAgICAgICB3aGVlbEJvZHkucXVhdGVybmlvbi5jb3B5KHQucXVhdGVybmlvbik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIHN0YXRlLnZlaGljbGVzW3V1aWRdID0gdmVoaWNsZTsKICAgICAgICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5wcmVTdGVwKTsKICAgICAgICAgIHN0YXRlLndvcmxkLmFkZEV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUudmVoaWNsZXNbdXVpZF0ucG9zdFN0ZXApOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAncmVtb3ZlUmF5Y2FzdFZlaGljbGUnOgogICAgICAgIHsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3ByZVN0ZXAnLCBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5wcmVTdGVwKTsKICAgICAgICAgIHN0YXRlLndvcmxkLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Bvc3RTdGVwJywgc3RhdGUudmVoaWNsZXNbdXVpZF0ucG9zdFN0ZXApOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbdXVpZF0ud29ybGQgPSBudWxsOwogICAgICAgICAgZGVsZXRlIHN0YXRlLnZlaGljbGVzW3V1aWRdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgY2FzZSAnc2V0UmF5Y2FzdFZlaGljbGVTdGVlcmluZ1ZhbHVlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbdmFsdWUsIHdoZWVsSW5kZXhdID0gcHJvcHM7CiAgICAgICAgICBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5zZXRTdGVlcmluZ1ZhbHVlKHZhbHVlLCB3aGVlbEluZGV4KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgIGNhc2UgJ2FwcGx5UmF5Y2FzdFZlaGljbGVFbmdpbmVGb3JjZSc6CiAgICAgICAgewogICAgICAgICAgY29uc3QgW3ZhbHVlLCB3aGVlbEluZGV4XSA9IHByb3BzOwogICAgICAgICAgc3RhdGUudmVoaWNsZXNbdXVpZF0uYXBwbHlFbmdpbmVGb3JjZSh2YWx1ZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICBjYXNlICdzZXRSYXljYXN0VmVoaWNsZUJyYWtlJzoKICAgICAgICB7CiAgICAgICAgICBjb25zdCBbYnJha2UsIHdoZWVsSW5kZXhdID0gcHJvcHM7CiAgICAgICAgICBzdGF0ZS52ZWhpY2xlc1t1dWlkXS5zZXRCcmFrZShicmFrZSwgd2hlZWxJbmRleCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICB9CiAgfTsKCn0oKSk7Cgo=",null,!1);var b=new f.Vector3,v=new f.Vector3(1,1,1),A=new f.Quaternion,y=new f.Matrix4;function w(e,t,n){return void 0!==e?(y.compose(b.fromArray(t.positions,3*e),A.fromArray(t.quaternions,4*e),n?n.scale:v),n&&(n.matrixAutoUpdate=!1,n.matrix.copy(y)),y):y.identity()}function G(e){var t=e.children,n=e.shouldInvalidate,r=void 0===n||n,a=e.step,i=void 0===a?1/60:a,o=e.gravity,s=void 0===o?[0,-10,0]:o,u=e.tolerance,I=void 0===u?.001:u,C=e.iterations,b=void 0===C?5:C,v=e.allowSleep,A=void 0!==v&&v,y=e.broadphase,G=void 0===y?"Naive":y,B=e.axisIndex,x=void 0===B?0:B,S=e.defaultContactMaterial,k=void 0===S?{contactEquationStiffness:1e6}:S,Z=e.size,R=void 0===Z?1e3:Z,N=Object(h.h)().invalidate,O=Object(g.useState)((function(){return new m})),W=Object(l.a)(O,1)[0],F=Object(g.useState)({}),M=Object(l.a)(F,1)[0],V=Object(g.useState)((function(){return{positions:new Float32Array(3*R),quaternions:new Float32Array(4*R)}})),T=Object(l.a)(V,1)[0],E=Object(g.useState)({}),j=Object(l.a)(E,1)[0],L=Object(g.useState)({}),X=Object(l.a)(L,1)[0],H=Object(g.useRef)({}),Y=Object(g.useCallback)((function(){0!==T.positions.byteLength&&0!==T.quaternions.byteLength&&W.postMessage(Object(c.a)({op:"step"},T),[T.positions.buffer,T.quaternions.buffer])}),[]);Object(h.f)(Y),Object(g.useLayoutEffect)((function(){W.postMessage({op:"init",props:{gravity:s,tolerance:I,step:i,iterations:b,broadphase:G,allowSleep:A,axisIndex:x,defaultContactMaterial:k}});var e,t=0;return W.onmessage=function(n){switch(n.data.op){case"frame":if(T.positions=n.data.positions,T.quaternions=n.data.quaternions,n.data.bodies)for(t=0;t<n.data.bodies.length;t++)e=n.data.bodies[t],H.current[e]=n.data.bodies.indexOf(e);if(n.data.observations.forEach((function(e){var t=Object(l.a)(e,2),n=t[0],r=t[1];X[n]&&X[n](r)})),n.data.active){for(var a=0,i=Object.values(M);a<i.length;a++){var o=i[a];if(o instanceof f.InstancedMesh)for(var s=0;s<o.count;s++){var u=H.current["".concat(o.uuid,"/").concat(s)];void 0!==u&&o.setMatrixAt(s,w(u,T)),o.instanceMatrix.needsUpdate=!0}else w(H.current[o.uuid],T,o)}r&&N()}break;case"event":switch(n.data.type){case"collide":j[n.data.target](Object(c.a)(Object(c.a)({},n.data),{},{target:M[n.data.target],body:M[n.data.body],contact:Object(c.a)(Object(c.a)({},n.data.contact),{},{bi:M[n.data.contact.bi],bj:M[n.data.contact.bj]})}));break;case"collideBegin":j[n.data.bodyA]&&j[n.data.bodyA]({op:"event",type:"collideBegin",target:M[n.data.bodyA],body:M[n.data.bodyB]}),j[n.data.bodyB]&&j[n.data.bodyB]({op:"event",type:"collideBegin",target:M[n.data.bodyB],body:M[n.data.bodyA]});break;case"collideEnd":j[n.data.bodyA]&&j[n.data.bodyA]({op:"event",type:"collideEnd",target:M[n.data.bodyA],body:M[n.data.bodyB]}),j[n.data.bodyB]&&j[n.data.bodyB]({op:"event",type:"collideEnd",target:M[n.data.bodyB],body:M[n.data.bodyA]});break;case"rayhit":if(!j[n.data.ray.uuid])break;j[n.data.ray.uuid](Object(c.a)(Object(c.a)({},n.data),{},{body:n.data.body?M[n.data.body]:null}))}}},function(){return W.terminate()}}),[]),function(e){var t=e.worker,n=e.gravity,r=e.tolerance,a=e.step,i=e.iterations,o=e.broadphase,s=e.axisIndex;Object(g.useEffect)((function(){t.postMessage({op:"setGravity",props:n})}),[n]),Object(g.useEffect)((function(){t.postMessage({op:"setTolerance",props:r})}),[r]),Object(g.useEffect)((function(){t.postMessage({op:"setStep",props:a})}),[a]),Object(g.useEffect)((function(){t.postMessage({op:"setIterations",props:i})}),[i]),Object(g.useEffect)((function(){t.postMessage({op:"setBroadphase",props:o})}),[o]),Object(g.useEffect)((function(){t.postMessage({op:"setAxisIndex",props:s})}),[s])}({worker:W,axisIndex:x,broadphase:G,gravity:s,iterations:b,step:i,tolerance:I});var z=Object(g.useMemo)((function(){return{worker:W,bodies:H,refs:M,buffers:T,events:j,subscriptions:X}}),[W,H,M,T,j,X]);return d.a.createElement(p.Provider,{value:z},t)}var B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0,0,0,0,0,0];Object(s.a)(this,e),this.elements=void 0,this.elements=t}return Object(u.a)(e,[{key:"identity",value:function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}},{key:"setZero",value:function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0}},{key:"setTrace",value:function(e){var t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z}},{key:"getTrace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new S,t=this.elements;return e.x=t[0],e.y=t[4],e.z=t[8],e}},{key:"vmult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S,n=this.elements,r=e.x,a=e.y,i=e.z;return t.x=n[0]*r+n[1]*a+n[2]*i,t.y=n[3]*r+n[4]*a+n[5]*i,t.z=n[6]*r+n[7]*a+n[8]*i,t}},{key:"smult",value:function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]*=e}},{key:"mmult",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.elements,a=t.elements,i=n.elements,o=r[0],s=r[1],u=r[2],c=r[3],l=r[4],g=r[5],d=r[6],h=r[7],f=r[8],p=a[0],I=a[1],C=a[2],m=a[3],b=a[4],v=a[5],A=a[6],y=a[7],w=a[8];return i[0]=o*p+s*m+u*A,i[1]=o*I+s*b+u*y,i[2]=o*C+s*v+u*w,i[3]=c*p+l*m+g*A,i[4]=c*I+l*b+g*y,i[5]=c*C+l*v+g*w,i[6]=d*p+h*m+f*A,i[7]=d*I+h*b+f*y,i[8]=d*C+h*v+f*w,n}},{key:"scale",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.elements,a=n.elements,i=0;3!==i;i++)a[3*i+0]=t.x*r[3*i+0],a[3*i+1]=t.y*r[3*i+1],a[3*i+2]=t.z*r[3*i+2];return n}},{key:"solve",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S,a=3,i=4,o=[];for(t=0;t<a*i;t++)o.push(0);for(t=0;t<3;t++)for(n=0;n<3;n++)o[t+i*n]=this.elements[t+3*n];o[3]=e.x,o[7]=e.y,o[11]=e.z;var s,u,c=3,l=c,g=4;do{if(0===o[(t=l-c)+i*t])for(n=t+1;n<l;n++)if(0!==o[t+i*n]){s=g;do{o[(u=g-s)+i*t]+=o[u+i*n]}while(--s);break}if(0!==o[t+i*t])for(n=t+1;n<l;n++){var d=o[t+i*n]/o[t+i*t];s=g;do{o[(u=g-s)+i*n]=u<=t?0:o[u+i*n]-o[u+i*t]*d}while(--s)}}while(--c);if(r.z=o[2*i+3]/o[2*i+2],r.y=(o[1*i+3]-o[1*i+2]*r.z)/o[1*i+1],r.x=(o[0*i+3]-o[0*i+2]*r.z-o[0*i+1]*r.y)/o[0*i+0],isNaN(r.x)||isNaN(r.y)||isNaN(r.z)||r.x===1/0||r.y===1/0||r.z===1/0)throw"Could not solve equation! Got x=["+r.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return r}},{key:"e",value:function(e,t,n){if(void 0===n)return this.elements[t+3*e];this.elements[t+3*e]=n}},{key:"copy",value:function(e){for(var t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this}},{key:"toString",value:function(){for(var e="",t=0;t<9;t++)e+=this.elements[t]+",";return e}},{key:"reverse",value:function(){var t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,a=3,i=6,o=x;for(t=0;t<3;t++)for(n=0;n<3;n++)o[t+i*n]=this.elements[t+3*n];o[3]=1,o[9]=0,o[15]=0,o[4]=0,o[10]=1,o[16]=0,o[5]=0,o[11]=0,o[17]=1;var s,u,c=3,l=c,g=i;do{if(0===o[(t=l-c)+i*t])for(n=t+1;n<l;n++)if(0!==o[t+i*n]){s=g;do{o[(u=g-s)+i*t]+=o[u+i*n]}while(--s);break}if(0!==o[t+i*t])for(n=t+1;n<l;n++){var d=o[t+i*n]/o[t+i*t];s=g;do{o[(u=g-s)+i*n]=u<=t?0:o[u+i*n]-o[u+i*t]*d}while(--s)}}while(--c);t=2;do{n=t-1;do{var h=o[t+i*n]/o[t+i*t];s=i;do{o[(u=i-s)+i*n]=o[u+i*n]-o[u+i*t]*h}while(--s)}while(n--)}while(--t);t=2;do{var f=1/o[t+i*t];s=i;do{o[(u=i-s)+i*t]=o[u+i*t]*f}while(--s)}while(t--);t=2;do{n=2;do{if(u=o[a+n+i*t],isNaN(u)||u===1/0)throw"Could not reverse! A=["+this.toString()+"]";r.e(t,n,u)}while(n--)}while(t--);return r}},{key:"setRotationFromQuaternion",value:function(e){var t=e.x,n=e.y,r=e.z,a=e.w,i=t+t,o=n+n,s=r+r,u=t*i,c=t*o,l=t*s,g=n*o,d=n*s,h=r*s,f=a*i,p=a*o,I=a*s,C=this.elements;return C[0]=1-(g+h),C[1]=c-I,C[2]=l+p,C[3]=c+I,C[4]=1-(u+h),C[5]=d-f,C[6]=l-p,C[7]=d+f,C[8]=1-(u+g),this}},{key:"transpose",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,r=this.elements,a=n.elements;return a[0]=r[0],a[4]=r[4],a[8]=r[8],t=r[1],a[1]=r[3],a[3]=t,t=r[2],a[2]=r[6],a[6]=t,t=r[5],a[5]=r[7],a[7]=t,n}}]),e}(),x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(s.a)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.x=t,this.y=n,this.z=r}return Object(u.a)(e,[{key:"cross",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=t.x,a=t.y,i=t.z,o=this.x,s=this.y,u=this.z;return n.x=s*i-u*a,n.y=u*r-o*i,n.z=o*a-s*r,n}},{key:"set",value:function(e,t,n){return this.x=e,this.y=t,this.z=n,this}},{key:"setZero",value:function(){this.x=this.y=this.z=0}},{key:"vadd",value:function(t,n){if(!n)return new e(this.x+t.x,this.y+t.y,this.z+t.z);n.x=t.x+this.x,n.y=t.y+this.y,n.z=t.z+this.z}},{key:"vsub",value:function(t,n){if(!n)return new e(this.x-t.x,this.y-t.y,this.z-t.z);n.x=this.x-t.x,n.y=this.y-t.y,n.z=this.z-t.z}},{key:"crossmat",value:function(){return new B([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.z,r=Math.sqrt(e*e+t*t+n*n);if(r>0){var a=1/r;this.x*=a,this.y*=a,this.z*=a}else this.x=0,this.y=0,this.z=0;return r}},{key:"unit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,n=this.x,r=this.y,a=this.z,i=Math.sqrt(n*n+r*r+a*a);return i>0?(i=1/i,t.x=n*i,t.y=r*i,t.z=a*i):(t.x=1,t.y=0,t.z=0),t}},{key:"length",value:function(){var e=this.x,t=this.y,n=this.z;return Math.sqrt(e*e+t*t+n*n)}},{key:"lengthSquared",value:function(){return this.dot(this)}},{key:"distanceTo",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.x,i=e.y,o=e.z;return Math.sqrt((a-t)*(a-t)+(i-n)*(i-n)+(o-r)*(o-r))}},{key:"distanceSquared",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.x,i=e.y,o=e.z;return(a-t)*(a-t)+(i-n)*(i-n)+(o-r)*(o-r)}},{key:"scale",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.x,a=this.y,i=this.z;return n.x=t*r,n.y=t*a,n.z=t*i,n}},{key:"vmul",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return n.x=t.x*this.x,n.y=t.y*this.y,n.z=t.z*this.z,n}},{key:"addScaledVector",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return r.x=this.x+t*n.x,r.y=this.y+t*n.y,r.z=this.z+t*n.z,r}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"isZero",value:function(){return 0===this.x&&0===this.y&&0===this.z}},{key:"negate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return t.x=-this.x,t.y=-this.y,t.z=-this.z,t}},{key:"tangents",value:function(e,t){var n=this.length();if(n>0){var r=k,a=1/n;r.set(this.x*a,this.y*a,this.z*a);var i=Z;Math.abs(r.x)<.9?(i.set(1,0,0),r.cross(i,e)):(i.set(0,1,0),r.cross(i,e)),r.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)}},{key:"toString",value:function(){return this.x+","+this.y+","+this.z}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"lerp",value:function(e,t,n){var r=this.x,a=this.y,i=this.z;n.x=r+(e.x-r)*t,n.y=a+(e.y-a)*t,n.z=i+(e.z-i)*t}},{key:"almostEquals",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6;return!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)}},{key:"almostZero",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-6;return!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)}},{key:"isAntiparallelTo",value:function(e,t){return this.negate(R),R.almostEquals(e,t)}},{key:"clone",value:function(){return new e(this.x,this.y,this.z)}}]),e}();S.ZERO=void 0,S.UNIT_X=void 0,S.UNIT_Y=void 0,S.UNIT_Z=void 0,S.ZERO=new S(0,0,0),S.UNIT_X=new S(1,0,0),S.UNIT_Y=new S(0,1,0),S.UNIT_Z=new S(0,0,1);var k=new S,Z=new S,R=new S,N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new S,this.upperBound=new S,t.lowerBound&&this.lowerBound.copy(t.lowerBound),t.upperBound&&this.upperBound.copy(t.upperBound)}return Object(u.a)(e,[{key:"setFromPoints",value:function(e,t,n,r){var a=this.lowerBound,i=this.upperBound,o=n;a.copy(e[0]),o&&o.vmult(a,a),i.copy(a);for(var s=1;s<e.length;s++){var u=e[s];o&&(o.vmult(u,O),u=O),u.x>i.x&&(i.x=u.x),u.x<a.x&&(a.x=u.x),u.y>i.y&&(i.y=u.y),u.y<a.y&&(a.y=u.y),u.z>i.z&&(i.z=u.z),u.z<a.z&&(a.z=u.z)}return t&&(t.vadd(a,a),t.vadd(i,i)),r&&(a.x-=r,a.y-=r,a.z-=r,i.x+=r,i.y+=r,i.z+=r),this}},{key:"copy",value:function(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"extend",value:function(e){this.lowerBound.x=Math.min(this.lowerBound.x,e.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,e.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,e.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,e.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,e.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,e.upperBound.z)}},{key:"overlaps",value:function(e){var t=this.lowerBound,n=this.upperBound,r=e.lowerBound,a=e.upperBound,i=r.x<=n.x&&n.x<=a.x||t.x<=a.x&&a.x<=n.x,o=r.y<=n.y&&n.y<=a.y||t.y<=a.y&&a.y<=n.y,s=r.z<=n.z&&n.z<=a.z||t.z<=a.z&&a.z<=n.z;return i&&o&&s}},{key:"volume",value:function(){var e=this.lowerBound,t=this.upperBound;return(t.x-e.x)*(t.y-e.y)*(t.z-e.z)}},{key:"contains",value:function(e){var t=this.lowerBound,n=this.upperBound,r=e.lowerBound,a=e.upperBound;return t.x<=r.x&&n.x>=a.x&&t.y<=r.y&&n.y>=a.y&&t.z<=r.z&&n.z>=a.z}},{key:"getCorners",value:function(e,t,n,r,a,i,o,s){var u=this.lowerBound,c=this.upperBound;e.copy(u),t.set(c.x,u.y,u.z),n.set(c.x,c.y,u.z),r.set(u.x,c.y,c.z),a.set(c.x,u.y,c.z),i.set(u.x,c.y,u.z),o.set(u.x,u.y,c.z),s.copy(c)}},{key:"toLocalFrame",value:function(e,t){var n=W,r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],l=n[7];this.getCorners(r,a,i,o,s,u,c,l);for(var g=0;8!==g;g++){var d=n[g];e.pointToLocal(d,d)}return t.setFromPoints(n)}},{key:"toWorldFrame",value:function(e,t){var n=W,r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],u=n[5],c=n[6],l=n[7];this.getCorners(r,a,i,o,s,u,c,l);for(var g=0;8!==g;g++){var d=n[g];e.pointToWorld(d,d)}return t.setFromPoints(n)}},{key:"overlapsRay",value:function(e){var t=e.direction,n=e.from,r=1/t.x,a=1/t.y,i=1/t.z,o=(this.lowerBound.x-n.x)*r,s=(this.upperBound.x-n.x)*r,u=(this.lowerBound.y-n.y)*a,c=(this.upperBound.y-n.y)*a,l=(this.lowerBound.z-n.z)*i,g=(this.upperBound.z-n.z)*i,d=Math.max(Math.max(Math.min(o,s),Math.min(u,c)),Math.min(l,g)),h=Math.min(Math.min(Math.max(o,s),Math.max(u,c)),Math.max(l,g));return!(h<0)&&!(d>h)}}]),e}(),O=new S,W=[new S,new S,new S,new S,new S,new S,new S,new S],F=function(){function e(){Object(s.a)(this,e),this._listeners=void 0}return Object(u.a)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),n[e].includes(t)||n[e].push(t),this}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return!(void 0===n[e]||!n[e].includes(t))}},{key:"hasAnyEventListener",value:function(e){return void 0!==this._listeners&&void 0!==this._listeners[e]}},{key:"removeEventListener",value:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners;if(void 0===n[e])return this;var r=n[e].indexOf(t);return-1!==r&&n[e].splice(r,1),this}},{key:"dispatchEvent",value:function(e){if(void 0===this._listeners)return this;var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=0,r=t.length;n<r;n++)t[n].call(this,e)}return this}}]),e}(),M=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(s.a)(this,e),this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=t,this.y=n,this.z=r,this.w=a}return Object(u.a)(e,[{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"toString",value:function(){return this.x+","+this.y+","+this.z+","+this.w}},{key:"toArray",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"setFromAxisAngle",value:function(e,t){var n=Math.sin(.5*t);return this.x=e.x*n,this.y=e.y*n,this.z=e.z*n,this.w=Math.cos(.5*t),this}},{key:"toAxisAngle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new S;this.normalize();var t=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/n,e.y=this.y/n,e.z=this.z/n),[e,t]}},{key:"setFromVectors",value:function(e,t){if(e.isAntiparallelTo(t)){var n=V,r=T;e.tangents(n,r),this.setFromAxisAngle(n,Math.PI)}else{var a=e.cross(t);this.x=a.x,this.y=a.y,this.z=a.z,this.w=Math.sqrt(Math.pow(e.length(),2)*Math.pow(t.length(),2))+e.dot(t),this.normalize()}return this}},{key:"mult",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,r=this.x,a=this.y,i=this.z,o=this.w,s=t.x,u=t.y,c=t.z,l=t.w;return n.x=r*l+o*s+a*c-i*u,n.y=a*l+o*u+i*s-r*c,n.z=i*l+o*c+r*u-a*s,n.w=o*l-r*s-a*u-i*c,n}},{key:"inverse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e,n=this.x,r=this.y,a=this.z,i=this.w;this.conjugate(t);var o=1/(n*n+r*r+a*a+i*i);return t.x*=o,t.y*=o,t.z*=o,t.w*=o,t}},{key:"conjugate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new e;return t.x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t}},{key:"normalize",value:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}},{key:"normalizeFast",value:function(){var e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e),this}},{key:"vmult",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S,n=e.x,r=e.y,a=e.z,i=this.x,o=this.y,s=this.z,u=this.w,c=u*n+o*a-s*r,l=u*r+s*n-i*a,g=u*a+i*r-o*n,d=-i*n-o*r-s*a;return t.x=c*u+d*-i+l*-s-g*-o,t.y=l*u+d*-o+g*-i-c*-s,t.z=g*u+d*-s+c*-o-l*-i,t}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this}},{key:"toEuler",value:function(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YZX",i=this.x,o=this.y,s=this.z,u=this.w;switch(a){case"YZX":var c=i*o+s*u;if(c>.499&&(t=2*Math.atan2(i,u),n=Math.PI/2,r=0),c<-.499&&(t=-2*Math.atan2(i,u),n=-Math.PI/2,r=0),void 0===t){var l=i*i,g=o*o,d=s*s;t=Math.atan2(2*o*u-2*i*s,1-2*g-2*d),n=Math.asin(2*c),r=Math.atan2(2*i*u-2*o*s,1-2*l-2*d)}break;default:throw new Error("Euler order "+a+" not supported yet.")}e.y=t,e.z=n,e.x=r}},{key:"setFromEuler",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"XYZ",a=Math.cos(e/2),i=Math.cos(t/2),o=Math.cos(n/2),s=Math.sin(e/2),u=Math.sin(t/2),c=Math.sin(n/2);return"XYZ"===r?(this.x=s*i*o+a*u*c,this.y=a*u*o-s*i*c,this.z=a*i*c+s*u*o,this.w=a*i*o-s*u*c):"YXZ"===r?(this.x=s*i*o+a*u*c,this.y=a*u*o-s*i*c,this.z=a*i*c-s*u*o,this.w=a*i*o+s*u*c):"ZXY"===r?(this.x=s*i*o-a*u*c,this.y=a*u*o+s*i*c,this.z=a*i*c+s*u*o,this.w=a*i*o-s*u*c):"ZYX"===r?(this.x=s*i*o-a*u*c,this.y=a*u*o+s*i*c,this.z=a*i*c-s*u*o,this.w=a*i*o+s*u*c):"YZX"===r?(this.x=s*i*o+a*u*c,this.y=a*u*o+s*i*c,this.z=a*i*c-s*u*o,this.w=a*i*o-s*u*c):"XZY"===r&&(this.x=s*i*o-a*u*c,this.y=a*u*o-s*i*c,this.z=a*i*c+s*u*o,this.w=a*i*o+s*u*c),this}},{key:"clone",value:function(){return new e(this.x,this.y,this.z,this.w)}},{key:"slerp",value:function(t,n){var r,a,i,o,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,c=this.x,l=this.y,g=this.z,d=this.w,h=t.x,f=t.y,p=t.z,I=t.w;return(a=c*h+l*f+g*p+d*I)<0&&(a=-a,h=-h,f=-f,p=-p,I=-I),1-a>1e-6?(r=Math.acos(a),i=Math.sin(r),o=Math.sin((1-n)*r)/i,s=Math.sin(n*r)/i):(o=1-n,s=n),u.x=o*c+s*h,u.y=o*l+s*f,u.z=o*g+s*p,u.w=o*d+s*I,u}},{key:"integrate",value:function(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e,i=t.x*r.x,o=t.y*r.y,s=t.z*r.z,u=this.x,c=this.y,l=this.z,g=this.w,d=.5*n;return a.x+=d*(i*g+o*l-s*c),a.y+=d*(o*g+s*u-i*l),a.z+=d*(s*g+i*c-o*u),a.w+=d*(-i*u-o*c-s*l),a}}]),e}(),V=new S,T=new S,E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=e.idCounter++,this.type=t.type||0,this.boundingSphereRadius=0,this.collisionResponse=!t.collisionResponse||t.collisionResponse,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.material=t.material?t.material:null,this.body=null}return Object(u.a)(e,[{key:"updateBoundingSphereRadius",value:function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}},{key:"volume",value:function(){throw"volume() not implemented for shape type "+this.type}},{key:"calculateLocalInertia",value:function(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type}},{key:"calculateWorldAABB",value:function(e,t,n,r){throw"calculateWorldAABB() not implemented for shape type "+this.type}}]),e}();E.idCounter=0,E.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};var j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.position=void 0,this.quaternion=void 0,this.position=new S,this.quaternion=new M,t.position&&this.position.copy(t.position),t.quaternion&&this.quaternion.copy(t.quaternion)}return Object(u.a)(e,[{key:"pointToLocal",value:function(t,n){return e.pointToLocalFrame(this.position,this.quaternion,t,n)}},{key:"pointToWorld",value:function(t,n){return e.pointToWorldFrame(this.position,this.quaternion,t,n)}},{key:"vectorToWorldFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return this.quaternion.vmult(e,t),t}}],[{key:"pointToLocalFrame",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new S;return n.vsub(e,r),t.conjugate(L),L.vmult(r,r),r}},{key:"pointToWorldFrame",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new S;return t.vmult(n,r),r.vadd(e,r),r}},{key:"vectorToWorldFrame",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new S;return e.vmult(t,n),n}},{key:"vectorToLocalFrame",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new S;return t.w*=-1,t.vmult(n,r),t.w*=-1,r}}]),e}(),L=new M,X=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,n);var a=r.vertices,i=void 0===a?[]:a,o=r.faces,u=void 0===o?[]:o,c=r.normals,l=void 0===c?[]:c,g=r.axes,d=r.boundingSphereRadius;return(e=t.call(this,{type:E.types.CONVEXPOLYHEDRON})).vertices=void 0,e.faces=void 0,e.faceNormals=void 0,e.worldVertices=void 0,e.worldVerticesNeedsUpdate=void 0,e.worldFaceNormals=void 0,e.worldFaceNormalsNeedsUpdate=void 0,e.uniqueAxes=void 0,e.uniqueEdges=void 0,e.vertices=i,e.faces=u,e.faceNormals=l,0===e.faceNormals.length&&e.computeNormals(),d?e.boundingSphereRadius=d:e.updateBoundingSphereRadius(),e.worldVertices=[],e.worldVerticesNeedsUpdate=!0,e.worldFaceNormals=[],e.worldFaceNormalsNeedsUpdate=!0,e.uniqueAxes=g?g.slice():null,e.uniqueEdges=[],e.computeEdges(),e}return Object(u.a)(n,[{key:"computeEdges",value:function(){var e=this.faces,t=this.vertices,n=this.uniqueEdges;n.length=0;for(var r=new S,a=0;a!==e.length;a++)for(var i=e[a],o=i.length,s=0;s!==o;s++){var u=(s+1)%o;t[i[s]].vsub(t[i[u]],r),r.normalize();for(var c=!1,l=0;l!==n.length;l++)if(n[l].almostEquals(r)||n[l].almostEquals(r)){c=!0;break}c||n.push(r.clone())}}},{key:"computeNormals",value:function(){this.faceNormals.length=this.faces.length;for(var e=0;e<this.faces.length;e++){for(var t=0;t<this.faces[e].length;t++)if(!this.vertices[this.faces[e][t]])throw new Error("Vertex "+this.faces[e][t]+" not found!");var n=this.faceNormals[e]||new S;this.getFaceNormal(e,n),n.negate(n),this.faceNormals[e]=n;var r=this.vertices[this.faces[e][0]];if(n.dot(r)<0){console.error(".faceNormals["+e+"] = Vec3("+n.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var a=0;a<this.faces[e].length;a++)console.warn(".vertices["+this.faces[e][a]+"] = Vec3("+this.vertices[this.faces[e][a]].toString()+")")}}}},{key:"getFaceNormal",value:function(e,t){var r=this.faces[e],a=this.vertices[r[0]],i=this.vertices[r[1]],o=this.vertices[r[2]];n.computeNormal(a,i,o,t)}},{key:"clipAgainstHull",value:function(e,t,n,r,a,i,o,s,u){for(var c=new S,l=-1,g=-Number.MAX_VALUE,d=0;d<n.faces.length;d++){c.copy(n.faceNormals[d]),a.vmult(c,c);var h=c.dot(i);h>g&&(g=h,l=d)}for(var f=[],p=0;p<n.faces[l].length;p++){var I=n.vertices[n.faces[l][p]],C=new S;C.copy(I),a.vmult(C,C),r.vadd(C,C),f.push(C)}l>=0&&this.clipFaceAgainstHull(i,e,t,f,o,s,u)}},{key:"findSeparatingAxis",value:function(e,t,n,r,a,i,o,s){var u=new S,c=new S,l=new S,g=new S,d=new S,h=new S,f=Number.MAX_VALUE,p=this;if(p.uniqueAxes)for(var I=0;I!==p.uniqueAxes.length;I++){n.vmult(p.uniqueAxes[I],u);var C=p.testSepAxis(u,e,t,n,r,a);if(!1===C)return!1;C<f&&(f=C,i.copy(u))}else for(var m=o?o.length:p.faces.length,b=0;b<m;b++){var v=o?o[b]:b;u.copy(p.faceNormals[v]),n.vmult(u,u);var A=p.testSepAxis(u,e,t,n,r,a);if(!1===A)return!1;A<f&&(f=A,i.copy(u))}if(e.uniqueAxes)for(var y=0;y!==e.uniqueAxes.length;y++){a.vmult(e.uniqueAxes[y],c);var w=p.testSepAxis(c,e,t,n,r,a);if(!1===w)return!1;w<f&&(f=w,i.copy(c))}else for(var G=s?s.length:e.faces.length,B=0;B<G;B++){var x=s?s[B]:B;c.copy(e.faceNormals[x]),a.vmult(c,c);var k=p.testSepAxis(c,e,t,n,r,a);if(!1===k)return!1;k<f&&(f=k,i.copy(c))}for(var Z=0;Z!==p.uniqueEdges.length;Z++){n.vmult(p.uniqueEdges[Z],g);for(var R=0;R!==e.uniqueEdges.length;R++)if(a.vmult(e.uniqueEdges[R],d),g.cross(d,h),!h.almostZero()){h.normalize();var N=p.testSepAxis(h,e,t,n,r,a);if(!1===N)return!1;N<f&&(f=N,i.copy(h))}}return r.vsub(t,l),l.dot(i)>0&&i.negate(i),!0}},{key:"testSepAxis",value:function(e,t,r,a,i,o){n.project(this,e,r,a,H),n.project(t,e,i,o,Y);var s=H[0],u=H[1],c=Y[0],l=Y[1];if(s<l||c<u)return!1;var g=s-l,d=c-u;return g<d?g:d}},{key:"calculateLocalInertia",value:function(e,t){var n=new S,r=new S;this.computeLocalAABB(r,n);var a=n.x-r.x,i=n.y-r.y,o=n.z-r.z;t.x=1/12*e*(2*i*2*i+2*o*2*o),t.y=1/12*e*(2*a*2*a+2*o*2*o),t.z=1/12*e*(2*i*2*i+2*a*2*a)}},{key:"getPlaneConstantOfFace",value:function(e){var t=this.faces[e],n=this.faceNormals[e],r=this.vertices[t[0]];return-n.dot(r)}},{key:"clipFaceAgainstHull",value:function(e,t,n,r,a,i,o){for(var s=new S,u=new S,c=new S,l=new S,g=new S,d=new S,h=new S,f=new S,p=this,I=r,C=[],m=-1,b=Number.MAX_VALUE,v=0;v<p.faces.length;v++){s.copy(p.faceNormals[v]),n.vmult(s,s);var A=s.dot(e);A<b&&(b=A,m=v)}if(!(m<0)){var y=p.faces[m];y.connectedFaces=[];for(var w=0;w<p.faces.length;w++)for(var G=0;G<p.faces[w].length;G++)-1!==y.indexOf(p.faces[w][G])&&w!==m&&-1===y.connectedFaces.indexOf(w)&&y.connectedFaces.push(w);for(var B=y.length,x=0;x<B;x++){var k=p.vertices[y[x]],Z=p.vertices[y[(x+1)%B]];k.vsub(Z,u),c.copy(u),n.vmult(c,c),t.vadd(c,c),l.copy(this.faceNormals[m]),n.vmult(l,l),t.vadd(l,l),c.cross(l,g),g.negate(g),d.copy(k),n.vmult(d,d),t.vadd(d,d);var R=y.connectedFaces[x];h.copy(this.faceNormals[R]);var N=this.getPlaneConstantOfFace(R);f.copy(h),n.vmult(f,f);var O=N-f.dot(t);for(this.clipFaceAgainstPlane(I,C,f,O);I.length;)I.shift();for(;C.length;)I.push(C.shift())}h.copy(this.faceNormals[m]);var W=this.getPlaneConstantOfFace(m);f.copy(h),n.vmult(f,f);for(var F=W-f.dot(t),M=0;M<I.length;M++){var V=f.dot(I[M])+F;if(V<=a&&(console.log("clamped: depth="+V+" to minDist="+a),V=a),V<=i){var T=I[M];if(V<=1e-6){var E={point:T,normal:f,depth:V};o.push(E)}}}}}},{key:"clipFaceAgainstPlane",value:function(e,t,n,r){var a,i,o=e.length;if(o<2)return t;var s=e[e.length-1],u=e[0];a=n.dot(s)+r;for(var c=0;c<o;c++){if(u=e[c],i=n.dot(u)+r,a<0)if(i<0){var l=new S;l.copy(u),t.push(l)}else{var g=new S;s.lerp(u,a/(a-i),g),t.push(g)}else if(i<0){var d=new S;s.lerp(u,a/(a-i),d),t.push(d),t.push(u)}s=u,a=i}return t}},{key:"computeWorldVertices",value:function(e,t){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new S);for(var n=this.vertices,r=this.worldVertices,a=0;a!==this.vertices.length;a++)t.vmult(n[a],r[a]),e.vadd(r[a],r[a]);this.worldVerticesNeedsUpdate=!1}},{key:"computeLocalAABB",value:function(e,t){var n=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0;r<this.vertices.length;r++){var a=n[r];a.x<e.x?e.x=a.x:a.x>t.x&&(t.x=a.x),a.y<e.y?e.y=a.y:a.y>t.y&&(t.y=a.y),a.z<e.z?e.z=a.z:a.z>t.z&&(t.z=a.z)}}},{key:"computeWorldFaceNormals",value:function(e){for(var t=this.faceNormals.length;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new S);for(var n=this.faceNormals,r=this.worldFaceNormals,a=0;a!==t;a++)e.vmult(n[a],r[a]);this.worldFaceNormalsNeedsUpdate=!1}},{key:"updateBoundingSphereRadius",value:function(){for(var e=0,t=this.vertices,n=0;n!==t.length;n++){var r=t[n].lengthSquared();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)}},{key:"calculateWorldAABB",value:function(e,t,n,r){for(var a,i,o,s,u,c,l=this.vertices,g=new S,d=0;d<l.length;d++){g.copy(l[d]),t.vmult(g,g),e.vadd(g,g);var h=g;(void 0===a||h.x<a)&&(a=h.x),(void 0===s||h.x>s)&&(s=h.x),(void 0===i||h.y<i)&&(i=h.y),(void 0===u||h.y>u)&&(u=h.y),(void 0===o||h.z<o)&&(o=h.z),(void 0===c||h.z>c)&&(c=h.z)}n.set(a,i,o),r.set(s,u,c)}},{key:"volume",value:function(){return 4*Math.PI*this.boundingSphereRadius/3}},{key:"getAveragePointLocal",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new S,t=this.vertices,n=0;n<t.length;n++)e.vadd(t[n],e);return e.scale(1/t.length,e),e}},{key:"transformAllPoints",value:function(e,t){var n=this.vertices.length,r=this.vertices;if(t){for(var a=0;a<n;a++){var i=r[a];t.vmult(i,i)}for(var o=0;o<this.faceNormals.length;o++){var s=this.faceNormals[o];t.vmult(s,s)}}if(e)for(var u=0;u<n;u++){var c=r[u];c.vadd(e,c)}}},{key:"pointIsInside",value:function(e){var t=this.vertices,n=this.faces,r=this.faceNormals,a=new S;this.getAveragePointLocal(a);for(var i=0;i<this.faces.length;i++){var o=r[i],s=t[n[i][0]],u=new S;e.vsub(s,u);var c=o.dot(u),l=new S;a.vsub(s,l);var g=o.dot(l);if(c<0&&g>0||c>0&&g<0)return!1}return-1}}],[{key:"computeNormal",value:function(e,t,n,r){var a=new S,i=new S;t.vsub(e,i),n.vsub(t,a),a.cross(i,r),r.isZero()||r.normalize()}},{key:"project",value:function(e,t,n,r,a){var i=e.vertices.length,o=z,s=0,u=0,c=K,l=e.vertices;c.setZero(),j.vectorToLocalFrame(n,r,t,o),j.pointToLocalFrame(n,r,c,c);var g=c.dot(o);u=s=l[0].dot(o);for(var d=1;d<i;d++){var h=l[d].dot(o);h>s&&(s=h),h<u&&(u=h)}if((u-=g)>(s-=g)){var f=u;u=s,s=f}a[0]=s,a[1]=u}}]),n}(E),H=[],Y=[],z=new S,K=new S,_=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,{type:E.types.BOX})).halfExtents=void 0,r.convexPolyhedronRepresentation=void 0,r.halfExtents=e,r.convexPolyhedronRepresentation=null,r.updateConvexPolyhedronRepresentation(),r.updateBoundingSphereRadius(),r}return Object(u.a)(n,[{key:"updateConvexPolyhedronRepresentation",value:function(){var e=this.halfExtents.x,t=this.halfExtents.y,n=this.halfExtents.z,r=S,a=[new r(-e,-t,-n),new r(e,-t,-n),new r(e,t,-n),new r(-e,t,-n),new r(-e,-t,n),new r(e,-t,n),new r(e,t,n),new r(-e,t,n)],i=[new r(0,0,1),new r(0,1,0),new r(1,0,0)],o=new X({vertices:a,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:i});this.convexPolyhedronRepresentation=o,o.material=this.material}},{key:"calculateLocalInertia",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return n.calculateInertia(this.halfExtents,e,t),t}},{key:"getSideNormals",value:function(e,t){var n=e,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==t)for(var a=0;a!==n.length;a++)t.vmult(n[a],n[a]);return n}},{key:"volume",value:function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}},{key:"updateBoundingSphereRadius",value:function(){this.boundingSphereRadius=this.halfExtents.length()}},{key:"forEachWorldCorner",value:function(e,t,n){for(var r=this.halfExtents,a=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]],i=0;i<a.length;i++)D.set(a[i][0],a[i][1],a[i][2]),t.vmult(D,D),e.vadd(D,D),n(D.x,D.y,D.z)}},{key:"calculateWorldAABB",value:function(e,t,n,r){var a=this.halfExtents;P[0].set(a.x,a.y,a.z),P[1].set(-a.x,a.y,a.z),P[2].set(-a.x,-a.y,a.z),P[3].set(-a.x,-a.y,-a.z),P[4].set(a.x,-a.y,-a.z),P[5].set(a.x,a.y,-a.z),P[6].set(-a.x,a.y,-a.z),P[7].set(a.x,-a.y,a.z);var i=P[0];t.vmult(i,i),e.vadd(i,i),r.copy(i),n.copy(i);for(var o=1;o<8;o++){var s=P[o];t.vmult(s,s),e.vadd(s,s);var u=s.x,c=s.y,l=s.z;u>r.x&&(r.x=u),c>r.y&&(r.y=c),l>r.z&&(r.z=l),u<n.x&&(n.x=u),c<n.y&&(n.y=c),l<n.z&&(n.z=l)}}}],[{key:"calculateInertia",value:function(e,t,n){var r=e;n.x=1/12*t*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*t*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*t*(2*r.y*2*r.y+2*r.x*2*r.x)}}]),n}(E),D=new S,P=[new S,new S,new S,new S,new S,new S,new S,new S],U=1,J=2,Q=4,q=0,$=1,ee=2,te=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,n),(e=t.call(this)).id=void 0,e.index=void 0,e.world=void 0,e.preStep=void 0,e.postStep=void 0,e.vlambda=void 0,e.collisionFilterGroup=void 0,e.collisionFilterMask=void 0,e.collisionResponse=void 0,e.position=void 0,e.previousPosition=void 0,e.interpolatedPosition=void 0,e.initPosition=void 0,e.velocity=void 0,e.initVelocity=void 0,e.force=void 0,e.mass=void 0,e.invMass=void 0,e.material=void 0,e.linearDamping=void 0,e.type=void 0,e.allowSleep=void 0,e.sleepState=void 0,e.sleepSpeedLimit=void 0,e.sleepTimeLimit=void 0,e.timeLastSleepy=void 0,e.wakeUpAfterNarrowphase=void 0,e.torque=void 0,e.quaternion=void 0,e.initQuaternion=void 0,e.previousQuaternion=void 0,e.interpolatedQuaternion=void 0,e.angularVelocity=void 0,e.initAngularVelocity=void 0,e.shapes=void 0,e.shapeOffsets=void 0,e.shapeOrientations=void 0,e.inertia=void 0,e.invInertia=void 0,e.invInertiaWorld=void 0,e.invMassSolve=void 0,e.invInertiaSolve=void 0,e.invInertiaWorldSolve=void 0,e.fixedRotation=void 0,e.angularDamping=void 0,e.linearFactor=void 0,e.angularFactor=void 0,e.aabb=void 0,e.aabbNeedsUpdate=void 0,e.boundingRadius=void 0,e.wlambda=void 0,e.isTrigger=void 0,e.id=n.idCounter++,e.index=-1,e.world=null,e.preStep=null,e.postStep=null,e.vlambda=new S,e.collisionFilterGroup="number"===typeof r.collisionFilterGroup?r.collisionFilterGroup:1,e.collisionFilterMask="number"===typeof r.collisionFilterMask?r.collisionFilterMask:-1,e.collisionResponse="boolean"!==typeof r.collisionResponse||r.collisionResponse,e.position=new S,e.previousPosition=new S,e.interpolatedPosition=new S,e.initPosition=new S,r.position&&(e.position.copy(r.position),e.previousPosition.copy(r.position),e.interpolatedPosition.copy(r.position),e.initPosition.copy(r.position)),e.velocity=new S,r.velocity&&e.velocity.copy(r.velocity),e.initVelocity=new S,e.force=new S;var a="number"===typeof r.mass?r.mass:0;return e.mass=a,e.invMass=a>0?1/a:0,e.material=r.material||null,e.linearDamping="number"===typeof r.linearDamping?r.linearDamping:.01,e.type=a<=0?n.STATIC:n.DYNAMIC,typeof r.type===typeof n.STATIC&&(e.type=r.type),e.allowSleep="undefined"===typeof r.allowSleep||r.allowSleep,e.sleepState=n.AWAKE,e.sleepSpeedLimit="undefined"!==typeof r.sleepSpeedLimit?r.sleepSpeedLimit:.1,e.sleepTimeLimit="undefined"!==typeof r.sleepTimeLimit?r.sleepTimeLimit:1,e.timeLastSleepy=0,e.wakeUpAfterNarrowphase=!1,e.torque=new S,e.quaternion=new M,e.initQuaternion=new M,e.previousQuaternion=new M,e.interpolatedQuaternion=new M,r.quaternion&&(e.quaternion.copy(r.quaternion),e.initQuaternion.copy(r.quaternion),e.previousQuaternion.copy(r.quaternion),e.interpolatedQuaternion.copy(r.quaternion)),e.angularVelocity=new S,r.angularVelocity&&e.angularVelocity.copy(r.angularVelocity),e.initAngularVelocity=new S,e.shapes=[],e.shapeOffsets=[],e.shapeOrientations=[],e.inertia=new S,e.invInertia=new S,e.invInertiaWorld=new B,e.invMassSolve=0,e.invInertiaSolve=new S,e.invInertiaWorldSolve=new B,e.fixedRotation="undefined"!==typeof r.fixedRotation&&r.fixedRotation,e.angularDamping="undefined"!==typeof r.angularDamping?r.angularDamping:.01,e.linearFactor=new S(1,1,1),r.linearFactor&&e.linearFactor.copy(r.linearFactor),e.angularFactor=new S(1,1,1),r.angularFactor&&e.angularFactor.copy(r.angularFactor),e.aabb=new N,e.aabbNeedsUpdate=!0,e.boundingRadius=0,e.wlambda=new S,e.isTrigger=Boolean(r.isTrigger),r.shape&&e.addShape(r.shape),e.updateMassProperties(),e}return Object(u.a)(n,[{key:"wakeUp",value:function(){var e=this.sleepState;this.sleepState=n.AWAKE,this.wakeUpAfterNarrowphase=!1,e===n.SLEEPING&&this.dispatchEvent(n.wakeupEvent)}},{key:"sleep",value:function(){this.sleepState=n.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}},{key:"sleepTick",value:function(e){if(this.allowSleep){var t=this.sleepState,r=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),a=Math.pow(this.sleepSpeedLimit,2);t===n.AWAKE&&r<a?(this.sleepState=n.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(n.sleepyEvent)):t===n.SLEEPY&&r>a?this.wakeUp():t===n.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(n.sleepEvent))}}},{key:"updateSolveMassProperties",value:function(){this.sleepState===n.SLEEPING||this.type===n.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}},{key:"pointToLocalFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t}},{key:"vectorToLocalFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return this.quaternion.conjugate().vmult(e,t),t}},{key:"pointToWorldFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return this.quaternion.vmult(e,t),t.vadd(this.position,t),t}},{key:"vectorToWorldFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;return this.quaternion.vmult(e,t),t}},{key:"addShape",value:function(e,t,n){var r=new S,a=new M;return t&&r.copy(t),n&&a.copy(n),this.shapes.push(e),this.shapeOffsets.push(r),this.shapeOrientations.push(a),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=this,this}},{key:"removeShape",value:function(e){var t=this.shapes.indexOf(e);return-1===t?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(t,1),this.shapeOffsets.splice(t,1),this.shapeOrientations.splice(t,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,e.body=null,this)}},{key:"updateBoundingRadius",value:function(){for(var e=this.shapes,t=this.shapeOffsets,n=e.length,r=0,a=0;a!==n;a++){var i=e[a];i.updateBoundingSphereRadius();var o=t[a].length(),s=i.boundingSphereRadius;o+s>r&&(r=o+s)}this.boundingRadius=r}},{key:"updateAABB",value:function(){for(var e=this.shapes,t=this.shapeOffsets,n=this.shapeOrientations,r=e.length,a=ne,i=re,o=this.quaternion,s=this.aabb,u=ae,c=0;c!==r;c++){var l=e[c];o.vmult(t[c],a),a.vadd(this.position,a),o.mult(n[c],i),l.calculateWorldAABB(a,i,u.lowerBound,u.upperBound),0===c?s.copy(u):s.extend(u)}this.aabbNeedsUpdate=!1}},{key:"updateInertiaWorld",value:function(e){var t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){var n=ie,r=oe;n.setRotationFromQuaternion(this.quaternion),n.transpose(r),n.scale(t,n),n.mmult(r,this.invInertiaWorld)}else;}},{key:"applyForce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;if(this.type===n.DYNAMIC){this.sleepState===n.SLEEPING&&this.wakeUp();var r=se;t.cross(e,r),this.force.vadd(e,this.force),this.torque.vadd(r,this.torque)}}},{key:"applyLocalForce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;if(this.type===n.DYNAMIC){var r=ue,a=ce;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,a),this.applyForce(r,a)}}},{key:"applyTorque",value:function(e){this.type===n.DYNAMIC&&(this.sleepState===n.SLEEPING&&this.wakeUp(),this.torque.vadd(e,this.torque))}},{key:"applyImpulse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;if(this.type===n.DYNAMIC){this.sleepState===n.SLEEPING&&this.wakeUp();var r=t,a=le;a.copy(e),a.scale(this.invMass,a),this.velocity.vadd(a,this.velocity);var i=ge;r.cross(e,i),this.invInertiaWorld.vmult(i,i),this.angularVelocity.vadd(i,this.angularVelocity)}}},{key:"applyLocalImpulse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;if(this.type===n.DYNAMIC){var r=de,a=he;this.vectorToWorldFrame(e,r),this.vectorToWorldFrame(t,a),this.applyImpulse(r,a)}}},{key:"updateMassProperties",value:function(){var e=fe;this.invMass=this.mass>0?1/this.mass:0;var t=this.inertia,n=this.fixedRotation;this.updateAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),_.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!n?1/t.x:0,t.y>0&&!n?1/t.y:0,t.z>0&&!n?1/t.z:0),this.updateInertiaWorld(!0)}},{key:"getVelocityAtWorldPoint",value:function(e,t){var n=new S;return e.vsub(this.position,n),this.angularVelocity.cross(n,t),this.velocity.vadd(t,t),t}},{key:"integrate",value:function(e,t,r){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),(this.type===n.DYNAMIC||this.type===n.KINEMATIC)&&this.sleepState!==n.SLEEPING){var a=this.velocity,i=this.angularVelocity,o=this.position,s=this.force,u=this.torque,c=this.quaternion,l=this.invMass,g=this.invInertiaWorld,d=this.linearFactor,h=l*e;a.x+=s.x*h*d.x,a.y+=s.y*h*d.y,a.z+=s.z*h*d.z;var f=g.elements,p=this.angularFactor,I=u.x*p.x,C=u.y*p.y,m=u.z*p.z;i.x+=e*(f[0]*I+f[1]*C+f[2]*m),i.y+=e*(f[3]*I+f[4]*C+f[5]*m),i.z+=e*(f[6]*I+f[7]*C+f[8]*m),o.x+=a.x*e,o.y+=a.y*e,o.z+=a.z*e,c.integrate(this.angularVelocity,e,this.angularFactor,c),t&&(r?c.normalizeFast():c.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}}]),n}(F);te.idCounter=0,te.COLLIDE_EVENT_NAME="collide",te.DYNAMIC=U,te.STATIC=J,te.KINEMATIC=Q,te.AWAKE=q,te.SLEEPY=$,te.SLEEPING=ee,te.wakeupEvent={type:"wakeup"},te.sleepyEvent={type:"sleepy"},te.sleepEvent={type:"sleep"};var ne=new S,re=new M,ae=new N,ie=new B,oe=new B,se=new S,ue=new S,ce=new S,le=new S,ge=new S,de=new S,he=new S,fe=new S;new S,new S;var pe,Ie,Ce,me,be,ve,Ae,ye=function(){function e(){Object(s.a)(this,e),this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new S,this.rayToWorld=new S,this.hitNormalWorld=new S,this.hitPointWorld=new S,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}return Object(u.a)(e,[{key:"reset",value:function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}},{key:"abort",value:function(){this.shouldStop=!0}},{key:"set",value:function(e,t,n,r,a,i,o){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=a,this.body=i,this.distance=o}}]),e}(),we=1,Ge=2,Be=4;pe=E.types.SPHERE,Ie=E.types.PLANE,Ce=E.types.BOX,me=E.types.CYLINDER,be=E.types.CONVEXPOLYHEDRON,ve=E.types.HEIGHTFIELD,Ae=E.types.TRIMESH;var xe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new S,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new S;Object(s.a)(this,e),this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=t.clone(),this.to=n.clone(),this.direction=new S,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=e.ANY,this.result=new ye,this.hasHit=!1,this.callback=function(e){}}return Object(u.a)(e,[{key:pe,get:function(){return this._intersectSphere}},{key:Ie,get:function(){return this._intersectPlane}},{key:Ce,get:function(){return this._intersectBox}},{key:me,get:function(){return this._intersectConvex}},{key:be,get:function(){return this._intersectConvex}},{key:ve,get:function(){return this._intersectHeightfield}},{key:Ae,get:function(){return this._intersectTrimesh}},{key:"intersectWorld",value:function(t,n){return this.mode=n.mode||e.ANY,this.result=n.result||new ye,this.skipBackfaces=!!n.skipBackfaces,this.collisionFilterMask="undefined"!==typeof n.collisionFilterMask?n.collisionFilterMask:-1,this.collisionFilterGroup="undefined"!==typeof n.collisionFilterGroup?n.collisionFilterGroup:-1,this.checkCollisionResponse="undefined"===typeof n.checkCollisionResponse||n.checkCollisionResponse,n.from&&this.from.copy(n.from),n.to&&this.to.copy(n.to),this.callback=n.callback||function(){},this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Se),ke.length=0,t.broadphase.aabbQuery(t,Se,ke),this.intersectBodies(ke),this.hasHit}},{key:"intersectBody",value:function(e,t){t&&(this.result=t,this.updateDirection());var n=this.checkCollisionResponse;if((!n||e.collisionResponse)&&0!==(this.collisionFilterGroup&e.collisionFilterMask)&&0!==(e.collisionFilterGroup&this.collisionFilterMask))for(var r=Ne,a=Oe,i=0,o=e.shapes.length;i<o;i++){var s=e.shapes[i];if((!n||s.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[i],a),e.quaternion.vmult(e.shapeOffsets[i],r),r.vadd(e.position,r),this.intersectShape(s,a,r,e),this.result.shouldStop))break}}},{key:"intersectBodies",value:function(e,t){t&&(this.result=t,this.updateDirection());for(var n=0,r=e.length;!this.result.shouldStop&&n<r;n++)this.intersectBody(e[n])}},{key:"updateDirection",value:function(){this.to.vsub(this.from,this.direction),this.direction.normalize()}},{key:"intersectShape",value:function(e,t,n,r){if(!(function(e,t,n){n.vsub(e,$e);var r=$e.dot(t);return t.scale(r,et),et.vadd(e,et),n.distanceTo(et)}(this.from,this.direction,n)>e.boundingSphereRadius)){var a=this[e.type];a&&a.call(this,e,t,n,r,e)}}},{key:"_intersectBox",value:function(e,t,n,r,a){return this._intersectConvex(e.convexPolyhedronRepresentation,t,n,r,a)}},{key:"_intersectPlane",value:function(e,t,n,r,a){var i=this.from,o=this.to,s=this.direction,u=new S(0,0,1);t.vmult(u,u);var c=new S;i.vsub(n,c);var l=c.dot(u);if(o.vsub(n,c),!(l*c.dot(u)>0)&&!(i.distanceTo(o)<l)){var g=u.dot(s);if(!(Math.abs(g)<this.precision)){var d=new S,h=new S,f=new S;i.vsub(n,d);var p=-u.dot(d)/g;s.scale(p,h),i.vadd(h,f),this.reportIntersection(u,f,a,r,-1)}}}},{key:"getAABB",value:function(e){var t=e.lowerBound,n=e.upperBound,r=this.to,a=this.from;t.x=Math.min(r.x,a.x),t.y=Math.min(r.y,a.y),t.z=Math.min(r.z,a.z),n.x=Math.max(r.x,a.x),n.y=Math.max(r.y,a.y),n.z=Math.max(r.z,a.z)}},{key:"_intersectHeightfield",value:function(e,t,n,r,a){e.data,e.elementSize;var i=je;i.from.copy(this.from),i.to.copy(this.to),j.pointToLocalFrame(n,t,i.from,i.from),j.pointToLocalFrame(n,t,i.to,i.to),i.updateDirection();var o,s,u,c,l=Le;o=s=0,u=c=e.data.length-1;var g=new N;i.getAABB(g),e.getIndexOfPosition(g.lowerBound.x,g.lowerBound.y,l,!0),o=Math.max(o,l[0]),s=Math.max(s,l[1]),e.getIndexOfPosition(g.upperBound.x,g.upperBound.y,l,!0),u=Math.min(u,l[0]+1),c=Math.min(c,l[1]+1);for(var d=o;d<u;d++)for(var h=s;h<c;h++){if(this.result.shouldStop)return;if(e.getAabbAtIndex(d,h,g),g.overlapsRay(i)){if(e.getConvexTrianglePillar(d,h,!1),j.pointToWorldFrame(n,t,e.pillarOffset,Ee),this._intersectConvex(e.pillarConvex,t,Ee,r,a,Te),this.result.shouldStop)return;e.getConvexTrianglePillar(d,h,!0),j.pointToWorldFrame(n,t,e.pillarOffset,Ee),this._intersectConvex(e.pillarConvex,t,Ee,r,a,Te)}}}},{key:"_intersectSphere",value:function(e,t,n,r,a){var i=this.from,o=this.to,s=e.radius,u=Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)+Math.pow(o.z-i.z,2),c=2*((o.x-i.x)*(i.x-n.x)+(o.y-i.y)*(i.y-n.y)+(o.z-i.z)*(i.z-n.z)),l=Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)+Math.pow(i.z-n.z,2)-Math.pow(s,2),g=Math.pow(c,2)-4*u*l,d=Xe,h=He;if(!(g<0))if(0===g)i.lerp(o,g,d),d.vsub(n,h),h.normalize(),this.reportIntersection(h,d,a,r,-1);else{var f=(-c-Math.sqrt(g))/(2*u),p=(-c+Math.sqrt(g))/(2*u);if(f>=0&&f<=1&&(i.lerp(o,f,d),d.vsub(n,h),h.normalize(),this.reportIntersection(h,d,a,r,-1)),this.result.shouldStop)return;p>=0&&p<=1&&(i.lerp(o,p,d),d.vsub(n,h),h.normalize(),this.reportIntersection(h,d,a,r,-1))}}},{key:"_intersectConvex",value:function(t,n,r,a,i,o){for(var s=Ye,u=ze,c=o&&o.faceList||null,l=t.faces,g=t.vertices,d=t.faceNormals,h=this.direction,f=this.from,p=this.to,I=f.distanceTo(p),C=c?c.length:l.length,m=this.result,b=0;!m.shouldStop&&b<C;b++){var v=c?c[b]:b,A=l[v],y=d[v],w=n,G=r;u.copy(g[A[0]]),w.vmult(u,u),u.vadd(G,u),u.vsub(f,u),w.vmult(y,s);var B=h.dot(s);if(!(Math.abs(B)<this.precision)){var x=s.dot(u)/B;if(!(x<0)){h.scale(x,We),We.vadd(f,We),Fe.copy(g[A[0]]),w.vmult(Fe,Fe),G.vadd(Fe,Fe);for(var S=1;!m.shouldStop&&S<A.length-1;S++){Me.copy(g[A[S]]),Ve.copy(g[A[S+1]]),w.vmult(Me,Me),w.vmult(Ve,Ve),G.vadd(Me,Me),G.vadd(Ve,Ve);var k=We.distanceTo(f);!e.pointInTriangle(We,Fe,Me,Ve)&&!e.pointInTriangle(We,Me,Fe,Ve)||k>I||this.reportIntersection(s,We,i,a,v)}}}}}},{key:"_intersectTrimesh",value:function(t,n,r,a,i,o){var s=Ke,u=Qe,c=qe,l=ze,g=_e,d=De,h=Pe,f=Je,p=Ue,I=t.indices;t.vertices;var C=this.from,m=this.to,b=this.direction;c.position.copy(r),c.quaternion.copy(n),j.vectorToLocalFrame(r,n,b,g),j.pointToLocalFrame(r,n,C,d),j.pointToLocalFrame(r,n,m,h),h.x*=t.scale.x,h.y*=t.scale.y,h.z*=t.scale.z,d.x*=t.scale.x,d.y*=t.scale.y,d.z*=t.scale.z,h.vsub(d,g),g.normalize();var v=d.distanceSquared(h);t.tree.rayQuery(this,c,u);for(var A=0,y=u.length;!this.result.shouldStop&&A!==y;A++){var w=u[A];t.getNormal(w,s),t.getVertex(I[3*w],Fe),Fe.vsub(d,l);var G=g.dot(s),B=s.dot(l)/G;if(!(B<0)){g.scale(B,We),We.vadd(d,We),t.getVertex(I[3*w+1],Me),t.getVertex(I[3*w+2],Ve);var x=We.distanceSquared(d);!e.pointInTriangle(We,Me,Fe,Ve)&&!e.pointInTriangle(We,Fe,Me,Ve)||x>v||(j.vectorToWorldFrame(n,s,p),j.pointToWorldFrame(r,n,We,f),this.reportIntersection(p,f,i,a,w))}}u.length=0}},{key:"reportIntersection",value:function(t,n,r,a,i){var o=this.from,s=this.to,u=o.distanceTo(n),c=this.result;if(!(this.skipBackfaces&&t.dot(this.direction)>0))switch(c.hitFaceIndex="undefined"!==typeof i?i:-1,this.mode){case e.ALL:this.hasHit=!0,c.set(o,s,t,n,r,a,u),c.hasHit=!0,this.callback(c);break;case e.CLOSEST:(u<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,s,t,n,r,a,u));break;case e.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,s,t,n,r,a,u),c.shouldStop=!0}}}],[{key:"pointInTriangle",value:function(e,t,n,r){r.vsub(t,$e),n.vsub(t,Ze),e.vsub(t,Re);var a,i,o=$e.dot($e),s=$e.dot(Ze),u=$e.dot(Re),c=Ze.dot(Ze),l=Ze.dot(Re);return(a=c*u-s*l)>=0&&(i=o*l-s*u)>=0&&a+i<o*c-s*s}}]),e}();xe.CLOSEST=we,xe.ANY=Ge,xe.ALL=Be;var Se=new N,ke=[],Ze=new S,Re=new S,Ne=new S,Oe=new M,We=new S,Fe=new S,Me=new S,Ve=new S,Te={faceList:[0]},Ee=new S,je=new xe,Le=[],Xe=new S,He=new S,Ye=new S,ze=new S,Ke=new S,_e=new S,De=new S,Pe=new S,Ue=new S,Je=new S;new N;var Qe=[],qe=new j,$e=new S,et=new S;new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S;var tt=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e),this.name=void 0,this.id=void 0,this.friction=void 0,this.restitution=void 0;var n="";"string"===typeof t&&(n=t,t={}),this.name=n,this.id=e.idCounter++,this.friction="undefined"!==typeof t.friction?t.friction:-1,this.restitution="undefined"!==typeof t.restitution?t.restitution:-1};tt.idCounter=0,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new xe,new S,new S,new S(1,0,0),new S(0,1,0),new S(0,0,1),new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S;new S,new S,new S,new S,new S,new S,new S,new S,new S;new S,new S,new S,new S,new S,new S,new S,new S,new S,new S;new S,new N,new S,new N,new S,new S,new S,new S,new S,new S,new S,new N,new S,new j,new N;E.types.SPHERE,E.types.SPHERE,E.types.PLANE,E.types.BOX,E.types.BOX,E.types.SPHERE,E.types.BOX,E.types.PLANE,E.types.BOX,E.types.CONVEXPOLYHEDRON,E.types.SPHERE,E.types.CONVEXPOLYHEDRON,E.types.PLANE,E.types.CONVEXPOLYHEDRON,E.types.BOX,E.types.CONVEXPOLYHEDRON,E.types.SPHERE,E.types.HEIGHTFIELD,E.types.BOX,E.types.HEIGHTFIELD,E.types.CONVEXPOLYHEDRON,E.types.HEIGHTFIELD,E.types.PARTICLE,E.types.SPHERE,E.types.PLANE,E.types.PARTICLE,E.types.BOX,E.types.PARTICLE,E.types.PARTICLE,E.types.CONVEXPOLYHEDRON,E.types.CYLINDER,E.types.SPHERE,E.types.CYLINDER,E.types.PLANE,E.types.CYLINDER,E.types.BOX,E.types.CYLINDER,E.types.CONVEXPOLYHEDRON,E.types.CYLINDER,E.types.HEIGHTFIELD,E.types.CYLINDER,E.types.PARTICLE,E.types.CYLINDER,E.types.SPHERE,E.types.TRIMESH,E.types.PLANE,E.types.TRIMESH,new S,new S,new S,new S,new S,new M,new M,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new N,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new S,new M,new S,new S,new S,new S,new S,new S,new S,new S,new N,new xe;var nt=globalThis.performance||{};if(!nt.now){var rt=Date.now();nt.timing&&nt.timing.navigationStart&&(rt=nt.timing.navigationStart),nt.now=function(){return Date.now()-rt}}new f.Vector3,new f.Vector3(1,1,1),new f.Quaternion;var at=new f.Object3D;function it(e,t){return e+t.charAt(0).toUpperCase()+t.slice(1)}function ot(e,t){return void 0!==t?"".concat(e.current.uuid,"/").concat(t):e.current.uuid}function st(e,t,n,r,a){return e.current&&t.postMessage({op:n,uuid:ot(e,r),props:a})}function ut(e,t,n,r,a,i){return function(o){var s=gt++;return n[s]=o,st(e,t,"subscribe",a,{id:s,type:r,target:void 0===i||null===i?"bodies":i}),function(){delete n[s],t.postMessage({op:"unsubscribe",props:s})}}}function ct(e,t){var n,r;e.userData=t.userData||{},(n=e.position).set.apply(n,Object(a.a)(t.position||[0,0,0])),(r=e.rotation).set.apply(r,Object(a.a)(t.rotation||[0,0,0])),e.updateMatrix()}function lt(e,t,n){var r=t.onCollide,a=t.onCollideBegin,i=t.onCollideEnd;(r||a||i)&&(e[n]=function(e){switch(e.type){case"collide":r&&r(e);break;case"collideBegin":a&&a(e);break;case"collideEnd":i&&i(e)}})}var gt=0;function dt(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=Object(g.useRef)(null),s=a||o,u=Object(g.useContext)(p),l=u.worker,d=u.refs,h=u.events,C=u.subscriptions,m=Object(g.useContext)(I);Object(g.useLayoutEffect)((function(){s.current||(s.current=new f.Object3D);var a=s.current,i=l,o=a instanceof f.InstancedMesh?(a.instanceMatrix.setUsage(f.DynamicDrawUsage),a.count):1,u=a instanceof f.InstancedMesh?new Array(o).fill(0).map((function(e,t){return"".concat(a.uuid,"/").concat(t)})):[a.uuid],g=a instanceof f.InstancedMesh?u.map((function(r,i){var o=t(i);return ct(at,o),a.setMatrixAt(i,at.matrix),a.instanceMatrix.needsUpdate=!0,d[r]=a,m&&m.add(r,o,e),lt(h,o,r),Object(c.a)(Object(c.a)({},o),{},{args:n(o.args)})})):u.map((function(r,i){var o=t(i);return ct(a,o),d[r]=a,m&&m.add(r,o,e),lt(h,o,r),Object(c.a)(Object(c.a)({},o),{},{args:n(o.args)})}));return i.postMessage({op:"addBodies",type:e,uuid:u,props:g.map((function(e){var t=e.onCollide,n=(e.onCollideBegin,e.onCollideEnd,Object(r.a)(e,["onCollide","onCollideBegin","onCollideEnd"]));return Object(c.a)({onCollide:Boolean(t)},n)}))}),function(){u.forEach((function(e){delete d[e],m&&m.remove(e),delete h[e]})),i.postMessage({op:"removeBodies",uuid:u})}}),i);var b=Object(g.useMemo)((function(){var e=function(e,t){return{set:function(n,r,a){return st(s,l,it("set",e),t,[n,r,a])},copy:function(n){var r=n.x,a=n.y,i=n.z;return st(s,l,it("set",e),t,[r,a,i])},subscribe:ut(s,l,C,e,t)}},t=function(e,t){return{set:function(n){return st(s,l,it("set",e),t,n)},subscribe:ut(s,l,C,e,t)}};function n(n){return{position:e("position",n),rotation:e("quaternion",n),velocity:e("velocity",n),angularVelocity:e("angularVelocity",n),linearFactor:e("linearFactor",n),angularFactor:e("angularFactor",n),mass:t("mass",n),linearDamping:t("linearDamping",n),angularDamping:t("angularDamping",n),allowSleep:t("allowSleep",n),sleepSpeedLimit:t("sleepSpeedLimit",n),sleepTimeLimit:t("sleepTimeLimit",n),collisionFilterGroup:t("collisionFilterGroup",n),collisionFilterMask:t("collisionFilterMask",n),collisionResponse:t("collisionResponse",n),fixedRotation:t("fixedRotation",n),userData:t("userData",n),isTrigger:t("isTrigger",n),applyForce:function(e,t){st(s,l,"applyForce",n,[e,t])},applyImpulse:function(e,t){st(s,l,"applyImpulse",n,[e,t])},applyLocalForce:function(e,t){st(s,l,"applyLocalForce",n,[e,t])},applyLocalImpulse:function(e,t){st(s,l,"applyLocalImpulse",n,[e,t])}}}var r={};return Object(c.a)(Object(c.a)({},n(void 0)),{},{at:function(e){return r[e]||(r[e]=n(e))}})}),[]);return[s,b]}function ht(e,t,n){var r=[1,1,1];return dt("Box",e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;return e}),t,n)}function ft(e,t,n){return dt("Cylinder",e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e}),t,n)}function pt(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=Object(g.useContext)(p),i=a.worker,o=a.events,s=Object(g.useState)((function(){return f.MathUtils.generateUUID()})),u=Object(l.a)(s,1),d=u[0];Object(g.useEffect)((function(){return o[d]=n,i.postMessage({op:"addRay",uuid:d,props:Object(c.a)({mode:e},t)}),function(){i.postMessage({op:"removeRay",uuid:d}),delete o[d]}}),r)}function It(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];pt("Closest",e,t,n)}function Ct(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=t||Object(g.useRef)(null),a=Object(g.useContext)(p),i=a.worker,o=a.subscriptions;Object(g.useLayoutEffect)((function(){var t;r.current||(r.current=new f.Object3D);var n=i,a=[r.current.uuid],o=e();return n.postMessage({op:"addRaycastVehicle",uuid:a,props:[null==(t=o.chassisBody.current)?void 0:t.uuid,o.wheels.map((function(e){var t;return null==(t=e.current)?void 0:t.uuid})),o.wheelInfos,(null==o?void 0:o.indexForwardAxis)||2,(null==o?void 0:o.indexRightAxis)||0,(null==o?void 0:o.indexUpAxis)||1]}),function(){n.postMessage({op:"removeRaycastVehicle",uuid:a})}}),n);var s=Object(g.useMemo)((function(){var e=function(e,t){return r.current&&i.postMessage({op:e,uuid:r.current.uuid,props:t})};return{sliding:{subscribe:ut(r,i,o,"sliding",void 0,"vehicles")},setSteeringValue:function(t,n){e("setRaycastVehicleSteeringValue",[t,n])},applyEngineForce:function(t,n){e("applyRaycastVehicleEngineForce",[t,n])},setBrake:function(t,n){e("setRaycastVehicleBrake",[t,n])}}}),n);return[r,s]}function mt(e){return d.a.createElement(g.Suspense,{fallback:null},d.a.createElement(G,e))}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(409)},,function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({sqrt_:function(e){var t={x:Object(i.a)(e,"x","sqrt")};return r.a.runKernel(a.Oc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a="undefined"!==typeof window?r.useLayoutEffect:r.useEffect;function i(e){var t=r.useRef(e);return a((function(){t.current=e})),r.useCallback((function(){return t.current.apply(void 0,arguments)}),[])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return g}));var r=n(19);function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function s(e,t){return i(e,t.map((function(e){return 1})),t)}function u(e,t,n){r.b(a(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function c(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function l(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function g(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"g",(function(){return A}));var r=n(7),a=n.n(r),i=n(16),o=n(17),s=n(93),u=n(119),c=n(19),l=n(209);function g(e,t){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(a.a.mark((function e(t,n){var r,i,s,u,c,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],i=[],s=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),u=function(e){var u=s[e],c=Array.isArray(t)?t[e].tensor:t[u];if("float32"!==c.dtype&&"int32"!==c.dtype&&"bool"!==c.dtype&&"string"!==c.dtype&&"complex64"!==c.dtype)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c.dtype));var l={name:u,shape:c.shape,dtype:c.dtype};if("string"===c.dtype){var g=new Promise(function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,i,o,s,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,i=new Uint8Array(r),o=0,s=0;s<n.length;s++)u=n[s],l=new Uint8Array(new Uint32Array([u.length]).buffer),i.set(l,o),o+=4,i.set(u,o),o+=u.length;t(i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());i.push(g)}else i.push(c.data());null!=n&&(l.group=n),r.push(l)},c=0;c<s.length;++c)u(c);return e.next=7,Promise.all(i);case 7:return l=e.sent,e.abrupt("return",{data:f(l),specs:r});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t){var n,r,a={},o=0,g=Object(i.a)(t);try{for(g.s();!(r=g.n()).done;){var d=r.value,h=d.name,f=d.dtype,p=d.shape,I=Object(c.O)(p),C=void 0;if("quantization"in d){var m=d.quantization;if("uint8"===m.dtype||"uint16"===m.dtype){if(!("min"in m)||!("scale"in m))throw new Error("Weight ".concat(d.name," with quantization ").concat(m.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==m.dtype)throw new Error("Weight ".concat(d.name," has unknown ")+"quantization dtype ".concat(m.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==f)throw new Error("Weight ".concat(d.name," is quantized with ").concat(m.dtype," ")+"which only supports weights of type float32 not ".concat(f,"."))}var b=l.a[m.dtype],v=e.slice(o,o+I*b),A="uint8"===m.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===f)if("uint8"===m.dtype||"uint16"===m.dtype){C=new Float32Array(A.length);for(var w=0;w<A.length;w++){var G=A[w];C[w]=G*m.scale+m.min}}else{if("float16"!==m.dtype)throw new Error("Unsupported quantization type ".concat(m.dtype," ")+"for weight type float32.");void 0===n&&(n=y()),C=n(A)}else{if("int32"!==f)throw new Error("Unsupported dtype in weight '".concat(h,"': ").concat(f));if("uint8"!==m.dtype&&"uint16"!==m.dtype)throw new Error("Unsupported quantization type ".concat(m.dtype," ")+"for weight type int32.");C=new Int32Array(A.length);for(var B=0;B<A.length;B++){var x=A[B];C[B]=Math.round(x*m.scale+m.min)}}o+=I*b}else if("string"===f){var S=Object(c.O)(d.shape);C=[];for(var k=0;k<S;k++){var Z=new Uint32Array(e.slice(o,o+4))[0];o+=4;var R=new Uint8Array(e.slice(o,o+Z));C.push(R),o+=Z}}else{var N=l.a[f],O=e.slice(o,o+I*N);if("float32"===f)C=new Float32Array(O);else if("int32"===f)C=new Int32Array(O);else if("bool"===f)C=new Uint8Array(O);else{if("complex64"!==f)throw new Error("Unsupported dtype in weight '".concat(h,"': ").concat(f));C=new Float32Array(O);for(var W=new Float32Array(C.length/2),F=new Float32Array(C.length/2),M=0;M<W.length;M++)W[M]=C[2*M],F[M]=C[2*M+1];var V=Object(u.a)(W,p,"float32"),T=Object(u.a)(F,p,"float32");a[h]=Object(s.a)(V,T),V.dispose(),T.dispose()}o+=I*N}"complex64"!==f&&(a[h]=Object(u.a)(C,p,f))}}catch(E){g.e(E)}finally{g.f()}return a}function f(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var p="undefined"!==typeof e&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function I(t){return p?e.byteLength(t):new Blob([t]).size}function C(t){if(p)return e.from(t).toString("base64");for(var n=new Uint8Array(t),r="",a=0,i=n.length;a<i;a++)r+=String.fromCharCode(n[a]);return btoa(r)}function m(t){if(p){var n=e.from(t,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}for(var r=atob(t),a=new Uint8Array(r.length),i=0;i<r.length;++i)a.set([r.charCodeAt(i)],i);return a.buffer}function b(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function v(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function A(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:I(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:I(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function y(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],u=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=u}return new Float32Array(a)}}}).call(this,n(279).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({exp_:function(e){var t={x:Object(i.a)(e,"x","exp")};return r.a.runKernel(a.ab,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({greater_:function(e,t){var n=Object(s.a)(e,"a","greater","string_or_numeric"),c=Object(s.a)(t,"b","greater","string_or_numeric"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.ob,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({abs_:function(e){var t=Object(i.a)(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return r.a.runKernel(a.A,n)}var o={x:t};return r.a.runKernel(a.a,o)}})},function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return C}));var r=n(33),a=n(169),i=n(172),o=n(20),s=n(179),u=n(115),c=n(180),l=n(18),g=n(108),d=n(116),h=n(31);function f(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Object(o.a)(e,Object(d.a)(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function p(e,t){var n=t,a=r.c(e.shape,t.shape);return a.length>0&&(n=Object(h.a)(n,a)),Object(l.a)(n,e.shape)}function I(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Object(u.a)(e);if("elu"===t)return Object(a.a)(e);if("relu6"===t)return Object(c.a)(e);if("prelu"===t)return Object(s.a)(e,n);if("leakyrelu"===t)return Object(i.a)(e,r);if("sigmoid"===t)return Object(g.a)(e);throw new Error("Unknown fused activation ".concat(t,"."))}var C=function(e,t){return!(e>0)||"linear"===t}},function(e,t,n){"use strict";n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"d",(function(){return A})),n.d(t,"g",(function(){return y})),n.d(t,"a",(function(){return G})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return w}));var r=n(16),a=n(12),i=n(13),o=n(7),s=n.n(o),u=n(17),c=n(1),l=n(9),g=n(0),d=n(125),h=n(111);function f(e){return e instanceof g.bd?{value:e.clone(),recurse:!1}:Object(h.e)(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var p=n(23),I=n(22),C=function(){function e(t){if(Object(c.a)(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return Object(l.a)(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=Object(r.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.push(a)}}catch(i){n.e(i)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),m=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){return Object(c.a)(this,n),t.call(this,n.INITIAL_CAPACITY)}return Object(l.a)(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){Object(p.a)(Object(I.a)(n.prototype),"isFull",this).call(this)&&this.expand(),Object(p.a)(Object(I.a)(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){Object(p.a)(Object(I.a)(n.prototype),"isFull",this).call(this)&&this.expand(),Object(p.a)(Object(I.a)(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(C);function b(e){return new B(e)}function v(e){return new x(e)}function A(e,t){return new T(e,t)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.FAIL;return new E(e,t)}m.INITIAL_CAPACITY=32;var w,G=function(){function e(){Object(c.a)(this,e)}return Object(l.a)(e,[{key:"toArray",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new W(this,e)}},{key:"filter",value:function(e){return new N(this,e)}},{key:"map",value:function(e){return new O(this,e)}},{key:"mapAsync",value:function(e){return new F(this,e)}},{key:"serialMapAsync",value:function(e){return new F(this,e).serial()}},{key:"flatmap",value:function(e){return new V(this,e)}},{key:"forEachAsync",value:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new R(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.f,r=this.rowMajorBatch(e,t);return r.map((function(e){return Object(h.d)(e,n)}))}},{key:"concatenate",value:function(e,t){return new T(b([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new Z(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new k(this,e)}},{key:"prefetch",value:function(e){return new j(this,e)}},{key:"shuffle",value:function(e,t){return new L(this,e,t)}},{key:"serial",value:function(){return new S(this)}}]),e}(),B=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).items=e,r.trav=0,r}return Object(l.a)(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:(n=t,Object(h.b)(n,f)),done:!1});case 5:case"end":return e.stop()}var n}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),x=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).nextFn=e,r}return Object(l.a)(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(G),S=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),k=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:g.Pd(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),Z=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),R=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),N=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:g.Pd(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),O=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,i,o,u,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=g.lf.getTensorsInContainer(t.value),a=this.transform(t.value),i=g.lf.getTensorsInContainer(a),o=Object(r.a)(n);try{for(o.s();!(u=o.n()).done;)c=u.value,g.lf.isTensorInList(c,i)||c.dispose()}catch(s){o.e(s)}finally{o.f()}return e.abrupt("return",{value:a,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),W=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(G),F=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,i,o,u,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=g.lf.getTensorsInContainer(t.value),e.next=8,this.transform(t.value);case 8:a=e.sent,i=g.lf.getTensorsInContainer(a),o=Object(r.a)(n);try{for(o.s();!(u=o.n()).done;)c=u.value,g.lf.isTensorInList(c,i)||c.dispose()}catch(s){o.e(s)}finally{o.f()}return e.abrupt("return",{value:a,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),M=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).outputQueue=new m,e.lastRead=Promise.resolve({value:null,done:!1}),e}return Object(l.a)(n,[{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),V=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,a,i,o,u,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=g.lf.getTensorsInContainer(t.value),a=this.transform(t.value),i=g.lf.getTensorsInContainer(a),this.outputQueue.pushAll(a),o=Object(r.a)(n);try{for(o.s();!(u=o.n()).done;)c=u.value,g.lf.isTensorInList(c,i)||c.dispose()}catch(s){o.e(s)}finally{o.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(M),T=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(G);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(w||(w={}));var E=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.FAIL;return Object(c.a)(this,n),(r=t.call(this)).iterators=e,r.mismatchMode=a,r.count=0,r.currentPromise=null,r}return Object(l.a)(n,[{key:"summary",value:function(){return"{".concat("TODO: fill in upstream of zip summaries","} -> Zip")}},{key:"nextState",value:function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){return e instanceof G?{value:e.next().then((function(e){return n++,e.done&&r++,e.value})),recurse:!1}:{value:null,recurse:!0}},e.next=3,t;case 3:return n=0,r=0,e.next=7,Object(h.c)(this.iterators,a);case 7:if(i=e.sent,n!==r){e.next=10;break}return e.abrupt("return",{value:null,done:!0});case 10:if(!(r>0)){e.next=16;break}e.t0=this.mismatchMode,e.next=e.t0===w.FAIL?14:e.t0===w.SHORTEST?15:(e.t0,w.LONGEST,16);break;case 14:throw new Error("Zipped streams should have the same length. "+"Mismatched at element ".concat(this.count,"."));case 15:return e.abrupt("return",{value:null,done:!0});case 16:return this.count++,e.abrupt("return",{value:i,done:!1});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentPromise=this.nextState(this.currentPromise),e.abrupt("return",this.currentPromise);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(G),j=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r){var a;return Object(c.a)(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new C(r),a}return Object(l.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(G),L=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(e,r,a){var i;return Object(c.a)(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=d.alea(a||g.tf.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return Object(l.a)(n,[{key:"next",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=Object(u.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(j)},function(e,t,n){var r=n(292).default;function a(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(460)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(14),a=n(19);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",a.c(e),new r.b(e,t,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({reverse_:function(e,t){var n={x:Object(i.a)(e,"x","reverse")},o={dims:t};return r.a.runKernel(a.tc,n,o)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),a=n(19),i=n(79);function o(e,t){Object(a.d)(e);var n=Object(r.c)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(i.a)(e,null,n,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11),a=n(19),i=n(24);function o(e,t,n,o){if(null==o&&(o=Object(a.r)(e)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(a.A)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Object(a.c)(t);var s=Object(a.O)(t),u=Object(a.O)(n);Object(a.b)(s===u,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(s," values but has ").concat(u)}));for(var c=0;c<n.length;++c){var l=n[c],g=c!==n.length-1||l!==Object(a.O)(t.slice(c));Object(a.b)(n[c]===t[c]||!g,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return Object(a.A)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==o?Object(i.toTypedArray)(e,o):Object(a.m)(e,[],!0),r.a.makeTensor(e,t,o)}},function(e,t,n){"use strict";var r=n(272),a="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||a||Function("return this")();t.a=i},function(e,t,n){"use strict";function r(e){return e&&e.ownerDocument||document}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return Ie})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return fe})),n.d(t,"e",(function(){return pe})),n.d(t,"f",(function(){return h}));var r=n(25),a=n(157),i=(n(203),n(196)),o=n(156),s=n(208),u=n(97),c={}.constructor;function l(e){if(null==e||"object"!==typeof e)return e;if(Array.isArray(e))return e.map(l);if(e.constructor!==c)return e;var t={};for(var n in e)t[n]=l(e[n]);return t}function g(e,t,n){void 0===e&&(e="unnamed");var r=n.jss,a=l(t),i=r.plugins.onCreateRule(e,a,n);return i||(e[0],null)}var d=function(e,t){for(var n="",r=0;r<e.length&&"!important"!==e[r];r++)n&&(n+=t),n+=e[r];return n},h=function(e,t){if(void 0===t&&(t=!1),!Array.isArray(e))return e;var n="";if(Array.isArray(e[0]))for(var r=0;r<e.length&&"!important"!==e[r];r++)n&&(n+=", "),n+=d(e[r]," ");else n=d(e,", ");return t||"!important"!==e[e.length-1]||(n+=" !important"),n};function f(e,t){for(var n="",r=0;r<t;r++)n+="  ";return n+e}function p(e,t,n){void 0===n&&(n={});var r="";if(!t)return r;var a=n.indent,i=void 0===a?0:a,o=t.fallbacks;if(e&&i++,o)if(Array.isArray(o))for(var s=0;s<o.length;s++){var u=o[s];for(var c in u){var l=u[c];null!=l&&(r&&(r+="\n"),r+=""+f(c+": "+h(l)+";",i))}}else for(var g in o){var d=o[g];null!=d&&(r&&(r+="\n"),r+=""+f(g+": "+h(d)+";",i))}for(var p in t){var I=t[p];null!=I&&"fallbacks"!==p&&(r&&(r+="\n"),r+=""+f(p+": "+h(I)+";",i))}return(r||n.allowEmpty)&&e?(r&&(r="\n"+r+"\n"),f(e+" {"+r,--i)+f("}",i)):r}var I=/([[\].#*$><+~=|^:(),"'`\s])/g,C="undefined"!==typeof CSS&&CSS.escape,m=function(e){return C?C(e):e.replace(I,"\\$1")},b=function(){function e(e,t,n){this.type="style",this.key=void 0,this.isProcessed=!1,this.style=void 0,this.renderer=void 0,this.renderable=void 0,this.options=void 0;var r=n.sheet,a=n.Renderer;this.key=e,this.options=n,this.style=t,r?this.renderer=r.renderer:a&&(this.renderer=new a)}return e.prototype.prop=function(e,t,n){if(void 0===t)return this.style[e];var r=!!n&&n.force;if(!r&&this.style[e]===t)return this;var a=t;n&&!1===n.process||(a=this.options.jss.plugins.onChangeValue(t,e,this));var i=null==a||!1===a,o=e in this.style;if(i&&!o&&!r)return this;var s=i&&o;if(s?delete this.style[e]:this.style[e]=a,this.renderable&&this.renderer)return s?this.renderer.removeProperty(this.renderable,e):this.renderer.setProperty(this.renderable,e,a),this;var u=this.options.sheet;return u&&u.attached,this},e}(),v=function(e){function t(t,n,r){var a;(a=e.call(this,t,n,r)||this).selectorText=void 0,a.id=void 0,a.renderable=void 0;var i=r.selector,o=r.scoped,u=r.sheet,c=r.generateId;return i?a.selectorText=i:!1!==o&&(a.id=c(Object(s.a)(Object(s.a)(a)),u),a.selectorText="."+m(a.id)),a}Object(o.a)(t,e);var n=t.prototype;return n.applyTo=function(e){var t=this.renderer;if(t){var n=this.toJSON();for(var r in n)t.setProperty(e,r,n[r])}return this},n.toJSON=function(){var e={};for(var t in this.style){var n=this.style[t];"object"!==typeof n?e[t]=n:Array.isArray(n)&&(e[t]=h(n))}return e},n.toString=function(e){var t=this.options.sheet,n=!!t&&t.options.link?Object(r.a)({},e,{allowEmpty:!0}):e;return p(this.selectorText,this.style,n)},Object(i.a)(t,[{key:"selector",set:function(e){if(e!==this.selectorText){this.selectorText=e;var t=this.renderer,n=this.renderable;if(n&&t)t.setSelector(n,e)||t.replaceRule(n,this)}},get:function(){return this.selectorText}}]),t}(b),A={onCreateRule:function(e,t,n){return"@"===e[0]||n.parent&&"keyframes"===n.parent.type?null:new v(e,t,n)}},y={indent:1,children:!0},w=/@([\w-]+)/,G=function(){function e(e,t,n){this.type="conditional",this.at=void 0,this.key=void 0,this.query=void 0,this.rules=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e;var a=e.match(w);for(var i in this.at=a?a[1]:"unknown",this.query=n.name||"@"+this.at,this.options=n,this.rules=new D(Object(r.a)({},n,{parent:this})),t)this.rules.add(i,t[i]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.indexOf=function(e){return this.rules.indexOf(e)},t.addRule=function(e,t,n){var r=this.rules.add(e,t,n);return r?(this.options.jss.plugins.onProcessRule(r),r):null},t.toString=function(e){if(void 0===e&&(e=y),null==e.indent&&(e.indent=y.indent),null==e.children&&(e.children=y.children),!1===e.children)return this.query+" {}";var t=this.rules.toString(e);return t?this.query+" {\n"+t+"\n}":""},e}(),B=/@media|@supports\s+/,x={onCreateRule:function(e,t,n){return B.test(e)?new G(e,t,n):null}},S={indent:1,children:!0},k=/@keyframes\s+([\w-]+)/,Z=function(){function e(e,t,n){this.type="keyframes",this.at="@keyframes",this.key=void 0,this.name=void 0,this.id=void 0,this.rules=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0;var a=e.match(k);a&&a[1]?this.name=a[1]:this.name="noname",this.key=this.type+"-"+this.name,this.options=n;var i=n.scoped,o=n.sheet,s=n.generateId;for(var u in this.id=!1===i?this.name:m(s(this,o)),this.rules=new D(Object(r.a)({},n,{parent:this})),t)this.rules.add(u,t[u],Object(r.a)({},n,{parent:this}));this.rules.process()}return e.prototype.toString=function(e){if(void 0===e&&(e=S),null==e.indent&&(e.indent=S.indent),null==e.children&&(e.children=S.children),!1===e.children)return this.at+" "+this.id+" {}";var t=this.rules.toString(e);return t&&(t="\n"+t+"\n"),this.at+" "+this.id+" {"+t+"}"},e}(),R=/@keyframes\s+/,N=/\$([\w-]+)/g,O=function(e,t){return"string"===typeof e?e.replace(N,(function(e,n){return n in t?t[n]:e})):e},W=function(e,t,n){var r=e[t],a=O(r,n);a!==r&&(e[t]=a)},F={onCreateRule:function(e,t,n){return"string"===typeof e&&R.test(e)?new Z(e,t,n):null},onProcessStyle:function(e,t,n){return"style"===t.type&&n?("animation-name"in e&&W(e,"animation-name",n.keyframes),"animation"in e&&W(e,"animation",n.keyframes),e):e},onChangeValue:function(e,t,n){var r=n.options.sheet;if(!r)return e;switch(t){case"animation":case"animation-name":return O(e,r.keyframes);default:return e}}},M=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).renderable=void 0,t}return Object(o.a)(t,e),t.prototype.toString=function(e){var t=this.options.sheet,n=!!t&&t.options.link?Object(r.a)({},e,{allowEmpty:!0}):e;return p(this.key,this.style,n)},t}(b),V={onCreateRule:function(e,t,n){return n.parent&&"keyframes"===n.parent.type?new M(e,t,n):null}},T=function(){function e(e,t,n){this.type="font-face",this.at="@font-face",this.key=void 0,this.style=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.style=t,this.options=n}return e.prototype.toString=function(e){if(Array.isArray(this.style)){for(var t="",n=0;n<this.style.length;n++)t+=p(this.at,this.style[n]),this.style[n+1]&&(t+="\n");return t}return p(this.at,this.style,e)},e}(),E=/@font-face/,j={onCreateRule:function(e,t,n){return E.test(e)?new T(e,t,n):null}},L=function(){function e(e,t,n){this.type="viewport",this.at="@viewport",this.key=void 0,this.style=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.style=t,this.options=n}return e.prototype.toString=function(e){return p(this.key,this.style,e)},e}(),X={onCreateRule:function(e,t,n){return"@viewport"===e||"@-ms-viewport"===e?new L(e,t,n):null}},H=function(){function e(e,t,n){this.type="simple",this.key=void 0,this.value=void 0,this.options=void 0,this.isProcessed=!1,this.renderable=void 0,this.key=e,this.value=t,this.options=n}return e.prototype.toString=function(e){if(Array.isArray(this.value)){for(var t="",n=0;n<this.value.length;n++)t+=this.key+" "+this.value[n]+";",this.value[n+1]&&(t+="\n");return t}return this.key+" "+this.value+";"},e}(),Y={"@charset":!0,"@import":!0,"@namespace":!0},z=[A,x,F,V,j,X,{onCreateRule:function(e,t,n){return e in Y?new H(e,t,n):null}}],K={process:!0},_={force:!0,process:!0},D=function(){function e(e){this.map={},this.raw={},this.index=[],this.counter=0,this.options=void 0,this.classes=void 0,this.keyframes=void 0,this.options=e,this.classes=e.classes,this.keyframes=e.keyframes}var t=e.prototype;return t.add=function(e,t,n){var a=this.options,i=a.parent,o=a.sheet,s=a.jss,u=a.Renderer,c=a.generateId,l=a.scoped,d=Object(r.a)({classes:this.classes,parent:i,sheet:o,jss:s,Renderer:u,generateId:c,scoped:l,name:e,keyframes:this.keyframes,selector:void 0},n),h=e;e in this.raw&&(h=e+"-d"+this.counter++),this.raw[h]=t,h in this.classes&&(d.selector="."+m(this.classes[h]));var f=g(h,t,d);if(!f)return null;this.register(f);var p=void 0===d.index?this.index.length:d.index;return this.index.splice(p,0,f),f},t.get=function(e){return this.map[e]},t.remove=function(e){this.unregister(e),delete this.raw[e.key],this.index.splice(this.index.indexOf(e),1)},t.indexOf=function(e){return this.index.indexOf(e)},t.process=function(){var e=this.options.jss.plugins;this.index.slice(0).forEach(e.onProcessRule,e)},t.register=function(e){this.map[e.key]=e,e instanceof v?(this.map[e.selector]=e,e.id&&(this.classes[e.key]=e.id)):e instanceof Z&&this.keyframes&&(this.keyframes[e.name]=e.id)},t.unregister=function(e){delete this.map[e.key],e instanceof v?(delete this.map[e.selector],delete this.classes[e.key]):e instanceof Z&&delete this.keyframes[e.name]},t.update=function(){var e,t,n;if("string"===typeof(arguments.length<=0?void 0:arguments[0])?(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],n=arguments.length<=2?void 0:arguments[2]):(t=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],e=null),e)this.updateOne(this.map[e],t,n);else for(var r=0;r<this.index.length;r++)this.updateOne(this.index[r],t,n)},t.updateOne=function(t,n,r){void 0===r&&(r=K);var a=this.options,i=a.jss.plugins,o=a.sheet;if(t.rules instanceof e)t.rules.update(n,r);else{var s=t,u=s.style;if(i.onUpdate(n,t,o,r),r.process&&u&&u!==s.style){for(var c in i.onProcessStyle(s.style,s,o),s.style){var l=s.style[c];l!==u[c]&&s.prop(c,l,_)}for(var g in u){var d=s.style[g],h=u[g];null==d&&d!==h&&s.prop(g,null,_)}}}},t.toString=function(e){for(var t="",n=this.options.sheet,r=!!n&&n.options.link,a=0;a<this.index.length;a++){var i=this.index[a].toString(e);(i||r)&&(t&&(t+="\n"),t+=i)}return t},e}(),P=function(){function e(e,t){for(var n in this.options=void 0,this.deployed=void 0,this.attached=void 0,this.rules=void 0,this.renderer=void 0,this.classes=void 0,this.keyframes=void 0,this.queue=void 0,this.attached=!1,this.deployed=!1,this.classes={},this.keyframes={},this.options=Object(r.a)({},t,{sheet:this,parent:this,classes:this.classes,keyframes:this.keyframes}),t.Renderer&&(this.renderer=new t.Renderer(this)),this.rules=new D(this.options),e)this.rules.add(n,e[n]);this.rules.process()}var t=e.prototype;return t.attach=function(){return this.attached||(this.renderer&&this.renderer.attach(),this.attached=!0,this.deployed||this.deploy()),this},t.detach=function(){return this.attached?(this.renderer&&this.renderer.detach(),this.attached=!1,this):this},t.addRule=function(e,t,n){var r=this.queue;this.attached&&!r&&(this.queue=[]);var a=this.rules.add(e,t,n);return a?(this.options.jss.plugins.onProcessRule(a),this.attached?this.deployed?(r?r.push(a):(this.insertRule(a),this.queue&&(this.queue.forEach(this.insertRule,this),this.queue=void 0)),a):a:(this.deployed=!1,a)):null},t.insertRule=function(e){this.renderer&&this.renderer.insertRule(e)},t.addRules=function(e,t){var n=[];for(var r in e){var a=this.addRule(r,e[r],t);a&&n.push(a)}return n},t.getRule=function(e){return this.rules.get(e)},t.deleteRule=function(e){var t="object"===typeof e?e:this.rules.get(e);return!(!t||this.attached&&!t.renderable)&&(this.rules.remove(t),!(this.attached&&t.renderable&&this.renderer)||this.renderer.deleteRule(t.renderable))},t.indexOf=function(e){return this.rules.indexOf(e)},t.deploy=function(){return this.renderer&&this.renderer.deploy(),this.deployed=!0,this},t.update=function(){var e;return(e=this.rules).update.apply(e,arguments),this},t.updateOne=function(e,t,n){return this.rules.updateOne(e,t,n),this},t.toString=function(e){return this.rules.toString(e)},e}(),U=function(){function e(){this.plugins={internal:[],external:[]},this.registry=void 0}var t=e.prototype;return t.onCreateRule=function(e,t,n){for(var r=0;r<this.registry.onCreateRule.length;r++){var a=this.registry.onCreateRule[r](e,t,n);if(a)return a}return null},t.onProcessRule=function(e){if(!e.isProcessed){for(var t=e.options.sheet,n=0;n<this.registry.onProcessRule.length;n++)this.registry.onProcessRule[n](e,t);e.style&&this.onProcessStyle(e.style,e,t),e.isProcessed=!0}},t.onProcessStyle=function(e,t,n){for(var r=0;r<this.registry.onProcessStyle.length;r++)t.style=this.registry.onProcessStyle[r](t.style,t,n)},t.onProcessSheet=function(e){for(var t=0;t<this.registry.onProcessSheet.length;t++)this.registry.onProcessSheet[t](e)},t.onUpdate=function(e,t,n,r){for(var a=0;a<this.registry.onUpdate.length;a++)this.registry.onUpdate[a](e,t,n,r)},t.onChangeValue=function(e,t,n){for(var r=e,a=0;a<this.registry.onChangeValue.length;a++)r=this.registry.onChangeValue[a](r,t,n);return r},t.use=function(e,t){void 0===t&&(t={queue:"external"});var n=this.plugins[t.queue];-1===n.indexOf(e)&&(n.push(e),this.registry=[].concat(this.plugins.external,this.plugins.internal).reduce((function(e,t){for(var n in t)n in e&&e[n].push(t[n]);return e}),{onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[],onUpdate:[]}))},e}(),J=new(function(){function e(){this.registry=[]}var t=e.prototype;return t.add=function(e){var t=this.registry,n=e.options.index;if(-1===t.indexOf(e))if(0===t.length||n>=this.index)t.push(e);else for(var r=0;r<t.length;r++)if(t[r].options.index>n)return void t.splice(r,0,e)},t.reset=function(){this.registry=[]},t.remove=function(e){var t=this.registry.indexOf(e);this.registry.splice(t,1)},t.toString=function(e){for(var t=void 0===e?{}:e,n=t.attached,r=Object(u.a)(t,["attached"]),a="",i=0;i<this.registry.length;i++){var o=this.registry[i];null!=n&&o.attached!==n||(a&&(a+="\n"),a+=o.toString(r))}return a},Object(i.a)(e,[{key:"index",get:function(){return 0===this.registry.length?0:this.registry[this.registry.length-1].options.index}}]),e}()),Q="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window&&window.Math===Math?window:"undefined"!==typeof self&&self.Math===Math?self:Function("return this")(),q="2f1acc6c3a606b082e5eef5e54414ffb";null==Q[q]&&(Q[q]=0);var $=Q[q]++,ee=function(e){void 0===e&&(e={});var t=0;return function(n,r){t+=1;var a="",i="";return r&&(r.options.classNamePrefix&&(i=r.options.classNamePrefix),null!=r.options.jss.id&&(a=String(r.options.jss.id))),e.minify?""+(i||"c")+$+a+t:i+n.key+"-"+$+(a?"-"+a:"")+"-"+t}},te=function(e){var t;return function(){return t||(t=e()),t}},ne=function(e,t){try{return e.attributeStyleMap?e.attributeStyleMap.get(t):e.style.getPropertyValue(t)}catch(n){return""}},re=function(e,t,n){try{var r=n;if(Array.isArray(n)&&(r=h(n,!0),"!important"===n[n.length-1]))return e.style.setProperty(t,r,"important"),!0;e.attributeStyleMap?e.attributeStyleMap.set(t,r):e.style.setProperty(t,r)}catch(a){return!1}return!0},ae=function(e,t){try{e.attributeStyleMap?e.attributeStyleMap.delete(t):e.style.removeProperty(t)}catch(n){}},ie=function(e,t){return e.selectorText=t,e.selectorText===t},oe=te((function(){return document.querySelector("head")}));function se(e){var t=J.registry;if(t.length>0){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.attached&&r.options.index>t.index&&r.options.insertionPoint===t.insertionPoint)return r}return null}(t,e);if(n&&n.renderer)return{parent:n.renderer.element.parentNode,node:n.renderer.element};if((n=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.attached&&r.options.insertionPoint===t.insertionPoint)return r}return null}(t,e))&&n.renderer)return{parent:n.renderer.element.parentNode,node:n.renderer.element.nextSibling}}var r=e.insertionPoint;if(r&&"string"===typeof r){var a=function(e){for(var t=oe(),n=0;n<t.childNodes.length;n++){var r=t.childNodes[n];if(8===r.nodeType&&r.nodeValue.trim()===e)return r}return null}(r);if(a)return{parent:a.parentNode,node:a.nextSibling}}return!1}var ue=te((function(){var e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null})),ce=function(e,t,n){try{if("insertRule"in e)e.insertRule(t,n);else if("appendRule"in e){e.appendRule(t)}}catch(r){return!1}return e.cssRules[n]},le=function(e,t){var n=e.cssRules.length;return void 0===t||t>n?n:t},ge=function(){function e(e){this.getPropertyValue=ne,this.setProperty=re,this.removeProperty=ae,this.setSelector=ie,this.element=void 0,this.sheet=void 0,this.hasInsertedRules=!1,this.cssRules=[],e&&J.add(e),this.sheet=e;var t=this.sheet?this.sheet.options:{},n=t.media,r=t.meta,a=t.element;this.element=a||function(){var e=document.createElement("style");return e.textContent="\n",e}(),this.element.setAttribute("data-jss",""),n&&this.element.setAttribute("media",n),r&&this.element.setAttribute("data-meta",r);var i=ue();i&&this.element.setAttribute("nonce",i)}var t=e.prototype;return t.attach=function(){if(!this.element.parentNode&&this.sheet){!function(e,t){var n=t.insertionPoint,r=se(t);if(!1!==r&&r.parent)r.parent.insertBefore(e,r.node);else if(n&&"number"===typeof n.nodeType){var a=n,i=a.parentNode;i&&i.insertBefore(e,a.nextSibling)}else oe().appendChild(e)}(this.element,this.sheet.options);var e=Boolean(this.sheet&&this.sheet.deployed);this.hasInsertedRules&&e&&(this.hasInsertedRules=!1,this.deploy())}},t.detach=function(){if(this.sheet){var e=this.element.parentNode;e&&e.removeChild(this.element),this.sheet.options.link&&(this.cssRules=[],this.element.textContent="\n")}},t.deploy=function(){var e=this.sheet;e&&(e.options.link?this.insertRules(e.rules):this.element.textContent="\n"+e.toString()+"\n")},t.insertRules=function(e,t){for(var n=0;n<e.index.length;n++)this.insertRule(e.index[n],n,t)},t.insertRule=function(e,t,n){if(void 0===n&&(n=this.element.sheet),e.rules){var r=e,a=n;if("conditional"===e.type||"keyframes"===e.type){var i=le(n,t);if(!1===(a=ce(n,r.toString({children:!1}),i)))return!1;this.refCssRule(e,i,a)}return this.insertRules(r.rules,a),a}var o=e.toString();if(!o)return!1;var s=le(n,t),u=ce(n,o,s);return!1!==u&&(this.hasInsertedRules=!0,this.refCssRule(e,s,u),u)},t.refCssRule=function(e,t,n){e.renderable=n,e.options.parent instanceof P&&(this.cssRules[t]=n)},t.deleteRule=function(e){var t=this.element.sheet,n=this.indexOf(e);return-1!==n&&(t.deleteRule(n),this.cssRules.splice(n,1),!0)},t.indexOf=function(e){return this.cssRules.indexOf(e)},t.replaceRule=function(e,t){var n=this.indexOf(e);return-1!==n&&(this.element.sheet.deleteRule(n),this.cssRules.splice(n,1),this.insertRule(t,n))},t.getRules=function(){return this.element.sheet.cssRules},e}(),de=0,he=function(){function e(e){this.id=de++,this.version="10.6.0",this.plugins=new U,this.options={id:{minify:!1},createGenerateId:ee,Renderer:a.a?ge:null,plugins:[]},this.generateId=ee({minify:!1});for(var t=0;t<z.length;t++)this.plugins.use(z[t],{queue:"internal"});this.setup(e)}var t=e.prototype;return t.setup=function(e){return void 0===e&&(e={}),e.createGenerateId&&(this.options.createGenerateId=e.createGenerateId),e.id&&(this.options.id=Object(r.a)({},this.options.id,e.id)),(e.createGenerateId||e.id)&&(this.generateId=this.options.createGenerateId(this.options.id)),null!=e.insertionPoint&&(this.options.insertionPoint=e.insertionPoint),"Renderer"in e&&(this.options.Renderer=e.Renderer),e.plugins&&this.use.apply(this,e.plugins),this},t.createStyleSheet=function(e,t){void 0===t&&(t={});var n=t.index;"number"!==typeof n&&(n=0===J.index?0:J.index+1);var a=new P(e,Object(r.a)({},t,{jss:this,generateId:t.generateId||this.generateId,insertionPoint:this.options.insertionPoint,Renderer:this.options.Renderer,index:n}));return this.plugins.onProcessSheet(a),a},t.removeStyleSheet=function(e){return e.detach(),J.remove(e),this},t.createRule=function(e,t,n){if(void 0===t&&(t={}),void 0===n&&(n={}),"object"===typeof e)return this.createRule(void 0,e,t);var a=Object(r.a)({},n,{name:e,jss:this,Renderer:this.options.Renderer});a.generateId||(a.generateId=this.generateId),a.classes||(a.classes={}),a.keyframes||(a.keyframes={});var i=g(e,t,a);return i&&this.plugins.onProcessRule(i),i},t.use=function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){e.plugins.use(t)})),this},e}();function fe(e){var t=null;for(var n in e){var r=e[n],a=typeof r;if("function"===a)t||(t={}),t[n]=r;else if("object"===a&&null!==r&&!Array.isArray(r)){var i=fe(r);i&&(t||(t={}),t[n]=i)}}return t}var pe="object"===typeof CSS&&null!=CSS&&"number"in CSS,Ie=function(e){return new he(e)};Ie()},function(e,t,n){"use strict";var r=n(215);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);function a(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(a.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),a.FullScreenQuad=function(){var e=new r.OrthographicCamera(-1,1,1,-1,0,1),t=new r.BufferGeometry;t.setAttribute("position",new r.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),t.setAttribute("uv",new r.Float32BufferAttribute([0,2,0,0,2,0],2));var n=function(e){this._mesh=new r.Mesh(t,e)};return Object.defineProperty(n.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(n.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),n}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({pow_:function(e,t){var n=Object(s.a)(e,"base","pow"),u=Object(s.a)(t,"exp","pow"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.fc,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(19),i=n(93),o=n(114);function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=s(e,"float32"),u=Object(o.a)(e,"float32");return Object(i.a)(n,u)}var c=Object(a.D)(Object(a.O)(e),t);return r.a.makeTensor(c,e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({lessEqual_:function(e,t){var n=Object(s.a)(e,"a","lessEqual","string_or_numeric"),c=Object(s.a)(t,"b","lessEqual","string_or_numeric"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.Ab,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var s={paddings:t,constantValue:n},u={x:o};return r.a.runKernel(a.ec,u,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({transpose_:function(e,t){var n=Object(i.a)(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){o.b(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var s={x:n},u={perm:t};return r.a.runKernel(a.dd,s,u)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(38),a={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},i={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function o(e){return"".concat(Math.round(e),"ms")}t.a={easing:a,duration:i,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.duration,s=void 0===n?i.standard:n,u=t.easing,c=void 0===u?a.easeInOut:u,l=t.delay,g=void 0===l?0:l;Object(r.a)(t,["duration","easing","delay"]);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof s?s:o(s)," ").concat(c," ").concat("string"===typeof g?g:o(g))})).join(",")},getAutoHeightDuration:function(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(188),a=n(265);function i(e,t,n){return(i=Object(a.a)()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&Object(r.a)(i,n.prototype),i}).apply(null,arguments)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return R})),n.d(t,"i",(function(){return O})),n.d(t,"c",(function(){return W})),n.d(t,"f",(function(){return F})),n.d(t,"e",(function(){return T})),n.d(t,"d",(function(){return E})),n.d(t,"k",(function(){return L})),n.d(t,"g",(function(){return X})),n.d(t,"h",(function(){return H})),n.d(t,"j",(function(){return Y})),n.d(t,"b",(function(){return z}));var r=n(3),a=n(21),i=n(1),o=n(9),s=n(0),u=n(127),c=n(150),l=n(4),g=n(363),d=n(364),h=n(365),f=n(366),p=n(367),I=n(368),C=n(369),m=n(370),b=n(371),v=n(372),A=n(373),y=n(374),w=n(375),G=n(376),B=n(377),x=n(378),S=n(379),k=n(380),Z=n(381),R=function(){function e(){var t;Object(i.a)(this,e);var n=[g,d,h,f,p,I,C,m,b,v,A,y,w,G,B,x,S,k,Z],r=(t=[]).concat.apply(t,Object(a.a)(n.map((function(e){return e.json}))));this.opMappers=r.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Object(o.a)(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.node,i=[],o=[],s=[],u=a.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?i.push(e[n.name]):"Const"===n.op?o.push(e[n.name]):null!=n.input&&0!==n.input.length||s.push(e[n.name]),e}),{}),c=[],g=[],d={},h={};null!=n&&(d=this.mapSignatureEntries(n.inputs),h=this.mapSignatureEntries(n.outputs));var f=Object.keys(u);f.forEach((function(e){var t=u[e];t.inputNames.forEach((function(e,n){var a=Object(l.b)(e),i=Object(r.a)(a,3),o=i[0],s=i[2],c=u[o];if(null!=c.outputs){var g=c.outputs.indexOf(s);if(-1!==g){var d="".concat(o,":").concat(g);t.inputNames[n]=d}}t.inputs.push(c),c.children.push(t)}))})),0===Object.keys(h).length?f.forEach((function(e){var t=u[e];0===t.children.length&&g.push(t)})):Object.keys(h).forEach((function(e){var t=Object(l.b)(e),n=Object(r.a)(t,1)[0],a=u[n];null!=a&&(a.signatureKey=h[e],g.push(a))})),Object.keys(d).length>0?Object.keys(d).forEach((function(e){var t=Object(l.b)(e),n=Object(r.a)(t,1)[0],a=u[n];a&&(a.signatureKey=d[e],c.push(a))})):c=i;var p={};null!=e.library&&null!=e.library.function&&(p=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var I={nodes:u,inputs:c,outputs:g,weights:o,placeholders:i,signature:n,functions:p};return s.length>0&&(I.initNodes=s),I}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=Object(c.a)(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=O(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=O(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=H(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=H(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=F(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=F(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=X(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=X(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=W(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=W(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=z(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=z(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=L(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=L(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=Y(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Y(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=T(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=T(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=E(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=E(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=V(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=V(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,a=[],i={};null!=n&&(i=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&a.push(e[n.name]),e}),{}));var o=[],s=[];e.signature.inputArg.forEach((function(e){var t=Object(l.b)(e.name),n=Object(r.a)(t,1)[0],a={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:M(e.type),type:"dtype"}},children:[]};a.signatureKey=e.name,o.push(a),i[n]=a})),Object.keys(i).forEach((function(e){var t=i[e];t.inputNames.forEach((function(e,n){var a=Object(l.b)(e),o=Object(r.a)(a,3),s=o[0],u=o[2],c=i[s];if(null!=c.outputs){var g=c.outputs.indexOf(u);if(-1!==g){var d="".concat(s,":").concat(g);t.inputNames[n]=d}}t.inputs.push(c),c.children.push(t)}))}));var u=e.ret;e.signature.outputArg.forEach((function(e){var t=Object(l.b)(u[e.name]),n=Object(r.a)(t,2),a=n[0],o=n[1],c=i[a];null!=c&&(c.defaultOutput=o,s.push(c))}));var c=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:s,weights:a,placeholders:[],signature:c}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function N(t,n){var r=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var n=Object(s.Ud)().global;if("undefined"!==typeof n.atob)return n.atob(t);if("undefined"!==typeof e)return new e(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return n?r:r.toLowerCase()}function O(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?N(a.s,r):n}function W(e,t,n){var r=e[t];return r?r.b:n}function F(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function M(e){switch("string"===typeof e&&(e=u.a[e]),e){case u.a.DT_FLOAT:return"float32";case u.a.DT_INT32:case u.a.DT_INT64:case u.a.DT_INT8:case u.a.DT_UINT8:return"int32";case u.a.DT_BOOL:return"bool";case u.a.DT_DOUBLE:return"float32";case u.a.DT_STRING:return"string";default:return null}}function V(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function T(e,t,n){var r=e[t];return r&&r.type?M(r.type):n}function E(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return M(e)})):n}function j(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function L(e,t,n){var r=e[t];return r&&r.shape?j(r.shape):n}function X(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function H(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return N(e,r)})):n}function Y(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return j(e)})):n}function z(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n(279).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({complex_:function(e,t){var n=Object(i.a)(e,"real","complex"),s=Object(i.a)(t,"imag","complex");o.e(n.shape,s.shape,"real and imag shapes, ".concat(n.shape," and ").concat(s.shape,", ")+"must match in call to tf.complex().");var u={real:n,imag:s};return r.a.runKernel(a.z,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(33),s=n(10);var u=Object(s.b)({logicalAnd_:function(e,t){var n=Object(i.a)(e,"a","logicalAnd","bool"),s=Object(i.a)(t,"b","logicalAnd","bool");Object(o.a)(n.shape,s.shape);var u={a:n,b:s};return r.a.runKernel(a.Fb,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","split"),s={x:o},u={numOrSizeSplits:t,axis:n};return r.a.runKernel(a.Nc,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.b)(e,"tensors","stack","string_or_numeric");o.b(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&o.b(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var s=n,u={axis:t};return r.a.runKernel(a.dc,s,u)}})},function(e,t,n){"use strict";var r=n(214);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";var r=n(80).a.Symbol,a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=r?r.toStringTag:void 0;var u=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(u){}var a=o.call(e);return r&&(t?e[s]=n:delete e[s]),a},c=Object.prototype.toString;var l=function(e){return c.call(e)},g=r?r.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":g&&g in Object(e)?u(e):l(e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return d}));var r=n(3),a=n(36),i=n(154),o=Object(i.a)("kernelRegistry",(function(){return new Map})),s=Object(i.a)("gradRegistry",(function(){return new Map}));function u(e,t){var n=h(e,t);return o.get(n)}function c(e){return s.get(e)}function l(e){for(var t=o.entries(),n=[];;){var a=t.next(),i=a.done,s=a.value;if(i)break;var u=Object(r.a)(s,2),c=u[0],l=u[1],g=c.split("_");Object(r.a)(g,1)[0]===e&&n.push(l)}return n}function g(e){var t=e.kernelName,n=e.backendName,r=h(t,n);o.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),o.set(r,e)}function d(e){var t=e.kernelName;s.has(t)&&Object(a.b)().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),s.set(t,e)}function h(e,t){return"".concat(t,"_").concat(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","expandDims","string_or_numeric");o.b(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var s={input:n},u={dim:t};return r.a.runKernel(a.bb,s,u)}})},function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(53),u=n(10),c=n(18);var l=Object(u.b)({conv2d_:function(e,t,n,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=Object(i.a)(e,"x","conv2d"),f=Object(i.a)(t,"filter","conv2d"),p=h,I=!1;3===h.rank&&(I=!0,p=Object(c.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.b(4===p.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(p.rank,".")})),o.b(4===f.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(f.rank,".")})),null!=d&&o.b(o.v(u),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(u,".")}));var C="NHWC"===l?p.shape[3]:p.shape[1];o.b(C===f.shape[2],(function(){return"Error in conv2d: depth of input (".concat(C,") must match ")+"input depth for filter ".concat(f.shape[2],".")})),o.b(s.h(n,g),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(g,"'")}));var m={x:p,filter:f},b={strides:n,pad:u,dataFormat:l,dilations:g,dimRoundingMode:d},v=r.a.runKernel(a.C,m,b);return I?Object(c.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({greaterEqual_:function(e,t){var n=Object(s.a)(e,"a","greaterEqual","string_or_numeric"),c=Object(s.a)(t,"b","greaterEqual","string_or_numeric"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.pb,d)}})},function(e,t,n){"use strict";function r(e,t){"function"===typeof e?e(t):e&&(e.current=t)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(395),a=(n(2),n(261));function i(){return Object(r.a)()||a.a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({clone_:function(e){var t={x:Object(i.a)(e,"x","clone","string_or_numeric")};return r.a.runKernel(a.rb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({sigmoid_:function(e){var t={x:Object(i.a)(e,"x","sigmoid")};return r.a.runKernel(a.Ac,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","max"),s={x:o},u={reductionIndices:t,keepDims:n};return r.a.runKernel(a.Ib,s,u)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=function(e){return e.scrollTop};function a(e,t){var n=e.timeout,r=e.style,a=void 0===r?{}:r;return{duration:a.transitionDuration||"number"===typeof n?n:n[t.mode]||0,delay:a.transitionDelay}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n(7),a=n.n(r),i=n(17),o=n(0);function s(e,t){return u(e,t)}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(f(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var s=e[o],c=u(s,t,n,r);i[o]=c}return r.delete(e),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;return l(e,t)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(f(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=l(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var s in r)o(s);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function g(e){return null===e?null:f(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function d(e,t){return h.apply(this,arguments)}function h(){return(h=Object(i.a)(a.a.mark((function e(t,n){var r,i,s,c,l,g,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Map,u(t,n,r),i=0,s=Array.from(r.keys());case 3:if(!(i<s.length)){e.next=14;break}if(c=s[i],l=r.get(c),!o.tf.isPromise(l)){e.next=11;break}return e.next=9,l;case 9:g=e.sent,r.set(c,g);case 11:i++,e.next=3;break;case 14:return d=u(t,n,r),e.abrupt("return",d);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof o.bd))}function p(e){return null==e||(null===(t=e)||"object"!==typeof t&&"function"!==typeof t)||Array.isArray(e)||"object"===typeof e&&e instanceof o.bd||o.tf.isTypedArray(e);var t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({log_:function(e){var t={x:Object(i.a)(e,"x","log")};return r.a.runKernel(a.Cb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n(21);function a(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||i)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function i(e,t){return e>t?1:e<t?-1:0}function o(e,t,n,r,a){return c(e,t,n,r,a,0)}function s(e,t,n,r,a,i){return c(e,t,n,r,a,0,!1,i,!0)}function u(e,t,n,r,a,i){return c(e,t,n,r,a,i,!0)}function c(e,t,n,i,o,s){for(var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=[],p=0;p<t.length;p++)t[p]>o&&f.push({score:t[p],boxIndex:p,suppressBeginIndex:0});f.sort(d);for(var I=s>0?-.5/s:0,C=[],m=[];C.length<n&&f.length>0;){var b=f.pop(),v=b.score,A=b.boxIndex,y=b.suppressBeginIndex;if(v<o)break;for(var w=!1,G=C.length-1;G>=y;--G){var B=l(e,A,C[G]);if(B>=i){w=!0;break}if(b.score=b.score*g(i,I,B),b.score<=o)break}b.suppressBeginIndex=C.length,w||(b.score===v?(C.push(A),m.push(b.score)):b.score>o&&a(f,b,d))}var x=C.length,S=n-x;c&&S>0&&(C.push.apply(C,Object(r.a)(new Array(S).fill(0))),m.push.apply(m,Object(r.a)(new Array(S).fill(0))));var k={selectedIndices:C};return u&&(k.selectedScores=m),h&&(k.validOutputs=x),k}function l(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),g=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),h=(s-i)*(u-o),f=(g-c)*(d-l);if(h<=0||f<=0)return 0;var p=Math.max(i,c),I=Math.max(o,l),C=Math.min(s,g),m=Math.min(u,d),b=Math.max(C-p,0)*Math.max(m-I,0);return b/(h+f-b)}function g(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function d(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(11),a=n(19),i=n(93);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=o(e,"float32"),s=o(e,"float32");return Object(i.a)(n,s)}var u=Object(a.F)(Object(a.O)(e),t);return r.a.makeTensor(u,e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({relu_:function(e){var t={x:Object(i.a)(e,"x","relu")};return r.a.runKernel(a.mc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","step"),o={x:n},s={alpha:t};return r.a.runKernel(a.Rc,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","unstack","string_or_numeric");o.b(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var s={value:n},u={axis:t};return r.a.runKernel(a.fd,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(18);var u=n(10);var c=Object(u.b)({batchNorm_:function(e,t,n,u,c,l){null==l&&(l=.001);var g,d,h=Object(i.a)(e,"x","batchNorm"),f=Object(i.a)(t,"mean","batchNorm"),p=Object(i.a)(n,"variance","batchNorm");null!=c&&(g=Object(i.a)(c,"scale","batchNorm")),null!=u&&(d=Object(i.a)(u,"offset","batchNorm")),o.b(f.rank===p.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.b(null==d||f.rank===d.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.b(null==g||f.rank===g.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var I={x:function(e){return 0===e.rank||1===e.rank?Object(s.a)(e,[1,1,1,e.size]):2===e.rank?Object(s.a)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(h),scale:g,offset:d,mean:f,variance:p},C={varianceEpsilon:l},m=r.a.runKernel(a.jb,I,C);return Object(s.a)(m,h.shape)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5),a=n(79);function i(e,t,n){var i=Object(r.c)(e,n);return Object(a.a)(e,t,i,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({tile_:function(e,t){var n=Object(i.a)(e,"x","tile","string_or_numeric");o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var s={x:n},u={reps:t};return r.a.runKernel(a.ad,s,u)}})},function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function a(e){return!!e&&!!e[D]}function i(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[_]||!!e.constructor[_]||d(e)||h(e))}function o(e,t,n){void 0===n&&(n=!1),0===s(e)?(n?Object.keys:P)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function s(e){var t=e[D];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:d(e)?2:h(e)?3:0}function u(e,t){return 2===s(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){return 2===s(e)?e.get(t):e[t]}function l(e,t,n){var r=s(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function g(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function d(e){return H&&e instanceof Map}function h(e){return Y&&e instanceof Set}function f(e){return e.o||e.t}function p(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=U(e);delete t[D];for(var n=P(t),r=0;r<n.length;r++){var a=n[r],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function I(e,t){return void 0===t&&(t=!1),m(e)||a(e)||!i(e)||(s(e)>1&&(e.set=e.add=e.clear=e.delete=C),Object.freeze(e),t&&o(e,(function(e,t){return I(t,!0)}),!0)),e}function C(){r(2)}function m(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function b(e){var t=J[e];return t||r(18,e),t}function v(e,t){J[e]||(J[e]=t)}function A(){return L}function y(e,t){t&&(b("Patches"),e.u=[],e.s=[],e.v=t)}function w(e){G(e),e.p.forEach(x),e.p=null}function G(e){e===L&&(L=e.l)}function B(e){return L={p:[],l:L,h:e,m:!0,_:0}}function x(e){var t=e[D];0===t.i||1===t.i?t.j():t.g=!0}function S(e,t){t._=t.p.length;var n=t.p[0],a=void 0!==e&&e!==n;return t.h.O||b("ES5").S(t,e,a),a?(n[D].P&&(w(t),r(4)),i(e)&&(e=k(t,e),t.l||R(t,e)),t.u&&b("Patches").M(n[D],e,t.u,t.s)):e=k(t,n,[]),w(t),t.u&&t.v(t.u,t.s),e!==K?e:void 0}function k(e,t,n){if(m(t))return t;var r=t[D];if(!r)return o(t,(function(a,i){return Z(e,r,t,a,i,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return R(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=p(r.k):r.o;o(3===r.i?new Set(a):a,(function(t,i){return Z(e,r,a,t,i,n)})),R(e,a,!1),n&&e.u&&b("Patches").R(r,n,e.u,e.s)}return r.o}function Z(e,t,n,r,o,s){if(a(o)){var c=k(e,o,s&&t&&3!==t.i&&!u(t.D,r)?s.concat(r):void 0);if(l(n,r,c),!a(c))return;e.m=!1}if(i(o)&&!m(o)){if(!e.h.N&&e._<1)return;k(e,o),t&&t.A.l||R(e,o)}}function R(e,t,n){void 0===n&&(n=!1),e.h.N&&e.m&&I(t,n)}function N(e,t){var n=e[D];return(n?f(n):e)[t]}function O(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function W(e){e.P||(e.P=!0,e.l&&W(e.l))}function F(e){e.o||(e.o=p(e.t))}function M(e,t,n){var r=d(t)?b("MapSet").T(t,n):h(t)?b("MapSet").F(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:A(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},a=r,i=Q;n&&(a=[r],i=q);var o=Proxy.revocable(a,i),s=o.revoke,u=o.proxy;return r.k=u,r.j=s,u}(t,n):b("ES5").J(t,n);return(n?n.A:A()).p.push(r),r}function V(e){return a(e)||r(22,e),function e(t){if(!i(t))return t;var n,r=t[D],a=s(t);if(r){if(!r.P&&(r.i<4||!b("ES5").K(r)))return r.t;r.I=!0,n=T(t,a),r.I=!1}else n=T(t,a);return o(n,(function(t,a){r&&c(r.t,t)===a||l(n,t,e(a))})),3===a?new Set(n):n}(e)}function T(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return p(e)}function E(){function e(e,t){var n=i[e];return n?n.enumerable=t:i[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[D];return Q.get(t,e)},set:function(t){var n=this[D];Q.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var a=e[t][D];if(!a.P)switch(a.i){case 5:r(a)&&W(a);break;case 4:n(a)&&W(a)}}}function n(e){for(var t=e.t,n=e.k,r=P(n),a=r.length-1;a>=0;a--){var i=r[a];if(i!==D){var o=t[i];if(void 0===o&&!u(t,i))return!0;var s=n[i],c=s&&s[D];if(c?c.t!==o:!g(s,o))return!0}}var l=!!t[D];return r.length!==P(t).length+(l?0:1)}function r(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var i={};v("ES5",{J:function(t,n){var r=Array.isArray(t),a=function(t,n){if(t){for(var r=Array(n.length),a=0;a<n.length;a++)Object.defineProperty(r,""+a,e(a,!0));return r}var i=U(n);delete i[D];for(var o=P(i),s=0;s<o.length;s++){var u=o[s];i[u]=e(u,t||!!i[u].enumerable)}return Object.create(Object.getPrototypeOf(n),i)}(r,t),i={i:r?5:4,A:n?n.A:A(),P:!1,I:!1,D:{},l:n,t:t,k:a,o:null,g:!1,C:!1};return Object.defineProperty(a,D,{value:i,writable:!0}),a},S:function(e,n,i){i?a(n)&&n[D].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[D];if(n){var a=n.t,i=n.k,s=n.D,c=n.i;if(4===c)o(i,(function(t){t!==D&&(void 0!==a[t]||u(a,t)?s[t]||e(i[t]):(s[t]=!0,W(n)))})),o(a,(function(e){void 0!==i[e]||u(i,e)||(s[e]=!1,W(n))}));else if(5===c){if(r(n)&&(W(n),s.length=!0),i.length<a.length)for(var l=i.length;l<a.length;l++)s[l]=!1;else for(var g=a.length;g<i.length;g++)s[g]=!0;for(var d=Math.min(i.length,a.length),h=0;h<d;h++)void 0===s[h]&&e(i[h])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):r(e)}})}n.d(t,"a",(function(){return Re})),n.d(t,"b",(function(){return We}));var j,L,X="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),H="undefined"!=typeof Map,Y="undefined"!=typeof Set,z="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,K=X?Symbol.for("immer-nothing"):((j={})["immer-nothing"]=!0,j),_=X?Symbol.for("immer-draftable"):"__$immer_draftable",D=X?Symbol.for("immer-state"):"__$immer_state",P=("undefined"!=typeof Symbol&&Symbol.iterator,"undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames),U=Object.getOwnPropertyDescriptors||function(e){var t={};return P(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},J={},Q={get:function(e,t){if(t===D)return e;var n=f(e);if(!u(n,t))return function(e,t,n){var r,a=O(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!i(r)?r:r===N(e.t,t)?(F(e),e.o[t]=M(e.A.h,r,e)):r},has:function(e,t){return t in f(e)},ownKeys:function(e){return Reflect.ownKeys(f(e))},set:function(e,t,n){var r=O(f(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var a=N(f(e),t),i=null==a?void 0:a[D];if(i&&i.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(g(n,a)&&(void 0!==n||u(e.t,t)))return!0;F(e),W(e)}return e.o[t]=n,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==N(e.t,t)||t in e.t?(e.D[t]=!1,F(e),W(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=f(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){r(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){r(12)}},q={};o(Q,(function(e,t){q[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),q.deleteProperty=function(e,t){return Q.deleteProperty.call(this,e[0],t)},q.set=function(e,t,n){return Q.set.call(this,e[0],t,n,e[0])};var $=new(function(){function e(e){this.O=z,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,n){if("function"==typeof e&&"function"!=typeof t){var a=t;t=e;var o=this;return function(e){var n=this;void 0===e&&(e=a);for(var r=arguments.length,i=Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return o.produce(e,(function(e){var r;return(r=t).call.apply(r,[n,e].concat(i))}))}}var s;if("function"!=typeof t&&r(6),void 0!==n&&"function"!=typeof n&&r(7),i(e)){var u=B(this),c=M(this,e,void 0),l=!0;try{s=t(c),l=!1}finally{l?w(u):G(u)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(e){return y(u,n),S(e,u)}),(function(e){throw w(u),e})):(y(u,n),S(s,u))}if(!e||"object"!=typeof e){if((s=t(e))===K)return;return void 0===s&&(s=e),this.N&&I(s,!0),s}r(21,e)},t.produceWithPatches=function(e,t){var n,r,a=this;return"function"==typeof e?function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return a.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(r))}))}:[this.produce(e,t,(function(e,t){n=e,r=t})),n,r]},t.createDraft=function(e){i(e)||r(8),a(e)&&(e=V(e));var t=B(this),n=M(this,e,void 0);return n[D].C=!0,G(t),n},t.finishDraft=function(e,t){var n=(e&&e[D]).A;return y(n,t),S(void 0,n)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!z&&r(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var i=b("Patches").$;return a(e)?i(e,t):this.produce(e,(function(e){return i(e,t.slice(n+1))}))},e}()),ee=$.produce,te=($.produceWithPatches.bind($),$.setAutoFreeze.bind($),$.setUseProxies.bind($),$.applyPatches.bind($),$.createDraft.bind($),$.finishDraft.bind($),ee),ne=n(215);function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){Object(ne.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var oe="function"===typeof Symbol&&Symbol.observable||"@@observable",se=function(){return Math.random().toString(36).substring(7).split("").join(".")},ue={INIT:"@@redux/INIT"+se(),REPLACE:"@@redux/REPLACE"+se(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+se()}};function ce(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function le(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(ie(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(ie(1));return n(le)(e,t)}if("function"!==typeof e)throw new Error(ie(2));var a=e,i=t,o=[],s=o,u=!1;function c(){s===o&&(s=o.slice())}function l(){if(u)throw new Error(ie(3));return i}function g(e){if("function"!==typeof e)throw new Error(ie(4));if(u)throw new Error(ie(5));var t=!0;return c(),s.push(e),function(){if(t){if(u)throw new Error(ie(6));t=!1,c();var n=s.indexOf(e);s.splice(n,1),o=null}}}function d(e){if(!ce(e))throw new Error(ie(7));if("undefined"===typeof e.type)throw new Error(ie(8));if(u)throw new Error(ie(9));try{u=!0,i=a(i,e)}finally{u=!1}for(var t=o=s,n=0;n<t.length;n++){(0,t[n])()}return e}function h(e){if("function"!==typeof e)throw new Error(ie(10));a=e,d({type:ue.REPLACE})}function f(){var e,t=g;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(ie(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[oe]=function(){return this},e}return d({type:ue.INIT}),(r={dispatch:d,subscribe:g,getState:l,replaceReducer:h})[oe]=f,r}function ge(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var a=t[r];0,"function"===typeof e[a]&&(n[a]=e[a])}var i,o=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:ue.INIT}))throw new Error(ie(12));if("undefined"===typeof n(void 0,{type:ue.PROBE_UNKNOWN_ACTION()}))throw new Error(ie(13))}))}(n)}catch(s){i=s}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var r=!1,a={},s=0;s<o.length;s++){var u=o[s],c=n[u],l=e[u],g=c(l,t);if("undefined"===typeof g){t&&t.type;throw new Error(ie(14))}a[u]=g,r=r||g!==l}return(r=r||o.length!==Object.keys(e).length)?a:e}}function de(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function he(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(ie(15))},a={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map((function(e){return e(a)}));return r=de.apply(void 0,i)(n.dispatch),ae(ae({},n),{},{dispatch:r})}}}function fe(e,t){return e===t}function pe(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,a=0;a<r;a++)if(!e(t[a],n[a]))return!1;return!0}function Ie(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"===typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}!function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r]}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe,n=null,r=null;return function(){return pe(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}}));function Ce(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(a){return"function"===typeof a?a(n,r,e):t(a)}}}}var me=Ce();me.withExtraArgument=Ce;var be=me;function ve(){return(ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ae(e){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function we(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ge(e,t,n){return(Ge=we()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&ye(a,n.prototype),a}).apply(null,arguments)}function Be(e){var t="function"===typeof Map?new Map:void 0;return(Be=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Ge(e,arguments,Ae(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ye(r,e)})(e)}var xe="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"===typeof arguments[0]?de:de.apply(null,arguments)};function Se(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var ke=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.concat=function(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return Ge(r,(t=e.prototype.concat).call.apply(t,[this].concat(a)))},a.prepend=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 1===t.length&&Array.isArray(t[0])?Ge(r,t[0].concat(this)):Ge(r,t.concat(this))},r}(Be(Array));function Ze(){return function(e){return function(e){void 0===e&&(e={});var t=e,n=t.thunk,r=void 0===n||n,a=(t.immutableCheck,t.serializableCheck,new ke);r&&(!function(e){return"boolean"===typeof e}(r)?a.push(be.withExtraArgument(r.extraArgument)):a.push(be));0;return a}(e)}}function Re(e){var t,n=Ze(),r=e||{},a=r.reducer,i=void 0===a?void 0:a,o=r.middleware,s=void 0===o?n():o,u=r.devTools,c=void 0===u||u,l=r.preloadedState,g=void 0===l?void 0:l,d=r.enhancers,h=void 0===d?void 0:d;if("function"===typeof i)t=i;else{if(!Se(i))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=ge(i)}var f=he.apply(void 0,"function"===typeof s?s(n):s),p=de;c&&(p=xe(ve({trace:!1},"object"===typeof c&&c)));var I=[f];return Array.isArray(h)?I=[f].concat(h):"function"===typeof h&&(I=h(I)),le(t,g,p.apply(void 0,I))}function Ne(e,t){function n(){if(t){var n=t.apply(void 0,arguments);if(!n)throw new Error("prepareAction did not return an object");return ve({type:e,payload:n.payload},"meta"in n&&{meta:n.meta},{},"error"in n&&{error:n.error})}return{type:e,payload:arguments.length<=0?void 0:arguments[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function Oe(e){var t,n={},r=[],a={addCase:function(e,t){var r="string"===typeof e?e:e.type;if(r in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[r]=t,a},addMatcher:function(e,t){return r.push({matcher:e,reducer:t}),a},addDefaultCase:function(e){return t=e,a}};return e(a),[n,r,t]}function We(e){var t=e.name,n=e.initialState;if(!t)throw new Error("`name` is a required option for createSlice");var r=e.reducers||{},o="undefined"===typeof e.extraReducers?[]:"function"===typeof e.extraReducers?Oe(e.extraReducers):[e.extraReducers],s=o[0],u=void 0===s?{}:s,c=o[1],l=void 0===c?[]:c,g=o[2],d=void 0===g?void 0:g,h=Object.keys(r),f={},p={},I={};h.forEach((function(e){var n,a,i=r[e],o=t+"/"+e;"reducer"in i?(n=i.reducer,a=i.prepare):n=i,f[e]=n,p[o]=n,I[e]=a?Ne(o,a):Ne(o)}));var C=function(e,t,n,r){void 0===n&&(n=[]);var o="function"===typeof t?Oe(t):[t,n,r],s=o[0],u=o[1],c=o[2],l=te(e,(function(){}));return function(e,t){void 0===e&&(e=l);var n=[s[t.type]].concat(u.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===n.filter((function(e){return!!e})).length&&(n=[c]),n.reduce((function(e,n){if(n){if(a(e)){var r=n(e,t);return"undefined"===typeof r?e:r}if(i(e))return te(e,(function(e){return n(e,t)}));var o=n(e,t);if("undefined"===typeof o){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return o}return e}),e)}}(n,ve({},u,{},p),l,d);return{name:t,reducer:C,actions:I,caseReducers:f}}"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));E()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(207);var a=n(344),i=n(259);function o(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||Object(a.a)(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(340);var a=n(259),i=n(341);function o(e,t){return Object(r.a)(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}}(e,t)||Object(a.a)(e,t)||Object(i.a)()}},function(e,t,n){var r=n(432),a=n(433),i=n(434),o=n(435),s=n(436),u=n(437),c=n(438);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(22),a=n(188);var i=n(91);function o(e){var t="function"===typeof Map?new Map:void 0;return(o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return Object(i.a)(e,arguments,Object(r.a)(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Object(a.a)(o,e)})(e)}},function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(r||(r={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","mean"),s={x:o},u={axis:t,keepDims:n};return r.a.runKernel(a.Pb,s,u)}})},function(e,t,n){"use strict";var r,a,i,o,s;n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(o||(o={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(s||(s={}));var u={float32:o,int32:a,bool:i,complex64:s};function c(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return u[e][t]}function l(e){return c(e,"int32")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),a=n(62),i=!0,o=!1,s=null,u={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function c(e){e.metaKey||e.altKey||e.ctrlKey||(i=!0)}function l(){i=!1}function g(){"hidden"===this.visibilityState&&o&&(i=!0)}function d(e){var t=e.target;try{return t.matches(":focus-visible")}catch(n){}return i||function(e){var t=e.type,n=e.tagName;return!("INPUT"!==n||!u[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}function h(){o=!0,window.clearTimeout(s),s=window.setTimeout((function(){o=!1}),100)}function f(){return{isFocusVisible:d,onBlurVisible:h,ref:r.useCallback((function(e){var t,n=a.findDOMNode(e);null!=n&&((t=n.ownerDocument).addEventListener("keydown",c,!0),t.addEventListener("mousedown",l,!0),t.addEventListener("pointerdown",l,!0),t.addEventListener("touchstart",l,!0),t.addEventListener("visibilitychange",g,!0))}),[])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({batchToSpaceND_:function(e,t,n){var s=Object(i.a)(e,"x","batchToSpaceND"),u=t.reduce((function(e,t){return e*t}));o.b(s.rank>=1+t.length,(function(){return"input rank is ".concat(s.rank," but should be > than blockShape.length ").concat(t.length)})),o.b(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.b(s.shape[0]%u===0,(function(){return"input tensor batch is ".concat(s.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(u)}));var c={x:s},l={blockShape:t,crops:n};return r.a.runKernel(a.t,c,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10),u=n(18);var c=Object(s.b)({depthwiseConv2d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],g=arguments.length>6?arguments[6]:void 0,d=Object(i.a)(e,"x","depthwiseConv2d"),h=Object(i.a)(t,"filter","depthwiseConv2d"),f=d,p=!1;3===d.rank&&(p=!0,f=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===f.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(f.rank,".")})),o.b(4===h.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(h.rank,".")})),o.b(f.shape[3]===h.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(f.shape[3],") must match the inChannels dimension in ")+"filter ".concat(h.shape[2],".")})),null!=g&&o.b(o.v(s),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(g," but got pad ").concat(s,".")}));var I={x:f,filter:h},C={strides:n,pad:s,dataFormat:c,dilations:l,dimRoundingMode:g},m=r.a.runKernel(a.O,I,C);return p?Object(u.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({equal_:function(e,t){var n=Object(s.a)(e,"a","equal","string_or_numeric"),c=Object(s.a)(t,"b","equal","string_or_numeric"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.Y,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(11),a=n(6);function i(e,t,n){var i={shape:e,value:t,dtype:n};return r.a.runKernel(a.eb,{},i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=Object(i.a)(e,"x","gather"),u=Object(i.a)(t,"indices","gather","int32"),c={x:s,indices:u},l={axis:n,batchDims:o};return r.a.runKernel(a.nb,c,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({logicalNot_:function(e){var t={x:Object(i.a)(e,"x","logicalNot","bool")};return r.a.runKernel(a.Gb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(27),l=n(10);var g=Object(l.b)({maximum_:function(e,t){var n=Object(s.a)(e,"a","maximum"),l=Object(s.a)(t,"b","maximum"),g=Object(o.makeTypesMatch)(n,l),d=Object(r.a)(g,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=Object(c.a)(n,"int32"),l=Object(c.a)(l,"int32")),Object(u.a)(n.shape,l.shape);var h={a:n,b:l};return a.a.runKernel(i.Ob,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({spaceToBatchND_:function(e,t,n){var s=Object(i.a)(e,"x","spaceToBatchND");o.b(s.rank>=1+t.length,(function(){return"input rank ".concat(s.rank," should be > than [blockShape] ").concat(t.length)})),o.b(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.b(s.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(s.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var u={x:s},c={blockShape:t,paddings:n};return r.a.runKernel(a.Hc,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),a=n(19),i=n(10),o=n(18);var s=Object(i.b)({squeeze_:function(e,t){var n=Object(r.a)(e,"x","squeeze");return Object(o.a)(n,Object(a.Q)(n.shape,t).newShape)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(206);function a(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return null==t?e:function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];e.apply(this,r),t.apply(this,r)}}),(function(){}))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(107),s=n(10),u=n(18);var c=Object(s.b)({broadcastTo_:function(e,t){var n=Object(i.a)(e,"broadcastTo","x"),s=n.shape;if(t.some((function(e){return!(e>0)||e%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var c=n.shape.slice();c.length<t.length;)c.unshift(1);n=Object(u.a)(n,c)}for(var l=n.shape,g=Array.from(t),d=t.length-1;d>=0;d--)if(l[d]===t[d])g[d]=1;else if(1!==n.shape[d])throw new Error("broadcastTo(): [".concat(s,"] cannot be broadcast to [").concat(t,"]."));if(0===g.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return Object(o.a)(n);var h={x:n},f={reps:g};return r.a.runKernel(a.ad,h,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}));var r=n(1),a=n(9),i=n(125),o=(n(191),function(){function e(t,n,a,o,s){Object(r.a)(this,e),this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var u=s||Math.random();this.random=i.alea(u.toString())}return Object(a.a)(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}()),s=function(){function e(t,n,a,s){Object(r.a)(this,e),this.alpha=t,this.beta=1/n,this.dtype=a;var u=s||Math.random();this.randu=i.alea(u.toString()),this.randn=new o(0,1,a,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return Object(a.a)(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),u=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(Object(r.a)(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=a-n,this.dtype=o,null==s&&(s=Math.random()),"number"===typeof s&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(a," <= 1 and dtype is not float"));this.random=i.alea(s)}return Object(a.a)(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(11),a=n(6);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var o={start:e,stop:t,step:n,dtype:i};return r.a.runKernel(a.ic,{},o)}},function(e,t,n){"use strict";var r=n(186),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(f){var a=h(n);a&&a!==f&&e(t,a,r)}var o=l(n);g&&(o=o.concat(g(n)));for(var s=u(t),p=u(n),I=0;I<o.length;++I){var C=o[I];if(!i[C]&&(!r||!r[C])&&(!p||!p[C])&&(!s||!s[C])){var m=d(n,C);try{c(t,C,m)}catch(b){}}}}return t}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i.if})),n.d(t,"e",(function(){return i.kf})),n.d(t,"f",(function(){return i.mf})),n.d(t,"c",(function(){return i.Qe})),n.d(t,"b",(function(){return qs})),n.d(t,"a",(function(){return r}));var r={};n.r(r),n.d(r,"inputLayer",(function(){return ul})),n.d(r,"elu",(function(){return cl})),n.d(r,"reLU",(function(){return ll})),n.d(r,"leakyReLU",(function(){return gl})),n.d(r,"prelu",(function(){return dl})),n.d(r,"softmax",(function(){return hl})),n.d(r,"thresholdedReLU",(function(){return fl})),n.d(r,"conv1d",(function(){return pl})),n.d(r,"conv2d",(function(){return Il})),n.d(r,"conv2dTranspose",(function(){return Cl})),n.d(r,"conv3d",(function(){return ml})),n.d(r,"conv3dTranspose",(function(){return bl})),n.d(r,"separableConv2d",(function(){return vl})),n.d(r,"cropping2D",(function(){return Al})),n.d(r,"upSampling2d",(function(){return yl})),n.d(r,"depthwiseConv2d",(function(){return wl})),n.d(r,"activation",(function(){return Gl})),n.d(r,"dense",(function(){return Bl})),n.d(r,"dropout",(function(){return xl})),n.d(r,"spatialDropout1d",(function(){return Sl})),n.d(r,"flatten",(function(){return kl})),n.d(r,"repeatVector",(function(){return Zl})),n.d(r,"reshape",(function(){return Rl})),n.d(r,"permute",(function(){return Nl})),n.d(r,"embedding",(function(){return Ol})),n.d(r,"add",(function(){return Wl})),n.d(r,"average",(function(){return Fl})),n.d(r,"concatenate",(function(){return Ml})),n.d(r,"maximum",(function(){return Vl})),n.d(r,"minimum",(function(){return Tl})),n.d(r,"multiply",(function(){return El})),n.d(r,"dot",(function(){return jl})),n.d(r,"batchNormalization",(function(){return Ll})),n.d(r,"layerNormalization",(function(){return Xl})),n.d(r,"zeroPadding2d",(function(){return Hl})),n.d(r,"averagePooling1d",(function(){return Yl})),n.d(r,"avgPool1d",(function(){return zl})),n.d(r,"avgPooling1d",(function(){return Kl})),n.d(r,"averagePooling2d",(function(){return _l})),n.d(r,"avgPool2d",(function(){return Dl})),n.d(r,"avgPooling2d",(function(){return Pl})),n.d(r,"averagePooling3d",(function(){return Ul})),n.d(r,"avgPool3d",(function(){return Jl})),n.d(r,"avgPooling3d",(function(){return Ql})),n.d(r,"globalAveragePooling1d",(function(){return ql})),n.d(r,"globalAveragePooling2d",(function(){return $l})),n.d(r,"globalMaxPooling1d",(function(){return eg})),n.d(r,"globalMaxPooling2d",(function(){return tg})),n.d(r,"maxPooling1d",(function(){return ng})),n.d(r,"maxPooling2d",(function(){return rg})),n.d(r,"maxPooling3d",(function(){return ag})),n.d(r,"gru",(function(){return ig})),n.d(r,"gruCell",(function(){return og})),n.d(r,"lstm",(function(){return sg})),n.d(r,"lstmCell",(function(){return ug})),n.d(r,"simpleRNN",(function(){return cg})),n.d(r,"simpleRNNCell",(function(){return lg})),n.d(r,"convLstm2d",(function(){return gg})),n.d(r,"convLstm2dCell",(function(){return dg})),n.d(r,"rnn",(function(){return hg})),n.d(r,"stackedRNNCells",(function(){return fg})),n.d(r,"bidirectional",(function(){return pg})),n.d(r,"timeDistributed",(function(){return Ig})),n.d(r,"globalMaxPool1d",(function(){return Cg})),n.d(r,"globalMaxPool2d",(function(){return mg})),n.d(r,"maxPool1d",(function(){return bg})),n.d(r,"maxPool2d",(function(){return vg})),n.d(r,"Layer",(function(){return oo})),n.d(r,"RNN",(function(){return ec})),n.d(r,"RNNCell",(function(){return tc})),n.d(r,"input",(function(){return $s})),n.d(r,"gaussianNoise",(function(){return Ag})),n.d(r,"gaussianDropout",(function(){return yg})),n.d(r,"alphaDropout",(function(){return wg})),n.d(r,"masking",(function(){return Gg}));var a={};n.r(a),n.d(a,"abs",(function(){return Bg.b})),n.d(a,"acos",(function(){return Bg.c})),n.d(a,"acosh",(function(){return Bg.d})),n.d(a,"add",(function(){return Bg.e})),n.d(a,"addN",(function(){return Bg.f})),n.d(a,"all",(function(){return Bg.g})),n.d(a,"any",(function(){return Bg.h})),n.d(a,"argMax",(function(){return Bg.i})),n.d(a,"argMin",(function(){return Bg.j})),n.d(a,"asin",(function(){return Bg.k})),n.d(a,"asinh",(function(){return Bg.l})),n.d(a,"atan",(function(){return Bg.m})),n.d(a,"atan2",(function(){return Bg.n})),n.d(a,"atanh",(function(){return Bg.o})),n.d(a,"avgPool",(function(){return Bg.p})),n.d(a,"avgPool3d",(function(){return Bg.q})),n.d(a,"basicLSTMCell",(function(){return Bg.r})),n.d(a,"batchToSpaceND",(function(){return Bg.w})),n.d(a,"batchNorm",(function(){return Bg.s})),n.d(a,"batchNorm2d",(function(){return Bg.t})),n.d(a,"batchNorm3d",(function(){return Bg.u})),n.d(a,"batchNorm4d",(function(){return Bg.v})),n.d(a,"bincount",(function(){return Bg.x})),n.d(a,"broadcastTo",(function(){return Bg.z})),n.d(a,"buffer",(function(){return Bg.A})),n.d(a,"cast",(function(){return Bg.B})),n.d(a,"ceil",(function(){return Bg.C})),n.d(a,"clipByValue",(function(){return Bg.D})),n.d(a,"clone",(function(){return Bg.E})),n.d(a,"complex",(function(){return Bg.F})),n.d(a,"concat",(function(){return Bg.G})),n.d(a,"concat1d",(function(){return Bg.H})),n.d(a,"concat2d",(function(){return Bg.I})),n.d(a,"concat3d",(function(){return Bg.J})),n.d(a,"concat4d",(function(){return Bg.K})),n.d(a,"conv1d",(function(){return Bg.L})),n.d(a,"conv2d",(function(){return Bg.M})),n.d(a,"conv2dTranspose",(function(){return Bg.N})),n.d(a,"conv3d",(function(){return Bg.O})),n.d(a,"conv3dTranspose",(function(){return Bg.P})),n.d(a,"cos",(function(){return Bg.Q})),n.d(a,"cosh",(function(){return Bg.R})),n.d(a,"cumsum",(function(){return Bg.T})),n.d(a,"denseBincount",(function(){return Bg.U})),n.d(a,"depthToSpace",(function(){return Bg.V})),n.d(a,"depthwiseConv2d",(function(){return Bg.W})),n.d(a,"diag",(function(){return Bg.X})),n.d(a,"dilation2d",(function(){return Bg.Y})),n.d(a,"div",(function(){return Bg.Z})),n.d(a,"divNoNan",(function(){return Bg.ab})),n.d(a,"dot",(function(){return Bg.bb})),n.d(a,"einsum",(function(){return Bg.db})),n.d(a,"elu",(function(){return Bg.eb})),n.d(a,"equal",(function(){return Bg.gb})),n.d(a,"erf",(function(){return Bg.hb})),n.d(a,"exp",(function(){return Bg.ib})),n.d(a,"expandDims",(function(){return Bg.jb})),n.d(a,"expm1",(function(){return Bg.kb})),n.d(a,"eye",(function(){return Bg.lb})),n.d(a,"fill",(function(){return Bg.nb})),n.d(a,"floor",(function(){return Bg.ob})),n.d(a,"floorDiv",(function(){return Bg.pb})),n.d(a,"gather",(function(){return Bg.rb})),n.d(a,"greater",(function(){return Bg.tb})),n.d(a,"greaterEqual",(function(){return Bg.ub})),n.d(a,"imag",(function(){return Bg.wb})),n.d(a,"isFinite",(function(){return Bg.Ab})),n.d(a,"isInf",(function(){return Bg.Bb})),n.d(a,"isNaN",(function(){return Bg.Cb})),n.d(a,"leakyRelu",(function(){return Bg.Db})),n.d(a,"less",(function(){return Bg.Eb})),n.d(a,"lessEqual",(function(){return Bg.Fb})),n.d(a,"linspace",(function(){return Bg.Hb})),n.d(a,"localResponseNormalization",(function(){return Bg.Ib})),n.d(a,"log",(function(){return Bg.Jb})),n.d(a,"log1p",(function(){return Bg.Kb})),n.d(a,"logSigmoid",(function(){return Bg.Lb})),n.d(a,"logSoftmax",(function(){return Bg.Mb})),n.d(a,"logSumExp",(function(){return Bg.Nb})),n.d(a,"logicalAnd",(function(){return Bg.Ob})),n.d(a,"logicalNot",(function(){return Bg.Pb})),n.d(a,"logicalOr",(function(){return Bg.Qb})),n.d(a,"logicalXor",(function(){return Bg.Rb})),n.d(a,"matMul",(function(){return Bg.Tb})),n.d(a,"max",(function(){return Bg.Ub})),n.d(a,"maxPool",(function(){return Bg.Vb})),n.d(a,"maxPool3d",(function(){return Bg.Wb})),n.d(a,"maxPoolWithArgmax",(function(){return Bg.Xb})),n.d(a,"maximum",(function(){return Bg.Yb})),n.d(a,"mean",(function(){return Bg.Zb})),n.d(a,"meshgrid",(function(){return Bg.ac})),n.d(a,"min",(function(){return Bg.bc})),n.d(a,"minimum",(function(){return Bg.cc})),n.d(a,"mirrorPad",(function(){return Bg.dc})),n.d(a,"mod",(function(){return Bg.ec})),n.d(a,"moments",(function(){return Bg.fc})),n.d(a,"mul",(function(){return Bg.hc})),n.d(a,"multiRNNCell",(function(){return Bg.ic})),n.d(a,"multinomial",(function(){return Bg.jc})),n.d(a,"neg",(function(){return Bg.kc})),n.d(a,"notEqual",(function(){return Bg.mc})),n.d(a,"oneHot",(function(){return Bg.nc})),n.d(a,"ones",(function(){return Bg.oc})),n.d(a,"onesLike",(function(){return Bg.pc})),n.d(a,"outerProduct",(function(){return Bg.rc})),n.d(a,"pad",(function(){return Bg.sc})),n.d(a,"pad1d",(function(){return Bg.tc})),n.d(a,"pad2d",(function(){return Bg.uc})),n.d(a,"pad3d",(function(){return Bg.vc})),n.d(a,"pad4d",(function(){return Bg.wc})),n.d(a,"pool",(function(){return Bg.xc})),n.d(a,"pow",(function(){return Bg.yc})),n.d(a,"prelu",(function(){return Bg.zc})),n.d(a,"print",(function(){return Bg.Ac})),n.d(a,"prod",(function(){return Bg.Bc})),n.d(a,"rand",(function(){return Bg.Cc})),n.d(a,"randomGamma",(function(){return Bg.Dc})),n.d(a,"randomNormal",(function(){return Bg.Ec})),n.d(a,"randomUniform",(function(){return Bg.Fc})),n.d(a,"range",(function(){return Bg.Gc})),n.d(a,"real",(function(){return Bg.Hc})),n.d(a,"reciprocal",(function(){return Bg.Ic})),n.d(a,"relu",(function(){return Bg.Jc})),n.d(a,"relu6",(function(){return Bg.Kc})),n.d(a,"reshape",(function(){return Bg.Lc})),n.d(a,"reverse",(function(){return Bg.Mc})),n.d(a,"reverse1d",(function(){return Bg.Nc})),n.d(a,"reverse2d",(function(){return Bg.Oc})),n.d(a,"reverse3d",(function(){return Bg.Pc})),n.d(a,"reverse4d",(function(){return Bg.Qc})),n.d(a,"round",(function(){return Bg.Sc})),n.d(a,"rsqrt",(function(){return Bg.Tc})),n.d(a,"scalar",(function(){return Bg.Uc})),n.d(a,"selu",(function(){return Bg.Wc})),n.d(a,"separableConv2d",(function(){return Bg.Xc})),n.d(a,"setdiff1dAsync",(function(){return Bg.Yc})),n.d(a,"sigmoid",(function(){return Bg.Zc})),n.d(a,"sign",(function(){return Bg.ad})),n.d(a,"sin",(function(){return Bg.cd})),n.d(a,"sinh",(function(){return Bg.dd})),n.d(a,"slice",(function(){return Bg.ed})),n.d(a,"slice1d",(function(){return Bg.fd})),n.d(a,"slice2d",(function(){return Bg.gd})),n.d(a,"slice3d",(function(){return Bg.hd})),n.d(a,"slice4d",(function(){return Bg.id})),n.d(a,"softmax",(function(){return Bg.jd})),n.d(a,"softplus",(function(){return Bg.kd})),n.d(a,"spaceToBatchND",(function(){return Bg.ld})),n.d(a,"fft",(function(){return Bg.mb})),n.d(a,"ifft",(function(){return Bg.vb})),n.d(a,"irfft",(function(){return Bg.zb})),n.d(a,"rfft",(function(){return Bg.Rc})),n.d(a,"split",(function(){return Bg.pd})),n.d(a,"sqrt",(function(){return Bg.qd})),n.d(a,"square",(function(){return Bg.rd})),n.d(a,"squaredDifference",(function(){return Bg.sd})),n.d(a,"squeeze",(function(){return Bg.td})),n.d(a,"stack",(function(){return Bg.ud})),n.d(a,"step",(function(){return Bg.vd})),n.d(a,"stridedSlice",(function(){return Bg.wd})),n.d(a,"sub",(function(){return Bg.yd})),n.d(a,"sum",(function(){return Bg.zd})),n.d(a,"tan",(function(){return Bg.Ad})),n.d(a,"tanh",(function(){return Bg.Bd})),n.d(a,"tensor",(function(){return Bg.Cd})),n.d(a,"tensor1d",(function(){return Bg.Dd})),n.d(a,"tensor2d",(function(){return Bg.Ed})),n.d(a,"tensor3d",(function(){return Bg.Fd})),n.d(a,"tensor4d",(function(){return Bg.Gd})),n.d(a,"tensor5d",(function(){return Bg.Hd})),n.d(a,"tensor6d",(function(){return Bg.Id})),n.d(a,"tile",(function(){return Bg.Jd})),n.d(a,"topk",(function(){return Bg.Kd})),n.d(a,"truncatedNormal",(function(){return Bg.Md})),n.d(a,"unique",(function(){return Bg.Nd})),n.d(a,"unsortedSegmentSum",(function(){return Bg.Od})),n.d(a,"unstack",(function(){return Bg.Pd})),n.d(a,"variable",(function(){return Bg.Qd})),n.d(a,"where",(function(){return Bg.Rd})),n.d(a,"whereAsync",(function(){return Bg.Sd})),n.d(a,"zeros",(function(){return Bg.Td})),n.d(a,"zerosLike",(function(){return Bg.Ud})),n.d(a,"booleanMaskAsync",(function(){return Bg.y})),n.d(a,"transpose",(function(){return Bg.Ld})),n.d(a,"norm",(function(){return Bg.lc})),n.d(a,"movingAverage",(function(){return Bg.gc})),n.d(a,"scatterND",(function(){return Bg.Vc})),n.d(a,"sparseToDense",(function(){return Bg.nd})),n.d(a,"gatherND",(function(){return Bg.sb})),n.d(a,"dropout",(function(){return Bg.cb})),n.d(a,"enclosingPowerOfTwo",(function(){return Bg.fb})),n.d(a,"cosineWindow",(function(){return Bg.S})),n.d(a,"inTopKAsync",(function(){return Bg.yb})),n.d(a,"op",(function(){return Bg.qc})),n.d(a,"OP_SCOPE_SUFFIX",(function(){return Bg.a})),n.d(a,"image",(function(){return Bg.xb})),n.d(a,"linalg",(function(){return Bg.Gb})),n.d(a,"losses",(function(){return Bg.Sb})),n.d(a,"spectral",(function(){return Bg.od})),n.d(a,"fused",(function(){return Bg.qb})),n.d(a,"signal",(function(){return Bg.bd})),n.d(a,"sparse",(function(){return Bg.md})),n.d(a,"string",(function(){return Bg.xd}));var i=n(0),o=n(3),s=n(6),u=n(27),c=n(20),l=n(116),g={kernelName:s.a,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(l.a)(Object(u.a)(n,"float32"),-1))}}}},d=n(30),h=n(49),f=n(32),p=n(65),I=n(43),C=n(29),m={kernelName:s.b,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){var t=Object(I.a)(Object(u.a)(n,"float32")),r=Object(p.a)(Object(C.a)(Object(f.a)(1),t));return Object(h.a)(Object(d.a)(e,r))}}}},b={kernelName:s.c,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){var t=Object(p.a)(Object(C.a)(Object(I.a)(Object(u.a)(n,"float32")),1));return Object(d.a)(e,t)}}}},v=n(33),A=n(18),y=n(31),w={kernelName:s.d,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=v.a(r.shape,a.shape);return{a:function(){var t=e,n=v.c(r.shape,i);return n.length>0&&(t=Object(y.a)(t,n)),Object(A.a)(t,r.shape)},b:function(){var t=e,n=v.c(a.shape,i);return n.length>0&&(t=Object(y.a)(t,n)),Object(A.a)(t,a.shape)}}}},G={kernelName:s.e,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},B=n(34),x={kernelName:s.h,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(B.a)(n)}}}},S={kernelName:s.i,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(B.a)(n)}}}},k={kernelName:s.j,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(p.a)(Object(C.a)(Object(f.a)(1),Object(I.a)(Object(u.a)(n,"float32")))))}}}},Z=n(28),R={kernelName:s.k,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){var t=Object(p.a)(Object(Z.a)(Object(f.a)(1),Object(I.a)(Object(u.a)(n,"float32"))));return Object(d.a)(e,t)}}}},N={kernelName:s.m,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(v.a)(r.shape,a.shape);return{a:function(){var t=Object(Z.a)(Object(I.a)(r),Object(I.a)(a)),n=Object(c.a)(e,Object(d.a)(a,t)),o=Object(v.c)(r.shape,i);return o.length>0&&(n=Object(y.a)(n,o)),Object(A.a)(n,r.shape)},b:function(){var t=Object(Z.a)(Object(I.a)(r),Object(I.a)(a)),n=Object(h.a)(Object(c.a)(e,Object(d.a)(r,t))),o=Object(v.c)(a.shape,i);return o.length>0&&(n=Object(y.a)(n,o)),Object(A.a)(n,a.shape)}}}},O={kernelName:s.l,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(Z.a)(Object(I.a)(Object(u.a)(n,"float32")),1))}}}},W={kernelName:s.n,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(C.a)(Object(f.a)(1),Object(I.a)(Object(u.a)(n,"float32"))))}}}},F=n(11),M=n(5),V=n(19),T=n(10);var E=Object(T.b)({avgPool3dGrad_:function(e,t,n,r,a,i){var o=Object(M.a)(e,"dy","avgPool3dGrad"),u=Object(M.a)(t,"input","avgPool3dGrad"),c=o,l=u,g=!1;4===u.rank&&(g=!0,c=Object(A.a)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=Object(A.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),V.b(5===c.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(c.rank,".")})),V.b(5===l.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,".")})),null!=i&&V.b(V.v(a),(function(){return"Error in avgPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(i," but got pad ").concat(a,".")}));var d={dy:c,input:l},h={filterSize:n,strides:r,pad:a,dimRoundingMode:i},f=F.a.runKernel(s.q,d,h);return g?Object(A.a)(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),j={kernelName:s.p,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.filterSize,i=n.strides,s=n.pad,u=n.dimRoundingMode;return{x:function(){return E(e,r,a,i,s,u)}}}};var L=Object(T.b)({avgPoolGrad_:function(e,t,n,r,a){var i=Object(M.a)(e,"dy","avgPoolGrad"),o=Object(M.a)(t,"input","avgPoolGrad");V.b(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var u=o,c=i,l=!1;3===o.rank&&(l=!0,u=Object(A.a)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=Object(A.a)(i,[1,i.shape[0],i.shape[1],i.shape[2]])),V.b(4===c.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,".")})),V.b(4===u.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")}));var g={dy:c,input:u},d={filterSize:n,strides:r,pad:a},h=F.a.runKernel(s.r,g,d);return l?Object(A.a)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),X={kernelName:s.o,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.filterSize,i=n.strides,s=n.pad;return{x:function(){return L(e,r,a,i,s)}}}},H=n(44),Y={kernelName:s.s,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.transposeA,u=n.transposeB;return s||u?!s&&u?{a:function(){return Object(H.a)(e,i,!1,!1)},b:function(){return Object(H.a)(e,a,!0,!1)}}:s&&!u?{a:function(){return Object(H.a)(i,e,!1,!0)},b:function(){return Object(H.a)(a,e,!1,!1)}}:{a:function(){return Object(H.a)(i,e,!0,!0)},b:function(){return Object(H.a)(e,a,!0,!0)}}:{a:function(){return Object(H.a)(e,i,!1,!0)},b:function(){return Object(H.a)(a,e,!0,!1)}}}},z=n(139),K={kernelName:s.t,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return Object(z.a)(e,r,a)}}}},_={kernelName:s.v,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var u=[],c=0;c<o.length;c++)o[c]>1&&u.push(c);return{x:function(){return Object(y.a)(e,u,!0)}}}},D={kernelName:s.w,gradFunc:function(e){return{x:function(){return e.clone()}}}},P={kernelName:s.x,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},U=n(104),J=n(87),Q=n(94),q=n(55),$={kernelName:s.y,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.clipValueMin,i=n.clipValueMax;return{x:function(){return Object(q.a)(Object(Q.a)(Object(U.a)(r,a),Object(J.a)(r,i)),e,Object(B.a)(e))}}}},ee={kernelName:s.A,inputsToSave:["x"],gradFunc:g.gradFunc},te=n(95),ne={kernelName:s.B,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=n.axis,i=Object(V.I)(a,t[0].shape)[0],o=r.map((function(e){return e[i]}));return Object(te.a)(e,o,i).map((function(e){return function(){return e}}))}},re=n(192),ae=n(190),ie=n(53),oe={kernelName:s.C,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.dilations,u=n.strides,c=n.pad,l=n.dataFormat;return V.b(ie.i(s),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(s,"'")})),{x:function(){return Object(ae.a)(a.shape,e,i,u,c,l)},filter:function(){return Object(re.a)(a,e,i.shape,u,c,l)}}}},se=n(103),ue={kernelName:s.E,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.strides,u=n.pad,c=n.dataFormat,l=n.dimRoundingMode;return{dy:function(){return Object(se.a)(e,i,s,u,c,1,l)},filter:function(){return Object(re.a)(e,a,i.shape,s,u,c,l)}}}};var ce=Object(T.b)({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=Object(A.a)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=Object(A.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),V.b(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),V.b(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),V.b(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),V.b(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),V.b(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var u={x:i,dy:o},c={strides:r,pad:a,filterShape:n};return F.a.runKernel(s.G,u,c)}}),le=n(267),ge={kernelName:s.F,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;V.b(Object(ie.i)(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var s=Object(o.a)(t,2),u=s[0],c=s[1];return{x:function(){return Object(le.a)(u.shape,e,c,a,i)},filter:function(){return ce(u,e,c.shape,a,i)}}}},de=n(248),he={kernelName:s.I,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(h.a)(Object(de.a)(Object(u.a)(n,"float32"))),e)}}}},fe=n(249),pe={kernelName:s.J,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(fe.a)(Object(u.a)(n,"float32")),e)}}}},Ie=n(67),Ce=n(167),me=n(89),be={kernelName:s.L,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.axis,i=n.exclusive,s=n.reverse;return{x:function(){var t=Object(Ie.f)([a],r.rank),n=Object(Ce.a)(e,a,i,!s);return null!=t&&(n=Object(me.a)(n,t)),n}}}},ve=n(271),Ae=n(270),ye={kernelName:s.O,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,s=n.dimRoundingMode,u=null==r?[1,1]:r;V.b(ie.i(u),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var c=Object(o.a)(t,2),l=c[0],g=c[1];return V.b(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")})),V.b(4===g.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(g.rank,".")})),V.b(l.shape[3]===g.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(g.shape[2],".")})),V.b(ie.h(a,u),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(u,"'.")})),null!=s&&V.b(V.v(i),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(s," but got pad ").concat(i,".")})),{x:function(){return Object(Ae.a)(l.shape,e,g,a,i,r,s)},filter:function(){return Object(ve.a)(l,e,g.shape,a,i,r,s)}}}},we={kernelName:s.S,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],u={x:a,filter:i,dy:e},c={x:a,filter:i,dy:e};return{x:function(){return F.a.runKernel(s.U,u,n)},filter:function(){return F.a.runKernel(s.T,c,n)}}}},Ge={kernelName:s.W,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:Object(o.a)(t,1)[0]};return{x:function(){return F.a.runKernel(s.X,n)}}}},Be=n(69),xe={kernelName:s.Z,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0],r=Object(c.a)(Object(Be.a)(Object(h.a)(Object(I.a)(n))),2/Math.sqrt(Math.PI));return{x:function(){return Object(c.a)(e,r)}}}},Se={kernelName:s.ab,outputsToSave:[!0],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,n)}}}},ke={kernelName:s.bb,inputsToSave:["input"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{input:function(){return Object(A.a)(e,n.shape)}}}},Ze={kernelName:s.cb,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(Be.a)(n))}}}},Re={kernelName:s.gb,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},Ne={kernelName:s.hb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(v.a)(r.shape,a.shape);return{a:function(){var t=Object(d.a)(e,Object(u.a)(a,"float32")),n=Object(v.c)(r.shape,i);return n.length>0?Object(A.a)(Object(y.a)(t,n),r.shape):t},b:function(){var t=Object(c.a)(e,Object(u.a)(r,"float32")),n=Object(v.c)(a.shape,i);n.length>0&&(t=Object(A.a)(Object(y.a)(t,n),a.shape));var o=Object(I.a)(a);return Object(h.a)(Object(d.a)(t,Object(u.a)(o,"float32")))}}}},Oe=n(245),We=n(120),Fe={kernelName:s.jb,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=Object(o.a)(t,4),i=a[0],s=a[1],u=a[2],l=a[3],g=null==l?Object(f.a)(1):l,d=Object(v.c)(s.shape,i.shape),h=[];if(1===s.rank){for(var p=0;p<i.shape.length-1;++p)h.push(i.shape[p]);h.push(1)}var I=Object(C.a)(i,s),m=Object(c.a)(e,g),b=Object(Oe.a)(Object(Z.a)(u,Object(f.a)(r))),w=Object(c.a)(Object(c.a)(Object(c.a)(b,b),b),Object(f.a)(-.5));return{x:function(){return 1===s.rank?Object(A.a)(Object(c.a)(Object(c.a)(e,Object(We.a)(Object(A.a)(b,[1,1,1,s.shape[0]]),h)),g),i.shape):Object(A.a)(Object(c.a)(Object(c.a)(e,b),g),i.shape)},mean:function(){var e=Object(c.a)(Object(c.a)(b,Object(f.a)(-1)),m);return 1===s.rank&&(e=Object(y.a)(e,d)),Object(A.a)(e,s.shape)},variance:function(){var e=Object(c.a)(Object(c.a)(w,I),m);return 1===s.rank&&(e=Object(y.a)(e,d)),Object(A.a)(e,s.shape)},scale:function(){var t=Object(c.a)(I,b),n=Object(c.a)(e,t);return 1===s.rank&&(n=Object(y.a)(n,d)),Object(A.a)(n,s.shape)},offset:function(){var t=e;return 1===s.rank&&(t=Object(y.a)(t,d)),Object(A.a)(t,s.shape)}}}},Me=n(184),Ve={kernelName:s.nb,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.axis,u=Object(V.I)(s,a.shape)[0];return{x:function(){var t=a.shape,n=i.size,r=t.slice(0,u),o=r.length,c=t.slice(s,t.length).slice(1),l=c.length,g=Te(0,o),d=Te(o+1,o+1+l),h=Ee([r,[n],c]),f=Object(A.a)(e,h),p=Object(A.a)(i,[n]),I=Ee([[o],g,d]),C=Object(me.a)(f,I),m=Object(Me.a)(C,p,a.shape[u]),b=Object(Ie.h)(I);return m=Object(me.a)(m,b)},indices:function(){return i}}}};function Te(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function Ee(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var je={kernelName:s.pb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1];return{a:function(){return Object(B.a)(r)},b:function(){return Object(B.a)(a)}}}},Le={kernelName:s.rb,gradFunc:function(e){return{x:function(){return Object(u.a)(e,"float32")}}}},Xe={kernelName:s.tb,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},He={kernelName:s.ub,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},Ye={kernelName:s.vb,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},ze=n(70),Ke={kernelName:s.yb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.alpha,i=Object(ze.a)(r,0);return{x:function(){return Object(q.a)(i,e,Object(c.a)(e,a))}}}},_e={kernelName:s.Db,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(Z.a)(n,1))}}}},De={kernelName:s.Cb,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(u.a)(n,"float32"))}}}},Pe={kernelName:s.Eb,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.axis;return{logits:function(){var t=Object(Be.a)(r);return Object(C.a)(e,Object(c.a)(Object(y.a)(e,a,!0),t))}}}};var Ue=Object(T.b)({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,u={x:e,y:t,dy:n},c={depthRadius:r,bias:a,alpha:i,beta:o};return F.a.runKernel(s.xb,u,c)}}),Je={kernelName:s.wb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.depthRadius,u=n.bias,c=n.alpha,l=n.beta;return{x:function(){return Ue(a,i,e,s,u,c,l)}}}},Qe=n(134);function qe(e,t,n,r){return t.rank<n.rank&&(t=Object(A.a)(t,Ie.e(t.shape,r))),e.rank<n.rank&&(e=Object(A.a)(e,Ie.e(e.shape,r))),{x:function(){return Object(c.a)(e,Object(u.a)(Object(Qe.a)(n,t),e.dtype))}}}var $e={kernelName:s.Ib,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=qe(e,t[1],a,V.I(r,a.shape));return{x:function(){return i.x()}}}},et=n(173),tt={kernelName:s.Ob,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1];return{a:function(){return Object(c.a)(e,Object(u.a)(Object(U.a)(r,a),"float32"))},b:function(){return Object(c.a)(e,Object(u.a)(Object(et.a)(r,a),"float32"))}}}};var nt=Object(T.b)({maxPool3dGrad_:function(e,t,n,r,a,i,o){var u=Object(M.a)(e,"dy","maxPool3dGrad"),c=Object(M.a)(t,"input","maxPool3dGrad"),l=Object(M.a)(n,"output","maxPool3dGrad"),g=u,d=c,h=l,f=!1;4===c.rank&&(f=!0,g=Object(A.a)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),d=Object(A.a)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),h=Object(A.a)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),V.b(5===g.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(g.rank,".")})),V.b(5===d.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(d.rank,".")})),V.b(5===h.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(h.rank,".")})),null!=o&&V.b(V.v(i),(function(){return"Error in maxPool3dGrad: pad must be an integer when "+"using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var p={dy:g,input:d,output:h},I={filterSize:r,strides:a,pad:i,dimRoundingMode:o},C=F.a.runKernel(s.Lb,p,I);return f?Object(A.a)(C,[C.shape[1],C.shape[2],C.shape[3],C.shape[4]]):C}}),rt={kernelName:s.Kb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.filterSize,u=n.strides,c=n.pad,l=n.dimRoundingMode;return{x:function(){return nt(e,a,i,s,u,c,l)}}}};var at=Object(T.b)({maxPoolGrad_:function(e,t,n,r,a,i,o){var u=Object(M.a)(e,"dy","maxPoolGrad"),c=Object(M.a)(t,"input","maxPoolGrad"),l=Object(M.a)(n,"output","maxPoolGrad");V.b(c.rank===u.rank,(function(){return"Rank of input (".concat(c.rank,") does not match rank of dy ")+"(".concat(u.rank,")")})),V.b(4===u.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),V.b(4===c.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,".")})),null!=o&&V.b(V.v(i),(function(){return"Error in maxPoolGrad: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var g={dy:u,input:c,output:l},d={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return F.a.runKernel(s.Mb,g,d)}}),it={kernelName:s.Jb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(o.a)(t,2),a=r[0],i=r[1],s=n.filterSize,u=n.strides,c=n.pad;return{x:function(){return at(e,a,i,s,u,c)}}}},ot=n(86),st={kernelName:s.Pb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.axis,i=V.I(a,r.shape),s=Object(Ie.d)(r.shape,i)[1],u=V.O(s);return{x:function(){var t=r.shape.slice();i.forEach((function(e){t[e]=1}));var n=Object(A.a)(e,t);return Object(d.a)(Object(c.a)(n,Object(ot.a)(r.shape,"float32")),u)}}}},ut={kernelName:s.Qb,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=Object(o.a)(t,2),i=a[0],s=qe(e,a[1],i,V.I(r,i.shape));return{x:function(){return s.x()}}}},ct={kernelName:s.Rb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1];return{a:function(){return Object(c.a)(e,Object(u.a)(Object(J.a)(r,a),"float32"))},b:function(){return Object(c.a)(e,Object(u.a)(Object(ze.a)(r,a),"float32"))}}}},lt=n(45),gt={kernelName:s.Sb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Object(lt.a)(e,a,r.shape)}}}},dt=n(170),ht={kernelName:s.Tb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(v.a)(r.shape,a.shape);return{a:function(){var t=Object(v.c)(r.shape,i);return t.length>0?Object(A.a)(Object(y.a)(e,t),r.shape):e},b:function(){var t=Object(c.a)(e,Object(h.a)(Object(dt.a)(Object(d.a)(r,a)))),n=Object(v.c)(a.shape,i);return n.length>0?Object(A.a)(Object(y.a)(t,n),a.shape):t}}}},ft={kernelName:s.Vb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(v.a)(r.shape,a.shape);return{a:function(){var t=Object(c.a)(e,Object(u.a)(a,"float32")),n=Object(v.c)(r.shape,i);return n.length>0?Object(A.a)(Object(y.a)(t,n),r.shape):t},b:function(){var t=Object(c.a)(e,Object(u.a)(r,"float32")),n=Object(v.c)(a.shape,i);return n.length>0?Object(A.a)(Object(y.a)(t,n),a.shape):t}}}},pt={kernelName:s.Wb,gradFunc:function(e){return{x:function(){return Object(h.a)(e)}}}},It=n(114),Ct={kernelName:s.bc,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Object(It.a)(n.shape,"float32")}}}},mt={kernelName:s.cc,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},bt=n(117),vt={kernelName:s.dc,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return Object(bt.a)(e,r).map((function(e){return function(){return e}}))}},At={kernelName:s.ec,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return Object(lt.a)(e,a,r.shape)}}}},yt=n(112),wt=n(85),Gt={kernelName:s.fc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=Object(o.a)(t,3),r=n[0],a=n[1],i=n[2],s=r,l=a,g=v.a(s.shape,l.shape);return{a:function(){var t=Object(u.a)(l,"float32"),n=Object(c.a)(e,Object(c.a)(t,Object(wt.a)(s,Object(C.a)(t,Object(f.a)(1))))),r=v.c(s.shape,g);return r.length>0&&(n=Object(y.a)(n,r)),Object(A.a)(n,s.shape)},b:function(){var t=Object(ze.a)(s,0),n=Object(q.a)(t,Object(yt.a)(s),Object(B.a)(s)),r=Object(c.a)(e,Object(c.a)(i,n)),a=v.c(l.shape,g);return a.length>0&&(r=Object(y.a)(r,a)),Object(A.a)(r,l.shape)}}}},Bt={kernelName:s.gc,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(ze.a)(r,0);return{x:function(){return Object(q.a)(i,e,Object(c.a)(e,a))},alpha:function(){var t=Object(q.a)(i,Object(B.a)(e),Object(c.a)(e,r)),n=Object(v.c)(a.shape,e.shape);return n.length>0&&(t=Object(y.a)(t,n)),Object(A.a)(t,a.shape)}}}},xt={kernelName:s.kc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=v.a(r.shape,a.shape);return{a:function(){var t=Object(d.a)(e,Object(u.a)(a,"float32")),n=v.c(r.shape,i);return n.length>0?Object(A.a)(Object(y.a)(t,n),r.shape):t},b:function(){var t=Object(c.a)(e,Object(u.a)(r,"float32")),n=v.c(a.shape,i);n.length>0&&(t=Object(A.a)(Object(y.a)(t,n),a.shape));var o=Object(I.a)(a);return Object(h.a)(Object(d.a)(t,Object(u.a)(o,"float32")))}}}},St={kernelName:s.lc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(h.a)(Object(I.a)(n)))}}}},kt={kernelName:s.nc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0],r=Object(c.a)(Object(J.a)(n,6),Object(l.a)(n));return{x:function(){return Object(c.a)(e,Object(u.a)(r,"float32"))}}}},Zt={kernelName:s.mc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(u.a)(Object(l.a)(n),"float32"))}}}},Rt={kernelName:s.oc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(A.a)(e,n.shape)}}}},Nt={kernelName:s.pc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:Object(o.a)(t,1)[0]};return{images:function(){return F.a.runKernel(s.qc,r,n)}}}},Ot={kernelName:s.rc,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:Object(o.a)(t,1)[0]};return{images:function(){return F.a.runKernel(s.sc,r,n)}}}},Wt=n(77),Ft={kernelName:s.tc,gradFunc:function(e,t,n){var r=n.dims,a=Object(V.I)(r,e.shape);return{x:function(){return Object(Wt.a)(e,a)}}}},Mt={kernelName:s.vc,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},Vt={kernelName:s.wc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(h.a)(Object(d.a)(e,Object(c.a)(Object(wt.a)(n,1.5),2)))}}}},Tt=n(137),Et={kernelName:s.yc,inputsToSave:["condition"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{condition:function(){return Object(u.a)(Object(B.a)(n),"float32")},t:function(){return Object(c.a)(e,Object(u.a)(n,e.dtype))},e:function(){return Object(c.a)(e,Object(u.a)(Object(Tt.a)(n),e.dtype))}}}},jt=n(205),Lt={kernelName:s.zc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){var t=Object(ze.a)(n,Object(f.a)(0)),r=Object(f.a)(jt.b),a=Object(f.a)(jt.a),i=Object(c.a)(e,a),o=Object(c.a)(Object(c.a)(e,r),Object(Be.a)(Object(u.a)(n,"float32")));return Object(q.a)(t,i,o)}}}},Xt={kernelName:s.Ac,outputsToSave:[!0],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(c.a)(n,Object(C.a)(Object(f.a)(1),n)))}}}},Ht={kernelName:s.Bc,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},Yt=n(166),zt={kernelName:s.Cc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(Yt.a)(Object(u.a)(n,"float32")),e)}}}},Kt=n(229),_t={kernelName:s.Dc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(Kt.a)(Object(u.a)(n,"float32")),e)}}}},Dt=n(88),Pt=n(163),Ut={kernelName:s.Ec,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=Object(o.a)(t,1)[0],a=n.begin,i=n.size,s=r.shape,u=Object(Pt.parseSliceParams)(r,a,i),c=Object(o.a)(u,2),l=c[0],g=c[1],d=[],h=0;h<e.rank;h++)d.push([l[h],s[h]-l[h]-g[h]]);return{x:function(){return Object(Dt.a)(e,d)}}}},Jt={kernelName:s.Fc,outputsToSave:[!0],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.dim,i=Object(c.a)(e,r);return{logits:function(){return Object(C.a)(i,Object(c.a)(Object(y.a)(i,[a],true),r))}}}},Qt=n(108),qt={kernelName:s.Gc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(Qt.a)(n))}}}},$t=n(132),en={kernelName:s.Hc,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Object($t.a)(e,r,a)}}}},tn=n(54),nn={kernelName:s.Nc,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return Object(tn.a)(e,r)}}}},rn={kernelName:s.Oc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(c.a)(Object(p.a)(Object(u.a)(n,"float32")),2))}}}},an={kernelName:s.Pc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(e,Object(c.a)(Object(u.a)(n,"float32"),2))}}}},on={kernelName:s.Qc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(f.a)(2);return{a:function(){return Object(c.a)(e,Object(c.a)(i,Object(C.a)(r,a)))},b:function(){return Object(c.a)(e,Object(c.a)(i,Object(C.a)(a,r)))}}}},sn={kernelName:s.Rc,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},un={kernelName:s.Wc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=Object(o.a)(t,2),r=n[0],a=n[1],i=v.a(r.shape,a.shape);return{a:function(){var t=e,n=v.c(r.shape,i);return n.length>0&&(t=Object(y.a)(t,n)),Object(A.a)(t,r.shape)},b:function(){var t=e,n=v.c(a.shape,i);return n.length>0&&(t=Object(y.a)(t,n)),Object(A.a)(Object(h.a)(t),a.shape)}}}},cn={kernelName:s.Xc,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=r.shape.slice(),i=n.axis;Object(V.I)(i,r.shape).forEach((function(e){a[e]=1}));var s=Object(A.a)(e,a),u=Object(c.a)(s,Object(ot.a)(r.shape,"float32"));return{x:function(){return u}}}},ln={kernelName:s.Yc,inputsToSave:["x"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(d.a)(e,Object(I.a)(Object(Yt.a)(n)))}}}},gn={kernelName:s.Zc,outputsToSave:[!0],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return Object(c.a)(Object(C.a)(Object(f.a)(1),Object(I.a)(n)),e)}}}},dn={kernelName:s.ad,inputsToSave:["x"],gradFunc:function(e,t,n){var r=Object(o.a)(t,1)[0],a=n.reps;return{x:function(){var t=Object(B.a)(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Object(Z.a)(t,Object(lt.a)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=Object(Z.a)(t,Object(lt.a)(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=Object(Z.a)(t,Object(lt.a)(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var g=0;g<a[1];++g)for(var d=0;d<a[2];++d)for(var h=0;h<a[3];++h)t=Object(Z.a)(t,Object(lt.a)(e,[l*r.shape[0],g*r.shape[1],d*r.shape[2],h*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},hn={kernelName:s.dd,gradFunc:function(e,t,n){var r=n.perm,a=Ie.h(r);return{x:function(){return Object(me.a)(e,a)}}}},fn=n(96),pn={kernelName:s.fd,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return Object(fn.a)(e,r)}}}},In=n(100),Cn=n(136),mn=n(138),bn={kernelName:s.gd,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=Object(o.a)(t,1)[0];return{x:function(){return function(e,t){for(var n=Object(mn.a)(t,Object(B.a)(t)),r=Object(Cn.a)(e,n),a=Object(U.a)(t,Object(f.a)(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=Object(In.a)(a,o+1);a=Object(Q.a)(a,Object(ot.a)(r.shape,"bool"));var s=Object(B.a)(r);return Object(q.a)(a,r,s)}(e,n)}}}};for(var vn={kernelName:s.hd,gradFunc:function(e){return{x:function(){return Object(B.a)(e)}}}},An=n(99),yn=0,wn=[g,m,b,w,G,x,S,k,R,N,O,W,j,X,Y,K,_,D,P,$,ee,ne,ue,oe,ge,he,pe,be,ye,we,xt,Ge,xe,Se,ke,Ze,Ne,Re,Fe,Ve,je,Le,Xe,He,Ye,Ke,_e,De,Pe,Je,$e,$e,tt,rt,it,st,ut,ct,gt,ht,ft,pt,Ct,mt,vt,At,At,Gt,Bt,St,kt,Zt,Rt,Nt,Ot,Ft,Mt,Vt,Et,Lt,Xt,Ht,zt,_t,Ut,Jt,qt,en,en,nn,nn,rn,on,an,sn,un,cn,ln,gn,dn,hn,pn,bn,vn];yn<wn.length;yn++){var Gn=wn[yn];Object(An.d)(Gn)}var Bn=n(71),xn=n(14);Object(xn.d)().prototype.abs=function(){return this.throwIfDisposed(),Object(Bn.a)(this)};var Sn=n(297);Object(xn.d)().prototype.acos=function(){return this.throwIfDisposed(),Object(Sn.a)(this)};var kn=n(298);Object(xn.d)().prototype.acosh=function(){return this.throwIfDisposed(),Object(kn.a)(this)},Object(xn.d)().prototype.add=function(e){return this.throwIfDisposed(),Object(Z.a)(this,e)};var Zn=n(221);Object(xn.d)().prototype.all=function(e,t){return this.throwIfDisposed(),Object(Zn.a)(this,e,t)};var Rn=n(222);Object(xn.d)().prototype.any=function(e,t){return this.throwIfDisposed(),Object(Rn.a)(this,e,t)};var Nn=n(223);Object(xn.d)().prototype.argMax=function(e){return this.throwIfDisposed(),Object(Nn.a)(this,e)};var On=n(224);Object(xn.d)().prototype.argMin=function(e){return this.throwIfDisposed(),Object(On.a)(this,e)},Object(xn.d)().prototype.asScalar=function(){return this.throwIfDisposed(),Object(V.b)(1===this.size,(function(){return"The array must have only 1 element."})),Object(A.a)(this,[])},Object(xn.d)().prototype.asType=function(e){return this.throwIfDisposed(),Object(u.a)(this,e)},Object(xn.d)().prototype.as1D=function(){return this.throwIfDisposed(),Object(A.a)(this,[this.size])},Object(xn.d)().prototype.as2D=function(e,t){return this.throwIfDisposed(),Object(A.a)(this,[e,t])},Object(xn.d)().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Object(A.a)(this,[e,t,n])},Object(xn.d)().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Object(A.a)(this,[e,t,n,r])},Object(xn.d)().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),Object(A.a)(this,[e,t,n,r,a])};var Wn=n(300);Object(xn.d)().prototype.asin=function(){return this.throwIfDisposed(),Object(Wn.a)(this)};var Fn=n(301);Object(xn.d)().prototype.asinh=function(){return this.throwIfDisposed(),Object(Fn.a)(this)};var Mn=n(302);Object(xn.d)().prototype.atan=function(){return this.throwIfDisposed(),Object(Mn.a)(this)};var Vn=n(225);Object(xn.d)().prototype.atan2=function(e){return this.throwIfDisposed(),Object(Vn.a)(this,e)};var Tn=n(303);Object(xn.d)().prototype.atanh=function(){return this.throwIfDisposed(),Object(Tn.a)(this)};var En=n(165);Object(xn.d)().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),Object(En.a)(this,e,t,n,r)},Object(xn.d)().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Object($t.a)(this,e,t)};var jn=n(118);Object(xn.d)().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),Object(jn.a)(this,e,t,n,r,a)};var Ln=n(143);Object(xn.d)().prototype.broadcastTo=function(e){return this.throwIfDisposed(),Object(Ln.a)(this,e)},Object(xn.d)().prototype.cast=function(e){return this.throwIfDisposed(),Object(u.a)(this,e)};var Xn=n(305);Object(xn.d)().prototype.ceil=function(){return this.throwIfDisposed(),Object(Xn.a)(this)};var Hn=n(306);Object(xn.d)().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),Object(Hn.a)(this,e,t)};var Yn=n(21);Object(xn.d)().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof xn.a&&(e=[e]),Object(tn.a)([this].concat(Object(Yn.a)(e)),t)};var zn=n(227);Object(xn.d)().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(zn.a)(this,e,t,n,r,a,i)};var Kn=n(228);Object(xn.d)().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Kn.a)(this,e,t,n,r,a)},Object(xn.d)().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(se.a)(this,e,t,n,r,a,i)},Object(xn.d)().prototype.cos=function(){return this.throwIfDisposed(),Object(Yt.a)(this)},Object(xn.d)().prototype.cosh=function(){return this.throwIfDisposed(),Object(Kt.a)(this)},Object(xn.d)().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),Object(Ce.a)(this,e,t,n)};var _n=n(230);Object(xn.d)().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),Object(_n.a)(this,e,t)};var Dn=n(133);Object(xn.d)().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Dn.a)(this,e,t,n,r,a,i)};var Pn=n(231);Object(xn.d)().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),Object(Pn.a)(this,e,t,n,r,a)};var Un=n(232);Object(xn.d)().prototype.divNoNan=function(e){return this.throwIfDisposed(),Object(Un.a)(this,e)},Object(xn.d)().prototype.div=function(e){return this.throwIfDisposed(),Object(d.a)(this,e)};var Jn=n(233);Object(xn.d)().prototype.dot=function(e){return this.throwIfDisposed(),Object(Jn.a)(this,e)};var Qn=n(169);Object(xn.d)().prototype.elu=function(){return this.throwIfDisposed(),Object(Qn.a)(this)},Object(xn.d)().prototype.equal=function(e){return this.throwIfDisposed(),Object(Qe.a)(this,e)};var qn=n(310);Object(xn.d)().prototype.erf=function(){return this.throwIfDisposed(),Object(qn.a)(this)},Object(xn.d)().prototype.exp=function(){return this.throwIfDisposed(),Object(Be.a)(this)},Object(xn.d)().prototype.expandDims=function(e){return this.throwIfDisposed(),Object(In.a)(this,e)};var $n=n(311);Object(xn.d)().prototype.expm1=function(){return this.throwIfDisposed(),Object($n.a)(this)};var er=n(181);Object(xn.d)().prototype.fft=function(){return this.throwIfDisposed(),Object(er.a)(this)},Object(xn.d)().prototype.flatten=function(){return this.throwIfDisposed(),Object(A.a)(this,[this.size])},Object(xn.d)().prototype.floor=function(){return this.throwIfDisposed(),Object(dt.a)(this)};var tr=n(168);Object(xn.d)().prototype.floorDiv=function(e){return this.throwIfDisposed(),Object(tr.a)(this,e)},Object(xn.d)().prototype.gather=function(e,t){return this.throwIfDisposed(),Object(Cn.a)(this,e,t)},Object(xn.d)().prototype.greaterEqual=function(e){return this.throwIfDisposed(),Object(U.a)(this,e)},Object(xn.d)().prototype.greater=function(e){return this.throwIfDisposed(),Object(ze.a)(this,e)};var nr=n(153);Object(xn.d)().prototype.ifft=function(){return this.throwIfDisposed(),Object(nr.a)(this)};var rr=n(250);Object(xn.d)().prototype.irfft=function(){return this.throwIfDisposed(),Object(rr.a)(this)};var ar=n(312);Object(xn.d)().prototype.isFinite=function(){return this.throwIfDisposed(),Object(ar.a)(this)};var ir=n(313);Object(xn.d)().prototype.isInf=function(){return this.throwIfDisposed(),Object(ir.a)(this)};var or=n(314);Object(xn.d)().prototype.isNaN=function(){return this.throwIfDisposed(),Object(or.a)(this)};var sr=n(172);Object(xn.d)().prototype.leakyRelu=function(e){return this.throwIfDisposed(),Object(sr.a)(this,e)},Object(xn.d)().prototype.lessEqual=function(e){return this.throwIfDisposed(),Object(J.a)(this,e)},Object(xn.d)().prototype.less=function(e){return this.throwIfDisposed(),Object(et.a)(this,e)};var ur=n(234);Object(xn.d)().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),Object(ur.a)(this,e,t,n,r)};var cr=n(316);Object(xn.d)().prototype.logSigmoid=function(){return this.throwIfDisposed(),Object(cr.a)(this)};var lr=n(317);Object(xn.d)().prototype.logSoftmax=function(e){return this.throwIfDisposed(),Object(lr.a)(this,e)};var gr=n(174);Object(xn.d)().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Object(gr.a)(this,e,t)},Object(xn.d)().prototype.log=function(){return this.throwIfDisposed(),Object(yt.a)(this)};var dr=n(235);Object(xn.d)().prototype.log1p=function(){return this.throwIfDisposed(),Object(dr.a)(this)},Object(xn.d)().prototype.logicalAnd=function(e){return this.throwIfDisposed(),Object(Q.a)(this,e)},Object(xn.d)().prototype.logicalNot=function(){return this.throwIfDisposed(),Object(Tt.a)(this)};var hr=n(175);Object(xn.d)().prototype.logicalOr=function(e){return this.throwIfDisposed(),Object(hr.a)(this,e)};var fr=n(237);Object(xn.d)().prototype.logicalXor=function(e){return this.throwIfDisposed(),Object(fr.a)(this,e)},Object(xn.d)().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),Object(H.a)(this,e,t,n)};var pr=n(176);Object(xn.d)().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Object(pr.a)(this,e,t,n,r)};var Ir=n(109);Object(xn.d)().prototype.max=function(e,t){return this.throwIfDisposed(),Object(Ir.a)(this,e,t)},Object(xn.d)().prototype.maximum=function(e){return this.throwIfDisposed(),Object(mn.a)(this,e)};var Cr=n(129);Object(xn.d)().prototype.mean=function(e,t){return this.throwIfDisposed(),Object(Cr.a)(this,e,t)};var mr=n(151);Object(xn.d)().prototype.min=function(e,t){return this.throwIfDisposed(),Object(mr.a)(this,e,t)};var br=n(177);Object(xn.d)().prototype.minimum=function(e){return this.throwIfDisposed(),Object(br.a)(this,e)};var vr=n(238);Object(xn.d)().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),Object(vr.a)(this,e,t)};var Ar=n(239);Object(xn.d)().prototype.mod=function(e){return this.throwIfDisposed(),Object(Ar.a)(this,e)},Object(xn.d)().prototype.mul=function(e){return this.throwIfDisposed(),Object(c.a)(this,e)},Object(xn.d)().prototype.neg=function(){return this.throwIfDisposed(),Object(h.a)(this)};var yr=n(185);Object(xn.d)().prototype.norm=function(e,t,n){return this.throwIfDisposed(),Object(yr.a)(this,e,t,n)};var wr=n(178);Object(xn.d)().prototype.notEqual=function(e){return this.throwIfDisposed(),Object(wr.a)(this,e)};var Gr=n(240);Object(xn.d)().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Object(Gr.a)(this,e,t,n)};var Br=n(321);Object(xn.d)().prototype.onesLike=function(){return this.throwIfDisposed(),Object(Br.a)(this)},Object(xn.d)().prototype.pad=function(e,t){return this.throwIfDisposed(),Object(Dt.a)(this,e,t)};var xr=n(241);Object(xn.d)().prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),Object(xr.a)(this,e,t,n,r,a)},Object(xn.d)().prototype.pow=function(e){return this.throwIfDisposed(),Object(wt.a)(this,e)};var Sr=n(179);Object(xn.d)().prototype.prelu=function(e){return this.throwIfDisposed(),Object(Sr.a)(this,e)};var kr=n(242);Object(xn.d)().prototype.prod=function(e,t){return this.throwIfDisposed(),Object(kr.a)(this,e,t)};var Zr=n(322);Object(xn.d)().prototype.reciprocal=function(){return this.throwIfDisposed(),Object(Zr.a)(this)};var Rr=n(115);Object(xn.d)().prototype.relu=function(){return this.throwIfDisposed(),Object(Rr.a)(this)};var Nr=n(180);Object(xn.d)().prototype.relu6=function(){return this.throwIfDisposed(),Object(Nr.a)(this)},Object(xn.d)().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Object(A.a)(this,e.shape)},Object(xn.d)().prototype.reshape=function(e){return this.throwIfDisposed(),Object(A.a)(this,e)};var Or=n(269);Object(xn.d)().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),Object(Or.a)(this,e,t,n)};var Wr=n(268);Object(xn.d)().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),Object(Wr.a)(this,e,t,n)},Object(xn.d)().prototype.reverse=function(e){return this.throwIfDisposed(),Object(Wt.a)(this,e)};var Fr=n(182);Object(xn.d)().prototype.rfft=function(){return this.throwIfDisposed(),Object(Fr.a)(this)};var Mr=n(244);Object(xn.d)().prototype.round=function(){return this.throwIfDisposed(),Object(Mr.a)(this)},Object(xn.d)().prototype.rsqrt=function(){return this.throwIfDisposed(),Object(Oe.a)(this)};var Vr=n(246);Object(xn.d)().prototype.selu=function(){return this.throwIfDisposed(),Object(Vr.a)(this)};var Tr=n(247);Object(xn.d)().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),Object(Tr.a)(this,e,t,n,r,a,i)},Object(xn.d)().prototype.sigmoid=function(){return this.throwIfDisposed(),Object(Qt.a)(this)};var Er=n(324);Object(xn.d)().prototype.sign=function(){return this.throwIfDisposed(),Object(Er.a)(this)},Object(xn.d)().prototype.sin=function(){return this.throwIfDisposed(),Object(de.a)(this)},Object(xn.d)().prototype.sinh=function(){return this.throwIfDisposed(),Object(fe.a)(this)},Object(xn.d)().prototype.slice=function(e,t){return this.throwIfDisposed(),Object(lt.a)(this,e,t)};var jr=n(325);Object(xn.d)().prototype.softmax=function(e){return this.throwIfDisposed(),Object(jr.a)(this,e)};var Lr=n(236);Object(xn.d)().prototype.softplus=function(){return this.throwIfDisposed(),Object(Lr.a)(this)},Object(xn.d)().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Object(z.a)(this,e,t)},Object(xn.d)().prototype.split=function(e,t){return this.throwIfDisposed(),Object(te.a)(this,e,t)},Object(xn.d)().prototype.sqrt=function(){return this.throwIfDisposed(),Object(p.a)(this)},Object(xn.d)().prototype.square=function(){return this.throwIfDisposed(),Object(I.a)(this)};var Xr=n(183);Object(xn.d)().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Object(Xr.a)(this,e)};var Hr=n(140);Object(xn.d)().prototype.squeeze=function(e){return this.throwIfDisposed(),Object(Hr.a)(this,e)},Object(xn.d)().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof xn.a?[this,e]:[this].concat(Object(Yn.a)(e));return Object(fn.a)(n,t)},Object(xn.d)().prototype.step=function(e){return this.throwIfDisposed(),Object(l.a)(this,e)};var Yr=n(326);Object(xn.d)().prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return this.throwIfDisposed(),Object(Yr.a)(this,e,t,n,r,a,i,o,s)},Object(xn.d)().prototype.sub=function(e){return this.throwIfDisposed(),Object(C.a)(this,e)},Object(xn.d)().prototype.sum=function(e,t){return this.throwIfDisposed(),Object(y.a)(this,e,t)};var zr=n(327);Object(xn.d)().prototype.tan=function(){return this.throwIfDisposed(),Object(zr.a)(this)};var Kr=n(204);Object(xn.d)().prototype.tanh=function(){return this.throwIfDisposed(),Object(Kr.a)(this)},Object(xn.d)().prototype.tile=function(e){return this.throwIfDisposed(),Object(We.a)(this,e)},Object(xn.d)().prototype.toBool=function(){return this.throwIfDisposed(),Object(u.a)(this,"bool")},Object(xn.d)().prototype.toFloat=function(){return this.throwIfDisposed(),Object(u.a)(this,"float32")},Object(xn.d)().prototype.toInt=function(){return this.throwIfDisposed(),Object(u.a)(this,"int32")};var _r=n(252);Object(xn.d)().prototype.topk=function(e,t){return this.throwIfDisposed(),Object(_r.a)(this,e,t)},Object(xn.d)().prototype.transpose=function(e){return this.throwIfDisposed(),Object(me.a)(this,e)};var Dr=n(253);Object(xn.d)().prototype.unique=function(e){return this.throwIfDisposed(),Object(Dr.a)(this,e)},Object(xn.d)().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),Object(Me.a)(this,e,t)},Object(xn.d)().prototype.unstack=function(e){return this.throwIfDisposed(),Object(bt.a)(this,e)},Object(xn.d)().prototype.where=function(e,t){return this.throwIfDisposed(),Object(q.a)(e,this,t)},Object(xn.d)().prototype.zerosLike=function(){return this.throwIfDisposed(),Object(B.a)(this)};var Pr,Ur=n(1),Jr=n(9),Qr=n(12),qr=n(13);function $r(){return null==Pr&&(Pr=Object(i.td)().epsilon()),Pr}var ea=n(16),ta=n(50),na=n(126),ra=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(ta.a)(r),n.prototype),r}return n}(Object(na.a)(Error)),aa=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(ta.a)(r),n.prototype),r}return n}(Object(na.a)(Error)),ia=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(ta.a)(r),n.prototype),r}return n}(Object(na.a)(Error)),oa=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(ta.a)(r),n.prototype),r}return n}(Object(na.a)(Error)),sa=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,e),Object.setPrototypeOf(Object(ta.a)(r),n.prototype),r}return n}(Object(na.a)(Error));Error;function ua(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function ca(e,t){if(!e)throw new sa(t)}function la(e,t){var n,r=0,a=Object(ea.a)(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(i){a.e(i)}finally{a.f()}return r}function ga(e){return 1===e.length?e[0]:e}function da(e){return Array.isArray(e)?e:[e]}function ha(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function fa(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var pa={};function Ia(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Ca(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return Ca(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?Ca(a):e[r]=a.value)}}function ma(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var i,s=e;if(s in n)i=n[s];else if(s in pa)i=pa[s];else if(null==(i=t[s]))throw new ia("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var u=e;if(null==u.className||null==u.config)throw new ia("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(u),".\n")+"'className' and 'config' must set.");var c,l,g=u.className;if(g in n){var d=Object(o.a)(n[g],2);c=d[0],l=d[1]}else if(g in pa){var h=Object(o.a)(pa.className,2);c=h[0],l=h[1]}else if(g in t){var f=Object(o.a)(t[g],2);c=f[0],l=f[1]}if(null==c)throw new ia("Unknown ".concat(r,": ").concat(g,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){for(var p={},I=0,C=Object.keys(pa);I<C.length;I++){var m=C[I];p[m]=pa[m]}for(var b=0,v=Object.keys(n);b<v.length;b++){var A=v[b];p[A]=n[A]}var y=u.config;y.customObjects=p;for(var w=Object.assign({},pa),G=0,B=Object.keys(n);G<B.length;G++){var x=B[G];pa[x]=n[x]}Ca(u.config);var S=l(c,u.config,n,a);return pa=Object.assign({},w),S}for(var k=Object.assign({},pa),Z=0,R=Object.keys(n);Z<R.length;Z++){var N=R[Z];pa[N]=n[N]}var O=new c(u.config);return pa=Object.assign({},k),O}function ba(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function va(e){if(null==e)return e;var t,n=[],r=Object(ea.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function Aa(e){if(null==e)throw new ia("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function ya(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new ia("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function wa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return ca(n>=0),ca(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function Ga(e,t){Array.isArray(e)?(i.tf.assert(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return Ga(e,"element ".concat(n+1," of ").concat(t))}))):i.tf.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(Ba(e),".")}))}function Ba(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return Ba(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function xa(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function Sa(e,t){return Object(i.mf)((function(){return i.bf(i.ff(i.ve(e,e),t,!0))}))}var ka=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"getConfig",value:function(){return{}}}]),n}(i.Pe.Serializable),Za=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=this;return Object(i.mf)((function(){var n=Sa(e,t.axis),r=i.Bd(n,0,t.maxValue);return i.ve(e,i.Qd(r,i.nd($r(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(ka);Za.className="MaxNorm",i.Pe.registerClass(Za);var Ra=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=this;return Object(i.mf)((function(){return i.Qd(e,i.nd($r(),Sa(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(ka);Ra.className="UnitNorm",i.Pe.registerClass(Ra);var Na=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return i.Je(e)}}]),n}(ka);Na.className="NonNeg",i.Pe.registerClass(Na);var Oa=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=this;return Object(i.mf)((function(){var n=Sa(e,t.axis),r=i.nd(i.ve(t.rate,i.Bd(n,t.minValue,t.maxValue)),i.ve(1-t.rate,n));return i.ve(e,i.Qd(r,i.nd($r(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(ka);Oa.className="MinMaxNorm",i.Pe.registerClass(Oa);var Wa={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Fa(e){return Ia(e)}function Ma(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ma(e,i.Pe.SerializationMap.getMap().classNameMap,t,"constraint")}function Va(e){return null==e?null:"string"===typeof e?Ma({className:e in Wa?Wa[e]:e,config:{}}):e instanceof ka?e:Ma(e)}var Ta=["channelsFirst","channelsLast"],Ea=["nearest","bilinear"],ja=["valid","same","causal"],La=["max","avg"],Xa=["sum","mul","concat","ave"],Ha=new Map;function Ya(e){ya(Ta,"DataFormat",e)}function za(e){ya(ja,"PaddingMode",e)}function Ka(e){ya(La,"PoolMode",e)}var _a=[];function Da(e,t){_a.push(e);try{var n=t();return _a.pop(),n}catch(r){throw _a.pop(),r}}function Pa(e){if(!Qa(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===_a.length?"":_a.join("/")+"/")+e}function Ua(e){if(!Qa(e))throw new Error("Not a valid tensor name: '"+e+"'");Ha.has(e)||Ha.set(e,0);var t=Ha.get(e);if(Ha.set(e,Ha.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return Ha.set(n,1),n}return e}var Ja=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Qa(e){return!!e.match(Ja)}function qa(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function $a(e){if(0===e.length)return Number.NaN;for(var t=Number.POSITIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r<t&&(t=r)}return t}function ei(e){if(0===e.length)return Number.NaN;for(var t=Number.NEGATIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r>t&&(t=r)}return t}function ti(e,t){if(t<e)throw new ia("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function ni(e,t){return e.asType(t)}function ri(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function ai(e){var t=[qa(e.shape)];return e.reshape(t)}function ii(e,t,n){return Object(i.mf)((function(){switch(e.rank){case 1:return i.Te(e,t,n);case 2:return i.Ue(e,[t,0],[n,e.shape[1]]);case 3:return i.Ve(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return i.We(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return i.Se(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return i.Se(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new ia("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function oi(e,t,n){return Object(i.mf)((function(){switch(e.rank){case 1:return i.Te(e,t,n);case 2:return i.Ue(e,[0,t],[e.shape[0],n]);case 3:return i.Ve(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return i.We(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new ia("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function si(e,t,n,r){return Object(i.mf)((function(){switch(e.rank){case 1:return i.Te(e,t,n);case 2:switch(r){case 1:return ii(e,t,n);case 2:return oi(e,t,n);default:throw new ia("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return ii(e,t,n);case 2:return i.Ve(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return oi(e,t,n);default:throw new ia("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return ii(e,t,n);case 2:return i.We(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return i.We(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return oi(e,t,n);default:throw new ia("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new ia("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function ui(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),i.Dd(e,n)}function ci(e,t){switch(e.rank){case 1:return i.Ed([e,t]);case 2:return i.Fd([e,t],0);case 3:return i.Gd([e,t],0);case 4:return i.Hd([e,t],0);default:throw new ia("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function li(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new ia("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return i.nf(e,t)}function gi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return i.Fe(e,t,n,r,a)}function di(e,t,n,r){if(e.rank<2||t.rank<2)throw new oa("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new oa("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return i.ae.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?pi(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),o=a.pop();e=e.reshape([-1,o]);var s=t.shape.slice(),u=s.pop(),c=s.pop(),l=[].concat(Object(Yn.a)(s),[u]),g=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(g).reshape([c,-1]);var d=[].concat(Object(Yn.a)(a),Object(Yn.a)(l));return i.ae.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?pi(e.rank,r,"channelsLast"):null,activation:n}).reshape(d)}function hi(e,t,n){return Object(i.mf)((function(){return t=Array.isArray(t)?Object(i.jf)(t,"int32"):t.toInt(),i.be(e,t,n)}))}function fi(e){return i.ve(e,e)}function pi(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new ia("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new ia("Unsupported input rank by biasAdd: ".concat(t.rank))}function Ii(e,t,n){return Object(i.mf)((function(){return null==n&&(n="channelsLast"),Ya(n),e.add(pi(e.rank,t,n))}))}function Ci(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new oa("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return i.Sd(e)}function mi(e,t,n,r){return Object(i.mf)((function(){return i.Rd(e,t,n,r)}))}function bi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var vi=["fanIn","fanOut","fanAvg"],Ai=["normal","uniform","truncatedNormal"];var yi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(i.Pe.Serializable),wi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){return Object(i.yf)(e,t)}}]),n}(yi);wi.className="Zeros",i.Pe.registerClass(wi);var Gi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){return Object(i.Ae)(e,t)}}]),n}(yi);Gi.className="Ones",i.Pe.registerClass(Gi);var Bi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),r=t.call(this),"object"!==typeof e)throw new ia("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new ia("config must have value set but got ".concat(e));return r.value=e.value,r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){var n=this;return Object(i.mf)((function(){return Object(i.ve)(Object(i.Me)(n.value),Object(i.Ae)(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(yi);Bi.className="Constant",i.Pe.registerClass(Bi);var xi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){return Object(i.Ge)(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(yi);xi.className="RandomUniform",i.Pe.registerClass(xi);var Si=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new oa("randomNormal does not support dType ".concat(t,"."));return gi(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(yi);Si.className="RandomNormal",i.Pe.registerClass(Si);var ki=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new oa("truncatedNormal does not support dType ".concat(t,"."));return Object(i.qf)(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(yi);ki.className="TruncatedNormal",i.Pe.registerClass(ki);var Zi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){var n=this;return Object(i.mf)((function(){if(2!==e.length||e[0]!==e[1])throw new ia("Identity matrix initializer can only be used for 2D square matrices.");return Object(i.ve)(n.gain,Object(i.Xd)(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(yi);Zi.className="Identity",i.Pe.registerClass(Zi);var Ri=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r,a;if(Object(Ur.a)(this,n),r=t.call(this),e.scale<0)throw new ia("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,ya(vi,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){ya(Ai,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Ya(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=qa(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=qa(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=qa(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],o=this.scale;if("fanIn"===this.mode?o/=Math.max(1,r):"fanOut"===this.mode?o/=Math.max(1,a):o/=Math.max(1,(r+a)/2),"normal"===this.distribution){var s=Math.sqrt(o);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new oa("".concat(this.getClassName()," does not support dType ").concat(t,"."));return Object(i.qf)(e,0,s,t,this.seed)}var u=Math.sqrt(3*o);return Object(i.Ge)(e,-u,u,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(yi);Ri.className="VarianceScaling",i.Pe.registerClass(Ri);var Ni=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return Object(Jr.a)(n,[{key:"getClassName",value:function(){return Ri.className}}]),n}(Ri);Ni.className="GlorotUniform",i.Pe.registerClass(Ni);var Oi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return Object(Jr.a)(n,[{key:"getClassName",value:function(){return Ri.className}}]),n}(Ri);Oi.className="GlorotNormal",i.Pe.registerClass(Oi);var Wi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return Object(Jr.a)(n,[{key:"getClassName",value:function(){return Ri.className}}]),n}(Ri);Wi.className="HeNormal",i.Pe.registerClass(Wi);var Fi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return Object(Jr.a)(n,[{key:"getClassName",value:function(){return Ri.className}}]),n}(Ri);Fi.className="HeUniform",i.Pe.registerClass(Fi);var Mi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return Object(Jr.a)(n,[{key:"getClassName",value:function(){return Ri.className}}]),n}(Ri);Mi.className="LeCunNormal",i.Pe.registerClass(Mi);var Vi=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return Object(Jr.a)(n,[{key:"getClassName",value:function(){return Ri.className}}]),n}(Ri);Vi.className="LeCunNormal",i.Pe.registerClass(Vi);var Ti=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new oa("Random seed is not implemented for Orthogonal Initializer yet.");return r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){var n=this;return Object(i.mf)((function(){if(e.length<2)throw new oa("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=gi(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=i.je.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Object(i.ve)(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(yi);Ti.className="Orthogonal",i.Pe.registerClass(Ti);var Ei={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ji(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ma(e,i.Pe.SerializationMap.getMap().classNameMap,t,"initializer")}function Li(e){return Ia(e)}function Xi(e){if("string"===typeof e){var t=e in Ei?Ei[e]:e;if("GlorotNormal"===t)return new Oi;if("GlorotUniform"===t)return new Ni;if("HeNormal"===t)return new Wi;if("HeUniform"===t)return new Fi;if("LeCunNormal"===t)return new Mi;if("LeCunUniform"===t)return new Vi;var n={};return n.className=t,n.config={},ji(n)}return e instanceof yi?e:ji(e)}var Hi=0;function Yi(){return Hi++}var zi={};function Ki(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in zi||(zi[e]=0),zi[e]+=1,e+zi[e].toString()}function _i(e){return Array.isArray(e)&&Array.isArray(e[0])}function Di(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Pi(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new ia("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function Ui(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new ia("Expected exactly 1 Shape; got ".concat(e.length))}return e}function Ji(e){var t,n=0,r=Object(ea.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(i){r.e(i)}finally{r.f()}return n}var Qi="Variable",qi=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qi,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;Object(Ur.a)(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=Yi(),r=null==r?Qi:r,this.originalName=Pa(r),this.name=Ua(this.originalName),this.trainable_=a,this.constraint=o,this.val=i.uf(t,this.trainable_,this.name,this.dtype)}return Object(Jr.a)(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function $i(e){return e.map((function(e){return e.read()}))}function eo(e){e.forEach((function(e){e[0].write(e[1])}))}var to=function e(t){Object(Ur.a)(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},no=function e(t,n,r,a,i,o,s){Object(Ur.a)(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=Yi(),null!=o&&(this.originalName=Pa(o),this.name=Ua(this.originalName)),this.rank=n.length},ro=0,ao=function(){function e(t,n){Object(Ur.a)(this,e),this.callArgs=n,this.id=ro++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=Object(ea.a)(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(o){a.e(o)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return Object(Jr.a)(e,[{key:"getConfig",value:function(){var e,t=[],n=Object(ea.a)(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(a){n.e(a)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),io=0,oo=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(Ur.a)(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=io++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=ha(i)+"_"+Ki(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return Object(Jr.a)(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new aa("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new ia("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return ga(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return ga(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new ra("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new ra("Layer ".concat(this.name)+" is not connected, no input to return.");return ga(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new ra("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new ra("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return ga(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=da(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=da(this.inputSpec);if(e.length!==t.length)throw new ia("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new ia("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new ia("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new ia("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new ia("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new ia("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var g=0;g<a.shape.length;++g){var d=a.shape[g],h=r.shape[g];if(null!=d&&null!=h&&d!==h)throw new ia("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=da(e),i=!0,o=Object(ea.a)(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof no)){i=!1;break}}}catch(l){o.e(l)}finally{o.f()}var s,u=!0,c=Object(ea.a)(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof no){u=!1;break}}}catch(l){c.e(l)}finally{c.f()}if(i===u)throw new ia("Arguments to apply() must be all SymbolicTensors or all Tensors");return Da(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=Object(ea.a)(da(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(l){o.e(l)}finally{o.f()}n.build(ga(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,g=n.call(e,t),d=da(g),h=[],f=Object(ea.a)(d);try{for(f.s();!(c=f.n()).done;){var p=c.value;-1!==a.indexOf(p)&&(p=p.clone()),h.push(p)}}catch(l){f.e(l)}finally{f.f()}if(g=ga(h),null!=n.activityRegularizer)throw new oa("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return g}var I,C=function(e){e=da(e);var t,n=[],r=Object(ea.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(l){r.e(l)}finally{r.f()}return ga(n)}(e),m=n.computeOutputShape(C),b="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?C[0]:C),I=null!=m&&m.length>0&&Array.isArray(m[0])?m.map((function(r,a){return new no(b,r,n,da(e),t,n.name,a)})):new no(b,m,n,da(e),t,n.name),n.addInboundNode(e,I,null,null,C,m,t),n._refCount++,null!=n.activityRegularizer)throw new oa("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return I}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new ra("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=Object(ea.a)(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(o){n.e(o)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new ra("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new aa("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Ji(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return $i(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;Object(i.mf)((function(){var n=t.weights;if(n.length!==e.length)throw new ia('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=$i(n),o=0;o<a.length;++o){var s=a[o],u=n[o],c=e[o];if(!i.tf.arraysEqual(s.shape,c.shape))throw new ia("Layer weight shape ".concat(s.shape," ")+"not compatible with provided weight shape ".concat(c.shape));r.push([u,c])}eo(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new ia("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=Xi("zeros"));var s=r.apply(t,n),u=new qi(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(u.read())})),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=da(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,Object(Yn.a)(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=da(e);t=da(t),n=da(n),r=da(r),a=Di(a),i=Di(i);var u,c=[],l=[],g=[],d=Object(ea.a)(s);try{for(d.s();!(u=d.n()).done;){var h=u.value;c.push(h.sourceLayer),l.push(h.nodeIndex),g.push(h.tensorIndex)}}catch(p){d.e(p)}finally{d.f()}new ao({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:g,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var f=0;f<t.length;f++)t[f].sourceLayer=this,t[f].nodeIndex=this.inboundNodes.length-1,t[f].tensorIndex=f}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(i.Pe.Serializable);function so(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,s=so(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]),u=Object(ea.a)(s);try{for(u.s();!(o=u.n()).done;){var c=o.value;-1===a.indexOf(c)&&a.push(c)}}catch(l){u.e(l)}finally{u.f()}}return a}var uo=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:Ki("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new ia("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new ia("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new ia("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new no(r.dtype,r.batchInputShape,Object(ta.a)(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new ao({outboundLayer:Object(ta.a)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){throw new ia("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(oo);function co(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new ia("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new uo({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}uo.className="InputLayer",i.Pe.registerClass(uo);var lo,go=n(7),ho=n.n(go),fo=n(17);function po(e){return Io.apply(this,arguments)}function Io(){return(Io=Object(fo.a)(ho.a.mark((function e(t){var n,r,a,o,s,u,c,l;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(o in n=[],r=[],a=[],t)"number"!==typeof(s=t[o])&&(u=s,n.push(u.data()),r.push(o),a.push(u));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(c=e.sent,l=0;l<c.length;++l)t[r[l]]=c[l][0];Object(i.Pd)(a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Co(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(lo||(lo={}));var mo=function(){function e(){Object(Ur.a)(this,e),this.validationData=null}return Object(Jr.a)(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),bo=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;Object(Ur.a)(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return Object(Jr.a)(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=Object(ea.a)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=Object(ea.a)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,i;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(ea.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,i;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(ea.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,i;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(ea.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,i;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=Object(ea.a)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n,r,a;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=Object(ea.a)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n,r,a;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=Object(ea.a)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),vo=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.call(this)}return Object(Jr.a)(n,[{key:"onEpochBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,o,s=this;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=function(e){var t=n[e];if("number"===typeof t)s.totals.hasOwnProperty(e)||(s.totals[e]=0),s.totals[e]=s.totals[e]+t*r;else{var a;e in s.totals?a=s.totals[e]:s.totals[e]=0;var o=Object(i.mf)((function(){return Object(i.nd)(s.totals[e],Object(i.ve)(t,r))}));s.totals[e]=o,null!=a&&a.dispose()}},n)a(o);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,o,s=this;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=19;break}r=Object(ea.a)(this.params.metrics),e.prev=2,o=function(){var e=a.value;if(null==s.totals[e])return"continue";"number"===typeof s.totals[e]?n[e]=s.totals[e]/s.seen:Object(i.mf)((function(){var t=Object(i.ve)(Object(i.Qd)(1,s.seen),s.totals[e]);n[e]=t,s.totals[e].dispose(),Object(i.ge)(n[e])}))},r.s();case 5:if((a=r.n()).done){e.next=11;break}if("continue"!==o()){e.next=9;break}return e.abrupt("continue",9);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(mo),Ao=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"onTrainBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=Object(fo.a)(ho.a.mark((function e(){var t,n,r,a,i,o,s,u,c;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(s=i[o],t.push(s.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(u=e.sent,c=0;c<u.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=u[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(mo),yo=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e,r){var a;if(Object(Ur.a)(this,n),(a=t.call(this)).currentEpoch=0,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return i.tf.isNumber(a.yieldEvery)&&(a.maybeWait=function(e,t){var n,r=i.tf.now();return function(){var a=i.tf.now();return a-r<t?n:(r=a,n=e.apply(void 0,arguments))}}(a.maybeWait.bind(Object(ta.a)(a)),a.yieldEvery)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return Object(Jr.a)(n,[{key:"maybeWait",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n,r){var a;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,po(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(Object(i.xe)()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,po(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,po(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(Object(i.xe)()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,po(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,po(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(Object(i.xe)()):i.tf.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,po(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,po(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(mo);function wo(e,t){return null==e&&(e={}),e instanceof mo?[e]:Array.isArray(e)&&e[0]instanceof mo?e:da(e).map((function(e){return new yo(e,t)}))}var Go=function(){function e(){Object(Ur.a)(this,e)}return Object(Jr.a)(e,null,[{key:"registerCallbackConstructor",value:function(t,n){i.tf.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new ia("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,Object(Yn.a)(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function Bo(e,t,n,r,a,i,o,s,u){var c=new Ao,l=[new vo].concat(Object(Yn.a)(Go.createCallbacks(t)));null!=e&&l.push.apply(l,Object(Yn.a)(e)),l.push(c);var g=new bo(l);return g.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:g,history:c}}Go.constructors={};var xo=n(23),So=n(22);function ko(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return ma(e,i.Pe.SerializationMap.getMap().classNameMap,t,"layer",n)}function Zo(e,t){return Object(i.mf)((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=i.ff(fi(e),t,!0),r=i.Yd(n.shape,$r()),a=i.bf(i.qe(n,r));return i.Qd(e,a)}))}function Ro(e,t){return Object(i.mf)((function(){return i.re(fi(i.ef(t,e)),-1)}))}function No(e,t){return Object(i.mf)((function(){return i.re(i.md(i.ef(t,e)),-1)}))}function Oo(e,t){return Object(i.mf)((function(){var n=i.ef(e,t),r=i.Bd(i.md(e),$r(),Number.MAX_VALUE),a=i.md(i.Qd(n,r));return i.ve(100,i.re(a,-1))}))}function Wo(e,t){return Object(i.mf)((function(){var n=i.Bd(t,$r(),Number.MAX_VALUE),r=i.ke(i.nd(1,n)),a=i.Bd(e,$r(),Number.MAX_VALUE),o=i.ke(i.nd(1,a));return i.re(fi(i.ef(r,o)),-1)}))}function Fo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(i.mf)((function(){if(n)t=i.Ye(t);else{var r=i.ff(t,t.shape.length-1,!0);t=i.Qd(t,r)}return t=i.Bd(t,$r(),1-$r()),i.we(i.ff(i.ve(e.toFloat(),i.ke(t)),t.shape.length-1))}))}function Mo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(i.mf)((function(){var r=i.Zd(ai(e)).toInt(),a=(t=i.Bd(t,$r(),1-$r())).shape;return Fo(i.ze(r,a[a.length-1]).reshape(a),t,n)}))}function Vo(e,t){return Object(i.mf)((function(){var n;return n=i.Bd(t,$r(),1-$r()),n=i.ke(i.Qd(n,i.ef(1,n))),i.re(function(e,t){if(!i.tf.arraysEqual(e.shape,t.shape))throw new ia("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return Object(i.mf)((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function To(e,t){return Object(i.mf)((function(){var n=i.Bd(e,$r(),1),r=i.Bd(t,$r(),1);return i.ff(i.ve(e,i.ke(i.Qd(n,r))),-1)}))}function Eo(e,t){return Object(i.mf)((function(){var n=Zo(e,-1),r=Zo(t,-1),a=i.ve(n,r);return i.we(i.ff(a,-1))}))}var jo={meanSquaredError:Ro,meanAbsoluteError:No,meanAbsolutePercentageError:Oo,meanSquaredLogarithmicError:Wo,squaredHinge:function(e,t){return Object(i.mf)((function(){var n=i.qe(0,i.ef(1,i.ve(e,t)));return i.re(fi(n),-1)}))},hinge:function(e,t){return Object(i.mf)((function(){var n=i.qe(0,i.ef(1,i.ve(e,t)));return i.re(n,-1)}))},categoricalHinge:function(e,t){return Object(i.mf)((function(){var n=i.ff(i.ve(e,t),-1),r=i.ne(i.ve(i.ef(1,e),t),-1);return i.qe(0,i.nd(1,i.ef(r,n)))}))},logcosh:function(e,t){return Object(i.mf)((function(){var n=Math.log(2),r=i.ef(t,e),a=i.ef(i.nd(r,i.Ze(i.ve(-2,r))),n);return i.re(a,-1)}))},categoricalCrossentropy:Fo,sparseCategoricalCrossentropy:Mo,binaryCrossentropy:Vo,kullbackLeiblerDivergence:To,poisson:function(e,t){return Object(i.mf)((function(){var n=i.ke(i.nd($r(),t));return i.re(i.ef(t,i.ve(e,n)),-1)}))},cosineProximity:Eo};function Lo(e){if("string"===typeof e){if(e in jo)return jo[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new ia(t)}return e}function Xo(e,t){return Object(i.mf)((function(){var n=i.ve(.5,i.Be(t)),r=ni(i.ce(t,n),e.dtype);return i.re(i.Vd(e,r),-1)}))}function Ho(e,t){return Object(i.mf)((function(){return ni(i.Vd(i.qd(e,-1),i.qd(t,-1)),"float32")}))}function Yo(e,t){return Object(i.mf)((function(){return i.me(e.equal(1),t.equal(1)).sum().cast("float32")}))}function zo(e,t){return Object(i.mf)((function(){var n=Yo(e,t),r=function(e,t){return Object(i.mf)((function(){return i.me(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),a=n.add(r);return i.xf(i.ce(a,0),n.div(a),0).cast("float32")}))}function Ko(e,t){return Vo(e,t)}function _o(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),i.Vd(e,t).asType("float32")}var Do=Fo,Po=Mo,Uo={binaryAccuracy:Xo,categoricalAccuracy:Ho,precision:zo,categoricalCrossentropy:Do,sparseCategoricalCrossentropy:Po,mse:Ro,MSE:Ro,mae:No,MAE:No,mape:Oo,MAPE:Oo,cosine:Eo};function Jo(e){if("string"===typeof e&&e in Uo)return Uo[e];if("string"!==typeof e&&null!=e)return e;throw new ia("Unknown metric ".concat(e))}function Qo(e){if(ca(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(jo);n<r.length;n++){var a=r[n];if(jo[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(Uo);i<o.length;i++){var s=o[i];if(Uo[s]===e){t=s;break}}return void 0!==t?t:e.name}var qo=1048576;function $o(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!es(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>qo&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(qo,"."))}}function es(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!es(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=Object(ea.a)(e);try{for(i.s();!(a=i.n()).done;){if(!es(a.value))return!1}}catch(s){i.e(s)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function ts(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=rs(e),o=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,Object(Yn.a)(e.nodesByDepth[s]))}a("_".repeat(t)),as(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?is(c[l],n,a):os(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var g=ns(e),d=Ji(e.nonTrainableWeights);a("Total params: ".concat(g+d)),a("Trainable params: ".concat(g)),a("Non-trainable params: ".concat(d)),a("_".repeat(t))}function ns(e){return null!=e.collectedTrainableWeights?Ji(e.collectedTrainableWeights):Ji(e.trainableWeights)}function rs(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,Object(Yn.a)(s))}if(t){var u,c=Object(ea.a)(e.layers);try{for(c.s();!(u=c.n()).done;){var l,g=u.value,d=!1,h=Object(ea.a)(g.inboundNodes);try{for(h.s();!(l=h.n()).done;){var f=l.value;if(-1!==r.indexOf(f)){if(d){t=!1;break}d=!0}}}catch(p){h.e(p)}finally{h.f()}if(!t)break}}catch(p){c.e(p)}finally{c.f()}}return t}function as(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function is(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(o){r="multiple"}var a=e.name,i=e.getClassName();as(["".concat(a," (").concat(i,")"),r,e.countParams().toString()],t,n)}function os(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch(C){a="multiple"}var i,o=[],s=Object(ea.a)(e.inboundNodes);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var c=0;c<u.inboundLayers.length;++c){var l=u.inboundLayers[c].name,g=u.nodeIndices[c],d=u.tensorIndices[c];o.push("".concat(l,"[").concat(g,"][").concat(d,"]"))}}}catch(C){s.e(C)}finally{s.f()}var h=e.name,f=e.getClassName(),p=0===o.length?"":o[0];as(["".concat(h," (").concat(f,")"),a,e.countParams().toString(),p],t,r);for(var I=1;I<o.length;++I)as(["","","",o[I]],t,r)}function ss(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function us(e,t){if(null===e)return null;if("string"===typeof e)return fa(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];ss(t,a,i)?n.push(i):n.push(us(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var g=fa(c);o[g]=us(l,g)}}return o}function cs(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return ha(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];ss(t,a,i)?n.push(i):n.push(cs(i,t))}return n}for(var o={},s=0,u=Object.keys(e);s<u.length;s++){var c=u[s],l=e[c],g=ha(c);o[g]="name"!==c&&"className"!==c||"string"!==typeof l?cs(l,c):l}return o}var ls="3.7.0";var gs=function(){function e(t){if(Object(Ur.a)(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=Object(ea.a)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(o){a.e(o)}finally{a.f()}}}return Object(Jr.a)(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new ia("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Object(i.Ad)(t,e.dtype)}catch(n){throw new ia("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof no){if(null==this.id2Value[e.id])throw new ia("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new ia("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof no){if(null==this.id2Value[e.id])throw new ia("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new ia("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&Object(i.Pd)(this.id2Mask)}}]),e}(),ds={},hs={};function fs(e,t,n,r){var a,o=null!=n&&n.training,s=Array.isArray(e),u=s?e:[e],c=u.map((function(e){return e.name})),l=[],g=t.names(),d=Object(ea.a)(c);try{for(d.s();!(a=d.n()).done;){var h=a.value;-1!==g.indexOf(h)?l.push(t.getValue(h)):l.push(null)}}catch(E){d.e(E)}finally{d.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var f,p,I=c.join(",")+"|"+t.names().join(",");if(null==ds[I]){var C=function(e,t){i.tf.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=Is(e[0],t);n=a.sorted,r=a.recipientMap}else{var o,s=new Set,u=Object(ea.a)(e);try{for(u.s();!(o=u.n()).done;){var c,l=Is(o.value,t),g=l.sorted,d=l.recipientMap,h=Object(ea.a)(g);try{for(h.s();!(c=h.n()).done;){var f=c.value;s.has(f.name)||(n.push(f),s.add(f.name))}}catch(E){h.e(E)}finally{h.f()}var p=function(e){null==r[e]&&(r[e]=new Set),d[e].forEach((function(t){return r[e].add(t)}))};for(var I in d)p(I)}}catch(E){u.e(E)}finally{u.f()}}return{sorted:n,recipientCounts:ps(r)}}(u,t);f=C.sorted,p=C.recipientCounts,ds[I]=f,hs[I]=p}f=ds[I],p={},o||Object.assign(p,hs[I]);for(var m=new gs(t),b=0;b<f.length;++b){if(null!=r){var v=Object(i.se)().numTensors;v>r.maxNumTensors&&(r.maxNumTensors=v),v<r.minNumTensors&&(r.minNumTensors=v)}var A=f[b],y=A.sourceLayer;if(!(y instanceof uo)){var w,G=[],B=[],x=[],S=!1,k=Object(ea.a)(A.inputs);try{for(k.s();!(w=k.n()).done;){var Z=w.value,R=m.getValue(Z),N=m.getMask(Z);G.push(R),B.push(N),null!=N&&(S=!0),o||(p[Z.name]--,0!==p[Z.name]||t.hasKey(Z)||-1!==c.indexOf(Z.name)||R.isDisposed||!0===Z.sourceLayer.stateful||x.push(R))}}catch(E){k.e(E)}finally{k.f()}S&&((n=n||{}).mask=B[0]);var O=da(y.apply(G,n)),W=null;y.supportsMasking&&(W=y.computeMask(G,B));for(var F=Cs(A),M=Array.isArray(F)?F:[F],V=0;V<M.length;++V){m.hasKey(M[V])||m.add(M[V],O[V],Array.isArray(W)?W[0]:W);var T=c.indexOf(M[V].name);-1!==T&&(l[T]=O[V])}o||Object(i.Pd)(x)}}return m.disposeMasks(),s?l:l[0]}function ps(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Is(e,t){var n,r=new Set,a=[],i={},o=Object(ea.a)(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(p){o.e(p)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var g=c[c.length-1]===u.length-1;if(0===l.inputs.length||g)u.pop(),a.push(l),r.add(l.name),g&&c.pop();else{c.push(u.length-1);var d,h=Object(ea.a)(l.inputs);try{for(h.s();!(d=h.n()).done;){var f=d.value;null==i[f.name]&&(i[f.name]=new Set),i[f.name].add(l.name),r.has(f.name)||u.push(f)}}catch(p){h.e(p)}finally{h.f()}}}}return{sorted:a,recipientMap:i}}function Cs(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=Object(ea.a)(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(o){i.e(o)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function ms(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function bs(e,t){return ms(e,t,"classWeight")}function vs(e,t,n,r){return As.apply(this,arguments)}function As(){return(As=Object(fo.a)(ho.a.mark((function e(t,n,r,a){var o,s,u;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return o=Object(i.mf)((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1){return t.argMax(1)}if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,o.data();case 7:return e.t1=e.sent,s=e.t0.from.call(e.t0,e.t1),Object(i.Pd)(o),u=[],s.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");u.push(r[e])})),e.abrupt("return",Object(i.jf)(u,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ys(e,t){return Object(i.ve)(e,t)}function ws(e,t){var n,r,a=t;n=a.xs,r=a.ys,i.tf.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var o=Gs("input",e.inputNames,n),s=Gs("output",e.outputNames,r),u=o[0].shape[0];i.tf.assert(o.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(o.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),i.tf.assert(s.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(s.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var c=function(t){i.tf.assert(o[t].shape[0]===u,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(e.inputNames[0],".")}))},l=0;l<o.length;l++)c(l);for(var g=function(t){i.tf.assert(s[t].shape[0]===u,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(s[t].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(e.inputNames[0],".")}))},d=0;d<s.length;d++)g(d);return{xs:o,ys:s}}function Gs(e,t,n){if(n instanceof i.bd)return[n];if(Array.isArray(n))return i.tf.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],o=Object(ea.a)(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(null==n[s])throw new ia("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(s,"'."));a.push(n[s])}}catch(u){o.e(u)}finally{o.f()}return a}function Bs(e){if(3===e.length)throw new oa("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function xs(e,t,n){return Ss.apply(this,arguments)}function Ss(){return(Ss=Object(fo.a)(ho.a.mark((function e(t,n,r){var a,o,s,u,c,l,g,d,h,f,p,I,C,m,b,v,A,y,w,G,B,x,S,k,Z,R,N,O,W,F,M,V,T;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,i.tf.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),i.tf.assert(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),i.tf.assert(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),i.tf.assert(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),i.tf.assert(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(o=null!=r.validationData)&&(Zs(r.validationData)?i.tf.assert(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(c=Bs(r.validationData),s=c.xs,u=c.ys)),l=t.makeTrainFunction(),g=t.getDedupedMetricsNames(),d=o?g.slice().concat(g.map((function(e){return"val_"+e}))):g.slice(),h=wo(r.callbacks,r.yieldEvery),f=null==r.verbose?1:r.verbose,p=Bo(h,f,r.epochs,null,null,ks(n,r),null,o,d),I=p.callbackList,C=p.history,I.setModel(t),t.history=C,e.next=22,I.onTrainBegin();case 22:return t.stopTraining_=!1,m=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:b=e.sent;case 27:if(!(m<r.epochs)){e.next=98;break}return v={},e.next=31,I.onEpochBegin(m);case 31:if(A=0,y=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:b=e.sent;case 37:if(a&&!(A<r.batchesPerEpoch)){e.next=91;break}return e.next=40,b.next();case 40:if(w=e.sent,!a||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(A," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return G=ws(t,w.value),B=G.xs,x=G.ys,(S={}).batch=y,S.size=B[0].shape[0],e.next=51,I.onBatchBegin(y,S);case 51:if(k=[],null==r.classWeight){e.next=64;break}Z=bs(r.classWeight,t.outputNames),R=0;case 55:if(!(R<Z.length)){e.next=64;break}return e.t0=k,e.next=59,vs(x[R],null,Z[R]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++R,e.next=55;break;case 64:for(N=B.concat(x).concat(k),O=l(N),i.Pd(N),W=0;W<g.length;++W)F=g[W],M=O[W],S[F]=M,i.ge(M);return e.next=70,I.onBatchEnd(y,S);case 70:Co(S),y++,A++;case 73:if(!(a?A>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!o){e.next=86;break}if(V=void 0,!Zs(r.validationData)){e.next=84;break}return e.t2=da,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,V=(0,e.t2)(e.t3),e.next=85;break;case 84:V=da(t.evaluate(s,u,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 85:for(T=0;T<t.metricsNames.length;++T)v["val_".concat(t.metricsNames[T])]=V[T];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,I.onEpochEnd(m,v);case 93:if(m++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,I.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])})))).apply(this,arguments)}function ks(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function Zs(e){return"function"===typeof e.iterator}function Rs(e){return"function"===typeof e.next}function Ns(e,t,n){return Os.apply(this,arguments)}function Os(){return(Os=Object(fo.a)(ho.a.mark((function e(t,n,r){var a,o,s,u,c,l,g,d,h;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,o=t.testFunction,s=[],!(r.verbose>0)){e.next=6;break}throw new oa("Verbose mode is not implemented yet.");case 6:if(i.tf.assert(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),!Rs(n)){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:u=e.t0,c=0,l=0,g=ho.a.mark((function e(){var n;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.next();case 2:if(n=e.sent,s=i.mf((function(){return n.value&&function(){var e=ws(t,n.value),r=e.xs,a=e.ys,u=r.concat(a),g=i.mf((function(){return o(u)}));if(i.Pd(u),0===l)for(var d=0;d<g.length;++d)s.push(Object(i.Me)(0));for(var h=u[0].shape[0],f=function(e){var t=g[e],n=s[e];s[e]=i.mf((function(){return i.nd(s[e],i.ve(h,t))})),l>0&&i.Pd(n)},p=0;p<g.length;++p)f(p);i.Pd(g),c+=h,++l}(),s})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(l<r.batches)){e.next=25;break}return e.delegateYield(g(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(d=0;d<s.length;++d)h=s[d],s[d]=i.Qd(s[d],c),i.Pd(h);return e.abrupt("return",ga(s));case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ws(e){i.tf.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function Fs(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return ii(e,t,n-t)})):ii(e,t,n-t)}function Ms(e,t){return i.mf((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return Ms(e,t)})):hi(e,"int32"===t.dtype?t:t.toInt())}))}function Vs(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function Ts(e,t,n,r,a,i,o,s,u,c,l,g,d,h,f){return Es.apply(this,arguments)}function Es(){return(Es=Object(fo.a)(ho.a.mark((function e(t,n,r,a,o,s,u,c,l,g,d,h,f,p,I){var C,m,b,v,A,y,w,G;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==o&&(o=32),null==s&&(s=1),null==d&&(d=!0),null==f&&(f=0),C=!1,null!=l&&null!=g&&(C=!0),null==I){e.next=10;break}if(C=!0,null!=p){e.next=10;break}throw new ia("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(m=t.checkNumSamples(r,o,p,"steps_per_epoch"))&&(b=ti(0,m)),null==u&&(u=1),v=Bo(c,u,s,f,m,p,o,C,h),A=v.callbackList,y=v.history,A.setModel(t),t.history=y,e.next=18,A.onTrainBegin();case 18:t.stopTraining_=!1,w=ho.a.mark((function e(s){var u;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.onEpochBegin(s);case 2:if(u={},null==p){e.next=7;break}throw new oa("stepsPerEpoch mode is not implemented yet.");case 7:return e.delegateYield(ho.a.mark((function e(){var s,c,h,f;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==d){e.next=4;break}throw new oa("batch shuffling is not implemneted yet");case 4:d&&i.tf.shuffle(b);case 5:s=Object(i.jf)(b),c=Vs(m,o),h=ho.a.mark((function e(d){var h;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h={},e.next=3,A.onBatchBegin(d,h);case 3:return i.mf((function(){var e=c[d][0],f=c[d][1],p=ii(s,e,f-e);h.batch=d,h.size=f-e;for(var I=Ms(r,p),m=n(I),b=0;b<a.length;++b){var v=a[b],A=m[b];h[v]=A,i.ge(A)}if(d===c.length-1&&C)for(var y=t.testLoop(l,g,o),w=0;w<a.length;++w){var G=a[w],B=y[w];i.ge(B),u["val_"+G]=B}})),e.next=6,A.onBatchEnd(d,h);case 6:if(Co(h),!t.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),f=0;case 9:if(!(f<c.length)){e.next=17;break}return e.delegateYield(h(f),"t0",11);case 11:if("break"!==e.t0){e.next=14;break}return e.abrupt("break",17);case 14:++f,e.next=9;break;case 17:s.dispose();case 18:case"end":return e.stop()}}),e)}))(),"t0",8);case 8:return e.next=10,A.onEpochEnd(s,u);case 10:if(!t.stopTraining_){e.next=12;break}return e.abrupt("return","break");case 12:case"end":return e.stop()}}),e)})),G=f;case 21:if(!(G<s)){e.next=29;break}return e.delegateYield(w(G),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++G,e.next=21;break;case 29:return e.next=31,A.onTrainEnd();case 31:return e.next=33,t.history.syncData();case 33:return e.abrupt("return",t.history);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function js(e,t,n){return Ls.apply(this,arguments)}function Ls(){return(Ls=Object(fo.a)(ho.a.mark((function e(t,n,r){var a,o,s,u,c,l,g,d,h,f,p,I,C,m,b,v,A,y,w,G,B,x,S,k,Z=arguments;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Z.length>3&&void 0!==Z[3]?Z[3]:{},!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,Ws(h=null==a.batchSize?32:a.batchSize),f=!1,e.next=10,t.standardizeUserData(n,r,a.sampleWeight,a.classWeight,f,h);case 10:if(p=e.sent,o=p[0],s=p[1],d=p[2],I=!1,!(null!=a.validationData&&a.validationData.length>0)){e.next=36;break}if(I=!0,2!==a.validationData.length){e.next=22;break}u=a.validationData[0],c=a.validationData[1],e.next=27;break;case 22:if(3!==a.validationData.length){e.next=26;break}throw new oa("validationData including sample weights is not supported yet.");case 26:throw new ia("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(a.validationData," is invalid."));case 27:return m=!0,e.next=30,t.standardizeUserData(u,c,null,null,m,h);case 30:b=e.sent,l=b[0],g=b[1],C=l.concat(g),e.next=37;break;case 36:null!=a.validationSplit&&a.validationSplit>0&&a.validationSplit<1?(I=!0,v=Math.floor(o[0].shape[0]*(1-a.validationSplit)),A=o[0].shape[0],l=Fs(o,v,A),o=Fs(o,0,v),g=Fs(s,v,A),s=Fs(s,0,v),C=l.concat(g)):null!=a.validationSteps&&(I=!0);case 37:return y=o.concat(s).concat(d),t.checkTrainableWeightsConsistency(),w=t.makeTrainFunction(),G=t.getDedupedMetricsNames(),I?(t.makeTestFunction(),B=t.testFunction,x=G.slice().concat(G.map((function(e){return"val_"+e})))):(B=null,C=[],x=G.slice()),S=wo(a.callbacks,a.yieldEvery),e.next=45,Ts(t,w,y,G,h,a.epochs,a.verbose,S,B,C,a.shuffle,x,a.initialEpoch,null,null);case 45:return k=e.sent,e.abrupt("return",k);case 47:return e.prev=47,t.isTraining=!1,Hs(o,n),Hs(s,r),Hs(l,u),Hs(g,c),null!=d&&i.Pd(d),e.finish(47);case 55:case"end":return e.stop()}}),e,null,[[4,,47,55]])})))).apply(this,arguments)}function Xs(e){var t=[];e instanceof i.bd&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(ri(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Hs(e,t){if(null!=e){var n=[];if(t instanceof i.bd)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var o=[];if(e instanceof i.bd)-1===n.indexOf(e.id)&&o.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&o.push(e)}));else if(null!=e)for(var s in e){var u=e[s];-1===n.indexOf(u.id)&&o.push(u)}o.forEach((function(e){e.isDisposed||e.dispose()}))}}function Ys(e){return Array.isArray(e)}function zs(e){return!function(e){return e instanceof i.bd}(e)&&!Ys(e)}function Ks(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(Ys(e)&&e.length>0)o=!0;else if(zs(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new ia("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(zs(e)){e=e,r=[];var u,c=Object(ea.a)(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new ia('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(I){c.e(I)}finally{c.f()}}else if(Ys(e)){if((e=e).length!==t.length)throw new ia("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(e=e,t.length>1)throw new ia("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=Xs(r),null!=n)for(var g=0;g<t.length;++g)if(null!=n[g]){var d=r[g];if(d.shape.length!==n[g].length)throw new ia("Error when checking ".concat(i,": expected ").concat(t[g]," ")+"to have ".concat(n[g].length," dimension(s). but got array with ")+"shape ".concat(d.shape));for(var h=0;h<n[g].length;++h)if(0!==h||a){var f=d.shape[h],p=n[g][h];if(null!=p&&p>=0&&f!==p)throw new ia("Error when checking ".concat(i,": expected ").concat(t[g]," ")+"to have shape [".concat(n[g],"], but got array with shape ")+"[".concat(d.shape,"]."))}}return r}function _s(e,t,n){var r=va(e.map((function(e){return e.shape[0]})));r.sort();var a=va(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new ia("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new ia("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!i.tf.arraysEqual(r,a))throw new ia("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function Ds(e,t,n){for(var r=[Ro,Vo,Fo],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===Fo&&1===i.shape[i.shape.length-1])throw new ia("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var g=u[l],d=c[l];if(null!=d&&g!==d)throw new ia("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function Ps(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new ia("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new ia("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new ia("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new ia("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var Us=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).isTraining=!1,r}return Object(Jr.a)(n,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new ia("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");ts(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return i.of.adagrad(.01)},Adadelta:function(){return i.of.adadelta(1,.95,$r())},Adam:function(){return i.of.adam(.001,.9,.999,$r())},Adamax:function(){return i.of.adamax(.002,.9,.999,$r(),0)},RMSProp:function(){return i.of.rmsprop(.001,.9,0,$r())},SGD:function(){return i.of.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new ia("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof i.dc))throw new ia("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ia("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return Lo(e)}))}else{var a=Lo(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var o in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(o))throw new ia('Unknown entry in loss dictionary: "'.concat(o,'". ')+"Only expected the following keys: ".concat(this.outputNames));var s,u=Object(ea.a)(this.outputNames);try{for(u.s();!(s=u.n()).done;){var c=s.value;null==e.loss[c]&&console.warn('Output "'.concat(c,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(c," during training")),n.push(Lo(e.loss[c]))}}catch(I){u.e(I)}finally{u.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var l=0;l<this.outputs.length;++l){var g=this.internalOutputShapes[l],d=this.outputNames[l];this.feedOutputNames.push(d),this.feedOutputShapes.push(g),this.feedLossFns.push(this.lossFunctions[l])}var h=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Da("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===h.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var f=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=Object(ea.a)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(I){i.e(I)}finally{i.f()}return a}(e.metrics,this.outputNames),p=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};Da("metric",(function(){for(var e=function(e){if(-1!==h.indexOf(e))return"continue";!function(n){var r,a,i,o,s=Object(ea.a)(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;if("string"===typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===Vo?-1!==["accuracy","acc"].indexOf(u)?a=Xo:-1!==["crossentropy","ce"].indexOf(u)&&(a=Ko):t.lossFunctions[e]===Mo?-1!==["accuracy","acc"].indexOf(u)?a=_o:-1!==["crossentropy","ce"].indexOf(u)&&(a=Po):-1!==["accuracy","acc"].indexOf(u)?a=Ho:-1!==["crossentropy","ce"].indexOf(u)&&(a=Do);var l=void 0;-1!==["accuracy","acc"].indexOf(u)?l="acc":-1!==["crossentropy","ce"].indexOf(u)&&(l="ce"),i=a,r=""+l}else{var g=Jo(u);i=g,r=""+Qo(u)}var d=void 0;Da(r,(function(){d=i})),p(e,r,d)}}catch(I){s.e(I)}finally{s.f()}}(f[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;Ws(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var s=this.testFunction,u=this.testLoop(s,o,r,n.verbose,n.steps);return ga(u)}finally{Hs(i[0],e),Hs(i[1],t)}}},{key:"evaluateDataset",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",Ns(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new ia("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new ia("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new ia("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),o=new gs;if(e instanceof i.bd&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ia("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var s=0;s<this.inputs.length;++s)o.add(this.inputs[s],e[s])}else{var u,c=Object(ea.a)(this.inputs);try{for(c.s();!(u=c.n()).done;){var l=u.value,g=e[l.name];if(null==g)throw new ia("No value is provided for the model's input ".concat(l.name));o.add(l,g)}}catch(h){c.e(h)}finally{c.f()}}var d=fs(a,o);return n?d:d[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=ua(null,e.length),r=e.length,a=Object(ea.a)(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(g){a.e(g)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new ia("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i.mf((function(){var a=t.checkNumSamples(e);if(r)throw new oa("Verbose predictLoop() is not implemented yet.");for(var o=Vs(a,n),s=t.outputs.map((function(e){return[]})),u=function(n){i.mf((function(){var r=o[n][0],a=o[n][1],i=Fs(e,r,a),s=[];if(Array.isArray(i))for(var u=0;u<i.length;++u)s.push({key:t.inputs[u],value:i[u]});else s.push({key:t.inputs[0],value:i});var c=new gs(s);return fs(t.outputs,c)})).forEach((function(e,t){return s[t].push(e)}))},c=0;c<o.length;++c)u(c);return ga(s.map((function(e){return i.Dd(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Xs(e);Ps(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return Ws(r),this.predictLoop(n,r)}finally{Hs(n,e)}}},{key:"predictOnBatch",value:function(e){Ps(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new aa("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===Mo?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(_s(e=Ks(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Ks(t,this.feedOutputNames,r,!1,"target")),Ds(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new ia("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n,r,a){var i,s,u,c,l,g,d,h,f,p=arguments;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(p.length>4&&void 0!==p[4])||p[4],s=p.length>5?p[5]:void 0,u=this.standardizeUserDataXY(t,n,i,s),c=Object(o.a)(u,2),l=c[0],g=c[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(d=null,null==a){e.next=19;break}h=bs(a,this.outputNames),d=[],f=0;case 10:if(!(f<h.length)){e.next=19;break}return e.t0=d,e.next=14,vs(g[f],null,h[f]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++f,e.next=10;break;case 19:return e.abrupt("return",[l,g,d]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0;return i.mf((function(){var s=r.checkNumSamples(t,n,o,"steps"),u=[];if(a>0)throw new oa("Verbose mode is not implemented yet.");if(null!=o)throw new oa("steps mode in testLoop() is not implemented yet");for(var c=Vs(s,n),l=Object(i.jf)(ti(0,s)),g=0;g<c.length;++g){var d=c[g][0],h=c[g][1],f=ii(l,d,h-d),p=Ms(t,f),I=e(p);if(0===g)for(var C=0;C<I.length;++C)u.push(Object(i.Me)(0));for(var m=0;m<I.length;++m){var b=I[m];u[m]=i.nd(u[m],i.ve(h-d,b))}}for(var v=0;v<u.length;++v)u[v]=i.Qd(u[v],s);return u}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(la(e,r)>1){var i=la(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),s=[],u=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],u=0;u<e.inputs.length;++u)t.push({key:e.inputs[u],value:r[u]});for(var c,l=new gs(t),g=fs(e.outputs,l,{training:!0}),d=0;d<e.lossFunctions.length;++d){var h=(0,e.lossFunctions[d])(a[d],g[d]);null!=o[d]&&(h=ys(h,o[d]));var f=i.re(h);n.push(f),c=0===d?h:i.nd(c,h)}for(var p=0;p<e.metricsTensors.length;++p){var I=void 0;if(e.outputs.length>1&&p<e.outputs.length)I=n[p];else{var C=e.metricsTensors[p][0],m=e.metricsTensors[p][1];I=i.re(C(a[m],g[m]))}i.ge(I),s.push(I)}return c=i.re(c),e.calculateLosses().forEach((function(e){c=i.nd(c,e)})),c}),!0,u)].concat(s)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return i.mf((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),o=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),s=[],u=0;u<e.inputs.length;++u)s.push({key:e.inputs[u],value:a[u]});for(var c=new gs(s),l=fs(e.outputs,c),g=0;g<e.lossFunctions.length;++g){var d=e.lossFunctions[g],h=i.re(d(o[g],l[g]));n=0===g?h:i.nd(n,h),r.push(n)}for(var f=0;f<e.metricsTensors.length;++f){var p=e.metricsTensors[f][0],I=e.metricsTensors[f][1],C=i.re(p(o[I],l[I]));r.push(C)}return r}))}}},{key:"fit",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a=arguments;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},e.abrupt("return",js(this,t,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xs(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,o,s,u,c,l,g,d,h;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],o=r[1],s=this.makeTrainFunction(),u=s(a.concat(o)),c=[],l=Object(ea.a)(u),e.prev=9,l.s();case 11:if((g=l.n()).done){e.next=19;break}return d=g.value,e.next=15,d.data();case 15:h=e.sent,c.push(h[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),l.e(e.t0);case 24:return e.prev=24,l.f(),e.finish(24);case 27:return i.Pd(u),e.abrupt("return",ga(c));case 29:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=i.se().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-i.se().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=ha(this.loss);else if(Array.isArray(this.loss)){var t,n=Object(ea.a)(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(u){n.e(u)}finally{n.f()}e=this.loss.map((function(e){return ha(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!==typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=ha(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[ha(Qo(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return ha(Qo(e))}));var e={};for(var t in this.metrics)e[t]=ha(Qo(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=ko(us(e.optimizer_config));if("string"===typeof e.loss)t=fa(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return fa(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=fa(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return fa(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=fa(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a,o,s,u,c,l,g,d;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=i.fe.getSaveHandlers(t)).length){e.next=6;break}throw new ia("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new ia("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new ia("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.next=13,i.fe.encodeWeights(this.getNamedWeights(n));case 13:if(a=e.sent,!1,null,o=this.toJSON(null,false),s={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(ls),convertedBy:null},!(null!=n&&n.includeOptimizer)||null==this.optimizer){e.next=34;break}return s.trainingConfig=this.getTrainingConfig(),c="optimizer",e.t0=i.fe,e.next=25,this.optimizer.getWeights();case 25:return e.t1=e.sent,e.t2=c,e.next=29,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 29:l=e.sent,g=l.data,d=l.specs,(u=a.specs).push.apply(u,Object(Yn.a)(d)),a.data=i.fe.concatenateArrayBuffers([a.data,g]);case 34:return null!=this.userDefinedMetadata&&(!0,$o(this.userDefinedMetadata,this.name,true),s.userDefinedMetadata=this.userDefinedMetadata),s.weightData=a.data,s.weightSpecs=a.specs,e.abrupt("return",t.save(s));case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){$o(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),n}(function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=Ki(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],va(r.inputs).length!==r.inputs.length)throw new ia("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));va(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=Object(ea.a)(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.sourceLayer,c=s.nodeIndex,l=s.tensorIndex;r.outputLayers.push(u),r.outputLayersNodeIndices.push(c),r.outputLayersTensorIndices.push(l)}}catch(ye){o.e(ye)}finally{o.f()}var g,d=Object(ea.a)(r.inputs);try{for(d.s();!(g=d.n()).done;){var h=g.value,f=h.sourceLayer,p=h.nodeIndex,I=h.tensorIndex;ca(0===p,"input layer has >1 nodes"),ca(0===I,"input layer has >1 tensors"),r.inputLayers.push(f),r.inputLayersNodeIndices.push(p),r.inputLayersTensorIndices.push(I)}}catch(ye){d.e(ye)}finally{d.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var C=0;C<r.inputLayers.length;C++){var m=r.inputLayers[C];if(!(m instanceof uo))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(C," (0-based) originates ")+"from layer type ".concat(m.getClassName(),"."));r.inputNames.push(m.name),r.feedInputShapes.push(m.batchInputShape),r.feedInputNames.push(m.name)}var b,v=Object(ea.a)(r.outputLayers);try{for(v.s();!(b=v.n()).done;){var A=b.value;r.outputNames.push(A.name)}}catch(ye){v.e(ye)}finally{v.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var y,w={},G={},B={},x={},S={},k=[],Z=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new aa("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in S||(S[o.id]=Object.keys(S).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,g=0;g<l;g++){e(c.inputTensors[g],a,i,c.inboundLayers[g],c.nodeIndices[g],c.tensorIndices[g])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);k.push(c)}},R=[],N=[],O=Object(ea.a)(r.outputs);try{for(O.s();!(y=O.n()).done;){Z(y.value,R,N)}}catch(ye){O.e(ye)}finally{O.f()}var W,F=k.slice().reverse(),M=Object(ea.a)(F);try{for(M.s();!(W=M.n()).done;){var V=W.value;G[V.id]=V,V.id in w||(w[V.id]=0);var T=w[V.id],E=null==B[V.outboundLayer.id]?0:B[V.outboundLayer.id];T=Math.max(T,E),B[V.outboundLayer.id]=T,x[V.outboundLayer.id]=V.outboundLayer,w[V.id]=T;for(var j=0;j<V.inboundLayers.length;j++){var L=V.inboundLayers[j],X=V.nodeIndices[j],H=L.inboundNodes[X],Y=null==w[H.id]?0:w[H.id];w[H.id]=Math.max(T+1,Y),G[H.id]=H}}}catch(ye){M.e(ye)}finally{M.f()}var z={};for(var K in w){var _=w[K];_ in z||(z[_]=[]),z[_].push(G[K])}var D={};for(var P in B){var U=B[P];U in D||(D[U]=[]),D[U].push(x[P])}var J=Object.keys(D).map((function(e){return parseInt(e,10)})).sort(ba);r.layers=[];var Q,q=Object(ea.a)(J);try{for(q.s();!(Q=q.n()).done;){var $=D[Q.value];$.sort((function(e,t){var n=S[e.id],r=S[t.id];return n<r?-1:n>r?1:0}));var ee,te=Object(ea.a)($);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;ne instanceof n&&r.internalContainerRefs.push(ne),r.layers.push(ne)}}catch(ye){te.e(ye)}finally{te.f()}}}catch(ye){q.e(ye)}finally{q.f()}r.layersByDepth=D,J=Object.keys(z).map((function(e){return parseInt(e,10)})).sort(ba);var re,ae=r.inputs.slice(),ie=[],oe=Object(ea.a)(J);try{for(oe.s();!(re=oe.n()).done;){var se,ue=re.value,ce=Object(ea.a)(z[ue]);try{for(ce.s();!(se=ce.n()).done;){var le=se.value,ge=le.outboundLayer;if(null!=ge){var de,he=Object(ea.a)(le.inputTensors);try{for(he.s();!(de=he.n()).done;){var fe=de.value;if(-1===ae.indexOf(fe))throw new aa("Graph disconnected: cannot obtain value for tensor ".concat(fe)+' at layer "'.concat(ge.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(ie))}}catch(ye){he.e(ye)}finally{he.f()}var pe,Ie=Object(ea.a)(le.outputTensors);try{for(Ie.s();!(pe=Ie.n()).done;){var Ce=pe.value;ae.push(Ce)}}catch(ye){Ie.e(ye)}finally{Ie.f()}ie.push(ge.name)}}}catch(ye){ce.e(ye)}finally{ce.f()}}}catch(ye){oe.e(ye)}finally{oe.f()}r.nodesByDepth=z;var me,be=r.layers.map((function(e){return e.name})),ve=Object(ea.a)(be);try{var Ae=function(){var e=me.value,t=be.filter((function(t){return t===e})).length;if(1!==t)throw new aa('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(be))};for(ve.s();!(me=ve.n()).done;)Ae()}catch(ye){ve.e(ye)}finally{ve.f()}return r.outboundNodes=[],r.inboundNodes=[],new ao({outboundLayer:Object(ta.a)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return Object(Jr.a)(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=Object(ea.a)(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(s){n.e(s)}finally{n.f()}var a,i=Object(ea.a)(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(s){i.e(s)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new ia("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=Object(ea.a)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=Object(ea.a)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Yn.a)(r.nonTrainableWeights))}}catch(u){n.e(u)}finally{n.f()}if(!this.trainable){var a,i=[],o=Object(ea.a)(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,Object(Yn.a)(s.trainableWeights))}}catch(u){o.e(u)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=Object(ea.a)(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=t.value,u=Object(ea.a)(s.weights);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(null!=r[c.originalName])throw new ia("Duplicate weight name: ".concat(c.originalName));r[c.originalName]=c,a++}}catch(C){u.e(C)}finally{u.f()}}}catch(C){i.e(C)}finally{i.f()}var l=[];for(var g in e){var d=g;if(null==r[g]){var h=g.split("/"),f=h.slice(0,-2).concat([h[h.length-1]]);d=f.join("/")}if(null!=r[d])l.push([r[d],e[g]]);else if(n)throw new ia("Provided weight data has no target variable: ".concat(g));delete r[d]}if(n){var p=[];for(var I in r)p.push(I);if(p.length>0)throw new ia("".concat(p.length," of ").concat(a," weights are not set: ")+"".concat(p))}eo(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(ls),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=cs(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){e=da(e);for(var r=new gs,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return fs(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return Object(i.mf)((function(){var r;return e=da(e),r=null==t?ua(null,e.length):da(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=Di(e);if(t.length!==this.inputLayers.length)throw new ia("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(ba);if(o.length>1){var s,u=Object(ea.a)(o);try{for(u.s();!(s=u.n()).done;){var c,l=s.value,g=this.nodesByDepth[l],d=Object(ea.a)(g);try{for(d.s();!(c=d.n()).done;){var h=c.value,f=h.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(f.id)){for(var p=[],I=0;I<h.inboundLayers.length;I++){var C=h.inboundLayers[I],m=h.nodeIndices[I],b=h.tensorIndices[I],v=n["".concat(C.name,"_").concat(m,"_").concat(b)];p.push(v)}for(var A=Di(f.computeOutputShape(ga(p))),y=f.inboundNodes.indexOf(h),w=0;w<A.length;w++){n["".concat(f.name,"_").concat(y,"_").concat(w)]=A[w]}}}}catch(W){d.e(W)}finally{d.f()}}}catch(W){u.e(W)}finally{u.f()}}for(var G=[],B=[],x=0;x<this.outputLayers.length;x++){var S=this.outputLayers[x],k=this.outputLayersNodeIndices[x],Z=this.outputLayersTensorIndices[x],R="".concat(S.name,"_").concat(k,"_").concat(Z);B.push(R)}for(var N=0;N<B.length;N++){var O=B[N];ca(O in n),G.push(n[O])}return ga(G)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=ua(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],s=t[r];n[a.id]=[i,s]}var u,c=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(ba),l=Object(ea.a)(c);try{for(l.s();!(u=l.n()).done;){var g,d=u.value,h=this.nodesByDepth[d],f=Object(ea.a)(h);try{for(f.s();!(g=f.n()).done;){var p,I=g.value,C=I.outboundLayer,m=I.inputTensors,b=I.outputTensors,v=new Array,A=Object(ea.a)(m);try{for(A.s();!(p=A.n()).done;){var y=p.value;y.id in n&&v.push(n[y.id])}}catch(z){A.e(z)}finally{A.f()}if(v.length===m.length){var w={},G=void 0,B=void 0,x=void 0,S=void 0;if(null!=I.callArgs&&(w=I.callArgs),1===v.length){var k=Object(o.a)(v[0],2),Z=k[0],R=k[1];null==w.mask&&(w.mask=R),x=da(C.call(Z,w)),S=da(C.computeMask(Z,R)),G=[Z],B=[R]}else G=v.map((function(e){return e[0]})),B=v.map((function(e){return e[1]})),null==w.mask&&(w.mask=B),x=da(C.call(G,w)),S=da(C.computeMask(G,B));if(C.activityRegularizer)throw new oa("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var N=0;N<b.length;++N){var O=b[N],W=x[N],F=S[N];n[O.id]=[W,F]}}}}catch(z){f.e(z)}finally{f.f()}}}catch(z){l.e(z)}finally{l.f()}var M,V=[],T=[],E=[],j=Object(ea.a)(this.outputs);try{for(j.s();!(M=j.n()).done;){var L=M.value;ca(L.id in n,"Could not compute output ".concat(L.name," : ").concat(L.id));var X=Object(o.a)(n[L.id],2),H=X[0],Y=X[1];E.push(H.shape),V.push(H),T.push(Y)}}catch(z){j.e(z)}finally{j.f()}return[V,T,E]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=Object(ea.a)(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(c){i.e(c)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new ia("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new ia("Provide either a layer name or layer index");var n,r=Object(ea.a)(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(i){r.e(i)}finally{r.f()}throw new ia("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return Object(i.mf)((function(){var t,r=[],a=Object(ea.a)(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,Object(Yn.a)(i.calculateLosses()))}}catch(u){a.e(u)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=Object(ea.a)(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var g=o.inboundNodes[l],d=n.nodeKey(o,l),h={};if(this.containerNodes.has(d)){if(g.callArgs)try{JSON.stringify(g.callArgs),h=g.callArgs}catch(M){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(g.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),h={}}if(g.inboundLayers.length>0){for(var f=[],p=0;p<g.inboundLayers.length;p++){var I=g.inboundLayers[p],C=g.nodeIndices[p],m=g.tensorIndices[p],b=r[n.nodeKey(I,C)];null==b&&(b=0),f.push([I.name,b,m,h])}c.push(f)}}}var v={};v.name=o.name,v.className=s,v.config=u,v.inboundNodes=c,a.push(v)}}catch(M){i.e(M)}finally{i.f()}t.layers=a;for(var A=[],y=0;y<this.inputLayers.length;y++){var w=this.inputLayers[y],G=this.inputLayersNodeIndices[y],B=n.nodeKey(w,G);if(this.containerNodes.has(B)){var x=r[B];null!==x&&void 0!==x||(x=0);var S=this.inputLayersTensorIndices[y];A.push([w.name,x,S])}}t.inputLayers=A;for(var k=[],Z=0;Z<this.outputLayers.length;Z++){var R=this.outputLayers[Z],N=this.outputLayersNodeIndices[Z],O=n.nodeKey(R,N);if(this.containerNodes.has(O)){var W=r[O];null!==W&&void 0!==W||(W=0);var F=this.outputLayersTensorIndices[Z];k.push([R.name,W,F])}}return t.outputLayers=k,t}},{key:"stateful",get:function(){if(this._stateful)throw new ia("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=Object(ea.a)(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;Object(i.mf)((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=Object(ea.a)(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],g=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var d=r[c];if(d.inboundNodes.length<=l)return void i(e,t);var h=d.inboundNodes[l];o.push(h.outputTensors[g])}}catch(f){s.e(f)}finally{s.f()}o.length>0&&e.apply(ga(o),n)}function s(e){var a=e.name,o=ko(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new ia("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,c=t.name,l=t.layers,g=Object(ea.a)(l);try{for(g.s();!(u=g.n()).done;){var d=u.value;s(d)}}catch(X){g.e(X)}finally{g.f()}for(;!Aa(a);){var h,f=Object(ea.a)(l);try{for(f.s();!(h=f.n()).done;){var p=h.value,I=r[p.name];if(I.name in a){var C=a[I.name];delete a[I.name];var m,b=Object(ea.a)(C);try{for(b.s();!(m=b.n()).done;){var v=m.value;o(I,v)}}catch(X){b.e(X)}finally{b.f()}}}}catch(X){f.e(X)}finally{f.f()}}var A,y=[],w=[],G=t.inputLayers,B=Object(ea.a)(G);try{for(B.s();!(A=B.n()).done;){var x=A.value,S=x[0],k=x[1],Z=x[2];ca(S in r);var R=r[S],N=R.inboundNodes[k].outputTensors;y.push(N[Z])}}catch(X){B.e(X)}finally{B.f()}var O,W=t.outputLayers,F=Object(ea.a)(W);try{for(F.s();!(O=F.n()).done;){var M=O.value,V=M[0],T=M[1],E=M[2];ca(V in r);var j=r[V],L=j.inboundNodes[T].outputTensors;w.push(L[E])}}catch(X){F.e(X)}finally{F.f()}return new e({inputs:y,outputs:w,name:c})}}]),n}(oo));Us.className="Model",i.Pe.registerClass(Us);var Js=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return n}(Us);Js.className="Functional",i.Pe.registerClass(Js);var Qs=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:Ki("sequential_"),null!=e.layers){var a,i=Object(ea.a)(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(s){i.e(s)}finally{i.f()}}return r}return Object(Jr.a)(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new ia("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof Us;if(r){if(1!==(t=e).outputs.length)throw new ia("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new ia("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new ia("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=co({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new ia("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new ia("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=so(this.outputs[0])}this.inboundNodes=[],new ao({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ua(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(Ui(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Us({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),Object(xo.a)(Object(So.a)(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),Object(xo.a)(Object(So.a)(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new aa("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new aa("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){var r,a=arguments;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new aa("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new aa("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t,n){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new ia("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new ia("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=Object(ea.a)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(i){n.e(i)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new ia("Legacy serialization format not supported yet.");r=t}else i.tf.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,o=t;var s=new e(o);if(!(s instanceof n))throw new oa("Sequential.fromConfig called on non-Sequential input: ".concat(s));var u,c=Object(ea.a)(r);try{for(c.s();!(u=c.n()).done;){var l=u.value,g=void 0,d=ko(l,g,a);a&&d.setFastWeightInitDuringBuild(!0),s.add(d)}}catch(h){c.e(h)}finally{c.f()}return s}}]),n}(Us);function qs(e){return new Qs(e)}function $s(e){return co(e)}Qs.className="Sequential",i.Pe.registerClass(Qs);var eu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"getConfig",value:function(){return{}}}]),n}(i.Pe.Serializable),tu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Ci(e,t)}}]),n}(eu);tu.className="elu",i.Pe.registerClass(tu);var nu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return i.Ne(e)}}]),n}(eu);nu.className="selu",i.Pe.registerClass(nu);var ru=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return i.Je(e)}}]),n}(eu);ru.className="relu",i.Pe.registerClass(ru);var au=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return Object(i.mf)((function(){return i.te(6,i.Je(e))}))}}]),n}(eu);au.className="relu6",i.Pe.registerClass(au);var iu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return e}}]),n}(eu);iu.className="linear",i.Pe.registerClass(iu);var ou=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return i.Re(e)}}]),n}(eu);ou.className="sigmoid",i.Pe.registerClass(ou);var su=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return function(e){return Object(i.mf)((function(){var t=i.nd(.5,i.ve(.2,e));return i.Bd(t,0,1)}))}(e)}}]),n}(eu);su.className="hardSigmoid",i.Pe.registerClass(su);var uu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return i.Ze(e)}}]),n}(eu);uu.className="softplus",i.Pe.registerClass(uu);var cu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return function(e){return Object(i.mf)((function(){return i.Qd(e,i.md(e).add(1))}))}(e)}}]),n}(eu);cu.className="softsign",i.Pe.registerClass(cu);var lu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return i.hf(e)}}]),n}(eu);lu.className="tanh",i.Pe.registerClass(lu);var gu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return i.Ye(e,t)}}]),n}(eu);gu.className="softmax",i.Pe.registerClass(gu);var du=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return i.le(e,t)}}]),n}(eu);du.className="logSoftmax",i.Pe.registerClass(du);var hu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(i.mf)((function(){return i.Re(e.mul(t)).mul(e)}))}}]),n}(eu);hu.className="swish",i.Pe.registerClass(hu);var fu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e){return Object(i.mf)((function(){return i.ve(e,i.hf(i.Ze(e)))}))}}]),n}(eu);function pu(e){return e.getClassName()}function Iu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ma(e,i.Pe.SerializationMap.getMap().classNameMap,t,"activation")}function Cu(e){if(null==e){var t={className:"linear",config:{}};return Iu(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},Iu(n)}return e instanceof eu?e:Iu(e)}function mu(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}fu.className="mish",i.Pe.registerClass(fu);var bu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return n}(i.Pe.Serializable),vu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this),mu(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return Object(Jr.a)(n,[{key:"apply",value:function(e){var t=this;return Object(i.mf)((function(){var n=Object(i.yf)([1]);return t.hasL1&&(n=Object(i.nd)(n,Object(i.ff)(i.ve(t.l1,Object(i.md)(e))))),t.hasL2&&(n=Object(i.nd)(n,Object(i.ff)(i.ve(t.l2,fi(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(bu);vu.className="L1L2",i.Pe.registerClass(vu);var Au={l1l2:"L1L2"};function yu(e){return Ia(e)}function wu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ma(e,i.Pe.SerializationMap.getMap().classNameMap,t,"regularizer")}function Gu(e){return null==e?null:"string"===typeof e?wu({className:e in Au?Au[e]:e,config:{}}):e instanceof bu?e:wu(e)}var Bu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){e=Pi(e);var n=Object(i.Je)(e);return null!=this.maxValue&&(n=Object(i.Bd)(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Bu.className="ReLU",i.Pe.registerClass(Bu);var xu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=Pi(e);return Object(i.ie)(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);xu.className="LeakyReLU",i.Pe.registerClass(xu);var Su=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Xi(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=Gu(e.alphaRegularizer),r.alphaConstraint=Va(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new ia("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return Object(Jr.a)(n,[{key:"build",value:function(e){var t=(e=Ui(e)).slice(1);if(null!=this.sharedAxes){var n,r=Object(ea.a)(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(o){r.e(o)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new to({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=Pi(e),Object(i.Ee)(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:Li(this.alphaInitializer),alphaRegularizer:yu(this.alphaRegularizer),alphaConstraint:Fa(this.alphaConstraint),sharedAxes:this.sharedAxes},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Su.className="PReLU",i.Pe.registerClass(Su);var ku=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new oa("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=Pi(e);return Object(i.Sd)(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);ku.className="ELU",i.Pe.registerClass(ku);var Zu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=Pi(e);return n.mul(ni(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Zu.className="ThresholdedReLU",i.Pe.registerClass(Zu);var Ru=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new gu).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=Pi(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Ru.className="Softmax",i.Pe.registerClass(Ru);var Nu=n(41);function Ou(e,t,n){if("number"===typeof e)return ua(e,t);if(e.length!==t)throw new ia("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new ia("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function Wu(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function Fu(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+ei([n-t,0]);else{if("same"!==r)throw new ia("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function Mu(e,t){return Object(i.mf)((function(){return Ya(t),"channelsFirst"===t?i.pf(e,[0,2,3,1]):e}))}function Vu(e,t){return Object(i.mf)((function(){return Ya(t),"channelsFirst"===t?i.pf(e,[0,2,3,4,1]):e}))}function Tu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return Object(i.mf)((function(){if(null==o&&(o="channelsLast"),Ya(o),3!==e.shape.length)throw new ia("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new ia("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new ia("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===o&&(e=i.pf(e,[0,2,1])),"causal"===a)throw new oa("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var u=i.Id(e,t,r,"same"===a?"same":"valid","NWC",s);return null!=n&&(u=Ii(u,n)),u}))}function Eu(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return Object(i.mf)((function(){if(null==o&&(o="channelsLast"),Ya(o),3!==e.rank&&4!==e.rank)throw new ia("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new ia("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var c=Mu(e,o);if("causal"===a)throw new oa("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=i.ae.conv2d({x:c,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:u}),"channelsFirst"===o&&(c=i.pf(c,[0,3,1,2])),c}))}function ju(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;return Object(i.mf)((function(){if(null==o&&(o="channelsLast"),Ya(o),4!==e.rank&&5!==e.rank)throw new ia("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new ia("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var u=Vu(e,o);if("causal"===a)throw new oa("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=i.Ld(u,t,r,"same"===a?"same":"valid","NDHWC",s),null!=n&&(u=Ii(u,n)),"channelsFirst"===o&&(u=i.pf(u,[0,4,1,2,3])),u}))}var Lu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e,r){var a;if(Object(Ur.a)(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,Ga(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new oa("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=Ou(r.kernelSize,e,"kernelSize"),a.strides=Ou(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,za(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Ya(a.dataFormat),a.activation=Cu(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=Xi(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=Va(r.biasConstraint),a.biasRegularizer=Gu(r.biasRegularizer),a.activityRegularizer=Gu(r.activityRegularizer),a.dilationRate=Ou(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new ia("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new ia("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new ia("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return Object(Jr.a)(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:pu(this.activation),useBias:this.useBias,biasInitializer:Li(this.biasInitializer),biasRegularizer:yu(this.biasRegularizer),activityRegularizer:yu(this.activityRegularizer),biasConstraint:Fa(this.biasConstraint)},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(ca("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!wa(e.kernelSize,"number",1,3))throw new ia("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(oo),Xu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e,r){var a;return Object(Ur.a)(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,Ga(a.filters,"filters"),a.kernelInitializer=Xi(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=Va(r.kernelConstraint),a.kernelRegularizer=Gu(r.kernelRegularizer),a}return Object(Jr.a)(n,[{key:"build",value:function(e){e=Ui(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new ia("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:Object(Nu.a)({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var t;e=Pi(e);var r=null==n.bias?null:n.bias.read(),a=xa(n.activation.getClassName());if(null!=a&&2===n.rank)t=Eu(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=Tu(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=Eu(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new oa("convolutions greater than 3D are not implemented yet.");t=ju(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=Ui(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=Wu(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:Li(this.kernelInitializer),kernelRegularizer:yu(this.kernelRegularizer),kernelConstraint:Fa(this.kernelConstraint)},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new ia("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(Lu),Hu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return Object(Jr.a)(n,[{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!wa(e.kernelSize,"number",1,2))throw new ia("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Xu);Hu.className="Conv2D",i.Pe.registerClass(Hu);var Yu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return Object(Jr.a)(n,[{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new ia("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Xu);Yu.className="Conv3D",i.Pe.registerClass(Yu);var zu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,e)).inputSpec=[new to({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new ia("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return Object(Jr.a)(n,[{key:"build",value:function(e){if(4!==(e=Ui(e)).length)throw new ia("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new ia("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new to({ndim:4,axes:Object(Nu.a)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return i.mf((function(){var t=Pi(e);if(4!==t.shape.length)throw new ia("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,o=t.shape,s=o[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var u=o[r],c=o[a],l=n.kernelSize[0],g=n.kernelSize[1],d=n.strides[0],h=n.strides[1],f=[s,Fu(u,d,l,n.padding),Fu(c,h,g,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=i.pf(t,[0,2,3,1]));var p=i.Kd(t,n.kernel.read(),f,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(p=i.pf(p,[0,3,1,2])),null!=n.bias&&(p=Ii(p,n.bias.read(),n.dataFormat)),null!=n.activation&&(p=n.activation.apply(p)),p}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=Ui(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=Fu(a[n],s,i,this.padding),a[r]=Fu(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(Hu);zu.className="Conv2DTranspose",i.Pe.registerClass(zu);var Ku=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,e)).inputSpec=[new to({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new ia("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return Object(Jr.a)(n,[{key:"build",value:function(e){if(5!==(e=Ui(e)).length)throw new ia("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new ia("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new to({ndim:5,axes:Object(Nu.a)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return i.mf((function(){var t=Pi(e);if(5!==t.shape.length)throw new ia("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,o,s=t.shape,u=s[0];"channelsFirst"===n.dataFormat?(o=2,r=3,a=4):(o=1,r=2,a=3);var c=s[o],l=s[r],g=s[a],d=n.kernelSize[0],h=n.kernelSize[1],f=n.kernelSize[2],p=n.strides[0],I=n.strides[1],C=n.strides[2],m=[u,Fu(c,p,d,n.padding),Fu(l,I,h,n.padding),Fu(g,C,f,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=i.pf(t,[0,2,3,4,1]));var b=i.Md(t,n.kernel.read(),m,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(b=i.pf(b,[0,4,1,2,3])),null!==n.bias&&(b=Ii(b,n.bias.read(),n.dataFormat)),null!==n.activation&&(b=n.activation.apply(b)),b}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=Ui(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],g=this.strides[2];return i[t]=this.filters,i[n]=Fu(i[n],c,o,this.padding),i[r]=Fu(i[r],l,s,this.padding),i[a]=Fu(i[a],g,u,this.padding),i}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(Yu);Ku.className="Conv3DTranspose",i.Pe.registerClass(Ku);var _u=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e,r){var a;if(Object(Ur.a)(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new ia("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new ia("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new ia("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=Xi(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Gu(r.depthwiseRegularizer),a.depthwiseConstraint=Va(r.depthwiseConstraint),a.pointwiseInitializer=Xi(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Gu(r.pointwiseRegularizer),a.pointwiseConstraint=Va(r.pointwiseConstraint),a}return Object(Jr.a)(n,[{key:"build",value:function(e){if((e=Ui(e)).length<this.rank+2)throw new ia("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new ia("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new to({ndim:this.rank+2,axes:Object(Nu.a)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var t;if(e=Pi(e),1===n.rank)throw new oa("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=i.pf(e,[0,2,3,1])),t=i.Oe(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=Ii(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=i.pf(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Li(this.depthwiseInitializer),e.pointwiseInitializer=Li(this.pointwiseInitializer),e.depthwiseRegularizer=yu(this.depthwiseRegularizer),e.pointwiseRegularizer=yu(this.pointwiseRegularizer),e.depthwiseConstraint=Fa(this.depthwiseConstraint),e.pointwiseConstraint=Fa(this.pointwiseConstraint),e}}]),n}(Xu);_u.className="SeparableConv";var Du=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,2,e)}return n}(_u);Du.className="SeparableConv2D",i.Pe.registerClass(Du);var Pu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return Object(Jr.a)(n,[{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!wa(e.kernelSize,"number",1,1))throw new ia("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(Xu);Pu.className="Conv1D",i.Pe.registerClass(Pu);var Uu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){if(e=Pi(e),"channelsLast"===n.dataFormat){var t=si(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return si(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=si(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return si(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Uu.className="Cropping2D",i.Pe.registerClass(Uu);var Ju=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r,a;return Object(Ur.a)(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ya(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,ya(Ea,"InterpolationFormat",a),r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return i.mf((function(){var t=Pi(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=i.pf(t,[0,2,3,1]);var a=n.size[0]*r[2],o=n.size[1]*r[3],s="nearest"===n.interpolation?t.resizeNearestNeighbor([a,o]):t.resizeBilinear([a,o]);return i.pf(s,[0,3,1,2])}var u=n.size[0]*r[1],c=n.size[1]*r[2];return"nearest"===n.interpolation?t.resizeNearestNeighbor([u,c]):t.resizeBilinear([u,c])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Ju.className="UpSampling2D",i.Pe.registerClass(Ju);var Qu=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=Xi(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=Va(e.depthwiseConstraint),r.depthwiseRegularizer=Gu(e.depthwiseRegularizer),r}return Object(Jr.a)(n,[{key:"build",value:function(e){if((e=Ui(e)).length<4)throw new ia("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new ia("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return Object(i.mf)((function(){null==a&&(a="channelsLast"),Ya(a);var s=Mu(e,a);if(4!==e.rank)throw new ia("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new ia("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return s=i.Nd(s,t,n,"same"===r?"same":"valid","NHWC",o),"channelsFirst"===a&&(s=i.pf(s,[0,3,1,2])),s}))}(e=Pi(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=Ii(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=Ui(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Wu(t,this.kernelSize[0],this.padding,this.strides[0]),i=Wu(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Li(this.depthwiseInitializer),e.depthwiseRegularizer=yu(this.depthwiseRegularizer),e.depthwiseConstraint=Fa(this.depthwiseRegularizer),e}}]),n}(Lu);function qu(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new ia("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function $u(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return i.mf((function(){var c=t.shape.length;if(c<3)throw new ia("Input should be at least 3D, but is ".concat(c,"D."));var l=[1,0].concat(ti(2,c));if(t=i.pf(t,l),null!=o)throw new oa("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===c-1&&(a=i.Wd(a,-1)),a=i.pf(a,l)),r&&(t=i.Le(t,0),null!=a&&(a=i.Le(a,0)));var g,d,h=[],f=n,p=t.shape[0],I=i.rf(t);null!=a&&(d=i.rf(a));for(var C,m=function(t){var n=I[t],r=i.mf((function(){return e(n,f)}));if(null==a)g=r[0],f=r[1];else{var o=i.mf((function(){var e=d[t],n=i.Be(e).sub(e);return{output:r[0].mul(e).add(f[0].mul(n)),newStates:f.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));g=o.output,f=o.newStates}u&&h.push(g)},b=0;b<p;++b)m(b);if(u){C=i.df(h,1)}return[g,C,f]}))}Qu.className="DepthwiseConv2D",i.Pe.registerClass(Qu);var ec=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r,a;if(Object(Ur.a)(this,n),r=t.call(this,e),null==e.cell)throw new ia("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new uc({cells:e.cell}):e.cell).stateSize)throw new ia("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new to({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return Object(Jr.a)(n,[{key:"getStates",value:function(){return null==this.states_?ti(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){_i(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=Object(ea.a)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(u){o.e(u)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return i.mf((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new oa("Constants support is not implemented in RNN yet.");_i(e)&&(e=e[0]),e=e;var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new to({shape:[t,null].concat(Object(Yn.a)(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!i.tf.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new ia("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new to({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(i.mf)((function(){if(!t.stateful)throw new ra("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new ia("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return i.yf([r,e])})):t.states_=[i.yf([r,t.cell.stateSize])];else if(null==e)i.Pd(t.states_),null!=t.keptStates&&(i.Pd(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return i.yf([r,e])})):t.states_[0]=i.yf([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new ia("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):i.Pd(t.states_);for(var a=0;a<t.states_.length;++a){var o=e[a],s=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,u=[r,s];if(!i.tf.arraysEqual(o.shape,u))throw new ia("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(o.shape));t.states_[a]=o}}t.states_=t.states_.map((function(e){return i.ge(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=qu(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=Object(ea.a)(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new to({shape:l.shape}))}}catch(p){c.e(p)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof no){var g=[e].concat(o),d=this.inputSpec.concat(s),h=this.inputSpec;this.inputSpec=d;var f=Object(xo.a)(Object(So.a)(n.prototype),"apply",this).call(this,g,t);return this.inputSpec=h,f}return Object(xo.a)(Object(So.a)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=Pi(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new ia("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=$u((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],g=u[2];n.stateful&&n.resetStates(g,a);var d=n.returnSequences?l:c;return n.returnState?[d].concat(g):d}))}},{key:"getInitialState",value:function(e){var t=this;return Object(i.mf)((function(){var n=i.yf(e.shape);return n=ri(n=i.ff(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?li(n,[1,e]):n})):t.cell.stateSize>1?[li(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){Object(xo.a)(Object(So.a)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign({},r,e,t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=ko(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(oo);ec.className="RNN",i.Pe.registerClass(ec);var tc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return n}(oo),nc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Ga(r.units,"units"),r.activation=Cu(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Xi(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Xi(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Xi(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Gu(e.kernelRegularizer),r.recurrentRegularizer=Gu(e.recurrentRegularizer),r.biasRegularizer=Gu(e.biasRegularizer),r.kernelConstraint=Va(e.kernelConstraint),r.recurrentConstraint=Va(e.recurrentConstraint),r.biasConstraint=Va(e.biasConstraint),r.dropout=$a([1,ei([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=$a([1,ei([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Object(Jr.a)(n,[{key:"build",value:function(e){e=Ui(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){if(2!==(e=e).length)throw new ia("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,o=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=cc({ones:function(){return i.Be(e)},rate:n.dropout,training:o})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=cc({ones:function(){return i.Be(r)},rate:n.recurrentDropout,training:o}));var s=n.dropoutMask,u=n.recurrentDropoutMask;a=di(null!=s?i.ve(e,s):e,n.kernel.read()),null!=n.bias&&(a=Ii(a,n.bias.read())),null!=u&&(r=i.ve(r,u));var c=i.nd(a,di(r,n.recurrentKernel.read()));return null!=n.activation&&(c=n.activation.apply(c)),[c,c]}))}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:pu(this.activation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),recurrentInitializer:Li(this.recurrentInitializer),biasInitializer:Li(this.biasInitializer),kernelRegularizer:yu(this.kernelRegularizer),recurrentRegularizer:yu(this.recurrentRegularizer),biasRegularizer:yu(this.biasRegularizer),activityRegularizer:yu(this.activityRegularizer),kernelConstraint:Fa(this.kernelConstraint),recurrentConstraint:Fa(this.recurrentConstraint),biasConstraint:Fa(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}]),n}(tc);nc.className="SimpleRNNCell",i.Pe.registerClass(nc);var rc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),e.cell=new nc(e),t.call(this,e)}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var r=this;return Object(i.mf)((function(){null!=r.cell.dropoutMask&&(i.Pd(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(i.Pd(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,o=null==t?null:t.training,s=null==t?null:t.initialState;return Object(xo.a)(Object(So.a)(n.prototype),"call",r).call(r,e,{mask:a,training:o,initialState:s})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(ec);rc.className="SimpleRNN",i.Pe.registerClass(rc);var ac=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new ia("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,Ga(r.units,"units"),r.activation=Cu(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Cu(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Xi(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Xi(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Xi(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Gu(e.kernelRegularizer),r.recurrentRegularizer=Gu(e.recurrentRegularizer),r.biasRegularizer=Gu(e.biasRegularizer),r.kernelConstraint=Va(e.kernelConstraint),r.recurrentConstraint=Va(e.recurrentConstraint),r.biasConstraint=Va(e.biasConstraint),r.dropout=$a([1,ei([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=$a([1,ei([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Object(Jr.a)(n,[{key:"build",value:function(e){var t=(e=Ui(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){if(2!==(e=e).length)throw new ia("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=cc({ones:function(){return i.Be(e)},rate:n.dropout,training:r,count:3})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=cc({ones:function(){return i.Be(a)},rate:n.recurrentDropout,training:r,count:3}));var s,u,c,l=n.dropoutMask,g=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=i.ve(e,l[0]));var d=di(e,n.kernel.read());n.useBias&&(d=Ii(d,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=i.ve(a,g[0]));var h=n.recurrentKernel.read(),f=i.af(h,[2*n.units,n.units],h.rank-1),p=Object(o.a)(f,2),I=p[0],C=p[1],m=di(a,I),b=i.af(d,3,d.rank-1),v=Object(o.a)(b,3),A=v[0],y=v[1],w=v[2],G=i.af(m,2,m.rank-1),B=Object(o.a)(G,2),x=B[0],S=B[1];s=n.recurrentActivation.apply(i.nd(A,x)),u=n.recurrentActivation.apply(i.nd(y,S));var k=di(i.ve(u,a),C);c=n.activation.apply(i.nd(w,k));var Z=i.nd(i.ve(s,a),i.ve(i.nd(1,i.we(s)),c));return[Z,Z]}))}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:pu(this.activation),recurrentActivation:pu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),recurrentInitializer:Li(this.recurrentInitializer),biasInitializer:Li(this.biasInitializer),kernelRegularizer:yu(this.kernelRegularizer),recurrentRegularizer:yu(this.recurrentRegularizer),biasRegularizer:yu(this.biasRegularizer),activityRegularizer:yu(this.activityRegularizer),kernelConstraint:Fa(this.kernelConstraint),recurrentConstraint:Fa(this.recurrentConstraint),biasConstraint:Fa(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}]),n}(tc);ac.className="GRUCell",i.Pe.registerClass(ac);var ic=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ac(e),t.call(this,e)}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var r=this;return Object(i.mf)((function(){null!=r.cell.dropoutMask&&(i.Pd(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(i.Pd(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,o=null==t?null:t.training,s=null==t?null:t.initialState;return Object(xo.a)(Object(So.a)(n.prototype),"call",r).call(r,e,{mask:a,training:o,initialState:s})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(ec);ic.className="GRU",i.Pe.registerClass(ic);var oc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Ga(r.units,"units"),r.activation=Cu(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Cu(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Xi(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Xi(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Xi(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=Gu(e.kernelRegularizer),r.recurrentRegularizer=Gu(e.recurrentRegularizer),r.biasRegularizer=Gu(e.biasRegularizer),r.kernelConstraint=Va(e.kernelConstraint),r.recurrentConstraint=Va(e.recurrentConstraint),r.biasConstraint=Va(e.biasConstraint),r.dropout=$a([1,ei([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=$a([1,ei([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return Object(Jr.a)(n,[{key:"build",value:function(e){var t,n,r=(e=Ui(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new((t=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new Gi).apply([i]),o=a.apply([2*i]);return ci(ci(n,r),o)}}]),n}(yi)).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var r=null!=t.training&&t.training;if(3!==(e=e).length)throw new ia("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],s=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=cc({ones:function(){return i.Be(e)},rate:n.dropout,training:r,count:4})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=cc({ones:function(){return i.Be(a)},rate:n.recurrentDropout,training:r,count:4}));var u,c,l,g,d=n.dropoutMask,h=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=i.ve(e,d[0]));var f=di(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=i.ve(a,h[0])),f=i.nd(f,di(a,n.recurrentKernel.read())),n.useBias&&(f=Ii(f,n.bias.read()));var p=i.af(f,4,f.rank-1),I=Object(o.a)(p,4),C=I[0],m=I[1],b=I[2],v=I[3];u=n.recurrentActivation.apply(C),c=n.recurrentActivation.apply(m),l=i.nd(i.ve(c,s),i.ve(u,n.activation.apply(b))),g=n.recurrentActivation.apply(v);var A=i.ve(g,n.activation.apply(l));return[A,A,l]}))}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:pu(this.activation),recurrentActivation:pu(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),recurrentInitializer:Li(this.recurrentInitializer),biasInitializer:Li(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:yu(this.kernelRegularizer),recurrentRegularizer:yu(this.recurrentRegularizer),biasRegularizer:yu(this.biasRegularizer),activityRegularizer:yu(this.activityRegularizer),kernelConstraint:Fa(this.kernelConstraint),recurrentConstraint:Fa(this.recurrentConstraint),biasConstraint:Fa(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}]),n}(tc);oc.className="LSTMCell",i.Pe.registerClass(oc);var sc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new oc(e),t.call(this,e)}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var r=this;return Object(i.mf)((function(){null!=r.cell.dropoutMask&&(i.Pd(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(i.Pd(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,o=null==t?null:t.training,s=null==t?null:t.initialState;return Object(xo.a)(Object(So.a)(n.prototype),"call",r).call(r,e,{mask:a,training:o,initialState:s})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(ec);sc.className="LSTM",i.Pe.registerClass(sc);var uc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).cells=e.cells,r}return Object(Jr.a)(n,[{key:"stateSize",get:function(){var e,t=[],n=Object(ea.a)(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,Object(Yn.a)(r.stateSize)):t.push(r.stateSize)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var r,a=(e=e).slice(1),i=[],o=Object(ea.a)(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(I){o.e(I)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var g=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=g.call(u,t),c.push(u.slice(1))}a=[];var d,h=Object(ea.a)(c.slice().reverse());try{for(h.s();!(d=h.n()).done;){var f,p=d.value;(f=a).push.apply(f,Object(Yn.a)(p))}}catch(I){h.e(I)}finally{h.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;_i(e)&&(e=e[0]),e=e,this.cells.forEach((function(n,r){Da("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign({},e,t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=Object(ea.a)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Yn.a)(r.trainableWeights))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=Object(ea.a)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Yn.a)(r.nonTrainableWeights))}}catch(u){n.e(u)}finally{n.f()}if(!this.trainable){var a,i=[],o=Object(ea.a)(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,Object(Yn.a)(s.trainableWeights))}}catch(u){o.e(u)}finally{o.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=Object(ea.a)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,Object(Yn.a)(r.weights))}}catch(a){n.e(a)}finally{n.f()}return $i(t)}},{key:"setWeights",value:function(e){var t,n=[],r=Object(ea.a)(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),s=0;s<a.weights.length;++s)n.push([a.weights[s],o[s]])}catch(u){r.e(u)}finally{r.f()}eo(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=Object(ea.a)(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(ko(o,r))}}catch(s){i.e(s)}finally{i.f()}return new e({cells:a})}}]),n}(tc);function cc(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,o=e.count,s=void 0===o?1:o,u=function(){return mi(t(),n)},c=function(){return bi(u,t,a)};return!s||s<=1?i.ge(c().clone()):Array(s).fill(void 0).map(c).map((function(e){return i.ge(e.clone())}))}uc.className="StackedRNNCells",i.Pe.registerClass(uc);var lc=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},gc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),e.unroll)throw new oa("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new oa("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new to({ndim:5})],r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var r=this;return i.mf((function(){if(null!=r.cell.dropoutMask&&(i.Pd(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(i.Pd(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new ia("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,o=null==t?null:t.training,s=null==t?null:t.initialState;return Object(xo.a)(Object(So.a)(n.prototype),"call",r).call(r,e,{mask:a,training:o,initialState:s})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(Object(Yn.a)(t.slice(2)))),this.returnState&&(t=[t].concat(Object(Yn.a)(Array(2).fill([e[0]].concat(Object(Yn.a)(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return i.mf((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),o=[a[0]].concat(Object(Yn.a)(a.slice(2))),s=i.yf(o);return Array.isArray(n)?Array(n.length).fill(s):[s]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.mf((function(){if(!t.stateful)throw new ra("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),o=[a[0]].concat(Object(Yn.a)(a.slice(2)));if(null==r[0])throw new ia("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return i.yf(o)})):t.states_=[i.yf(o)];else if(null==e)i.Pd(t.states_),null!=t.keptStates&&(i.Pd(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return i.yf(o)})):t.states_[0]=i.yf(o);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new ia("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):i.Pd(t.states_);for(var s=0;s<t.states_.length;++s){var u=e[s],c=o;if(!i.tf.arraysEqual(u.shape,c))throw new ia("State ".concat(s," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(c,", received shape=").concat(u.shape));t.states_[s]=u}}t.states_=t.states_.map((function(e){return i.ge(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,s=t.dilationRate,u="channelsFirst"===n,c=e[u?3:2],l=e[u?4:3],g=Wu(c,a[0],i,o[0],s[0]),d=Wu(l,a[1],i,o[1],s[1]);return[].concat(Object(Yn.a)(e.slice(0,2)),Object(Yn.a)(u?[r,g,d]:[g,d,r]))}}]),n}(ec);gc.className="ConvRNN2D";var dc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;Object(Ur.a)(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,u=e.dataFormat,c=e.dilationRate;return(r=t.call(this,Object.assign({},e,{units:a}))).filters=a,Ga(r.filters,"filters"),r.kernelSize=Ou(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return Ga(e,"kernelSize")})),r.strides=Ou(o||1,2,"strides"),r.strides.forEach((function(e){return Ga(e,"strides")})),r.padding=s||"valid",za(r.padding),r.dataFormat=u||"channelsLast",Ya(r.dataFormat),r.dilationRate=Ou(c||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return Ga(e,"dilationRate")})),r}return Object(Jr.a)(n,[{key:"build",value:function(e){var t;e=Ui(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new ia("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var o=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var s;if(this.unitForgetBias){var u=this.biasInitializer,c=this.filters;s=new((t=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"apply",value:function(e,t){return ui([u.apply([c]),i.Ae([c]),u.apply([2*c])])}}]),n}(yi)).className="CustomInit",t)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,s,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return i.mf((function(){if(3!==e.length)throw new ia("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],s=e[1],u=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=cc({ones:function(){return i.Be(a)},rate:n.dropout,training:r,count:4}));var c=n.dropoutMask,l=function(e,t,n){return t&&t[n]?i.ve(t[n],e):e},g=l(a,c,0),d=l(a,c,1),h=l(a,c,2),f=l(a,c,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=cc({ones:function(){return i.Be(s)},rate:n.recurrentDropout,training:r,count:4}));var p=n.recurrentDropoutMask,I=l(s,p,0),C=l(s,p,1),m=l(s,p,2),b=l(s,p,3),v=i.af(n.kernel.read(),4,3),A=Object(o.a)(v,4),y=A[0],w=A[1],G=A[2],B=A[3],x=n.useBias?i.af(n.bias.read(),4):[null,null,null,null],S=Object(o.a)(x,4),k=S[0],Z=S[1],R=S[2],N=S[3];g=n.inputConv(g,y,k,n.padding),d=n.inputConv(d,w,Z,n.padding),h=n.inputConv(h,G,R,n.padding),f=n.inputConv(f,B,N,n.padding);var O=i.af(n.recurrentKernel.read(),4,3),W=Object(o.a)(O,4),F=W[0],M=W[1],V=W[2],T=W[3];I=n.recurrentConv(I,F),C=n.recurrentConv(C,M),m=n.recurrentConv(m,V),b=n.recurrentConv(b,T);var E=n.recurrentActivation.apply(i.nd(g,I)),j=n.recurrentActivation.apply(i.nd(d,C)),L=i.nd(i.ve(j,u),i.ve(E,n.activation.apply(i.nd(h,m)))),X=i.ve(n.recurrentActivation.apply(i.nd(f,b)),n.activation.apply(L));return[X,X,L]}))}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t=(e.units,lc(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},t,r)}},{key:"inputConv",value:function(e,t,n,r){var a=i.Jd(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Ii(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return i.Jd(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(oc);dc.className="ConvLSTM2DCell",i.Pe.registerClass(dc);var hc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){Object(Ur.a)(this,n);var r=new dc(e);return t.call(this,Object.assign({},e,{cell:r}))}return Object(Jr.a)(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(gc);hc.className="ConvLSTM2D",i.Pe.registerClass(hc);var fc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return Object(Jr.a)(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return bi((function(){return mi(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return Object(xo.a)(Object(So.a)(n.prototype),"dispose",this).call(this)}}]),n}(oo);fc.className="Dropout",i.Pe.registerClass(fc);var pc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return Object(Jr.a)(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(fc);pc.className="SpatialDropout1D",i.Pe.registerClass(pc);var Ic=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,Ga(r.units,"units"),r.activation=Cu(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=Xi(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Xi(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=Va(e.kernelConstraint),r.biasConstraint=Va(e.biasConstraint),r.kernelRegularizer=Gu(e.kernelRegularizer),r.biasRegularizer=Gu(e.biasRegularizer),r.activityRegularizer=Gu(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return Object(Jr.a)(n,[{key:"build",value:function(e){var t=(e=Ui(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:Object(Nu.a)({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=Ui(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r,a=Pi(e),i=xa(n.activation.getClassName());return null!=i?r=di(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=di(a,n.kernel.read()),null!=n.bias&&(r=Ii(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:pu(this.activation),useBias:this.useBias,kernelInitializer:Li(this.kernelInitializer),biasInitializer:Li(this.biasInitializer),kernelRegularizer:yu(this.kernelRegularizer),biasRegularizer:yu(this.biasRegularizer),activityRegularizer:yu(this.activityRegularizer),kernelConstraint:Fa(this.kernelConstraint),biasConstraint:Fa(this.biasConstraint)},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Ic.className="Dense",i.Pe.registerClass(Ic);var Cc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){e=Ui(e);var t,n=Object(ea.a)(e.slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new ia('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(r){n.e(r)}finally{n.f()}return[e[0],qa(e,1)]}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new ia("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],qa(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Cc.className="Flatten",i.Pe.registerClass(Cc);var mc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=Cu(e.activation),r}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:pu(this.activation)},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);mc.className="Activation",i.Pe.registerClass(mc);var bc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){return e=Pi(e),t=e,r=n.n,Object(i.mf)((function(){if(2!==t.shape.length)throw new ia("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return li(ri(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);bc.className="RepeatVector",i.Pe.registerClass(bc);var vc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;Object(Ur.a)(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return Object(Jr.a)(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new ia("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=qa(e);if(null!==i){if(0===a||u%a!==0)throw new ia(n);r[i]=u/a}else if(u!==a)throw new ia(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);vc.className="Reshape",i.Pe.registerClass(vc);var Ac=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=ti(1,e.dims.length+1);if(!i.tf.arraysEqual(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new to({ndim:r.dims.length+1})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){var t=(e=Ui(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return Object(i.pf)(Pi(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Ac.className="Permute",i.Pe.registerClass(Ac);var yc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=Pi(e);return Object(i.pd)(Object(i.ye)(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e),a=Object(i.pd)(Object(i.ye)(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))}}]),n}(oo);yc.className="Masking",i.Pe.registerClass(yc);var wc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(da(e.inputLength))}return r.inputDim=e.inputDim,Ga(r.inputDim,"inputDim"),r.outputDim=e.outputDim,Ga(r.outputDim,"outputDim"),r.embeddingsInitializer=Xi(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=Gu(e.embeddingsRegularizer),r.activityRegularizer=Gu(e.activityRegularizer),r.embeddingsConstraint=Va(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return Object(Jr.a)(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return Object(i.mf)((function(){return n.maskZero?(e=Pi(e),Object(i.ye)(e,Object(i.zf)(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=Ui(e),null==this.inputLength)return[].concat(Object(Yn.a)(e),[this.outputDim]);var t=da(this.inputLength);if(t.length!==e.length-1)throw new ia('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new ia('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(Object(Yn.a)(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e);return"int32"!==r.dtype&&(r=ni(r,"int32")),hi(n.embeddings.read(),r.as1D()).reshape(Ui(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Li(this.embeddingsInitializer),embeddingsRegularizer:yu(this.embeddingsRegularizer),activityRegularizer:yu(this.activityRegularizer),embeddingsConstraint:Fa(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);wc.className="Embedding",i.Pe.registerClass(wc);var Gc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return Object(Jr.a)(n,[{key:"mergeFunction",value:function(e){throw new oa}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new ia("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ui(e)]),(e=e).length<2)throw new ia("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=Object(ea.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(c){r.e(c)}finally{r.f()}if((n=va(n)).length>1)throw new ia("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===va(u).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){if(e=e,n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,o=ei(r),s=Object(ea.a)(e);try{for(s.s();!(a=s.n()).done;){for(var u=a.value,c=u.rank,l=0;l<o-c;++l)u=ri(u,1);t.push(u)}}catch(S){s.e(S)}finally{s.f()}return n.mergeFunction(t)}var g,d=!1,h=Object(ea.a)(e);try{for(h.s();!(g=h.n()).done;){var f=g.value,p=f.rank;if(null==p){var I=f.shape,C=I[0],m=I.slice(1).concat([C]),b=f.reshape([C].concat(qa(I.slice(1))));b=(b=i.pf(b,[1,0])).reshape(m),t.push(b),d=!0}else if(p>1){var v=ti(1,p).concat([0]);t.push(i.pf(f,v)),d=!0}else t.push(f)}}catch(S){h.e(S)}finally{h.f()}var A=n.mergeFunction(t),y=A.rank;if(d)if(null==y){var w=A.shape,G=w[w.length-1],B=[G].concat(w.slice(0,w.length-1));A=i.pf(A.reshape([-1,G]),[1,0]).reshape(B)}else if(y>1){var x=[y-1].concat(ti(0,y-1));A=i.pf(A,x)}return A}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=Object(ea.a)(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(u){o.e(u)}finally{o.f()}return t=1===(i=va(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return i.mf((function(){if(null==t)return null;if(!Array.isArray(t))throw new ia("`mask` should be an Array");if(!Array.isArray(e))throw new ia("`inputs` should be an Array");if(t.length!==e.length)throw new ia("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:i.Wd(e,0)})))[0],r=1;r<t.length-1;++r)n=i.me(n,t[r]);return n}))}}]),n}(oo),Bc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"mergeFunction",value:function(e){return Object(i.mf)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=i.nd(t,e[n]);return t}))}}]),n}(Gc);Bc.className="Add",i.Pe.registerClass(Bc);var xc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"mergeFunction",value:function(e){return Object(i.mf)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=i.ve(t,e[n]);return t}))}}]),n}(Gc);xc.className="Multiply",i.Pe.registerClass(xc);var Sc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"mergeFunction",value:function(e){return Object(i.mf)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=i.nd(t,e[n]);return i.ve(1/e.length,t)}))}}]),n}(Gc);Sc.className="Average",i.Pe.registerClass(Sc);var kc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"mergeFunction",value:function(e){return Object(i.mf)((function(){for(var t=e[0],n=1;n<e.length;++n)t=i.qe(t,e[n]);return t}))}}]),n}(Gc);kc.className="Maximum",i.Pe.registerClass(kc);var Zc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"mergeFunction",value:function(e){return Object(i.mf)((function(){for(var t=e[0],n=1;n<e.length;++n)t=i.te(t,e[n]);return t}))}}]),n}(Gc);Zc.className="Minimum",i.Pe.registerClass(Zc);var Rc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Object(Jr.a)(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new ia("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;var t,n=!0,r=Object(ea.a)(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(d){r.e(d)}finally{r.f()}if(!n){for(var a=[],o=0;o<e.length;++o){var s=e[o].slice();s.splice(this.axis,1);var u,c=!1,l=Object(ea.a)(a);try{for(l.s();!(u=l.n()).done;){var g=u.value;if(i.tf.arraysEqual(g,s)){c=!0;break}}}catch(d){l.e(d)}finally{l.f()}c||a.push(s)}if(a.length>1)throw new ia("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return Object(i.mf)((function(){return ui(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new ia("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=Object(ea.a)(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new ia("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ia("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new ia("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return i.mf((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],o=0;o<e.length;++o)null==t[o]?a.push(i.Be(e[o]).asType("bool")):t[o].rank<e[o].rank?a.push(i.Wd(t[o],-1)):a.push(t[o]);var s=i.Dd(a,n.axis);return i.od(s,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Gc);function Nc(e,t){for(;e<0;)e+=t;return e}Rc.className="Concatenate",i.Pe.registerClass(Rc);var Oc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return Object(Jr.a)(n,[{key:"build",value:function(e){i.tf.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new oa("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new ia("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new ia("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return Nc(t,e[n].shape.length)})):[Nc(this.axes,n.shape.length),Nc(this.axes,r.shape.length)],this.normalize&&(n=Zo(n,t[0]),r=Zo(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new oa("batchDot is not implemented for tensors of 4D or higher rank yet");if(i.tf.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),i.tf.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new oa("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var o=n;return i.mf((function(){var n,i;if(r>a){n=r-a;for(var s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=e.reshape(e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)i=o[0]===o[1]?e.mul(t).sum(o[0]):e.transpose([1,0]).mul(t).sum(o[1]);else{var g=o[0]!==e.shape.length-1,d=o[1]===t.shape.length-1;i=e.matMul(t,g,d)}if(n>0){for(var h,f=[],p=h=r>a?r+a-3:r-1;p<h+n;++p)f.push(p);i=i.squeeze(f)}return 1===i.shape.length&&(i=i.expandDims(1)),i}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[Nc(this.axes,e.length),Nc(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){i.tf.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new oa("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(Gc);Oc.className="Dot",i.Pe.registerClass(Oc);var Wc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e);return bi((function(){return gi(r.shape,0,n.stddev).add(r)}),(function(){return r}),t.training||!1)}))}}]),n}(oo);Wc.className="GaussianNoise",i.Pe.registerClass(Wc);var Fc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t);var r=Pi(e);if(n.rate>0&&n.rate<1){return bi((function(){var e=Math.sqrt(n.rate/(1-n.rate));return r.mul(gi(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(oo);Fc.className="GaussianDropout",i.Pe.registerClass(Fc);var Mc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return Object(Jr.a)(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||Pi(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return bi((function(){var t=Pi(e),a=-1.7580993408473766,o=Object(i.de)(Object(i.Ge)(r),n.rate);o=ni(o,"float32");var s=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),u=-s*a*n.rate;return t.mul(o).add(o.add(-1).mul(a)).mul(s).add(u)}),(function(){return Pi(e)}),t.training||!1)}return e}))}}]),n}(oo);function Vc(e,t,n,r,a){var o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)o=i.vd(e,t,n,r,a,s);else if(3===e.rank)o=i.wd(e,t,n,r,a,s);else{if(4!==e.rank)throw new oa("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");o=i.xd(e,t,n,r,a,s)}return o}function Tc(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Object(i.mf)((function(){var o=i.ue(e,r),s=o.mean,u=o.variance;return[Vc(e,s,u,n,t,a),s,u]}))}function Ec(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Object(i.mf)((function(){var o,s=i.ue(e,r),u=s.mean,c=s.variance,l=[],g=Object(ea.a)(ti(0,e.rank));try{for(g.s();!(o=g.n()).done;){var d=o.value;-1!==r.indexOf(d)?l.push(1):l.push(e.shape[d])}}catch(C){g.e(C)}finally{g.f()}var h=u.reshape(l),f=c.reshape(l),p=null==t?null:t.reshape(l),I=null==n?null:n.reshape(l);return[Vc(e,h,f,I,p,a),u,c]}))}Mc.className="AlphaDropout",i.Pe.registerClass(Mc);var jc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Xi(e.betaInitializer||"zeros"),r.gammaInitializer=Xi(e.gammaInitializer||"ones"),r.movingMeanInitializer=Xi(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Xi(e.movingVarianceInitializer||"ones"),r.betaConstraint=Va(e.betaConstraint),r.gammaConstraint=Va(e.gammaConstraint),r.betaRegularizer=Gu(e.betaRegularizer),r.gammaRegularizer=Gu(e.gammaRegularizer),r}return Object(Jr.a)(n,[{key:"build",value:function(e){e=Ui(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new ia("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new to({ndim:e.length,axes:Object(Nu.a)({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var r=null!=t.training&&t.training,a=Pi(e),s=a.shape,u=s.length,c=ti(0,u),l=n.axis>=0?n.axis:n.axis+u;c.splice(l,1);var g=ua(1,u);g[l]=s[l];var d=c.slice();d.sort();var h=!i.tf.arraysEqual(d,ti(0,u).slice(0,u-1));if(!r)return function(){if(h){var e=n.movingMean.read().reshape(g),t=n.movingVariance.read().reshape(g),r=n.center?n.beta.read().reshape(g):null,i=n.scale?n.gamma.read().reshape(g):null;return Vc(a,e,t,r,i,n.epsilon)}return Vc(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var f=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return i.tf.arraysEqual(r.slice().sort(),ti(0,e.rank-1))?Tc(e,t,n,r,a):Ec(e,t,n,r,a)}(a,n.gamma.read(),n.beta.read(),c,n.epsilon),p=Object(o.a)(f,3),I=p[0],C=p[1],m=p[2],b=function(e,t,n){i.mf((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return b(n.movingMean,C,n.momentum),b(n.movingVariance,m,n.momentum),I}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Li(this.betaInitializer),gammaInitializer:Li(this.gammaInitializer),movingMeanInitializer:Li(this.movingMeanInitializer),movingVarianceInitializer:Li(this.movingVarianceInitializer),betaRegularizer:yu(this.betaRegularizer),gammaRegularizer:yu(this.gammaRegularizer),betaConstraint:Fa(this.betaConstraint),gammaConstraint:Fa(this.gammaConstraint)},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);jc.className="BatchNormalization",i.Pe.registerClass(jc);var Lc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=Object(ea.a)(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(s){i.e(s)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Xi(e.betaInitializer||"zeros"),r.gammaInitializer=Xi(e.gammaInitializer||"ones"),r.betaRegularizer=Gu(e.betaRegularizer),r.gammaRegularizer=Gu(e.gammaRegularizer),r.supportsMasking=!0,r}return Object(Jr.a)(n,[{key:"build",value:function(e){var t=(e=Ui(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=Object(ea.a)(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(s){a.e(s)}finally{a.f()}if(this.axis.length!==va(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=Pi(e),a=r.shape,o=a.length;return Object(i.mf)((function(){var e,t=Object(i.ue)(r,n.axis,!0),s=t.mean,u=t.variance,c=ua(1,o),l=Object(ea.a)(n.axis);try{for(l.s();!(e=l.n()).done;){var g=e.value;c[g]=a[g]}}catch(m){l.e(m)}finally{l.f()}for(var d=function(e){return null!=e&&e.shape.length!==o&&n.axis!==[o-1]?e.reshape(c):e},h=d(n.gamma.read()),f=d(n.beta.read()),p=[],I=[],C=0;C<o;++C)-1!==n.axis.indexOf(C)?(p.push(a[C]),I.push(1)):(p.push(1),I.push(a[C]));return s=s.tile(p),u=u.tile(p),h=h.tile(I),f=f.tile(I),Vc(r,s,u,f,h,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Li(this.betaInitializer),gammaInitializer:Li(this.gammaInitializer),betaRegularizer:yu(this.betaRegularizer),gammaRegularizer:yu(this.gammaRegularizer)},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);Lc.className="LayerNormalization",i.Pe.registerClass(Lc);var Xc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new ia("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new ia("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new ia("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new to({ndim:4})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=Ui(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){return t=Pi(e),r=n.padding,a=n.dataFormat,Object(i.mf)((function(){if(4!==t.rank)throw new ia("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new ia("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new ia("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],i.Ce(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo);function Hc(e,t,n,r,a,o){return Object(i.mf)((function(){var s;Ya(a),Ka(o),za(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==o&&(o="max"),e=Mu(e,a);var u="same"===r?"same":"valid";return s="max"===o?i.oe(e,t,n,u):i.rd(e,t,n,u),"channelsFirst"===a&&(s=i.pf(s,[0,3,1,2])),s}))}function Yc(e,t,n,r,a,o){return Object(i.mf)((function(){var s;Ya(a),Ka(o),za(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==o&&(o="max"),e=Vu(e,a);var u="same"===r?"same":"valid";return s="max"===o?i.pe(e,t,n,u):i.sd(e,t,n,u),"channelsFirst"===a&&(s=i.pf(s,[0,4,1,2,3])),s}))}Xc.className="ZeroPadding2D",i.Pe.registerClass(Xc);var zc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new ia("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(Ga(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new ia("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return Ga(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,za(r.padding),r.inputSpec=[new to({ndim:3})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){var t=Wu((e=Ui(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){n.invokeCallHook(e,t),e=ri(Pi(e),2);var r=n.poolingFunction(Pi(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return i.cf(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo),Kc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ya(a),za(r),Hc(e,t,n,r,a,"max")}}]),n}(zc);Kc.className="MaxPooling1D",i.Pe.registerClass(Kc);var _c=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ya(a),za(r),Hc(e,t,n,r,a,"avg")}}]),n}(zc);_c.className="AveragePooling1D",i.Pe.registerClass(_c);var Dc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new ia("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return Ga(r.poolSize,"poolSize"),Ga(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ya(r.dataFormat),za(r.padding),r.inputSpec=[new to({ndim:4})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){e=Ui(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=Wu(t,this.poolSize[0],this.padding,this.strides[0]),n=Wu(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Pi(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo),Pc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ya(a),za(r),Hc(e,t,n,r,a,"max")}}]),n}(Dc);Pc.className="MaxPooling2D",i.Pe.registerClass(Pc);var Uc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ya(a),za(r),Hc(e,t,n,r,a,"avg")}}]),n}(Dc);Uc.className="AveragePooling2D",i.Pe.registerClass(Uc);var Jc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;if(Object(Ur.a)(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new ia("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return Ga(r.poolSize,"poolSize"),Ga(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ya(r.dataFormat),za(r.padding),r.inputSpec=[new to({ndim:5})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){e=Ui(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=Wu(t,this.poolSize[0],this.padding,this.strides[0]),n=Wu(n,this.poolSize[1],this.padding,this.strides[1]),r=Wu(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Pi(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo),Qc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ya(a),za(r),Yc(e,t,n,r,a,"max")}}]),n}(Jc);Qc.className="MaxPooling3D",i.Pe.registerClass(Qc);var qc=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e)}return Object(Jr.a)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return Ya(a),za(r),Yc(e,t,n,r,a,"avg")}}]),n}(Jc);qc.className="AveragePooling3D",i.Pe.registerClass(qc);var $c=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).inputSpec=[new to({ndim:3})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new oa}}]),n}(oo),el=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e||{})}return Object(Jr.a)(n,[{key:"call",value:function(e,t){return Object(i.mf)((function(){var t=Pi(e);return i.re(t,1)}))}}]),n}($c);el.className="GlobalAveragePooling1D",i.Pe.registerClass(el);var tl=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){return Object(Ur.a)(this,n),t.call(this,e||{})}return Object(Jr.a)(n,[{key:"call",value:function(e,t){return Object(i.mf)((function(){var t=Pi(e);return i.ne(t,1)}))}}]),n}($c);tl.className="GlobalMaxPooling1D",i.Pe.registerClass(tl);var nl=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Ya(r.dataFormat),r.inputSpec=[new to({ndim:4})],r}return Object(Jr.a)(n,[{key:"computeOutputShape",value:function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new oa}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(oo),rl=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var t=Pi(e);return"channelsLast"===n.dataFormat?i.re(t,[1,2]):i.re(t,[2,3])}))}}]),n}(nl);rl.className="GlobalAveragePooling2D",i.Pe.registerClass(rl);var al=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){return Object(Ur.a)(this,n),t.apply(this,arguments)}return Object(Jr.a)(n,[{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var t=Pi(e);return"channelsLast"===n.dataFormat?i.ne(t,[1,2]):i.ne(t,[2,3])}))}}]),n}(nl);al.className="GlobalMaxPooling2D",i.Pe.registerClass(al);var il=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).layer=e.layer,r}return Object(Jr.a)(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){Object(xo.a)(Object(So.a)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=ko(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(oo),ol=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;return Object(Ur.a)(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return Object(Jr.a)(n,[{key:"build",value:function(e){if((e=Ui(e)).length<3)throw new ia("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),Object(xo.a)(Object(So.a)(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=Ui(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){return $u((function(e,r){return[Pi(n.layer.call(e,t)),[]]}),e=Pi(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(il);ol.className="TimeDistributed",i.Pe.registerClass(ol);var sl=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r;Object(Ur.a)(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=ko(i),a.goBackwards=!0!==a.goBackwards;var o,s={};if(s.className=e.layer.getClassName(),s.config=a,r.backwardLayer=ko(s),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=r.mergeMode,ya(Xa,"BidirectionalMergeMode",o),e.weights)throw new oa("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return Object(Jr.a)(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState?(r=a.slice(1),t=a[0]):t=a[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):ga(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=qu(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return Object(xo.a)(Object(So.a)(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new ia("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,Object(Yn.a)(r));var c=r.map((function(e){return new to({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,Object(Yn.a)(c))}if(null!=a)throw new oa("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof no,g=0,d=o;g<d.length;g++){if(d[g]instanceof no!==l)throw new ia("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var h=[e].concat(o),f=this.inputSpec.concat(s),p=this.inputSpec;this.inputSpec=f;var I=Object(xo.a)(Object(So.a)(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=p,I}return Object(xo.a)(Object(So.a)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return Object(i.mf)((function(){var r,a,o,s,u=t.initialState;if(null==u)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var c=u.slice(0,u.length/2),l=u.slice(u.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:c})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:l}))}return n.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=i.Le(a,1)),"concat"===n.mergeMode?s=ui([r,a]):"sum"===n.mergeMode?s=i.nd(r,a):"ave"===n.mergeMode?s=i.ve(.5,i.nd(r,a)):"mul"===n.mergeMode?s=i.ve(r,a):null==n.mergeMode&&(s=[r,a]),n.returnState?null==n.mergeMode?s.concat(o):[s].concat(o):s}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;Da(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Da(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){Object(xo.a)(Object(So.a)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=Object(xo.a)(Object(So.a)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=ko(t.layer);if(delete t.layer,null!=t.numConstants)throw new oa("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(il);function ul(e){return new uo(e)}function cl(e){return new ku(e)}function ll(e){return new Bu(e)}function gl(e){return new xu(e)}function dl(e){return new Su(e)}function hl(e){return new Ru(e)}function fl(e){return new Zu(e)}function pl(e){return new Pu(e)}function Il(e){return new Hu(e)}function Cl(e){return new zu(e)}function ml(e){return new Yu(e)}function bl(e){return new Ku(e)}function vl(e){return new Du(e)}function Al(e){return new Uu(e)}function yl(e){return new Ju(e)}function wl(e){return new Qu(e)}function Gl(e){return new mc(e)}function Bl(e){return new Ic(e)}function xl(e){return new fc(e)}function Sl(e){return new pc(e)}function kl(e){return new Cc(e)}function Zl(e){return new bc(e)}function Rl(e){return new vc(e)}function Nl(e){return new Ac(e)}function Ol(e){return new wc(e)}function Wl(e){return new Bc(e)}function Fl(e){return new Sc(e)}function Ml(e){return new Rc(e)}function Vl(e){return new kc(e)}function Tl(e){return new Zc(e)}function El(e){return new xc(e)}function jl(e){return new Oc(e)}function Ll(e){return new jc(e)}function Xl(e){return new Lc(e)}function Hl(e){return new Xc(e)}function Yl(e){return new _c(e)}function zl(e){return Yl(e)}function Kl(e){return Yl(e)}function _l(e){return new Uc(e)}function Dl(e){return _l(e)}function Pl(e){return _l(e)}function Ul(e){return new qc(e)}function Jl(e){return Ul(e)}function Ql(e){return Ul(e)}function ql(e){return new el(e)}function $l(e){return new rl(e)}function eg(e){return new tl(e)}function tg(e){return new al(e)}function ng(e){return new Kc(e)}function rg(e){return new Pc(e)}function ag(e){return new Qc(e)}function ig(e){return new ic(e)}function og(e){return new ac(e)}function sg(e){return new sc(e)}function ug(e){return new oc(e)}function cg(e){return new rc(e)}function lg(e){return new nc(e)}function gg(e){return new hc(e)}function dg(e){return new dc(e)}function hg(e){return new ec(e)}function fg(e){return new uc(e)}function pg(e){return new sl(e)}function Ig(e){return new ol(e)}sl.className="Bidirectional",i.Pe.registerClass(sl);var Cg=eg,mg=tg,bg=ng,vg=rg;function Ag(e){return new Wc(e)}function yg(e){return new Fc(e)}function wg(e){return new Mc(e)}function Gg(e){return new yc(e)}n(92),n(4),n(150),n(299),n(93),n(171),n(152);var Bg=n(35);n(307),n(319),n(304),n(318);n(135),n(315),n(320),n(243),n(145),n(328),n(254),n(323);n(78),n(309),n(336),n(226),n(308),n(329),n(330);var xg=n(125),Sg=n(73),kg=n(111),Zg=function(){function e(){Object(Ur.a)(this,e),this.size=null}return Object(Jr.a)(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return i.tf.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),Rg(Object(fo.a)(ho.a.mark((function t(){return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,Ng));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,Rg(Object(fo.a)(ho.a.mark((function t(){return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,Rg(Object(fo.a)(ho.a.mark((function t(){return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return i.mf((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return Rg(Object(fo.a)(ho.a.mark((function n(){return ho.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return i.mf((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return Rg(Object(fo.a)(ho.a.mark((function n(){return ho.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return Rg(Object(fo.a)(ho.a.mark((function n(){return ho.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,Rg(Object(fo.a)(ho.a.mark((function t(){var r;return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(Sg.e)(Object(fo.a)(ho.a.mark((function e(){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",Object(Sg.d)(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,Rg(Object(fo.a)(ho.a.mark((function t(){return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=xg.alea(t||i.tf.now().toString());return Rg(Object(fo.a)(ho.a.mark((function t(){var i;return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,Rg(Object(fo.a)(ho.a.mark((function t(){return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=Object(fo.a)(ho.a.mark((function e(){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=Object(fo.a)(ho.a.mark((function e(){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Rg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){Object(Qr.a)(a,n);var r=Object(qr.a)(a);function a(){var e;return Object(Ur.a)(this,a),(e=r.apply(this,arguments)).size=t,e}return Object(Jr.a)(a,[{key:"iterator",value:function(){var t=Object(fo.a)(ho.a.mark((function t(){return ho.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(Zg))}function Ng(e){if(null===e)return null;var t=e[0];return Object(kg.a)(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof i.bd?i.df(e):i.if(e)}(e),recurse:!1}:{value:null,recurse:!0}}Zg.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote"),Sg.a,Sg.a,n(382).a;function Og(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&i.tf.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var Wg=i.he.whereImpl,Fg=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(){var e;return Object(Ur.a)(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new i.L(Object(ta.a)(e),Object(i.Td)()),e}return Object(Jr.a)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,Object(i.Ud)().get("IS_NODE")&&i.ud.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&i.tf.isString(n[0])){var a=n.map((function(e){return i.tf.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;if("complex64"===n){var a=this.readSync(r.real.dataId),o=this.readSync(r.imag.dataId);return i.ud.mergeRealAndImagArrays(a,o)}return this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return i.tf.decodeString(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(i.zd)(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return Object(i.Td)().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e),r=n.complexTensorInfos;null!=r&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n,r;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.tf.now(),t(),r=i.tf.now()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){Og([e],"where");var t=this.readSync(e.dataId);return Wg(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return Object(xo.a)(Object(So.a)(n.prototype),"epsilon",this).call(this)}}]),n}(i.wb);Fg.nextDataId=0;function Mg(e,t,n){return function(r){var a=r.inputs,o=r.attrs,s=r.backend,u=a.x;if(Og(u,e),"string"===u.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var c=s,l=c.data.get(u.dataId).values,g=i.tf.sizeFromShape(u.shape),d=n||u.dtype,h=i.tf.getArrayFromDType(d,g),f=0;f<g;++f)h[f]=t(l[f],o);return c.makeTensorInfo(u.shape,d,h)}}function Vg(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(Og(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var u=o,c=u.data.get(s.dataId).values,l=n||s.dtype,g=t(c,l,i);return u.makeTensorInfo(s.shape,l,g)}}Object(i.He)("cpu",(function(){return new Fg}),1);var Tg=Mg(i.W,(function(e){return e>=0?e:Math.exp(e)-1})),Eg={kernelName:i.W,backendName:"cpu",kernelFunc:Tg};function jg(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Lg={kernelName:i.rb,backendName:"cpu",kernelFunc:jg};function Xg(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.alpha;Og([a],"leakyRelu");for(var s=i.tf.sizeFromShape(a.shape),u=n.data.get(a.dataId).values,c=i.tf.getTypedArrayFromDType("float32",s),l=0;l<u.length;l++)c[l]=u[l]<0?o*u[l]:u[l];return n.makeTensorInfo(a.shape,"float32",c)}var Hg={kernelName:i.zb,backendName:"cpu",kernelFunc:Xg};function Yg(e){return function(t,n,r,a,o){var s=i.ud.assertAndGetBroadcastShape(t,n),u=s.length,c=i.tf.computeStrides(s),l=i.tf.sizeFromShape(s),g=i.tf.getTypedArrayFromDType(o,l),d=t.length,h=n.length,f=i.tf.computeStrides(t),p=i.tf.computeStrides(n),I=i.ud.getBroadcastDims(t,s),C=i.ud.getBroadcastDims(n,s);if(I.length+C.length===0)for(var m=0;m<g.length;++m)g[m]=e(r[m%r.length],a[m%a.length]);else for(var b=function(t){var n=i.tf.indexToLoc(t,u,c),o=n.slice(-d);I.forEach((function(e){return o[e]=0}));var s=i.tf.locToIndex(o,d,f),l=n.slice(-h);C.forEach((function(e){return l[e]=0}));var m=i.tf.locToIndex(l,h,p);g[t]=e(r[s],a[m])},v=0;v<g.length;++v)b(v);return[g,s]}}var zg=Yg((function(e,t){return e<0?t*e:e}));function Kg(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;Og([r,a],"prelu");var i=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=zg(r.shape,a.shape,i,s,r.dtype),c=Object(o.a)(u,2),l=c[0],g=c[1];return n.makeTensorInfo(g,r.dtype,l)}var _g={kernelName:i.hc,backendName:"cpu",kernelFunc:Kg},Dg=Mg(i.nc,(function(e){return Math.max(0,e)})),Pg={kernelName:i.nc,backendName:"cpu",kernelFunc:Dg},Ug=Mg(i.oc,(function(e){return Math.min(Math.max(0,e),6)})),Jg={kernelName:i.oc,backendName:"cpu",kernelFunc:Ug},Qg=Mg(i.Bc,(function(e){return 1/(1+Math.exp(-e))})),qg={kernelName:i.Bc,backendName:"cpu",kernelFunc:Qg};function $g(e,t,n,r,a){if("linear"===n)return jg({inputs:{x:t},backend:e});if("relu"===n)return Dg({inputs:{x:t},backend:e});if("elu"===n)return Tg({inputs:{x:t},backend:e});if("relu6"===n)return Ug({inputs:{x:t},backend:e});if("prelu"===n)return Kg({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return Xg({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return Qg({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function ed(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}var td={kernelName:i.y,backendName:"cpu",kernelFunc:ed};function nd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=nd(e,t,"float32"),a=nd(e,t,"float32");return ed({inputs:{real:r,imag:a},backend:e})}var o=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(t),n);return e.makeTensorInfo(t,n,o)}function rd(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var ad={kernelName:i.kc,backendName:"cpu",kernelFunc:rd};function id(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.dtype;if("complex64"===s){if("complex64"===a.dtype)return jg({inputs:{x:a},backend:n});var u=nd(n,a.shape,a.dtype),c=id({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=ed({inputs:{real:c,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}if("complex64"===a.dtype){var g=rd({inputs:{input:a},backend:n}),d=id({inputs:{x:g},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(g),d}if(!i.tf.hasEncodingLoss(a.dtype,s)){var h=jg({inputs:{x:a},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:s}}if("int32"===s){var f=n.data.get(a.dataId).values,p=Int32Array.from(f);return n.makeTensorInfo(a.shape,"int32",p)}if("bool"===s){var I=n.data.get(a.dataId).values,C=i.tf.toTypedArray([0],a.dtype),m=Yg((function(e,t){return e!==t?1:0}))(a.shape,[],I,C,"bool"),b=Object(o.a)(m,2),v=b[0],A=b[1];return n.makeTensorInfo(A,"bool",v)}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(s))}var od={kernelName:i.v,backendName:"cpu",kernelFunc:id};function sd(e,t,n,r){return null==n?function(n){var a=n.inputs,s=n.backend,u=a.a,c=a.b,l=s;Og([u,c],e);var g=l.data.get(u.dataId).values,d=l.data.get(c.dataId).values,h="string"===u.dtype?i.ud.fromUint8ToStringArray(g):g,f="string"===u.dtype?i.ud.fromUint8ToStringArray(d):d,p=r||u.dtype,I=t(u.shape,c.shape,h,f,p),C=Object(o.a)(I,2),m=C[0],b=C[1];return l.makeTensorInfo(b,p,m)}:function(e){var a=e.inputs,i=e.backend,s=a.a,u=a.b,c=i;if("complex64"===s.dtype||"complex64"===u.dtype){var l=id({inputs:{x:s},backend:c,attrs:{dtype:"complex64"}}),g=c.data.get(l.dataId),d=g.complexTensorInfos.real,h=g.complexTensorInfos.imag,f=c.data.get(d.dataId).values,p=c.data.get(h.dataId).values,I=id({inputs:{x:u},backend:c,attrs:{dtype:"complex64"}}),C=c.data.get(I.dataId),m=C.complexTensorInfos.real,b=C.complexTensorInfos.imag,v=c.data.get(m.dataId).values,A=c.data.get(b.dataId).values,y=n(s.shape,u.shape,f,p,v,A),w=Object(o.a)(y,3),G=w[0],B=w[1],x=w[2],S=c.makeTensorInfo(x,"float32",G),k=c.makeTensorInfo(x,"float32",B),Z=ed({inputs:{real:S,imag:k},backend:c});return c.disposeIntermediateTensorInfo(l),c.disposeIntermediateTensorInfo(I),c.disposeIntermediateTensorInfo(S),c.disposeIntermediateTensorInfo(k),Z}var R=c.data.get(s.dataId).values,N=c.data.get(u.dataId).values,O=r||s.dtype,W=t(s.shape,u.shape,R,N,O),F=Object(o.a)(W,2),M=F[0],V=F[1];return c.makeTensorInfo(V,O,M)}}function ud(e){return function(t,n,r,a,o,s){var u=i.ud.assertAndGetBroadcastShape(t,n),c=i.tf.sizeFromShape(u),l=u.length,g=i.tf.computeStrides(u),d=i.tf.getTypedArrayFromDType("float32",c),h=i.tf.getTypedArrayFromDType("float32",c),f=i.ud.getBroadcastDims(t,u),p=i.ud.getBroadcastDims(n,u),I=i.ud.mergeRealAndImagArrays(r,a),C=i.ud.mergeRealAndImagArrays(o,s),m=t.length,b=i.tf.computeStrides(t),v=n.length,A=i.tf.computeStrides(n);if(f.length+p.length===0)for(var y=0;y<d.length;y++){var w=y%I.length,G=y%C.length,B=e(I[2*w],I[2*w+1],C[2*G],C[2*G+1]);d[y]=B.real,h[y]=B.imag}else for(var x=function(t){var n=i.tf.indexToLoc(t,l,g),r=n.slice(-m);f.forEach((function(e){return r[e]=0}));var a=i.tf.locToIndex(r,m,b),o=n.slice(-v);p.forEach((function(e){return o[e]=0}));var s=i.tf.locToIndex(o,v,A),u=e(I[2*a],I[2*a+1],C[2*s],C[2*s+1]);d[t]=u.real,h[t]=u.imag},S=0;S<d.length;S++)x(S);return[d,h,u]}}var cd=Yg((function(e,t){return e+t})),ld=ud((function(e,t,n,r){return{real:e+n,imag:t+r}})),gd=sd(i.d,cd,ld),dd={kernelName:i.d,backendName:"cpu",kernelFunc:gd};function hd(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.shape,s=i.tf.sizeFromShape(a.shape),u=i.tf.inferFromImplicitShape(o,s),c=i.tf.sizeFromShape(u);i.tf.assert(s===c,(function(){return"The new shape (".concat(u,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var l=n.data.get(a.dataId);if(null!=l.complexTensorInfos){var g=l.complexTensorInfos.real,d=l.complexTensorInfos.imag;g.shape=u,d.shape=u}return{dataId:a.dataId,shape:u,dtype:a.dtype}}var fd={kernelName:i.pc,backendName:"cpu",kernelFunc:hd};function pd(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,s=t.b,u=r.transposeA,c=r.transposeB;Og([a,s],"matMul");var l=a.shape.length,g=s.shape.length,d=u?a.shape[l-2]:a.shape[l-1],h=c?s.shape[g-1]:s.shape[g-2],f=u?a.shape[l-1]:a.shape[l-2],p=c?s.shape[g-2]:s.shape[g-1],I=a.shape.slice(0,-2),C=s.shape.slice(0,-2),m=i.tf.sizeFromShape(I),b=i.tf.sizeFromShape(C),v=m===b||1===m||1===b;i.tf.assert(l>=2&&g>=2&&v,(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(I,") and (").concat(C,").")}));var A=(m>b?a.shape.slice(0,-2):s.shape.slice(0,-2)).concat([f,p]);i.tf.assert(d===h,(function(){return"Error in matMul: inner shapes (".concat(d,") and (")+"".concat(h,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(s.shape," and transposeA=").concat(u)+" and transposeB=".concat(c," must match.")}));for(var y=c?[b,p,h]:[b,h,p],w=hd({inputs:{x:a},backend:n,attrs:{shape:u?[m,d,f]:[m,f,d]}}),G=hd({inputs:{x:s},backend:n,attrs:{shape:y}}),B=u?w.shape[1]:w.shape[2],x=u?w.shape[2]:w.shape[1],S=c?G.shape[1]:G.shape[2],k=Math.max(m,b),Z=n.data.get(w.dataId).values,R=n.data.get(G.dataId).values,N=i.tf.computeStrides(w.shape),O=i.tf.computeStrides(G.shape),W=u?[N[0],1,N[1]]:[N[0],N[1],1],F=Object(o.a)(W,3),M=F[0],V=F[1],T=F[2],E=c?[1,O[1],O[0]]:[O[1],1,O[0]],j=Object(o.a)(E,3),L=j[0],X=j[1],H=j[2],Y=x*S,z=Object(i.zd)([k,x,S],w.dtype),K=z.values,_=n.blockSize,D=0;D<k;D++)for(var P=0;P<x;P+=_)for(var U=0;U<S;U+=_)for(var J=0;J<B;J+=_)for(var Q=Math.min(P+_,x),q=Math.min(U+_,S),$=Math.min(J+_,B),ee=P;ee<Q;ee++)for(var te=U;te<q;te++){for(var ne=0,re=J;re<$;re++){var ae=Math.min(D,m-1)*M,ie=Math.min(D,b-1)*H;ne+=Z[ae+ee*V+re*T]*R[re*L+te*X+ie]}K[D*Y+(ee*S+te)]+=ne}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(G),n.makeTensorInfo(A,z.dtype,z.values)}var Id={kernelName:i.s,backendName:"cpu",kernelFunc:pd};var Cd={kernelName:i.ld,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,s=a.a,u=a.b,c=a.bias,l=a.preluActivationWeights,g=o.transposeA,d=o.transposeB,h=o.activation,f=o.leakyreluAlpha,p=[];t=pd({inputs:{a:s,b:u},attrs:{transposeA:g,transposeB:d},backend:i}),c&&(n=gd({inputs:{a:t,b:c},backend:i}),p.push(t),t=n),h&&(r=$g(i,t,h,l,f),p.push(t),t=r);for(var I=0,C=p;I<C.length;I++){var m=C[I];i.disposeIntermediateTensorInfo(m)}return t}};function md(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var bd={kernelName:i.a,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;Og(t,"abs");var r=new Float32Array(i.tf.sizeFromShape(t.shape));return r=md(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,"float32")}},vd=Mg(i.b,(function(e){return Math.acos(e)})),Ad={kernelName:i.b,backendName:"cpu",kernelFunc:vd},yd=Mg(i.c,(function(e){return Math.acosh(e)})),wd={kernelName:i.c,backendName:"cpu",kernelFunc:yd};var Gd={kernelName:i.e,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;Og(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),o=Object(i.zd)(r[0].shape,r[0].dtype),s=o.values,u=0;u<r.length;u++)for(var c=a[u],l=0;l<s.length;l++)s[l]+=c[l];return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function Bd(e,t,n,r,a){for(var o=t.length,s=i.tf.sizeFromShape(t),u=i.tf.computeStrides(t),c=i.tf.computeStrides(a),l=i.tf.getTypedArrayFromDType(n,i.tf.sizeFromShape(a)),g=0;g<s;++g){for(var d=i.tf.indexToLoc(g,o,u),h=new Array(d.length),f=0;f<h.length;f++)h[f]=d[r[f]];l[i.tf.locToIndex(h,o,c)]=e[g]}return l}function xd(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;Og(a,"transpose");for(var o=a.shape.length,s=new Array(o),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var c=Bd(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(c,s,a.dtype),shape:s,dtype:a.dtype}}var Sd={kernelName:i.gd,backendName:"cpu",kernelFunc:xd};var kd={kernelName:i.f,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis,u=r.keepDims;Og(a,"all");var c=i.tf.parseAxisParam(s,a.shape),l=c,g=i.ud.getAxesPermutation(l,a.shape.length),d=a;null!=g&&(d=xd({inputs:{x:a},backend:n,attrs:{perm:g}}),l=i.ud.getInnerMostAxes(l.length,a.shape.length)),i.ud.assertAxesAreInnerMostDims("all",l,d.shape.length);for(var h=i.ud.computeOutAndReduceShapes(d.shape,l),f=Object(o.a)(h,2),p=f[0],I=f[1],C=i.tf.sizeFromShape(I),m=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(p),d.dtype),b=n.data.get(d.dataId).values,v=0;v<m.length;++v){for(var A=v*C,y=b[A],w=0;w<C;++w){var G=b[A+w];y=y&&G}m[v]=y}null!=g&&n.disposeIntermediateTensorInfo(d);var B=n.makeTensorInfo(p,d.dtype,m);if(u){var x=hd({inputs:{x:B},backend:n,attrs:{shape:i.ud.expandShapeToKeepDim(p,c)}});return n.disposeIntermediateTensorInfo(B),x}return B}};var Zd={kernelName:i.g,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis,u=r.keepDims;Og(a,"any");var c=i.tf.parseAxisParam(s,a.shape),l=c,g=i.ud.getAxesPermutation(l,a.shape.length),d=a;null!=g&&(d=xd({inputs:{x:a},backend:n,attrs:{perm:g}}),l=i.ud.getInnerMostAxes(l.length,a.shape.length)),i.ud.assertAxesAreInnerMostDims("any",l,d.shape.length);for(var h=i.ud.computeOutAndReduceShapes(d.shape,l),f=Object(o.a)(h,2),p=f[0],I=f[1],C=i.tf.sizeFromShape(I),m=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(p),d.dtype),b=n.data.get(d.dataId).values,v=0;v<m.length;++v){for(var A=v*C,y=b[A],w=0;w<C;++w){var G=b[A+w];y=y||G}m[v]=y}null!=g&&n.disposeIntermediateTensorInfo(d);var B=n.makeTensorInfo(p,d.dtype,m);if(u){var x=hd({inputs:{x:B},backend:n,attrs:{shape:i.ud.expandShapeToKeepDim(p,c)}});return n.disposeIntermediateTensorInfo(B),x}return B}};var Rd={kernelName:i.h,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis;Og(a,"argMax");var u=i.tf.parseAxisParam(s,a.shape),c=i.ud.getAxesPermutation(u,a.shape.length),l=a,g=[];null!=c&&(l=xd({inputs:{x:a},backend:n,attrs:{perm:c}}),g.push(l),u=i.ud.getInnerMostAxes(u.length,l.shape.length)),u=[u[0]],i.ud.assertAxesAreInnerMostDims("argMax",u,l.shape.length);for(var d=i.ud.computeOutAndReduceShapes(l.shape,u),h=Object(o.a)(d,2),f=h[0],p=h[1],I=i.tf.sizeFromShape(f),C=i.tf.makeZerosTypedArray(I,"int32"),m=i.tf.sizeFromShape(p),b=n.data.get(l.dataId).values,v=0;v<C.length;++v){for(var A=v*m,y=b[A],w=0,G=0;G<m;++G){var B=b[A+G];B>y&&(y=B,w=G)}C[v]=w}return g.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f,"int32",C)}};var Nd={kernelName:i.i,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis;Og(a,"argMin");var u=i.tf.parseAxisParam(s,a.shape),c=i.ud.getAxesPermutation(u,a.shape.length),l=a,g=[];null!=c&&(l=xd({inputs:{x:a},backend:n,attrs:{perm:c}}),g.push(l),u=i.ud.getInnerMostAxes(u.length,l.shape.length)),u=[u[0]],i.ud.assertAxesAreInnerMostDims("argMin",u,l.shape.length);for(var d=i.ud.computeOutAndReduceShapes(l.shape,u),h=Object(o.a)(d,2),f=h[0],p=h[1],I=i.tf.sizeFromShape(f),C=i.tf.makeZerosTypedArray(I,"int32"),m=i.tf.sizeFromShape(p),b=n.data.get(l.dataId).values,v=0;v<C.length;++v){for(var A=v*m,y=b[A],w=0,G=0;G<m;++G){var B=b[A+G];B<y&&(y=B,w=G)}C[v]=w}return g.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(f,"int32",C)}},Od=Mg(i.j,(function(e){return Math.asin(e)})),Wd={kernelName:i.j,backendName:"cpu",kernelFunc:Od},Fd=Mg(i.k,(function(e){return Math.asinh(e)})),Md={kernelName:i.k,backendName:"cpu",kernelFunc:Fd},Vd=Mg(i.l,(function(e){return Math.atan(e)})),Td={kernelName:i.l,backendName:"cpu",kernelFunc:Vd},Ed=Yg((function(e,t){return Math.atan2(e,t)})),jd=sd(i.m,Ed),Ld={kernelName:i.m,backendName:"cpu",kernelFunc:jd},Xd=Mg(i.n,(function(e){return Math.atanh(e)})),Hd={kernelName:i.n,backendName:"cpu",kernelFunc:Xd};function Yd(e,t,n,r,a,o){for(var s=a.strideHeight,u=a.strideWidth,c=a.dilationHeight,l=a.dilationWidth,g=a.effectiveFilterHeight,d=a.effectiveFilterWidth,h=a.padInfo.top,f=a.padInfo.left,p="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,I=Object(i.zd)(a.outShape,n),C=I.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],v=a.outShape[3],A=0;A<a.batchSize;++A)for(var y=A*m,w=A*r[0],G=0;G<a.inChannels;++G)for(var B=0;B<a.outHeight;++B)for(var x=B*s-h,S=Math.max(0,x),k=Math.min(a.inHeight,g+x),Z=y+B*b,R=0;R<a.outWidth;++R){for(var N=R*u-f,O=Math.max(0,N),W=Math.min(a.inWidth,d+N),F=p,M=0,V=0,T=S;T<k;T+=c){for(var E=w+T*r[1],j=O;j<W;j+=l){var L=e[E+j*r[2]+G];"max"===o&&L>F?F=L:"avg"===o&&(M+=L,V++)}if(isNaN(F))break}C[Z+R*v+G]="avg"===o?M/V:F}return I}function zd(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=Object(i.zd)(r.outShape,"int32"),u=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,g=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,I=Object(i.zd)(t,n,e),C=0;C<r.batchSize;++C)for(var m=0;m<r.inChannels;++m)for(var b=0;b<r.outHeight;++b){for(var v=b*u-f,A=v;A<0;)A+=l;for(var y=Math.min(r.inHeight,d+v),w=0;w<r.outWidth;++w){for(var G=w*c-p,B=G;B<0;)B+=g;for(var x=Math.min(r.inWidth,h+G),S=Number.NEGATIVE_INFINITY,k=-1,Z=A;Z<y;Z+=l)for(var R=Z-v,N=B;N<x;N+=g){var O=N-G,W=I.get(C,Z,N,m);W>S&&(S=W,k=a?o?((C*r.inHeight+Z)*r.inWidth+N)*r.inChannels+m:(Z*r.inWidth+N)*r.inChannels+m:R*h+O)}s.set(k,C,b,w,m)}}return s}function Kd(e,t,n,r,a,o){for(var s=a.strideDepth,u=a.strideHeight,c=a.strideWidth,l=a.dilationDepth,g=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterDepth,f=a.effectiveFilterHeight,p=a.effectiveFilterWidth,I=a.padInfo.front,C=a.padInfo.top,m=a.padInfo.left,b="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Object(i.zd)(a.outShape,n),A=v.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],G=a.outShape[3]*a.outShape[4],B=a.outShape[4],x=0;x<a.batchSize;++x)for(var S=x*y,k=x*r[0],Z=0;Z<a.inChannels;++Z)for(var R=0;R<a.outDepth;++R){for(var N=R*s-I,O=N;O<0;)O+=l;for(var W=Math.min(a.inDepth,h+N),F=S+R*w,M=0;M<a.outHeight;++M){for(var V=M*u-C,T=V;T<0;)T+=g;for(var E=Math.min(a.inHeight,f+V),j=F+M*G,L=0;L<a.outWidth;++L){for(var X=L*c-m,H=X;H<0;)H+=d;for(var Y=Math.min(a.inWidth,p+X),z=j+L*B,K=b,_=0,D=0,P=O;P<W;P+=l){for(var U=k+P*r[1],J=T;J<E;J+=g){for(var Q=U+J*r[2],q=H;q<Y;q+=d){var $=e[Q+q*r[3]+Z];if("max"===o&&$>K?K=$:"avg"===o&&(_+=$,D++),isNaN(K))break}if(isNaN(K))break}if(isNaN(K))break}A[z+Z]="avg"===o?_/D:K}}}return v}var _d={kernelName:i.o,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Og(a,"avgPool");var o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l,g=i.ud.computePool2DInfo(a.shape,o,s,1,u,c);if(1===g.filterWidth&&1===g.filterHeight&&i.tf.arraysEqual(g.inShape,g.outShape))l=jg({inputs:{x:a},backend:n});else{var d=n.data.get(a.dataId).values,h=i.tf.computeStrides(a.shape),f=Yd(d,a.shape,a.dtype,h,g,"avg");l=n.makeTensorInfo(g.outShape,a.dtype,f.values)}return l}};var Dd={kernelName:i.p,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=r.dataFormat;Og(a,"avgPool3d");var g=i.ud.computePool3DInfo(a.shape,o,s,1,u,c,l),d=Kd(n.data.get(a.dataId).values,a.shape,a.dtype,i.tf.computeStrides(a.shape),g,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}};var Pd={kernelName:i.q,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode;Og([a,o],"avgPool3DGrad");for(var g=i.ud.computePool3DInfo(o.shape,s,u,1,c,l),d=g.strideDepth,h=g.strideHeight,f=g.strideWidth,p=g.filterDepth,I=g.filterHeight,C=g.filterWidth,m=g.dilationDepth,b=g.dilationHeight,v=g.dilationWidth,A=g.effectiveFilterDepth,y=g.effectiveFilterHeight,w=g.effectiveFilterWidth,G=A-1-g.padInfo.front,B=w-1-g.padInfo.left,x=y-1-g.padInfo.top,S=Object(i.zd)(o.shape,"float32"),k=1/(p*I*C),Z=n.bufferSync(a),R=0;R<g.batchSize;++R)for(var N=0;N<g.inChannels;++N)for(var O=0;O<g.inDepth;++O)for(var W=0;W<g.inHeight;++W)for(var F=0;F<g.inWidth;++F){for(var M=O-G,V=W-x,T=F-B,E=0,j=0;j<A;j+=m){var L=(M+j)/d;if(!(L<0||L>=g.outDepth||Math.floor(L)!==L))for(var X=0;X<y;X+=b){var H=(V+X)/h;if(!(H<0||H>=g.outHeight||Math.floor(H)!==H))for(var Y=0;Y<w;Y+=v){var z=(T+Y)/f;if(!(z<0||z>=g.outWidth||Math.floor(z)!==z))E+=Z.get(R,L,H,z,N)}}}S.set(E*k,R,O,W,F,N)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};var Ud={kernelName:i.r,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=o;Og([a,o],"avgPoolGrad");for(var u=r.filterSize,c=r.strides,l=r.pad,g=i.ud.computePool2DInfo(s.shape,u,c,1,l),d=g.strideHeight,h=g.strideWidth,f=g.filterHeight,p=g.filterWidth,I=g.dilationHeight,C=g.dilationWidth,m=g.effectiveFilterHeight,b=g.effectiveFilterWidth,v=b-1-g.padInfo.left,A=m-1-g.padInfo.top,y=Object(i.zd)(s.shape,"float32"),w=1/(f*p),G=n.data.get(a.dataId).values,B=Object(i.zd)(a.shape,"float32",G),x=0;x<g.batchSize;++x)for(var S=0;S<g.inChannels;++S)for(var k=0;k<g.inHeight;++k)for(var Z=0;Z<g.inWidth;++Z){for(var R=k-A,N=Z-v,O=0,W=0;W<m;W+=I){var F=(R+W)/d;if(!(F<0||F>=g.outHeight||Math.floor(F)!==F))for(var M=0;M<b;M+=C){var V=(N+M)/h;if(!(V<0||V>=g.outWidth||Math.floor(V)!==V))O+=B.get(x,F,V,S)}}y.set(O*w,x,k,Z,S)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var Jd={kernelName:i.jb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.scale,s=t.offset,u=t.mean,c=t.variance;i.tf.assert(u.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),i.tf.assert(null==s||u.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),i.tf.assert(null==o||u.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),Og([a,u,c,o,s],"batchNorm");var l=r.varianceEpsilon;null==l&&(l=.001);for(var g=n.data.get(a.dataId).values,d=n.data.get(u.dataId).values,h=n.data.get(c.dataId).values,f=o?n.data.get(o.dataId).values:new Float32Array([1]),p=s?n.data.get(s.dataId).values:new Float32Array([0]),I=new Float32Array(g.length),C=p.length,m=f.length,b=h.length,v=d.length,A=0,y=0,w=0,G=0,B=0;B<g.length;++B)I[B]=p[A++]+(g[B]-d[y++])*f[w++]/Math.sqrt(h[G++]+l),A>=C&&(A=0),y>=v&&(y=0),w>=m&&(w=0),G>=b&&(G=0);return n.makeTensorInfo(a.shape,a.dtype,I)}};function Qd(e,t,n,r,a){var o=i.Xe.isSliceContinous(r,t,n),s=i.tf.sizeFromShape(n),u=i.tf.computeStrides(r);if(o){var c=i.Xe.computeFlatOffset(t,u);return"string"===a?e.slice(c,c+s):e.subarray(c,c+s)}for(var l="string"===a?i.ud.fromUint8ToStringArray(e):e,g=Object(i.zd)(r,a,l),d=Object(i.zd)(n,a),h=0;h<d.size;++h){var f=d.indexToLoc(h),p=f.map((function(e,n){return e+t[n]}));d.set.apply(d,[g.get.apply(g,Object(Yn.a)(p))].concat(Object(Yn.a)(f)))}return"string"===a?i.ud.fromStringArrayToUint8(d.values):d.values}function qd(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.begin,u=r.size;Og(a,"slice");var c=i.Xe.parseSliceParams(a,s,u),l=Object(o.a)(c,2),g=l[0],d=l[1];i.Xe.assertParamsValid(a,g,d);var h=Qd(n.data.get(a.dataId).values,g,d,a.shape,a.dtype);return n.makeTensorInfo(d,a.dtype,h)}var $d={kernelName:i.Fc,backendName:"cpu",kernelFunc:qd};var eh={kernelName:i.t,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.blockShape,s=r.crops;Og([a],"batchToSpaceND");var u=o.reduce((function(e,t){return e*t})),c=i.ud.getReshaped(a.shape,o,u),l=i.ud.getPermuted(c.length,o.length),g=i.ud.getReshapedPermuted(a.shape,o,u),d=i.ud.getSliceBeginCoords(s,o.length),h=i.ud.getSliceSize(g,s,o.length),f=hd({inputs:{x:a},backend:n,attrs:{shape:c}}),p=xd({inputs:{x:f},backend:n,attrs:{perm:l}}),I=hd({inputs:{x:p},backend:n,attrs:{shape:g}}),C=qd({inputs:{x:I},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(I),C}};function th(e,t,n,r,a){for(var o=i.tf.sizeFromShape(r),s=i.tf.makeZerosTypedArray(a,n),u=0;u<e.length;u++){var c=e[u];if(c<0)throw new Error("Input x must be non-negative!");c>=a||(s[c]+=o>0?t[u]:1)}return s}function nh(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],o=e.shape[1],s=Object(i.zd)([a,n],t.dtype),u=0;u<a;u++)for(var c=0;c<o;c++){var l=e.get(u,c);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?s.set(1,u,l):t.size>0?s.set(s.get(u,l)+t.get(u,c),u,l):s.set(s.get(u,l)+1,u,l))}return s}var rh={kernelName:i.u,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=th(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};function ah(e){return function(t,n,r){for(var a=i.tf.getTypedArrayFromDType(n,t.length),o=0;o<t.length;++o)a[o]=e(t[o],r);return a}}var ih=ah((function(e){return Math.ceil(e)})),oh=Vg(i.w,ih),sh={kernelName:i.w,backendName:"cpu",kernelFunc:oh},uh=Mg(i.x,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),ch={kernelName:i.x,backendName:"cpu",kernelFunc:uh},lh={kernelName:i.z,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(i.tf.sizeFromShape(t.shape)),a=n.data.get(t.dataId),o=a.complexTensorInfos.real,s=a.complexTensorInfos.imag,u=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values,l=0;l<u.length;l++){var g=u[l],d=c[l];r[l]=Math.hypot(g,d)}return n.makeOutput(r,t.shape,"float32")}};function gh(e,t,n,r){var a=i.tf.getArrayFromDType(n,i.tf.sizeFromShape(t));if(r&&"string"!==n){var o=0;e.forEach((function(e){var t=i.tf.sizeFromShape(e.shape);a.set(e.vals,o),o+=t}))}else{var s=0;e.forEach((function(e){for(var r="string"===n?i.ud.fromUint8ToStringArray(e.vals):e.vals,o=0,u=0;u<e.shape[0];++u)for(var c=u*t[1]+s,l=0;l<e.shape[1];++l)a[c+l]=r[o++];s+=e.shape[1]}))}return a}function dh(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var hh={kernelName:i.sb,backendName:"cpu",kernelFunc:dh};function fh(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=i.tf.parseAxisParam(r,t[0].shape)[0],o=i.ud.computeOutShape(t.map((function(e){return e.shape})),a);if(0===i.tf.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var s=t.filter((function(e){return i.tf.sizeFromShape(e.shape)>0}));if(1===s.length)return jg({inputs:{x:s[0]},backend:n});var u=s.map((function(e){return e.shape}));if(i.ud.assertParamsConsistent(u,a),"complex64"===s[0].dtype){var c=s.map((function(e){return rd({inputs:{input:e},backend:n})})),l=s.map((function(e){return dh({inputs:{input:e},backend:n})})),g=fh({inputs:c,backend:n,attrs:{axis:a}}),d=fh({inputs:l,backend:n,attrs:{axis:a}}),h=ed({inputs:{real:g,imag:d},backend:n});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(d),h}var f=s.map((function(e){var t=i.tf.sizeFromShape(e.shape.slice(a));return hd({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),p=f.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));o=i.ud.computeOutShape(f.map((function(e){return e.shape})),1);var I=1===f[0].shape[0],C=gh(p,o,t[0].dtype,I),m=i.ud.computeOutShape(s.map((function(e){return e.shape})),a),b=n.makeTensorInfo(m,t[0].dtype,C);return f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),b}var ph={kernelName:i.A,backendName:"cpu",kernelFunc:fh};function Ih(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dilations,g=r.dimRoundingMode;Og([a,o],"conv2d");for(var d=i.ud.convertConv2DDataFormat(c),h=i.ud.computeConv2DInfo(a.shape,o.shape,s,l,u,g,!1,d),f=h.filterHeight,p=h.filterWidth,I=h.dilationHeight,C=h.dilationWidth,m=h.padInfo.left,b=h.padInfo.top,v="channelsLast"===h.dataFormat,A=new i.cd(h.outShape,a.dtype),y=i.tf.computeStrides(a.shape),w=i.tf.computeStrides(o.shape),G=y[0],B=v?y[1]:y[2],x=v?y[2]:1,S=v?1:y[1],k=A.strides[0],Z=v?A.strides[1]:A.strides[2],R=v?A.strides[2]:1,N=v?1:A.strides[1],O=n.data.get(a.dataId).values,W=n.data.get(o.dataId).values,F=A.values,M=0;M<h.batchSize;++M)for(var V=M*G,T=M*k,E=0;E<h.outHeight;++E)for(var j=T+E*Z,L=E*h.strideHeight-b,X=0;X<f;++X){var H=L+X*I;if(!(H<0||H>=h.inHeight))for(var Y=X*w[0],z=V+H*B,K=0;K<h.outWidth;++K)for(var _=j+K*R,D=K*h.strideWidth-m,P=0;P<p;++P){var U=D+P*C;if(!(U<0||U>=h.inWidth))for(var J=z+U*x,Q=Y+P*w[1],q=0;q<h.inChannels;++q){for(var $=O[J+q*S],ee=0;ee<h.outChannels;++ee)F[_+ee*N]+=$*W[Q+ee];Q+=h.outChannels}}}return n.makeTensorInfo(A.shape,A.dtype,F)}var Ch={kernelName:i.B,backendName:"cpu",kernelFunc:Ih};var mh={kernelName:i.C,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.dy,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,g=r.filterShape;Og([a,o],"conv2dBackpropFilter");for(var d=i.ud.convertConv2DDataFormat(c),h=i.ud.computeConv2DInfo(a.shape,g,s,1,u,l,!1,d),f=h.strideHeight,p=h.strideWidth,I=h.filterHeight,C=h.filterWidth,m="channelsLast"===h.dataFormat,b=new i.cd(h.filterShape,"float32"),v=h.padInfo.left,A=h.padInfo.top,y=n.data.get(a.dataId).values,w=n.data.get(o.dataId).values,G=new i.cd(a.shape,a.dtype,y),B=new i.cd(o.shape,o.dtype,w),x=0;x<I;++x)for(var S=Math.max(0,Math.ceil((A-x)/f)),k=Math.min(h.outHeight,(h.inHeight+A-x)/f),Z=0;Z<C;++Z)for(var R=Math.max(0,Math.ceil((v-Z)/p)),N=Math.min(h.outWidth,(h.inWidth+v-Z)/p),O=0;O<h.inChannels;++O)for(var W=0;W<h.outChannels;++W){for(var F=0,M=0;M<h.batchSize;++M)for(var V=S;V<k;++V)for(var T=x+V*f-A,E=R;E<N;++E){var j=Z+E*p-v;F+=m?G.get(M,T,j,O)*B.get(M,V,E,W):G.get(M,O,T,j)*B.get(M,W,V,E)}b.set(F,x,Z,O,W)}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var bh={kernelName:i.D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,s=t.filter,u=r.inputShape,c=r.strides,l=r.pad,g=r.dataFormat,d=r.dimRoundingMode;Og([a,s],"conv2dBackpropInput");var h=i.tf.computeStrides(s.shape),f=i.tf.computeStrides(a.shape),p=i.ud.convertConv2DDataFormat(g),I=i.ud.computeConv2DInfo(u,s.shape,c,1,l,d,!1,p),C=new i.cd(I.inShape,"float32"),m=C.values,b=n.data.get(a.dataId).values,v=n.data.get(s.dataId).values,A=Object(o.a)(h,3),y=A[0],w=A[1],G=A[2],B=I.batchSize,x=I.filterHeight,S=I.filterWidth,k=I.inChannels,Z=I.inHeight,R=I.inWidth,N=I.outChannels,O=I.outHeight,W=I.outWidth,F=I.strideHeight,M=I.strideWidth;p=I.dataFormat;for(var V=x-1-I.padInfo.top,T=S-1-I.padInfo.left,E="channelsLast"===p,j=C.strides[0],L=E?C.strides[1]:C.strides[2],X=E?C.strides[2]:1,H=E?1:C.strides[1],Y=f[0],z=E?f[1]:f[2],K=E?f[2]:1,_=E?1:f[1],D=0;D<B;++D)for(var P=0;P<k;++P)for(var U=0;U<Z;++U)for(var J=U-V,Q=Math.max(0,Math.ceil(J/F)),q=Math.min(O,(x+J)/F),$=0;$<R;++$){for(var ee=$-T,te=Math.max(0,Math.ceil(ee/M)),ne=Math.min(W,(S+ee)/M),re=0,ae=Q;ae<q;++ae)for(var ie=ae*F-J,oe=te;oe<ne;++oe)for(var se=Y*D+z*ae+K*oe,ue=y*(x-1-ie)+w*(S-1-(oe*M-ee))+G*P,ce=0;ce<N;++ce){re+=b[se+_*ce]*v[ue+ce]}m[j*D+L*U+X*$+H*P]=re}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var vh={kernelName:i.E,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=r.strides,u=r.pad,c=r.dilations;Og([a,o],"conv3d");for(var l=i.ud.computeConv3DInfo(a.shape,o.shape,s,c,u),g=l.filterDepth,d=l.filterHeight,h=l.filterWidth,f=l.dilationDepth,p=l.dilationHeight,I=l.dilationWidth,C=l.padInfo,m=C.front,b=C.left,v=C.top,A=new i.cd(l.outShape,a.dtype),y=n.data.get(a.dataId).values,w=n.data.get(o.dataId).values,G=A.values,B=i.tf.computeStrides(a.shape),x=i.tf.computeStrides(o.shape),S=0;S<l.batchSize;++S)for(var k=S*B[0],Z=S*A.strides[0],R=0;R<l.outDepth;++R)for(var N=Z+R*A.strides[1],O=R*l.strideDepth-m,W=0;W<g;++W){var F=O+W*f;if(!(F<0||F>=l.inDepth))for(var M=W*x[0],V=k+F*B[1],T=0;T<l.outHeight;++T)for(var E=N+T*A.strides[2],j=T*l.strideHeight-v,L=0;L<d;++L){var X=j+L*p;if(!(X<0||X>=l.inHeight))for(var H=M+L*x[1],Y=V+X*B[2],z=0;z<l.outWidth;++z)for(var K=E+z*l.outChannels,_=z*l.strideWidth-b,D=0;D<h;++D){var P=_+D*I;if(!(P<0||P>=l.inWidth))for(var U=H+D*x[2],J=Y+P*l.inChannels,Q=U,q=0;q<l.inChannels;++q){for(var $=y[J+q],ee=0;ee<l.outChannels;++ee)G[K+ee]+=$*w[Q+ee];Q+=l.outChannels}}}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}};var Ah={kernelName:i.F,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=t.dy,u=r.strides,c=r.pad,l=r.filterShape;Og([a,s],"conv3dBackpropFilterV2");for(var g=i.tf.computeStrides(a.shape),d=i.tf.computeStrides(s.shape),h=i.ud.computeConv3DInfo(a.shape,l,u,1,c),f=h.strideDepth,p=h.strideHeight,I=h.strideWidth,C=h.filterDepth,m=h.filterHeight,b=h.filterWidth,v=new i.cd(h.filterShape,"float32"),A=v.values,y=Object(o.a)(v.strides,4),w=y[0],G=y[1],B=y[2],x=y[3],S=n.data.get(s.dataId).values,k=Object(o.a)(d,4),Z=k[0],R=k[1],N=k[2],O=k[3],W=n.data.get(a.dataId).values,F=Object(o.a)(g,4),M=F[0],V=F[1],T=F[2],E=F[3],j=h.padInfo.front,L=h.padInfo.left,X=h.padInfo.top,H=0;H<C;++H)for(var Y=Math.max(0,Math.ceil((j-H)/f)),z=Math.min(h.outDepth,(h.inDepth+j-H)/f),K=H*w,_=0;_<m;++_)for(var D=Math.max(0,Math.ceil((X-_)/p)),P=Math.min(h.outHeight,(h.inHeight+X-_)/p),U=_*G+K,J=0;J<b;++J)for(var Q=Math.max(0,Math.ceil((L-J)/I)),q=Math.min(h.outWidth,(h.inWidth+L-J)/I),$=J*B+U,ee=0;ee<h.inChannels;++ee)for(var te=ee*x+$,ne=0;ne<h.outChannels;++ne){for(var re=0,ae=0;ae<h.batchSize;++ae)for(var ie=ae*M,oe=ae*Z,se=Y;se<z;++se)for(var ue=(H+se*f-j)*V+ie,ce=se*R+oe,le=D;le<P;++le)for(var ge=(_+le*p-X)*T+ue,de=le*N+ce,he=Q;he<q;++he){var fe=he*O+de;re+=W[(J+he*I-L)*E+ge+ee]*S[fe+ne]}A[te+ne]=re}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var yh={kernelName:i.G,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,s=t.filter,u=r.pad,c=r.strides,l=r.inputShape;Og([a],"conv3dBackpropInputV2");for(var g=i.tf.computeStrides(a.shape),d=i.tf.computeStrides(s.shape),h=i.ud.computeConv3DInfo(l,s.shape,c,1,u),f=new i.cd(h.inShape,"float32"),p=f.values,I=Object(o.a)(f.strides,4),C=I[0],m=I[1],b=I[2],v=I[3],A=n.data.get(a.dataId).values,y=Object(o.a)(g,4),w=y[0],G=y[1],B=y[2],x=y[3],S=n.data.get(s.dataId).values,k=Object(o.a)(d,4),Z=k[0],R=k[1],N=k[2],O=k[3],W=h.batchSize,F=h.filterDepth,M=h.filterHeight,V=h.filterWidth,T=h.inChannels,E=h.inDepth,j=h.inHeight,L=h.inWidth,X=h.outChannels,H=h.outDepth,Y=h.outHeight,z=h.outWidth,K=h.strideDepth,_=h.strideHeight,D=h.strideWidth,P=F-1-h.padInfo.front,U=M-1-h.padInfo.top,J=V-1-h.padInfo.left,Q=0;Q<W;++Q)for(var q=0;q<T;++q)for(var $=0;$<E;++$)for(var ee=$-P,te=Math.max(0,Math.ceil(ee/K)),ne=Math.min(H,(F+ee)/K),re=0;re<j;++re)for(var ae=re-U,ie=Math.max(0,Math.ceil(ae/_)),oe=Math.min(Y,(M+ae)/_),se=0;se<L;++se){for(var ue=se-J,ce=Math.max(0,Math.ceil(ue/D)),le=Math.min(z,(V+ue)/D),ge=0,de=te;de<ne;++de)for(var he=de*K-ee,fe=ie;fe<oe;++fe)for(var pe=fe*_-ae,Ie=ce;Ie<le;++Ie)for(var Ce=w*Q+G*de+B*fe+x*Ie,me=Z*(F-1-he)+R*(M-1-pe)+N*(V-1-(Ie*D-ue))+O*q,be=0;be<X;++be){ge+=A[Ce+be]*S[me+be]}p[C*Q+m*$+b*re+v*se+q]=ge}return n.makeTensorInfo(f.shape,f.dtype,f.values)}},wh=Mg(i.H,(function(e){return Math.cos(e)})),Gh={kernelName:i.H,backendName:"cpu",kernelFunc:wh},Bh=Mg(i.I,(function(e){return Math.cosh(e)})),xh={kernelName:i.I,backendName:"cpu",kernelFunc:Bh};var Sh={kernelName:i.J,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,s=t.boxes,u=t.boxInd,c=r.cropSize,l=r.method,g=r.extrapolationValue,d=Object(o.a)(a.shape,4),h=d[0],f=d[1],p=d[2],I=d[3],C=s.shape[0],m=Object(o.a)(c,2),b=m[0],v=m[1],A=Object(i.zd)([C,b,v,I],"float32"),y=n.data.get(s.dataId).values,w=n.data.get(u.dataId).values,G=n.data.get(a.dataId).values,B=i.tf.computeStrides(a.shape),x=i.tf.computeStrides(A.shape),S=0;S<C;S++){var k=4*S,Z=y[k],R=y[k+1],N=y[k+2],O=y[k+3],W=w[S];if(!(W>=h))for(var F=b>1?(N-Z)*(f-1)/(b-1):0,M=v>1?(O-R)*(p-1)/(v-1):0,V=0;V<b;V++){var T=b>1?Z*(f-1)+V*F:.5*(Z+N)*(f-1);if(T<0||T>f-1)for(var E=0;E<v;E++)for(var j=0;j<I;j++){var L=j+E*x[2]+V*x[1]+S*x[0];A.values[L]=g}else if("bilinear"===l)for(var X=Math.floor(T),H=Math.ceil(T),Y=T-X,z=0;z<v;z++){var K=v>1?R*(p-1)+z*M:.5*(R+O)*(p-1);if(K<0||K>p-1)for(var _=0;_<I;_++){var D=_+z*x[2]+V*x[1]+S*x[0];A.values[D]=g}else for(var P=Math.floor(K),U=Math.ceil(K),J=K-P,Q=0;Q<I;Q++){var q=Q+P*B[2]+X*B[1]+W*B[0],$=G[q],ee=G[q=Q+U*B[2]+X*B[1]+W*B[0]],te=G[q=Q+P*B[2]+H*B[1]+W*B[0]],ne=$+(ee-$)*J,re=te+(G[q=Q+U*B[2]+H*B[1]+W*B[0]]-te)*J;q=Q+z*x[2]+V*x[1]+S*x[0],A.values[q]=ne+(re-ne)*Y}}else for(var ae=0;ae<v;++ae){var ie=v>1?R*(p-1)+ae*M:.5*(R+O)*(p-1);if(ie<0||ie>p-1)for(var oe=0;oe<I;oe++){var se=oe+ae*x[2]+V*x[1]+S*x[0];A.values[se]=g}else for(var ue=Math.round(ie),ce=Math.round(T),le=0;le<I;le++){var ge=le+ue*B[2]+ce*B[1]+W*B[0],de=le+ae*x[2]+V*x[1]+S*x[0];A.values[de]=G[ge]}}}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}};var kh={kernelName:i.K,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,s=r.exclusive,u=r.reverse;Og(a,"cumsum");var c=i.ud.getAxesPermutation([o],a.shape.length),l=a;null!=c&&(l=xd({inputs:{x:a},backend:n,attrs:{perm:c}}));var g=i.ud.getInnerMostAxes(1,a.shape.length)[0];if(g!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(g));for(var d=Object(i.sf)(l.dtype,"int32"),h=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(l.shape),d),f=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],I=u?function(e,t){return e+p-t-1}:function(e,t){return e+t},C=0;C<f.length;C+=p)for(var m=0;m<p;m++){var b=I(C,m);if(0===m)h[b]=s?0:f[b];else{var v=I(C,m-1);h[b]=s?f[v]+h[v]:f[b]+h[v]}}var A=n.makeTensorInfo(l.shape,d,h);if(null!=c){var y=xd({inputs:{x:A},backend:n,attrs:{perm:i.ud.getUndoAxesPermutation(c)}});return n.disposeIntermediateTensorInfo(A),n.disposeIntermediateTensorInfo(l),y}return A}};var Zh={kernelName:i.M,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=th(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}if(2===a.shape.length){var c=nh(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var Rh={kernelName:i.N,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.blockSize,s=r.dataFormat;i.tf.assert("NHWC"===s,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(s)})),i.tf.assert(o>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(o)}));for(var u=a.shape[0],c=a.shape[1],l=a.shape[2],g=a.shape[3],d=c*o,h=l*o,f=g/(o*o),p=n.data.get(a.dataId).values,I=new Float32Array(u*d*h*f),C=0,m=0;m<u;++m)for(var b=0;b<d;++b)for(var v=Math.floor(b/o),A=b%o,y=0;y<h;++y)for(var w=Math.floor(y/o),G=(A*o+y%o)*f,B=0;B<f;++B){var x=B+G+g*(w+l*(v+c*m));I[C++]=p[x]}return n.makeTensorInfo([u,d,h,f],a.dtype,I)}};function Nh(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=r.strides,u=r.pad,c=r.dilations,l=r.dimRoundingMode;Og([a,o],"depthwiseConv2DNative");var g=i.tf.computeStrides(a.shape),d=i.tf.computeStrides(o.shape),h=c;null==h&&(h=[1,1]),i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(s,h),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(h,"'")}));for(var f=i.ud.computeConv2DInfo(a.shape,o.shape,s,h,u,l,!0),p=f.filterHeight,I=f.filterWidth,C=f.dilationHeight,m=f.dilationWidth,b=f.padInfo,v=b.left,A=b.top,y=f.outChannels/f.inChannels,w=new i.cd(f.outShape,a.dtype),G=n.data.get(a.dataId).values,B=n.data.get(o.dataId).values,x=w.values,S=0;S<f.batchSize;++S)for(var k=S*g[0],Z=S*w.strides[0],R=0;R<f.outHeight;++R)for(var N=Z+R*w.strides[1],O=R*f.strideHeight-A,W=0;W<p;++W){var F=O+W*C;if(!(F<0||F>=f.inHeight))for(var M=W*d[0],V=k+F*g[1],T=0;T<f.outWidth;++T)for(var E=N+T*w.strides[2],j=T*f.strideWidth-v,L=0;L<I;++L){var X=j+L*m;if(!(X<0||X>=f.inWidth))for(var H=M+L*d[1],Y=V+X*f.inChannels,z=E,K=H,_=0;_<f.inChannels;++_){for(var D=G[Y+_],P=0;P<y;++P)x[z+P]+=D*B[K+P];z+=y,K+=y}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var Oh={kernelName:i.O,backendName:"cpu",kernelFunc:Nh};var Wh={kernelName:i.P,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.dy,s=r.strides,u=r.dilations,c=r.pad,l=r.dimRoundingMode,g=r.filterShape;Og([a,o],"depthwiseConv2dNativeBackpropFilter");for(var d=i.ud.computeConv2DInfo(a.shape,g,s,u,c,l,!0),h=d.strideHeight,f=d.strideWidth,p=d.filterHeight,I=d.filterWidth,C=new i.cd(d.filterShape,"float32"),m=d.padInfo.left,b=d.padInfo.top,v=d.outChannels/d.inChannels,A=n.data.get(a.dataId).values,y=new i.cd(a.shape,a.dtype,A),w=n.data.get(o.dataId).values,G=new i.cd(o.shape,o.dtype,w),B=0;B<p;++B)for(var x=Math.max(0,Math.ceil((b-B)/h)),S=Math.min(d.outHeight,(d.inHeight+b-B)/h),k=0;k<I;++k)for(var Z=Math.max(0,Math.ceil((m-k)/f)),R=Math.min(d.outWidth,(d.inWidth+m-k)/f),N=0;N<d.outChannels;++N){for(var O=Math.trunc(N/v),W=N%v,F=0,M=0;M<d.batchSize;++M)for(var V=x;V<S;++V)for(var T=B+V*h-b,E=Z;E<R;++E){var j=k+E*f-m;F+=y.get(M,T,j,O)*G.get(M,V,E,N)}C.set(F,B,k,O,W)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var Fh={kernelName:i.Q,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,s=t.filter,u=r.strides,c=r.dilations,l=r.pad,g=r.dimRoundingMode,d=r.inputShape;Og([a,s],"depthwiseConv2DNativeBackpropInput");for(var h=i.tf.computeStrides(a.shape),f=i.tf.computeStrides(s.shape),p=i.ud.computeConv2DInfo(d,s.shape,u,c,l,g,!0),I=new i.cd(p.inShape,"float32"),C=I.values,m=Object(o.a)(I.strides,3),b=m[0],v=m[1],A=m[2],y=n.data.get(a.dataId).values,w=Object(o.a)(h,3),G=w[0],B=w[1],x=w[2],S=n.data.get(s.dataId).values,k=Object(o.a)(f,3),Z=k[0],R=k[1],N=k[2],O=p.batchSize,W=p.filterHeight,F=p.filterWidth,M=p.inChannels,V=p.inHeight,T=p.inWidth,E=p.outChannels,j=p.outHeight,L=p.outWidth,X=p.strideHeight,H=p.strideWidth,Y=W-1-p.padInfo.top,z=F-1-p.padInfo.left,K=E/M,_=0;_<O;++_)for(var D=0;D<M;++D)for(var P=0;P<V;++P)for(var U=P-Y,J=Math.max(0,Math.ceil(U/X)),Q=Math.min(j,(W+U)/X),q=0;q<T;++q){for(var $=q-z,ee=Math.max(0,Math.ceil($/H)),te=Math.min(L,(F+$)/H),ne=0,re=J;re<Q;++re)for(var ae=re*X-U,ie=ee;ie<te;++ie)for(var oe=G*_+B*re+x*ie,se=Z*(W-1-ae)+R*(F-1-(ie*H-$))+N*D,ue=0;ue<K;++ue){ne+=y[oe+(D*K+ue)]*S[se+ue]}C[b*_+v*P+A*q+D]=ne}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};var Mh={kernelName:i.R,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=i.tf.sizeFromShape(r.shape),o=n.data.get(r.dataId).values,s=Object(i.zd)([a,a],r.dtype),u=s.values,c=0;c<o.length;c++)u[c*a+c]=o[c];var l=[].concat(Object(Yn.a)(r.shape),Object(Yn.a)(r.shape));return n.makeTensorInfo(l,s.dtype,s.values)}},Vh={kernelName:i.S,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=r.strides,u=r.pad,c=r.dilations,l=n,g=l.data.get(a.dataId).values,d=a.shape.length,h=l.data.get(o.dataId).values,f=o.shape.length,p=i.ud.computeDilation2DInfo(a.shape,o.shape,s,u,"NHWC",c),I=p.batchSize,C=p.inHeight,m=p.inWidth,b=p.inChannels,v=p.outHeight,A=p.outWidth,y=p.padInfo,w=p.strideHeight,G=p.strideWidth,B=p.filterHeight,x=p.filterWidth,S=p.dilationHeight,k=p.dilationWidth,Z=p.outShape,R=i.tf.sizeFromShape(Z),N=Z.length,O=i.tf.getArrayFromDType(a.dtype,R),W=0;W<I;++W)for(var F=0;F<v;++F)for(var M=F*w-y.top,V=0;V<A;++V)for(var T=V*G-y.left,E=0;E<b;++E){for(var j=Number.MIN_SAFE_INTEGER,L=0;L<B;++L){var X=M+L*S;if(X>=0&&X<C)for(var H=0;H<x;++H){var Y=T+H*k;if(Y>=0&&Y<m){var z=i.tf.locToIndex([W,X,Y,E],d,i.tf.computeStrides(a.shape)),K=i.tf.locToIndex([L,H,E],f,i.tf.computeStrides(o.shape)),_=g[z]+h[K];_>j&&(j=_)}}}O[i.tf.locToIndex([W,F,V,E],N,i.tf.computeStrides(Z))]=j}return{dataId:l.write(i.tf.toTypedArray(O,a.dtype),Z,a.dtype),shape:Z,dtype:a.dtype}}},Th={kernelName:i.T,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=t.dy,u=r.strides,c=r.pad,l=r.dilations,g=n,d=i.tf.toNestedArray(a.shape,g.data.get(a.dataId).values),h=i.tf.toNestedArray(o.shape,g.data.get(o.dataId).values),f=i.ud.computeDilation2DInfo(a.shape,o.shape,u,c,"NHWC",l),p=f.batchSize,I=f.inHeight,C=f.inWidth,m=f.inChannels,b=f.outHeight,v=f.outWidth,A=f.padInfo,y=f.strideHeight,w=f.strideWidth,G=f.filterHeight,B=f.filterWidth,x=f.dilationHeight,S=f.dilationWidth,k=f.outShape;i.tf.assert(s.rank===k.length,(function(){return"Error in ".concat(i.T,", dy ")+"must have the same rank as output ".concat(k.length,", but got ")+"".concat(s.rank)}));for(var Z=i.tf.toNestedArray(k,g.data.get(s.dataId).values),R=i.tf.makeZerosNestedTypedArray(o.shape,o.dtype),N=0;N<p;++N)for(var O=0;O<b;++O)for(var W=O*y-A.top,F=0;F<v;++F)for(var M=F*w-A.left,V=0;V<m;++V){for(var T=Number.MIN_SAFE_INTEGER,E=0,j=0,L=0;L<G;++L){var X=W+L*x;if(X>=0&&X<I)for(var H=0;H<B;++H){var Y=M+H*S;if(Y>=0&&Y<C){var z=d[N][X][Y][V]+h[L][H][V];z>T&&(T=z,E=L,j=H)}}}R[E][j][V]+=Z[N][O][F][V]}return{dataId:g.write(i.tf.toTypedArray(R,a.dtype),o.shape,o.dtype),shape:o.shape,dtype:o.dtype}}},Eh={kernelName:i.U,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=t.dy,u=r.strides,c=r.pad,l=r.dilations,g=n,d=i.tf.toNestedArray(a.shape,g.data.get(a.dataId).values),h=i.tf.toNestedArray(o.shape,g.data.get(o.dataId).values),f=i.ud.computeDilation2DInfo(a.shape,o.shape,u,c,"NHWC",l),p=f.batchSize,I=f.inHeight,C=f.inWidth,m=f.inChannels,b=f.outHeight,v=f.outWidth,A=f.padInfo,y=f.strideHeight,w=f.strideWidth,G=f.filterHeight,B=f.filterWidth,x=f.dilationHeight,S=f.dilationWidth,k=f.outShape;i.tf.assert(s.rank===k.length,(function(){return"Error in ".concat(i.U,", dy ")+"must have the same rank as output ".concat(k.length,", but got ")+"".concat(s.rank)}));for(var Z=i.tf.toNestedArray(k,g.data.get(s.dataId).values),R=i.tf.makeZerosNestedTypedArray(a.shape,a.dtype),N=0;N<p;++N)for(var O=0;O<b;++O)for(var W=O*y-A.top,F=0;F<v;++F)for(var M=F*w-A.left,V=0;V<m;++V){for(var T=Number.MIN_SAFE_INTEGER,E=W<0?0:W,j=M<0?0:M,L=0;L<G;++L){var X=W+L*x;if(X>=0&&X<I)for(var H=0;H<B;++H){var Y=M+H*S;if(Y>=0&&Y<C){var z=d[N][X][Y][V]+h[L][H][V];z>T&&(T=z,E=X,j=Y)}}}R[N][E][j][V]+=Z[N][O][F][V]}return{dataId:g.write(i.tf.toTypedArray(R,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},jh=Yg((function(e,t){return e*t})),Lh=ud((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),Xh=sd(i.Vb,jh,Lh),Hh={kernelName:i.Vb,backendName:"cpu",kernelFunc:Xh};function Yh(e){var t,n=e.inputs,r=e.backend,a=e.attrs,s=n.x,u=a.axis,c=a.keepDims;Og(s,"sum");var l=(t="bool"===s.dtype?id({inputs:{x:s},backend:r,attrs:{dtype:"int32"}}):jg({inputs:{x:s},backend:r})).shape.length,g=i.tf.parseAxisParam(u,t.shape),d=i.ud.getAxesPermutation(g,l),h=g,f=t;null!=d&&(f=xd({inputs:{x:t},backend:r,attrs:{perm:d}}),h=i.ud.getInnerMostAxes(h.length,l)),i.ud.assertAxesAreInnerMostDims("sum",h,f.shape.length);for(var p=i.ud.computeOutAndReduceShapes(f.shape,h),I=Object(o.a)(p,2),C=I[0],m=I[1],b=nd(r,C,i.ud.upcastType(f.dtype,"int32")),v=i.tf.sizeFromShape(m),A=r.data.get(b.dataId).values,y=r.data.get(f.dataId).values,w=0;w<A.length;++w){for(var G=w*v,B=0,x=0;x<v;++x)B+=y[G+x];A[w]=B}if(c){var S=b;b=hd({inputs:{x:b},backend:r,attrs:{shape:i.ud.expandShapeToKeepDim(b.shape,g)}}),r.disposeIntermediateTensorInfo(S)}return r.disposeIntermediateTensorInfo(t),null!=d&&r.disposeIntermediateTensorInfo(f),b}var zh={kernelName:i.Yc,backendName:"cpu",kernelFunc:Yh};var Kh={kernelName:i.V,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,a=t,o=i.ud.decodeEinsumEquation(r,a.length),s=o.allDims,u=o.summedDims,c=o.idDims;i.ud.checkEinsumDimSizes(s.length,c,a);for(var l=i.ud.getEinsumComputePath(u,c),g=l.path,d=l.steps,h=d.length,f=null,p=s.length,I=[],C=0;C<h;++C){var m,b=Object(ea.a)(d[C]);try{for(b.s();!(m=b.n()).done;){var v=m.value,A=i.ud.getEinsumPermutation(p,c[v]),y=A.permutationIndices,w=A.expandDims,G=void 0;i.ud.isIdentityPermutation(y)?G=a[v]:(G=xd({inputs:{x:a[v]},backend:n,attrs:{perm:y}}),I.push(G));for(var B=G.shape.slice(),x=0;x<w.length;++x)B.splice(w[x],0,1);i.tf.arraysEqual(G.shape,B)||(G=hd({inputs:{x:G},backend:n,attrs:{shape:B}}),I.push(G)),null===f?f=G:(f=Xh({inputs:{a:G,b:f},backend:n}),I.push(f))}}catch(R){b.e(R)}finally{b.f()}C<h-1&&(g[C]>=0&&(f=Yh({inputs:{x:f},backend:n,attrs:{axis:g[C]-(s.length-p),keepDims:!1}}),I.push(f)),p--)}for(var S=0,k=I;S<k.length;S++){var Z=k[S];Z!==f&&n.disposeIntermediateTensorInfo(Z)}return f}};var _h={kernelName:i.X,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;Og([r,a],"eluGrad");for(var o=new Float32Array(i.tf.sizeFromShape(a.shape)),s=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=0;c<s.length;++c){var l=s[c];o[c]=l>=1?u[c]:u[c]*(l+1)}return n.makeTensorInfo(a.shape,"float32",o)}},Dh=Yg((function(e,t){return e===t?1:0})),Ph=sd(i.Y,Dh,null,"bool"),Uh={kernelName:i.Y,backendName:"cpu",kernelFunc:Ph},Jh=i.ud.ERF_P,Qh=i.ud.ERF_A1,qh=i.ud.ERF_A2,$h=i.ud.ERF_A3,ef=i.ud.ERF_A4,tf=i.ud.ERF_A5,nf=Mg(i.Z,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+Jh*n);return t*(1-((((tf*r+ef)*r+$h)*r+qh)*r+Qh)*r*Math.exp(-n*n))})),rf={kernelName:i.Z,backendName:"cpu",kernelFunc:nf},af=ah((function(e){return Math.exp(e)})),of=Vg(i.ab,af),sf={kernelName:i.ab,backendName:"cpu",kernelFunc:of};function uf(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,o=r.dim,s=a.shape.length,u=a.shape.slice(),c=o;return o<0&&(i.tf.assert(-(s+1)<=o,(function(){return"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")})),c=s+o+1),u.splice(c,0,1),hd({inputs:{x:a},backend:n,attrs:{shape:u}})}var cf={kernelName:i.bb,backendName:"cpu",kernelFunc:uf},lf=ah((function(e){return Math.expm1(e)})),gf=Vg(i.cb,lf),df={kernelName:i.cb,backendName:"cpu",kernelFunc:gf},hf=Yg((function(e,t){return e/t})),ff=sd(i.lc,hf),pf={kernelName:i.lc,backendName:"cpu",kernelFunc:ff},If=Yg((function(e,t){return e-t})),Cf=ud((function(e,t,n,r){return{real:e-n,imag:t-r}})),mf=sd(i.Xc,If,Cf),bf={kernelName:i.Xc,backendName:"cpu",kernelFunc:mf};function vf(e,t,n){for(var r=e.shape,a=r[0],o=r[1],s=n.data.get(e.dataId),u=s.complexTensorInfos.real,c=s.complexTensorInfos.imag,l=[a,o],g=i.tf.sizeFromShape(l),d=i.tf.getTypedArrayFromDType("float32",g),h=i.tf.getTypedArrayFromDType("float32",g),f=0;f<a;f++){for(var p=qd({inputs:{x:u},backend:n,attrs:{begin:[f,0],size:[1,o]}}),I=qd({inputs:{x:c},backend:n,attrs:{begin:[f,0],size:[1,o]}}),C=ed({inputs:{real:p,imag:I},backend:n}),m=Af(C,t,n),b=m.real,v=m.imag,A=i.ud.mergeRealAndImagArrays(b,v),y=0;y<o;y++){var w=i.ud.getComplexWithIndex(A,y);d[f*o+y]=w.real,h[f*o+y]=w.imag}n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(C)}var G=n.makeTensorInfo(l,"float32",d),B=n.makeTensorInfo(l,"float32",h),x=ed({inputs:{real:G,imag:B},backend:n});return n.disposeIntermediateTensorInfo(G),n.disposeIntermediateTensorInfo(B),x}function Af(e,t,n){var r=i.tf.sizeFromShape(e.shape),a=n.data.get(e.dataId),o=n.data.get(a.complexTensorInfos.real.dataId).values,s=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((m=r)&m-1)){var u=yf(o,s,r,t,n),c=[e.shape[0],e.shape[1]];if(t){var l=n.makeTensorInfo(c,"float32",u.real),g=n.makeTensorInfo(c,"float32",u.imag),d=n.makeTensorInfo([],"float32",i.tf.createScalarValue(r,"float32")),h=jg({inputs:{x:d},backend:n}),f=pf.kernelFunc({inputs:{a:l,b:d},backend:n}),p=pf.kernelFunc({inputs:{a:g,b:h},backend:n}),I=n.data.get(f.dataId).values,C=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:I,imag:C}}return u}var m,b=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var o=0,s=0,u=0;u<t;u++){var c=i.ud.exponent(a*u,t,n),l=i.ud.getComplexWithIndex(e,u);o+=l.real*c.real-l.imag*c.imag,s+=l.real*c.imag+l.imag*c.real}n&&(o/=t,s/=t),i.ud.assignToTypedArray(r,o,s,a)}return r}(i.ud.mergeRealAndImagArrays(o,s),r,t);return i.ud.splitRealAndImagArrays(b)}function yf(e,t,n,r,a){if(1===n)return{real:e,imag:t};var o=i.ud.mergeRealAndImagArrays(e,t),s=n/2,u=i.ud.complexWithEvenIndex(o),c=u.real,l=u.imag,g=[c.length],d=a.makeTensorInfo(g,"float32",c),h=a.makeTensorInfo(g,"float32",l),f=ed({inputs:{real:d,imag:h},backend:a}),p=i.ud.complexWithOddIndex(o),I=p.real,C=p.imag,m=[I.length],b=a.makeTensorInfo(m,"float32",I),v=a.makeTensorInfo(m,"float32",C),A=ed({inputs:{real:b,imag:v},backend:a}),y=yf(c,l,s,r,a),w=y.real,G=y.imag,B=[w.length],x=a.makeTensorInfo(B,"float32",w),S=a.makeTensorInfo(B,"float32",G),k=ed({inputs:{real:x,imag:S},backend:a}),Z=yf(I,C,s,r,a),R=Z.real,N=Z.imag,O=[R.length],W=a.makeTensorInfo(O,"float32",R),F=a.makeTensorInfo(O,"float32",N),M=ed({inputs:{real:W,imag:F},backend:a}),V=i.ud.exponents(n,r),T=[V.real.length],E=a.makeTensorInfo(T,"float32",V.real),j=a.makeTensorInfo(T,"float32",V.imag),L=ed({inputs:{real:E,imag:j},backend:a}),X=Xh({inputs:{a:L,b:M},backend:a}),H=gd({inputs:{a:k,b:X},backend:a}),Y=mf({inputs:{a:k,b:X},backend:a}),z=rd({inputs:{input:H},backend:a}),K=rd({inputs:{input:Y},backend:a}),_=dh({inputs:{input:H},backend:a}),D=dh({inputs:{input:Y},backend:a}),P=fh({inputs:[z,K],backend:a,attrs:{axis:0}}),U=fh({inputs:[_,D],backend:a,attrs:{axis:0}}),J=a.data.get(P.dataId).values,Q=a.data.get(U.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(k),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(U),{real:J,imag:Q}}var wf={kernelName:i.db,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=i.tf.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],s=hd({inputs:{x:r},backend:n,attrs:{shape:[a/o,o]}}),u=vf(s,!1,n),c=hd({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),c}};function Gf(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,o=n.dtype||i.tf.inferDtype(a),s=i.tf.getArrayFromDType(o,i.tf.sizeFromShape(r));return function(e,t,n){e.fill(t)}(s,a),t.makeTensorInfo(r,o,s)}var Bf={kernelName:i.eb,backendName:"cpu",kernelFunc:Gf};var xf={kernelName:i.fb,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,s=i.tf.getTypedArrayFromDType(r.dtype,i.tf.sizeFromShape(r.shape)),u=Object(o.a)(r.shape,4),c=u[0],l=u[1],g=u[2],d=u[3],h=a.data.get(r.dataId).values,f=0;f<c;f++)for(var p=f*g*l*d,I=0;I<l;I++)for(var C=I*(g*d),m=0;m<g;m++)for(var b=m*d,v=0;v<d;v++){var A=[c,I,m,v][2],y=Math.round(g-A),w=p+C+b+v,G=h[w];if(y>=0&&y<g)G=h[p+C+y*d+v];s[w]=G}return{dataId:a.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Sf=ah((function(e){return Math.floor(e)})),kf=Vg(i.gb,Sf),Zf={kernelName:i.gb,backendName:"cpu",kernelFunc:kf},Rf=Yg((function(e,t){return Math.floor(e/t)})),Nf=sd(i.hb,Rf,null,"int32"),Of={kernelName:i.hb,backendName:"cpu",kernelFunc:Nf};var Wf={kernelName:i.kb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,g=r.dilations,d=r.dimRoundingMode,h=r.activation,f=r.leakyreluAlpha,p=Ih({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:g,dimRoundingMode:d}});if(o){var I=p;p=gd({inputs:{a:p,b:o},backend:n}),n.disposeIntermediateTensorInfo(I)}if(h){var C=p;p=$g(n,p,h,s,f),n.disposeIntermediateTensorInfo(C)}return p}};var Ff={kernelName:i.lb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,s=t.preluActivationWeights,u=r.strides,c=r.pad,l=r.dataFormat,g=r.dilations,d=r.dimRoundingMode,h=r.activation,f=r.leakyreluAlpha,p=Nh({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:g,dimRoundingMode:d}});if(o){var I=p;p=gd({inputs:{a:p,b:o},backend:n}),n.disposeIntermediateTensorInfo(I)}if(h){var C=p;p=$g(n,p,h,s,f),n.disposeIntermediateTensorInfo(C)}return p}};function Mf(e,t,n,r,a,o,s,u,c){for(var l=Object(i.zd)([r,o],n),g=0;g<r;g++){for(var d=[],h=0,f=0;f<a;f++){var p=e[g*a+f];h+=p*s[f],d.push(p)}if(h<0||h>=c/o)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(u));for(var I=0;I<o;I++)l.values[g*o+I]=t.get.apply(t,Object(Yn.a)(t.indexToLoc(h*o+I)))}return l}var Vf={kernelName:i.mb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,s=i.tf.sizeFromShape(r.shape),u=a.shape,c=u[u.length-1],l=i.ud.prepareAndValidate(r,a),g=Object(o.a)(l,4),d=g[0],h=g[1],f=g[2],p=g[3];if(0===h)return n.makeTensorInfo(d,r.dtype,[]);var I=Mf(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,h,c,f,p,r.shape,s);return n.makeTensorInfo(d,r.dtype,I.values)}};function Tf(e,t,n){for(var r=Object(i.zd)(n,e.dtype),a=0;a<r.size;++a){var o=r.indexToLoc(a).slice(),s=o[0],u=o[2],c=t.locToIndex([s,u]);o[2]=t.values[c];var l=e.locToIndex(o);r.values[a]=e.values[l]}return r}var Ef={kernelName:i.nb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.indices,s=r.axis,u=r.batchDims;Og([a,o],"gatherV2");var c=u;null==u&&(c=0);var l=i.tf.sizeFromShape(o.shape),g=i.tf.parseAxisParam(s,a.shape)[0],d=i.ud.segment_util.collectGatherOpShapeInfo(a,o,g,c),h=hd({inputs:{x:a},backend:n,attrs:{shape:[d.batchSize,d.outerSize,d.dimSize,d.sliceSize]}}),f=hd({inputs:{x:o},backend:n,attrs:{shape:[d.batchSize,l/d.batchSize]}}),p=[d.batchSize,d.outerSize,l/d.batchSize,d.sliceSize],I=n.bufferSync(f),C=Tf(n.bufferSync(h),I,p);return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.makeTensorInfo(d.outputShape,C.dtype,C.values)}},jf=Yg((function(e,t){return e>t?1:0})),Lf=sd(i.ob,jf,null,"bool"),Xf={kernelName:i.ob,backendName:"cpu",kernelFunc:Lf},Hf=Yg((function(e,t){return e>=t?1:0})),Yf=sd(i.pb,Hf,null,"bool"),zf={kernelName:i.pb,backendName:"cpu",kernelFunc:Yf};var Kf={kernelName:i.qb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=i.tf.sizeFromShape(r.shape),o=r.shape[r.shape.length-1],s=hd({inputs:{x:r},backend:n,attrs:{shape:[a/o,o]}}),u=vf(s,!0,n),c=hd({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),c}},_f=Mg(i.tb,(function(e){return Number.isFinite(e)?1:0}),"bool"),Df={kernelName:i.tb,backendName:"cpu",kernelFunc:_f},Pf=Mg(i.ub,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),Uf={kernelName:i.ub,backendName:"cpu",kernelFunc:Pf},Jf=Mg(i.vb,(function(e){return Number.isNaN(e)?1:0}),"bool"),Qf={kernelName:i.vb,backendName:"cpu",kernelFunc:Jf},qf=Yg((function(e,t){return e<t?1:0})),$f=sd(i.Ab,qf,null,"bool"),ep={kernelName:i.Ab,backendName:"cpu",kernelFunc:$f},tp=Yg((function(e,t){return e<=t?1:0})),np=sd(i.Bb,tp,null,"bool"),rp={kernelName:i.Bb,backendName:"cpu",kernelFunc:np};function ap(e,t,n){var r=(t-e)/(n-1),a=i.tf.makeZerosTypedArray(n,"float32");a[0]=e;for(var o=1;o<a.length;o++)a[o]=a[o-1]+r;return a}var ip={kernelName:i.Cb,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=ap(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},op=ah((function(e){return Math.log(e)})),sp=Vg(i.Db,op),up={kernelName:i.Db,backendName:"cpu",kernelFunc:sp},cp=Mg(i.Eb,(function(e){return Math.log1p(e)})),lp={kernelName:i.Eb,backendName:"cpu",kernelFunc:cp},gp=Yg((function(e,t){return e&&t})),dp=sd(i.Fb,gp,null,"bool"),hp={kernelName:i.Fb,backendName:"cpu",kernelFunc:dp},fp=Mg(i.Gb,(function(e){return e?0:1}),"bool"),pp={kernelName:i.Gb,backendName:"cpu",kernelFunc:fp},Ip=Yg((function(e,t){return e||t})),Cp=sd(i.Hb,Ip,null,"bool"),mp={kernelName:i.Hb,backendName:"cpu",kernelFunc:Cp};var bp={kernelName:i.xb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.depthRadius,s=r.bias,u=r.alpha,c=r.beta;Og(a,"LRN");var l=a.shape[3],g=l-1,d=n.data.get(a.dataId).values,h=i.tf.sizeFromShape(a.shape),f=new Float32Array(h);function p(e){for(var t=e%l,n=e-t+Math.max(0,t-o),r=e-t+Math.min(t+o,g),a=0;n<=r;n++){var i=d[n];a+=i*i}return a}for(var I=0;I<h;I++){var C=p(I),m=d[I]*Math.pow(s+u*C,-c);f[I]=m}return n.makeTensorInfo(a.shape,a.dtype,f)}};var vp={kernelName:i.yb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.y,s=t.dy,u=r.depthRadius,c=r.bias,l=r.alpha,g=r.beta;Og(s,"LRNGrad");for(var d=i.tf.sizeFromShape(s.shape),h=s.shape[3],f=n.data.get(s.dataId).values,p=n.data.get(a.dataId).values,I=n.data.get(o.dataId).values,C=new Float32Array(d),m=d,b=0;b<m;b++){for(var v=b%h,A=b-v+Math.max(0,v-u),y=b-v+Math.min(h,v+u+1),w=0,G=A;G<y;G++)w+=Math.pow(p[G],2);w=l*w+c;for(var B=A;B<y;B++){var x=-2*l*g*p[B]*I[b]/w;b===B&&(x+=Math.pow(w,-g)),x*=f[b],C[B]+=x}}return n.makeTensorInfo(s.shape,a.dtype,C)}};function Ap(e,t,n,r){for(var a=i.tf.getTypedArrayFromDType(r,i.tf.sizeFromShape(n)),o=0;o<a.length;++o){for(var s=o*t,u=e[s],c=0;c<t;++c){var l=e[s+c];(Number.isNaN(l)||l>u)&&(u=l)}a[o]=u}return a}function yp(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.reductionIndices,u=r.keepDims,c=n,l=a.shape,g=l.length,d=i.tf.parseAxisParam(s,l),h=d,f=i.ud.getAxesPermutation(h,g),p=c.data.get(a.dataId).values;if(null!=f){for(var I=new Array(g),C=0;C<I.length;C++)I[C]=l[f[C]];p=Bd(p,l,a.dtype,f,I),h=i.ud.getInnerMostAxes(h.length,g),l=I}Og(a,"max"),i.ud.assertAxesAreInnerMostDims("max",h,g);var m=i.ud.computeOutAndReduceShapes(l,h),b=Object(o.a)(m,2),v=b[0],A=b[1],y=Ap(p,i.tf.sizeFromShape(A),v,a.dtype),w=c.write(y,v,a.dtype),G=v;u&&(G=i.ud.expandShapeToKeepDim(v,d));return{dataId:w,shape:G,dtype:a.dtype}}var wp={kernelName:i.Ib,backendName:"cpu",kernelFunc:yp},Gp=Yg((function(e,t){return Math.max(e,t)})),Bp=sd(i.Ob,Gp),xp={kernelName:i.Ob,backendName:"cpu",kernelFunc:Bp};var Sp={kernelName:i.Jb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Og(a,"maxPool");var o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l,g=i.ud.computePool2DInfo(a.shape,o,s,1,u,c);if(1===g.filterWidth&&1===g.filterHeight&&i.tf.arraysEqual(g.inShape,g.outShape))l=jg({inputs:{x:a},backend:n});else{var d=n.data.get(a.dataId).values,h=i.tf.computeStrides(a.shape),f=Yd(d,a.shape,a.dtype,h,g,"max");l=n.makeTensorInfo(g.outShape,a.dtype,f.values)}return l}};var kp={kernelName:i.Kb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=r.dataFormat;Og(a,"maxPool3d");var g=i.ud.computePool3DInfo(a.shape,o,s,1,u,c,l),d=Kd(n.data.get(a.dataId).values,a.shape,a.dtype,i.tf.computeStrides(a.shape),g,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}};var Zp={kernelName:i.Lb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode;Og([a,o],"maxPool3DGrad");for(var g=i.ud.computePool3DInfo(o.shape,s,u,1,c,l),d=function(e,t){for(var n=Object(i.zd)(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,g=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.front,f=t.padInfo.top,p=t.padInfo.left,I=0;I<t.batchSize;++I)for(var C=0;C<t.inChannels;++C)for(var m=0;m<t.outDepth;++m){for(var b=m*r-h,v=b;v<0;)v+=s;for(var A=Math.min(t.inDepth,l+b),y=0;y<t.outHeight;++y){for(var w=y*a-f,G=w;G<0;)G+=u;for(var B=Math.min(t.inHeight,g+w),x=0;x<t.outWidth;++x){for(var S=x*o-p,k=S;k<0;)k+=c;for(var Z=Math.min(t.inWidth,d+S),R=Number.NEGATIVE_INFINITY,N=-1,O=v;O<A;O+=s)for(var W=O-b,F=G;F<B;F+=u)for(var M=F-w,V=k;V<Z;V+=c){var T=V-S,E=e.get(I,O,F,V,C);E>=R&&(R=E,N=W*g*d+M*g+T)}n.set(N,I,m,y,x,C)}}}return n}(n.bufferSync(o),g),h=g.strideDepth,f=g.strideHeight,p=g.strideWidth,I=g.dilationDepth,C=g.dilationHeight,m=g.dilationWidth,b=g.effectiveFilterDepth,v=g.effectiveFilterHeight,A=g.effectiveFilterWidth,y=b-1-g.padInfo.front,w=A-1-g.padInfo.left,G=v-1-g.padInfo.top,B=Object(i.zd)(o.shape,"float32"),x=n.bufferSync(a),S=0;S<g.batchSize;++S)for(var k=0;k<g.inChannels;++k)for(var Z=0;Z<g.inDepth;++Z)for(var R=0;R<g.inHeight;++R)for(var N=0;N<g.inWidth;++N){for(var O=Z-y,W=R-G,F=N-w,M=0,V=0;V<b;V+=I){var T=(O+V)/h;if(!(T<0||T>=g.outDepth||Math.floor(T)!==T))for(var E=0;E<v;E+=C){var j=(W+E)/f;if(!(j<0||j>=g.outHeight||Math.floor(j)!==j))for(var L=0;L<A;L+=m){var X=(F+L)/p;if(!(X<0||X>=g.outWidth||Math.floor(X)!==X)){var H=b*v*A-1-d.get(S,T,j,X,k)===V*v*A+E*A+L?1:0;if(0!==H)M+=x.get(S,T,j,X,k)*H}}}}B.set(M,S,Z,R,N,k)}return n.makeTensorInfo(B.shape,B.dtype,B.values)}};var Rp={kernelName:i.Mb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=o;Og([o,t.output],"maxPoolGrad");for(var u=r.filterSize,c=r.strides,l=r.pad,g=r.dimRoundingMode,d=i.ud.computePool2DInfo(s.shape,u,c,1,l,g),h=n.data.get(s.dataId).values,f=Object(i.zd)(d.outShape,s.dtype,zd(h,s.shape,s.dtype,d).values),p=d.strideHeight,I=d.strideWidth,C=d.dilationHeight,m=d.dilationWidth,b=d.effectiveFilterHeight,v=d.effectiveFilterWidth,A=v-1-d.padInfo.left,y=b-1-d.padInfo.top,w=Object(i.zd)(s.shape,"float32"),G=n.data.get(a.dataId).values,B=Object(i.zd)(a.shape,"float32",G),x=0;x<d.batchSize;++x)for(var S=0;S<d.inChannels;++S)for(var k=0;k<d.inHeight;++k)for(var Z=0;Z<d.inWidth;++Z){for(var R=k-y,N=Z-A,O=0,W=0;W<b;W+=C){var F=(R+W)/p;if(!(F<0||F>=d.outHeight||Math.floor(F)!==F))for(var M=0;M<v;M+=m){var V=(N+M)/I;if(!(V<0||V>=d.outWidth||Math.floor(V)!==V)){var T=b*v-1-f.get(x,F,V,S)===W*v+M?1:0;if(0!==T)O+=B.get(x,F,V,S)*T}}}w.set(O,x,k,Z,S)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var Np={kernelName:i.Nb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,s=n.filterSize,u=n.strides,c=n.pad,l=n.includeBatchInIndex,g=r;Og(a,"MaxPoolWithArgmax");var d=g.data.get(a.dataId).values,h=i.ud.computePool2DInfo(a.shape,s,u,[1,1],c),f=function(e,t,n,r,a){var o=Yd(e,0,n,i.tf.computeStrides(t),a,"max"),s=zd(e,t,n,a,!0,r);return[o.values,s.values]}(d,a.shape,a.dtype,l,h),p=Object(o.a)(f,2),I=p[0],C=p[1],m=g.write(I,h.outShape,a.dtype),b=g.write(C,h.outShape,a.dtype);return[{dataId:m,shape:h.outShape,dtype:a.dtype},{dataId:b,shape:h.outShape,dtype:"int32"}]}};var Op={kernelName:i.Pb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,s=r.keepDims,u=i.tf.parseAxisParam(o,a.shape),c=i.ud.computeOutAndReduceShapes(a.shape,u)[1],l=i.tf.sizeFromShape(c),g=[],d=n.makeTensorInfo([],"float32",new Float32Array([l]));g.push(d);var h=id({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});g.push(h);var f=ff({inputs:{a:h,b:d},backend:n});g.push(f);var p=Yh({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:s}});return g.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),p}};var Wp={kernelName:i.Qb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis,u=r.keepDims;Og(a,"min");var c=i.tf.parseAxisParam(s,a.shape),l=c,g=i.ud.getAxesPermutation(l,a.shape.length),d=a;null!=g&&(d=xd({inputs:{x:a},backend:n,attrs:{perm:g}}),l=i.ud.getInnerMostAxes(l.length,a.shape.length)),i.ud.assertAxesAreInnerMostDims("min",l,d.shape.length);for(var h=i.ud.computeOutAndReduceShapes(d.shape,l),f=Object(o.a)(h,2),p=f[0],I=f[1],C=i.tf.sizeFromShape(I),m=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(p),d.dtype),b=n.data.get(d.dataId).values,v=0;v<m.length;++v){for(var A=v*C,y=b[A],w=0;w<C;++w){var G=b[A+w];(Number.isNaN(G)||G<y)&&(y=G)}m[v]=y}null!=g&&n.disposeIntermediateTensorInfo(d);var B=n.makeTensorInfo(p,d.dtype,m);if(u){var x=hd({inputs:{x:B},backend:n,attrs:{shape:i.ud.expandShapeToKeepDim(p,c)}});return n.disposeIntermediateTensorInfo(B),x}return B}},Fp=Yg((function(e,t){return Math.min(e,t)})),Mp=sd(i.Rb,Fp),Vp={kernelName:i.Rb,backendName:"cpu",kernelFunc:Mp};var Tp={kernelName:i.Sb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.paddings,s=r.mode;Og(a,"mirrorPad");for(var u=o.map((function(e,t){return e[0]+a.shape[t]+e[1]})),c=o.map((function(e){return e[0]})),l=o.map((function(e,t){return e[0]+a.shape[t]})),g="reflect"===s?0:1,d=n.data.get(a.dataId).values,h=a.shape.length,f=i.tf.computeStrides(a.shape),p=i.tf.sizeFromShape(u),I=u.length,C=i.tf.computeStrides(u),m=i.tf.getTypedArrayFromDType(a.dtype,p),b=0;b<p;b++){for(var v=i.tf.indexToLoc(b,I,C),A=0;A<I;A++)v[A]<c[A]?v[A]=2*c[A]-v[A]-g:v[A]>=l[A]&&(v[A]=2*(l[A]-1)-v[A]+g);v=v.map((function(e,t){return e-c[t]}));var y=i.tf.locToIndex(v,h,f);m[b]=d[y]}return{dataId:n.write(m,u,a.dtype),shape:u,dtype:a.dtype}}},Ep=Yg((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),jp=sd(i.Tb,Ep),Lp={kernelName:i.Tb,backendName:"cpu",kernelFunc:jp};function Xp(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,o=r.dim,s=a.shape.length,u=o;if(-1===u&&(u=s-1),u!==s-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(s," and dim was ").concat(u));var c=i.tf.parseAxisParam([u],a.shape),l=yp({inputs:{x:a},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),g=i.ud.expandShapeToKeepDim(l.shape,c),d=hd({inputs:{x:l},backend:n,attrs:{shape:g}}),h=mf({inputs:{a:a,b:d},backend:n}),f=of({inputs:{x:h},backend:n}),p=Yh({inputs:{x:f},backend:n,attrs:{axis:c,keepDims:!1}}),I=hd({inputs:{x:p},backend:n,attrs:{shape:g}}),C=ff({inputs:{a:f,b:I},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(I),C}var Hp={kernelName:i.Gc,backendName:"cpu",kernelFunc:Xp};var Yp={kernelName:i.Ub,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,o=r.numSamples,s=r.seed,u=r.normalized;Og(a,"multinomial");for(var c=u?a:Xp({inputs:{logits:a},backend:n,attrs:{dim:-1}}),l=c.shape[0],g=c.shape[1],d=n.data.get(c.dataId).values,h=[l,o],f=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(h),"int32"),p=0;p<l;++p){var I=p*g,C=new Float32Array(g-1);C[0]=d[I];for(var m=1;m<C.length;++m)C[m]=C[m-1]+d[I+m];for(var b=xg.alea(s.toString()),v=p*o,A=0;A<o;++A){var y=b();f[v+A]=C.length;for(var w=0;w<C.length;w++)if(y<C[w]){f[v+A]=w;break}}}return u||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(h,"int32",f)}};function zp(e,t,n){var r=i.tf.createScalarValue(-1,n);return jh([],t,r,e,n)}var Kp={kernelName:i.Wb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;Og(r,"neg");var a=zp(n.data.get(r.dataId).values,r.shape,r.dtype),i=Object(o.a)(a,2),s=i[0],u=i[1];return n.makeTensorInfo(u,r.dtype,s)}},_p=i.he.nonMaxSuppressionV3Impl;var Dp={kernelName:i.Xb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold;Og(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,g=_p(c,l,o,s,u).selectedIndices;return n.makeTensorInfo([g.length],"int32",new Int32Array(g))}},Pp=i.he.nonMaxSuppressionV4Impl;var Up={kernelName:i.Yb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.padToMaxOutputSize;Og(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,g=n.data.get(i.dataId).values,d=Pp(l,g,o,s,u,c),h=d.selectedIndices,f=d.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},Jp=i.he.nonMaxSuppressionV5Impl;var Qp={kernelName:i.Zb,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma;Og(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,g=n.data.get(i.dataId).values,d=Jp(l,g,o,s,u,c),h=d.selectedIndices,f=d.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([f.length],"float32",new Float32Array(f))]}},qp=Yg((function(e,t){return e!==t?1:0})),$p=sd(i.ac,qp,null,"bool"),eI={kernelName:i.ac,backendName:"cpu",kernelFunc:$p};var tI={kernelName:i.bc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,o=r.depth,s=r.onValue,u=r.offValue;Og(a,"oneHot");var c=i.tf.sizeFromShape(a.shape),l=new Float32Array(c*o);l.fill(u);for(var g=n.data.get(a.dataId).values,d=0;d<c;++d)g[d]>=0&&g[d]<o&&(l[d*o+g[d]]=s);return n.makeTensorInfo([].concat(Object(Yn.a)(a.shape),[o]),"int32",l)}};function nI(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=rd({inputs:{input:r},backend:n}),i=nI({inputs:{x:a},backend:n}),o=dh({inputs:{input:r},backend:n}),s=nI({inputs:{x:o},backend:n}),u=ed({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return Gf({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var rI={kernelName:i.kd,backendName:"cpu",kernelFunc:nI};var aI={kernelName:i.cc,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=rd({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=dh({inputs:{input:a},backend:r}),u=nI({inputs:{x:s},backend:r}),c=ed({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return Gf({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function iI(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return uf({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,o=t[0].dtype;t.forEach((function(e){i.tf.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),i.tf.assert(o===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=[],u=fh({inputs:t.map((function(e){var t=uf({inputs:{input:e},backend:n,attrs:{dim:r}});return s.push(t),t})),backend:n,attrs:{axis:r}});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}var oI={kernelName:i.ec,backendName:"cpu",kernelFunc:iI};var sI={kernelName:i.fc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.paddings,s=r.constantValue;Og(a,"pad");var u=o.map((function(e,t){return e[0]+a.shape[t]+e[1]})),c=o.map((function(e){return e[0]})),l=n.data.get(a.dataId).values,g=i.tf.sizeFromShape(a.shape),d=a.shape.length,h=i.tf.computeStrides(a.shape),f=i.tf.sizeFromShape(u),p=u.length,I=i.tf.computeStrides(u),C=i.tf.getTypedArrayFromDType(a.dtype,f);0!==s&&C.fill(s);for(var m=0;m<g;m++){var b=i.tf.indexToLoc(m,d,h).map((function(e,t){return e+c[t]}));C[i.tf.locToIndex(b,p,I)]=l[m]}return{dataId:n.write(C,u,a.dtype),shape:u,dtype:a.dtype}}},uI=Yg((function(e,t){return Math.pow(e,t)})),cI=sd(i.gc,uI),lI={kernelName:i.gc,backendName:"cpu",kernelFunc:cI};function gI(e,t,n,r){for(var a=i.ud.computeOutAndReduceShapes(e,r),s=Object(o.a)(a,2),u=s[0],c=s[1],l=Object(i.sf)(t,"int32"),g=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(u),l),d=i.tf.sizeFromShape(c),h=0;h<g.length;++h){for(var f=h*d,p=1,I=0;I<d;++I)p*=n[f+I];g[h]=p}return{outVals:g,outShape:u,outDtype:l}}var dI={kernelName:i.ic,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,s=r.keepDims;Og(a,"prod");var u=a.shape.length,c=i.tf.parseAxisParam(o,a.shape),l=i.ud.getAxesPermutation(c,u),g=c,d=a,h=[];null!=l&&(d=xd({inputs:{x:a},backend:n,attrs:{perm:l}}),h.push(d),g=i.ud.getInnerMostAxes(g.length,u));var f=n.data.get(d.dataId).values,p=gI(d.shape,d.dtype,f,g),I=p.outVals,C=p.outShape,m=p.outDtype,b=C;return s&&(b=i.ud.expandShapeToKeepDim(C,c)),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(b,m,I)}};function hI(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return i.tf.makeZerosTypedArray(0,r);var a=Math.abs(Math.ceil((t-e)/n)),o=i.tf.makeZerosTypedArray(a,r);t<e&&1===n&&(n=-1),o[0]=e;for(var s=1;s<o.length;s++)o[s]=o[s-1]+n;return o}var fI={kernelName:i.jc,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=hI(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},pI=Mg(i.mc,(function(e){return 1/e})),II={kernelName:i.mc,backendName:"cpu",kernelFunc:pI};var CI={kernelName:i.qc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,s=r.alignCorners,u=r.halfPixelCenters,c=r.size;Og(a,"resizeBilinear");for(var l=i.tf.computeStrides(a.shape),g=Object(o.a)(c,2),d=g[0],h=g[1],f=Object(o.a)(a.shape,4),p=f[0],I=f[1],C=f[2],m=f[3],b=n.data.get(a.dataId).values,v=new Float32Array(i.tf.sizeFromShape([p,d,h,m])),A=[s&&d>1?I-1:I,s&&h>1?C-1:C],y=[s&&d>1?d-1:d,s&&h>1?h-1:h],w=0,G=A[0]/y[0],B=A[1]/y[1],x=0;x<p;x++)for(var S=0;S<d;S++){var k=void 0;k=u?G*(S+.5)-.5:G*S;for(var Z=Math.max(0,Math.floor(k)),R=k-Z,N=Math.min(I-1,Math.ceil(k)),O=x*l[0]+Z*l[1],W=x*l[0]+N*l[1],F=0;F<h;F++){var M=void 0;M=u?B*(F+.5)-.5:B*F;for(var V=Math.max(0,Math.floor(M)),T=M-V,E=Math.min(C-1,Math.ceil(M)),j=O+V*l[2],L=W+V*l[2],X=O+E*l[2],H=W+E*l[2],Y=0;Y<m;Y++){var z=b[j+Y],K=b[L+Y],_=z+(b[X+Y]-z)*T,D=_+(K+(b[H+Y]-K)*T-_)*R;v[w++]=D}}}return n.makeTensorInfo([p,d,h,m],"float32",v)}};var mI={kernelName:i.rc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,s=t.dy,u=r.alignCorners;Og([s,a],"resizeBilinearGrad");for(var c=i.tf.computeStrides(a.shape),l=Object(o.a)(a.shape,4),g=l[0],d=l[1],h=l[2],f=l[3],p=Object(o.a)(s.shape,3),I=p[1],C=p[2],m=new Float32Array(g*d*h*f),b=[u&&I>1?d-1:d,u&&C>1?h-1:h],v=[u&&I>1?I-1:I,u&&C>1?C-1:C],A=b[0]/v[0],y=b[1]/v[1],w=n.data.get(s.dataId).values,G=0,B=0;B<g;B++)for(var x=B*c[0],S=0;S<I;S++)for(var k=S*A,Z=Math.floor(k),R=Math.min(Math.ceil(k),d-1),N=x+Z*c[1],O=x+R*c[1],W=k-Z,F=1-W,M=0;M<C;M++)for(var V=M*y,T=Math.floor(V),E=Math.min(Math.ceil(V),h-1),j=V-T,L=1-j,X=N+T*c[2],H=N+E*c[2],Y=O+T*c[2],z=O+E*c[2],K=F*L,_=F*j,D=W*L,P=W*j,U=0;U<f;U++){var J=w[G++];m[X+U]+=J*K,m[H+U]+=J*_,m[Y+U]+=J*D,m[z+U]+=J*P}return n.makeTensorInfo([g,h,d,f],"float32",m)}};var bI={kernelName:i.sc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,s=r.alignCorners,u=r.halfPixelCenters,c=r.size;Og(a,"resizeNearestNeighbor");for(var l=i.tf.computeStrides(a.shape),g=Object(o.a)(c,2),d=g[0],h=g[1],f=Object(o.a)(a.shape,4),p=f[0],I=f[1],C=f[2],m=f[3],b=n.data.get(a.dataId).values,v=new Float32Array(p*d*h*m),A=[s&&d>1?I-1:I,s&&h>1?C-1:C],y=[s&&d>1?d-1:d,s&&h>1?h-1:h],w=A[0]/y[0],G=A[1]/y[1],B=0,x=0;x<p;x++)for(var S=x*l[0],k=0;k<d;k++){var Z=u?w*(k+.5):w*k,R=Math.min(I-1,s?Math.round(Z):Math.floor(Z));u&&(R=Math.max(0,R));for(var N=S+R*l[1],O=0;O<h;O++){var W=u?G*(O+.5):G*O,F=Math.min(C-1,s?Math.round(W):Math.floor(W));u&&(F=Math.max(0,F));for(var M=N+F*l[2],V=0;V<m;V++){var T=b[M+V];v[B++]=T}}}return n.makeTensorInfo([p,d,h,m],a.dtype,v)}};var vI={kernelName:i.tc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,s=t.dy,u=r.alignCorners;Og([s,a],"resizeNearestNeighborGrad");for(var c=i.tf.computeStrides(a.shape),l=i.tf.computeStrides(s.shape),g=Object(o.a)(a.shape,4),d=g[0],h=g[1],f=g[2],p=g[3],I=Object(o.a)(s.shape,3),C=I[1],m=I[2],b=new Float32Array(d*h*f*p),v=n.data.get(s.dataId).values,A=[u&&C>1?h-1:h,u&&m>1?f-1:f],y=[u&&C>1?C-1:C,u&&m>1?m-1:m],w=A[0]/y[0],G=A[1]/y[1],B=1/w,x=1/G,S=2*Math.ceil(B)+2,k=2*Math.ceil(x)+2,Z=0;Z<d;Z++)for(var R=Z*c[0],N=0;N<h;N++)for(var O=R+N*c[1],W=Math.floor(N*B),F=Math.floor(W-S/2),M=0;M<f;M++)for(var V=O+M*c[2],T=Math.floor(M*x),E=Math.floor(T-k/2),j=0;j<p;j++){for(var L=0,X=0;X<S;X++){var H=X+F;if(!(H<0||H>=C)){var Y=R+H*l[1],z=H*w;if(N===Math.min(h-1,u?Math.round(z):Math.floor(z)))for(var K=0;K<k;K++){var _=K+E;if(!(_<0||_>=m)){var D=Y+_*l[2],P=_*G;M===Math.min(f-1,u?Math.round(P):Math.floor(P))&&(L+=v[D+j])}}}}b[V+j]=L}return n.makeTensorInfo(a.shape,a.dtype,b)}};var AI={kernelName:i.uc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.dims;Og(a,"reverse");var s=a.shape.length,u=i.tf.parseAxisParam(o,a.shape);if(0===s)return jg({inputs:{x:a},backend:n});for(var c=new i.cd(a.shape,a.dtype),l=n.bufferSync(a),g=function(e){var t=c.indexToLoc(e),n=t.slice();u.forEach((function(e){return n[e]=a.shape[e]-1-n[e]})),c.set.apply(c,[l.get.apply(l,Object(Yn.a)(n))].concat(Object(Yn.a)(t)))},d=0;d<c.size;d++)g(d);return n.makeTensorInfo(c.shape,c.dtype,c.values)}},yI={kernelName:i.vc,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,s=n.radians,u=n.fillValue,c=n.center,l=r,g=i.tf.getTypedArrayFromDType(a.dtype,i.tf.sizeFromShape(a.shape)),d=Object(o.a)(a.shape,4),h=d[0],f=d[1],p=d[2],I=d[3],C=i.ud.getImageCenter(c,f,p),m=Object(o.a)(C,2),b=m[0],v=m[1],A=Math.sin(s),y=Math.cos(s),w=l.data.get(a.dataId).values,G=0;G<h;G++)for(var B=G*p*f*I,x=0;x<f;x++)for(var S=x*(p*I),k=0;k<p;k++)for(var Z=k*I,R=0;R<I;R++){var N=[h,x,k,R],O=N[2],W=N[1],F=(O-b)*y-(W-v)*A,M=(O-b)*A+(W-v)*y;F=Math.round(F+b),M=Math.round(M+v);var V=u;if("number"!==typeof u&&(V=3===R?255:u[R]),F>=0&&F<p&&M>=0&&M<f)V=w[B+M*(p*I)+F*I+R];g[B+S+Z+R]=V}return{dataId:l.write(g,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},wI=Mg(i.wc,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),GI={kernelName:i.wc,backendName:"cpu",kernelFunc:wI},BI=ah((function(e){return 1/Math.sqrt(e)})),xI=Vg(i.xc,BI),SI={kernelName:i.xc,backendName:"cpu",kernelFunc:xI};function kI(e,t,n,r,a,o,s,u,c,l){var g=[r/a,a],d=e.values,h=t.values;if(0===r)return Object(i.zd)(n,t.dtype);var f=Object(i.zd)(g,t.dtype);f.values.fill(c);for(var p=0;p<o;p++){for(var I=[],C=0,m=0;m<s;m++){var b=d[p*s+m];I.push(b),C+=b*u[m]}if(C<0||C>=r/a)throw new Error("Invalid indices: ".concat(I," does not index into ").concat(n));for(var v=0;v<a;v++)l?f.values[C*a+v]+=h[p*a+v]:f.values[C*a+v]=0===t.rank?h[0]:h[p*a+v]}return f}var ZI={kernelName:i.yc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,o=t.updates,s=r.shape,u=i.ud.calculateShapes(o,a,s),c=u.sliceRank,l=u.numUpdates,g=u.sliceSize,d=u.strides,h=u.outputSize,f=kI(n.bufferSync(a),n.bufferSync(o),s,h,g,l,c,d,0,!0);return n.makeTensorInfo(s,f.dtype,f.values)}};var RI={kernelName:i.zc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,o=t.e;Og([r,a,o],"select");for(var s=r.shape.length,u=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values,g=Object(i.sf)(a.dtype,o.dtype),d=i.tf.makeZerosTypedArray(i.tf.sizeFromShape(a.shape),g),h=0,f=0===s||s>1||1===a.shape.length?1:i.tf.sizeFromShape(a.shape.slice(1)),p=0;p<u.length;p++)for(var I=0;I<f;I++)1===u[p]?d[h++]=c[p]:d[h++]=l[p];return n.makeTensorInfo(a.shape,g,d)}},NI=i.ud.SELU_SCALEALPHA,OI=i.ud.SELU_SCALE,WI=Mg(i.Ac,(function(e){return e>=0?OI*e:NI*(Math.exp(e)-1)})),FI={kernelName:i.Ac,backendName:"cpu",kernelFunc:WI},MI=Mg(i.Cc,(function(e){return e<0?-1:e>0?1:0})),VI={kernelName:i.Cc,backendName:"cpu",kernelFunc:MI},TI=Mg(i.Dc,(function(e){return Math.sin(e)})),EI={kernelName:i.Dc,backendName:"cpu",kernelFunc:TI},jI=Mg(i.Ec,(function(e){return Math.sinh(e)})),LI={kernelName:i.Ec,backendName:"cpu",kernelFunc:jI},XI=Math.log(1.1920928955078125e-7)+2,HI=Mg(i.Hc,(function(e){var t=e>-XI,n=e<XI,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),YI={kernelName:i.Hc,backendName:"cpu",kernelFunc:HI};var zI={kernelName:i.Ic,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.blockShape,s=r.paddings;Og([a],"spaceToBatchND");var u=i.tf.sizeFromShape(o),c=[[0,0]];c.push.apply(c,Object(Yn.a)(s));for(var l=1+o.length;l<a.shape.length;++l)c.push([0,0]);var g=sI.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),d=i.ud.getReshaped(g.shape,o,u,!1),h=i.ud.getPermuted(d.length,o.length,!1),f=i.ud.getReshapedPermuted(g.shape,o,u,!1),p=hd({inputs:{x:g},backend:n,attrs:{shape:d}}),I=xd({inputs:{x:p},backend:n,attrs:{perm:h}}),C=hd({inputs:{x:I},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(I),C}};function KI(e,t,n,r,a,o,s){var u=t[0],c=o[0],l=new Array(c),g=new Array(u),d=t[1];if(0===c){if(0!==u)throw new Error("Received SparseTensor with denseShape[0] = 0 but\n         indices.shape[0] = ".concat(u));return[i.tf.getArrayFromDType(n,0),[0,d],i.tf.getArrayFromDType(a,0),l,g]}for(var h=!0,f=0,p=new Array(c).fill(0),I=0;I<u;++I){var C=e[I*d];if(C<0)throw new Error("indices(".concat(I,", 0) is invalid: ").concat(C," < 0"));if(C>=c)throw new Error("indices(".concat(I,", 0) is invalid: ").concat(C," >= ").concat(c));++p[C],h=h&&C>=f,f=C}for(var m=!0,b=0;b<c;++b){var v=0===p[b];l[b]=v,m=m&&!v,p[b]=Math.max(p[b],1),b>0&&(p[b]+=p[b-1])}if(m&&h){for(var A=e,y=r,w=0;w<u;++w)g[w]=w;return[A,[u,d],y,l,g]}for(var G=p[c-1],B=i.tf.getArrayFromDType(n,G*d),x=i.tf.getArrayFromDType(a,G),S=new Array(c).fill(0),k=0;k<u;++k){var Z=e[k*d],R=S[Z],N=(0===Z?0:p[Z-1])+R;S[Z]++;for(var O=0;O<d;++O)B[N*d+O]=e[k*d+O];x[N]=r[k],g[k]=N}for(var W=0;W<c;++W){if(0===S[W]){var F=0===W?0:p[W-1];B[F*d+0]=W;for(var M=1;M<d;++M)B[F*d+M]=0;x[F]=s}}return[B,[G,d],x,l,g]}var _I={kernelName:i.Jc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,s=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==s.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));var u=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,g=n.data.get(s.dataId).values[0],d=KI(u,r.shape,r.dtype,c,a.dtype,l,g),h=Object(o.a)(d,5),f=h[0],p=h[1],I=h[2],C=h[3],m=h[4];return[n.makeTensorInfo(p,r.dtype,f),n.makeTensorInfo([p[0]],a.dtype,I),n.makeTensorInfo([C.length],"bool",new Uint8Array(C.map((function(e){return Number(e)})))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function DI(e,t,n,r,a){for(var o=i.tf.sizeFromShape(r),s=t[0],u=a.length,c=[],l=1,g=-1,d=0;d<u;++d){var h=a[d];if(-1===h){if(-1!==g)throw new Error("only one output dimension may be -1, not both ".concat(g," and ").concat(d));g=d,c.push(1)}else{if(h<0)throw new Error("size ".concat(d," must be non-negative, not ").concat(h));l*=h,c.push(h)}}if(-1!==g){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");var f=Math.trunc(o/l);if(l*f!==o)throw new Error("Input to reshape is a SparseTensor with ".concat(o,"\n          dense values, but the requested shape requires a multiple of ").concat(l,". inputShape=").concat(r," outputShape= ").concat(c));c[g]=f}var p=i.tf.sizeFromShape(c);if(p!==o)throw new Error("Input to reshape is a tensor with ".concat(o," dense values, but the requested shape has ").concat(p,". inputShape=").concat(r," outputShape=").concat(c));var I=r.length,C=[];if(I>0){C[I-1]=1;for(var m=I-2;m>=0;--m)C[m]=C[m+1]*r[m+1]}var b=[];if(u>0){b[u-1]=1;for(var v=u-2;v>=0;--v)b[v]=b[v+1]*c[v+1]}for(var A=i.tf.getArrayFromDType(n,s*u),y=0;y<s;++y){for(var w=0,G=0;G<I;++G)w+=e[y*I+G]*C[G];for(var B=0;B<u;++B)A[y*u+B]=Math.trunc(w/b[B]),w%=b[B]}return[A,[s,u],c]}var PI={kernelName:i.Kc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var s=Array.from(n.data.get(a.dataId).values),u=n.data.get(r.dataId).values,c=Array.from(n.data.get(i.dataId).values),l=DI(u,r.shape,r.dtype,s,c),g=Object(o.a)(l,3),d=g[0],h=g[1],f=g[2];return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}};function UI(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=r.length;if(u!==a.length)throw new Error("segmentIds and indices should have same size.");var c=[t[0],e.length/t[0]],l=c[1],g=u>0?a[u-1]+1:0,d=g;if(d<0)throw new Error("segment ids must be >= 0");var h=t.slice();h[0]=d;var f=h.reduce((function(e,t){return e*t}),1),p=i.tf.getArrayFromDType(n,f);if(0===u)return d>0&&p.fill(s),[p,h];if(d<=0)throw new Error("segment ids must be >= 0");for(var I=0,C=1,m=0,b=a[I];;){var v=0;if(C<u){if(b===(v=a[C])){++C;continue}if(b>=v)throw new Error("segment ids are not increasing")}if(b<0||b>=d)throw new Error("Segment id ".concat(b," out of range [0, ").concat(d,"), possibly because segmentIds input is not sorted."));b>m&&p.fill(s,m*l,b*l);for(var A=I;A<C;++A){var y=r[A];if(y<0||y>=c[0])throw new Error("Bad: indices[".concat(A,"] == ").concat(r[A]," out of range [0, ").concat(c[0],")"));for(var w=0;w<l;w++)p[b*l+w]+=e[y*l+w]}if(o)for(var G=0;G<l;G++)p[b*l+G]/=C-I;if(I=C,m=b+1,b=v,++C>u)break}return m<d&&p.fill(s,m*l,d*l),[p,h]}var JI={kernelName:i.Lc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));var s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=UI(s,r.shape,r.dtype,u,c,!0),g=Object(o.a)(l,2),d=g[0],h=g[1];return n.makeTensorInfo(h,r.dtype,d)}};var QI={kernelName:i.Mc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));var s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=UI(s,r.shape,r.dtype,u,c),g=Object(o.a)(l,2),d=g[0],h=g[1];return n.makeTensorInfo(h,r.dtype,d)}};var qI={kernelName:i.Nc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,o=t.sparseValues,s=t.defaultValue,u=r.outputShape,c=i.ud.calculateShapes(o,a,u),l=c.sliceRank,g=c.numUpdates,d=c.sliceSize,h=c.strides,f=c.outputSize,p=kI(n.bufferSync(a),n.bufferSync(o),u,f,d,g,l,h,n.data.get(s.dataId).values[0],!1);return n.makeTensorInfo(u,p.dtype,p.values)}};var $I={kernelName:i.Oc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.numOrSizeSplits,s=r.axis,u=i.tf.parseAxisParam(s,a.shape)[0],c=i.ud.prepareSplitSize(a,o,u),l=new Array(a.shape.length).fill(0),g=a.shape.slice();return c.map((function(e){var t=Object(Yn.a)(g);t[u]=e;var r=qd({inputs:{x:a},backend:n,attrs:{begin:l,size:t}});return l[u]+=e,r}))}},eC=Mg(i.Pc,(function(e){return Math.sqrt(e)})),tC={kernelName:i.Pc,backendName:"cpu",kernelFunc:eC},nC={kernelName:i.Qc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;Og(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},rC=Yg((function(e,t){var n=e-t;return n*n})),aC=sd(i.Rc,rC),iC={kernelName:i.Rc,backendName:"cpu",kernelFunc:aC},oC=Mg(i.Sc,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),sC={kernelName:i.Sc,backendName:"cpu",kernelFunc:oC};function uC(e,t,n,r){for(var a=Object(i.zd)(e,t.dtype),o=0;o<a.size;o++){for(var s=a.indexToLoc(o),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[c]*n[c]+r[c];a.set.apply(a,[t.get.apply(t,u)].concat(Object(Yn.a)(s)))}return a}var cC={kernelName:i.Tc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.begin,s=r.end,u=r.strides,c=r.beginMask,l=r.endMask,g=r.ellipsisMask,d=r.newAxisMask,h=r.shrinkAxisMask;Og(a,"stridedSlice");var f,p=i.Xe.sliceInfo(a.shape,o,s,u,c,l,g,d,h),I=p.nonStrided,C=p.$begin,m=p.$strides,b=p.size,v=p.newShape,A=p.outShape,y=hd({inputs:{x:a},backend:n,attrs:{shape:v}});if(I){var w=qd({inputs:{x:y},backend:n,attrs:{begin:C,size:b}});f=hd({inputs:{x:w},backend:n,attrs:{shape:A}}),n.disposeIntermediateTensorInfo(w)}else if(A.some((function(e){return 0===e})))f=n.makeTensorInfo(A,a.dtype,[]);else{var G=uC(A,n.bufferSync(y),m,C);f=n.makeTensorInfo(G.shape,G.dtype,G.values)}var B=hd({inputs:{x:f},backend:n,attrs:{shape:A}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(f),B}},lC=function(){function e(t,n,r,a,o,s){Object(Ur.a)(this,e),this.separator=i.tf.encodeString(t),this.nGramWidths=n,this.leftPad=i.tf.encodeString(r),this.rightPad=i.tf.encodeString(a),this.padWidth=o,this.preserveShort=s}return Object(Jr.a)(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,s=function(s){var u=o.getPadWidth(i),c=Math.max(0,u-s),l=Math.max(0,u-(a-(s+1))),g=i-(c+l),d=t+(c>0?0:s-u),h=0;h+=c*o.leftPad.length;for(var f=0;f<g;++f)h+=e[d+f].length;h+=l*o.rightPad.length,h+=(c+l+g-1)*o.separator.length,n[r+s]=new Uint8Array(h);for(var p=n[r+s],I=0,C=function(e){return e.forEach((function(e){return p[I++]=e}))},m=0;m<c;++m)C(o.leftPad),C(o.separator);for(var b=0;b<g-1;++b)C(e[d+b]),C(o.separator);if(g>0){C(e[d+g-1]);for(var v=0;v<l;++v)C(o.separator),C(o.rightPad)}else{for(var A=0;A<l-1;++A)C(o.rightPad),C(o.separator);C(o.rightPad)}},u=0;u<a;++u)s(u)}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var o=t[0];if(0!==o)throw new Error("First split value must be 0, got ".concat(o));for(var s=1;s<a;++s){var u=t[s]>=o;if(!(u=u&&t[s]<=r))throw new Error("Invalid split value ".concat(t[s],", must be in [").concat(o,", ").concat(r,"]"));o=t[s]}if(o!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(o))}var c=a-1,l=i.tf.getArrayFromDType("int32",a);if(0===r||0===a){for(var g=new Array(r),d=0;d<=c;++d)l[d]=0;return[g,l]}l[0]=0;for(var h=function(e){var r=t[e]-t[e-1],a=0;n.nGramWidths.forEach((function(e){a+=n.getNumNGrams(r,e)})),n.preserveShort&&r>0&&0===a&&(a=1),l[e]=l[e-1]+a},f=1;f<=c;++f)h(f);for(var p=new Array(l[c]),I=function(r){var a=t[r],i=l[r];if(n.nGramWidths.forEach((function(o){var s=t[r+1]-t[r],u=n.getNumNGrams(s,o);n.createNGrams(e,a,p,i,u,o),i+=u})),n.preserveShort&&i===l[r]){var o=t[r+1]-t[r];if(0===o)return"continue";var s=o+2*n.padWidth;n.createNGrams(e,a,p,i,1,s)}},C=0;C<c;++C)I(C);return[p,l]}}]),e}();function gC(e,t,n,r,a,i,o,s){return new lC(n,r,a,i,o,s).compute(e,t)}var dC={kernelName:i.Uc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,s=r.leftPad,u=r.rightPad,c=r.padWidth,l=r.preserveShortSequences,g=t.data,d=t.dataSplits,h=gC(n.data.get(g.dataId).values,n.data.get(d.dataId).values,a,i,s,u,c,l),f=Object(o.a)(h,2),p=f[0],I=f[1];return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",I)]}};function hC(e,t,n){if(!e.length)return[];if(0===t.length){for(var r=new Array(e.length),a=0;a<e.length;++a)r[a]=e.subarray(a,a+1);return r}if(1===t.length){for(var i=t[0],o=[],s=e.indexOf(i);-1!==s;){var u=e.subarray(0,s);n&&0===u.length||o.push(u),s=(e=e.subarray(s+1)).indexOf(i)}return n&&0===e.length||o.push(e),o}for(var c=[],l=0,g=0;g<e.length+1;g++)if(g===e.length||-1!==t.indexOf(e[g])){var d=e.subarray(l,g);n&&0===d.length||c.push(d),l=g+1}return c}function fC(e,t,n){for(var r=e.length,a=[],o=0,s=0,u=new Array(r),c=0;c<r;++c){var l=hC(e[c],t,n),g=l.length;u[c]=g,o+=g,s=Math.max(s,g),a.push.apply(a,Object(Yn.a)(l))}for(var d=i.tf.getArrayFromDType("int32",2*o),h=new Array(o),f=[r,s],p=0,I=0;I<r;++I)for(var C=0;C<u[I];++C)d[2*p]=I,d[2*p+1]=C,h[p]=a[p],++p;return[d,h,f]}var pC={kernelName:i.Vc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var s=fC(n.data.get(a.dataId).values,n.data.get(i.dataId).values[0],r),u=Object(o.a)(s,3),c=u[0],l=u[1],g=u[2],d=l.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(g))]}};function IC(e,t){for(var n=i.tf.getArrayFromDType("int32",e.length),r=0;r<e.length;++r)n[r]=i.tf.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var CC={kernelName:i.Wc,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=IC(n.data.get(a.dataId).values,r);return n.makeTensorInfo(a.shape,"int32",i)}},mC=Mg(i.Zc,(function(e){return Math.tan(e)})),bC={kernelName:i.Zc,backendName:"cpu",kernelFunc:mC},vC=Mg(i.ad,(function(e){return Math.tanh(e)})),AC={kernelName:i.ad,backendName:"cpu",kernelFunc:vC};function yC(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=Object(i.zd)(n,e.dtype),o=0;o<a.values.length;++o){for(var s=a.indexToLoc(o),u=new Array(e.rank),c=0;c<u.length;c++)u[c]=s[c]%e.shape[c];var l=e.locToIndex(u);a.values[o]=e.values[l]}return a}var wC={kernelName:i.dd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;Og(a,"tile");var o=yC(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}};function GC(e,t,n,r,a){for(var o=t[t.length-1],s=e.length/o,u=o,c=i.tf.getTypedArrayFromDType(n,s*r),l=i.tf.getTypedArrayFromDType("int32",s*r),g=0;g<s;g++){for(var d=g*u,h=e.subarray(d,d+u),f=[],p=0;p<h.length;p++)f.push({value:h[p],index:p});f.sort((function(e,t){return t.value-e.value}));for(var I=g*r,C=c.subarray(I,I+r),m=l.subarray(I,I+r),b=0;b<r;b++)C[b]=f[b].value,m[b]=f[b].index}var v=t.slice();return v[v.length-1]=r,[Object(i.zd)(v,n,c),Object(i.zd)(v,"int32",l)]}var BC={kernelName:i.ed,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k;r.sorted,Og(a,"topk");var s=GC(n.data.get(a.dataId).values,a.shape,a.dtype,i),u=Object(o.a)(s,2),c=u[0],l=u[1];return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};var xC={kernelName:i.fd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,s=t.transforms,u=n.interpolation,c=n.fillMode,l=n.fillValue,g=n.outputShape,d=Object(o.a)(a.shape,4),h=d[0],f=d[1],p=d[2],I=d[3],C=null!=g?g:[f,p],m=Object(o.a)(C,2),b=m[0],v=m[1],A=[h,b,v,I],y=i.tf.computeStrides(a.shape),w=y[0],G=y[1],B=y[2],x=i.tf.getTypedArrayFromDType(a.dtype,i.tf.sizeFromShape(A));x.fill(l);for(var S=r.data.get(a.dataId).values,k=r.data.get(s.dataId).values,Z=0;Z<h;++Z){for(var R=1===s.shape[0]?k:k.subarray(8*Z,8*Z+8),N=0;N<b;++N)for(var O=0;O<v;++O)for(var W=0;W<I;++W){var F=void 0,M=R[6]*O+R[7]*N+1;if(0!==M){var V=(R[0]*O+R[1]*N+R[2])/M,T=(R[3]*O+R[4]*N+R[5])/M,E=SC(V,p,c),j=SC(T,f,c);switch(u){case"nearest":F=ZC(S,f,p,w,G,B,Z,j,E,W,l);break;case"bilinear":F=RC(S,f,p,w,G,B,Z,j,E,W,l);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(u))}x[Z*w+N*G+O*B+W]=F}}return r.makeTensorInfo(A,a.dtype,x)}return{dataId:r.write(x,A,a.dtype),shape:a.shape,dtype:a.dtype}}};function SC(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return i.tf.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return i.tf.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return i.tf.clamp(0,e,t-1)}(e,t);case"constant":default:return function(e,t){return e}(e)}}function kC(e,t,n,r,a,i,o,s,u,c,l){return 0<=s&&s<t&&0<=u&&u<n?e[o*r+s*a+u*i+c]:l}function ZC(e,t,n,r,a,i,o,s,u,c,l){return kC(e,t,n,r,a,i,o,Math.round(s),Math.round(u),c,l)}function RC(e,t,n,r,a,i,o,s,u,c,l){var g=Math.floor(s),d=Math.floor(u),h=g+1,f=d+1;return(h-s)*((f-u)*kC(e,t,n,r,a,i,o,g,d,c,l)+(u-d)*kC(e,t,n,r,a,i,o,g,f,c,l))+(s-g)*((f-u)*kC(e,t,n,r,a,i,o,h,d,c,l)+(u-d)*kC(e,t,n,r,a,i,o,h,f,c,l))}function NC(e,t,n,r){for(var a=i.tf.parseAxisParam(t,n)[0],o=[1,n[0],1],s=0;s<a;s++)o[0]*=n[s];o[1]=n[a];for(var u=a+1;u<n.length;u++)o[2]*=n[u];for(var c={},l=new Int32Array(n[a]),g=new i.cd(o,r,e),d=[],h=1===o[0]&&1===o[2],f=0;f<n[a];f++){var p=void 0;if(h)p=e[f].toString();else{for(var I=[],C=0;C<o[0];C++)for(var m=0;m<o[2];m++)I.push(g.get(C,f,m));p=I.join(",")}if(void 0!==c[p])l[f]=c[p];else{var b=Object.keys(c).length;c[p]=b,l[f]=b,d.push(f)}}var v=o.slice();v[1]=Object.keys(c).length;var A=new i.cd(v,r);d.forEach((function(e,t){for(var n=0;n<o[0];n++)for(var r=0;r<o[2];r++)A.set(g.get(n,e,r),n,t,r)}));var y=n.slice();return y[a]=v[1],{outputValues:A.values,outputShape:y,indices:l}}var OC={kernelName:i.hd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;Og(i,"unique");var o=NC(r.data.get(i.dataId).values,a,i.shape,i.dtype),s=o.outputValues,u=o.outputShape,c=o.indices;return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}};var WC={kernelName:i.id,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,s=a.shape[i],u=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(u[c++]=a.shape[l]);var g=new Array(o).fill(0),d=a.shape.slice();d[i]=1;for(var h=new Array(s),f=0;f<h.length;f++){g[i]=f;var p=qd({inputs:{x:a},backend:n,attrs:{begin:g,size:d}});h[f]=hd({inputs:{x:p},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(p)}return h}};for(var FC={kernelName:i.jd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.segmentIds,s=r.numSegments;Og(a,"unsortedSegmentSum");for(var u=[],c=[],l=a.shape.length-o.shape.length,g=o,d=0;d<l;++d){var h=uf({inputs:{input:g},backend:n,attrs:{dim:d+1}});g=h,c.push(h)}for(var f=0;f<s;++f){var p=i.tf.createScalarValue(f,"int32"),I=n.makeTensorInfo([],"int32",p),C=Ph({inputs:{a:I,b:g},backend:n}),m=id({inputs:{x:C},backend:n,attrs:{dtype:"float32"}}),b=Xh({inputs:{a:m,b:a},backend:n}),v=Yh({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});u.push(v),c.push(I),c.push(C),c.push(m),c.push(b),c.push(v)}var A=iI({inputs:u,backend:n,attrs:{axis:0}});return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),A}},MC=0,VC=[Cd,bd,Ad,wd,dd,Gd,kd,Zd,Rd,Nd,Wd,Md,Td,Ld,Hd,_d,Dd,Pd,Ud,Id,Jd,eh,rh,od,sh,ch,td,lh,ph,mh,bh,Ch,Ah,yh,vh,Gh,xh,Sh,kh,Zh,Rh,Oh,Wh,Fh,Mh,Vh,Eh,Th,pf,Kh,Eg,_h,Uh,rf,sf,cf,df,wf,Bf,xf,Zf,Of,Wf,Ff,Vf,Ef,Xf,zf,Lg,Kf,hh,Df,Uf,Qf,Hg,ep,rp,ip,up,lp,hp,pp,mp,bp,vp,xp,Sp,kp,Zp,Rp,Np,wp,Op,Wp,Vp,Tp,Lp,Yp,Hh,Kp,Dp,Up,Qp,eI,tI,aI,oI,sI,lI,_g,dI,fI,ad,II,Pg,Jg,fd,CI,mI,bI,vI,AI,yI,GI,SI,ZI,RI,FI,qg,VI,EI,LI,$d,Hp,YI,zI,_I,PI,JI,QI,qI,$I,tC,nC,iC,sC,cC,dC,pC,CC,bf,zh,bC,AC,wC,BC,Sd,xC,OC,WC,FC,rI];MC<VC.length;MC++){var TC=VC[MC];Object(i.Ie)(TC)}var EC,jC,LC,XC={},HC={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function YC(e){if(!(e in XC)){var t=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);if(t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete XC[e]}),!1),1===e)return t.getContext("webgl",HC)||t.getContext("experimental-webgl",HC);return t.getContext("webgl2",HC)}(e);if(null===t)return console.log("Could not get context for WebGL version",e),null;XC[e]=t}var n=XC[e];return n.isContextLost()?(delete XC[e],YC(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),XC[e])}function zC(e,t){return[t,e]}function KC(e){var t=i.tf.sizeFromShape(e),n=Math.ceil(t/4);return i.tf.sizeToSquarishShape(n)}function _C(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function DC(e,t){var n,r,a,o,s,u,c,l,g,d=e;return 2===Object(i.Ud)().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,a=d.RGBA16F,o=d.RGBA32F,s=d.RED,u=4,c=1,l=d.HALF_FLOAT,g=d.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,o=d.RGBA,s=e.RGBA,u=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,g=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:g}}function PC(e,t){var n=t();return Object(i.Ud)().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(EC||(EC={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(jC||(jC={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(LC||(LC={}));function UC(e){return!!(Object(i.Ud)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function JC(e,t){return cm(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function QC(e,t){var n=cm(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(PC(e,(function(){return e.shaderSource(n,t)})),PC(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=em.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),o=a.length.toString().length+2,s=a.map((function(e,t){return i.tf.rightPad((t+1).toString(),o)+e})),u=0,c=0;c<s.length;c++)u=Math.max(s[c].length,u);var l=s.slice(0,r-1),g=s.slice(r-1,r),d=s.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(i.tf.rightPad(g[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var qC,$C,em=/ERROR: [0-9]+:([0-9]+):/g;function tm(e,t){if(PC(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function nm(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(PC(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),PC(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),PC(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function rm(e,t,n){return cm(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function am(e,t,n){return e.getUniformLocation(t,n)}function im(e,t,n,r){PC(e,(function(){return function(e,t,n){lm(e,n),PC(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),PC(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),PC(e,(function(){return e.uniform1i(n,r)}))}function om(e,t,n){PC(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),PC(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function sm(e,t){PC(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),PC(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function um(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function cm(e,t,n){var r=PC(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function lm(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function gm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return i.tf.sizeFromShape(e.slice(0,e.length-t))}function dm(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function hm(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[gm(e)].concat(Object(Yn.a)(dm(e)))),t}function fm(e){return e%2===0}function pm(e,t){if(e=e.slice(-2),t=t.slice(-2),i.tf.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(fm(n)&&fm(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&fm(e[0])&&fm(t[0])}function Im(e,t){return null!=e.getExtension(t)}function Cm(e){try{if(null!=YC(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function mm(e){if(0===e)return!1;var t=YC(e);if(1!==e){if(Im(t,"EXT_color_buffer_float"))return bm(t);var n="EXT_color_buffer_half_float";if(Im(t,n)){var r=t.getExtension(n);return function(e,t){var n=DC(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!Im(t,"OES_texture_float")&&(!!Im(t,"WEBGL_color_buffer_float")&&bm(t))}function bm(e){var t=DC(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function vm(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&i.tf.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var Am=Object(i.Ud)();function ym(){var e,t,n,r,a,o,s,u,c,l;return 2===Object(i.Ud)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",o="outputColor",s="out vec4 outputColor;",u="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",o="gl_FragColor",s="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:o,defineOutput:s,defineSpecialNaN:u,defineSpecialInf:c,defineRound:l}}function wm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=i.tf.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function Gm(e){var t=i.tf.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}Am.registerFlag("HAS_WEBGL",(function(){return Am.getNumber("WEBGL_VERSION")>0})),Am.registerFlag("WEBGL_VERSION",(function(){return Cm(2)?2:Cm(1)?1:0})),Am.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),Am.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Am.get("WEBGL_VERSION")})),Am.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Am.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Am.registerFlag("WEBGL_PACK",(function(){return Am.getBool("HAS_WEBGL")})),Am.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_CLIP",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_PACK_REDUCE",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_CONV_IM2COL",(function(){return Am.getBool("WEBGL_PACK")})),Am.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==qC){var t=YC(e);qC=t.getParameter(t.MAX_TEXTURE_SIZE)}return qC}(Am.getNumber("WEBGL_VERSION"))})),Am.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==$C){var t=YC(e);$C=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$C)}(Am.getNumber("WEBGL_VERSION"))})),Am.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Am.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=YC(e);return Im(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Im(t,"EXT_disjoint_timer_query")?1:0}(e)})),Am.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Am.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!i.Od.isMobile()})),Am.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=YC(e);if(1===e){if(!Im(t,"OES_texture_float"))return!1}else if(!Im(t,"EXT_color_buffer_float"))return!1;return bm(t)}(Am.getNumber("WEBGL_VERSION"))})),Am.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Am.getBool("WEBGL_FORCE_F16_TEXTURES")&&Am.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Am.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return mm(Am.getNumber("WEBGL_VERSION"))})),Am.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=Am.getNumber("WEBGL_VERSION"))&&null!=YC(e).fenceSync;var e})),Am.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Am.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Am.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),Am.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return i.Od.isMobile()&&Am.getBool("IS_CHROME")?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),Am.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128}));var Bm="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",xm=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=EC.DENSE;var n=KC(t),r=ym();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(wm(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},Sm=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=EC.DENSE;var n=KC(t),r=ym();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(wm(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},km=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.outTexUsage=jC.DOWNLOAD;var n=ym();this.outputShape=t,this.userCode="\n      ".concat(Bm,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},Zm=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=jC.DOWNLOAD;var n=ym();this.outputShape=t,this.userCode="\n      ".concat(Bm,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},Rm=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(Ur.a)(this,e),this.variableNames=["A"];var a=ym(),i=Object(o.a)(n,2),s=i[0],u=i[1];this.outputShape=t;var c="result";r&&(c="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(Gm(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(u,";\n        int c = imod(flatIndex, ").concat(u,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(s,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(c,", 0., 0., 0.);\n      }\n    ")},Nm=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=ym(),i=Object(o.a)(n,2),s=i[0],u=i[1];this.outputShape=t;var c="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var g=0;g<=1;g++)for(var d=0;d<=1;d++){var h=2*g+d;c+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(d," < ").concat(t[2],") {\n            localCoords[2] += ").concat(d,";\n            if(localCoords[1] + ").concat(g," < ").concat(t[1],") {\n              localCoords[1] += ").concat(g,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(u,";\n              c = imod(flatIndex, ").concat(u,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(s,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(h,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(h,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(h,"] = values[2];\n              } else {\n                result[").concat(h,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(Gm(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(c,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")};function Om(e){var t=ym();return function(e,t){var n=cm(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(PC(e,(function(){return e.shaderSource(n,t)})),PC(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Wm(e){return function(e,t){var n=cm(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return PC(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),PC(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Fm(e){return function(e,t){var n=cm(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return PC(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),PC(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function Mm(e,t,n,r,a,o){!function(e,t){var n=Object(i.Ud)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),o="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+o+".")}}(t,n);var s=function(e){return cm(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),u=e.TEXTURE_2D;return PC(e,(function(){return e.bindTexture(u,s)})),PC(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),PC(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),PC(e,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),PC(e,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),PC(e,(function(){return e.texImage2D(u,0,r,t,n,0,a,o,null)})),PC(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function Vm(e){return e.internalFormatFloat}function Tm(e){return e.internalFormatHalfFloat}function Em(e){return e.downloadTextureFormat}function jm(e){return e.internalFormatPackedFloat}function Lm(e){return e.internalFormatPackedHalfFloat}function Xm(e,t,n,r,a,i,s,u){var c=e,l=new Float32Array(function(e,t){var n=_C(e,t),r=Object(o.a)(n,2);return r[0]*r[1]*4}(i,s));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}var Hm=function(){function e(t){Object(Ur.a)(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Object(i.Ud)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){XC[e]=t}(n,t)):this.gl=YC(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===Object(i.Ud)().getNumber("WEBGL_VERSION")){var o="OES_texture_half_float";if(this.textureFloatExtension=JC(this.gl,"OES_texture_float"),Im(this.gl,o))this.textureHalfFloatExtension=JC(this.gl,o);else if(Object(i.Ud)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Im(this.gl,a))this.colorBufferHalfFloatExtension=JC(this.gl,a);else if(Object(i.Ud)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Im(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Im(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=Wm(this.gl),this.indexBuffer=Fm(this.gl),this.framebuffer=function(e){return cm(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=DC(this.gl,this.textureHalfFloatExtension)}return Object(Jr.a)(e,[{key:"debug",get:function(){return Object(i.Ud)().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;PC(t,(function(){return t.finish()})),PC(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),PC(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),PC(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),PC(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),PC(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=zC(t,n),i=Object(o.a)(a,2);return Mm(e,i[0],i[1],Vm(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=zC(t,n),i=Object(o.a)(a,2);return Mm(e,i[0],i[1],Tm(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=zC(t,n),i=Object(o.a)(a,2);return Mm(e,i[0],i[1],Em(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){PC(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?PC(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):PC(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),PC(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,u;PC(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,u=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,u=i.internalFormatPackedFloat),o.set(a),PC(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,u,n,r,0,e.RGBA,s,o)})),PC(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_C(t,n),i=Object(o.a)(a,2);return Mm(e,i[0],i[1],Lm(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=_C(t,n),i=Object(o.a)(a,2);return Mm(e,i[0],i[1],jm(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(sm(this.gl,this.framebuffer),this.outputTexture=null),PC(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=zC(t,n),i=Object(o.a)(a,2),s=i[0],u=i[1],c=new Uint8Array(t*n*4);return PC(e,(function(){return e.readPixels(0,0,s,u,r.downloadTextureFormat,e.UNSIGNED_BYTE,c)})),new Float32Array(c.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return Xm(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();PC(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return PC(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),PC(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),PC(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(Object(i.Ud)().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(o,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=o}else Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return PC(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl,r=QC(n,e);null==this.vertexShader&&(this.vertexShader=Om(n));var a=function(e){return cm(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);return PC(n,(function(){return n.attachShader(a,t.vertexShader)})),PC(n,(function(){return n.attachShader(a,r)})),function(e,t){if(PC(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,a),this.debug&&tm(n,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return PC(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),nm(e,t,"clipSpacePos",n,3,20,0)&&nm(e,t,"uv",n,2,20,12)}(n,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&PC(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&tm(this.gl,this.program),PC(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?rm(this.gl,e,t):am(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),PC(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),im(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=_C(t,n),a=Object(o.a)(r,2),i=a[0],s=a[1];this.setOutputMatrixTextureDriver(e,i,s)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&tm(this.gl,this.program),um(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),PC(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),PC(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=JC(this.gl,2===Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n=this;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.tf.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||i.tf.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),om(this.gl,e,this.framebuffer),this.debug&&um(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(om(this.gl,this.outputTexture,this.framebuffer),this.debug&&um(this.gl)):sm(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;om(r,e,this.framebuffer),this.debug&&um(r),this.outputTexture=e,PC(r,(function(){return r.viewport(0,0,t,n)})),PC(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),PC(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var Ym=i.ud.getBroadcastDims;function zm(e,t,n,r){var a=[];e.forEach((function(e){var t=i.tf.sizeFromShape(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var o,s,u=a.join("\n"),c=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?_m(e):Km(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(r+=n?$m(e,t):eb(e,t));return r}(e,t,r)})).join("\n"),l=t.texShape,g=ym(),d=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(g),h=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Dm,"\n    ").concat(Pm,"\n    ").concat(Um,"\n  ")}(g);return t.isPacked?(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(i.tf.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)i*=e[e.length-u-1],o="\n      int b".concat(u," = index / ").concat(i,";\n      index -= b").concat(u," * ").concat(i,";\n    ")+o,s="b".concat(u,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t)}}(t.logicalShape,l),s=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(g)):(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){if(1===t[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t);case 2:return function(e,t){if(i.tf.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=wm(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=wm(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=wm(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=wm(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,l),s=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(g)),r&&(h+=Jm),[h,d,s,u,o,c,n].join("\n")}function Km(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=Object(o.a)(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var s=Object(o.a)(e.shapeInfo.texShape,2),u=s[0],c=s[1],l=Qm(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(u,", ").concat(c,", ").concat(l,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(qm(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=Qm(t);if(1===i)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(1===a)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&i.tf.arraysEqual(t,a)){var o=a[0],s=a[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var u=i.tf.squeezeShape(t),c=u.newShape,l=u.keptDims,g=c;if(g.length<t.length){var d=nb(e,g),h=["row","col"];return"\n      ".concat(Km(d),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(rb(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(qm(e),"\n      }\n    ");var f=a[0],p=a[1],I=Qm(n);if(1===p)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(I,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(f,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===f)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(I,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(p,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(I,";\n    vec2 uv = uvFromFlat(").concat(f,", ").concat(p,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],o=t[2],s=i.tf.squeezeShape(t),u=s.newShape,c=s.keptDims,l=u;if(l.length<t.length){var g=nb(e,l),d=["row","col","depth"];return"\n        ".concat(Km(g),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(rb(d,c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(o,", 1)));\n        ").concat(qm(e),"\n      }\n    ");var h=e.shapeInfo.texShape,f=h[0],p=h[1],I=e.shapeInfo.flatOffset;if(p===a&&null==I)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(f,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(p===o&&null==I)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(f,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var C=Qm(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(o," + depth + ").concat(C,";\n        vec2 uv = uvFromFlat(").concat(f,", ").concat(p,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],o=t[2]*a,s=t[1]*o,u=i.tf.squeezeShape(t),c=u.newShape,l=u.keptDims;if(c.length<t.length){var g=nb(e,c),d=["row","col","depth","depth2"];return"\n      ".concat(Km(g),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(rb(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(a,", 1)));\n        ").concat(qm(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],I=f[1];if(I===s&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(I,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(I===a&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(I,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var C=Qm(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(I,", index + ").concat(C,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],o=t[3]*a,s=t[2]*o,u=t[1]*s,c=i.tf.squeezeShape(t),l=c.newShape,g=c.keptDims;if(l.length<t.length){var d=nb(e,l),h=["row","col","depth","depth2","depth3"];return"\n      ".concat(Km(d),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(rb(h,g),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(s,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(qm(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,I=p[0],C=p[1];if(C===u&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(C,".0, ").concat(I,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(C===a&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(C,".0, ").concat(I,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=Qm(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(I,", ").concat(C,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=i.tf.squeezeShape(t),o=a.newShape,s=a.keptDims;if(o.length<t.length){var u=nb(e,o),c=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Km(u),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(rb(c,s),");\n      }\n    ")}var l=t[5],g=t[4]*l,d=t[3]*g,h=t[2]*d,f=t[1]*h;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(f,", ").concat(h,", ").concat(d,", ").concat(g,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(l,", 1)));\n        ").concat(qm(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,I=e.shapeInfo.texShape,C=I[0],m=I[1];if(m===f&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(h,", ").concat(d,", ").concat(g,", ").concat(l,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(C,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===l&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(C,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var b=Qm(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(f," + col * ").concat(h," + depth * ").concat(d," +\n          depth2 * ").concat(g," + depth3 * ").concat(l," + depth4 + ").concat(b,";\n      vec2 uv = uvFromFlat(").concat(C,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function _m(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=ym();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=ym();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,o=a[0],s=a[1],u=ym();if(null!=a&&i.tf.arraysEqual(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");var c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var o=[1,2],s=nb(e,t.slice(1)),u=["b","row","col"];return"\n        ".concat(_m(s),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(rb(u,o),");\n        }\n      ")}var c=i[0],l=i[1],g=Math.ceil(t[2]/2),d=g*Math.ceil(t[1]/2),h=ym();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(d,", ").concat(g,", b, row, col);\n      return ").concat(h.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),g="int b, int row, int col",d="b * ".concat(l," + (row / 2) * ").concat(c," + (col / 2)"),h=2;h<n-1;h++)g="int b".concat(h,", ")+g,l*=t[n-h-1],d="b".concat(h," * ").concat(l," + ")+d;var f=ym();return"\n    vec4 ".concat(a,"(").concat(g,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(s,");\n      return ").concat(f.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var Dm="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Pm="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Um="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Jm="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Qm(e){return"offset".concat(e)}function qm(e){var t=e.name,n=i.tf.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function $m(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),o="get"+a+"AtOutCoords",s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,c=Ym(e.shapeInfo.logicalShape,t.logicalShape),l=tb(u),g=u-s,d=["x","y","z","w","u","v"];n=0===s?"":u<2&&c.length>=1?"coords = 0;":c.map((function(e){return"coords.".concat(d[e+g]," = 0;")})).join("\n");var h="";h=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(d[t+g])})).join(", ");var f="return outputValue;",p=1===i.tf.sizeFromShape(e.shapeInfo.logicalShape),I=1===i.tf.sizeFromShape(t.logicalShape);if(1!==s||p||I){if(p&&!I)f=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var C=s-2,m=s-1;c.indexOf(C)>-1&&c.indexOf(m)>-1?f="return vec4(outputValue.x);":c.indexOf(C)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(m)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(h,");\n      ").concat(f,"\n    }\n  ")}function eb(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=t.texShape,s=e.shapeInfo.texShape,u=e.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!e.shapeInfo.isUniform&&u===c&&null==e.shapeInfo.flatOffset&&i.tf.arraysEqual(s,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var l,g=tb(c),d=Ym(e.shapeInfo.logicalShape,t.logicalShape),h=c-u,f=["x","y","z","w","u","v"];l=0===u?"":c<2&&d.length>=1?"coords = 0;":d.map((function(e){return"coords.".concat(f[e+h]," = 0;")})).join("\n");var p="";return p=c<2&&u>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+h])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(g," coords = getOutputCoords();\n      ").concat(l,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}function tb(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function nb(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function rb(e,t){return t.map((function(t){return e[t]})).join(", ")}function ab(e,t,n,r){var a=t.userCode,o=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),s=o.map((function(e){return e.shapeInfo})),u={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},c=zm(o,u,a,t.packedInputs),l=e.createProgram(c),g=null,d=e.getUniformLocation(l,"NAN",!1);1===Object(i.Ud)().getNumber("WEBGL_VERSION")&&(g=e.getUniformLocation(l,"INFINITY",!1));for(var h={},f=0;f<t.variableNames.length;f++){var p=t.variableNames[f];h[p]=e.getUniformLocation(l,p,false),h["offset".concat(p)]=e.getUniformLocation(l,"offset".concat(p),false)}return{program:t,source:c,webGLProgram:l,uniformLocations:h,inShapeInfos:s,outShapeInfo:u,infLoc:g,nanLoc:d}}function ib(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],o=a.shape;if(!i.tf.arraysEqual(r,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(o," must match"));if(!e.isUniform||!a.isUniform){var s=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!i.tf.arraysEqual(s,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(u," must match"))}}))}function ob(e,t,n,r,a){ib(t.inShapeInfos,n),ib([t.outShapeInfo],[r]);var o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o,s[0],s[1]):e.setOutputMatrixTexture(o,s[0],s[1]),e.setProgram(t.webGLProgram),1===Object(i.Ud)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],o=t.uniformLocations[a],s=t.uniformLocations["offset".concat(a)];if(null!=o)if(n.isUniform)if(i.tf.sizeFromShape(n.shape)<2)e.gl.uniform1f(o,n.uniformValues[0]);else{var u=n.uniformValues;u instanceof Float32Array||(u=new Float32Array(u)),e.gl.uniform1fv(o,u)}else null!=n.texData.slice&&null!=s&&e.gl.uniform1i(s,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,o,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}function sb(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a}var ub=cd,cb=th,lb=nh,gb=ih,db=gh,hb=Dh,fb=af,pb=lf,Ib=Sf,Cb=Mf,mb=Tf,bb=jf,vb=Hf,Ab=qf,yb=tp,wb=ap,Gb=op,Bb=Ap,xb=Gp,Sb=Fp,kb=jh,Zb=zp,Rb=qp,Nb=gI,Ob=hI,Wb=BI,Fb=md,Mb=Qd,Vb=KI,Tb=DI,Eb=UI,jb=uC,Lb=gC,Xb=fC,Hb=IC,Yb=If,zb=yC,Kb=GC,_b=Bd,Db=NC;function Pb(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function Ub(e,t){return 1===t?[e]:Pb(e,t)}var Jb=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=Ub("rc",n),a=tb(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),s=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}};var Qb=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e){var t=wm(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(Gm(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")};var qb=function(){function e(t){Object(Ur.a)(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return Object(Jr.a)(e,[{key:"acquireTexture",value:function(e,t,n){var r=ev(t,n),a=tv(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=$b(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return r===LC.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===LC.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===LC.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===LC.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===LC.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=ev(n,r),o=tv(t,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);var s=$b(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=Object(i.Ud)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=s):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;var c=this.usedTextures[o],l=c.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(l,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function $b(e,t,n,r,a){var i,s=function(e,t){switch(e){case LC.PACKED_2X2_FLOAT32:return jm(t);case LC.PACKED_2X2_FLOAT16:return Lm(t);case LC.UNPACKED_FLOAT32:return Vm(t);case LC.UNPACKED_FLOAT16:return Tm(t);case LC.PACKED_4X1_UNSIGNED_BYTE:return Em(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var u=_C(e[0],e[1]),c=Object(o.a)(u,2);i=c[0]*c[1]}else{var l=zC(e[0],e[1]),g=Object(o.a)(l,2);i=g[0]*g[1]}return i*function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,s)}function ev(e,t){if(e===jC.UPLOAD)return LC.PACKED_2X2_FLOAT32;if(e===jC.RENDER||null==e)return function(e){return Object(i.Ud)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?LC.PACKED_2X2_FLOAT32:LC.UNPACKED_FLOAT32:e?LC.PACKED_2X2_FLOAT16:LC.UNPACKED_FLOAT16}(t);if(e===jC.DOWNLOAD||e===jC.PIXELS)return LC.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function tv(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var nv=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},rv="if (isnan(x)) return x;",av="return x;",iv="return abs(x);";var ov="return (x >= 0.0) ? x : (exp(x) - 1.0);",sv=rv+"\n  return (x < 0.0) ? 0.0 : x;\n",uv=rv+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",cv="return x;",lv="return 1.0 / (1.0 + exp(-1.0 * x));",gv="return x;",dv="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",hv="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",fv="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",pv="return 1.0 / (1.0 + exp(-1.0 * x));",Iv=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},Cv=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=Ub("rc",n),a=tb(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")},mv=i.he.whereImpl,bv={};var vv=Object(i.Ud)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var Av=function(e){Object(Qr.a)(n,e);var t=Object(qr.a)(n);function n(e){var r,a;if(Object(Ur.a)(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!Object(i.Ud)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var o=YC(Object(i.Ud)().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Object(i.Ud)().getNumber("WEBGL_VERSION"))in bv||(bv[a]={}),bv[a]),r.gpgpu=new Hm(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new qb(r.gpgpu),r.numMBBeforeWarning=null==Object(i.Ud)().global.screen?1024:Object(i.Ud)().global.screen.height*Object(i.Ud)().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new i.L(Object(ta.a)(r),Object(i.Td)()),r}return Object(Jr.a)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((Object(i.Ud)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(i.Ud)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:jC.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if(Object(i.Ud)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:jC.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,o=t.slice,s=t.shape,u=t.isPacked;if(null!=o){var c;c=u?new Iv(s,cv):new nv(s,cv);var l=this.runWebGLProgram(c,[{dataId:e,shape:s,dtype:r}],r),g=this.readSync(l.dataId);return this.disposeIntermediateTensorInfo(l),g}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var d,h,f=null!=this.activeTimers;if(f&&(d=i.tf.now()),"complex64"===r){var p=this.readSync(a.real.dataId),I=this.readSync(a.imag.dataId);h=i.ud.mergeRealAndImagArrays(p,I)}else h=this.getValuesFromTexture(e);return f&&(this.downloadWaitMs+=i.tf.now()-d),this.convertAndCacheOnCPU(e,h)}},{key:"read",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n,r,a,o,s,u,c,l,g,d,h,f,p,I,C,m,b,v,A,y,w,G;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,o=r.shape,s=r.slice,u=r.dtype,c=r.complexTensorInfos,l=r.isPacked,null==s){e.next=11;break}return g=l?new Iv(o,cv):new nv(o,cv),d=this.runWebGLProgram(g,[{dataId:t,shape:o,dtype:u}],u),h=this.read(d.dataId),this.disposeIntermediateTensorInfo(d),e.abrupt("return",h);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(Object(i.Ud)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Object(i.Ud)().getNumber("WEBGL_VERSION")){e.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(f=null,"complex64"!==u&&Object(i.Ud)().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),C=this.texData.get(p.dataId),f=(I=this.gpgpu).createBufferFromTexture.apply(I,[C.texture].concat(Object(Yn.a)(KC(o))))),this.pendingRead.set(t,[]),"complex64"===u){e.next=21;break}return e.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==u){e.next=30;break}return e.next=24,Promise.all([this.read(c.real.dataId),this.read(c.imag.dataId)]);case 24:b=e.sent,v=b[0],A=b[1],m=i.ud.mergeRealAndImagArrays(v,A),e.next=31;break;case 30:null==f?m=this.getValuesFromTexture(t):(y=i.tf.sizeFromShape(o),m=this.gpgpu.downloadFloat32MatrixFromBuffer(f,y));case 31:return null!=p&&this.disposeIntermediateTensorInfo(p),w=this.convertAndCacheOnCPU(t,m),G=this.pendingRead.get(t),this.pendingRead.delete(t),G.forEach((function(e){return e(w)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Object(i.Td)().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",w);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return i.tf.decodeString(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(i.zd)(e.shape,e.dtype,n)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!UC(n)){if(Object(i.Ud)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,o=i.tf.sizeFromShape(n);if(Object(i.Ud)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s,u=this.decode(e),c=this.texData.get(u.dataId),l=(s=this.gpgpu).downloadMatrixFromPackedTexture.apply(s,[c.texture].concat(Object(Yn.a)(KC(n)))).subarray(0,o);return this.disposeIntermediateTensorInfo(u),l}var g=Object(i.Ud)().getBool("WEBGL_PACK")&&!0===a,d=g?hm(n):n,h=g?new Zm(d):new km(d),f=this.runWebGLProgram(h,[{shape:d,dtype:r,dataId:e}],"float32"),p=this.texData.get(f.dataId),I=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(f),I}},{key:"timerAvailable",value:function(){return Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n,r,a,o,s,u,c;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),o=i.tf.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),s=i.tf.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=19;break}return e.next=14,Promise.all(o);case 14:c=e.sent,u.kernelMs=i.tf.sum(c),u.getExtraProfileInfo=function(){return c.map((function(e,t){return{name:s[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=20;break;case 19:u.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",u);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:i.tf.now(),endMs:null}}},{key:"endTimer",value:function(e){return Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=i.tf.now(),e)}},{key:"getQueryTime",value:function(){var e=Object(fo.a)(ho.a.mark((function e(t){var n;return ho.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object(i.Ud)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vv;return Object(i.Ud)().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&i.tf.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){i.ud.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return mv(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new Iv(e.shape,t),a=this.compileAndRun(r,[e],n);return Object(i.Td)().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=Fb(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Object(i.Ud)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,iv,e.dtype);var n=new nv(e.shape,iv),r=this.compileAndRun(n,[e]);return Object(i.Td)().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&i.tf.isString(n[0])){var a=n.map((function(e){return i.tf.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){var r=this.makeTensorInfo(e,t,n).dataId;return Object(i.Td)().makeTensorFromDataId(r,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new Cv(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new Jb(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[gm(e.shape)].concat(Object(Yn.a)(dm(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[gm(t)].concat(Object(Yn.a)(dm(t))),i=new Qb(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=hm(a);t=r?new Sm(o):new xm(o);return{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(s.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===EC.DENSE){var c=KC(e.outputShape);u.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===i.tf.sizeFromShape(s.shape))return u.values=i.tf.getTypedArrayFromDType(s.dtype,0),s;var l=[],g=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&i.tf.sizeFromShape(t.shape)<=Object(i.Ud)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!pm(n.shape,t.shape)){var r=t,o=t.shape;t.shape=n.shape,t=a.packedReshape(t,o),l.push(t),n=a.texData.get(t.dataId),r.shape=o}return a.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var d,h={shape:s.shape,texData:u,isUniform:!1},f=sb(e,g,h),p=this.getAndSaveBinary(f,(function(){return ab(a.gpgpu,e,g,h)})),I=null!=this.activeTimers;I&&(d=this.startTimer()),ob(this.gpgpu,p,g,h,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),I&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)}));var C=Object(i.Ud)().get("WEBGL_FLUSH_THRESHOLD");if(C>0){var m=i.tf.now();m-this.lastGlFlushTime>C&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=m)}if(!Object(i.Ud)().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===o){var b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return i}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!Object(i.Ud)().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(i.mf)((function(){if(!Object(i.Ud)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Object(i.Ud)().getBool("DEBUG");Object(i.Ud)().set("DEBUG",!1);var n=e.abs(Object(i.Me)(1e-8)).dataSync()[0];if(Object(i.Ud)().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,s=t.texture,u=t.usage,c=t.isPacked;if(null==s){var l,g=null!=this.activeTimers;g&&(l=i.tf.now());var d=t.texShape;if(null==d&&(d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(i.Ud)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?i.tf.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=i.tf.squeezeShape(e);e=r.newShape}var a=i.tf.sizeFromShape(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var s=gm(e),u=2,c=2;if(e.length){var l=dm(e),g=Object(o.a)(l,2);u=g[0],c=g[1]}return a=s*(u/2)*(c/2),i.tf.sizeToSquarishShape(a).map((function(e){return 2*e}))}return i.tf.sizeToSquarishShape(a)}(n,c),t.texShape=d),null!=a){var h,f=hm(n),p=d[1],I=d[0],C=a instanceof Uint8Array;if(c){var m=_C(d[0],d[1]),b=Object(o.a)(m,2);p=b[0],I=b[1],h=new Nm(f,[I,p],C)}else h=new Rm(f,[I,p],C);var v=this.makeTensorInfo([I,p],r);this.texData.get(v.dataId).usage=C?jC.PIXELS:jC.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,I,a);var A=this.runWebGLProgram(h,[v],r,null,!0),y=this.texData.get(A.dataId);t.texture=y.texture,t.texShape=y.texShape,t.isPacked=y.isPacked,t.usage=y.usage,this.disposeIntermediateTensorInfo(v),this.texData.delete(A.dataId),t.values=null,g&&(this.uploadWaitMs+=i.tf.now()-l)}else{var w=this.acquireTexture(d,u,r,c);t.texture=w}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*i.tf.bytesPerElement(t)}}]),n}(i.wb);Av.nextDataId=0;i.Od.isBrowser()&&Object(i.He)("webgl",(function(){return new Av}),2);var yv=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["A","B"],this.outputShape=i.ud.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},wv=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(Ur.a)(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i.ud.assertAndGetBroadcastShape(n,r);var o=this.outputShape.length,s="";if(a)if(0===o||1===i.tf.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var u=tb(o);if(s="\n          ".concat(u," coords = getOutputCoords();\n        "),1===o)s+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var c=Ub("coords",o);s+="\n            bool nextRowOutOfBounds =\n              (".concat(c[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(c[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(s,"\n\n        setOutput(result);\n      }\n    ")};function Gv(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Bv={kernelName:i.rb,backendName:"webgl",kernelFunc:Gv};function xv(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=Gv({inputs:{x:r},backend:n}),u=Gv({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}var Sv={kernelName:i.y,backendName:"webgl",kernelFunc:xv},kv="return (a < 0.) ? b * a : a;",Zv="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Rv={kernelName:i.zb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.alpha,s=n.makeTensorInfo([],"float32",i.tf.createScalarValue(o,"float32")),u=Object(i.Ud)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wv(Zv,a.shape,s.shape):new yv(kv,a.shape,s.shape),c=n.runWebGLProgram(u,[a,s],a.dtype);return n.disposeIntermediateTensorInfo(s),c}},Nv="return (a < 0.) ? b * a : a;",Ov="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Wv={kernelName:i.hc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,o=Object(i.Ud)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wv(Ov,r.shape,a.shape):new yv(Nv,r.shape,a.shape);return n.runWebGLProgram(o,[r,a],r.dtype)}};function Fv(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var o,s=e.inputs,u=e.backend,c=s.x,l=u,g=a||c.dtype;if(l.shouldExecuteOnCPU([c])&&null!=r){var d=l.texData.get(c.dataId),h=r(d.values,g);return l.makeTensorInfo(c.shape,g,h)}return o=Object(i.Ud)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Iv(c.shape,n):new nv(c.shape,t),l.runWebGLProgram(o,[c],g)}}function Mv(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,s=e.supportsComplex,u=void 0!==s&&s,c=e.cpuKernelImpl,l=e.dtype;return function(e){var r=e.inputs,s=e.backend,g=r.a,d=r.b,h=s;if(u&&"complex64"===g.dtype){var f=h.texData.get(g.dataId),p=h.texData.get(d.dataId),I=[[f.complexTensorInfos.real,p.complexTensorInfos.real],[f.complexTensorInfos.imag,p.complexTensorInfos.imag]].map((function(e){var n=Object(o.a)(e,2),r=n[0],a=n[1],s={dataId:r.dataId,dtype:r.dtype,shape:g.shape},u={dataId:a.dataId,dtype:a.dtype,shape:d.shape},c=new yv(t,g.shape,d.shape);return h.runWebGLProgram(c,[s,u],Object(i.sf)(r.dtype,a.dtype))})),C=Object(o.a)(I,2),m=C[0],b=C[1],v=xv({inputs:{real:m,imag:b},backend:h});return h.disposeIntermediateTensorInfo(m),h.disposeIntermediateTensorInfo(b),v}var A,y=l||Object(i.sf)(g.dtype,d.dtype);if(("string"===g.dtype||"string"===d.dtype||h.shouldExecuteOnCPU([g,d]))&&null!=c){var w=h.texData.get(g.dataId).values,G=h.texData.get(d.dataId).values,B="string"===g.dtype?i.ud.fromUint8ToStringArray(w):w,x="string"===g.dtype?i.ud.fromUint8ToStringArray(G):G,S=c(g.shape,d.shape,B,x,y),k=Object(o.a)(S,2),Z=k[0],R=k[1],N=h.makeTensorInfo(R,y);return h.texData.get(N.dataId).values=Z,N}return A=Object(i.Ud)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new wv(n,g.shape,d.shape,a):new yv(t,g.shape,d.shape),h.runWebGLProgram(A,[g,d],y)}}function Vv(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?gv:av;if("relu"===e)return t?hv:sv;if("elu"===e)return t?dv:ov;if("relu6"===e)return t?fv:uv;if("prelu"===e)return t?Ov:Nv;if("leakyrelu"===e)return t?Zv:kv;if("sigmoid"===e)return t?pv:lv;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var Tv=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Object(Ur.a)(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var l=a?t[1]:t[2],g=Math.ceil(l/2),d=a?"i * 2, rc.y":"rc.y, i * 2",h=i?"rc.z, i * 2":"i * 2, rc.z",f=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],I="",C="";s&&(I=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),C="result = activation(result);");var m=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");var b="rc.x",v="rc.x";t[0]<n[0]?b="int(min(float(rc.x), ".concat(t[0]-1,".))"):n[0]<t[0]&&(v="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(I,"\n\n      const float sharedDimension = ").concat(g,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(g,"; i++) {\n          int batchA = ").concat(b,";\n          int batchB = ").concat(v,";\n          vec4 a = getMatrixA(batchA, ").concat(d,");\n          vec4 b = getMatrixB(batchB, ").concat(h,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(p[0],");\n          result += (").concat(f[1]," * ").concat(p[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(m,"\n\n        ").concat(C,"\n\n        setOutput(result);\n      }\n    ")},Ev="return areal * breal - aimag * bimag;",jv="return areal * bimag + aimag * breal;",Lv=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=i.ud.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},Xv="return a * b;";function Hv(e){var t,n=e.inputs,r=e.backend,a=n.a,s=n.b,u=i.ud.upcastType(a.dtype,s.dtype);if("complex64"===a.dtype){var c=r.texData.get(a.dataId),l=r.texData.get(s.dataId),g=new Lv(Ev,a.shape,s.shape),d=new Lv(jv,a.shape,s.shape),h=[{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:a.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],f=r.runWebGLProgram(g,h,"float32"),p=r.runWebGLProgram(d,h,"float32"),I=xv({inputs:{real:f,imag:p},backend:r});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(p),I}if(r.shouldExecuteOnCPU([a,s])){var C=r.texData.get(a.dataId),m=r.texData.get(s.dataId),b=kb(a.shape,s.shape,C.values,m.values,u),v=Object(o.a)(b,2),A=v[0],y=v[1],w=r.makeTensorInfo(y,u);return r.texData.get(w.dataId).values=A,w}return t=Object(i.Ud)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wv(Xv,a.shape,s.shape):new yv(Xv,a.shape,s.shape),r.runWebGLProgram(t,[a,s],u)}var Yv={kernelName:i.Vb,backendName:"webgl",kernelFunc:Hv};function zv(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.shape,s=n,u=i.tf.sizeFromShape(a.shape),c=i.tf.inferFromImplicitShape(o,u),l=i.tf.sizeFromShape(c);i.tf.assert(u===l,(function(){return"The new shape (".concat(c,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(u," elements. The new shape and old ")+"shape must have the same number of elements."}));var g=s.texData.get(a.dataId);return!g.isPacked||pm(a.shape,c)||null!==g.texture&&pm(g.shape,c)?(s.incRef(a.dataId),{dataId:a.dataId,shape:c,dtype:a.dtype}):function(e,t,n){var r=[gm(e.shape)].concat(Object(Yn.a)(dm(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[gm(t)].concat(Object(Yn.a)(dm(t))),o=new Qb(i,r),s=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(a,c,s)}var Kv={kernelName:i.pc,backendName:"webgl",kernelFunc:zv},_v=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,o=t.inSize,s=t.outSize;this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="sumValue += dot(values, ones);";if(null!=n){var g=1/n;l="sumValue += dot(values * ".concat(i.tf.isInt(g)?g.toPrecision(2):g,", ones);")}var d="";o%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")},Dv=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),g=r%4,d="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(u,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),h="vec4";"all"===n?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===n&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(d,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===g,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(2===g,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(d,"\n        } else if (").concat(3===g,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(d,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")};function Pv(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=i.ud.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),o=e,s=0;s<a.length;s++){var u,c=a[s],l=c.inSize,g=c.windowSize,d=c.outSize,h=void 0;h="mean"===n?0===s?new _v({windowSize:g,inSize:l,batchSize:e.shape[0],outSize:d},l):new _v({windowSize:g,inSize:l,batchSize:e.shape[0],outSize:d}):new Dv({windowSize:g,inSize:l,batchSize:e.shape[0],outSize:d},n),u=o,o=r.runWebGLProgram(h,[o],t),u.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(u)}return o}var Uv=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=tb(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")};var Jv=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=tb(this.rank),o=Pb("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),g="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(g,";\n      if(").concat(l,") {\n        result[1] = ").concat(g,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(g,";\n        if(").concat(l,") {\n          result[3] = ").concat(g,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function Qv(e,t,n){var r=Object(i.Ud)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Jv(e.shape,t):new Uv(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function qv(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,s=e.shape.length,u=i.tf.parseAxisParam(a,e.shape),c=u,l=i.ud.getAxesPermutation(c,s),g=null!=l,d=e;g&&(d=Qv(e,l,r),c=i.ud.getInnerMostAxes(c.length,s)),i.ud.assertAxesAreInnerMostDims("sum",c,s);var h=i.ud.computeOutAndReduceShapes(d.shape,c),f=Object(o.a)(h,2),p=f[0],I=f[1],C=p;n&&(C=i.ud.expandShapeToKeepDim(p,u));var m=i.tf.sizeFromShape(I),b=zv({inputs:{x:d},attrs:{shape:[i.tf.sizeFromShape(e.shape)/m,m]},backend:r}),v=Pv(b,Object(i.gf)(e.dtype),"sum",r),A=zv({inputs:{x:v},attrs:{shape:C},backend:r});return r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),g&&r.disposeIntermediateTensorInfo(d),A}(t.x,r.axis,r.keepDims,n)}var $v={kernelName:i.Yc,backendName:"webgl",kernelFunc:qv};function eA(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var g=s.texData.get(i.dataId).values,d=_b(g,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=d}else t=Qv(i,o,s);return t}var tA={kernelName:i.gd,backendName:"webgl",kernelFunc:eA};function nA(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,o=e.backend,s=e.bias,u=void 0===s?null:s,c=e.preluActivationWeights,l=void 0===c?null:c,g=e.leakyreluAlpha,d=void 0===g?0:g,h=e.activation,f=void 0===h?null:h,p=t.shape.length,I=n.shape.length,C=r?t.shape[p-2]:t.shape[p-1],m=a?n.shape[I-1]:n.shape[I-2],b=r?t.shape[p-1]:t.shape[p-2],v=a?n.shape[I-2]:n.shape[I-1],A=t.shape.slice(0,-2),y=n.shape.slice(0,-2),w=i.tf.sizeFromShape(A),G=i.tf.sizeFromShape(y),B=w===G||1===w||1===G;i.tf.assert(p>=2&&I>=2&&B,(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(A,") and (").concat(y,").")}));var x=(w>G?t.shape.slice(0,-2):n.shape.slice(0,-2)).concat([b,v]);i.tf.assert(C===m,(function(){return"Error in matMul: inner shapes (".concat(C,") and (")+"".concat(m,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var S,k=r?[w,C,b]:[w,b,C],Z=a?[G,v,m]:[G,m,v],R=zv({inputs:{x:t},backend:o,attrs:{shape:k}}),N=zv({inputs:{x:n},backend:o,attrs:{shape:Z}}),O=[R,N],W=Math.max(w,G),F=r?R.shape[1]:R.shape[2],M=null!=u,V=null!=l,T="leakyrelu"===f,E=null!=f?Vv(f,!0):null;if((1===b||1===v)&&F>1e3&&!1===(M||V||T||null!=E)){var j=R,L=N;r&&(j=eA({inputs:{x:R},backend:o,attrs:{perm:[0,2,1]}}),O.push(j)),a&&(L=eA({inputs:{x:N},backend:o,attrs:{perm:[0,2,1]}}),O.push(L));var X=1===v,H=j;1!==v&&(H=zv({inputs:{x:j},backend:o,attrs:{shape:[W,F,1]}}),O.push(H));var Y=1===v?2:1,z=L;X&&(z=zv({inputs:{x:L},backend:o,attrs:{shape:[W,1,F]}}),O.push(z));var K=Hv({inputs:{a:H,b:z},backend:o});S=qv({inputs:{x:K},backend:o,attrs:{axis:Y,keepDims:!0}}),O.push(K)}else{var _=Object(i.sf)(t.dtype,n.dtype),D=new Tv(k,Z,[W,b,v],r,a,M,E,V,T),P=[R,N];if(null!=u&&P.push(u),V&&P.push(l),T){var U=o.makeTensorInfo([],"float32",i.tf.createScalarValue(d,"float32"));P.push(U),O.push(U)}S=o.runWebGLProgram(D,P,_)}var J=zv({inputs:{x:S},backend:o,attrs:{shape:x}});O.push(S);for(var Q=0,q=O;Q<q.length;Q++){var $=q[Q];o.disposeIntermediateTensorInfo($)}return J}var rA={kernelName:i.ld,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,u=r.transposeA,c=r.transposeB,l=r.activation;return nA({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},aA="return abs(x);";var iA={kernelName:i.a,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var o=r.texData.get(a.dataId),s=Fb(o.values);return r.makeTensorInfo(a.shape,a.dtype,s)}return t=Object(i.Ud)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Iv(a.shape,aA):new nv(a.shape,aA),r.runWebGLProgram(t,[a],a.dtype)}},oA=Fv({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),sA={kernelName:i.b,backendName:"webgl",kernelFunc:oA},uA=Fv({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),cA={kernelName:i.c,backendName:"webgl",kernelFunc:uA},lA="return a + b;",gA=Mv({opSnippet:lA,packedOpSnippet:lA,supportsComplex:!0,cpuKernelImpl:ub}),dA={kernelName:i.d,backendName:"webgl",kernelFunc:gA},hA=function e(t,n){Object(Ur.a)(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},fA=function e(t,n){Object(Ur.a)(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")};var pA={kernelName:i.e,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return Gv({inputs:{x:a[0]},backend:r});if(a.length>Object(i.Ud)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(a.length/2),s=e({inputs:a.slice(0,o),backend:r}),u=e({inputs:a.slice(o),backend:r});return e({inputs:[s,u],backend:r})}var c=a.map((function(e){return e.dtype})).reduce((function(e,t){return Object(i.sf)(e,t)})),l=a.map((function(e){return e.shape})),g=Object(i.Ud)().getBool("WEBGL_PACK")?new fA(a[0].shape,l):new hA(a[0].shape,l);return r.runWebGLProgram(g,a,c)}};var IA={kernelName:i.f,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis,u=r.keepDims,c=a.shape.length,l=i.tf.parseAxisParam(s,a.shape),g=l,d=i.ud.getAxesPermutation(g,c),h=a;null!=d&&(h=eA({inputs:{x:a},backend:n,attrs:{perm:d}}),g=i.ud.getInnerMostAxes(g.length,c)),i.ud.assertAxesAreInnerMostDims("all",g,c);var f,p=i.ud.computeOutAndReduceShapes(h.shape,g),I=Object(o.a)(p,2),C=I[0],m=I[1],b=zv({inputs:{x:h},backend:n,attrs:{shape:[-1,i.tf.sizeFromShape(m)]}}),v=Pv(b,b.dtype,"all",n);return f=zv(u?{inputs:{x:v},backend:n,attrs:{shape:i.ud.expandShapeToKeepDim(C,l)}}:{inputs:{x:v},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),null!=d&&n.disposeIntermediateTensorInfo(h),f}};var CA={kernelName:i.g,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis,u=r.keepDims,c=a.shape.length,l=i.tf.parseAxisParam(s,a.shape),g=l,d=i.ud.getAxesPermutation(g,c),h=a;null!=d&&(h=eA({inputs:{x:a},backend:n,attrs:{perm:d}}),g=i.ud.getInnerMostAxes(g.length,c)),i.ud.assertAxesAreInnerMostDims("any",g,c);var f,p=i.ud.computeOutAndReduceShapes(h.shape,g),I=Object(o.a)(p,2),C=I[0],m=I[1],b=zv({inputs:{x:h},backend:n,attrs:{shape:[-1,i.tf.sizeFromShape(m)]}}),v=Pv(b,b.dtype,"any",n);return f=zv(u?{inputs:{x:v},backend:n,attrs:{shape:i.ud.expandShapeToKeepDim(C,l)}}:{inputs:{x:v},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),null!=d&&n.disposeIntermediateTensorInfo(h),f}},mA=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(u,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")},bA=function e(t,n,r,a){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,i.tf.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var o=t[t.length-1],s=Math.ceil(o/n);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),a||this.variableNames.push("bestIndicesA");var u,c,l=this.outputShape,g=l.length,d=tb(g),h=Ub("coords",g);if(1===s){var f=tb(c=g+1);u="\n        ".concat(f," sourceLocR = ").concat(f,"(").concat(h.join(),", 0);\n        ++").concat(h[g-1],";\n        ").concat(f," sourceLocG = ").concat(f,"(").concat(h.join(),", 0);\n        ++").concat(h[g-2],";\n        ").concat(f," sourceLocA = ").concat(f,"(").concat(h.join(),", 0);\n        --").concat(h[g-1],";\n        ").concat(f," sourceLocB = ").concat(f,"(").concat(h.join(),", 0);\n        --").concat(h[g-2],";")}else c=g,u="\n        ".concat(d," sourceLocR = coords;\n        ++").concat(h[g-1],";\n        ").concat(d," sourceLocG = coords;\n        ++").concat(h[g-2],";\n        ").concat(d," sourceLocA = coords;\n        --").concat(h[g-1],";\n        ").concat(d," sourceLocB = coords;\n        --").concat(h[g-2],";");var p=["x","y","z","w","u","v"].slice(0,c),I="."+p[c-1],C=p.map((function(e){return"int "+e})),m=Ub("sourceLocR",c-1).concat("inIdx.r"),b=Ub("sourceLocG",c-1).concat("inIdx.g"),v=Ub("sourceLocB",c-1).concat("inIdx.b"),A=Ub("sourceLocA",c-1).concat("inIdx.a"),y="max"===r?"greaterThan":"lessThan",w=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),"),\n                             getBestIndicesAChannel(").concat(A.join(),")));"),G="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(v.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(A.join(),") : 0.)"),B=a?"":"\n      float getBestIndicesAChannel(".concat(C.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(C.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(B,"\n      void main() {\n        ").concat(d," coords = getOutputCoords();\n        bool hasNextCol = ").concat(h[g-1]," < ").concat(l[g-1]-1,";\n        bool hasNextRow = ").concat(h[g-2]," < ").concat(l[g-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(I,", sourceLocG").concat(I,",\n          sourceLocB").concat(I,", sourceLocA").concat(I,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(G,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(G,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(y,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};function vA(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],o=t.shape[1];null!=r&&(a=r.shape[0],o=r.shape[1]);var s=i.ud.computeOptimalWindowSize(o),u={windowSize:s,inSize:o,batchSize:a,outSize:Math.ceil(o/s)},c=new mA(u,n,null==r),l=[t];null!=r&&l.push(r);var g=e.runWebGLProgram(c,l,"int32");if(1===g.shape[1])return g;var d=vA(e,t,n,g);return e.disposeIntermediateTensorInfo(g),d}function AA(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,o=a[a.length-1],s=i.ud.computeOptimalWindowSize(o),u=new bA(a,s,n,null==r),c=null==r?[t]:[t,r],l=e.runWebGLProgram(u,c,"int32");if(l.shape.length===t.shape.length){var g=AA(e,t,n,l);return e.disposeIntermediateTensorInfo(l),g}return l}function yA(e,t,n,r){var a=[n];if(i.ud.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Object(i.Ud)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var s=[],u=i.ud.computeOutAndReduceShapes(t.shape,a),c=Object(o.a)(u,2),l=c[0],g=c[1],d=i.tf.sizeFromShape(g),h=zv({inputs:{x:t},backend:e,attrs:{shape:[-1,d]}});s.push(h);var f=vA(e,h,r);s.push(f);var p=zv({inputs:{x:f},backend:e,attrs:{shape:l}});return s.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),p}return AA(e,t,r)}var wA={kernelName:i.h,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,s=i.tf.parseAxisParam(o,a.shape),u=i.ud.getAxesPermutation(s,a.shape.length),c=a,l=[];null!=u&&(c=eA({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(c),s=i.ud.getInnerMostAxes(s.length,c.shape.length)),i.ud.assertAxesAreInnerMostDims("argMax",[s[0]],c.shape.length);var g=yA(n,c,s[0],"max");return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}};var GA={kernelName:i.i,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,s=i.tf.parseAxisParam(o,a.shape),u=i.ud.getAxesPermutation(s,a.shape.length),c=a,l=[];null!=u&&(c=eA({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(c),s=i.ud.getInnerMostAxes(s.length,c.shape.length)),i.ud.assertAxesAreInnerMostDims("argMin",[s[0]],c.shape.length);var g=yA(n,c,s[0],"min");return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},BA=Fv({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),xA={kernelName:i.j,backendName:"webgl",kernelFunc:BA},SA=Fv({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),kA={kernelName:i.k,backendName:"webgl",kernelFunc:SA},ZA=Fv({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),RA={kernelName:i.l,backendName:"webgl",kernelFunc:ZA},NA=Mv({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),OA={kernelName:i.m,backendName:"webgl",kernelFunc:NA},WA=Fv({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),FA={kernelName:i.n,backendName:"webgl",kernelFunc:WA},MA=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(Ur.a)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,g=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;var p="avg"===n,I="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),C="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),m="0.0";if(p||(m="-1.0 / 1e-20"),r){var b=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(g,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(b," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?I:C:"wR * ".concat(d," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var v="max",A="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(A="avgValue / count");var y=4*Math.floor(o/4),w=o%4,G="\n      if (".concat(p,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(v,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(f,");\n      const float initializationValue = ").concat(m,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(m,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(g,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(y,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(G,"\n          }\n\n          int xC = xCCorner + ").concat(y,";\n          if (").concat(1===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(G,"\n          } else if (").concat(2===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(G,"\n          } else if (").concat(3===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(G,"\n          }\n        }\n        setOutput(").concat(A,");\n      }\n    ")}},VA=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(Ur.a)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,g=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,I=t.padInfo.front,C=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,v="0.0";if(b||(v="-1.0 / 1e-20"),r){var A=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(I,", ").concat(C,", ").concat(m,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(g,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(p,";\n                  wC += ").concat(d,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(A," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(f," * ").concat(p," +\n                      wR * ").concat(p," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var y="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / count");var G=4*Math.floor(o/4),B=o%4,x="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(y,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(I,", ").concat(C,", ").concat(m,");\n      const float initializationValue = ").concat(v,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(v,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(g,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(G,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(d,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(d,", ch)\n              );\n\n              ").concat(x,"\n            }\n\n            int xC = xCCorner + ").concat(G,";\n            if (").concat(1===B,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(x,"\n            } else if (").concat(2===B,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(x,"\n            } else if (").concat(3===B,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(d,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(d,", ch),\n                initializationValue\n              );\n\n              ").concat(x,"\n            }\n          }\n          setOutput(").concat(w,");\n        }\n      }\n    ")}};var TA={kernelName:i.o,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;vm(a,"avgPool");var o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l=i.ud.computePool2DInfo(a.shape,o,s,1,u,c);if(1===l.filterWidth&&1===l.filterHeight&&i.tf.arraysEqual(l.inShape,l.outShape))return Gv({inputs:{x:a},backend:n});var g=new MA(l,"avg",!1);return n.runWebGLProgram(g,[a],"float32")}};var EA={kernelName:i.p,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode,l=r.dataFormat,g=i.ud.computePool3DInfo(a.shape,o,s,[1,1,1],u,c,l),d=new VA(g,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}},jA=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=u-1-t.padInfo.top,g=c-1-t.padInfo.left,d=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(g,");\n      const float avgMultiplier = float(").concat(d,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},LA=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,g=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=g-1-t.padInfo.front,p=d-1-t.padInfo.top,I=h-1-t.padInfo.left,C=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(I,");\n      const float avgMultiplier = float(").concat(C,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(g,";\n            wD += ").concat(u,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var XA={kernelName:i.q,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,g=i.ud.computePool3DInfo(o.shape,s,u,[1,1,1],c,l),d=new LA(g);return n.runWebGLProgram(d,[a],o.dtype)}};var HA={kernelName:i.r,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=o;vm([a,o],"avgPoolGrad");var u=r.filterSize,c=r.strides,l=r.pad,g=i.ud.computePool2DInfo(s.shape,u,c,1,l),d=new jA(g);return n.runWebGLProgram(d,[a],s.dtype)}};var YA={kernelName:i.s,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return nA({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},zA=function e(t,n,r,a,o,s){Object(Ur.a)(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],i.ud.assertAndGetBroadcastShape(t,n),i.ud.assertAndGetBroadcastShape(t,r);var u="0.0";null!=a&&(i.ud.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var c="1.0";null!=o&&(i.ud.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(u,";\n        float scale = ").concat(c,";\n        float inv = scale * inversesqrt(variance + float(").concat(s,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},KA=function e(t,n,r,a,o,s){Object(Ur.a)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],i.ud.assertAndGetBroadcastShape(t,n),i.ud.assertAndGetBroadcastShape(t,r);var u="vec4(0.0)";null!=a&&(i.ud.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var c="vec4(1.0)";null!=o&&(i.ud.assertAndGetBroadcastShape(t,o),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(u,";\n        vec4 scale = ").concat(c,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(s,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},_A={kernelName:i.jb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.mean,s=t.variance,u=t.offset,c=t.scale;i.tf.assert(o.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),i.tf.assert(null==u||o.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),i.tf.assert(null==c||o.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var l=r.varianceEpsilon;null==l&&(l=.001);var g=[a,o,s],d=null;null!=u&&(d=u.shape,g.push(u));var h=null;null!=c&&(h=c.shape,g.push(c));var f=Object(i.Ud)().getBool("WEBGL_PACK_NORMALIZATION")?new KA(a.shape,o.shape,s.shape,d,h,l):new zA(a.shape,o.shape,s.shape,d,h,l);return n.runWebGLProgram(f,g,g[0].dtype)}},DA=function(){function e(t){Object(Ur.a)(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=tb(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return PA.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),o=t.map((function(e,t){return"sourceLoc.".concat(PA[t]," = start[").concat(t,"] + coords.").concat(PA[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),PA=["x","y","z","w","u","v"];var UA=function(){function e(t){Object(Ur.a)(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=tb(this.rank),r=Ub("coords",this.rank),a=Ub("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();function JA(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.begin,u=r.size,c=i.Xe.parseSliceParams(a,s,u),l=Object(o.a)(c,2),g=l[0],d=l[1];if(i.Xe.assertParamsValid(a,g,d),0===i.tf.sizeFromShape(d))return n.makeTensorInfo(d,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var h=n.texData.get(a.dataId),f=Mb(h.values,g,d,a.shape,a.dtype);return n.makeTensorInfo(d,a.dtype,f)}var p=n.texData.get(a.dataId).isPacked,I=i.Xe.isSliceContinous(a.shape,g,d);if(p||!I){var C=Object(i.Ud)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UA(d):new DA(d),m=C.getCustomSetupFunc(g);return n.runWebGLProgram(C,[a],a.dtype,m)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),o=r.makeTensorInfo(n,e.dtype),s=r.texData.get(o.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=e.dtype;var u=i.Xe.computeFlatOffset(t,i.tf.computeStrides(e.shape));a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||e.dataId};var c=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,c+1),o}(a,g,d,n)}var QA={kernelName:i.Fc,backendName:"webgl",kernelFunc:JA},qA={kernelName:i.t,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.blockShape,s=r.crops;i.tf.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var u=o.reduce((function(e,t){return e*t})),c=i.ud.getReshaped(a.shape,o,u),l=i.ud.getPermuted(c.length,o.length),g=i.ud.getReshapedPermuted(a.shape,o,u),d=i.ud.getSliceBeginCoords(s,o.length),h=i.ud.getSliceSize(g,s,o.length),f=[],p=zv({inputs:{x:a},backend:n,attrs:{shape:c}}),I=eA({inputs:{x:p},backend:n,attrs:{perm:l}}),C=zv({inputs:{x:I},backend:n,attrs:{shape:g}}),m=JA({inputs:{x:C},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(I),f.push(C),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}};var $A={kernelName:i.u,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=cb(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}},ey=Mv({opSnippet:"return float(a != b);",cpuKernelImpl:Rb,dtype:"bool"}),ty={kernelName:i.ac,backendName:"webgl",kernelFunc:ey};function ny(e){var t=e.inputs,n=e.backend,r=t.input;return Gv({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var ry={kernelName:i.kc,backendName:"webgl",kernelFunc:ny};var ay={kernelName:i.v,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,o=n.x,s=a.dtype;if("complex64"===s){if("complex64"===o.dtype)return Gv({inputs:{x:o},backend:r});var u=i.yf(o.shape),c=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),l=xv({inputs:{real:c,imag:u},backend:r});return u.dispose(),r.disposeIntermediateTensorInfo(c),l}if("complex64"===o.dtype){var g=ny({inputs:{input:o},backend:r}),d=e({inputs:{x:g},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(g),d}if(!i.tf.hasEncodingLoss(o.dtype,s)){var h=Gv({inputs:{x:o},backend:r});return{dataId:h.dataId,shape:h.shape,dtype:s}}if("int32"===s)return function(e,t){var n=new nv(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===s){var f=r.makeTensorInfo([],"bool",i.tf.getTypedArrayFromDType("bool",1)),p=ey({inputs:{a:o,b:f},backend:r});return r.disposeIntermediateTensorInfo(f),p}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(s))}},iy="return ceil(x);",oy=Fv({opSnippet:iy,packedOpSnippet:iy,cpuKernelImpl:gb}),sy={kernelName:i.w,backendName:"webgl",kernelFunc:oy},uy=function(){function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),cy=function(){function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();var ly={kernelName:i.x,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,s=a.clipValueMin,u=a.clipValueMax,c=(t=Object(i.Ud)().getBool("WEBGL_PACK_CLIP")?new cy(o.shape):new uy(o.shape)).getCustomSetupFunc(s,u);return r.runWebGLProgram(t,[o],o.dtype,c)}},gy=function e(t){Object(Ur.a)(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};function dy(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var hy={kernelName:i.z,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new gy(r.shape),o=[dy(r,a.complexTensorInfos.real),dy(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},fy=function e(t){Object(Ur.a)(this,e),this.outputShape=[],this.outputShape=i.ud.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],o=1;o<n.length;o++){var s=n[o-1];a.push("else if (yC < ".concat(n[o],") ")+"setOutput(getT".concat(o,"(yR, yC-").concat(s,"));"))}var u=n.length,c=n[n.length-1];a.push("else setOutput(getT".concat(u,"(yR, yC-").concat(c,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")},py=function e(t,n){Object(Ur.a)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=i.ud.computeOutShape(t,n);var r=this.outputShape,a=r.length,o=tb(a),s=Ub("coords",a),u=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var c=new Array(t.length-1);c[0]=t[0][n];for(var l=1;l<c.length;l++)c[l]=c[l-1]+t[l][n];for(var g=u[n],d=u.slice(-2),h=u.join(),f="if (".concat(g," < ").concat(c[0],") {\n        return getChannel(\n            getT0(").concat(h,"), vec2(").concat(d.join(),"));\n        }"),p=1;p<c.length;p++){var I=c[p-1];f+="\n        if (".concat(g," < ").concat(c[p],"  && ").concat(g," >= ").concat(c[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(Iy(u,g,I),"),\n            vec2(").concat(Iy(d,g,I),"));\n        }")}var C=c.length,m=c[c.length-1];f+="\n        return getChannel(\n          getT".concat(C,"(").concat(Iy(u,g,m),"),\n          vec2(").concat(Iy(d,g,m),"));"),this.userCode="\n      float getValue(".concat(u.map((function(e){return"int "+e})),") {\n        ").concat(f,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(s,"), 0., 0., 0.);\n\n        ").concat(s[a-1]," = ").concat(s[a-1]," + 1;\n        if (").concat(s[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(s,");\n        }\n\n        ").concat(s[a-2]," = ").concat(s[a-2]," + 1;\n        if (").concat(s[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(s,");\n        }\n\n        ").concat(s[a-1]," = ").concat(s[a-1]," - 1;\n        if (").concat(s[a-2]," < ").concat(r[a-2]," &&\n            ").concat(s[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(s,");\n        }\n        setOutput(result);\n      }\n    ")};function Iy(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function Cy(e){var t=e.inputs,n=e.backend,r=t.input;return Gv({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var my={kernelName:i.sb,backendName:"webgl",kernelFunc:Cy};function by(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return ny({inputs:{input:e},backend:n})})),o=e.map((function(e){return Cy({inputs:{input:e},backend:n})})),s=by(a,t,n),u=by(o,t,n),c=xv({inputs:{real:s,imag:u},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),c}var l=n.shouldExecuteOnCPU(e);if("string"===r&&(l=!0),l){var g=e.map((function(e){var r=i.tf.sizeFromShape(e.shape.slice(t));return zv({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),d=g.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),h=i.ud.computeOutShape(g.map((function(e){return e.shape})),1),f=1===g[0].shape[0],p=db(d,h,r,f),I=i.ud.computeOutShape(e.map((function(e){return e.shape})),t),C=n.makeTensorInfo(I,r,p);return g.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),C}if(e.length>Object(i.Ud)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var m=Math.floor(e.length/2),b=by(e.slice(0,m),t,n),v=by(e.slice(m),t,n),A=by([b,v],t,n);return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),A}if(Object(i.Ud)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){var y=new py(e.map((function(e){return e.shape})),t);return n.runWebGLProgram(y,e,r)}var w=function(e,t,n){var r=i.ud.computeOutShape(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return zv({inputs:{x:e},attrs:{shape:[-1,i.tf.sizeFromShape(e.shape.slice(t))]},backend:n})})),outShape:r}}(e,t,n),G=w.tensors2D,B=w.outShape,x=new fy(G.map((function(e){return e.shape}))),S=n.runWebGLProgram(x,G,r);G.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var k=zv({inputs:{x:S},attrs:{shape:B},backend:n});return n.disposeIntermediateTensorInfo(S),k}function vy(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=i.tf.parseAxisParam(r,t[0].shape)[0],o=i.ud.computeOutShape(t.map((function(e){return e.shape})),a);if(0===i.tf.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var s=t.filter((function(e){return i.tf.sizeFromShape(e.shape)>0}));if(1===s.length)return Gv({inputs:{x:s[0]},backend:n});var u=s.map((function(e){return e.shape}));return i.ud.assertParamsConsistent(u,a),by(s,a,n)}var Ay={kernelName:i.A,backendName:"webgl",kernelFunc:vy},yy=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(Ur.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,g=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4,I="channelsLast"===t.dataFormat,C=I?1:2,m=I?2:3,b=I?3:1,v="",A="";r&&(v=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),A="result = activation(result);");var y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(b,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(C,"], coords[").concat(m,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(g,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(I,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(I,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(I,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(I,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(y,"\n        ").concat(A,"\n        setOutput(result);\n      }\n    ")},wy=function e(t){Object(Ur.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,g=t.filterDepth,d=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(g,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(d,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===p,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===p,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===p,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Gy=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,s=r.strideHeight,u=r.padInfo,c=r.outWidth,l=r.dilationWidth,g=r.dilationHeight,d=r.dataFormat,h=u.left,f=u.top,p=i*a,I=ym(),C="channelsLast"===d,m=C?0:1,b=C?1:2,v="",A=0;A<=1;A++)for(var y=0;y<=1;y++)v+="\n          blockIndex = rc.y + ".concat(y,";\n          pos = rc.x + ").concat(A,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(c,")) * ").concat(s," - ").concat(f,";\n            d0 = offsetY + ").concat(g," * (pos / ").concat(p,");\n\n            if(d0 < ").concat(n[m]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(c,".) * ").concat(o,". - ").concat(h,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(p,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[b]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(C,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*A+y,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*A+y,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(v,"\n\n        ").concat(I.output," = result;\n      }\n    ")};function By(e){var t,n=e.x,r=e.filter,a=e.convInfo,o=e.backend,s=e.bias,u=void 0===s?null:s,c=e.preluActivationWeights,l=void 0===c?null:c,g=e.leakyreluAlpha,d=void 0===g?0:g,h=e.activation,f=void 0===h?null:h,p=n.shape,I=o.texData.get(n.dataId),C=a.inChannels,m=p[0]*p[1]*p[2],b=a.outChannels,v="channelsLast"===a.dataFormat,A=[],y=(1===m||1===b)&&C>1e3,w=p[2]%2!==0&&!!I.isPacked;if(!y&&Object(i.Ud)().getBool("WEBGL_LAZILY_UNPACK")&&Object(i.Ud)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&w){var G=v?p[0]*p[1]*(p[2]+1):p[0]*p[2]*(p[3]+1),B={dataId:n.dataId,shape:[1,G,a.inChannels],dtype:n.dtype},x=I.shape;I.shape=I.shape.slice(),I.shape[I.shape.length-2]++,i.tf.assert(pm(I.shape,B.shape),(function(){return"packed reshape ".concat(I.shape," to ").concat(B.shape," isn't free")}));var S=zv({inputs:{x:r},backend:o,attrs:{shape:[1,a.inChannels,a.outChannels]}});A.push(S);var k=nA({a:B,b:S,backend:o,transposeA:false,transposeB:false,bias:u,activation:f,preluActivationWeights:l,leakyreluAlpha:d}),Z=o.texData.get(k.dataId);i.tf.assert(Z.isPacked,(function(){return"batchMatMul result is expected to be packed"})),I.shape=x,Z.shape=a.outShape,(t=Gv({inputs:{x:k},backend:o})).shape=a.outShape,A.push(k)}else{var R=zv({inputs:{x:n},backend:o,attrs:{shape:[1,v?p[0]*p[1]*p[2]:p[0]*p[2]*p[3],a.inChannels]}}),N=zv({inputs:{x:r},backend:o,attrs:{shape:[1,a.inChannels,a.outChannels]}}),O=nA({a:R,b:N,transposeA:false,transposeB:false,backend:o,bias:u,activation:f,preluActivationWeights:l,leakyreluAlpha:d});t=zv({inputs:{x:O},backend:o,attrs:{shape:a.outShape}}),A.push(R),A.push(N),A.push(O)}for(var W=0,F=A;W<F.length;W++){var M=F[W];o.disposeIntermediateTensorInfo(M)}return t}function xy(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,o=e.bias,s=void 0===o?null:o,u=e.preluActivationWeights,c=void 0===u?null:u,l=e.leakyreluAlpha,g=void 0===l?0:l,d=e.activation,h=void 0===d?null:d,f=r.filterWidth,p=r.filterHeight,I=r.inChannels,C=r.outWidth,m=r.outHeight,b="channelsLast"===r.dataFormat,v=f*p*I,A=m*C,y=[v,A],w=[],G=zv({inputs:{x:t},backend:a,attrs:{shape:t.shape.slice(1)}}),B=zv({inputs:{x:n},backend:a,attrs:{shape:[1,v,i.tf.sizeFromShape(n.shape)/v]}});w.push(G),w.push(B);var x=new Gy(y,G.shape,r),S=a.runWebGLProgram(x,[G],"float32"),k=zv({inputs:{x:S},backend:a,attrs:{shape:[1,y[0],y[1]]}});w.push(S),w.push(k);var Z=null!=s,R=null!=c,N="leakyrelu"===h,O=h?Vv(h,!0):null,W=new Tv(k.shape,B.shape,[1,A,r.outChannels],!0,!1,Z,O,R,N),F=[k,B];if(s&&F.push(s),R&&F.push(c),N){var M=a.makeTensorInfo([],"float32",i.tf.createScalarValue(g,"float32"));F.push(M),w.push(M)}var V=a.runWebGLProgram(W,F,"float32"),T=zv({inputs:{x:V},backend:a,attrs:{shape:b?[1,m,C,r.outChannels]:[1,r.outChannels,m,C]}});w.push(V);for(var E=0,j=w;E<j.length;E++){var L=j[E];a.disposeIntermediateTensorInfo(L)}return T}var Sy={kernelName:i.B,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,s=n.filter,u=a.strides,c=a.pad,l=a.dataFormat,g=a.dilations,d=a.dimRoundingMode,h=i.ud.convertConv2DDataFormat(l),f=i.ud.computeConv2DInfo(o.shape,s.shape,u,g,c,d,!1,h);if(1!==f.filterHeight||1!==f.filterWidth||1!==f.dilationHeight||1!==f.dilationWidth||1!==f.strideHeight||1!==f.strideWidth||"SAME"!==f.padInfo.type&&"VALID"!==f.padInfo.type)if(Object(i.Ud)().getBool("WEBGL_CONV_IM2COL")&&1===o.shape[0])t=xy({x:o,filter:s,convInfo:f,backend:r});else{var p=new yy(f);t=r.runWebGLProgram(p,[o,s],"float32")}else t=By({x:o,filter:s,convInfo:f,backend:r});var I=zv({inputs:{x:t},backend:r,attrs:{shape:f.outShape}});return r.disposeIntermediateTensorInfo(t),I}},ky=function e(t){Object(Ur.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Zy=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,u=r-1-t.padInfo.left,c=o?1:2,l=o?2:3,g=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(g,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ry=function e(t){Object(Ur.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ny=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Oy={kernelName:i.C,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.dy,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,g=r.filterShape,d=i.ud.convertConv2DDataFormat(c),h=i.ud.computeConv2DInfo(a.shape,g,s,1,u,l,!1,d),f=new ky(h);return n.runWebGLProgram(f,[a,o],"float32")}};var Wy={kernelName:i.D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.filter,s=r.inputShape,u=r.strides,c=r.pad,l=r.dataFormat,g=r.dimRoundingMode,d=i.ud.convertConv2DDataFormat(l),h=i.ud.computeConv2DInfo(s,o.shape,u,1,c,g,!1,d),f=new Zy(h);return n.runWebGLProgram(f,[a,o],"float32")}};var Fy={kernelName:i.E,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=r.strides,u=r.pad,c=r.dilations,l=i.ud.computeConv3DInfo(a.shape,o.shape,s,c,u),g=new wy(l);return n.runWebGLProgram(g,[a,o],"float32")}};var My={kernelName:i.F,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.dy,s=r.strides,u=r.pad,c=r.filterShape,l=i.ud.computeConv3DInfo(a.shape,c,s,1,u),g=new Ry(l);return n.runWebGLProgram(g,[a,o],"float32")}};var Vy={kernelName:i.G,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.filter,s=r.pad,u=r.strides,c=r.inputShape,l=i.ud.computeConv3DInfo(c,o.shape,u,1,s),g=new Ny(l);return n.runWebGLProgram(g,[a,o],"float32")}},Ty=Fv({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),Ey={kernelName:i.H,backendName:"webgl",kernelFunc:Ty},jy=Fv({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Ly={kernelName:i.I,backendName:"webgl",kernelFunc:jy},Xy=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var s=Object(o.a)(t,4),u=s[0],c=s[1],l=s[2],g=s[3],d=Object(o.a)(n,1)[0],h=Object(o.a)(r,2),f=h[0],p=h[1];this.outputShape=[d,f,p,g];var I="bilinear"===a?1:0,C="".concat(c-1,".0"),m="".concat(l-1,".0"),b=f>1?["".concat((c-1)/(f-1)),"(y2-y1) * height_ratio","y1*".concat(C," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(C)],v=Object(o.a)(b,3),A=v[0],y=v[1],w=v[2],G=p>1?["".concat((l-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(m," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(m)],B=Object(o.a)(G,3),x=B[0],S=B[1],k=B[2];this.userCode="\n      const float height_ratio = float(".concat(A,");\n      const float width_ratio = float(").concat(x,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(u,") {\n          return;\n        }\n\n        float height_scale = ").concat(y,";\n        float width_scale = ").concat(S,";\n\n        float in_y = ").concat(w,";\n        if( in_y < 0.0 || in_y > ").concat(C," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(k,";\n        if( in_x < 0.0 || in_x > ").concat(m," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(I," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},Hy={kernelName:i.J,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,u=r.method,c=r.extrapolationValue,l=new Xy(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")}},Yy=function(){function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(zy(a,"coords"),")"),o=t[t.length-1],s="",u="";n?(s=r?"end != ".concat(o-1):"end != 0",u=r?"end + 1":"end - 1"):(s=r?"end + pow2 < ".concat(o):"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(tb(a)," coords = getOutputCoords();\n        int end = ").concat(Ky(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(s,") {\n          int idx = ").concat(u,";\n          ").concat(Ky(a,"coords")," = idx;\n          val += getX(").concat(zy(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function zy(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function Ky(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var _y={kernelName:i.K,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,s=r.exclusive,u=r.reverse,c=a.shape.length,l=i.ud.getAxesPermutation([o],c),g=a;null!=l&&(g=eA({inputs:{x:a},backend:n,attrs:{perm:l}}));var d=i.ud.getInnerMostAxes(1,c)[0];if(d!==c-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(a.shape.length-1," ")+"but got axis=".concat(o));for(var h=g.shape[d],f=Gv({inputs:{x:g},backend:n}),p=0;p<=Math.ceil(Math.log2(h))-1;p++){var I=new Yy(g.shape,!1,u),C=I.getCustomSetupFunc(p),m=f;f=n.runWebGLProgram(I,[f],f.dtype,C),n.disposeIntermediateTensorInfo(m)}if(s){var b=new Yy(g.shape,s,u),v=f;f=n.runWebGLProgram(b,[f],f.dtype),n.disposeIntermediateTensorInfo(v)}if(null!=l){var A=eA({inputs:{x:f},backend:n,attrs:{perm:i.ud.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),A}return f}};var Dy={kernelName:i.M,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=cb(u,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var g=n.bufferSync(a),d=n.bufferSync(i),h=lb(g,d,o,s);return n.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},Py=function(){function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return Object(Jr.a)(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var Uy={kernelName:i.N,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.blockSize,s=r.dataFormat;i.tf.assert(o>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(o)}));var u=a.shape[0],c="NHWC"===s?a.shape[1]:a.shape[2],l="NHWC"===s?a.shape[2]:a.shape[3],g="NHWC"===s?a.shape[3]:a.shape[1],d=c*o,h=l*o,f=g/(o*o),p=new Py("NHWC"===s?[u,d,h,f]:[u,f,d,h],o,s);return n.runWebGLProgram(p,[a],a.dtype)}},Jy=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(Ur.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,s=t.inWidth,u=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,g=t.strideWidth,d=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,I=t.outChannels/t.inChannels,C="",m="";r&&(C=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),m="result = activation(result);");var b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(C,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(g,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(I,";\n        int q = d2 - d1 * ").concat(I,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(f,"; wR++) {\n          int xR = xRCorner + wR * ").concat(d,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(h,";\n\n            if (xC < 0 || xC >= ").concat(s,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(b,"\n        ").concat(m,"\n        setOutput(result);\n      }\n    ")},Qy=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(Ur.a)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var s=t.outChannels/t.inChannels,u=t.inHeight,c=t.inWidth,l=t.padInfo.top,g=t.padInfo.left,d=t.strideHeight,h=t.strideWidth,f=t.dilationHeight,p=t.dilationWidth,I=t.filterHeight,C=t.filterWidth,m=C,b="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",v=0;v<C;v++)b+="\n          vec4 xTexelC".concat(2*v,";\n          int xTexelC").concat(2*v,"Ready;\n          vec4 xC").concat(v,";");for(var A=0;A<I;A++){for(var y=0;y<C;y++)b+="\n          xTexelC".concat(2*y," = vec4(0.0);\n          xTexelC").concat(2*y,"Ready = 0;\n          xC").concat(y," = vec4(0.0);");b+="\n        xR = xRCorner + ".concat(A*f,";\n        if (xR >=0 && xR < ").concat(u,") {\n      ");for(var w=0;w<(m+1)/2;w++){var G=2*w,B=G*p;if(b+="\n          xC = xCCorner + ".concat(B,";\n          "),1===h){if(G<C&&(g%2===1?(b+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < ".concat(c," && xTexelC").concat(B,"Ready == 0) {\n                  xTexelC").concat(B," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= ").concat(c,") {\n                    xTexelC").concat(B,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(B,"Ready = 1;\n                }\n              "),b+=1===p&&B>0?"\n                xC".concat(G," = vec4(xTexelC").concat(B-2,".zw, xTexelC").concat(B,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < ".concat(c,") {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= ").concat(c,") {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC").concat(G," = vec4(previous.zw, xTexelC").concat(B,".xy);\n                  } else {\n                    xC").concat(G," = vec4(0.0, 0.0, xTexelC").concat(B,".xy);\n                  }\n                  ")):b+="\n                if (xC >= 0 && xC < ".concat(c," && xTexelC").concat(B,"Ready == 0) {\n                  xTexelC").concat(B," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= ").concat(c,") {\n                    xTexelC").concat(B,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(B,"Ready = 1;\n                }\n\n                xC").concat(G," = xTexelC").concat(B,";\n                "),B+1<C)){var x=g%2===0?i.tf.nearestLargerEven(p):p;p%2===0&&g%2===1||p%2!==0&&g%2!==1?(b+="\n                  xCOffset = xC + ".concat(g%2," + ").concat(x,";\n\n                  if (xCOffset >= 0 && xCOffset < ").concat(c," && xTexelC").concat(B+2,"Ready == 0) {\n                    xTexelC").concat(B+2," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= ").concat(c,") {\n                      xTexelC").concat(B+2,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(B+2,"Ready = 1;\n                  }\n                  "),p>1&&(b+="\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < ".concat(c," && xTexelC").concat(B,"Ready == 0) {\n                      xTexelC").concat(B," = getX(batch, xR, xCOffset, d1);\n                      xTexelC").concat(B,"Ready = 1;\n                    }\n                    ")),b+="\n                  xC".concat(G+1," = vec4(xTexelC").concat(B,".zw, xTexelC").concat(B+2,".xy);\n                  ")):b+=1===x?"\n                    xC".concat(G+1," = xTexelC").concat(B,";\n                    "):"\n                    xCOffset = xC + ".concat(x,";\n\n                    if (xCOffset >= 0 && xCOffset < ").concat(c," && xTexelC").concat(B+2,"Ready == 0) {\n                      xTexelC").concat(B+2," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= ").concat(c,") {\n                        xTexelC").concat(B+2,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(B+2,"Ready = 1;\n                    }\n\n                    xC").concat(G+1," = xTexelC").concat(B+2,";\n                    ")}}else B<C&&(g%2===1?(b+="\n                xCOffset = xC + 1 - ".concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(c," && xTexelC").concat(B,"Ready == 0) {\n                  xTexelC").concat(B," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= ").concat(c,") {\n                    xTexelC").concat(B,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(B,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(c," && xTexelC").concat(B+2,"Ready == 0) {\n                  xTexelC").concat(B+2," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= ").concat(c,") {\n                    xTexelC").concat(B+2,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(B+2,"Ready = 1;\n                }\n\n                xC").concat(G," = vec4(xTexelC").concat(B,".zw, xTexelC").concat(B+2,".zw);\n              "),B+1<C&&(b+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + ".concat(h,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(c,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC").concat(G+1," = vec4(xTexelC").concat(B+2,".xy, final.xy);\n                "))):(b+="\n                if(xC >= 0 && xC < ".concat(c," && xTexelC").concat(B,"Ready == 0) {\n                  xTexelC").concat(B," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= ").concat(c,") {\n                    xTexelC").concat(B,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(B,"Ready = 1;\n                }\n\n                xCOffset = xC + ").concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(c," && xTexelC").concat(B+2,"Ready == 0) {\n                  xTexelC").concat(B+2," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= ").concat(c,") {\n                    xTexelC").concat(B+2,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(B+2,"Ready = 1;\n                }\n\n                xC").concat(G," = vec4(\n                  xTexelC").concat(B,".xy, xTexelC").concat(B+2,".xy);\n              "),B+1<C&&(b+="\n                  xC".concat(G+1," = vec4(xTexelC").concat(B,".zw, xTexelC").concat(B+2,".zw);\n                "))));G<C&&(b+="\n            wTexel = getW(".concat(A,", ").concat(B,", d1, q);\n            dotProd += xC").concat(G," * vec4(wTexel.xz, wTexel.xz);\n          "),B+1<C&&(b+="\n              wTexel = getW(".concat(A,", ").concat(B+1,", d1, q);\n              dotProd += xC").concat(G+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}b+="\n        }\n      "}var S="",k="";r&&(S=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):o?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),k="result = activation(result);");var Z=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(S,"\n\n      const ivec2 strides = ivec2(").concat(d,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(l,", ").concat(g,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(b,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(Z,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")};var qy={kernelName:i.O,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=r.strides,u=r.pad,c=r.dilations,l=r.dimRoundingMode,g=c;null==g&&(g=[1,1]),i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(s,g),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(g,"'")}));var d,h=i.ud.computeConv2DInfo(a.shape,o.shape,s,g,u,l,!0);return d=Object(i.Ud)().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new Qy(h):new Jy(h),n.runWebGLProgram(d,[a,o],"float32")}},$y=function e(t){Object(Ur.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},ew=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(u,"; dm++) {\n              int d2 = d1 * ").concat(u," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var tw={kernelName:i.P,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.dy,s=r.strides,u=r.dilations,c=r.pad,l=r.dimRoundingMode,g=r.filterShape,d=i.ud.computeConv2DInfo(a.shape,g,s,u,c,l,!0),h=new $y(d);return n.runWebGLProgram(h,[a,o],"float32")}};var nw={kernelName:i.Q,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.filter,s=r.strides,u=r.dilations,c=r.pad,l=r.dimRoundingMode,g=r.inputShape,d=i.ud.computeConv2DInfo(g,o.shape,s,u,c,l,!0),h=new ew(d);return n.runWebGLProgram(h,[a,o],"float32")}},rw=function e(t){Object(Ur.a)(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "};var aw={kernelName:i.R,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(Object(Yn.a)(r.shape),Object(Yn.a)(r.shape)),o=i.tf.sizeFromShape(r.shape),s=zv({inputs:{x:r},backend:n,attrs:{shape:[o]}}),u=new rw(o),c=n.runWebGLProgram(u,[s],s.dtype),l=zv({inputs:{x:c},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),l}},iw=function e(t){Object(Ur.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,u=t.filterWidth,c=t.dilationHeight,l=t.dilationWidth,g=a.top,d=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(g,", ").concat(d,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(u,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")};var ow={kernelName:i.S,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,s=n.filter,u=a.strides,c=a.pad,l=a.dilations,g=i.ud.computeDilation2DInfo(o.shape,s.shape,u,c,"NHWC",l),d=new iw(g),h=zv({inputs:{x:t=r.runWebGLProgram(d,[o,s],"float32")},backend:r,attrs:{shape:g.outShape}});return r.disposeIntermediateTensorInfo(t),h}};var sw={kernelName:i.V,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,a=t,o=i.ud.decodeEinsumEquation(r,a.length),s=o.allDims,u=o.summedDims,c=o.idDims;i.ud.checkEinsumDimSizes(s.length,c,a);for(var l=i.ud.getEinsumComputePath(u,c),g=l.path,d=l.steps,h=d.length,f=null,p=s.length,I=[],C=0;C<h;++C){var m,b=Object(ea.a)(d[C]);try{for(b.s();!(m=b.n()).done;){var v=m.value,A=i.ud.getEinsumPermutation(p,c[v]),y=A.permutationIndices,w=A.expandDims,G=void 0;i.ud.isIdentityPermutation(y)?G=a[v]:(G=eA({inputs:{x:a[v]},backend:n,attrs:{perm:y}}),I.push(G));for(var B=G.shape.slice(),x=0;x<w.length;++x)B.splice(w[x],0,1);i.tf.arraysEqual(G.shape,B)||(G=zv({inputs:{x:G},backend:n,attrs:{shape:B}}),I.push(G)),null===f?f=G:(f=Hv({inputs:{a:G,b:f},backend:n}),I.push(f))}}catch(R){b.e(R)}finally{b.f()}C<h-1&&(g[C]>=0&&(f=qv({inputs:{x:f},backend:n,attrs:{axis:g[C]-(s.length-p),keepDims:!1}}),I.push(f)),p--)}for(var S=0,k=I;S<k.length;S++){var Z=k[S];Z!==f&&n.disposeIntermediateTensorInfo(Z)}return f}},uw=Fv({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),cw={kernelName:i.W,backendName:"webgl",kernelFunc:uw},lw={kernelName:i.X,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,o=Object(i.Ud)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new wv("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new yv("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(o,[r,a],r.dtype)}},gw=Mv({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:hb}),dw={kernelName:i.Y,backendName:"webgl",kernelFunc:gw},hw=Fv({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(i.ud.ERF_P,";\n  float a1 = ").concat(i.ud.ERF_A1,";\n  float a2 = ").concat(i.ud.ERF_A2,";\n  float a3 = ").concat(i.ud.ERF_A3,";\n  float a4 = ").concat(i.ud.ERF_A4,";\n  float a5 = ").concat(i.ud.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),fw={kernelName:i.Z,backendName:"webgl",kernelFunc:hw},pw="return exp(x);",Iw=Fv({opSnippet:pw,packedOpSnippet:pw,cpuKernelImpl:fb}),Cw={kernelName:i.ab,backendName:"webgl",kernelFunc:Iw};function mw(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,o=t.input,s=o.shape.length,u=o.shape.slice(),c=a;return a<0&&(i.tf.assert(-(s+1)<=a,(function(){return"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")})),c=s+a+1),u.splice(c,0,1),zv({inputs:{x:o},backend:r,attrs:{shape:u}})}var bw={kernelName:i.bb,backendName:"webgl",kernelFunc:mw},vw="return exp(x) - 1.0;",Aw=Fv({opSnippet:vw,packedOpSnippet:vw,cpuKernelImpl:pb}),yw={kernelName:i.cb,backendName:"webgl",kernelFunc:Aw},ww=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};function Gw(e,t,n){var r=n.texData.get(e.dataId),a=i.tf.sizeFromShape(e.shape),o=e.shape[e.shape.length-1],s=zv({inputs:{x:e},backend:n,attrs:{shape:[a/o,o]}}),u=s.shape,c=new ww("real",u,t),l=new ww("imag",u,t),g=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],d=n.runWebGLProgram(c,g,"float32"),h=n.runWebGLProgram(l,g,"float32"),f=xv({inputs:{real:d,imag:h},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h);var p=zv({inputs:{x:f},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(f),p}var Bw={kernelName:i.db,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return Gw(t.input,!1,n)}},xw=function(){function e(t,n){Object(Ur.a)(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();function Sw(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,o=n.dtype;if("string"===(o=o||i.tf.inferDtype(a))){var s=i.tf.getArrayFromDType(o,i.tf.sizeFromShape(r));return s.fill(a),t.makeTensorInfo(r,o,s)}var u=new xw(r,a),c=u.getCustomSetupFunc(a);return t.runWebGLProgram(u,[],o,c)}var kw,Zw={kernelName:i.eb,backendName:"webgl",kernelFunc:Sw},Rw=function e(t){Object(Ur.a)(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},Nw={kernelName:i.fb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new Rw(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},Ow="return floor(x);",Ww=Fv({opSnippet:Ow,packedOpSnippet:Ow,cpuKernelImpl:Ib}),Fw={kernelName:i.gb,backendName:"webgl",kernelFunc:Ww},Mw=Mv({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Vw={kernelName:i.hb,backendName:"webgl",kernelFunc:Mw},Tw=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"];var n=ym(),r=Object(o.a)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},Ew=function e(t){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=ym(),r=Object(o.a)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},jw={kernelName:i.ib,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,s=r.numChannels,u="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,c="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,l=u?[a.videoWidth,a.videoHeight]:[a.width,a.height],g=Object(o.a)(l,2),d=g[0],h=g[1],f=[h,d],p=[h,d,s];(c||u)&&(null==kw&&(kw=document.createElement("canvas").getContext("2d")),kw.canvas.width=d,kw.canvas.height=h,kw.drawImage(a,0,0,d,h),a=kw.canvas);var I=n.makeTensorInfo(f,"int32");n.texData.get(I.dataId).usage=jC.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(I.dataId),a);var C=Object(i.Ud)().getBool("WEBGL_PACK")?new Ew(p):new Tw(p),m=n.runWebGLProgram(C,[I],"int32");return n.disposeData(I.dataId),m}};var Lw={kernelName:i.kb,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,s=n.filter,u=n.bias,c=n.preluActivationWeights,l=a.strides,g=a.pad,d=a.dataFormat,h=a.dilations,f=a.dimRoundingMode,p=a.activation,I=a.leakyreluAlpha,C=i.ud.convertConv2DDataFormat(d),m=i.ud.computeConv2DInfo(o.shape,s.shape,l,h,g,f,!1,C),b=[];if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(Object(i.Ud)().getBool("WEBGL_CONV_IM2COL")&&1===o.shape[0])t=xy({x:o,filter:s,convInfo:m,backend:r,bias:u,activation:p,preluActivationWeights:c,leakyreluAlpha:I});else{var v=null!=u,A=null!=c,y="leakyrelu"===p,w=p?Vv(p,!1):null,G=new yy(m,v,w,A,y),B=[o,s];if(u&&B.push(u),c&&B.push(c),y){var x=r.makeTensorInfo([],"float32",i.tf.createScalarValue(I,"float32"));B.push(x),b.push(x)}t=r.runWebGLProgram(G,B,"float32")}else t=By({x:o,filter:s,convInfo:m,backend:r,bias:u,activation:p,preluActivationWeights:c,leakyreluAlpha:I});var S=zv({inputs:{x:t},backend:r,attrs:{shape:m.outShape}});return b.push(t),b.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),S}};var Xw={kernelName:i.lb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.filter,s=t.bias,u=t.preluActivationWeights,c=r.strides,l=r.pad,g=r.dilations,d=r.dimRoundingMode,h=r.activation,f=r.leakyreluAlpha,p=[],I=g;null==I&&(I=[1,1]),i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(c,I),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(I,"'")}));var C,m=i.ud.computeConv2DInfo(a.shape,o.shape,c,I,l,d,!0),b=Object(i.Ud)().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,v=h?Vv(h,b):null,A=[a,o],y=null!=s,w=null!=u,G="leakyrelu"===h;if(y&&A.push(s),w&&A.push(u),G){var B=n.makeTensorInfo([],"float32",i.tf.createScalarValue(f,"float32"));A.push(B),p.push(B)}C=b?new Qy(m,y,v,w,G):new Jy(m,y,v,w,G);var x=n.runWebGLProgram(C,A,"float32");return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}},Hw=function e(t,n,r){Object(Ur.a)(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=tb(n.length),i=tb(r.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(o,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};var Yw={kernelName:i.mb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,s=a.shape,u=s[s.length-1],c=i.tf.sizeFromShape(r.shape),l=i.ud.prepareAndValidate(r,a),g=Object(o.a)(l,4),d=g[0],h=g[1],f=g[2],p=g[3],I=zv({inputs:{x:a},backend:n,attrs:{shape:[h,u]}}),C=zv({inputs:{x:r},backend:n,attrs:{shape:[i.tf.sizeFromShape(r.shape)/f,f]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var m=n.readSync(a.dataId),b=n.bufferSync(r),v=Cb(m,b,r.dtype,h,u,f,p,r.shape,c);return n.makeTensorInfo(d,r.dtype,v.values)}var A=new Hw(u,p,[h,f]),y=n.runWebGLProgram(A,[C,I],C.dtype),w=zv({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(y),w}},zw=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=tb(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("int(getIndices(resRC.x, resRC.z))"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")};var Kw={kernelName:i.nb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.indices,s=r.axis,u=r.batchDims,c=i.tf.parseAxisParam(s,a.shape)[0],l=i.ud.segment_util.collectGatherOpShapeInfo(a,o,c,u),g=i.tf.sizeFromShape(o.shape),d=[],h=zv({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),f=zv({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,g/l.batchSize]}});d.push(h),d.push(f);var p=[l.batchSize,l.outerSize,g/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([a,o])||"string"===a.dtype){var I=n.bufferSync(f),C=n.bufferSync(h),m=mb(C,I,p);return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(l.outputShape,m.dtype,m.values)}var b=new zw(h.shape,p),v=n.runWebGLProgram(b,[h,f],h.dtype);d.push(v);var A=zv({inputs:{x:v},backend:n,attrs:{shape:l.outputShape}});return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),A}},_w=Mv({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:bb,dtype:"bool"}),Dw={kernelName:i.ob,backendName:"webgl",kernelFunc:_w},Pw=Mv({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:vb}),Uw={kernelName:i.pb,backendName:"webgl",kernelFunc:Pw};var Jw={kernelName:i.qb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return Gw(t.input,!0,n)}},Qw=Fv({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),qw={kernelName:i.tb,backendName:"webgl",kernelFunc:Qw},$w=Fv({opSnippet:"return float(isinf(x));",dtype:"bool"}),eG={kernelName:i.ub,backendName:"webgl",kernelFunc:$w},tG=Fv({opSnippet:"return float(isnan(x));",dtype:"bool"}),nG={kernelName:i.vb,backendName:"webgl",kernelFunc:tG},rG=Mv({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:Ab,dtype:"bool"}),aG={kernelName:i.Ab,backendName:"webgl",kernelFunc:rG},iG=Mv({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:yb,dtype:"bool"}),oG={kernelName:i.Bb,backendName:"webgl",kernelFunc:iG};var sG={kernelName:i.Cb,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=wb(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},uG=Fv({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Gb}),cG={kernelName:i.Db,backendName:"webgl",kernelFunc:uG},lG=Fv({opSnippet:"return log(1.0 + x);"}),gG={kernelName:i.Eb,backendName:"webgl",kernelFunc:lG},dG=Mv({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),hG={kernelName:i.Fb,backendName:"webgl",kernelFunc:dG},fG=Fv({opSnippet:"return float(!(x >= 1.0));"}),pG={kernelName:i.Gb,backendName:"webgl",kernelFunc:fG},IG=Mv({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),CG={kernelName:i.Hb,backendName:"webgl",kernelFunc:IG},mG=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")},bG=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")},vG={kernelName:i.xb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.depthRadius,s=r.bias,u=r.alpha,c=r.beta,l=Object(i.Ud)().getBool("WEBGL_PACK_NORMALIZATION")?new bG(a.shape,o,s,u,c):new mG(a.shape,o,s,u,c);return n.runWebGLProgram(l,[a],a.dtype)}},AG=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},yG={kernelName:i.yb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,u=r.bias,c=r.alpha,l=r.beta,g=new AG(a.shape,s,u,c,l);return n.runWebGLProgram(g,[a,i,o],a.dtype)}};function wG(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.reductionIndices,u=r.keepDims,c=a.shape.length,l=i.tf.parseAxisParam(s,a.shape),g=l,d=i.ud.getAxesPermutation(g,c),h=null!=d,f=n.shouldExecuteOnCPU([a]),p=a;if(h){if(f){for(var I=n.texData.get(p.dataId).values,C=new Array(c),m=0;m<C.length;m++)C[m]=a.shape[d[m]];var b=_b(I,a.shape,a.dtype,d,C);p=n.makeTensorInfo(C,a.dtype),n.texData.get(p.dataId).values=b}else p=Qv(a,d,n);g=i.ud.getInnerMostAxes(g.length,c)}i.ud.assertAxesAreInnerMostDims("max",g,c);var v,A=i.ud.computeOutAndReduceShapes(p.shape,g),y=Object(o.a)(A,2),w=y[0],G=y[1],B=w;if(u&&(B=i.ud.expandShapeToKeepDim(w,l)),f){var x=n.texData.get(p.dataId).values,S=Bb(x,i.tf.sizeFromShape(G),B,a.dtype);v=n.makeTensorInfo(B,a.dtype),n.texData.get(v.dataId).values=S}else v=function(e,t,n,r){var a=i.tf.sizeFromShape(t),o=zv({inputs:{x:e},attrs:{shape:[i.tf.sizeFromShape(e.shape)/a,a]},backend:r}),s=Pv(o,e.dtype,"max",r),u=zv({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),u}(p,G,B,n);return h&&n.disposeIntermediateTensorInfo(p),v}var GG={kernelName:i.Ib,backendName:"webgl",kernelFunc:wG},BG=Mv({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:xb}),xG={kernelName:i.Ob,backendName:"webgl",kernelFunc:BG};var SG={kernelName:i.Jb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;vm(a,"maxPool");var o=r.filterSize,s=r.strides,u=r.pad,c=r.dimRoundingMode;i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l=i.ud.computePool2DInfo(a.shape,o,s,1,u,c);if(1===l.filterWidth&&1===l.filterHeight&&i.tf.arraysEqual(l.inShape,l.outShape))return Gv({inputs:{x:a},backend:n});var g=new MA(l,"max",!1);return n.runWebGLProgram(g,[a],a.dtype)}};var kG={kernelName:i.Kb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.filterSize,s=r.strides,u=r.pad,c=r.dataFormat,l=r.dimRoundingMode,g=i.ud.computePool3DInfo(a.shape,o,s,[1,1,1],u,l,c),d=new VA(g,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}},ZG=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,u=o-1-t.padInfo.left,c=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},RG=function e(t){Object(Ur.a)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,g=u-1-t.padInfo.front,d=c-1-t.padInfo.top,h=l-1-t.padInfo.left,f=u*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(g,", ").concat(d,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var NG={kernelName:i.Lb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=r.filterSize,u=r.strides,c=r.pad,l=r.dimRoundingMode,g=i.ud.computePool3DInfo(o.shape,s,u,[1,1,1],c,l),d=new VA(g,"max",!0),h=n.runWebGLProgram(d,[o],o.dtype),f=new RG(g),p=n.runWebGLProgram(f,[a,h],o.dtype);return n.disposeIntermediateTensorInfo(h),p}};var OG={kernelName:i.Mb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.input,s=o;vm([o,t.output],"maxPoolGrad");var u=r.filterSize,c=r.strides,l=r.pad,g=r.dimRoundingMode,d=i.ud.computePool2DInfo(s.shape,u,c,1,l,g),h=new MA(d,"max",!0),f=n.runWebGLProgram(h,[s],s.dtype),p=new ZG(d),I=n.runWebGLProgram(p,[a,f],s.dtype);return n.disposeIntermediateTensorInfo(f),I}};var WG={kernelName:i.Nb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,s=n.filterSize,u=n.strides,c=n.pad,l=n.includeBatchInIndex,g=r;i.tf.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var d=[1,1];i.tf.assert(i.ud.eitherStridesOrDilationsAreOne(u,d),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(u," and dilations '").concat(d,"'")}));var h=i.ud.computePool2DInfo(a.shape,s,u,d,c),f=function(e,t,n,r){var a=new MA(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new MA(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,l,h,g),p=Object(o.a)(f,2);return[p[0],p[1]]}};var FG={kernelName:i.Pb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,s=n.keepDims,u=n.axis,c=r,l=a.shape.length,g=i.tf.parseAxisParam(u,a.shape),d=g,h=i.ud.getAxesPermutation(d,l),f=null!=h,p=c.shouldExecuteOnCPU([a]),I=[],C=a;if(f){if(p){for(var m=c.texData.get(C.dataId).values,b=new Array(l),v=0;v<b.length;v++)b[v]=a.shape[h[v]];var A=_b(m,a.shape,a.dtype,h,b);C=c.makeTensorInfo(b,a.dtype),c.texData.get(C.dataId).values=A}else C=Qv(a,h,c);I.push(C),d=i.ud.getInnerMostAxes(d.length,l)}i.ud.assertAxesAreInnerMostDims("sum",d,l);var y=i.ud.computeOutAndReduceShapes(C.shape,d),w=Object(o.a)(y,2),G=w[0],B=w[1],x=G;s&&(x=i.ud.expandShapeToKeepDim(G,g));for(var S=function(e,t,n,r){var a=i.tf.sizeFromShape(t),o=zv({inputs:{x:e},attrs:{shape:[i.tf.sizeFromShape(e.shape)/a,a]},backend:r}),s=Pv(o,"float32","mean",r),u=zv({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),u}(C,B,x,c),k=0,Z=I;k<Z.length;k++){var R=Z[k];c.disposeIntermediateTensorInfo(R)}return S}};var MG={kernelName:i.Qb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,s=r.axis,u=r.keepDims,c=a.shape.length,l=i.tf.parseAxisParam(s,a.shape),g=l,d=i.ud.getAxesPermutation(g,c),h=a;null!=d&&(h=eA({inputs:{x:a},backend:n,attrs:{perm:d}}),g=i.ud.getInnerMostAxes(g.length,a.shape.length)),i.ud.assertAxesAreInnerMostDims("min",g,c);var f,p=i.ud.computeOutAndReduceShapes(h.shape,g),I=Object(o.a)(p,2),C=I[0],m=I[1],b=zv({inputs:{x:h},backend:n,attrs:{shape:[-1,i.tf.sizeFromShape(m)]}}),v=Pv(b,b.dtype,"min",n);return f=zv(u?{inputs:{x:v},backend:n,attrs:{shape:i.ud.expandShapeToKeepDim(C,l)}}:{inputs:{x:v},backend:n,attrs:{shape:C}}),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),null!=d&&n.disposeIntermediateTensorInfo(h),f}},VG=Mv({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Sb}),TG={kernelName:i.Rb,backendName:"webgl",kernelFunc:VG},EG=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=tb(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),c="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(u,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")},jG=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=tb(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=Ub("rc",a),c=Ub("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),g=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d="reflect"===r?0:1,h="";if(1===a){var f="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(d,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(d,";\n        }\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(f,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(f,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n        }\n      ")}else{var p="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(d,") +\n                gte * ((end - 1) * 2 - source + ").concat(d,");\n        source -= start;\n      ");h="\n        ".concat(i," rc = outputLoc;\n        ").concat(p,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n        ").concat(u[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(p,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n        }\n        rc = outputLoc;\n        ").concat(u[a-2]," += 1;\n        if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(p,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n          ").concat(u[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(p,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")},LG={kernelName:i.Sb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.paddings,s=r.mode,u=Object(i.Ud)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jG(a.shape,o,s):new EG(a.shape,o,s);return n.runWebGLProgram(u,[a],a.dtype)}},XG=Mv({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),HG={kernelName:i.Tb,backendName:"webgl",kernelFunc:XG},YG=function(){function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),zG=Mv({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),KG={kernelName:i.lc,backendName:"webgl",kernelFunc:zG},_G="return a - b;",DG=Mv({opSnippet:_G,packedOpSnippet:_G,supportsComplex:!0,cpuKernelImpl:Yb}),PG={kernelName:i.Xc,backendName:"webgl",kernelFunc:DG};function UG(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,o=r.dim,s=i.tf.parseAxisParam([o],a.shape),u=wG({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),c=i.ud.expandShapeToKeepDim(u.shape,s),l=zv({inputs:{x:u},backend:n,attrs:{shape:c}}),g=DG({inputs:{a:a,b:l},backend:n}),d=Iw({inputs:{x:g},backend:n}),h=qv({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),f=zv({inputs:{x:h},backend:n,attrs:{shape:c}}),p=zG({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}var JG={kernelName:i.Gc,backendName:"webgl",kernelFunc:UG};var QG={kernelName:i.Ub,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,u=s?a:UG({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],g=new YG(c,l,i),d=g.getCustomSetupFunc(o),h=n.runWebGLProgram(g,[u],"int32",d);return s||n.disposeIntermediateTensorInfo(u),h}},qG="return -x;";var $G={kernelName:i.Wb,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var s=r.texData.get(a.dataId),u=Zb(s.values,a.shape,a.dtype),c=Object(o.a)(u,2),l=c[0],g=c[1];return r.makeTensorInfo(g,a.dtype,l)}return t=Object(i.Ud)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Iv(a.shape,qG):new nv(a.shape,qG),r.runWebGLProgram(t,[a],a.dtype)}},eB=i.he.nonMaxSuppressionV3Impl;var tB={kernelName:i.Xb,backendName:"webgl",kernelFunc:function(e){i.ud.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,o=t.scores,s=r.maxOutputSize,u=r.iouThreshold,c=r.scoreThreshold,l=n.readSync(a.dataId),g=n.readSync(o.dataId),d=eB(l,g,s,u,c).selectedIndices;return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},nB=i.he.nonMaxSuppressionV4Impl;var rB={kernelName:i.Yb,backendName:"webgl",kernelFunc:function(e){i.ud.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,o=t.scores,s=r.maxOutputSize,u=r.iouThreshold,c=r.scoreThreshold,l=r.padToMaxOutputSize,g=n.readSync(a.dataId),d=n.readSync(o.dataId),h=nB(g,d,s,u,c,l),f=h.selectedIndices,p=h.validOutputs;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},aB=i.he.nonMaxSuppressionV5Impl;var iB={kernelName:i.Zb,backendName:"webgl",kernelFunc:function(e){i.ud.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,o=t.scores,s=r.maxOutputSize,u=r.iouThreshold,c=r.scoreThreshold,l=r.softNmsSigma,g=n.readSync(a.dataId),d=n.readSync(o.dataId),h=aB(g,d,s,u,c,l),f=h.selectedIndices,p=h.selectedScores;return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},oB=function e(t,n,r,a){Object(Ur.a)(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},sB={kernelName:i.bc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,o=r.depth,s=r.onValue,u=r.offValue,c=i.tf.sizeFromShape(a.shape),l=new oB(c,o,s,u),g=zv({inputs:{x:a},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(l,[g],a.dtype);n.disposeIntermediateTensorInfo(g);var h=zv({inputs:{x:d},backend:n,attrs:{shape:[].concat(Object(Yn.a)(a.shape),[o])}});return n.disposeIntermediateTensorInfo(d),h}};function uB(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=ny({inputs:{input:r},backend:n}),i=uB({inputs:{x:a},backend:n}),o=Cy({inputs:{input:r},backend:n}),s=uB({inputs:{x:o},backend:n}),u=xv({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),u}return Sw({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var cB={kernelName:i.kd,backendName:"webgl",kernelFunc:uB};var lB={kernelName:i.cc,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=ny({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=Cy({inputs:{input:a},backend:r}),u=uB({inputs:{x:s},backend:r}),c=xv({inputs:{real:o,imag:u},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(u),c}return Sw({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var gB={kernelName:i.ec,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return mw({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,o=t[0].dtype;t.forEach((function(e){i.tf.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),i.tf.assert(o===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=[],u=vy({inputs:t.map((function(e){var t=mw({inputs:{input:e},backend:n,attrs:{dim:r}});return s.push(t),t})),backend:n,attrs:{axis:r}});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}},dB=function(){function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=tb(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n        uniform float value;\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),hB=function(){function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=tb(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=Ub("rc",a),c=Ub("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),g=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),d=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,I=1===a?2:4;p<I;p++)f+="\n        ".concat(d[p],"\n        if (").concat(h,") {\n          result[").concat(p,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(p,"] = getChannel(getX(").concat(c.join(),"), ").concat(g,");\n        }\n      ");f+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),fB=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.paddings,s=r.constantValue,u=Object(i.Ud)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hB(a.shape,o,s):new dB(a.shape,o,s),c=u.getCustomSetupFunc(s);return n.runWebGLProgram(u,[a],a.dtype,c)},pB={kernelName:i.fc,backendName:"webgl",kernelFunc:fB},IB=Mv({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),CB={kernelName:i.gc,backendName:"webgl",kernelFunc:IB};var mB={kernelName:i.ic,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,s=n.x,u=a.axis,c=a.keepDims,l=s.shape.length,g=[],d=i.tf.parseAxisParam(u,s.shape),h=d,f=i.ud.getAxesPermutation(h,l),p=s;if(null!=f&&(p=eA({inputs:{x:s},backend:r,attrs:{perm:f}}),h=i.ud.getInnerMostAxes(h.length,l),g.push(p)),i.ud.assertAxesAreInnerMostDims("prod",h,l),r.shouldExecuteOnCPU([p])){var I=r.texData.get(p.dataId).values,C=Nb(p.shape,p.dtype,I,h),m=C.outVals,b=C.outShape,v=C.outDtype;t=r.makeTensorInfo(b,v,m)}else{var A=i.ud.computeOutAndReduceShapes(p.shape,h),y=Object(o.a)(A,2),w=y[0],G=y[1],B=i.tf.sizeFromShape(G),x=zv({inputs:{x:p},backend:r,attrs:{shape:[-1,B]}}),S=Pv(x,Object(i.gf)(s.dtype),"prod",r);t=zv({inputs:{x:S},backend:r,attrs:{shape:w}}),g.push(x),g.push(S)}if(c){g.push(t);var k=i.ud.expandShapeToKeepDim(t.shape,d);t=zv({inputs:{x:t},backend:r,attrs:{shape:k}})}return g.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}},bB=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=Ob(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},vB={kernelName:i.jc,backendName:"webgl",kernelFunc:bB},AB=Fv({opSnippet:"return 1.0 / x;"}),yB={kernelName:i.mc,backendName:"webgl",kernelFunc:AB},wB=Fv({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),GB={kernelName:i.nc,backendName:"webgl",kernelFunc:wB},BB=Fv({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),xB={kernelName:i.oc,backendName:"webgl",kernelFunc:BB},SB=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["A"],this.outputShape=[];var s=Object(o.a)(t,4),u=s[0],c=s[1],l=s[2],g=s[3];this.outputShape=[u,n,r,g];var d,h=[a&&n>1?c-1:c,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];d=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(h[0]/f[0],",\n          ").concat(h[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},kB=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var s=Object(o.a)(t,4),u=s[0],c=s[1],l=s[2],g=s[3];this.outputShape=[u,n,r,g];var d,h=[a&&n>1?c-1:c,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];d=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(h[0]/f[0],",\n          ").concat(h[1]/f[1],",\n          ").concat(h[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(g-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")};var ZB={kernelName:i.qc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,s=r.alignCorners,u=r.halfPixelCenters,c=r.size,l=Object(o.a)(c,2),g=l[0],d=l[1],h=Object(i.Ud)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kB(a.shape,g,d,s,u):new SB(a.shape,g,d,s,u);return n.runWebGLProgram(h,[a],"float32")}},RB=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(o.a)(n,3),i=a[1],s=a[2],u=Object(o.a)(t,3),c=u[1],l=u[2],g=[r&&c>1?i-1:i,r&&l>1?s-1:s],d=[r&&c>1?c-1:c,r&&l>1?l-1:l],h=g[0]/d[0],f=g[1]/d[1],p=1/h,I=1/f,C=2*Math.ceil(p)+2,m=2*Math.ceil(I)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(I,");\n\n        const int winHeight = int(").concat(C,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(c,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(s-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var NB={kernelName:i.rc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new RB(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},OB=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["A"],this.outputShape=[];var s=Object(o.a)(t,4),u=s[0],c=s[1],l=s[2],g=s[3];this.outputShape=[u,n,r,g];var d,h=[a&&n>1?c-1:c,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";d=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(h[0]/f[0],",\n          ").concat(h[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(c,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")},WB=function e(t,n,r,a,i){Object(Ur.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var s=Object(o.a)(t,4),u=s[0],c=s[1],l=s[2],g=s[3];this.outputShape=[u,n,r,g];var d,h=[a&&n>1?c-1:c,a&&r>1?l-1:l],f=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";d=i?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(h[0]/f[0],",\n          ").concat(h[1]/f[1],",\n          ").concat(h[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(c,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(g-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")};var FB={kernelName:i.sc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,s=r.alignCorners,u=r.halfPixelCenters,c=r.size,l=Object(o.a)(c,2),g=l[0],d=l[1],h=Object(i.Ud)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new WB(a.shape,g,d,s,u):new OB(a.shape,g,d,s,u);return n.runWebGLProgram(h,[a],a.dtype)}},MB=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(o.a)(n,3),i=a[1],s=a[2],u=Object(o.a)(t,3),c=u[1],l=u[2],g=[r&&c>1?i-1:i,r&&l>1?s-1:s],d=[r&&c>1?c-1:c,r&&l>1?l-1:l],h=g[0]/d[0],f=g[1]/d[1],p=1/h,I=1/f,C=2*Math.ceil(p)+2,m=2*Math.ceil(I)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(f,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(I,");\n\n        const int winHeight = int(").concat(C,");\n        const int winWidth = int(").concat(m,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(c,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(g[0],") *\n                (float(dyR) / float(").concat(d[0],"));\n\n            float sourceFracCol =\n                float(").concat(g[1],") *\n                  (float(dyC) / float(").concat(d[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(s,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var VB={kernelName:i.tc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new MB(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},TB=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=tb(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")},EB=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=Ub("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=tb(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")};var jB={kernelName:i.uc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.dims,s=a.shape.length,u=i.tf.parseAxisParam(o,a.shape);if(0===s)return Gv({inputs:{x:a},backend:n});var c=Object(i.Ud)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new EB(a.shape,u):new TB(a.shape,u);return n.runWebGLProgram(c,[a],a.dtype)}},LB=function(){function e(t,n){Object(Ur.a)(this,e),this.variableNames=["Image"],this.outputShape=[];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        uniform vec4 params;\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}return Object(Jr.a)(e,[{key:"getCustomSetupFunc",value:function(e,t,n,r){var a=this;return function(i,o){null==a.paramsLoc&&(a.paramsLoc=i.getUniformLocationNoThrow(o,"params")),i.gl.uniform4f(a.paramsLoc,e,t,n,r)}}}]),e}(),XB={kernelName:i.vc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,s=n.radians,u=n.fillValue,c=n.center,l=r,g=new LB(a.shape,u),d=i.ud.getImageCenter(c,a.shape[1],a.shape[2]),h=Object(o.a)(d,2),f=h[0],p=h[1],I=g.getCustomSetupFunc(f,p,Math.sin(s),Math.cos(s));return l.runWebGLProgram(g,[a],a.dtype,I)}},HB=Fv({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),YB={kernelName:i.wc,backendName:"webgl",kernelFunc:HB},zB=Fv({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Wb}),KB={kernelName:i.xc,backendName:"webgl",kernelFunc:zB},_B=function e(t,n,r,a,i,o){Object(Ur.a)(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=tb(i.length),u=tb(o.length),c="";1===r?c="i":2===r&&(c="i, j");var l="getIndices(".concat(c,")"),g="";1===a?g="i":2===a&&(g="i, coords[1]");var d="getUpdates(".concat(g,")"),h=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(h,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(d,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")};var DB={kernelName:i.yc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,o=t.updates,s=r.shape,u=i.ud.calculateShapes(o,a,s),c=u.sliceRank,l=u.numUpdates,g=u.sliceSize,d=u.strides,h=u.outputSize,f=[h/g,g];if(0===h)return n.makeTensorInfo(s,a.dtype);var p=zv({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),I=zv({inputs:{x:o},backend:n,attrs:{shape:[l,g]}}),C=n.makeTensorInfo([],"float32",new Float32Array([0])),m=new _B(l,c,p.shape.length,I.shape.length,d,f),b=n.runWebGLProgram(m,[I,p,C],I.dtype),v=zv({inputs:{x:b},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(I),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(C),v}},PB=function e(t,n,r){var a,i;if(Object(Ur.a)(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push("".concat(o[c])),c<t&&s.push("".concat(o[c]));a=s.join(),i=u.join()}var l=tb(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")};var UB={kernelName:i.zc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,o=t.e,s=new PB(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,o],Object(i.sf)(a.dtype,o.dtype))}},JB=Fv({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(i.ud.SELU_SCALEALPHA,";\n  float scale = ").concat(i.ud.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),QB={kernelName:i.Ac,backendName:"webgl",kernelFunc:JB},qB=Fv({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),$B={kernelName:i.Bc,backendName:"webgl",kernelFunc:qB},ex=Fv({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),tx={kernelName:i.Cc,backendName:"webgl",kernelFunc:ex},nx=Fv({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),rx={kernelName:i.Dc,backendName:"webgl",kernelFunc:nx},ax=Fv({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),ix={kernelName:i.Ec,backendName:"webgl",kernelFunc:ax},ox=Fv({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),sx={kernelName:i.Hc,backendName:"webgl",kernelFunc:ox},ux={kernelName:i.Ic,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.blockShape,s=r.paddings;i.tf.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var u=o.reduce((function(e,t){return e*t})),c=[[0,0]];c.push.apply(c,Object(Yn.a)(s));for(var l=1+o.length;l<a.shape.length;++l)c.push([0,0]);var g=[],d=fB({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),h=i.ud.getReshaped(d.shape,o,u,!1),f=i.ud.getPermuted(h.length,o.length,!1),p=i.ud.getReshapedPermuted(d.shape,o,u,!1),I=zv({inputs:{x:d},backend:n,attrs:{shape:h}}),C=eA({inputs:{x:I},backend:n,attrs:{perm:f}}),m=zv({inputs:{x:C},backend:n,attrs:{shape:p}});return g.push(d),g.push(I),g.push(C),g.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}};var cx={kernelName:i.Jc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,i=t.denseShape,s=t.defaultValue;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==s.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(s.shape));var u=n.readSync(r.dataId),c=n.readSync(a.dataId),l=n.readSync(i.dataId),g=n.readSync(s.dataId)[0],d=Vb(u,r.shape,r.dtype,c,a.dtype,l,g),h=Object(o.a)(d,5),f=h[0],p=h[1],I=h[2],C=h[3],m=h[4];return[n.makeTensorInfo(p,r.dtype,f),n.makeTensorInfo([p[0]],a.dtype,I),n.makeTensorInfo([C.length],"bool",new Uint8Array(C.map((function(e){return Number(e)})))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};var lx={kernelName:i.Kc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,i=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));var s=Array.from(n.readSync(a.dataId)),u=n.readSync(r.dataId),c=Array.from(n.readSync(i.dataId)),l=Tb(u,r.shape,r.dtype,s,c),g=Object(o.a)(l,3),d=g[0],h=g[1],f=g[2];return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([f.length],i.dtype,new Int32Array(f))]}};var gx={kernelName:i.Lc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));var s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=Eb(s,r.shape,r.dtype,u,c,!0),g=Object(o.a)(l,2),d=g[0],h=g[1];return n.makeTensorInfo(h,r.dtype,d)}};var dx={kernelName:i.Mc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,i=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));var s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=Eb(s,r.shape,r.dtype,u,c),g=Object(o.a)(l,2),d=g[0],h=g[1];return n.makeTensorInfo(h,r.dtype,d)}};var hx={kernelName:i.Nc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,o=t.sparseValues,s=t.defaultValue,u=r.outputShape,c=i.ud.calculateShapes(o,a,u),l=c.sliceRank,g=c.numUpdates,d=c.strides,h=c.outputSize,f=new _B(g,l,a.shape.length,o.shape.length,d,[h,1],!1),p=n.runWebGLProgram(f,[o,a,s],o.dtype),I=zv({inputs:{x:p},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(p),I}};var fx={kernelName:i.Oc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.numOrSizeSplits,s=r.axis,u=i.tf.parseAxisParam(s,a.shape)[0],c=i.ud.prepareSplitSize(a,o,u),l=a.shape.length,g=new Array(l).fill(0),d=a.shape.slice();return c.map((function(e){var t=Object(Yn.a)(d);t[u]=e;var r=JA({inputs:{x:a},backend:n,attrs:{begin:g,size:t}});return g[u]+=e,r}))}},px=Fv({opSnippet:"return sqrt(x);"}),Ix={kernelName:i.Pc,backendName:"webgl",kernelFunc:px},Cx=Fv({opSnippet:"return x * x;"}),mx={kernelName:i.Qc,backendName:"webgl",kernelFunc:Cx},bx="return (a - b) * (a - b);",vx=Mv({opSnippet:bx,packedOpSnippet:bx}),Ax={kernelName:i.Rc,backendName:"webgl",kernelFunc:vx};var yx={kernelName:i.Sc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=rv+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new nv(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},wx=function e(t,n,r){Object(Ur.a)(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=tb(r.length),o=tb(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")};var Gx={kernelName:i.Tc,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,s=a.begin,u=a.end,c=a.strides,l=a.beginMask,g=a.endMask,d=a.ellipsisMask,h=a.newAxisMask,f=a.shrinkAxisMask,p=i.Xe.sliceInfo(o.shape,s,u,c,l,g,d,h,f),I=p.nonStrided,C=p.$begin,m=p.$strides,b=p.size,v=p.newShape,A=p.outShape,y=zv({inputs:{x:o},backend:r,attrs:{shape:v}});if(I){var w=JA({inputs:{x:y},backend:r,attrs:{begin:C,size:b}});t=zv({inputs:{x:w},backend:r,attrs:{shape:A}}),r.disposeIntermediateTensorInfo(w)}else if(A.some((function(e){return 0===e})))t=r.makeTensorInfo(A,o.dtype,[]);else{if(r.shouldExecuteOnCPU([y])){var G=r.texData.get(y.dataId).values,B=Object(i.zd)(y.shape,y.dtype,G),x=jb(A,B,m,C);t=r.makeTensorInfo(A,y.dtype,x.values)}else{var S=new wx(C,m,A);t=r.runWebGLProgram(S,[y],y.dtype)}}var k=zv({inputs:{x:t},backend:r,attrs:{shape:A}});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(t),k}};var Bx={kernelName:i.Uc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,i=r.nGramWidths,s=r.leftPad,u=r.rightPad,c=r.padWidth,l=r.preserveShortSequences,g=t.data,d=t.dataSplits,h=n.readSync(g.dataId),f=n.readSync(d.dataId),p=Lb(h,f,a,i,s,u,c,l),I=Object(o.a)(p,2),C=I[0],m=I[1];return[n.makeTensorInfo([C.length],"string",C),n.makeTensorInfo(d.shape,"int32",m)]}};var xx={kernelName:i.Vc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,i=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==i.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(i.shape));var s=n.readSync(a.dataId),u=n.readSync(i.dataId)[0],c=Xb(s,u,r),l=Object(o.a)(c,3),g=l[0],d=l[1],h=l[2],f=d.length;return[n.makeTensorInfo([f,2],"int32",g),n.makeTensorInfo([f],"string",d),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};var Sx={kernelName:i.Wc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=Hb(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},kx=Fv({opSnippet:"return tan(x);"}),Zx={kernelName:i.Zc,backendName:"webgl",kernelFunc:kx},Rx=Fv({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),Nx={kernelName:i.ad,backendName:"webgl",kernelFunc:Rx},Ox=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=tb(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")};function Wx(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.reps;if("string"===a.dtype||a.shape.length>5){var s=n.readSync(a.dataId),u="string"===a.dtype?s.map((function(e){return i.tf.decodeString(e)})):s,c=Object(i.zd)(a.shape,a.dtype,u),l=zb(c,o);return n.makeTensorInfo(l.shape,l.dtype,l.values)}var g=new Ox(a.shape,o);return n.runWebGLProgram(g,[a],a.dtype)}var Fx={kernelName:i.dd,backendName:"webgl",kernelFunc:Wx};var Mx={kernelName:i.ed,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,s=r.sorted,u=n.readSync(a.dataId),c=Kb(u,a.shape,a.dtype,i,s),l=Object(o.a)(c,2),g=l[0],d=l[1];return[n.makeTensorInfo(g.shape,g.dtype,g.values),n.makeTensorInfo(d.shape,d.dtype,d.values)]}},Vx=function e(t,n,r,a,i,o){Object(Ur.a)(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,u="nearest"===r?1:2;switch(a){case"constant":s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4;break;default:s=1}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(u," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")};var Tx={kernelName:i.fd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,s=r.interpolation,u=r.fillMode,c=r.fillValue,l=r.outputShape,g=Object(o.a)(a.shape,4),d=g[0],h=g[1],f=g[2],p=g[3],I=null!=l?l:[h,f],C=Object(o.a)(I,2),m=C[0],b=C[1],v=new Vx(h,f,s,u,c,[d,m,b,p]);return n.runWebGLProgram(v,[a,i],"float32")}};var Ex={kernelName:i.hd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;vm(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=Db(o,a,i.shape,i.dtype),u=s.outputValues,c=s.outputShape,l=s.indices;return[r.makeTensorInfo(c,i.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}};var jx={kernelName:i.id,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1),l=0,g=0;g<s;g++)g!==i&&(c[l++]=o.shape[g]);var d=[],h=new Array(s).fill(0),f=o.shape.slice();f[i]=1;for(var p=new Array(u),I=0;I<p.length;I++){h[i]=I;var C=JA({inputs:{x:o},backend:n,attrs:{begin:h,size:f}}),m=zv({inputs:{x:C},backend:n,attrs:{shape:c}});p[I]=m,d.push(C)}return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),p}},Lx=function e(t,n){Object(Ur.a)(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",g="";i%r>0&&(g="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(g,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(d,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")};for(var Xx=0,Hx=[vG,yG,rA,iA,sA,cA,dA,pA,IA,CA,wA,GA,xA,kA,OA,RA,FA,EA,TA,XA,HA,YA,_A,qA,$A,ay,sy,ly,hy,Sv,Ay,Oy,Wy,Sy,My,Vy,Fy,Ey,Ly,Hy,_y,Dy,Uy,tw,nw,qy,aw,ow,sw,cw,lw,dw,fw,Cw,bw,yw,Bw,Zw,Nw,Fw,Vw,jw,Lw,Xw,Yw,Kw,Dw,Uw,Bv,Jw,my,qw,eG,nG,Rv,aG,oG,sG,gG,cG,hG,pG,CG,GG,kG,SG,NG,OG,WG,xG,FG,MG,TG,LG,HG,QG,Yv,$G,tB,rB,iB,ty,sB,lB,gB,pB,CB,Wv,mB,vB,ry,KG,yB,xB,GB,Kv,ZB,NB,FB,VB,jB,XB,YB,KB,DB,UB,QB,$B,tx,rx,ix,QA,JG,sx,ux,cx,lx,gx,dx,hx,fx,Ix,mx,Ax,yx,Gx,Bx,xx,Sx,PG,$v,Zx,Nx,Fx,Mx,Tx,tA,Ex,jx,{kernelName:i.jd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.segmentIds,s=r.numSegments,u=a.shape.length,c=[],l=0,g=i.ud.getAxesPermutation([l],u),d=a;null!=g&&(d=eA({inputs:{x:a},backend:n,attrs:{perm:g}}),c.push(d),l=i.ud.getInnerMostAxes(1,u)[0]);var h=i.ud.segment_util.computeOutShape(d.shape,l,s),f=i.tf.sizeFromShape([d.shape[l]]),p=zv({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});c.push(p);var I=zv({inputs:{x:function e(t,r,a,o,s){var u=t.shape[0],l=t.shape[1],g=i.ud.segment_util.segOpComputeOptimalWindowSize(l,s),d=new Lx({windowSize:g,inSize:l,batchSize:u,numSegments:s},r),h=n.compileAndRun(d,[t,a],o);if(c.push(h),h.shape[1]===s)return h;var f=bB({backend:n,attrs:{start:0,stop:s,step:1,dtype:"float32"}}),p=Wx({inputs:{x:f},backend:n,attrs:{reps:[l/g]}});return c.push(f),c.push(p),e(h,r,p,o,s)}(p,"unsortedSegmentSum",o,Object(i.gf)(a.dtype),s)},backend:n,attrs:{shape:h}}),C=I;if(null!=g){c.push(I);var m=i.ud.getUndoAxesPermutation(g);C=eA({inputs:{x:C},backend:n,attrs:{perm:m}})}return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),C}},cB];Xx<Hx.length;Xx++){var Yx=Hx[Xx];Object(i.Ie)(Yx)}i.wf},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r={};function a(e){return r[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","min"),s={x:o},u={axis:t,keepDims:n};return r.a.runKernel(a.Qb,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({real_:function(e){var t={input:Object(i.a)(e,"input","real")};return r.a.runKernel(a.jc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(19),o=n(10);var s=Object(o.b)({ifft_:function(e){Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.a.runKernel(a.qb,t)}})},function(e,t,n){"use strict";(function(e,r){var a;function i(){if(null==a){var t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof e)t=e;else if("undefined"!==typeof r)t=r;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}a=t}return a}function o(e,t){var n=function(){var e=i();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))}).call(this,n(148),n(197))},function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(343);function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object(r.a)(e,t)}},function(e,t,n){"use strict";var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a="object"===("undefined"===typeof window?"undefined":r(window))&&"object"===("undefined"===typeof document?"undefined":r(document))&&9===document.nodeType;t.a=a},function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return i}));var a=n(50);function i(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?Object(a.a)(e):t}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";n.r(t),n.d(t,"version",(function(){return r})),n.d(t,"bisect",(function(){return I})),n.d(t,"bisectRight",(function(){return h})),n.d(t,"bisectLeft",(function(){return f})),n.d(t,"bisectCenter",(function(){return p})),n.d(t,"ascending",(function(){return a})),n.d(t,"bisector",(function(){return i})),n.d(t,"count",(function(){return C})),n.d(t,"cross",(function(){return w})),n.d(t,"cumsum",(function(){return G})),n.d(t,"descending",(function(){return B})),n.d(t,"deviation",(function(){return S})),n.d(t,"extent",(function(){return k})),n.d(t,"Adder",(function(){return N})),n.d(t,"fsum",(function(){return O})),n.d(t,"fcumsum",(function(){return W})),n.d(t,"group",(function(){return P})),n.d(t,"groups",(function(){return U})),n.d(t,"index",(function(){return q})),n.d(t,"indexes",(function(){return $})),n.d(t,"rollup",(function(){return J})),n.d(t,"rollups",(function(){return Q})),n.d(t,"groupSort",(function(){return ae})),n.d(t,"bin",(function(){return Ie})),n.d(t,"histogram",(function(){return Ie})),n.d(t,"thresholdFreedmanDiaconis",(function(){return we})),n.d(t,"thresholdScott",(function(){return Ge})),n.d(t,"thresholdSturges",(function(){return pe})),n.d(t,"max",(function(){return Ce})),n.d(t,"maxIndex",(function(){return Be})),n.d(t,"mean",(function(){return xe})),n.d(t,"median",(function(){return Se})),n.d(t,"merge",(function(){return Re})),n.d(t,"min",(function(){return me})),n.d(t,"minIndex",(function(){return Ne})),n.d(t,"nice",(function(){return fe})),n.d(t,"pairs",(function(){return Oe})),n.d(t,"permute",(function(){return ne})),n.d(t,"quantile",(function(){return Ae})),n.d(t,"quantileSorted",(function(){return ye})),n.d(t,"quickselect",(function(){return be})),n.d(t,"range",(function(){return Fe})),n.d(t,"least",(function(){return Me})),n.d(t,"leastIndex",(function(){return Ve})),n.d(t,"greatest",(function(){return Te})),n.d(t,"greatestIndex",(function(){return Ee})),n.d(t,"scan",(function(){return je})),n.d(t,"shuffle",(function(){return Le})),n.d(t,"shuffler",(function(){return Xe})),n.d(t,"sum",(function(){return He})),n.d(t,"ticks",(function(){return ge})),n.d(t,"tickIncrement",(function(){return de})),n.d(t,"tickStep",(function(){return he})),n.d(t,"transpose",(function(){return Ye})),n.d(t,"variance",(function(){return x})),n.d(t,"zip",(function(){return Ke})),n.d(t,"every",(function(){return _e})),n.d(t,"some",(function(){return De})),n.d(t,"filter",(function(){return Pe})),n.d(t,"map",(function(){return Ue})),n.d(t,"reduce",(function(){return Je})),n.d(t,"reverse",(function(){return Qe})),n.d(t,"sort",(function(){return re})),n.d(t,"difference",(function(){return qe})),n.d(t,"disjoint",(function(){return $e})),n.d(t,"intersection",(function(){return tt})),n.d(t,"subset",(function(){return rt})),n.d(t,"superset",(function(){return nt})),n.d(t,"union",(function(){return at})),n.d(t,"InternMap",(function(){return X})),n.d(t,"InternSet",(function(){return H})),n.d(t,"axisTop",(function(){return ft})),n.d(t,"axisRight",(function(){return pt})),n.d(t,"axisBottom",(function(){return It})),n.d(t,"axisLeft",(function(){return Ct})),n.d(t,"brush",(function(){return Xi})),n.d(t,"brushX",(function(){return ji})),n.d(t,"brushY",(function(){return Li})),n.d(t,"brushSelection",(function(){return Ei})),n.d(t,"chord",(function(){return $i})),n.d(t,"chordTranspose",(function(){return eo})),n.d(t,"chordDirected",(function(){return to})),n.d(t,"ribbon",(function(){return Ao})),n.d(t,"ribbonArrow",(function(){return yo})),n.d(t,"color",(function(){return dr})),n.d(t,"rgb",(function(){return Ir})),n.d(t,"hsl",(function(){return wr})),n.d(t,"lab",(function(){return Oo})),n.d(t,"hcl",(function(){return Lo})),n.d(t,"lch",(function(){return jo})),n.d(t,"gray",(function(){return No})),n.d(t,"cubehelix",(function(){return qo})),n.d(t,"contours",(function(){return us})),n.d(t,"contourDensity",(function(){return fs})),n.d(t,"Delaunay",(function(){return Ts})),n.d(t,"Voronoi",(function(){return Rs})),n.d(t,"dispatch",(function(){return Gt})),n.d(t,"drag",(function(){return _s})),n.d(t,"dragDisable",(function(){return _n})),n.d(t,"dragEnable",(function(){return Dn})),n.d(t,"dsvFormat",(function(){return $s})),n.d(t,"csvParse",(function(){return tu})),n.d(t,"csvParseRows",(function(){return nu})),n.d(t,"csvFormat",(function(){return ru})),n.d(t,"csvFormatBody",(function(){return au})),n.d(t,"csvFormatRows",(function(){return iu})),n.d(t,"csvFormatRow",(function(){return ou})),n.d(t,"csvFormatValue",(function(){return su})),n.d(t,"tsvParse",(function(){return cu})),n.d(t,"tsvParseRows",(function(){return lu})),n.d(t,"tsvFormat",(function(){return gu})),n.d(t,"tsvFormatBody",(function(){return du})),n.d(t,"tsvFormatRows",(function(){return hu})),n.d(t,"tsvFormatRow",(function(){return fu})),n.d(t,"tsvFormatValue",(function(){return pu})),n.d(t,"autoType",(function(){return Iu})),n.d(t,"easeLinear",(function(){return mu.y})),n.d(t,"easeQuad",(function(){return mu.D})),n.d(t,"easeQuadIn",(function(){return mu.E})),n.d(t,"easeQuadOut",(function(){return mu.G})),n.d(t,"easeQuadInOut",(function(){return mu.F})),n.d(t,"easeCubic",(function(){return mu.m})),n.d(t,"easeCubicIn",(function(){return mu.n})),n.d(t,"easeCubicOut",(function(){return mu.p})),n.d(t,"easeCubicInOut",(function(){return mu.o})),n.d(t,"easePoly",(function(){return mu.z})),n.d(t,"easePolyIn",(function(){return mu.A})),n.d(t,"easePolyOut",(function(){return mu.C})),n.d(t,"easePolyInOut",(function(){return mu.B})),n.d(t,"easeSin",(function(){return mu.H})),n.d(t,"easeSinIn",(function(){return mu.I})),n.d(t,"easeSinOut",(function(){return mu.K})),n.d(t,"easeSinInOut",(function(){return mu.J})),n.d(t,"easeExp",(function(){return mu.u})),n.d(t,"easeExpIn",(function(){return mu.v})),n.d(t,"easeExpOut",(function(){return mu.x})),n.d(t,"easeExpInOut",(function(){return mu.w})),n.d(t,"easeCircle",(function(){return mu.i})),n.d(t,"easeCircleIn",(function(){return mu.j})),n.d(t,"easeCircleOut",(function(){return mu.l})),n.d(t,"easeCircleInOut",(function(){return mu.k})),n.d(t,"easeBounce",(function(){return mu.e})),n.d(t,"easeBounceIn",(function(){return mu.f})),n.d(t,"easeBounceOut",(function(){return mu.h})),n.d(t,"easeBounceInOut",(function(){return mu.g})),n.d(t,"easeBack",(function(){return mu.a})),n.d(t,"easeBackIn",(function(){return mu.b})),n.d(t,"easeBackOut",(function(){return mu.d})),n.d(t,"easeBackInOut",(function(){return mu.c})),n.d(t,"easeElastic",(function(){return mu.q})),n.d(t,"easeElasticIn",(function(){return mu.r})),n.d(t,"easeElasticOut",(function(){return mu.t})),n.d(t,"easeElasticInOut",(function(){return mu.s})),n.d(t,"blob",(function(){return vu})),n.d(t,"buffer",(function(){return yu})),n.d(t,"dsv",(function(){return xu})),n.d(t,"csv",(function(){return Su})),n.d(t,"tsv",(function(){return ku})),n.d(t,"image",(function(){return Zu})),n.d(t,"json",(function(){return Nu})),n.d(t,"text",(function(){return Gu})),n.d(t,"xml",(function(){return Wu})),n.d(t,"html",(function(){return Fu})),n.d(t,"svg",(function(){return Mu})),n.d(t,"forceCenter",(function(){return Vu})),n.d(t,"forceCollide",(function(){return Uu})),n.d(t,"forceLink",(function(){return qu})),n.d(t,"forceManyBody",(function(){return ac})),n.d(t,"forceRadial",(function(){return ic})),n.d(t,"forceSimulation",(function(){return rc})),n.d(t,"forceX",(function(){return oc})),n.d(t,"forceY",(function(){return sc})),n.d(t,"formatDefaultLocale",(function(){return wc})),n.d(t,"format",(function(){return pc})),n.d(t,"formatPrefix",(function(){return Ic})),n.d(t,"formatLocale",(function(){return yc})),n.d(t,"formatSpecifier",(function(){return gc})),n.d(t,"FormatSpecifier",(function(){return dc})),n.d(t,"precisionFixed",(function(){return Gc})),n.d(t,"precisionPrefix",(function(){return Bc})),n.d(t,"precisionRound",(function(){return xc})),n.d(t,"geoArea",(function(){return Sl})),n.d(t,"geoBounds",(function(){return ug})),n.d(t,"geoCentroid",(function(){return vg})),n.d(t,"geoCircle",(function(){return Ng})),n.d(t,"geoClipAntimeridian",(function(){return Hg})),n.d(t,"geoClipCircle",(function(){return Yg})),n.d(t,"geoClipExtent",(function(){return Qg})),n.d(t,"geoClipRectangle",(function(){return _g})),n.d(t,"geoContains",(function(){return fd})),n.d(t,"geoDistance",(function(){return id})),n.d(t,"geoGraticule",(function(){return Cd})),n.d(t,"geoGraticule10",(function(){return md})),n.d(t,"geoInterpolate",(function(){return wd})),n.d(t,"geoLength",(function(){return nd})),n.d(t,"geoPath",(function(){return Ah})),n.d(t,"geoAlbers",(function(){return jh})),n.d(t,"geoAlbersUsa",(function(){return Lh})),n.d(t,"geoAzimuthalEqualArea",(function(){return zh})),n.d(t,"geoAzimuthalEqualAreaRaw",(function(){return Yh})),n.d(t,"geoAzimuthalEquidistant",(function(){return _h})),n.d(t,"geoAzimuthalEquidistantRaw",(function(){return Kh})),n.d(t,"geoConicConformal",(function(){return qh})),n.d(t,"geoConicConformalRaw",(function(){return Qh})),n.d(t,"geoConicEqualArea",(function(){return Eh})),n.d(t,"geoConicEqualAreaRaw",(function(){return Th})),n.d(t,"geoConicEquidistant",(function(){return nf})),n.d(t,"geoConicEquidistantRaw",(function(){return tf})),n.d(t,"geoEqualEarth",(function(){return lf})),n.d(t,"geoEqualEarthRaw",(function(){return cf})),n.d(t,"geoEquirectangular",(function(){return ef})),n.d(t,"geoEquirectangularRaw",(function(){return $h})),n.d(t,"geoGnomonic",(function(){return df})),n.d(t,"geoGnomonicRaw",(function(){return gf})),n.d(t,"geoIdentity",(function(){return hf})),n.d(t,"geoProjection",(function(){return Fh})),n.d(t,"geoProjectionMutator",(function(){return Mh})),n.d(t,"geoMercator",(function(){return Ph})),n.d(t,"geoMercatorRaw",(function(){return Dh})),n.d(t,"geoNaturalEarth1",(function(){return pf})),n.d(t,"geoNaturalEarth1Raw",(function(){return ff})),n.d(t,"geoOrthographic",(function(){return Cf})),n.d(t,"geoOrthographicRaw",(function(){return If})),n.d(t,"geoStereographic",(function(){return bf})),n.d(t,"geoStereographicRaw",(function(){return mf})),n.d(t,"geoTransverseMercator",(function(){return Af})),n.d(t,"geoTransverseMercatorRaw",(function(){return vf})),n.d(t,"geoRotation",(function(){return kg})),n.d(t,"geoStream",(function(){return ul})),n.d(t,"geoTransform",(function(){return yh})),n.d(t,"cluster",(function(){return Bf})),n.d(t,"hierarchy",(function(){return Zf})),n.d(t,"pack",(function(){return ep})),n.d(t,"packSiblings",(function(){return Pf})),n.d(t,"packEnclose",(function(){return Mf})),n.d(t,"partition",(function(){return op})),n.d(t,"stratify",(function(){return gp})),n.d(t,"tree",(function(){return mp})),n.d(t,"treemap",(function(){return wp})),n.d(t,"treemapBinary",(function(){return Gp})),n.d(t,"treemapDice",(function(){return ip})),n.d(t,"treemapSlice",(function(){return bp})),n.d(t,"treemapSliceDice",(function(){return Bp})),n.d(t,"treemapSquarify",(function(){return yp})),n.d(t,"treemapResquarify",(function(){return xp})),n.d(t,"interpolate",(function(){return Jr})),n.d(t,"interpolateArray",(function(){return Lr})),n.d(t,"interpolateBasis",(function(){return Sr})),n.d(t,"interpolateBasisClosed",(function(){return kr})),n.d(t,"interpolateDate",(function(){return Hr})),n.d(t,"interpolateDiscrete",(function(){return Sp})),n.d(t,"interpolateHue",(function(){return kp})),n.d(t,"interpolateNumber",(function(){return Yr})),n.d(t,"interpolateNumberArray",(function(){return Er})),n.d(t,"interpolateObject",(function(){return zr})),n.d(t,"interpolateRound",(function(){return Zp})),n.d(t,"interpolateString",(function(){return Ur})),n.d(t,"interpolateTransformCss",(function(){return ka})),n.d(t,"interpolateTransformSvg",(function(){return Za})),n.d(t,"interpolateZoom",(function(){return Np})),n.d(t,"interpolateRgb",(function(){return Fr})),n.d(t,"interpolateRgbBasis",(function(){return Vr})),n.d(t,"interpolateRgbBasisClosed",(function(){return Tr})),n.d(t,"interpolateHsl",(function(){return Wp})),n.d(t,"interpolateHslLong",(function(){return Fp})),n.d(t,"interpolateLab",(function(){return Mp})),n.d(t,"interpolateHcl",(function(){return Tp})),n.d(t,"interpolateHclLong",(function(){return Ep})),n.d(t,"interpolateCubehelix",(function(){return Lp})),n.d(t,"interpolateCubehelixLong",(function(){return Xp})),n.d(t,"piecewise",(function(){return Hp})),n.d(t,"quantize",(function(){return Yp})),n.d(t,"path",(function(){return co})),n.d(t,"polygonArea",(function(){return zp})),n.d(t,"polygonCentroid",(function(){return Kp})),n.d(t,"polygonHull",(function(){return Pp})),n.d(t,"polygonContains",(function(){return Up})),n.d(t,"polygonLength",(function(){return Jp})),n.d(t,"quadtree",(function(){return Xu})),n.d(t,"randomUniform",(function(){return qp})),n.d(t,"randomInt",(function(){return $p})),n.d(t,"randomNormal",(function(){return eI})),n.d(t,"randomLogNormal",(function(){return tI})),n.d(t,"randomBates",(function(){return rI})),n.d(t,"randomIrwinHall",(function(){return nI})),n.d(t,"randomExponential",(function(){return aI})),n.d(t,"randomPareto",(function(){return iI})),n.d(t,"randomBernoulli",(function(){return oI})),n.d(t,"randomGeometric",(function(){return sI})),n.d(t,"randomBinomial",(function(){return lI})),n.d(t,"randomGamma",(function(){return uI})),n.d(t,"randomBeta",(function(){return cI})),n.d(t,"randomWeibull",(function(){return gI})),n.d(t,"randomCauchy",(function(){return dI})),n.d(t,"randomLogistic",(function(){return hI})),n.d(t,"randomPoisson",(function(){return fI})),n.d(t,"randomLcg",(function(){return mI})),n.d(t,"scaleBand",(function(){return wI})),n.d(t,"scalePoint",(function(){return BI})),n.d(t,"scaleIdentity",(function(){return EI})),n.d(t,"scaleLinear",(function(){return TI})),n.d(t,"scaleLog",(function(){return DI})),n.d(t,"scaleSymlog",(function(){return QI})),n.d(t,"scaleOrdinal",(function(){return yI})),n.d(t,"scaleImplicit",(function(){return AI})),n.d(t,"scalePow",(function(){return nC})),n.d(t,"scaleSqrt",(function(){return rC})),n.d(t,"scaleRadial",(function(){return oC})),n.d(t,"scaleQuantile",(function(){return sC})),n.d(t,"scaleQuantize",(function(){return uC})),n.d(t,"scaleThreshold",(function(){return cC})),n.d(t,"scaleTime",(function(){return Cv})),n.d(t,"scaleUtc",(function(){return mv})),n.d(t,"scaleSequential",(function(){return Av})),n.d(t,"scaleSequentialLog",(function(){return yv})),n.d(t,"scaleSequentialPow",(function(){return Gv})),n.d(t,"scaleSequentialSqrt",(function(){return Bv})),n.d(t,"scaleSequentialSymlog",(function(){return wv})),n.d(t,"scaleSequentialQuantile",(function(){return xv})),n.d(t,"scaleDiverging",(function(){return kv})),n.d(t,"scaleDivergingLog",(function(){return Zv})),n.d(t,"scaleDivergingPow",(function(){return Nv})),n.d(t,"scaleDivergingSqrt",(function(){return Ov})),n.d(t,"scaleDivergingSymlog",(function(){return Rv})),n.d(t,"tickFormat",(function(){return MI})),n.d(t,"schemeCategory10",(function(){return Fv})),n.d(t,"schemeAccent",(function(){return Mv})),n.d(t,"schemeDark2",(function(){return Vv})),n.d(t,"schemePaired",(function(){return Tv})),n.d(t,"schemePastel1",(function(){return Ev})),n.d(t,"schemePastel2",(function(){return jv})),n.d(t,"schemeSet1",(function(){return Lv})),n.d(t,"schemeSet2",(function(){return Xv})),n.d(t,"schemeSet3",(function(){return Hv})),n.d(t,"schemeTableau10",(function(){return Yv})),n.d(t,"interpolateBrBG",(function(){return _v})),n.d(t,"schemeBrBG",(function(){return Kv})),n.d(t,"interpolatePRGn",(function(){return Pv})),n.d(t,"schemePRGn",(function(){return Dv})),n.d(t,"interpolatePiYG",(function(){return Jv})),n.d(t,"schemePiYG",(function(){return Uv})),n.d(t,"interpolatePuOr",(function(){return qv})),n.d(t,"schemePuOr",(function(){return Qv})),n.d(t,"interpolateRdBu",(function(){return eA})),n.d(t,"schemeRdBu",(function(){return $v})),n.d(t,"interpolateRdGy",(function(){return nA})),n.d(t,"schemeRdGy",(function(){return tA})),n.d(t,"interpolateRdYlBu",(function(){return aA})),n.d(t,"schemeRdYlBu",(function(){return rA})),n.d(t,"interpolateRdYlGn",(function(){return oA})),n.d(t,"schemeRdYlGn",(function(){return iA})),n.d(t,"interpolateSpectral",(function(){return uA})),n.d(t,"schemeSpectral",(function(){return sA})),n.d(t,"interpolateBuGn",(function(){return lA})),n.d(t,"schemeBuGn",(function(){return cA})),n.d(t,"interpolateBuPu",(function(){return dA})),n.d(t,"schemeBuPu",(function(){return gA})),n.d(t,"interpolateGnBu",(function(){return fA})),n.d(t,"schemeGnBu",(function(){return hA})),n.d(t,"interpolateOrRd",(function(){return IA})),n.d(t,"schemeOrRd",(function(){return pA})),n.d(t,"interpolatePuBuGn",(function(){return mA})),n.d(t,"schemePuBuGn",(function(){return CA})),n.d(t,"interpolatePuBu",(function(){return vA})),n.d(t,"schemePuBu",(function(){return bA})),n.d(t,"interpolatePuRd",(function(){return yA})),n.d(t,"schemePuRd",(function(){return AA})),n.d(t,"interpolateRdPu",(function(){return GA})),n.d(t,"schemeRdPu",(function(){return wA})),n.d(t,"interpolateYlGnBu",(function(){return xA})),n.d(t,"schemeYlGnBu",(function(){return BA})),n.d(t,"interpolateYlGn",(function(){return kA})),n.d(t,"schemeYlGn",(function(){return SA})),n.d(t,"interpolateYlOrBr",(function(){return RA})),n.d(t,"schemeYlOrBr",(function(){return ZA})),n.d(t,"interpolateYlOrRd",(function(){return OA})),n.d(t,"schemeYlOrRd",(function(){return NA})),n.d(t,"interpolateBlues",(function(){return FA})),n.d(t,"schemeBlues",(function(){return WA})),n.d(t,"interpolateGreens",(function(){return VA})),n.d(t,"schemeGreens",(function(){return MA})),n.d(t,"interpolateGreys",(function(){return EA})),n.d(t,"schemeGreys",(function(){return TA})),n.d(t,"interpolatePurples",(function(){return LA})),n.d(t,"schemePurples",(function(){return jA})),n.d(t,"interpolateReds",(function(){return HA})),n.d(t,"schemeReds",(function(){return XA})),n.d(t,"interpolateOranges",(function(){return zA})),n.d(t,"schemeOranges",(function(){return YA})),n.d(t,"interpolateCividis",(function(){return KA})),n.d(t,"interpolateCubehelixDefault",(function(){return _A})),n.d(t,"interpolateRainbow",(function(){return JA})),n.d(t,"interpolateWarm",(function(){return DA})),n.d(t,"interpolateCool",(function(){return PA})),n.d(t,"interpolateSinebow",(function(){return ey})),n.d(t,"interpolateTurbo",(function(){return ty})),n.d(t,"interpolateViridis",(function(){return ry})),n.d(t,"interpolateMagma",(function(){return ay})),n.d(t,"interpolateInferno",(function(){return iy})),n.d(t,"interpolatePlasma",(function(){return oy})),n.d(t,"create",(function(){return sy})),n.d(t,"creator",(function(){return xn})),n.d(t,"local",(function(){return cy})),n.d(t,"matcher",(function(){return Nt})),n.d(t,"namespace",(function(){return _t})),n.d(t,"namespaces",(function(){return Kt})),n.d(t,"pointer",(function(){return qr})),n.d(t,"pointers",(function(){return gy})),n.d(t,"select",(function(){return Yn})),n.d(t,"selectAll",(function(){return dy})),n.d(t,"selection",(function(){return Hn})),n.d(t,"selector",(function(){return St})),n.d(t,"selectorAll",(function(){return Rt})),n.d(t,"style",(function(){return rn})),n.d(t,"window",(function(){return $t})),n.d(t,"arc",(function(){return Fy})),n.d(t,"area",(function(){return Hy})),n.d(t,"line",(function(){return Xy})),n.d(t,"pie",(function(){return Ky})),n.d(t,"areaRadial",(function(){return Qy})),n.d(t,"radialArea",(function(){return Qy})),n.d(t,"lineRadial",(function(){return Jy})),n.d(t,"radialLine",(function(){return Jy})),n.d(t,"pointRadial",(function(){return qy})),n.d(t,"linkHorizontal",(function(){return iw})),n.d(t,"linkVertical",(function(){return ow})),n.d(t,"linkRadial",(function(){return sw})),n.d(t,"symbol",(function(){return xw})),n.d(t,"symbols",(function(){return Bw})),n.d(t,"symbolCircle",(function(){return uw})),n.d(t,"symbolCross",(function(){return cw})),n.d(t,"symbolDiamond",(function(){return dw})),n.d(t,"symbolSquare",(function(){return Cw})),n.d(t,"symbolStar",(function(){return Iw})),n.d(t,"symbolTriangle",(function(){return bw})),n.d(t,"symbolWye",(function(){return Gw})),n.d(t,"curveBasisClosed",(function(){return Ow})),n.d(t,"curveBasisOpen",(function(){return Fw})),n.d(t,"curveBasis",(function(){return Rw})),n.d(t,"curveBumpX",(function(){return Vw})),n.d(t,"curveBumpY",(function(){return Tw})),n.d(t,"curveBundle",(function(){return jw})),n.d(t,"curveCardinalClosed",(function(){return zw})),n.d(t,"curveCardinalOpen",(function(){return _w})),n.d(t,"curveCardinal",(function(){return Hw})),n.d(t,"curveCatmullRomClosed",(function(){return Qw})),n.d(t,"curveCatmullRomOpen",(function(){return $w})),n.d(t,"curveCatmullRom",(function(){return Uw})),n.d(t,"curveLinearClosed",(function(){return tG})),n.d(t,"curveLinear",(function(){return Ey})),n.d(t,"curveMonotoneX",(function(){return cG})),n.d(t,"curveMonotoneY",(function(){return lG})),n.d(t,"curveNatural",(function(){return hG})),n.d(t,"curveStep",(function(){return pG})),n.d(t,"curveStepAfter",(function(){return CG})),n.d(t,"curveStepBefore",(function(){return IG})),n.d(t,"stack",(function(){return yG})),n.d(t,"stackOffsetExpand",(function(){return wG})),n.d(t,"stackOffsetDiverging",(function(){return GG})),n.d(t,"stackOffsetNone",(function(){return mG})),n.d(t,"stackOffsetSilhouette",(function(){return BG})),n.d(t,"stackOffsetWiggle",(function(){return xG})),n.d(t,"stackOrderAppearance",(function(){return SG})),n.d(t,"stackOrderAscending",(function(){return ZG})),n.d(t,"stackOrderDescending",(function(){return NG})),n.d(t,"stackOrderInsideOut",(function(){return OG})),n.d(t,"stackOrderNone",(function(){return bG})),n.d(t,"stackOrderReverse",(function(){return WG})),n.d(t,"timeInterval",(function(){return bC})),n.d(t,"timeMillisecond",(function(){return AC})),n.d(t,"timeMilliseconds",(function(){return yC})),n.d(t,"utcMillisecond",(function(){return AC})),n.d(t,"utcMilliseconds",(function(){return yC})),n.d(t,"timeSecond",(function(){return GC})),n.d(t,"timeSeconds",(function(){return BC})),n.d(t,"utcSecond",(function(){return GC})),n.d(t,"utcSeconds",(function(){return BC})),n.d(t,"timeMinute",(function(){return SC})),n.d(t,"timeMinutes",(function(){return kC})),n.d(t,"timeHour",(function(){return RC})),n.d(t,"timeHours",(function(){return NC})),n.d(t,"timeDay",(function(){return WC})),n.d(t,"timeDays",(function(){return FC})),n.d(t,"timeWeek",(function(){return VC})),n.d(t,"timeWeeks",(function(){return YC})),n.d(t,"timeSunday",(function(){return VC})),n.d(t,"timeSundays",(function(){return YC})),n.d(t,"timeMonday",(function(){return TC})),n.d(t,"timeMondays",(function(){return zC})),n.d(t,"timeTuesday",(function(){return EC})),n.d(t,"timeTuesdays",(function(){return KC})),n.d(t,"timeWednesday",(function(){return jC})),n.d(t,"timeWednesdays",(function(){return _C})),n.d(t,"timeThursday",(function(){return LC})),n.d(t,"timeThursdays",(function(){return DC})),n.d(t,"timeFriday",(function(){return XC})),n.d(t,"timeFridays",(function(){return PC})),n.d(t,"timeSaturday",(function(){return HC})),n.d(t,"timeSaturdays",(function(){return UC})),n.d(t,"timeMonth",(function(){return QC})),n.d(t,"timeMonths",(function(){return qC})),n.d(t,"timeYear",(function(){return em})),n.d(t,"timeYears",(function(){return tm})),n.d(t,"utcMinute",(function(){return rm})),n.d(t,"utcMinutes",(function(){return am})),n.d(t,"utcHour",(function(){return om})),n.d(t,"utcHours",(function(){return sm})),n.d(t,"utcDay",(function(){return cm})),n.d(t,"utcDays",(function(){return lm})),n.d(t,"utcWeek",(function(){return dm})),n.d(t,"utcWeeks",(function(){return bm})),n.d(t,"utcSunday",(function(){return dm})),n.d(t,"utcSundays",(function(){return bm})),n.d(t,"utcMonday",(function(){return hm})),n.d(t,"utcMondays",(function(){return vm})),n.d(t,"utcTuesday",(function(){return fm})),n.d(t,"utcTuesdays",(function(){return Am})),n.d(t,"utcWednesday",(function(){return pm})),n.d(t,"utcWednesdays",(function(){return ym})),n.d(t,"utcThursday",(function(){return Im})),n.d(t,"utcThursdays",(function(){return wm})),n.d(t,"utcFriday",(function(){return Cm})),n.d(t,"utcFridays",(function(){return Gm})),n.d(t,"utcSaturday",(function(){return mm})),n.d(t,"utcSaturdays",(function(){return Bm})),n.d(t,"utcMonth",(function(){return Sm})),n.d(t,"utcMonths",(function(){return km})),n.d(t,"utcYear",(function(){return Rm})),n.d(t,"utcYears",(function(){return Nm})),n.d(t,"utcTicks",(function(){return Mm})),n.d(t,"utcTickInterval",(function(){return Vm})),n.d(t,"timeTicks",(function(){return jm})),n.d(t,"timeTickInterval",(function(){return Lm})),n.d(t,"timeFormatDefaultLocale",(function(){return hv})),n.d(t,"timeFormat",(function(){return _m})),n.d(t,"timeParse",(function(){return Dm})),n.d(t,"utcFormat",(function(){return Pm})),n.d(t,"utcParse",(function(){return Um})),n.d(t,"timeFormatLocale",(function(){return zm})),n.d(t,"isoFormat",(function(){return MG})),n.d(t,"isoParse",(function(){return VG})),n.d(t,"now",(function(){return sa})),n.d(t,"timer",(function(){return la})),n.d(t,"timerFlush",(function(){return ga})),n.d(t,"timeout",(function(){return pa})),n.d(t,"interval",(function(){return TG})),n.d(t,"transition",(function(){return ai})),n.d(t,"active",(function(){return li})),n.d(t,"interrupt",(function(){return wa})),n.d(t,"zoom",(function(){return QG})),n.d(t,"zoomTransform",(function(){return HG})),n.d(t,"zoomIdentity",(function(){return XG}));var r="6.7.0",a=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},i=function(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return a(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}};var o=n(7),s=n.n(o),u=n(16),c=s.a.mark(g),l=function(e){return null===e?NaN:+e};function g(e,t){var n,r,a,i,o,l,g;return s.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(void 0!==t){s.next=21;break}n=Object(u.a)(e),s.prev=2,n.s();case 4:if((r=n.n()).done){s.next=11;break}if(!(null!=(a=r.value)&&(a=+a)>=a)){s.next=9;break}return s.next=9,a;case 9:s.next=4;break;case 11:s.next=16;break;case 13:s.prev=13,s.t0=s.catch(2),n.e(s.t0);case 16:return s.prev=16,n.f(),s.finish(16);case 19:s.next=40;break;case 21:i=-1,o=Object(u.a)(e),s.prev=23,o.s();case 25:if((l=o.n()).done){s.next=32;break}if(g=l.value,!(null!=(g=t(g,++i,e))&&(g=+g)>=g)){s.next=30;break}return s.next=30,g;case 30:s.next=25;break;case 32:s.next=37;break;case 34:s.prev=34,s.t1=s.catch(23),o.e(s.t1);case 37:return s.prev=37,o.f(),s.finish(37);case 40:case"end":return s.stop()}}),c,null,[[2,13,16,19],[23,34,37,40]])}var d=i(a),h=d.right,f=d.left,p=i(l).center,I=h;function C(e,t){var n=0;if(void 0===t){var r,a=Object(u.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(i=+i)>=i&&++n}}catch(g){a.e(g)}finally{a.f()}}else{var o,s=-1,c=Object(u.a)(e);try{for(c.s();!(o=c.n()).done;){var l=o.value;null!=(l=t(l,++s,e))&&(l=+l)>=l&&++n}}catch(g){c.e(g)}finally{c.f()}}return n}var m=n(21);function b(e){return 0|e.length}function v(e){return!(e>0)}function A(e){return"object"!==typeof e||"length"in e?e:Array.from(e)}function y(e){return function(t){return e.apply(void 0,Object(m.a)(t))}}function w(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="function"===typeof t[t.length-1]&&y(t.pop()),a=(t=t.map(A)).map(b),i=t.length-1,o=new Array(i+1).fill(0),s=[];if(i<0||a.some(v))return s;for(;;){s.push(o.map((function(e,n){return t[n][e]})));for(var u=i;++o[u]===a[u];){if(0===u)return r?s.map(r):s;o[u--]=0}}}function G(e,t){var n=0,r=0;return Float64Array.from(e,void 0===t?function(e){return n+=+e||0}:function(a){return n+=+t(a,r++,e)||0})}var B=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};function x(e,t){var n,r=0,a=0,i=0;if(void 0===t){var o,s=Object(u.a)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=c&&(c=+c)>=c&&(i+=(n=c-a)*(c-(a+=n/++r)))}}catch(f){s.e(f)}finally{s.f()}}else{var l,g=-1,d=Object(u.a)(e);try{for(d.s();!(l=d.n()).done;){var h=l.value;null!=(h=t(h,++g,e))&&(h=+h)>=h&&(i+=(n=h-a)*(h-(a+=n/++r)))}}catch(f){d.e(f)}finally{d.f()}}if(r>1)return i/(r-1)}function S(e,t){var n=x(e,t);return n?Math.sqrt(n):n}var k=function(e,t){var n,r;if(void 0===t){var a,i=Object(u.a)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;null!=o&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}}catch(d){i.e(d)}finally{i.f()}}else{var s,c=-1,l=Object(u.a)(e);try{for(l.s();!(s=l.n()).done;){var g=s.value;null!=(g=t(g,++c,e))&&(void 0===n?g>=g&&(n=r=g):(n>g&&(n=g),r<g&&(r=g)))}}catch(d){l.e(d)}finally{l.f()}}return[n,r]},Z=n(1),R=n(9),N=function(){function e(){Object(Z.a)(this,e),this._partials=new Float64Array(32),this._n=0}return Object(R.a)(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}();function O(e,t){var n=new N;if(void 0===t){var r,a=Object(u.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;(i=+i)&&n.add(i)}}catch(g){a.e(g)}finally{a.f()}}else{var o,s=-1,c=Object(u.a)(e);try{for(c.s();!(o=c.n()).done;){var l=o.value;(l=+t(l,++s,e))&&n.add(l)}}catch(g){c.e(g)}finally{c.f()}}return+n}function W(e,t){var n=new N,r=-1;return Float64Array.from(e,void 0===t?function(e){return n.add(+e||0)}:function(a){return n.add(+t(a,++r,e)||0)})}var F=n(3),M=n(50),V=n(23),T=n(22),E=n(12),j=n(13),L=n(126),X=function(e){Object(E.a)(n,e);var t=Object(j.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(Object(Z.a)(this,n),r=t.call(this),Object.defineProperties(Object(M.a)(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=Object(u.a)(e);try{for(o.s();!(i=o.n()).done;){var s=Object(F.a)(i.value,2),c=s[0],l=s[1];r.set(c,l)}}catch(g){o.e(g)}finally{o.f()}}return r}return Object(R.a)(n,[{key:"get",value:function(e){return Object(V.a)(Object(T.a)(n.prototype),"get",this).call(this,Y(this,e))}},{key:"has",value:function(e){return Object(V.a)(Object(T.a)(n.prototype),"has",this).call(this,Y(this,e))}},{key:"set",value:function(e,t){return Object(V.a)(Object(T.a)(n.prototype),"set",this).call(this,z(this,e),t)}},{key:"delete",value:function(e){return Object(V.a)(Object(T.a)(n.prototype),"delete",this).call(this,K(this,e))}}]),n}(Object(L.a)(Map)),H=function(e){Object(E.a)(n,e);var t=Object(j.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;if(Object(Z.a)(this,n),r=t.call(this),Object.defineProperties(Object(M.a)(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=Object(u.a)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;r.add(s)}}catch(c){o.e(c)}finally{o.f()}}return r}return Object(R.a)(n,[{key:"has",value:function(e){return Object(V.a)(Object(T.a)(n.prototype),"has",this).call(this,Y(this,e))}},{key:"add",value:function(e){return Object(V.a)(Object(T.a)(n.prototype),"add",this).call(this,z(this,e))}},{key:"delete",value:function(e){return Object(V.a)(Object(T.a)(n.prototype),"delete",this).call(this,K(this,e))}}]),n}(Object(L.a)(Set));function Y(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):t}function z(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function K(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)&&(t=n.get(t),n.delete(r)),t}function _(e){return null!==e&&"object"===typeof e?e.valueOf():e}var D=function(e){return e};function P(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return te(e,D,D,n)}function U(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return te(e,Array.from,D,n)}function J(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return te(e,D,t,r)}function Q(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return te(e,Array.from,t,r)}function q(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return te(e,D,ee,n)}function $(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return te(e,Array.from,ee,n)}function ee(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function te(e,t,n,r){return function e(a,i){if(i>=r.length)return n(a);var o,s=new X,c=r[i++],l=-1,g=Object(u.a)(a);try{for(g.s();!(o=g.n()).done;){var d=o.value,h=c(d,++l,a),f=s.get(h);f?f.push(d):s.set(h,[d])}}catch(v){g.e(v)}finally{g.f()}var p,I=Object(u.a)(s);try{for(I.s();!(p=I.n()).done;){var C=Object(F.a)(p.value,2),m=C[0],b=C[1];s.set(m,e(b,i))}}catch(v){I.e(v)}finally{I.f()}return t(s)}(e,0)}var ne=function(e,t){return Array.from(t,(function(t){return e[t]}))};function re(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);var i=n,o=Object(F.a)(i,1),s=o[0],c=void 0===s?a:s;if(1===c.length||n.length>1){var l=Uint32Array.from(e,(function(e,t){return t}));return n.length>1?(n=n.map((function(t){return e.map(t)})),l.sort((function(e,t){var r,i=Object(u.a)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=a(o[e],o[t]);if(s)return s}}catch(c){i.e(c)}finally{i.f()}}))):(c=e.map(c),l.sort((function(e,t){return a(c[e],c[t])}))),ne(e,l)}return e.sort(c)}function ae(e,t,n){return(1===t.length?re(J(e,t,n),(function(e,t){var n=Object(F.a)(e,2),r=n[0],i=n[1],o=Object(F.a)(t,2),s=o[0],u=o[1];return a(i,u)||a(r,s)})):re(P(e,n),(function(e,n){var r=Object(F.a)(e,2),i=r[0],o=r[1],s=Object(F.a)(n,2),u=s[0],c=s[1];return t(o,c)||a(i,u)}))).map((function(e){return Object(F.a)(e,1)[0]}))}var ie=Array.prototype,oe=ie.slice,se=(ie.map,function(e){return function(){return e}}),ue=Math.sqrt(50),ce=Math.sqrt(10),le=Math.sqrt(2),ge=function(e,t,n){var r,a,i,o,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=de(e,t,n))||!isFinite(o))return[];if(o>0){var u=Math.round(e/o),c=Math.round(t/o);for(u*o<e&&++u,c*o>t&&--c,i=new Array(a=c-u+1);++s<a;)i[s]=(u+s)*o}else{o=-o;var l=Math.round(e*o),g=Math.round(t*o);for(l/o<e&&++l,g/o>t&&--g,i=new Array(a=g-l+1);++s<a;)i[s]=(l+s)/o}return r&&i.reverse(),i};function de(e,t,n){var r=(t-e)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,a);return a>=0?(i>=ue?10:i>=ce?5:i>=le?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=ue?10:i>=ce?5:i>=le?2:1)}function he(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=ue?a*=10:i>=ce?a*=5:i>=le&&(a*=2),t<e?-a:a}function fe(e,t,n){for(var r;;){var a=de(e,t,n);if(a===r||0===a||!isFinite(a))return[e,t];a>0?(e=Math.floor(e/a)*a,t=Math.ceil(t/a)*a):a<0&&(e=Math.ceil(e*a)/a,t=Math.floor(t*a)/a),r=a}}var pe=function(e){return Math.ceil(Math.log(C(e))/Math.LN2)+1},Ie=function(){var e=D,t=k,n=pe;function r(r){Array.isArray(r)||(r=Array.from(r));var a,i,o=r.length,s=new Array(o);for(a=0;a<o;++a)s[a]=e(r[a],a,r);var u=t(s),c=u[0],l=u[1],g=n(s,c,l);if(!Array.isArray(g)){var d=l,h=+g;if(t===k){var f=fe(c,l,h),p=Object(F.a)(f,2);c=p[0],l=p[1]}if((g=ge(c,l,h))[g.length-1]>=l)if(d>=l&&t===k){var C=de(c,l,h);isFinite(C)&&(C>0?l=(Math.floor(l/C)+1)*C:C<0&&(l=(Math.ceil(l*-C)+1)/-C))}else g.pop()}for(var m=g.length;g[0]<=c;)g.shift(),--m;for(;g[m-1]>l;)g.pop(),--m;var b,v=new Array(m+1);for(a=0;a<=m;++a)(b=v[a]=[]).x0=a>0?g[a-1]:c,b.x1=a<m?g[a]:l;for(a=0;a<o;++a)c<=(i=s[a])&&i<=l&&v[I(g,i,0,m)].push(r[a]);return v}return r.value=function(t){return arguments.length?(e="function"===typeof t?t:se(t),r):e},r.domain=function(e){return arguments.length?(t="function"===typeof e?e:se([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"===typeof e?e:Array.isArray(e)?se(oe.call(e)):se(e),r):n},r};function Ce(e,t){var n;if(void 0===t){var r,a=Object(u.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(g){a.e(g)}finally{a.f()}}else{var o,s=-1,c=Object(u.a)(e);try{for(c.s();!(o=c.n()).done;){var l=o.value;null!=(l=t(l,++s,e))&&(n<l||void 0===n&&l>=l)&&(n=l)}}catch(g){c.e(g)}finally{c.f()}}return n}function me(e,t){var n;if(void 0===t){var r,a=Object(u.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}}catch(g){a.e(g)}finally{a.f()}}else{var o,s=-1,c=Object(u.a)(e);try{for(c.s();!(o=c.n()).done;){var l=o.value;null!=(l=t(l,++s,e))&&(n>l||void 0===n&&l>=l)&&(n=l)}}catch(g){c.e(g)}finally{c.f()}}return n}function be(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a;r>n;){if(r-n>600){var o=r-n+1,s=t-n+1,u=Math.log(o),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(o-c)/o)*(s-o/2<0?-1:1),g=Math.max(n,Math.floor(t-s*c/o+l)),d=Math.min(r,Math.floor(t+(o-s)*c/o+l));be(e,t,g,d,i)}var h=e[t],f=n,p=r;for(ve(e,n,t),i(e[r],h)>0&&ve(e,n,r);f<p;){for(ve(e,f,p),++f,--p;i(e[f],h)<0;)++f;for(;i(e[p],h)>0;)--p}0===i(e[n],h)?ve(e,n,p):ve(e,++p,r),p<=t&&(n=p+1),t<=p&&(r=p-1)}return e}function ve(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Ae(e,t,n){if(r=(e=Float64Array.from(g(e,n))).length){if((t=+t)<=0||r<2)return me(e);if(t>=1)return Ce(e);var r,a=(r-1)*t,i=Math.floor(a),o=Ce(be(e,i).subarray(0,i+1));return o+(me(e.subarray(i+1))-o)*(a-i)}}function ye(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),s=+n(e[i+1],i+1,e);return o+(s-o)*(a-i)}}var we=function(e,t,n){return Math.ceil((n-t)/(2*(Ae(e,.75)-Ae(e,.25))*Math.pow(C(e),-1/3)))},Ge=function(e,t,n){return Math.ceil((n-t)/(3.5*S(e)*Math.pow(C(e),-1/3)))};function Be(e,t){var n,r=-1,a=-1;if(void 0===t){var i,o=Object(u.a)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;++a,null!=s&&(n<s||void 0===n&&s>=s)&&(n=s,r=a)}}catch(d){o.e(d)}finally{o.f()}}else{var c,l=Object(u.a)(e);try{for(l.s();!(c=l.n()).done;){var g=c.value;null!=(g=t(g,++a,e))&&(n<g||void 0===n&&g>=g)&&(n=g,r=a)}}catch(d){l.e(d)}finally{l.f()}}return r}function xe(e,t){var n=0,r=0;if(void 0===t){var a,i=Object(u.a)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;null!=o&&(o=+o)>=o&&(++n,r+=o)}}catch(d){i.e(d)}finally{i.f()}}else{var s,c=-1,l=Object(u.a)(e);try{for(l.s();!(s=l.n()).done;){var g=s.value;null!=(g=t(g,++c,e))&&(g=+g)>=g&&(++n,r+=g)}}catch(d){l.e(d)}finally{l.f()}}if(n)return r/n}var Se=function(e,t){return Ae(e,.5,t)},ke=s.a.mark(Ze);function Ze(e){var t,n,r;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=Object(u.a)(e),a.prev=1,t.s();case 3:if((n=t.n()).done){a.next=8;break}return r=n.value,a.delegateYield(r,"t0",6);case 6:a.next=3;break;case 8:a.next=13;break;case 10:a.prev=10,a.t1=a.catch(1),t.e(a.t1);case 13:return a.prev=13,t.f(),a.finish(13);case 16:case"end":return a.stop()}}),ke,null,[[1,10,13,16]])}function Re(e){return Array.from(Ze(e))}function Ne(e,t){var n,r=-1,a=-1;if(void 0===t){var i,o=Object(u.a)(e);try{for(o.s();!(i=o.n()).done;){var s=i.value;++a,null!=s&&(n>s||void 0===n&&s>=s)&&(n=s,r=a)}}catch(d){o.e(d)}finally{o.f()}}else{var c,l=Object(u.a)(e);try{for(l.s();!(c=l.n()).done;){var g=c.value;null!=(g=t(g,++a,e))&&(n>g||void 0===n&&g>=g)&&(n=g,r=a)}}catch(d){l.e(d)}finally{l.f()}}return r}function Oe(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We,a=[],i=!1,o=Object(u.a)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;i&&a.push(r(t,s)),t=s,i=!0}}catch(c){o.e(c)}finally{o.f()}return a}function We(e,t){return[e,t]}var Fe=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i};function Me(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,r=!1;if(1===n.length){var i,o,s=Object(u.a)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=n(c);(r?a(l,i)<0:0===a(l,l))&&(t=c,i=l,r=!0)}}catch(f){s.e(f)}finally{s.f()}}else{var g,d=Object(u.a)(e);try{for(d.s();!(g=d.n()).done;){var h=g.value;(r?n(h,t)<0:0===n(h,h))&&(t=h,r=!0)}}catch(f){d.e(f)}finally{d.f()}}return t}function Ve(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if(1===n.length)return Ne(e,n);var r,i=-1,o=-1,s=Object(u.a)(e);try{for(s.s();!(r=s.n()).done;){var c=r.value;++o,(i<0?0===n(c,c):n(c,t)<0)&&(t=c,i=o)}}catch(l){s.e(l)}finally{s.f()}return i}function Te(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,r=!1;if(1===n.length){var i,o,s=Object(u.a)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=n(c);(r?a(l,i)>0:0===a(l,l))&&(t=c,i=l,r=!0)}}catch(f){s.e(f)}finally{s.f()}}else{var g,d=Object(u.a)(e);try{for(d.s();!(g=d.n()).done;){var h=g.value;(r?n(h,t)>0:0===n(h,h))&&(t=h,r=!0)}}catch(f){d.e(f)}finally{d.f()}}return t}function Ee(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;if(1===n.length)return Be(e,n);var r,i=-1,o=-1,s=Object(u.a)(e);try{for(s.s();!(r=s.n()).done;){var c=r.value;++o,(i<0?0===n(c,c):n(c,t)>0)&&(t=c,i=o)}}catch(l){s.e(l)}finally{s.f()}return i}function je(e,t){var n=Ve(e,t);return n<0?void 0:n}var Le=Xe(Math.random);function Xe(e){return function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,a=r-(n=+n);a;){var i=e()*a--|0,o=t[a+n];t[a+n]=t[i+n],t[i+n]=o}return t}}function He(e,t){var n=0;if(void 0===t){var r,a=Object(u.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;(i=+i)&&(n+=i)}}catch(g){a.e(g)}finally{a.f()}}else{var o,s=-1,c=Object(u.a)(e);try{for(c.s();!(o=c.n()).done;){var l=o.value;(l=+t(l,++s,e))&&(n+=l)}}catch(g){c.e(g)}finally{c.f()}}return n}var Ye=function(e){if(!(a=e.length))return[];for(var t=-1,n=me(e,ze),r=new Array(n);++t<n;)for(var a,i=-1,o=r[t]=new Array(a);++i<a;)o[i]=e[i][t];return r};function ze(e){return e.length}var Ke=function(){return Ye(arguments)};function _e(e,t){if("function"!==typeof t)throw new TypeError("test is not a function");var n,r=-1,a=Object(u.a)(e);try{for(a.s();!(n=a.n()).done;){if(!t(n.value,++r,e))return!1}}catch(i){a.e(i)}finally{a.f()}return!0}function De(e,t){if("function"!==typeof t)throw new TypeError("test is not a function");var n,r=-1,a=Object(u.a)(e);try{for(a.s();!(n=a.n()).done;){if(t(n.value,++r,e))return!0}}catch(i){a.e(i)}finally{a.f()}return!1}function Pe(e,t){if("function"!==typeof t)throw new TypeError("test is not a function");var n,r=[],a=-1,i=Object(u.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;t(o,++a,e)&&r.push(o)}}catch(s){i.e(s)}finally{i.f()}return r}function Ue(e,t){if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!==typeof t)throw new TypeError("mapper is not a function");return Array.from(e,(function(n,r){return t(n,r,e)}))}function Je(e,t,n){if("function"!==typeof t)throw new TypeError("reducer is not a function");var r,a,i=e[Symbol.iterator](),o=-1;if(arguments.length<3){var s=i.next();if(r=s.done,n=s.value,r)return;++o}for(;r=(u=i.next()).done,a=u.value,!r;){var u;n=t(n,a,++o,e)}return n}function Qe(e){if("function"!==typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()}function qe(e){e=new Set(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o,s=i[a],c=Object(u.a)(s);try{for(c.s();!(o=c.n()).done;){var l=o.value;e.delete(l)}}catch(g){c.e(g)}finally{c.f()}}return e}function $e(e,t){var n,r=t[Symbol.iterator](),a=new Set,i=Object(u.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(a.has(o))return!1;for(var s=void 0,c=void 0;s=(l=r.next()).value,c=l.done,l;){var l;if(c)break;if(Object.is(o,s))return!1;a.add(s)}}}catch(g){i.e(g)}finally{i.f()}return!0}function et(e){return e instanceof Set?e:new Set(e)}function tt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=new Set(e),n=n.map(et);var a,i=Object(u.a)(e);try{e:for(i.s();!(a=i.n()).done;){var o,s=a.value,c=Object(u.a)(n);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(!l.has(s)){e.delete(s);continue e}}}catch(g){c.e(g)}finally{c.f()}}}catch(g){i.e(g)}finally{i.f()}return e}function nt(e,t){var n,r=e[Symbol.iterator](),a=new Set,i=Object(u.a)(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(!a.has(o))for(var s=void 0,c=void 0;s=(l=r.next()).value,c=l.done,l;){var l;if(c)return!1;if(a.add(s),Object.is(o,s))break}}}catch(g){i.e(g)}finally{i.f()}return!0}function rt(e,t){return nt(t,e)}function at(){for(var e=new Set,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o,s=i[a],c=Object(u.a)(s);try{for(c.s();!(o=c.n()).done;){var l=o.value;e.add(l)}}catch(g){c.e(g)}finally{c.f()}}return e}var it=Array.prototype.slice,ot=function(e){return e},st=1e-6;function ut(e){return"translate("+e+",0)"}function ct(e){return"translate(0,"+e+")"}function lt(e){return function(t){return+e(t)}}function gt(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}function dt(){return!this.__axis}function ht(e,t){var n=[],r=null,a=null,i=6,o=6,s=3,u="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,c=1===e||4===e?-1:1,l=4===e||2===e?"x":"y",g=1===e||3===e?ut:ct;function d(d){var h=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,f=null==a?t.tickFormat?t.tickFormat.apply(t,n):ot:a,p=Math.max(i,0)+s,I=t.range(),C=+I[0]+u,m=+I[I.length-1]+u,b=(t.bandwidth?gt:lt)(t.copy(),u),v=d.selection?d.selection():d,A=v.selectAll(".domain").data([null]),y=v.selectAll(".tick").data(h,t).order(),w=y.exit(),G=y.enter().append("g").attr("class","tick"),B=y.select("line"),x=y.select("text");A=A.merge(A.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),y=y.merge(G),B=B.merge(G.append("line").attr("stroke","currentColor").attr(l+"2",c*i)),x=x.merge(G.append("text").attr("fill","currentColor").attr(l,c*p).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),d!==v&&(A=A.transition(d),y=y.transition(d),B=B.transition(d),x=x.transition(d),w=w.transition(d).attr("opacity",st).attr("transform",(function(e){return isFinite(e=b(e))?g(e+u):this.getAttribute("transform")})),G.attr("opacity",st).attr("transform",(function(e){var t=this.parentNode.__axis;return g((t&&isFinite(t=t(e))?t:b(e))+u)}))),w.remove(),A.attr("d",4===e||2===e?o?"M"+c*o+","+C+"H"+u+"V"+m+"H"+c*o:"M"+u+","+C+"V"+m:o?"M"+C+","+c*o+"V"+u+"H"+m+"V"+c*o:"M"+C+","+u+"H"+m),y.attr("opacity",1).attr("transform",(function(e){return g(b(e)+u)})),B.attr(l+"2",c*i),x.attr(l,c*p).text(f),v.filter(dt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),v.each((function(){this.__axis=b}))}return d.scale=function(e){return arguments.length?(t=e,d):t},d.ticks=function(){return n=it.call(arguments),d},d.tickArguments=function(e){return arguments.length?(n=null==e?[]:it.call(e),d):n.slice()},d.tickValues=function(e){return arguments.length?(r=null==e?null:it.call(e),d):r&&r.slice()},d.tickFormat=function(e){return arguments.length?(a=e,d):a},d.tickSize=function(e){return arguments.length?(i=o=+e,d):i},d.tickSizeInner=function(e){return arguments.length?(i=+e,d):i},d.tickSizeOuter=function(e){return arguments.length?(o=+e,d):o},d.tickPadding=function(e){return arguments.length?(s=+e,d):s},d.offset=function(e){return arguments.length?(u=+e,d):u},d}function ft(e){return ht(1,e)}function pt(e){return ht(2,e)}function It(e){return ht(3,e)}function Ct(e){return ht(4,e)}var mt={value:function(){}};function bt(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new vt(r)}function vt(e){this._=e}function At(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function yt(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function wt(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=mt,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}vt.prototype=bt.prototype={constructor:vt,on:function(e,t){var n,r=this._,a=At(e+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=a[i]).type)r[n]=wt(r[n],e.name,t);else if(null==t)for(n in r)r[n]=wt(r[n],e.name,null);return this}for(;++i<o;)if((n=(e=a[i]).type)&&(n=yt(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new vt(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var Gt=bt,Bt=n(41);function xt(){}var St=function(e){return null==e?xt:function(){return this.querySelector(e)}},kt=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)};function Zt(){return[]}var Rt=function(e){return null==e?Zt:function(){return this.querySelectorAll(e)}};var Nt=function(e){return function(){return this.matches(e)}};function Ot(e){return function(t){return t.matches(e)}}var Wt=Array.prototype.find;function Ft(){return this.firstElementChild}var Mt=Array.prototype.filter;function Vt(){return this.children}var Tt=function(e){return new Array(e.length)};function Et(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Et.prototype={constructor:Et,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var jt=function(e){return function(){return e}};function Lt(e,t,n,r,a,i){for(var o,s=0,u=t.length,c=i.length;s<c;++s)(o=t[s])?(o.__data__=i[s],r[s]=o):n[s]=new Et(e,i[s]);for(;s<u;++s)(o=t[s])&&(a[s]=o)}function Xt(e,t,n,r,a,i,o){var s,u,c,l=new Map,g=t.length,d=i.length,h=new Array(g);for(s=0;s<g;++s)(u=t[s])&&(h[s]=c=o.call(u,u.__data__,s,t)+"",l.has(c)?a[s]=u:l.set(c,u));for(s=0;s<d;++s)c=o.call(e,i[s],s,i)+"",(u=l.get(c))?(r[s]=u,u.__data__=i[s],l.delete(c)):n[s]=new Et(e,i[s]);for(s=0;s<g;++s)(u=t[s])&&l.get(h[s])===u&&(a[s]=u)}function Ht(e){return e.__data__}function Yt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var zt="http://www.w3.org/1999/xhtml",Kt={svg:"http://www.w3.org/2000/svg",xhtml:zt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},_t=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Kt.hasOwnProperty(t)?{space:Kt[t],local:e}:e};function Dt(e){return function(){this.removeAttribute(e)}}function Pt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ut(e,t){return function(){this.setAttribute(e,t)}}function Jt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Qt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function qt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var $t=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function en(e){return function(){this.style.removeProperty(e)}}function tn(e,t,n){return function(){this.style.setProperty(e,t,n)}}function nn(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function rn(e,t){return e.style.getPropertyValue(t)||$t(e).getComputedStyle(e,null).getPropertyValue(t)}function an(e){return function(){delete this[e]}}function on(e,t){return function(){this[e]=t}}function sn(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function un(e){return e.trim().split(/^|\s+/)}function cn(e){return e.classList||new ln(e)}function ln(e){this._node=e,this._names=un(e.getAttribute("class")||"")}function gn(e,t){for(var n=cn(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function dn(e,t){for(var n=cn(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function hn(e){return function(){gn(this,e)}}function fn(e){return function(){dn(this,e)}}function pn(e,t){return function(){(t.apply(this,arguments)?gn:dn)(this,e)}}ln.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function In(){this.textContent=""}function Cn(e){return function(){this.textContent=e}}function mn(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function bn(){this.innerHTML=""}function vn(e){return function(){this.innerHTML=e}}function An(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function yn(){this.nextSibling&&this.parentNode.appendChild(this)}function wn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Gn(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===zt&&t.documentElement.namespaceURI===zt?t.createElement(e):t.createElementNS(n,e)}}function Bn(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}var xn=function(e){var t=_t(e);return(t.local?Bn:Gn)(t)};function Sn(){return null}function kn(){var e=this.parentNode;e&&e.removeChild(this)}function Zn(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Rn(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Nn(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function On(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?t.length=a:delete this.__on}}}function Wn(e,t,n){return function(){var r,a=this.__on,i=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(a)for(var o=0,s=a.length;o<s;++o)if((r=a[o]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=t);this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},a?a.push(r):this.__on=[r]}}function Fn(e,t,n){var r=$t(e),a=r.CustomEvent;"function"===typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function Mn(e,t){return function(){return Fn(this,e,t)}}function Vn(e,t){return function(){return Fn(this,e,t.apply(this,arguments))}}var Tn=s.a.mark(En);function En(){var e,t,n,r,a,i,o;return s.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=this._groups,t=0,n=e.length;case 1:if(!(t<n)){s.next=13;break}r=e[t],a=0,i=r.length;case 3:if(!(a<i)){s.next=10;break}if(!(o=r[a])){s.next=7;break}return s.next=7,o;case 7:++a,s.next=3;break;case 10:++t,s.next=1;break;case 13:case"end":return s.stop()}}),Tn,this)}var jn=[null];function Ln(e,t){this._groups=e,this._parents=t}function Xn(){return new Ln([[document.documentElement]],jn)}Ln.prototype=Xn.prototype=Object(Bt.a)({constructor:Ln,select:function(e){"function"!==typeof e&&(e=St(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,s=t[a],u=s.length,c=r[a]=new Array(u),l=0;l<u;++l)(i=s[l])&&(o=e.call(i,i.__data__,l,s))&&("__data__"in i&&(o.__data__=i.__data__),c[l]=o);return new Ln(r,this._parents)},selectAll:function(e){e="function"===typeof e?function(e){return function(){var t=e.apply(this,arguments);return null==t?[]:kt(t)}}(e):Rt(e);for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o,s=t[i],u=s.length,c=0;c<u;++c)(o=s[c])&&(r.push(e.call(o,o.__data__,c,s)),a.push(o));return new Ln(r,a)},selectChild:function(e){return this.select(null==e?Ft:function(e){return function(){return Wt.call(this.children,e)}}("function"===typeof e?e:Ot(e)))},selectChildren:function(e){return this.selectAll(null==e?Vt:function(e){return function(){return Mt.call(this.children,e)}}("function"===typeof e?e:Ot(e)))},filter:function(e){"function"!==typeof e&&(e=Nt(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],s=o.length,u=r[a]=[],c=0;c<s;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&u.push(i);return new Ln(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Ht);var n=t?Xt:Lt,r=this._parents,a=this._groups;"function"!==typeof e&&(e=jt(e));for(var i=a.length,o=new Array(i),s=new Array(i),u=new Array(i),c=0;c<i;++c){var l=r[c],g=a[c],d=g.length,h=kt(e.call(l,l&&l.__data__,c,r)),f=h.length,p=s[c]=new Array(f),I=o[c]=new Array(f),C=u[c]=new Array(d);n(l,g,p,I,C,h,t);for(var m,b,v=0,A=0;v<f;++v)if(m=p[v]){for(v>=A&&(A=v+1);!(b=I[A])&&++A<f;);m._next=b||null}}return(o=new Ln(o,r))._enter=s,o._exit=u,o},enter:function(){return new Ln(this._enter||this._groups.map(Tt),this._parents)},exit:function(){return new Ln(this._exit||this._groups.map(Tt),this._parents)},join:function(e,t,n){var r=this.enter(),a=this,i=this.exit();return r="function"===typeof e?e(r):r.append(e+""),null!=t&&(a=t(a)),null==n?i.remove():n(i),r&&a?r.merge(a).order():a},merge:function(e){if(!(e instanceof Ln))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),s=0;s<i;++s)for(var u,c=t[s],l=n[s],g=c.length,d=o[s]=new Array(g),h=0;h<g;++h)(u=c[h]||l[h])&&(d[h]=u);for(;s<r;++s)o[s]=t[s];return new Ln(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Yt);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,s=n[i],u=s.length,c=a[i]=new Array(u),l=0;l<u;++l)(o=s[l])&&(c[l]=o);c.sort(t)}return new Ln(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e,t=0,n=Object(u.a)(this);try{for(n.s();!(e=n.n()).done;){e.value;++t}}catch(r){n.e(r)}finally{n.f()}return t},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,s=i.length;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=_t(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?Pt:Dt:"function"===typeof t?n.local?qt:Qt:n.local?Jt:Ut)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?en:"function"===typeof t?nn:tn)(e,t,null==n?"":n)):rn(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?an:"function"===typeof t?sn:on)(e,t)):this.node()[e]},classed:function(e,t){var n=un(e+"");if(arguments.length<2){for(var r=cn(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"===typeof t?pn:t?hn:fn)(n,t))},text:function(e){return arguments.length?this.each(null==e?In:("function"===typeof e?mn:Cn)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?bn:("function"===typeof e?An:vn)(e)):this.node().innerHTML},raise:function(){return this.each(yn)},lower:function(){return this.each(wn)},append:function(e){var t="function"===typeof e?e:xn(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:xn(e),r=null==t?Sn:"function"===typeof t?t:St(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(kn)},clone:function(e){return this.select(e?Rn:Zn)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=Nn(e+""),o=i.length;if(!(arguments.length<2)){for(s=t?Wn:On,r=0;r<o;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var u,c=0,l=s.length;c<l;++c)for(r=0,u=s[c];r<o;++r)if((a=i[r]).type===u.type&&a.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"===typeof t?Vn:Mn)(e,t))}},Symbol.iterator,En);var Hn=Xn,Yn=function(e){return"string"===typeof e?new Ln([[document.querySelector(e)]],[document.documentElement]):new Ln([[e]],jn)};function zn(e){e.stopImmediatePropagation()}var Kn=function(e){e.preventDefault(),e.stopImmediatePropagation()},_n=function(e){var t=e.document.documentElement,n=Yn(e).on("dragstart.drag",Kn,!0);"onselectstart"in t?n.on("selectstart.drag",Kn,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};function Dn(e,t){var n=e.document.documentElement,r=Yn(e).on("dragstart.drag",null);t&&(r.on("click.drag",Kn,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Pn=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function Un(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Jn(){}var Qn=.7,qn=1/Qn,$n="\\s*([+-]?\\d+)\\s*",er="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",tr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",nr=/^#([0-9a-f]{3,8})$/,rr=new RegExp("^rgb\\("+[$n,$n,$n]+"\\)$"),ar=new RegExp("^rgb\\("+[tr,tr,tr]+"\\)$"),ir=new RegExp("^rgba\\("+[$n,$n,$n,er]+"\\)$"),or=new RegExp("^rgba\\("+[tr,tr,tr,er]+"\\)$"),sr=new RegExp("^hsl\\("+[er,tr,tr]+"\\)$"),ur=new RegExp("^hsla\\("+[er,tr,tr,er]+"\\)$"),cr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function lr(){return this.rgb().formatHex()}function gr(){return this.rgb().formatRgb()}function dr(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=nr.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?hr(t):3===n?new Cr(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?fr(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?fr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=rr.exec(e))?new Cr(t[1],t[2],t[3],1):(t=ar.exec(e))?new Cr(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ir.exec(e))?fr(t[1],t[2],t[3],t[4]):(t=or.exec(e))?fr(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=sr.exec(e))?Ar(t[1],t[2]/100,t[3]/100,1):(t=ur.exec(e))?Ar(t[1],t[2]/100,t[3]/100,t[4]):cr.hasOwnProperty(e)?hr(cr[e]):"transparent"===e?new Cr(NaN,NaN,NaN,0):null}function hr(e){return new Cr(e>>16&255,e>>8&255,255&e,1)}function fr(e,t,n,r){return r<=0&&(e=t=n=NaN),new Cr(e,t,n,r)}function pr(e){return e instanceof Jn||(e=dr(e)),e?new Cr((e=e.rgb()).r,e.g,e.b,e.opacity):new Cr}function Ir(e,t,n,r){return 1===arguments.length?pr(e):new Cr(e,t,n,null==r?1:r)}function Cr(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function mr(){return"#"+vr(this.r)+vr(this.g)+vr(this.b)}function br(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function vr(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Ar(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Gr(e,t,n,r)}function yr(e){if(e instanceof Gr)return new Gr(e.h,e.s,e.l,e.opacity);if(e instanceof Jn||(e=dr(e)),!e)return new Gr;if(e instanceof Gr)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,s=i-a,u=(i+a)/2;return s?(o=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=u<.5?i+a:2-i-a,o*=60):s=u>0&&u<1?0:o,new Gr(o,s,u,e.opacity)}function wr(e,t,n,r){return 1===arguments.length?yr(e):new Gr(e,t,n,null==r?1:r)}function Gr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Br(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function xr(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}Pn(Jn,dr,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:lr,formatHex:lr,formatHsl:function(){return yr(this).formatHsl()},formatRgb:gr,toString:gr}),Pn(Cr,Ir,Un(Jn,{brighter:function(e){return e=null==e?qn:Math.pow(qn,e),new Cr(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?Qn:Math.pow(Qn,e),new Cr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:mr,formatHex:mr,formatRgb:br,toString:br})),Pn(Gr,wr,Un(Jn,{brighter:function(e){return e=null==e?qn:Math.pow(qn,e),new Gr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Qn:Math.pow(Qn,e),new Gr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Cr(Br(e>=240?e-240:e+120,a,r),Br(e,a,r),Br(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var Sr=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,s=r<t-1?e[r+2]:2*i-a;return xr((n-r/t)*t,o,a,i,s)}},kr=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return xr((n-r/t)*t,a,i,o,s)}},Zr=function(e){return function(){return e}};function Rr(e,t){return function(n){return e+n*t}}function Nr(e,t){var n=t-e;return n?Rr(e,n>180||n<-180?n-360*Math.round(n/360):n):Zr(isNaN(e)?t:e)}function Or(e){return 1===(e=+e)?Wr:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Zr(isNaN(t)?n:t)}}function Wr(e,t){var n=t-e;return n?Rr(e,n):Zr(isNaN(e)?t:e)}var Fr=function e(t){var n=Or(t);function r(e,t){var r=n((e=Ir(e)).r,(t=Ir(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=Wr(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Mr(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),s=new Array(a);for(n=0;n<a;++n)r=Ir(t[n]),i[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return i=e(i),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=s(e),r+""}}}var Vr=Mr(Sr),Tr=Mr(kr),Er=function(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}};function jr(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var Lr=function(e,t){return(jr(t)?Er:Xr)(e,t)};function Xr(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=Jr(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}var Hr=function(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}},Yr=function(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}},zr=function(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Jr(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}},Kr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_r=new RegExp(Kr.source,"g");var Dr,Pr,Ur=function(e,t){var n,r,a,i=Kr.lastIndex=_r.lastIndex=0,o=-1,s=[],u=[];for(e+="",t+="";(n=Kr.exec(e))&&(r=_r.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:Yr(n,r)})),i=_r.lastIndex;return i<t.length&&(a=t.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(e){return function(){return e}}(t):(t=u.length,function(e){for(var n,r=0;r<t;++r)s[(n=u[r]).i]=n.x(e);return s.join("")})},Jr=function(e,t){var n,r=typeof t;return null==t||"boolean"===r?Zr(t):("number"===r?Yr:"string"===r?(n=dr(t))?(t=n,Fr):Ur:t instanceof dr?Fr:t instanceof Date?Hr:jr(t)?Er:Array.isArray(t)?Xr:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?zr:Yr)(e,t)},Qr=function(e){for(var t;t=e.sourceEvent;)e=t;return e},qr=function(e,t){if(e=Qr(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}}return[e.pageX,e.pageY]},$r=0,ea=0,ta=0,na=0,ra=0,aa=0,ia="object"===typeof performance&&performance.now?performance:Date,oa="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function sa(){return ra||(oa(ua),ra=ia.now()+aa)}function ua(){ra=0}function ca(){this._call=this._time=this._next=null}function la(e,t,n){var r=new ca;return r.restart(e,t,n),r}function ga(){sa(),++$r;for(var e,t=Dr;t;)(e=ra-t._time)>=0&&t._call.call(null,e),t=t._next;--$r}function da(){ra=(na=ia.now())+aa,$r=ea=0;try{ga()}finally{$r=0,function(){var e,t,n=Dr,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Dr=t);Pr=e,fa(r)}(),ra=0}}function ha(){var e=ia.now(),t=e-na;t>1e3&&(aa-=t,na=e)}function fa(e){$r||(ea&&(ea=clearTimeout(ea)),e-ra>24?(e<1/0&&(ea=setTimeout(da,e-ia.now()-aa)),ta&&(ta=clearInterval(ta))):(ta||(na=ia.now(),ta=setInterval(ha,1e3)),$r=1,oa(da)))}ca.prototype=la.prototype={constructor:ca,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?sa():+n)+(null==t?0:+t),this._next||Pr===this||(Pr?Pr._next=this:Dr=this,Pr=this),this._call=e,this._time=n,fa()},stop:function(){this._call&&(this._call=null,this._time=1/0,fa())}};var pa=function(e,t,n){var r=new ca;return t=null==t?0:+t,r.restart((function(n){r.stop(),e(n+t)}),t,n),r},Ia=Gt("start","end","cancel","interrupt"),Ca=[],ma=function(e,t,n,r,a,i){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var r,a=e.__transition;function i(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(i){var c,l,g,d;if(1!==n.state)return u();for(c in a)if((d=a[c]).name===n.name){if(3===d.state)return pa(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete a[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete a[c])}if(pa((function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(i))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(g=n.tween.length),c=0,l=-1;c<g;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++l]=d);r.length=l+1}}function s(t){for(var a=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(u),n.state=5,1),i=-1,o=r.length;++i<o;)r[i].call(e,a);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),u())}function u(){for(var r in n.state=6,n.timer.stop(),delete a[t],a)return;delete e.__transition}a[t]=n,n.timer=la(i,0,n.time)}(e,n,{name:t,index:r,group:a,on:Ia,tween:Ca,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})};function ba(e,t){var n=Aa(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function va(e,t){var n=Aa(e,t);if(n.state>3)throw new Error("too late; already running");return n}function Aa(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var ya,wa=function(e,t){var n,r,a,i=e.__transition,o=!0;if(i){for(a in t=null==t?null:t+"",i)(n=i[a]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[a]):o=!1;o&&delete e.__transition}},Ga=180/Math.PI,Ba={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},xa=function(e,t,n,r,a,i){var o,s,u;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),e*r<t*n&&(e=-e,t=-t,u=-u,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*Ga,skewX:Math.atan(u)*Ga,scaleX:o,scaleY:s}};function Sa(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var s=[],u=[];return i=e(i),o=e(o),function(e,r,a,i,o,s){if(e!==a||r!==i){var u=o.push("translate(",null,t,null,n);s.push({i:u-4,x:Yr(e,a)},{i:u-2,x:Yr(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,s,u),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:Yr(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,s,u),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:Yr(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,s,u),function(e,t,n,r,i,o){if(e!==n||t!==r){var s=i.push(a(i)+"scale(",null,",",null,")");o.push({i:s-4,x:Yr(e,n)},{i:s-2,x:Yr(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,s,u),i=o=null,function(e){for(var t,n=-1,r=u.length;++n<r;)s[(t=u[n]).i]=t.x(e);return s.join("")}}}var ka=Sa((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ba:xa(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Za=Sa((function(e){return null==e?Ba:(ya||(ya=document.createElementNS("http://www.w3.org/2000/svg","g")),ya.setAttribute("transform",e),(e=ya.transform.baseVal.consolidate())?(e=e.matrix,xa(e.a,e.b,e.c,e.d,e.e,e.f)):Ba)}),", ",")",")");function Ra(e,t){var n,r;return function(){var a=va(this,e),i=a.tween;if(i!==n)for(var o=0,s=(r=n=i).length;o<s;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}a.tween=r}}function Na(e,t,n){var r,a;if("function"!==typeof n)throw new Error;return function(){var i=va(this,e),o=i.tween;if(o!==r){a=(r=o).slice();for(var s={name:t,value:n},u=0,c=a.length;u<c;++u)if(a[u].name===t){a[u]=s;break}u===c&&a.push(s)}i.tween=a}}function Oa(e,t,n){var r=e._id;return e.each((function(){var e=va(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return Aa(e,r).value[t]}}var Wa=function(e,t){var n;return("number"===typeof t?Yr:t instanceof dr?Fr:(n=dr(t))?(t=n,Fr):Ur)(e,t)};function Fa(e){return function(){this.removeAttribute(e)}}function Ma(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Va(e,t,n){var r,a,i=n+"";return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function Ta(e,t,n){var r,a,i=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function Ea(e,t,n){var r,a,i;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttribute(e))===(s=u+"")?null:o===r&&s===a?i:(a=s,i=t(r=o,u));this.removeAttribute(e)}}function ja(e,t,n){var r,a,i;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttributeNS(e.space,e.local))===(s=u+"")?null:o===r&&s===a?i:(a=s,i=t(r=o,u));this.removeAttributeNS(e.space,e.local)}}function La(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Xa(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Ha(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&Xa(e,a)),n}return a._value=t,a}function Ya(e,t){var n,r;function a(){var a=t.apply(this,arguments);return a!==r&&(n=(r=a)&&La(e,a)),n}return a._value=t,a}function za(e,t){return function(){ba(this,e).delay=+t.apply(this,arguments)}}function Ka(e,t){return t=+t,function(){ba(this,e).delay=t}}function _a(e,t){return function(){va(this,e).duration=+t.apply(this,arguments)}}function Da(e,t){return t=+t,function(){va(this,e).duration=t}}function Pa(e,t){if("function"!==typeof t)throw new Error;return function(){va(this,e).ease=t}}function Ua(e,t,n){var r,a,i=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?ba:va;return function(){var o=i(this,e),s=o.on;s!==r&&(a=(r=s).copy()).on(t,n),o.on=a}}var Ja=Hn.prototype.constructor;function Qa(e){return function(){this.style.removeProperty(e)}}function qa(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function $a(e,t,n){var r,a;function i(){var i=t.apply(this,arguments);return i!==a&&(r=(a=i)&&qa(e,i,n)),r}return i._value=t,i}function ei(e){return function(t){this.textContent=e.call(this,t)}}function ti(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&ei(r)),t}return r._value=e,r}var ni=0;function ri(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ai(e){return Hn().transition(e)}function ii(){return++ni}var oi=Hn.prototype;ri.prototype=ai.prototype=Object(Bt.a)({constructor:ri,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=St(e));for(var r=this._groups,a=r.length,i=new Array(a),o=0;o<a;++o)for(var s,u,c=r[o],l=c.length,g=i[o]=new Array(l),d=0;d<l;++d)(s=c[d])&&(u=e.call(s,s.__data__,d,c))&&("__data__"in s&&(u.__data__=s.__data__),g[d]=u,ma(g[d],t,n,d,g,Aa(s,n)));return new ri(i,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=Rt(e));for(var r=this._groups,a=r.length,i=[],o=[],s=0;s<a;++s)for(var u,c=r[s],l=c.length,g=0;g<l;++g)if(u=c[g]){for(var d,h=e.call(u,u.__data__,g,c),f=Aa(u,n),p=0,I=h.length;p<I;++p)(d=h[p])&&ma(d,t,n,p,h,f);i.push(h),o.push(u)}return new ri(i,o,t,n)},filter:function(e){"function"!==typeof e&&(e=Nt(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],s=o.length,u=r[a]=[],c=0;c<s;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&u.push(i);return new ri(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),s=0;s<i;++s)for(var u,c=t[s],l=n[s],g=c.length,d=o[s]=new Array(g),h=0;h<g;++h)(u=c[h]||l[h])&&(d[h]=u);for(;s<r;++s)o[s]=t[s];return new ri(o,this._parents,this._name,this._id)},selection:function(){return new Ja(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=ii(),r=this._groups,a=r.length,i=0;i<a;++i)for(var o,s=r[i],u=s.length,c=0;c<u;++c)if(o=s[c]){var l=Aa(o,t);ma(o,e,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new ri(r,this._parents,e,n)},call:oi.call,nodes:oi.nodes,node:oi.node,size:oi.size,empty:oi.empty,each:oi.each,on:function(e,t){var n=this._id;return arguments.length<2?Aa(this.node(),n).on.on(e):this.each(Ua(n,e,t))},attr:function(e,t){var n=_t(e),r="transform"===n?Za:Wa;return this.attrTween(e,"function"===typeof t?(n.local?ja:Ea)(n,r,Oa(this,"attr."+e,t)):null==t?(n.local?Ma:Fa)(n):(n.local?Ta:Va)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=_t(e);return this.tween(n,(r.local?Ha:Ya)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?ka:Wa;return null==t?this.styleTween(e,function(e,t){var n,r,a;return function(){var i=rn(this,e),o=(this.style.removeProperty(e),rn(this,e));return i===o?null:i===n&&o===r?a:a=t(n=i,r=o)}}(e,r)).on("end.style."+e,Qa(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,a,i;return function(){var o=rn(this,e),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(e),u=s=rn(this,e)),o===u?null:o===r&&u===a?i:(a=u,i=t(r=o,s))}}(e,r,Oa(this,"style."+e,t))).each(function(e,t){var n,r,a,i,o="style."+t,s="end."+o;return function(){var u=va(this,e),c=u.on,l=null==u.value[o]?i||(i=Qa(t)):void 0;c===n&&a===l||(r=(n=c).copy()).on(s,a=l),u.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,a,i=n+"";return function(){var o=rn(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,$a(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Oa(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,ti(e))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,a=Aa(this.node(),n).tween,i=0,o=a.length;i<o;++i)if((r=a[i]).name===e)return r.value;return null}return this.each((null==t?Ra:Na)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?za:Ka)(t,e)):Aa(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?_a:Da)(t,e)):Aa(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(Pa(t,e)):Aa(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;va(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,a=n.size();return new Promise((function(i,o){var s={value:o},u={value:function(){0===--a&&i()}};n.each((function(){var n=va(this,r),a=n.on;a!==e&&((t=(e=a).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(u)),n.on=t})),0===a&&i()}))}},Symbol.iterator,oi[Symbol.iterator]);var si={time:null,delay:0,duration:250,ease:n(199).b};function ui(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}Hn.prototype.interrupt=function(e){return this.each((function(){wa(this,e)}))},Hn.prototype.transition=function(e){var t,n;e instanceof ri?(t=e._id,e=e._name):(t=ii(),(n=si).time=sa(),e=null==e?null:e+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var o,s=r[i],u=s.length,c=0;c<u;++c)(o=s[c])&&ma(o,e,t,c,s,n||ui(o,t));return new ri(r,this._parents,e,t)};var ci=[null],li=function(e,t){var n,r,a=e.__transition;if(a)for(r in t=null==t?null:t+"",a)if((n=a[r]).state>1&&n.name===t)return new ri([[e]],ci,t,+r);return null},gi=function(e){return function(){return e}};function di(e,t){var n=t.sourceEvent,r=t.target,a=t.selection,i=t.mode,o=t.dispatch;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:a,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function hi(e){e.stopImmediatePropagation()}var fi=function(e){e.preventDefault(),e.stopImmediatePropagation()},pi={name:"drag"},Ii={name:"space"},Ci={name:"handle"},mi={name:"center"},bi=Math.abs,vi=Math.max,Ai=Math.min;function yi(e){return[+e[0],+e[1]]}function wi(e){return[yi(e[0]),yi(e[1])]}var Gi={name:"x",handles:["w","e"].map(Oi),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Bi={name:"y",handles:["n","s"].map(Oi),input:function(e,t){return null==e?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},xi={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Oi),input:function(e){return null==e?null:wi(e)},output:function(e){return e}},Si={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ki={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Zi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Ri={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Ni={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Oi(e){return{type:e}}function Wi(e){return!e.ctrlKey&&!e.button}function Fi(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function Mi(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vi(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function Ti(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function Ei(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function ji(){return Hi(Gi)}function Li(){return Hi(Bi)}var Xi=function(){return Hi(xi)};function Hi(e){var t,n=Fi,r=Wi,a=Mi,i=!0,o=Gt("start","brush","end"),s=6;function c(t){var n=t.property("__brush",I).selectAll(".overlay").data([Oi("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Si.overlay).merge(n).each((function(){var e=Vi(this).extent;Yn(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])})),t.selectAll(".selection").data([Oi("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Si.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,(function(e){return e.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(e){return"handle handle--"+e.type})).attr("cursor",(function(e){return Si[e.type]})),t.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(a).on("touchstart.brush",h).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function l(){var e=Yn(this),t=Vi(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",(function(e){return"e"===e.type[e.type.length-1]?t[1][0]-s/2:t[0][0]-s/2})).attr("y",(function(e){return"s"===e.type[0]?t[1][1]-s/2:t[0][1]-s/2})).attr("width",(function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+s:s})).attr("height",(function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+s:s}))):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function g(e,t,n){var r=e.__brush.emitter;return!r||n&&r.clean?new d(e,t,n):r}function d(e,t,n){this.that=e,this.args=t,this.state=e.__brush,this.active=0,this.clean=n}function h(n){if((!t||n.touches)&&r.apply(this,arguments)){var a,o,s,c,d,h,f,p,I,C,m,b=this,v=n.target.__data__.type,A="selection"===(i&&n.metaKey?v="overlay":v)?pi:i&&n.altKey?mi:Ci,y=e===Bi?null:Ri[v],w=e===Gi?null:Ni[v],G=Vi(b),B=G.extent,x=G.selection,S=B[0][0],k=B[0][1],Z=B[1][0],R=B[1][1],N=0,O=0,W=y&&w&&i&&n.shiftKey,F=Array.from(n.touches||[n],(function(e){var t=e.identifier;return(e=qr(e,b)).point0=e.slice(),e.identifier=t,e}));if("overlay"===v){x&&(I=!0);var M=[F[0],F[1]||F[0]];G.selection=x=[[a=e===Bi?S:Ai(M[0][0],M[1][0]),s=e===Gi?k:Ai(M[0][1],M[1][1])],[d=e===Bi?Z:vi(M[0][0],M[1][0]),f=e===Gi?R:vi(M[0][1],M[1][1])]],F.length>1&&X()}else a=x[0][0],s=x[0][1],d=x[1][0],f=x[1][1];o=a,c=s,h=d,p=f;var V=Yn(b).attr("pointer-events","none"),T=V.selectAll(".overlay").attr("cursor",Si[v]);wa(b);var E=g(b,arguments,!0).beforestart();if(n.touches)E.moved=L,E.ended=H;else{var j=Yn(n.view).on("mousemove.brush",L,!0).on("mouseup.brush",H,!0);i&&j.on("keydown.brush",Y,!0).on("keyup.brush",z,!0),_n(n.view)}l.call(b),E.start(n,A.name)}function L(e){var t,n=Object(u.a)(e.changedTouches||[e]);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=Object(u.a)(F);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.identifier===a.identifier&&(o.cur=qr(a,b))}}catch(d){i.e(d)}finally{i.f()}}}catch(d){n.e(d)}finally{n.f()}if(W&&!C&&!m&&1===F.length){var s=F[0];bi(s.cur[0]-s[0])>bi(s.cur[1]-s[1])?m=!0:C=!0}var c,l=Object(u.a)(F);try{for(l.s();!(c=l.n()).done;){var g=c.value;g.cur&&(g[0]=g.cur[0],g[1]=g.cur[1])}}catch(d){l.e(d)}finally{l.f()}I=!0,fi(e),X(e)}function X(e){var t,n=F[0],r=n.point0;switch(N=n[0]-r[0],O=n[1]-r[1],A){case Ii:case pi:y&&(N=vi(S-a,Ai(Z-d,N)),o=a+N,h=d+N),w&&(O=vi(k-s,Ai(R-f,O)),c=s+O,p=f+O);break;case Ci:F[1]?(y&&(o=vi(S,Ai(Z,F[0][0])),h=vi(S,Ai(Z,F[1][0])),y=1),w&&(c=vi(k,Ai(R,F[0][1])),p=vi(k,Ai(R,F[1][1])),w=1)):(y<0?(N=vi(S-a,Ai(Z-a,N)),o=a+N,h=d):y>0&&(N=vi(S-d,Ai(Z-d,N)),o=a,h=d+N),w<0?(O=vi(k-s,Ai(R-s,O)),c=s+O,p=f):w>0&&(O=vi(k-f,Ai(R-f,O)),c=s,p=f+O));break;case mi:y&&(o=vi(S,Ai(Z,a-N*y)),h=vi(S,Ai(Z,d+N*y))),w&&(c=vi(k,Ai(R,s-O*w)),p=vi(k,Ai(R,f+O*w)))}h<o&&(y*=-1,t=a,a=d,d=t,t=o,o=h,h=t,v in ki&&T.attr("cursor",Si[v=ki[v]])),p<c&&(w*=-1,t=s,s=f,f=t,t=c,c=p,p=t,v in Zi&&T.attr("cursor",Si[v=Zi[v]])),G.selection&&(x=G.selection),C&&(o=x[0][0],h=x[1][0]),m&&(c=x[0][1],p=x[1][1]),x[0][0]===o&&x[0][1]===c&&x[1][0]===h&&x[1][1]===p||(G.selection=[[o,c],[h,p]],l.call(b),E.brush(e,A.name))}function H(e){if(hi(e),e.touches){if(e.touches.length)return;t&&clearTimeout(t),t=setTimeout((function(){t=null}),500)}else Dn(e.view,I),j.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);V.attr("pointer-events","all"),T.attr("cursor",Si.overlay),G.selection&&(x=G.selection),Ti(x)&&(G.selection=null,l.call(b)),E.end(e,A.name)}function Y(e){switch(e.keyCode){case 16:W=y&&w;break;case 18:A===Ci&&(y&&(d=h-N*y,a=o+N*y),w&&(f=p-O*w,s=c+O*w),A=mi,X());break;case 32:A!==Ci&&A!==mi||(y<0?d=h-N:y>0&&(a=o-N),w<0?f=p-O:w>0&&(s=c-O),A=Ii,T.attr("cursor",Si.selection),X());break;default:return}fi(e)}function z(e){switch(e.keyCode){case 16:W&&(C=m=W=!1,X());break;case 18:A===mi&&(y<0?d=h:y>0&&(a=o),w<0?f=p:w>0&&(s=c),A=Ci,X());break;case 32:A===Ii&&(e.altKey?(y&&(d=h-N*y,a=o+N*y),w&&(f=p-O*w,s=c+O*w),A=mi):(y<0?d=h:y>0&&(a=o),w<0?f=p:w>0&&(s=c),A=Ci),T.attr("cursor",Si[v]),X());break;default:return}fi(e)}}function f(e){g(this,arguments).moved(e)}function p(e){g(this,arguments).ended(e)}function I(){var t=this.__brush||{selection:null};return t.extent=wi(n.apply(this,arguments)),t.dim=e,t}return c.move=function(t,n){t.tween?t.on("start.brush",(function(e){g(this,arguments).beforestart().start(e)})).on("interrupt.brush end.brush",(function(e){g(this,arguments).end(e)})).tween("brush",(function(){var t=this,r=t.__brush,a=g(t,arguments),i=r.selection,o=e.input("function"===typeof n?n.apply(this,arguments):n,r.extent),s=Jr(i,o);function u(e){r.selection=1===e&&null===o?null:s(e),l.call(t),a.brush()}return null!==i&&null!==o?u:u(1)})):t.each((function(){var t=this,r=arguments,a=t.__brush,i=e.input("function"===typeof n?n.apply(t,r):n,a.extent),o=g(t,r).beforestart();wa(t),a.selection=null===i?null:i,l.call(t),o.start().brush().end()}))},c.clear=function(e){c.move(e,null)},d.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(e,t){return this.starting?(this.starting=!1,this.emit("start",e,t)):this.emit("brush",e),this},brush:function(e,t){return this.emit("brush",e,t),this},end:function(e,t){return 0===--this.active&&(delete this.state.emitter,this.emit("end",e,t)),this},emit:function(t,n,r){var a=Yn(this.that).datum();o.call(t,this.that,new di(t,{sourceEvent:n,target:c,selection:e.output(this.state.selection),mode:r,dispatch:o}),a)}},c.extent=function(e){return arguments.length?(n="function"===typeof e?e:gi(wi(e)),c):n},c.filter=function(e){return arguments.length?(r="function"===typeof e?e:gi(!!e),c):r},c.touchable=function(e){return arguments.length?(a="function"===typeof e?e:gi(!!e),c):a},c.handleSize=function(e){return arguments.length?(s=+e,c):s},c.keyModifiers=function(e){return arguments.length?(i=!!e,c):i},c.on=function(){var e=o.on.apply(o,arguments);return e===o?c:e},c}var Yi=Math.abs,zi=Math.cos,Ki=Math.sin,_i=Math.PI,Di=_i/2,Pi=2*_i,Ui=Math.max,Ji=1e-12;function Qi(e,t){return Array.from({length:t-e},(function(t,n){return e+n}))}function qi(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}var $i=function(){return no(!1,!1)};function eo(){return no(!1,!0)}function to(){return no(!0,!1)}function no(e,t){var n=0,r=null,a=null,i=null;function o(o){var s,c=o.length,l=new Array(c),g=Qi(0,c),d=new Array(c*c),h=new Array(c),f=0;o=Float64Array.from({length:c*c},t?function(e,t){return o[t%c][t/c|0]}:function(e,t){return o[t/c|0][t%c]});for(var p=0;p<c;++p){for(var I=0,C=0;C<c;++C)I+=o[p*c+C]+e*o[C*c+p];f+=l[p]=I}f=Ui(0,Pi-n*c)/f,s=f?n:Pi/c;var m=0;r&&g.sort((function(e,t){return r(l[e],l[t])}));var b,v=Object(u.a)(g);try{var A=function(){var t=b.value,n=m;if(e){var r=Qi(1+~c,c).filter((function(e){return e<0?o[~e*c+t]:o[t*c+e]}));a&&r.sort((function(e,n){return a(e<0?-o[~e*c+t]:o[t*c+e],n<0?-o[~n*c+t]:o[t*c+n])}));var i,g=Object(u.a)(r);try{for(g.s();!(i=g.n()).done;){var p=i.value;if(p<0)(d[~p*c+t]||(d[~p*c+t]={source:null,target:null})).target={index:t,startAngle:m,endAngle:m+=o[~p*c+t]*f,value:o[~p*c+t]};else(d[t*c+p]||(d[t*c+p]={source:null,target:null})).source={index:t,startAngle:m,endAngle:m+=o[t*c+p]*f,value:o[t*c+p]}}}catch(G){g.e(G)}finally{g.f()}h[t]={index:t,startAngle:n,endAngle:m,value:l[t]}}else{var I=Qi(0,c).filter((function(e){return o[t*c+e]||o[e*c+t]}));a&&I.sort((function(e,n){return a(o[t*c+e],o[t*c+n])}));var C,v=Object(u.a)(I);try{for(v.s();!(C=v.n()).done;){var A=C.value,y=void 0;if(t<A?(y=d[t*c+A]||(d[t*c+A]={source:null,target:null})).source={index:t,startAngle:m,endAngle:m+=o[t*c+A]*f,value:o[t*c+A]}:((y=d[A*c+t]||(d[A*c+t]={source:null,target:null})).target={index:t,startAngle:m,endAngle:m+=o[t*c+A]*f,value:o[t*c+A]},t===A&&(y.source=y.target)),y.source&&y.target&&y.source.value<y.target.value){var w=y.source;y.source=y.target,y.target=w}}}catch(G){v.e(G)}finally{v.f()}h[t]={index:t,startAngle:n,endAngle:m,value:l[t]}}m+=s};for(v.s();!(b=v.n()).done;)A()}catch(y){v.e(y)}finally{v.f()}return(d=Object.values(d)).groups=h,i?d.sort(i):d}return o.padAngle=function(e){return arguments.length?(n=Ui(0,e),o):n},o.sortGroups=function(e){return arguments.length?(r=e,o):r},o.sortSubgroups=function(e){return arguments.length?(a=e,o):a},o.sortChords=function(e){return arguments.length?(null==e?i=null:(i=qi(e))._=e,o):i&&i._},o}var ro=Math.PI,ao=2*ro,io=1e-6,oo=ao-io;function so(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function uo(){return new so}so.prototype=uo.prototype={constructor:so,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,a,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(e,t,n,r,a){e=+e,t=+t,n=+n,r=+r,a=+a;var i=this._x1,o=this._y1,s=n-e,u=r-t,c=i-e,l=o-t,g=c*c+l*l;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(g>io)if(Math.abs(l*s-u*c)>io&&a){var d=n-i,h=r-o,f=s*s+u*u,p=d*d+h*h,I=Math.sqrt(f),C=Math.sqrt(g),m=a*Math.tan((ro-Math.acos((f+g-p)/(2*I*C)))/2),b=m/C,v=m/I;Math.abs(b-1)>io&&(this._+="L"+(e+b*c)+","+(t+b*l)),this._+="A"+a+","+a+",0,0,"+ +(l*d>c*h)+","+(this._x1=e+v*s)+","+(this._y1=t+v*u)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,a,i){e=+e,t=+t,i=!!i;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=e+o,c=t+s,l=1^i,g=i?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>io||Math.abs(this._y1-c)>io)&&(this._+="L"+u+","+c),n&&(g<0&&(g=g%ao+ao),g>oo?this._+="A"+n+","+n+",0,1,"+l+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):g>io&&(this._+="A"+n+","+n+",0,"+ +(g>=ro)+","+l+","+(this._x1=e+n*Math.cos(a))+","+(this._y1=t+n*Math.sin(a))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var co=uo,lo=Array.prototype.slice,go=function(e){return function(){return e}};function ho(e){return e.source}function fo(e){return e.target}function po(e){return e.radius}function Io(e){return e.startAngle}function Co(e){return e.endAngle}function mo(){return 0}function bo(){return 10}function vo(e){var t=ho,n=fo,r=po,a=po,i=Io,o=Co,s=mo,u=null;function c(){var c,l=t.apply(this,arguments),g=n.apply(this,arguments),d=s.apply(this,arguments)/2,h=lo.call(arguments),f=+r.apply(this,(h[0]=l,h)),p=i.apply(this,h)-Di,I=o.apply(this,h)-Di,C=+a.apply(this,(h[0]=g,h)),m=i.apply(this,h)-Di,b=o.apply(this,h)-Di;if(u||(u=c=co()),d>Ji&&(Yi(I-p)>2*d+Ji?I>p?(p+=d,I-=d):(p-=d,I+=d):p=I=(p+I)/2,Yi(b-m)>2*d+Ji?b>m?(m+=d,b-=d):(m-=d,b+=d):m=b=(m+b)/2),u.moveTo(f*zi(p),f*Ki(p)),u.arc(0,0,f,p,I),p!==m||I!==b)if(e){var v=+e.apply(this,arguments),A=C-v,y=(m+b)/2;u.quadraticCurveTo(0,0,A*zi(m),A*Ki(m)),u.lineTo(C*zi(y),C*Ki(y)),u.lineTo(A*zi(b),A*Ki(b))}else u.quadraticCurveTo(0,0,C*zi(m),C*Ki(m)),u.arc(0,0,C,m,b);if(u.quadraticCurveTo(0,0,f*zi(p),f*Ki(p)),u.closePath(),c)return u=null,c+""||null}return e&&(c.headRadius=function(t){return arguments.length?(e="function"===typeof t?t:go(+t),c):e}),c.radius=function(e){return arguments.length?(r=a="function"===typeof e?e:go(+e),c):r},c.sourceRadius=function(e){return arguments.length?(r="function"===typeof e?e:go(+e),c):r},c.targetRadius=function(e){return arguments.length?(a="function"===typeof e?e:go(+e),c):a},c.startAngle=function(e){return arguments.length?(i="function"===typeof e?e:go(+e),c):i},c.endAngle=function(e){return arguments.length?(o="function"===typeof e?e:go(+e),c):o},c.padAngle=function(e){return arguments.length?(s="function"===typeof e?e:go(+e),c):s},c.source=function(e){return arguments.length?(t=e,c):t},c.target=function(e){return arguments.length?(n=e,c):n},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}var Ao=function(){return vo()};function yo(){return vo(bo)}var wo=Math.PI/180,Go=180/Math.PI,Bo=.96422,xo=.82521,So=4/29,ko=6/29,Zo=3*ko*ko;function Ro(e){if(e instanceof Wo)return new Wo(e.l,e.a,e.b,e.opacity);if(e instanceof Xo)return Ho(e);e instanceof Cr||(e=pr(e));var t,n,r=To(e.r),a=To(e.g),i=To(e.b),o=Fo((.2225045*r+.7168786*a+.0606169*i)/1);return r===a&&a===i?t=n=o:(t=Fo((.4360747*r+.3850649*a+.1430804*i)/Bo),n=Fo((.0139322*r+.0971045*a+.7141733*i)/xo)),new Wo(116*o-16,500*(t-o),200*(o-n),e.opacity)}function No(e,t){return new Wo(e,0,0,null==t?1:t)}function Oo(e,t,n,r){return 1===arguments.length?Ro(e):new Wo(e,t,n,null==r?1:r)}function Wo(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Fo(e){return e>.008856451679035631?Math.pow(e,1/3):e/Zo+So}function Mo(e){return e>ko?e*e*e:Zo*(e-So)}function Vo(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function To(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Eo(e){if(e instanceof Xo)return new Xo(e.h,e.c,e.l,e.opacity);if(e instanceof Wo||(e=Ro(e)),0===e.a&&0===e.b)return new Xo(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Go;return new Xo(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function jo(e,t,n,r){return 1===arguments.length?Eo(e):new Xo(n,t,e,null==r?1:r)}function Lo(e,t,n,r){return 1===arguments.length?Eo(e):new Xo(e,t,n,null==r?1:r)}function Xo(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function Ho(e){if(isNaN(e.h))return new Wo(e.l,0,0,e.opacity);var t=e.h*wo;return new Wo(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Pn(Wo,Oo,Un(Jn,{brighter:function(e){return new Wo(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Wo(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Cr(Vo(3.1338561*(t=Bo*Mo(t))-1.6168667*(e=1*Mo(e))-.4906146*(n=xo*Mo(n))),Vo(-.9787684*t+1.9161415*e+.033454*n),Vo(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Pn(Xo,Lo,Un(Jn,{brighter:function(e){return new Xo(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Xo(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return Ho(this).rgb()}}));var Yo=-.14861,zo=1.78277,Ko=-.29227,_o=-.90649,Do=1.97294,Po=-1.7884503806,Uo=3.5172982438,Jo=-.6557636667999999;function Qo(e){if(e instanceof $o)return new $o(e.h,e.s,e.l,e.opacity);e instanceof Cr||(e=pr(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(Jo*r+Po*t-Uo*n)/(Jo+Po-Uo),i=r-a,o=(Do*(n-a)-Ko*i)/_o,s=Math.sqrt(o*o+i*i)/(Do*a*(1-a)),u=s?Math.atan2(o,i)*Go-120:NaN;return new $o(u<0?u+360:u,s,a,e.opacity)}function qo(e,t,n,r){return 1===arguments.length?Qo(e):new $o(e,t,n,null==r?1:r)}function $o(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Pn($o,qo,Un(Jn,{brighter:function(e){return e=null==e?qn:Math.pow(qn,e),new $o(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Qn:Math.pow(Qn,e),new $o(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*wo,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new Cr(255*(t+n*(Yo*r+zo*a)),255*(t+n*(Ko*r+_o*a)),255*(t+n*(Do*r)),this.opacity)}}));var es=Array.prototype.slice,ts=function(e,t){return e-t},ns=function(e){return function(){return e}},rs=function(e,t){for(var n,r=-1,a=t.length;++r<a;)if(n=as(e,t[r]))return n;return 0};function as(e,t){for(var n=t[0],r=t[1],a=-1,i=0,o=e.length,s=o-1;i<o;s=i++){var u=e[i],c=u[0],l=u[1],g=e[s],d=g[0],h=g[1];if(is(u,g,t))return 0;l>r!==h>r&&n<(d-c)*(r-l)/(h-l)+c&&(a=-a)}return a}function is(e,t,n){var r,a,i,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(a=e[r=+(e[0]===t[0])],i=n[r],o=t[r],a<=i&&i<=o||o<=i&&i<=a)}var os=function(){},ss=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],us=function(){var e=1,t=1,n=pe,r=s;function a(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(ts);else{var r=k(e),a=r[0],o=r[1];t=he(a,o,t),t=Fe(Math.floor(a/t)*t,Math.floor(o/t)*t,t)}return t.map((function(t){return i(e,t)}))}function i(n,a){var i=[],s=[];return function(n,r,a){var i,s,u,c,l,g,d=new Array,h=new Array;i=s=-1,c=n[0]>=r,ss[c<<1].forEach(f);for(;++i<e-1;)u=c,c=n[i+1]>=r,ss[u|c<<1].forEach(f);ss[c<<0].forEach(f);for(;++s<t-1;){for(i=-1,c=n[s*e+e]>=r,l=n[s*e]>=r,ss[c<<1|l<<2].forEach(f);++i<e-1;)u=c,c=n[s*e+e+i+1]>=r,g=l,l=n[s*e+i+1]>=r,ss[u|c<<1|l<<2|g<<3].forEach(f);ss[c|l<<3].forEach(f)}i=-1,l=n[s*e]>=r,ss[l<<2].forEach(f);for(;++i<e-1;)g=l,l=n[s*e+i+1]>=r,ss[l<<2|g<<3].forEach(f);function f(e){var t,n,r=[e[0][0]+i,e[0][1]+s],u=[e[1][0]+i,e[1][1]+s],c=o(r),l=o(u);(t=h[c])?(n=d[l])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(u),a(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(u),h[t.end=l]=t):(t=d[l])?(n=h[c])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(u),a(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=c]=t):d[c]=h[l]={start:c,end:l,ring:[r,u]}}ss[l<<3].forEach(f)}(n,a,(function(e){r(e,n,a),function(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?i.push([e]):s.push(e)})),s.forEach((function(e){for(var t,n=0,r=i.length;n<r;++n)if(-1!==rs((t=i[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:a,coordinates:i}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function s(n,r,a){n.forEach((function(n){var i,o=n[0],s=n[1],u=0|o,c=0|s,l=r[c*e+u];o>0&&o<e&&u===o&&(i=r[c*e+u-1],n[0]=o+(a-i)/(l-i)-.5),s>0&&s<t&&c===s&&(i=r[(c-1)*e+u],n[1]=s+(a-i)/(l-i)-.5)}))}return a.contour=i,a.size=function(n){if(!arguments.length)return[e,t];var r=Math.floor(n[0]),i=Math.floor(n[1]);if(!(r>=0&&i>=0))throw new Error("invalid size");return e=r,t=i,a},a.thresholds=function(e){return arguments.length?(n="function"===typeof e?e:Array.isArray(e)?ns(es.call(e)):ns(e),a):n},a.smooth=function(e){return arguments.length?(r=e?s:os,a):r===s},a};function cs(e,t,n){for(var r=e.width,a=e.height,i=1+(n<<1),o=0;o<a;++o)for(var s=0,u=0;s<r+n;++s)s<r&&(u+=e.data[s+o*r]),s>=n&&(s>=i&&(u-=e.data[s-i+o*r]),t.data[s-n+o*r]=u/Math.min(s+1,r-1+i-s,i))}function ls(e,t,n){for(var r=e.width,a=e.height,i=1+(n<<1),o=0;o<r;++o)for(var s=0,u=0;s<a+n;++s)s<a&&(u+=e.data[o+s*r]),s>=n&&(s>=i&&(u-=e.data[o+(s-i)*r]),t.data[o+(s-n)*r]=u/Math.min(s+1,a-1+i-s,i))}function gs(e){return e[0]}function ds(e){return e[1]}function hs(){return 1}var fs=function(){var e=gs,t=ds,n=hs,r=960,a=500,i=20,o=2,s=3*i,u=r+2*s>>o,c=a+2*s>>o,l=ns(20);function g(r){var a=new Float32Array(u*c),g=new Float32Array(u*c);r.forEach((function(r,i,l){var g=+e(r,i,l)+s>>o,d=+t(r,i,l)+s>>o,h=+n(r,i,l);g>=0&&g<u&&d>=0&&d<c&&(a[g+d*u]+=h)})),cs({width:u,height:c,data:a},{width:u,height:c,data:g},i>>o),ls({width:u,height:c,data:g},{width:u,height:c,data:a},i>>o),cs({width:u,height:c,data:a},{width:u,height:c,data:g},i>>o),ls({width:u,height:c,data:g},{width:u,height:c,data:a},i>>o),cs({width:u,height:c,data:a},{width:u,height:c,data:g},i>>o),ls({width:u,height:c,data:g},{width:u,height:c,data:a},i>>o);var h=l(a);if(!Array.isArray(h)){var f=Ce(a);h=he(0,f,h),(h=Fe(0,Math.floor(f/h)*h,h)).shift()}return us().thresholds(h).size([u,c])(a).map(d)}function d(e){return e.value*=Math.pow(2,-2*o),e.coordinates.forEach(h),e}function h(e){e.forEach(f)}function f(e){e.forEach(p)}function p(e){e[0]=e[0]*Math.pow(2,o)-s,e[1]=e[1]*Math.pow(2,o)-s}function I(){return u=r+2*(s=3*i)>>o,c=a+2*s>>o,g}return g.x=function(t){return arguments.length?(e="function"===typeof t?t:ns(+t),g):e},g.y=function(e){return arguments.length?(t="function"===typeof e?e:ns(+e),g):t},g.weight=function(e){return arguments.length?(n="function"===typeof e?e:ns(+e),g):n},g.size=function(e){if(!arguments.length)return[r,a];var t=+e[0],n=+e[1];if(!(t>=0&&n>=0))throw new Error("invalid size");return r=t,a=n,I()},g.cellSize=function(e){if(!arguments.length)return 1<<o;if(!((e=+e)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(e)/Math.LN2),I()},g.thresholds=function(e){return arguments.length?(l="function"===typeof e?e:Array.isArray(e)?ns(es.call(e)):ns(e),g):l},g.bandwidth=function(e){if(!arguments.length)return Math.sqrt(i*(i+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return i=Math.round((Math.sqrt(4*e*e+1)-1)/2),I()},g},ps=Math.pow(2,-52),Is=new Uint32Array(512),Cs=function(){function e(t){Object(Z.a)(this,e);var n=t.length>>1;if(n>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return Object(R.a)(e,[{key:"update",value:function(){for(var e=this.coords,t=this._hullPrev,n=this._hullNext,r=this._hullTri,a=this._hullHash,i=e.length>>1,o=1/0,s=1/0,u=-1/0,c=-1/0,l=0;l<i;l++){var g=e[2*l],d=e[2*l+1];g<o&&(o=g),d<s&&(s=d),g>u&&(u=g),d>c&&(c=d),this._ids[l]=l}for(var h,f,p,I=(o+u)/2,C=(s+c)/2,m=1/0,b=0;b<i;b++){var v=ms(I,C,e[2*b],e[2*b+1]);v<m&&(h=b,m=v)}var A=e[2*h],y=e[2*h+1];m=1/0;for(var w=0;w<i;w++)if(w!==h){var G=ms(A,y,e[2*w],e[2*w+1]);G<m&&G>0&&(f=w,m=G)}for(var B=e[2*f],x=e[2*f+1],S=1/0,k=0;k<i;k++)if(k!==h&&k!==f){var Z=ys(A,y,B,x,e[2*k],e[2*k+1]);Z<S&&(p=k,S=Z)}var R=e[2*p],N=e[2*p+1];if(S===1/0){for(var O=0;O<i;O++)this._dists[O]=e[2*O]-e[0]||e[2*O+1]-e[1];ws(this._ids,this._dists,0,i-1);for(var W=new Uint32Array(i),F=0,M=0,V=-1/0;M<i;M++){var T=this._ids[M];this._dists[T]>V&&(W[F++]=T,V=this._dists[T])}return this.hull=W.subarray(0,F),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(vs(A,y,B,x,R,N)){var E=f,j=B,L=x;f=p,B=R,x=N,p=E,R=j,N=L}var X=function(e,t,n,r,a,i){var o=n-e,s=r-t,u=a-e,c=i-t,l=o*o+s*s,g=u*u+c*c,d=.5/(o*c-s*u);return{x:e+(c*l-s*g)*d,y:t+(o*g-u*l)*d}}(A,y,B,x,R,N);this._cx=X.x,this._cy=X.y;for(var H=0;H<i;H++)this._dists[H]=ms(e[2*H],e[2*H+1],X.x,X.y);ws(this._ids,this._dists,0,i-1),this._hullStart=h;var Y=3;n[h]=t[p]=f,n[f]=t[h]=p,n[p]=t[f]=h,r[h]=0,r[f]=1,r[p]=2,a.fill(-1),a[this._hashKey(A,y)]=h,a[this._hashKey(B,x)]=f,a[this._hashKey(R,N)]=p,this.trianglesLen=0,this._addTriangle(h,f,p,-1,-1,-1);for(var z,K,_=0;_<this._ids.length;_++){var D=this._ids[_],P=e[2*D],U=e[2*D+1];if(!(_>0&&Math.abs(P-z)<=ps&&Math.abs(U-K)<=ps)&&(z=P,K=U,D!==h&&D!==f&&D!==p)){for(var J=0,Q=0,q=this._hashKey(P,U);Q<this._hashSize&&(-1===(J=a[(q+Q)%this._hashSize])||J===n[J]);Q++);for(var $=J=t[J],ee=void 0;ee=n[$],!vs(P,U,e[2*$],e[2*$+1],e[2*ee],e[2*ee+1]);)if(($=ee)===J){$=-1;break}if(-1!==$){var te=this._addTriangle($,D,n[$],-1,-1,r[$]);r[D]=this._legalize(te+2),r[$]=te,Y++;for(var ne=n[$];ee=n[ne],vs(P,U,e[2*ne],e[2*ne+1],e[2*ee],e[2*ee+1]);)te=this._addTriangle(ne,D,ee,r[D],-1,r[ne]),r[D]=this._legalize(te+2),n[ne]=ne,Y--,ne=ee;if($===J)for(;vs(P,U,e[2*(ee=t[$])],e[2*ee+1],e[2*$],e[2*$+1]);)te=this._addTriangle(ee,D,$,-1,r[$],r[ee]),this._legalize(te+2),r[ee]=te,n[$]=$,Y--,$=ee;this._hullStart=t[D]=$,n[$]=t[ne]=D,n[D]=ne,a[this._hashKey(P,U)]=D,a[this._hashKey(e[2*$],e[2*$+1])]=$}}}this.hull=new Uint32Array(Y);for(var re=0,ae=this._hullStart;re<Y;re++)this.hull[re]=ae,ae=n[ae];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){for(var t=this._triangles,n=this._halfedges,r=this.coords,a=0,i=0;;){var o=n[e],s=e-e%3;if(i=s+(e+2)%3,-1!==o){var u=o-o%3,c=s+(e+1)%3,l=u+(o+2)%3,g=t[i],d=t[e],h=t[c],f=t[l];if(As(r[2*g],r[2*g+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*f],r[2*f+1])){t[e]=f,t[o]=g;var p=n[l];if(-1===p){var I=this._hullStart;do{if(this._hullTri[I]===l){this._hullTri[I]=e;break}I=this._hullPrev[I]}while(I!==this._hullStart)}this._link(e,p),this._link(o,n[i]),this._link(i,l);var C=u+(o+1)%3;a<Is.length&&(Is[a++]=C)}else{if(0===a)break;e=Is[--a]}}else{if(0===a)break;e=Is[--a]}}return i}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,a,i){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xs,a=t.length,i=new Float64Array(2*a),o=0;o<a;o++){var s=t[o];i[2*o]=n(s),i[2*o+1]=r(s)}return new e(i)}}]),e}();function ms(e,t,n,r){var a=e-n,i=t-r;return a*a+i*i}function bs(e,t,n,r,a,i){var o=(r-t)*(a-e),s=(n-e)*(i-t);return Math.abs(o-s)>=33306690738754716e-32*Math.abs(o+s)?o-s:0}function vs(e,t,n,r,a,i){return(bs(a,i,e,t,n,r)||bs(e,t,n,r,a,i)||bs(n,r,a,i,e,t))<0}function As(e,t,n,r,a,i,o,s){var u=e-o,c=t-s,l=n-o,g=r-s,d=a-o,h=i-s,f=l*l+g*g,p=d*d+h*h;return u*(g*p-f*h)-c*(l*p-f*d)+(u*u+c*c)*(l*h-g*d)<0}function ys(e,t,n,r,a,i){var o=n-e,s=r-t,u=a-e,c=i-t,l=o*o+s*s,g=u*u+c*c,d=.5/(o*c-s*u),h=(c*l-s*g)*d,f=(o*g-u*l)*d;return h*h+f*f}function ws(e,t,n,r){if(r-n<=20)for(var a=n+1;a<=r;a++){for(var i=e[a],o=t[i],s=a-1;s>=n&&t[e[s]]>o;)e[s+1]=e[s--];e[s+1]=i}else{var u=n+1,c=r;Gs(e,n+r>>1,u),t[e[n]]>t[e[r]]&&Gs(e,n,r),t[e[u]]>t[e[r]]&&Gs(e,u,r),t[e[n]]>t[e[u]]&&Gs(e,n,u);for(var l=e[u],g=t[l];;){do{u++}while(t[e[u]]<g);do{c--}while(t[e[c]]>g);if(c<u)break;Gs(e,u,c)}e[n+1]=e[c],e[c]=l,r-u+1>=c-n?(ws(e,t,u,r),ws(e,t,n,c-1)):(ws(e,t,n,c-1),ws(e,t,u,r))}}function Gs(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function Bs(e){return e[0]}function xs(e){return e[1]}var Ss=1e-6,ks=function(){function e(){Object(Z.a)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return Object(R.a)(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),a=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(a):(Math.abs(this._x1-r)>Ss||Math.abs(this._y1-a)>Ss)&&(this._+="L"+r+","+a),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=a))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),Zs=function(){function e(){Object(Z.a)(this,e),this._=[]}return Object(R.a)(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),Rs=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=Object(F.a)(n,4),a=r[0],i=r[1],o=r[2],s=r[3];if(Object(Z.a)(this,e),!((o=+o)>=(a=+a))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=o,this.xmin=a,this.ymax=s,this.ymin=i,this._init()}return Object(R.a)(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n=this.delaunay,r=n.points,a=n.hull,i=n.triangles,o=this.vectors,s=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2),u=0,c=0,l=i.length;u<l;u+=3,c+=2){var g=2*i[u],d=2*i[u+1],h=2*i[u+2],f=r[g],p=r[g+1],I=r[d],C=r[d+1],m=r[h],b=r[h+1],v=I-f,A=C-p,y=m-f,w=b-p,G=v*v+A*A,B=y*y+w*w,x=2*(v*w-A*y);if(x)if(Math.abs(x)<1e-8)e=(f+m)/2,t=(p+b)/2;else{var S=1/x;e=f+(w*G-A*B)*S,t=p+(v*B-y*G)*S}else e=(f+m)/2-1e8*w,t=(p+b)/2+1e8*y;s[c]=e,s[c+1]=t}var k,Z,R,N=a[a.length-1],O=4*N,W=r[2*N],F=r[2*N+1];o.fill(0);for(var M=0;M<a.length;++M)k=O,Z=W,R=F,O=4*(N=a[M]),W=r[2*N],F=r[2*N+1],o[k+2]=o[O]=R-F,o[k+3]=o[O+1]=W-Z}},{key:"render",value:function(e){var t=null==e?e=new ks:void 0,n=this.delaunay,r=n.halfedges,a=n.inedges,i=n.hull,o=this.circumcenters,s=this.vectors;if(i.length<=1)return null;for(var u=0,c=r.length;u<c;++u){var l=r[u];if(!(l<u)){var g=2*Math.floor(u/3),d=2*Math.floor(l/3),h=o[g],f=o[g+1],p=o[d],I=o[d+1];this._renderSegment(h,f,p,I,e)}}for(var C,m=i[i.length-1],b=0;b<i.length;++b){C=m,m=i[b];var v=2*Math.floor(a[m]/3),A=o[v],y=o[v+1],w=4*C,G=this._project(A,y,s[w+2],s[w+3]);G&&this._renderSegment(A,y,G[0],G[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new ks:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new ks:void 0,r=this._clip(e);if(null!==r&&r.length){t.moveTo(r[0],r[1]);for(var a=r.length;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(var i=2;i<a;i+=2)r[i]===r[i-2]&&r[i+1]===r[i-1]||t.lineTo(r[i],r[i+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:s.a.mark((function e(){var t,n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,r=t.length/2;case 2:if(!(n<r)){e.next=11;break}if(!(a=this.cellPolygon(n))){e.next=8;break}return a.index=n,e.next=8,a;case 8:++n,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new Zs;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,a){var i,o=this._regioncode(e,t),s=this._regioncode(n,r);0===o&&0===s?(a.moveTo(e,t),a.lineTo(n,r)):(i=this._clipSegment(e,t,n,r,o,s))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"neighbors",value:s.a.mark((function e(t){var n,r,a,i,o,c,l,g,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._clip(t))){e.next=33;break}r=Object(u.a)(this.delaunay.neighbors(t)),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=25;break}if(i=a.value,!(o=this._clip(i))){e.next=23;break}c=0,l=n.length;case 10:if(!(c<l)){e.next=23;break}g=0,d=o.length;case 12:if(!(g<d)){e.next=20;break}if(n[c]!=o[g]||n[c+1]!=o[g+1]||n[(c+2)%l]!=o[(g+d-2)%d]||n[(c+3)%l]!=o[(g+d-1)%d]){e.next=17;break}return e.next=16,i;case 16:return e.abrupt("break",23);case 17:g+=2,e.next=12;break;case 20:c+=2,e.next=10;break;case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(3),r.e(e.t0);case 30:return e.prev=30,r.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[3,27,30,33]])}))},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,a=n.halfedges,i=n.triangles,o=r[e];if(-1===o)return null;var s=[],u=o;do{var c=Math.floor(u/3);if(s.push(t[2*c],t[2*c+1]),i[u=u%3===2?u-2:u+1]!==e)break;u=a[u]}while(u!==o&&-1!==u);return s}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,a,i,o,s=t.length,u=null,c=t[s-2],l=t[s-1],g=this._regioncode(c,l),d=0;d<s;d+=2)if(n=c,r=l,c=t[d],l=t[d+1],a=g,g=this._regioncode(c,l),0===a&&0===g)i=o,o=0,u?u.push(c,l):u=[c,l];else{var h=void 0,f=void 0,p=void 0,I=void 0,C=void 0;if(0===a){if(null===(h=this._clipSegment(n,r,c,l,a,g)))continue;var m=h,b=Object(F.a)(m,4);f=b[0],p=b[1],I=b[2],C=b[3]}else{if(null===(h=this._clipSegment(c,l,n,r,g,a)))continue;var v=h,A=Object(F.a)(v,4);I=A[0],C=A[1],f=A[2],p=A[3],i=o,o=this._edgecode(f,p),i&&o&&this._edge(e,i,o,u,u.length),u?u.push(f,p):u=[f,p]}i=o,o=this._edgecode(I,C),i&&o&&this._edge(e,i,o,u,u.length),u?u.push(I,C):u=[I,C]}if(u)i=o,o=this._edgecode(u[0],u[1]),i&&o&&this._edge(e,i,o,u,u.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}},{key:"_clipSegment",value:function(e,t,n,r,a,i){for(;;){if(0===a&&0===i)return[e,t,n,r];if(a&i)return null;var o=void 0,s=void 0,u=a||i;8&u?(o=e+(n-e)*(this.ymax-t)/(r-t),s=this.ymax):4&u?(o=e+(n-e)*(this.ymin-t)/(r-t),s=this.ymin):2&u?(s=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(s=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),a?(e=o,t=s,a=this._regioncode(e,t)):(n=o,r=s,i=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,a,i){var o,s=Array.from(t);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],a,i))&&s.push(o[0],o[1]),s=this._clipFinite(e,s))for(var u,c=0,l=s.length,g=this._edgecode(s[l-2],s[l-1]);c<l;c+=2)u=g,g=this._edgecode(s[c],s[c+1]),u&&g&&(c=this._edge(e,u,g,s,c),l=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}},{key:"_edge",value:function(e,t,n,r,a){for(;t!==n;){var i=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,i=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,i=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,i=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,i=this.xmin,o=this.ymin}r[a]===i&&r[a+1]===o||!this.contains(e,i,o)||(r.splice(a,0,i,o),a+=2)}if(r.length>4)for(var s=0;s<r.length;s+=2){var u=(s+2)%r.length,c=(s+4)%r.length;(r[s]===r[u]&&r[u]===r[c]||r[s+1]===r[u+1]&&r[u+1]===r[c+1])&&(r.splice(u,2),s-=2)}return a}},{key:"_project",value:function(e,t,n,r){var a,i,o,s=1/0;if(r<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/r)<s&&(o=this.ymin,i=e+(s=a)*n)}else if(r>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/r)<s&&(o=this.ymax,i=e+(s=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<s&&(i=this.xmax,o=t+(s=a)*r)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<s&&(i=this.xmin,o=t+(s=a)*r)}return[i,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}(),Ns=s.a.mark(js),Os=2*Math.PI,Ws=Math.pow;function Fs(e){return e[0]}function Ms(e){return e[1]}function Vs(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var Ts=function(){function e(t){Object(Z.a)(this,e),this._delaunator=new Cs(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return Object(R.a)(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var a=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[a])*(n[i+1]-n[a+1])-(n[i]-n[a])*(n[o+1]-n[a+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],a=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],i=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]),o=0,s=t.length/2;o<s;++o){var u=Vs(t[2*o],t[2*o+1],i);t[2*o]=u[0],t[2*o+1]=u[1]}this._delaunator=new Cs(t)}else delete this.collinear;for(var c=this.halfedges=this._delaunator.halfedges,l=this.hull=this._delaunator.hull,g=this.triangles=this._delaunator.triangles,d=this.inedges.fill(-1),h=this._hullIndex.fill(-1),f=0,p=c.length;f<p;++f){var I=g[f%3===2?f-2:f+1];-1!==c[f]&&-1!==d[I]||(d[I]=f)}for(var C=0,m=l.length;C<m;++C)h[l[C]]=C;l.length<=2&&l.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=l[0],this.triangles[1]=l[1],this.triangles[2]=l[1],d[l[0]]=1,2===l.length&&(d[l[1]]=0))}},{key:"voronoi",value:function(e){return new Rs(this,e)}},{key:"neighbors",value:s.a.mark((function e(t){var n,r,a,i,o,u,c,l,g,d,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,r=this.hull,a=this._hullIndex,i=this.halfedges,o=this.triangles,!(u=this.collinear)){e.next=10;break}if(!((c=u.indexOf(t))>0)){e.next=6;break}return e.next=6,u[c-1];case 6:if(!(c<u.length-1)){e.next=9;break}return e.next=9,u[c+1];case 9:return e.abrupt("return");case 10:if(-1!==(l=n[t])){e.next=13;break}return e.abrupt("return");case 13:g=l,d=-1;case 14:return e.next=16,d=o[g];case 16:if(o[g=g%3===2?g-2:g+1]===t){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(g=i[g])){e.next=26;break}if((h=r[(a[t]+1)%r.length])===d){e.next=25;break}return e.next=25,h;case 25:return e.abrupt("return");case 26:if(g!==l){e.next=14;break}case 27:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(var r,a=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==a;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this.inedges,a=this.hull,i=this._hullIndex,o=this.halfedges,s=this.triangles,u=this.points;if(-1===r[e]||!u.length)return(e+1)%(u.length>>1);var c=e,l=Ws(t-u[2*e],2)+Ws(n-u[2*e+1],2),g=r[e],d=g;do{var h=s[d],f=Ws(t-u[2*h],2)+Ws(n-u[2*h+1],2);if(f<l&&(l=f,c=h),s[d=d%3===2?d-2:d+1]!==e)break;if(-1===(d=o[d])){if((d=a[(i[e]+1)%a.length])!==h&&Ws(t-u[2*d],2)+Ws(n-u[2*d+1],2)<l)return d;break}}while(d!==g);return c}},{key:"render",value:function(e){for(var t=null==e?e=new ks:void 0,n=this.points,r=this.halfedges,a=this.triangles,i=0,o=r.length;i<o;++i){var s=r[i];if(!(s<i)){var u=2*a[i],c=2*a[s];e.moveTo(n[u],n[u+1]),e.lineTo(n[c],n[c+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new ks:void 0,r=this.points,a=0,i=r.length;a<i;a+=2){var o=r[a],s=r[a+1];e.moveTo(o+t,s),e.arc(o,s,t,0,Os)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new ks:void 0,n=this.hull,r=this.points,a=2*n[0],i=n.length;e.moveTo(r[a],r[a+1]);for(var o=1;o<i;++o){var s=2*n[o];e.lineTo(r[s],r[s+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new Zs;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new ks:void 0,r=this.points,a=this.triangles,i=2*a[e*=3],o=2*a[e+1],s=2*a[e+2];return t.moveTo(r[i],r[i+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,r=t.length/3;case 2:if(!(n<r)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new Zs;return this.renderTriangle(e,t),t.value()}}],[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ms,a=arguments.length>3?arguments[3]:void 0;return new e("length"in t?Es(t,n,r,a):Float64Array.from(js(t,n,r,a)))}}]),e}();function Es(e,t,n,r){for(var a=e.length,i=new Float64Array(2*a),o=0;o<a;++o){var s=e[o];i[2*o]=t.call(r,s,o,e),i[2*o+1]=n.call(r,s,o,e)}return i}function js(e,t,n,r){var a,i,o,c;return s.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a=0,i=Object(u.a)(e),s.prev=2,i.s();case 4:if((o=i.n()).done){s.next=13;break}return c=o.value,s.next=8,t.call(r,c,a,e);case 8:return s.next=10,n.call(r,c,a,e);case 10:++a;case 11:s.next=4;break;case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(2),i.e(s.t0);case 18:return s.prev=18,i.f(),s.finish(18);case 21:case"end":return s.stop()}}),Ns,null,[[2,15,18,21]])}var Ls=function(e){return function(){return e}};function Xs(e,t){var n=t.sourceEvent,r=t.subject,a=t.target,i=t.identifier,o=t.active,s=t.x,u=t.y,c=t.dx,l=t.dy,g=t.dispatch;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:g}})}function Hs(e){return!e.ctrlKey&&!e.button}function Ys(){return this.parentNode}function zs(e,t){return null==t?{x:e.x,y:e.y}:t}function Ks(){return navigator.maxTouchPoints||"ontouchstart"in this}Xs.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var _s=function(){var e,t,n,r,a=Hs,i=Ys,o=zs,s=Ks,u={},c=Gt("start","drag","end"),l=0,g=0;function d(e){e.on("mousedown.drag",h).filter(s).on("touchstart.drag",I).on("touchmove.drag",C).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(o,s){if(!r&&a.call(this,o,s)){var u=b(this,i.call(this,o,s),o,s,"mouse");u&&(Yn(o.view).on("mousemove.drag",f,!0).on("mouseup.drag",p,!0),_n(o.view),zn(o),n=!1,e=o.clientX,t=o.clientY,u("start",o))}}function f(r){if(Kn(r),!n){var a=r.clientX-e,i=r.clientY-t;n=a*a+i*i>g}u.mouse("drag",r)}function p(e){Yn(e.view).on("mousemove.drag mouseup.drag",null),Dn(e.view,n),Kn(e),u.mouse("end",e)}function I(e,t){if(a.call(this,e,t)){var n,r,o=e.changedTouches,s=i.call(this,e,t),u=o.length;for(n=0;n<u;++n)(r=b(this,s,e,t,o[n].identifier,o[n]))&&(zn(e),r("start",e,o[n]))}}function C(e){var t,n,r=e.changedTouches,a=r.length;for(t=0;t<a;++t)(n=u[r[t].identifier])&&(Kn(e),n("drag",e,r[t]))}function m(e){var t,n,a=e.changedTouches,i=a.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(n=u[a[t].identifier])&&(zn(e),n("end",e,a[t]))}function b(e,t,n,r,a,i){var s,g,h,f=c.copy(),p=qr(i||n,t);if(null!=(h=o.call(e,new Xs("beforestart",{sourceEvent:n,target:d,identifier:a,active:l,x:p[0],y:p[1],dx:0,dy:0,dispatch:f}),r)))return s=h.x-p[0]||0,g=h.y-p[1]||0,function n(i,o,c){var I,C=p;switch(i){case"start":u[a]=n,I=l++;break;case"end":delete u[a],--l;case"drag":p=qr(c||o,t),I=l}f.call(i,e,new Xs(i,{sourceEvent:o,subject:h,target:d,identifier:a,active:I,x:p[0]+s,y:p[1]+g,dx:p[0]-C[0],dy:p[1]-C[1],dispatch:f}),r)}}return d.filter=function(e){return arguments.length?(a="function"===typeof e?e:Ls(!!e),d):a},d.container=function(e){return arguments.length?(i="function"===typeof e?e:Ls(e),d):i},d.subject=function(e){return arguments.length?(o="function"===typeof e?e:Ls(e),d):o},d.touchable=function(e){return arguments.length?(s="function"===typeof e?e:Ls(!!e),d):s},d.on=function(){var e=c.on.apply(c,arguments);return e===c?d:e},d.clickDistance=function(e){return arguments.length?(g=(e=+e)*e,d):Math.sqrt(g)},d},Ds={},Ps={};function Us(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Js(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Qs(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function qs(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),a=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Qs(-t,6):t>9999?"+"+Qs(t,6):Qs(t,4))+"-"+Qs(e.getUTCMonth()+1,2)+"-"+Qs(e.getUTCDate(),2)+(i?"T"+Qs(n,2)+":"+Qs(r,2)+":"+Qs(a,2)+"."+Qs(i,3)+"Z":a?"T"+Qs(n,2)+":"+Qs(r,2)+":"+Qs(a,2)+"Z":r||n?"T"+Qs(n,2)+":"+Qs(r,2)+"Z":"")}var $s=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,s=0,u=i<=0,c=!1;function l(){if(u)return Ps;if(c)return c=!1,Ds;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?u=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return u=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==Ps;){for(var g=[];r!==Ds&&r!==Ps;)g.push(r),r=l();t&&null==(g=t(g,s++))||a.push(g)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?qs(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=Us(e);return function(r,a){return t(n(r),a,e)}}(e,t):Us(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=Js(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Js(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}},eu=$s(","),tu=eu.parse,nu=eu.parseRows,ru=eu.format,au=eu.formatBody,iu=eu.formatRows,ou=eu.formatRow,su=eu.formatValue,uu=$s("\t"),cu=uu.parse,lu=uu.parseRows,gu=uu.format,du=uu.formatBody,hu=uu.formatRows,fu=uu.formatRow,pu=uu.formatValue;function Iu(e){for(var t in e){var n,r,a=e[t].trim();if(a)if("true"===a)a=!0;else if("false"===a)a=!1;else if("NaN"===a)a=NaN;else if(isNaN(n=+a)){if(!(r=a.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Cu&&r[4]&&!r[7]&&(a=a.replace(/-/g,"/").replace(/T/," ")),a=new Date(a)}else a=n;else a=null;e[t]=a}return e}var Cu=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),mu=n(161);function bu(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}var vu=function(e,t){return fetch(e,t).then(bu)};function Au(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}var yu=function(e,t){return fetch(e,t).then(Au)};function wu(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}var Gu=function(e,t){return fetch(e,t).then(wu)};function Bu(e){return function(t,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),Gu(t,n).then((function(t){return e(t,r)}))}}function xu(e,t,n,r){3===arguments.length&&"function"===typeof n&&(r=n,n=void 0);var a=$s(e);return Gu(t,n).then((function(e){return a.parse(e,r)}))}var Su=Bu(tu),ku=Bu(cu),Zu=function(e,t){return new Promise((function(n,r){var a=new Image;for(var i in t)a[i]=t[i];a.onerror=r,a.onload=function(){n(a)},a.src=e}))};function Ru(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(204!==e.status&&205!==e.status)return e.json()}var Nu=function(e,t){return fetch(e,t).then(Ru)};function Ou(e){return function(t,n){return Gu(t,n).then((function(t){return(new DOMParser).parseFromString(t,e)}))}}var Wu=Ou("application/xml"),Fu=Ou("text/html"),Mu=Ou("image/svg+xml"),Vu=function(e,t){var n,r=1;function a(){var a,i,o=n.length,s=0,u=0;for(a=0;a<o;++a)s+=(i=n[a]).x,u+=i.y;for(s=(s/o-e)*r,u=(u/o-t)*r,a=0;a<o;++a)(i=n[a]).x-=s,i.y-=u}return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){n=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a.strength=function(e){return arguments.length?(r=+e,a):r},a};function Tu(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var a,i,o,s,u,c,l,g,d,h=e._root,f={data:r},p=e._x0,I=e._y0,C=e._x1,m=e._y1;if(!h)return e._root=f,e;for(;h.length;)if((c=t>=(i=(p+C)/2))?p=i:C=i,(l=n>=(o=(I+m)/2))?I=o:m=o,a=h,!(h=h[g=l<<1|c]))return a[g]=f,e;if(s=+e._x.call(null,h.data),u=+e._y.call(null,h.data),t===s&&n===u)return f.next=h,a?a[g]=f:e._root=f,e;do{a=a?a[g]=new Array(4):e._root=new Array(4),(c=t>=(i=(p+C)/2))?p=i:C=i,(l=n>=(o=(I+m)/2))?I=o:m=o}while((g=l<<1|c)===(d=(u>=o)<<1|s>=i));return a[d]=h,a[g]=f,e}var Eu=function(e,t,n,r,a){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=a};function ju(e){return e[0]}function Lu(e){return e[1]}function Xu(e,t,n){var r=new Hu(null==t?ju:t,null==n?Lu:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function Hu(e,t,n,r,a,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function Yu(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var zu=Xu.prototype=Hu.prototype;zu.copy=function(){var e,t,n=new Hu(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Yu(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var a=0;a<4;++a)(t=r.source[a])&&(t.length?e.push({source:t,target:r.target[a]=new Array(4)}):r.target[a]=Yu(t));return n},zu.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return Tu(this.cover(t,n),t,n,e)},zu.addAll=function(e){var t,n,r,a,i=e.length,o=new Array(i),s=new Array(i),u=1/0,c=1/0,l=-1/0,g=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=r,s[n]=a,r<u&&(u=r),r>l&&(l=r),a<c&&(c=a),a>g&&(g=a));if(u>l||c>g)return this;for(this.cover(u,c).cover(l,g),n=0;n<i;++n)Tu(this,o[n],s[n],e[n]);return this},zu.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var o,s,u=a-n||1,c=this._root;n>e||e>=a||r>t||t>=i;)switch(s=(t<r)<<1|e<n,(o=new Array(4))[s]=c,c=o,u*=2,s){case 0:a=n+u,i=r+u;break;case 1:n=a-u,i=r+u;break;case 2:a=n+u,r=i-u;break;case 3:n=a-u,r=i-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},zu.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},zu.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},zu.find=function(e,t,n){var r,a,i,o,s,u,c,l=this._x0,g=this._y0,d=this._x1,h=this._y1,f=[],p=this._root;for(p&&f.push(new Eu(p,l,g,d,h)),null==n?n=1/0:(l=e-n,g=t-n,d=e+n,h=t+n,n*=n);u=f.pop();)if(!(!(p=u.node)||(a=u.x0)>d||(i=u.y0)>h||(o=u.x1)<l||(s=u.y1)<g))if(p.length){var I=(a+o)/2,C=(i+s)/2;f.push(new Eu(p[3],I,C,o,s),new Eu(p[2],a,C,I,s),new Eu(p[1],I,i,o,C),new Eu(p[0],a,i,I,C)),(c=(t>=C)<<1|e>=I)&&(u=f[f.length-1],f[f.length-1]=f[f.length-1-c],f[f.length-1-c]=u)}else{var m=e-+this._x.call(null,p.data),b=t-+this._y.call(null,p.data),v=m*m+b*b;if(v<n){var A=Math.sqrt(n=v);l=e-A,g=t-A,d=e+A,h=t+A,r=p.data}}return r},zu.remove=function(e){if(isNaN(i=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,a,i,o,s,u,c,l,g,d,h=this._root,f=this._x0,p=this._y0,I=this._x1,C=this._y1;if(!h)return this;if(h.length)for(;;){if((c=i>=(s=(f+I)/2))?f=s:I=s,(l=o>=(u=(p+C)/2))?p=u:C=u,t=h,!(h=h[g=l<<1|c]))return this;if(!h.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(n=t,d=g)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(a=h.next)&&delete h.next,r?(a?r.next=a:delete r.next,this):t?(a?t[g]=a:delete t[g],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=a,this)},zu.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},zu.root=function(){return this._root},zu.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},zu.visit=function(e){var t,n,r,a,i,o,s=[],u=this._root;for(u&&s.push(new Eu(u,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(u=t.node,r=t.x0,a=t.y0,i=t.x1,o=t.y1)&&u.length){var c=(r+i)/2,l=(a+o)/2;(n=u[3])&&s.push(new Eu(n,c,l,i,o)),(n=u[2])&&s.push(new Eu(n,r,l,c,o)),(n=u[1])&&s.push(new Eu(n,c,a,i,l)),(n=u[0])&&s.push(new Eu(n,r,a,c,l))}return this},zu.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new Eu(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var a=t.node;if(a.length){var i,o=t.x0,s=t.y0,u=t.x1,c=t.y1,l=(o+u)/2,g=(s+c)/2;(i=a[0])&&n.push(new Eu(i,o,s,l,g)),(i=a[1])&&n.push(new Eu(i,l,s,u,g)),(i=a[2])&&n.push(new Eu(i,o,g,l,c)),(i=a[3])&&n.push(new Eu(i,l,g,u,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},zu.x=function(e){return arguments.length?(this._x=e,this):this._x},zu.y=function(e){return arguments.length?(this._y=e,this):this._y};var Ku=function(e){return function(){return e}},_u=function(e){return 1e-6*(e()-.5)};function Du(e){return e.x+e.vx}function Pu(e){return e.y+e.vy}var Uu=function(e){var t,n,r,a=1,i=1;function o(){for(var e,o,u,c,l,g,d,h=t.length,f=0;f<i;++f)for(o=Xu(t,Du,Pu).visitAfter(s),e=0;e<h;++e)u=t[e],g=n[u.index],d=g*g,c=u.x+u.vx,l=u.y+u.vy,o.visit(p);function p(e,t,n,i,o){var s=e.data,h=e.r,f=g+h;if(!s)return t>c+f||i<c-f||n>l+f||o<l-f;if(s.index>u.index){var p=c-s.x-s.vx,I=l-s.y-s.vy,C=p*p+I*I;C<f*f&&(0===p&&(C+=(p=_u(r))*p),0===I&&(C+=(I=_u(r))*I),C=(f-(C=Math.sqrt(C)))/C*a,u.vx+=(p*=C)*(f=(h*=h)/(d+h)),u.vy+=(I*=C)*f,s.vx-=p*(f=1-f),s.vy-=I*f)}}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function u(){if(t){var r,a,i=t.length;for(n=new Array(i),r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}}return"function"!==typeof e&&(e=Ku(null==e?1:+e)),o.initialize=function(e,n){t=e,r=n,u()},o.iterations=function(e){return arguments.length?(i=+e,o):i},o.strength=function(e){return arguments.length?(a=+e,o):a},o.radius=function(t){return arguments.length?(e="function"===typeof t?t:Ku(+t),u(),o):e},o};function Ju(e){return e.index}function Qu(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}var qu=function(e){var t,n,r,a,i,o,s=Ju,u=function(e){return 1/Math.min(a[e.source.index],a[e.target.index])},c=Ku(30),l=1;function g(r){for(var a=0,s=e.length;a<l;++a)for(var u,c,g,d,h,f,p,I=0;I<s;++I)c=(u=e[I]).source,d=(g=u.target).x+g.vx-c.x-c.vx||_u(o),h=g.y+g.vy-c.y-c.vy||_u(o),d*=f=((f=Math.sqrt(d*d+h*h))-n[I])/f*r*t[I],h*=f,g.vx-=d*(p=i[I]),g.vy-=h*p,c.vx+=d*(p=1-p),c.vy+=h*p}function d(){if(r){var o,u,c=r.length,l=e.length,g=new Map(r.map((function(e,t){return[s(e,t,r),e]})));for(o=0,a=new Array(c);o<l;++o)(u=e[o]).index=o,"object"!==typeof u.source&&(u.source=Qu(g,u.source)),"object"!==typeof u.target&&(u.target=Qu(g,u.target)),a[u.source.index]=(a[u.source.index]||0)+1,a[u.target.index]=(a[u.target.index]||0)+1;for(o=0,i=new Array(l);o<l;++o)u=e[o],i[o]=a[u.source.index]/(a[u.source.index]+a[u.target.index]);t=new Array(l),h(),n=new Array(l),f()}}function h(){if(r)for(var n=0,a=e.length;n<a;++n)t[n]=+u(e[n],n,e)}function f(){if(r)for(var t=0,a=e.length;t<a;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),g.initialize=function(e,t){r=e,o=t,d()},g.links=function(t){return arguments.length?(e=t,d(),g):e},g.id=function(e){return arguments.length?(s=e,g):s},g.iterations=function(e){return arguments.length?(l=+e,g):l},g.strength=function(e){return arguments.length?(u="function"===typeof e?e:Ku(+e),h(),g):u},g.distance=function(e){return arguments.length?(c="function"===typeof e?e:Ku(+e),f(),g):c},g},$u=4294967296;function ec(e){return e.x}function tc(e){return e.y}var nc=Math.PI*(3-Math.sqrt(5)),rc=function(e){var t,n=1,r=.001,a=1-Math.pow(r,1/300),i=0,o=.6,s=new Map,u=la(g),c=Gt("tick","end"),l=function(){var e=1;return function(){return(e=(1664525*e+1013904223)%$u)/$u}}();function g(){d(),c.call("tick",t),n<r&&(u.stop(),c.call("end",t))}function d(r){var u,c,l=e.length;void 0===r&&(r=1);for(var g=0;g<r;++g)for(n+=(i-n)*a,s.forEach((function(e){e(n)})),u=0;u<l;++u)null==(c=e[u]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var a=10*Math.sqrt(.5+n),i=n*nc;t.x=a*Math.cos(i),t.y=a*Math.sin(i)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function f(t){return t.initialize&&t.initialize(e,l),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return u.restart(g),t},stop:function(){return u.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),s.forEach(f),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(a=+e,t):+a},alphaTarget:function(e){return arguments.length?(i=+e,t):i},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},randomSource:function(e){return arguments.length?(l=e,s.forEach(f),t):l},force:function(e,n){return arguments.length>1?(null==n?s.delete(e):s.set(e,f(n)),t):s.get(e)},find:function(t,n,r){var a,i,o,s,u,c=0,l=e.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(a=t-(s=e[c]).x)*a+(i=n-s.y)*i)<r&&(u=s,r=o);return u},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}},ac=function(){var e,t,n,r,a,i=Ku(-30),o=1,s=1/0,u=.81;function c(n){var a,i=e.length,o=Xu(e,ec,tc).visitAfter(g);for(r=n,a=0;a<i;++a)t=e[a],o.visit(d)}function l(){if(e){var t,n,r=e.length;for(a=new Array(r),t=0;t<r;++t)n=e[t],a[n.index]=+i(n,t,e)}}function g(e){var t,n,r,i,o,s=0,u=0;if(e.length){for(r=i=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(s+=t.value,u+=n,r+=n*t.x,i+=n*t.y);e.x=r/u,e.y=i/u}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=a[t.data.index]}while(t=t.next)}e.value=s}function d(e,i,c,l){if(!e.value)return!0;var g=e.x-t.x,d=e.y-t.y,h=l-i,f=g*g+d*d;if(h*h/u<f)return f<s&&(0===g&&(f+=(g=_u(n))*g),0===d&&(f+=(d=_u(n))*d),f<o&&(f=Math.sqrt(o*f)),t.vx+=g*e.value*r/f,t.vy+=d*e.value*r/f),!0;if(!(e.length||f>=s)){(e.data!==t||e.next)&&(0===g&&(f+=(g=_u(n))*g),0===d&&(f+=(d=_u(n))*d),f<o&&(f=Math.sqrt(o*f)));do{e.data!==t&&(h=a[e.data.index]*r/f,t.vx+=g*h,t.vy+=d*h)}while(e=e.next)}}return c.initialize=function(t,r){e=t,n=r,l()},c.strength=function(e){return arguments.length?(i="function"===typeof e?e:Ku(+e),l(),c):i},c.distanceMin=function(e){return arguments.length?(o=e*e,c):Math.sqrt(o)},c.distanceMax=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c.theta=function(e){return arguments.length?(u=e*e,c):Math.sqrt(u)},c},ic=function(e,t,n){var r,a,i,o=Ku(.1);function s(e){for(var o=0,s=r.length;o<s;++o){var u=r[o],c=u.x-t||1e-6,l=u.y-n||1e-6,g=Math.sqrt(c*c+l*l),d=(i[o]-g)*a[o]*e/g;u.vx+=c*d,u.vy+=l*d}}function u(){if(r){var t,n=r.length;for(a=new Array(n),i=new Array(n),t=0;t<n;++t)i[t]=+e(r[t],t,r),a[t]=isNaN(i[t])?0:+o(r[t],t,r)}}return"function"!==typeof e&&(e=Ku(+e)),null==t&&(t=0),null==n&&(n=0),s.initialize=function(e){r=e,u()},s.strength=function(e){return arguments.length?(o="function"===typeof e?e:Ku(+e),u(),s):o},s.radius=function(t){return arguments.length?(e="function"===typeof t?t:Ku(+t),u(),s):e},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(e){return arguments.length?(n=+e,s):n},s},oc=function(e){var t,n,r,a=Ku(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vx+=(r[i]-a.x)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=Ku(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:Ku(+e),o(),i):a},i.x=function(t){return arguments.length?(e="function"===typeof t?t:Ku(+t),o(),i):e},i},sc=function(e){var t,n,r,a=Ku(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vy+=(r[i]-a.y)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=Ku(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:Ku(+e),o(),i):a},i.y=function(t){return arguments.length?(e="function"===typeof t?t:Ku(+t),o(),i):e},i};function uc(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}var cc=function(e){return(e=uc(Math.abs(e)))?e[1]:NaN},lc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function gc(e){if(!(t=lc.exec(e)))throw new Error("invalid format: "+e);var t;return new dc({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function dc(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}gc.prototype=dc.prototype,dc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var hc,fc,pc,Ic,Cc=function(e,t){var n=uc(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")},mc={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Cc(100*e,t)},r:Cc,s:function(e,t){var n=uc(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(hc=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+uc(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},bc=function(e){return e},vc=Array.prototype.map,Ac=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],yc=function(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?bc:(t=vc.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,s=t[0],u=0;a>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),i.push(e.substring(a-=s,a+s)),!((u+=s+1)>r));)s=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?bc:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(vc.call(e.numerals,String)),u=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function g(e){var t=(e=gc(e)).fill,n=e.align,g=e.sign,d=e.symbol,h=e.zero,f=e.width,p=e.comma,I=e.precision,C=e.trim,m=e.type;"n"===m?(p=!0,m="g"):mc[m]||(void 0===I&&(I=12),C=!0,m="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v="$"===d?i:/[%p]/.test(m)?u:"",A=mc[m],y=/[defgprs%]/.test(m);function w(e){var a,i,u,d=b,w=v;if("c"===m)w=A(e)+w,e="";else{var G=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:A(Math.abs(e),I),C&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),G&&0===+e&&"+"!==g&&(G=!1),d=(G?"("===g?g:c:"-"===g||"("===g?"":g)+d,w=("s"===m?Ac[8+hc/3]:"")+w+(G&&"("===g?")":""),y)for(a=-1,i=e.length;++a<i;)if(48>(u=e.charCodeAt(a))||u>57){w=(46===u?o+e.slice(a+1):e.slice(a))+w,e=e.slice(0,a);break}}p&&!h&&(e=r(e,1/0));var B=d.length+e.length+w.length,x=B<f?new Array(f-B+1).join(t):"";switch(p&&h&&(e=r(x+e,x.length?f-w.length:1/0),x=""),n){case"<":e=d+e+w+x;break;case"=":e=d+x+e+w;break;case"^":e=x.slice(0,B=x.length>>1)+d+e+w+x.slice(B);break;default:e=x+d+e+w}return s(e)}return I=void 0===I?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,I)):Math.max(0,Math.min(20,I)),w.toString=function(){return e+""},w}return{format:g,formatPrefix:function(e,t){var n=g(((e=gc(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(cc(t)/3))),a=Math.pow(10,-r),i=Ac[8+r/3];return function(e){return n(a*e)+i}}}};function wc(e){return fc=yc(e),pc=fc.format,Ic=fc.formatPrefix,fc}wc({thousands:",",grouping:[3],currency:["$",""]});var Gc=function(e){return Math.max(0,-cc(Math.abs(e)))},Bc=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(cc(t)/3)))-cc(Math.abs(e)))},xc=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,cc(t)-cc(e))+1},Sc=1e-6,kc=1e-12,Zc=Math.PI,Rc=Zc/2,Nc=Zc/4,Oc=2*Zc,Wc=180/Zc,Fc=Zc/180,Mc=Math.abs,Vc=Math.atan,Tc=Math.atan2,Ec=Math.cos,jc=Math.ceil,Lc=Math.exp,Xc=(Math.floor,Math.hypot),Hc=Math.log,Yc=Math.pow,zc=Math.sin,Kc=Math.sign||function(e){return e>0?1:e<0?-1:0},_c=Math.sqrt,Dc=Math.tan;function Pc(e){return e>1?0:e<-1?Zc:Math.acos(e)}function Uc(e){return e>1?Rc:e<-1?-Rc:Math.asin(e)}function Jc(e){return(e=zc(e/2))*e}function Qc(){}function qc(e,t){e&&el.hasOwnProperty(e.type)&&el[e.type](e,t)}var $c={Feature:function(e,t){qc(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)qc(n[r].geometry,t)}},el={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){tl(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)tl(n[r],t,0)},Polygon:function(e,t){nl(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)nl(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)qc(n[r],t)}};function tl(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function nl(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)tl(e[n],t,1);t.polygonEnd()}var rl,al,il,ol,sl,ul=function(e,t){e&&$c.hasOwnProperty(e.type)?$c[e.type](e,t):qc(e,t)},cl=new N,ll=new N,gl={point:Qc,lineStart:Qc,lineEnd:Qc,polygonStart:function(){cl=new N,gl.lineStart=dl,gl.lineEnd=hl},polygonEnd:function(){var e=+cl;ll.add(e<0?Oc+e:e),this.lineStart=this.lineEnd=this.point=Qc},sphere:function(){ll.add(Oc)}};function dl(){gl.point=fl}function hl(){pl(rl,al)}function fl(e,t){gl.point=pl,rl=e,al=t,il=e*=Fc,ol=Ec(t=(t*=Fc)/2+Nc),sl=zc(t)}function pl(e,t){var n=(e*=Fc)-il,r=n>=0?1:-1,a=r*n,i=Ec(t=(t*=Fc)/2+Nc),o=zc(t),s=sl*o,u=ol*i+s*Ec(a),c=s*r*zc(a);cl.add(Tc(c,u)),il=e,ol=i,sl=o}var Il,Cl,ml,bl,vl,Al,yl,wl,Gl,Bl,xl,Sl=function(e){return ll=new N,ul(e,gl),2*ll};function kl(e){return[Tc(e[1],e[0]),Uc(e[2])]}function Zl(e){var t=e[0],n=e[1],r=Ec(n);return[r*Ec(t),r*zc(t),zc(n)]}function Rl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Nl(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ol(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Wl(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Fl(e){var t=_c(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Ml={point:Vl,lineStart:El,lineEnd:jl,polygonStart:function(){Ml.point=Ll,Ml.lineStart=Xl,Ml.lineEnd=Hl,Gl=new N,gl.polygonStart()},polygonEnd:function(){gl.polygonEnd(),Ml.point=Vl,Ml.lineStart=El,Ml.lineEnd=jl,cl<0?(Il=-(ml=180),Cl=-(bl=90)):Gl>Sc?bl=90:Gl<-1e-6&&(Cl=-90),xl[0]=Il,xl[1]=ml},sphere:function(){Il=-(ml=180),Cl=-(bl=90)}};function Vl(e,t){Bl.push(xl=[Il=e,ml=e]),t<Cl&&(Cl=t),t>bl&&(bl=t)}function Tl(e,t){var n=Zl([e*Fc,t*Fc]);if(wl){var r=Nl(wl,n),a=Nl([r[1],-r[0],0],r);Fl(a),a=kl(a);var i,o=e-vl,s=o>0?1:-1,u=a[0]*Wc*s,c=Mc(o)>180;c^(s*vl<u&&u<s*e)?(i=a[1]*Wc)>bl&&(bl=i):c^(s*vl<(u=(u+360)%360-180)&&u<s*e)?(i=-a[1]*Wc)<Cl&&(Cl=i):(t<Cl&&(Cl=t),t>bl&&(bl=t)),c?e<vl?Yl(Il,e)>Yl(Il,ml)&&(ml=e):Yl(e,ml)>Yl(Il,ml)&&(Il=e):ml>=Il?(e<Il&&(Il=e),e>ml&&(ml=e)):e>vl?Yl(Il,e)>Yl(Il,ml)&&(ml=e):Yl(e,ml)>Yl(Il,ml)&&(Il=e)}else Bl.push(xl=[Il=e,ml=e]);t<Cl&&(Cl=t),t>bl&&(bl=t),wl=n,vl=e}function El(){Ml.point=Tl}function jl(){xl[0]=Il,xl[1]=ml,Ml.point=Vl,wl=null}function Ll(e,t){if(wl){var n=e-vl;Gl.add(Mc(n)>180?n+(n>0?360:-360):n)}else Al=e,yl=t;gl.point(e,t),Tl(e,t)}function Xl(){gl.lineStart()}function Hl(){Ll(Al,yl),gl.lineEnd(),Mc(Gl)>Sc&&(Il=-(ml=180)),xl[0]=Il,xl[1]=ml,wl=null}function Yl(e,t){return(t-=e)<0?t+360:t}function zl(e,t){return e[0]-t[0]}function Kl(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var _l,Dl,Pl,Ul,Jl,Ql,ql,$l,eg,tg,ng,rg,ag,ig,og,sg,ug=function(e){var t,n,r,a,i,o,s;if(bl=ml=-(Il=Cl=1/0),Bl=[],ul(e,Ml),n=Bl.length){for(Bl.sort(zl),t=1,i=[r=Bl[0]];t<n;++t)Kl(r,(a=Bl[t])[0])||Kl(r,a[1])?(Yl(r[0],a[1])>Yl(r[0],r[1])&&(r[1]=a[1]),Yl(a[0],r[1])>Yl(r[0],r[1])&&(r[0]=a[0])):i.push(r=a);for(o=-1/0,t=0,r=i[n=i.length-1];t<=n;r=a,++t)a=i[t],(s=Yl(r[1],a[0]))>o&&(o=s,Il=a[0],ml=r[1])}return Bl=xl=null,Il===1/0||Cl===1/0?[[NaN,NaN],[NaN,NaN]]:[[Il,Cl],[ml,bl]]},cg={sphere:Qc,point:lg,lineStart:dg,lineEnd:pg,polygonStart:function(){cg.lineStart=Ig,cg.lineEnd=Cg},polygonEnd:function(){cg.lineStart=dg,cg.lineEnd=pg}};function lg(e,t){e*=Fc;var n=Ec(t*=Fc);gg(n*Ec(e),n*zc(e),zc(t))}function gg(e,t,n){++_l,Pl+=(e-Pl)/_l,Ul+=(t-Ul)/_l,Jl+=(n-Jl)/_l}function dg(){cg.point=hg}function hg(e,t){e*=Fc;var n=Ec(t*=Fc);ig=n*Ec(e),og=n*zc(e),sg=zc(t),cg.point=fg,gg(ig,og,sg)}function fg(e,t){e*=Fc;var n=Ec(t*=Fc),r=n*Ec(e),a=n*zc(e),i=zc(t),o=Tc(_c((o=og*i-sg*a)*o+(o=sg*r-ig*i)*o+(o=ig*a-og*r)*o),ig*r+og*a+sg*i);Dl+=o,Ql+=o*(ig+(ig=r)),ql+=o*(og+(og=a)),$l+=o*(sg+(sg=i)),gg(ig,og,sg)}function pg(){cg.point=lg}function Ig(){cg.point=mg}function Cg(){bg(rg,ag),cg.point=lg}function mg(e,t){rg=e,ag=t,e*=Fc,t*=Fc,cg.point=bg;var n=Ec(t);ig=n*Ec(e),og=n*zc(e),sg=zc(t),gg(ig,og,sg)}function bg(e,t){e*=Fc;var n=Ec(t*=Fc),r=n*Ec(e),a=n*zc(e),i=zc(t),o=og*i-sg*a,s=sg*r-ig*i,u=ig*a-og*r,c=Xc(o,s,u),l=Uc(c),g=c&&-l/c;eg.add(g*o),tg.add(g*s),ng.add(g*u),Dl+=l,Ql+=l*(ig+(ig=r)),ql+=l*(og+(og=a)),$l+=l*(sg+(sg=i)),gg(ig,og,sg)}var vg=function(e){_l=Dl=Pl=Ul=Jl=Ql=ql=$l=0,eg=new N,tg=new N,ng=new N,ul(e,cg);var t=+eg,n=+tg,r=+ng,a=Xc(t,n,r);return a<kc&&(t=Ql,n=ql,r=$l,Dl<Sc&&(t=Pl,n=Ul,r=Jl),(a=Xc(t,n,r))<kc)?[NaN,NaN]:[Tc(n,t)*Wc,Uc(r/a)*Wc]},Ag=function(e){return function(){return e}},yg=function(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n};function wg(e,t){return[Mc(e)>Zc?e+Math.round(-e/Oc)*Oc:e,t]}function Gg(e,t,n){return(e%=Oc)?t||n?yg(xg(e),Sg(t,n)):xg(e):t||n?Sg(t,n):wg}function Bg(e){return function(t,n){return[(t+=e)>Zc?t-Oc:t<-Zc?t+Oc:t,n]}}function xg(e){var t=Bg(e);return t.invert=Bg(-e),t}function Sg(e,t){var n=Ec(e),r=zc(e),a=Ec(t),i=zc(t);function o(e,t){var o=Ec(t),s=Ec(e)*o,u=zc(e)*o,c=zc(t),l=c*n+s*r;return[Tc(u*a-l*i,s*n-c*r),Uc(l*a+u*i)]}return o.invert=function(e,t){var o=Ec(t),s=Ec(e)*o,u=zc(e)*o,c=zc(t),l=c*a-u*i;return[Tc(u*a+c*i,s*n+l*r),Uc(l*n-s*r)]},o}wg.invert=wg;var kg=function(e){function t(t){return(t=e(t[0]*Fc,t[1]*Fc))[0]*=Wc,t[1]*=Wc,t}return e=Gg(e[0]*Fc,e[1]*Fc,e.length>2?e[2]*Fc:0),t.invert=function(t){return(t=e.invert(t[0]*Fc,t[1]*Fc))[0]*=Wc,t[1]*=Wc,t},t};function Zg(e,t,n,r,a,i){if(n){var o=Ec(t),s=zc(t),u=r*n;null==a?(a=t+r*Oc,i=t-u/2):(a=Rg(o,a),i=Rg(o,i),(r>0?a<i:a>i)&&(a+=r*Oc));for(var c,l=a;r>0?l>i:l<i;l-=u)c=kl([o,-s*Ec(l),-s*zc(l)]),e.point(c[0],c[1])}}function Rg(e,t){(t=Zl(t))[0]-=e,Fl(t);var n=Pc(-t[1]);return((-t[2]<0?-n:n)+Oc-Sc)%Oc}var Ng=function(){var e,t,n=Ag([0,0]),r=Ag(90),a=Ag(6),i={point:function(n,r){e.push(n=t(n,r)),n[0]*=Wc,n[1]*=Wc}};function o(){var o=n.apply(this,arguments),s=r.apply(this,arguments)*Fc,u=a.apply(this,arguments)*Fc;return e=[],t=Gg(-o[0]*Fc,-o[1]*Fc,0).invert,Zg(i,s,u,1),o={type:"Polygon",coordinates:[e]},e=t=null,o}return o.center=function(e){return arguments.length?(n="function"===typeof e?e:Ag([+e[0],+e[1]]),o):n},o.radius=function(e){return arguments.length?(r="function"===typeof e?e:Ag(+e),o):r},o.precision=function(e){return arguments.length?(a="function"===typeof e?e:Ag(+e),o):a},o},Og=function(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:Qc,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}},Wg=function(e,t){return Mc(e[0]-t[0])<Sc&&Mc(e[1]-t[1])<Sc};function Fg(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var Mg=function(e,t,n,r,a){var i,o,s=[],u=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(Wg(r,o)){if(!r[2]&&!o[2]){for(a.lineStart(),i=0;i<t;++i)a.point((r=e[i])[0],r[1]);return void a.lineEnd()}o[0]+=2e-6}s.push(n=new Fg(r,e,null,!0)),u.push(n.o=new Fg(r,null,n,!1)),s.push(n=new Fg(o,e,null,!1)),u.push(n.o=new Fg(o,null,n,!0))}})),s.length){for(u.sort(t),Vg(s),Vg(u),i=0,o=u.length;i<o;++i)u[i].e=n=!n;for(var c,l,g=s[0];;){for(var d=g,h=!0;d.v;)if((d=d.n)===g)return;c=d.z,a.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(i=0,o=c.length;i<o;++i)a.point((l=c[i])[0],l[1]);else r(d.x,d.n.x,1,a);d=d.n}else{if(h)for(c=d.p.z,i=c.length-1;i>=0;--i)a.point((l=c[i])[0],l[1]);else r(d.x,d.p.x,-1,a);d=d.p}c=(d=d.o).z,h=!h}while(!d.v);a.lineEnd()}}};function Vg(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}function Tg(e){return Mc(e[0])<=Zc?e[0]:Kc(e[0])*((Mc(e[0])+Zc)%Oc-Zc)}var Eg=function(e,t){var n=Tg(t),r=t[1],a=zc(r),i=[zc(n),-Ec(n),0],o=0,s=0,u=new N;1===a?r=Rc+Sc:-1===a&&(r=-Rc-Sc);for(var c=0,l=e.length;c<l;++c)if(d=(g=e[c]).length)for(var g,d,h=g[d-1],f=Tg(h),p=h[1]/2+Nc,I=zc(p),C=Ec(p),m=0;m<d;++m,f=v,I=y,C=w,h=b){var b=g[m],v=Tg(b),A=b[1]/2+Nc,y=zc(A),w=Ec(A),G=v-f,B=G>=0?1:-1,x=B*G,S=x>Zc,k=I*y;if(u.add(Tc(k*B*zc(x),C*w+k*Ec(x))),o+=S?G+B*Oc:G,S^f>=n^v>=n){var Z=Nl(Zl(h),Zl(b));Fl(Z);var R=Nl(i,Z);Fl(R);var O=(S^G>=0?-1:1)*Uc(R[2]);(r>O||r===O&&(Z[0]||Z[1]))&&(s+=S^G>=0?1:-1)}}return(o<-1e-6||o<Sc&&u<-1e-12)^1&s},jg=function(e,t,n,r){return function(a){var i,o,s,u=t(a),c=Og(),l=t(c),g=!1,d={point:h,lineStart:p,lineEnd:I,polygonStart:function(){d.point=C,d.lineStart=m,d.lineEnd=b,o=[],i=[]},polygonEnd:function(){d.point=h,d.lineStart=p,d.lineEnd=I,o=Re(o);var e=Eg(i,r);o.length?(g||(a.polygonStart(),g=!0),Mg(o,Xg,e,n,a)):e&&(g||(a.polygonStart(),g=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),g&&(a.polygonEnd(),g=!1),o=i=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(t,n){e(t,n)&&a.point(t,n)}function f(e,t){u.point(e,t)}function p(){d.point=f,u.lineStart()}function I(){d.point=h,u.lineEnd()}function C(e,t){s.push([e,t]),l.point(e,t)}function m(){l.lineStart(),s=[]}function b(){C(s[0][0],s[0][1]),l.lineEnd();var e,t,n,r,u=l.clean(),d=c.result(),h=d.length;if(s.pop(),i.push(s),s=null,h)if(1&u){if((t=(n=d[0]).length-1)>0){for(g||(a.polygonStart(),g=!0),a.lineStart(),e=0;e<t;++e)a.point((r=n[e])[0],r[1]);a.lineEnd()}}else h>1&&2&u&&d.push(d.pop().concat(d.shift())),o.push(d.filter(Lg))}return d}};function Lg(e){return e.length>1}function Xg(e,t){return((e=e.x)[0]<0?e[1]-Rc-Sc:Rc-e[1])-((t=t.x)[0]<0?t[1]-Rc-Sc:Rc-t[1])}var Hg=jg((function(){return!0}),(function(e){var t,n=NaN,r=NaN,a=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var s=i>0?Zc:-Zc,u=Mc(i-n);Mc(u-Zc)<Sc?(e.point(n,r=(r+o)/2>0?Rc:-Rc),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(i,r),t=0):a!==s&&u>=Zc&&(Mc(n-a)<Sc&&(n-=a*Sc),Mc(i-s)<Sc&&(i-=s*Sc),r=function(e,t,n,r){var a,i,o=zc(e-n);return Mc(o)>Sc?Vc((zc(t)*(i=Ec(r))*zc(n)-zc(r)*(a=Ec(t))*zc(e))/(a*i*o)):(t+r)/2}(n,r,i,o),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=i,r=o),a=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var a;if(null==e)a=n*Rc,r.point(-Zc,a),r.point(0,a),r.point(Zc,a),r.point(Zc,0),r.point(Zc,-a),r.point(0,-a),r.point(-Zc,-a),r.point(-Zc,0),r.point(-Zc,a);else if(Mc(e[0]-t[0])>Sc){var i=e[0]<t[0]?Zc:-Zc;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(t[0],t[1])}),[-Zc,-Rc]);var Yg=function(e){var t=Ec(e),n=6*Fc,r=t>0,a=Mc(t)>Sc;function i(e,n){return Ec(e)*Ec(n)>t}function o(e,n,r){var a=[1,0,0],i=Nl(Zl(e),Zl(n)),o=Rl(i,i),s=i[0],u=o-s*s;if(!u)return!r&&e;var c=t*o/u,l=-t*s/u,g=Nl(a,i),d=Wl(a,c);Ol(d,Wl(i,l));var h=g,f=Rl(d,h),p=Rl(h,h),I=f*f-p*(Rl(d,d)-1);if(!(I<0)){var C=_c(I),m=Wl(h,(-f-C)/p);if(Ol(m,d),m=kl(m),!r)return m;var b,v=e[0],A=n[0],y=e[1],w=n[1];A<v&&(b=v,v=A,A=b);var G=A-v,B=Mc(G-Zc)<Sc;if(!B&&w<y&&(b=y,y=w,w=b),B||G<Sc?B?y+w>0^m[1]<(Mc(m[0]-v)<Sc?y:w):y<=m[1]&&m[1]<=w:G>Zc^(v<=m[0]&&m[0]<=A)){var x=Wl(h,(-f+C)/p);return Ol(x,d),[m,kl(x)]}}}function s(t,n){var a=r?e:Zc-e,i=0;return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}return jg(i,(function(e){var t,n,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(g,d){var h,f=[g,d],p=i(g,d),I=r?p?0:s(g,d):p?s(g+(g<0?Zc:-Zc),d):0;if(!t&&(c=u=p)&&e.lineStart(),p!==u&&(!(h=o(t,f))||Wg(t,h)||Wg(f,h))&&(f[2]=1),p!==u)l=0,p?(e.lineStart(),h=o(f,t),e.point(h[0],h[1])):(h=o(t,f),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(a&&t&&r^p){var C;I&n||!(C=o(f,t,!0))||(l=0,r?(e.lineStart(),e.point(C[0][0],C[0][1]),e.point(C[1][0],C[1][1]),e.lineEnd()):(e.point(C[1][0],C[1][1]),e.lineEnd(),e.lineStart(),e.point(C[0][0],C[0][1],3)))}!p||t&&Wg(t,f)||e.point(f[0],f[1]),t=f,u=p,n=I},lineEnd:function(){u&&e.lineEnd(),t=null},clean:function(){return l|(c&&u)<<1}}}),(function(t,r,a,i){Zg(i,e,n,a,t,r)}),r?[0,-e]:[-Zc,e-Zc])},zg=1e9,Kg=-zg;function _g(e,t,n,r){function a(a,i){return e<=a&&a<=n&&t<=i&&i<=r}function i(a,i,s,c){var l=0,g=0;if(null==a||(l=o(a,s))!==(g=o(i,s))||u(a,i)<0^s>0)do{c.point(0===l||3===l?e:n,l>1?r:t)}while((l=(l+s+4)%4)!==g);else c.point(i[0],i[1])}function o(r,a){return Mc(r[0]-e)<Sc?a>0?0:3:Mc(r[0]-n)<Sc?a>0?2:1:Mc(r[1]-t)<Sc?a>0?1:0:a>0?3:2}function s(e,t){return u(e.x,t.x)}function u(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var u,c,l,g,d,h,f,p,I,C,m,b=o,v=Og(),A={point:y,lineStart:function(){A.point=w,c&&c.push(l=[]);C=!0,I=!1,f=p=NaN},lineEnd:function(){u&&(w(g,d),h&&I&&v.rejoin(),u.push(v.result()));A.point=y,I&&b.lineEnd()},polygonStart:function(){b=v,u=[],c=[],m=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,a=c.length;n<a;++n)for(var i,o,s=c[n],u=1,l=s.length,g=s[0],d=g[0],h=g[1];u<l;++u)i=d,o=h,d=(g=s[u])[0],h=g[1],o<=r?h>r&&(d-i)*(r-o)>(h-o)*(e-i)&&++t:h<=r&&(d-i)*(r-o)<(h-o)*(e-i)&&--t;return t}(),n=m&&t,a=(u=Re(u)).length;(n||a)&&(o.polygonStart(),n&&(o.lineStart(),i(null,null,1,o),o.lineEnd()),a&&Mg(u,s,t,i,o),o.polygonEnd());b=o,u=c=l=null}};function y(e,t){a(e,t)&&b.point(e,t)}function w(i,o){var s=a(i,o);if(c&&l.push([i,o]),C)g=i,d=o,h=s,C=!1,s&&(b.lineStart(),b.point(i,o));else if(s&&I)b.point(i,o);else{var u=[f=Math.max(Kg,Math.min(zg,f)),p=Math.max(Kg,Math.min(zg,p))],v=[i=Math.max(Kg,Math.min(zg,i)),o=Math.max(Kg,Math.min(zg,o))];!function(e,t,n,r,a,i){var o,s=e[0],u=e[1],c=0,l=1,g=t[0]-s,d=t[1]-u;if(o=n-s,g||!(o>0)){if(o/=g,g<0){if(o<c)return;o<l&&(l=o)}else if(g>0){if(o>l)return;o>c&&(c=o)}if(o=a-s,g||!(o<0)){if(o/=g,g<0){if(o>l)return;o>c&&(c=o)}else if(g>0){if(o<c)return;o<l&&(l=o)}if(o=r-u,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>c&&(c=o)}if(o=i-u,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<l&&(l=o)}return c>0&&(e[0]=s+c*g,e[1]=u+c*d),l<1&&(t[0]=s+l*g,t[1]=u+l*d),!0}}}}}(u,v,e,t,n,r)?s&&(b.lineStart(),b.point(i,o),m=!1):(I||(b.lineStart(),b.point(u[0],u[1])),b.point(v[0],v[1]),s||b.lineEnd(),m=!1)}f=i,p=o,I=s}return A}}var Dg,Pg,Ug,Jg,Qg=function(){var e,t,n,r=0,a=0,i=960,o=500;return n={stream:function(n){return e&&t===n?e:e=_g(r,a,i,o)(t=n)},extent:function(s){return arguments.length?(r=+s[0][0],a=+s[0][1],i=+s[1][0],o=+s[1][1],e=t=null,n):[[r,a],[i,o]]}}},qg={sphere:Qc,point:Qc,lineStart:function(){qg.point=ed,qg.lineEnd=$g},lineEnd:Qc,polygonStart:Qc,polygonEnd:Qc};function $g(){qg.point=qg.lineEnd=Qc}function ed(e,t){Pg=e*=Fc,Ug=zc(t*=Fc),Jg=Ec(t),qg.point=td}function td(e,t){e*=Fc;var n=zc(t*=Fc),r=Ec(t),a=Mc(e-Pg),i=Ec(a),o=r*zc(a),s=Jg*n-Ug*r*i,u=Ug*n+Jg*r*i;Dg.add(Tc(_c(o*o+s*s),u)),Pg=e,Ug=n,Jg=r}var nd=function(e){return Dg=new N,ul(e,qg),+Dg},rd=[null,null],ad={type:"LineString",coordinates:rd},id=function(e,t){return rd[0]=e,rd[1]=t,nd(ad)},od={Feature:function(e,t){return ud(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)if(ud(n[r].geometry,t))return!0;return!1}},sd={Sphere:function(){return!0},Point:function(e,t){return cd(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)if(cd(n[r],t))return!0;return!1},LineString:function(e,t){return ld(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)if(ld(n[r],t))return!0;return!1},Polygon:function(e,t){return gd(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)if(gd(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)if(ud(n[r],t))return!0;return!1}};function ud(e,t){return!(!e||!sd.hasOwnProperty(e.type))&&sd[e.type](e,t)}function cd(e,t){return 0===id(e,t)}function ld(e,t){for(var n,r,a,i=0,o=e.length;i<o;i++){if(0===(r=id(e[i],t)))return!0;if(i>0&&(a=id(e[i],e[i-1]))>0&&n<=a&&r<=a&&(n+r-a)*(1-Math.pow((n-r)/a,2))<kc*a)return!0;n=r}return!1}function gd(e,t){return!!Eg(e.map(dd),hd(t))}function dd(e){return(e=e.map(hd)).pop(),e}function hd(e){return[e[0]*Fc,e[1]*Fc]}var fd=function(e,t){return(e&&od.hasOwnProperty(e.type)?od[e.type]:ud)(e,t)};function pd(e,t,n){var r=Fe(e,t-Sc,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function Id(e,t,n){var r=Fe(e,t-Sc,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function Cd(){var e,t,n,r,a,i,o,s,u,c,l,g,d=10,h=d,f=90,p=360,I=2.5;function C(){return{type:"MultiLineString",coordinates:m()}}function m(){return Fe(jc(r/f)*f,n,f).map(l).concat(Fe(jc(s/p)*p,o,p).map(g)).concat(Fe(jc(t/d)*d,e,d).filter((function(e){return Mc(e%f)>Sc})).map(u)).concat(Fe(jc(i/h)*h,a,h).filter((function(e){return Mc(e%p)>Sc})).map(c))}return C.lines=function(){return m().map((function(e){return{type:"LineString",coordinates:e}}))},C.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(g(o).slice(1),l(n).reverse().slice(1),g(s).reverse().slice(1))]}},C.extent=function(e){return arguments.length?C.extentMajor(e).extentMinor(e):C.extentMinor()},C.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],s=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),s>o&&(e=s,s=o,o=e),C.precision(I)):[[r,s],[n,o]]},C.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],i=+n[0][1],a=+n[1][1],t>e&&(n=t,t=e,e=n),i>a&&(n=i,i=a,a=n),C.precision(I)):[[t,i],[e,a]]},C.step=function(e){return arguments.length?C.stepMajor(e).stepMinor(e):C.stepMinor()},C.stepMajor=function(e){return arguments.length?(f=+e[0],p=+e[1],C):[f,p]},C.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],C):[d,h]},C.precision=function(d){return arguments.length?(I=+d,u=pd(i,a,90),c=Id(t,e,I),l=pd(s,o,90),g=Id(r,n,I),C):I},C.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function md(){return Cd()()}var bd,vd,Ad,yd,wd=function(e,t){var n=e[0]*Fc,r=e[1]*Fc,a=t[0]*Fc,i=t[1]*Fc,o=Ec(r),s=zc(r),u=Ec(i),c=zc(i),l=o*Ec(n),g=o*zc(n),d=u*Ec(a),h=u*zc(a),f=2*Uc(_c(Jc(i-r)+o*u*Jc(a-n))),p=zc(f),I=f?function(e){var t=zc(e*=f)/p,n=zc(f-e)/p,r=n*l+t*d,a=n*g+t*h,i=n*s+t*c;return[Tc(a,r)*Wc,Tc(i,_c(r*r+a*a))*Wc]}:function(){return[n*Wc,r*Wc]};return I.distance=f,I},Gd=function(e){return e},Bd=new N,xd=new N,Sd={point:Qc,lineStart:Qc,lineEnd:Qc,polygonStart:function(){Sd.lineStart=kd,Sd.lineEnd=Nd},polygonEnd:function(){Sd.lineStart=Sd.lineEnd=Sd.point=Qc,Bd.add(Mc(xd)),xd=new N},result:function(){var e=Bd/2;return Bd=new N,e}};function kd(){Sd.point=Zd}function Zd(e,t){Sd.point=Rd,bd=Ad=e,vd=yd=t}function Rd(e,t){xd.add(yd*e-Ad*t),Ad=e,yd=t}function Nd(){Rd(bd,vd)}var Od=Sd,Wd=1/0,Fd=Wd,Md=-Wd,Vd=Md;var Td,Ed,jd,Ld,Xd={point:function(e,t){e<Wd&&(Wd=e);e>Md&&(Md=e);t<Fd&&(Fd=t);t>Vd&&(Vd=t)},lineStart:Qc,lineEnd:Qc,polygonStart:Qc,polygonEnd:Qc,result:function(){var e=[[Wd,Fd],[Md,Vd]];return Md=Vd=-(Fd=Wd=1/0),e}},Hd=0,Yd=0,zd=0,Kd=0,_d=0,Dd=0,Pd=0,Ud=0,Jd=0,Qd={point:qd,lineStart:$d,lineEnd:nh,polygonStart:function(){Qd.lineStart=rh,Qd.lineEnd=ah},polygonEnd:function(){Qd.point=qd,Qd.lineStart=$d,Qd.lineEnd=nh},result:function(){var e=Jd?[Pd/Jd,Ud/Jd]:Dd?[Kd/Dd,_d/Dd]:zd?[Hd/zd,Yd/zd]:[NaN,NaN];return Hd=Yd=zd=Kd=_d=Dd=Pd=Ud=Jd=0,e}};function qd(e,t){Hd+=e,Yd+=t,++zd}function $d(){Qd.point=eh}function eh(e,t){Qd.point=th,qd(jd=e,Ld=t)}function th(e,t){var n=e-jd,r=t-Ld,a=_c(n*n+r*r);Kd+=a*(jd+e)/2,_d+=a*(Ld+t)/2,Dd+=a,qd(jd=e,Ld=t)}function nh(){Qd.point=qd}function rh(){Qd.point=ih}function ah(){oh(Td,Ed)}function ih(e,t){Qd.point=oh,qd(Td=jd=e,Ed=Ld=t)}function oh(e,t){var n=e-jd,r=t-Ld,a=_c(n*n+r*r);Kd+=a*(jd+e)/2,_d+=a*(Ld+t)/2,Dd+=a,Pd+=(a=Ld*e-jd*t)*(jd+e),Ud+=a*(Ld+t),Jd+=3*a,qd(jd=e,Ld=t)}var sh=Qd;function uh(e){this._context=e}uh.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Oc)}},result:Qc};var ch,lh,gh,dh,hh,fh=new N,ph={point:Qc,lineStart:function(){ph.point=Ih},lineEnd:function(){ch&&Ch(lh,gh),ph.point=Qc},polygonStart:function(){ch=!0},polygonEnd:function(){ch=null},result:function(){var e=+fh;return fh=new N,e}};function Ih(e,t){ph.point=Ch,lh=dh=e,gh=hh=t}function Ch(e,t){dh-=e,hh-=t,fh.add(_c(dh*dh+hh*hh)),dh=e,hh=t}var mh=ph;function bh(){this._string=[]}function vh(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}bh.prototype={_radius:4.5,_circle:vh(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=vh(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var Ah=function(e,t){var n,r,a=4.5;function i(e){return e&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),ul(e,n(r))),r.result()}return i.area=function(e){return ul(e,n(Od)),Od.result()},i.measure=function(e){return ul(e,n(mh)),mh.result()},i.bounds=function(e){return ul(e,n(Xd)),Xd.result()},i.centroid=function(e){return ul(e,n(sh)),sh.result()},i.projection=function(t){return arguments.length?(n=null==t?(e=null,Gd):(e=t).stream,i):e},i.context=function(e){return arguments.length?(r=null==e?(t=null,new bh):new uh(t=e),"function"!==typeof a&&r.pointRadius(a),i):t},i.pointRadius=function(e){return arguments.length?(a="function"===typeof e?e:(r.pointRadius(+e),+e),i):a},i.projection(e).context(t)},yh=function(e){return{stream:wh(e)}};function wh(e){return function(t){var n=new Gh;for(var r in e)n[r]=e[r];return n.stream=t,n}}function Gh(){}function Bh(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),ul(n,e.stream(Xd)),t(Xd.result()),null!=r&&e.clipExtent(r),e}function xh(e,t,n){return Bh(e,(function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+t[0][0]+(r-i*(n[1][0]+n[0][0]))/2,s=+t[0][1]+(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,s])}),n)}function Sh(e,t,n){return xh(e,[[0,0],t],n)}function kh(e,t,n){return Bh(e,(function(n){var r=+t,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];e.scale(150*a).translate([i,o])}),n)}function Zh(e,t,n){return Bh(e,(function(n){var r=+t,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([i,o])}),n)}Gh.prototype={constructor:Gh,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Rh=Ec(30*Fc),Nh=function(e,t){return+t?function(e,t){function n(r,a,i,o,s,u,c,l,g,d,h,f,p,I){var C=c-r,m=l-a,b=C*C+m*m;if(b>4*t&&p--){var v=o+d,A=s+h,y=u+f,w=_c(v*v+A*A+y*y),G=Uc(y/=w),B=Mc(Mc(y)-1)<Sc||Mc(i-g)<Sc?(i+g)/2:Tc(A,v),x=e(B,G),S=x[0],k=x[1],Z=S-r,R=k-a,N=m*Z-C*R;(N*N/b>t||Mc((C*Z+m*R)/b-.5)>.3||o*d+s*h+u*f<Rh)&&(n(r,a,i,o,s,u,S,k,B,v/=w,A/=w,y,p,I),I.point(S,k),n(S,k,B,v,A,y,c,l,g,d,h,f,p,I))}}return function(t){var r,a,i,o,s,u,c,l,g,d,h,f,p={point:I,lineStart:C,lineEnd:b,polygonStart:function(){t.polygonStart(),p.lineStart=v},polygonEnd:function(){t.polygonEnd(),p.lineStart=C}};function I(n,r){n=e(n,r),t.point(n[0],n[1])}function C(){l=NaN,p.point=m,t.lineStart()}function m(r,a){var i=Zl([r,a]),o=e(r,a);n(l,g,c,d,h,f,l=o[0],g=o[1],c=r,d=i[0],h=i[1],f=i[2],16,t),t.point(l,g)}function b(){p.point=I,t.lineEnd()}function v(){C(),p.point=A,p.lineEnd=y}function A(e,t){m(r=e,t),a=l,i=g,o=d,s=h,u=f,p.point=m}function y(){n(l,g,c,d,h,f,a,i,r,o,s,u,16,t),p.lineEnd=b,b()}return p}}(e,t):function(e){return wh({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)};var Oh=wh({point:function(e,t){this.stream.point(e*Fc,t*Fc)}});function Wh(e,t,n,r,a,i){if(!i)return function(e,t,n,r,a){function i(i,o){return[t+e*(i*=r),n-e*(o*=a)]}return i.invert=function(i,o){return[(i-t)/e*r,(n-o)/e*a]},i}(e,t,n,r,a);var o=Ec(i),s=zc(i),u=o*e,c=s*e,l=o/e,g=s/e,d=(s*n-o*t)/e,h=(s*t+o*n)/e;function f(e,i){return[u*(e*=r)-c*(i*=a)+t,n-c*e-u*i]}return f.invert=function(e,t){return[r*(l*e-g*t+d),a*(h-g*e-l*t)]},f}function Fh(e){return Mh((function(){return e}))()}function Mh(e){var t,n,r,a,i,o,s,u,c,l,g=150,d=480,h=250,f=0,p=0,I=0,C=0,m=0,b=0,v=1,A=1,y=null,w=Hg,G=null,B=Gd,x=.5;function S(e){return u(e[0]*Fc,e[1]*Fc)}function k(e){return(e=u.invert(e[0],e[1]))&&[e[0]*Wc,e[1]*Wc]}function Z(){var e=Wh(g,0,0,v,A,b).apply(null,t(f,p)),r=Wh(g,d-e[0],h-e[1],v,A,b);return n=Gg(I,C,m),s=yg(t,r),u=yg(n,s),o=Nh(s,x),R()}function R(){return c=l=null,S}return S.stream=function(e){return c&&l===e?c:c=Oh(function(e){return wh({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(w(o(B(l=e)))))},S.preclip=function(e){return arguments.length?(w=e,y=void 0,R()):w},S.postclip=function(e){return arguments.length?(B=e,G=r=a=i=null,R()):B},S.clipAngle=function(e){return arguments.length?(w=+e?Yg(y=e*Fc):(y=null,Hg),R()):y*Wc},S.clipExtent=function(e){return arguments.length?(B=null==e?(G=r=a=i=null,Gd):_g(G=+e[0][0],r=+e[0][1],a=+e[1][0],i=+e[1][1]),R()):null==G?null:[[G,r],[a,i]]},S.scale=function(e){return arguments.length?(g=+e,Z()):g},S.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],Z()):[d,h]},S.center=function(e){return arguments.length?(f=e[0]%360*Fc,p=e[1]%360*Fc,Z()):[f*Wc,p*Wc]},S.rotate=function(e){return arguments.length?(I=e[0]%360*Fc,C=e[1]%360*Fc,m=e.length>2?e[2]%360*Fc:0,Z()):[I*Wc,C*Wc,m*Wc]},S.angle=function(e){return arguments.length?(b=e%360*Fc,Z()):b*Wc},S.reflectX=function(e){return arguments.length?(v=e?-1:1,Z()):v<0},S.reflectY=function(e){return arguments.length?(A=e?-1:1,Z()):A<0},S.precision=function(e){return arguments.length?(o=Nh(s,x=e*e),R()):_c(x)},S.fitExtent=function(e,t){return xh(S,e,t)},S.fitSize=function(e,t){return Sh(S,e,t)},S.fitWidth=function(e,t){return kh(S,e,t)},S.fitHeight=function(e,t){return Zh(S,e,t)},function(){return t=e.apply(this,arguments),S.invert=t.invert&&k,Z()}}function Vh(e){var t=0,n=Zc/3,r=Mh(e),a=r(t,n);return a.parallels=function(e){return arguments.length?r(t=e[0]*Fc,n=e[1]*Fc):[t*Wc,n*Wc]},a}function Th(e,t){var n=zc(e),r=(n+zc(t))/2;if(Mc(r)<Sc)return function(e){var t=Ec(e);function n(e,n){return[e*t,zc(n)/t]}return n.invert=function(e,n){return[e/t,Uc(n*t)]},n}(e);var a=1+n*(2*r-n),i=_c(a)/r;function o(e,t){var n=_c(a-2*r*zc(t))/r;return[n*zc(e*=r),i-n*Ec(e)]}return o.invert=function(e,t){var n=i-t,o=Tc(e,Mc(n))*Kc(n);return n*r<0&&(o-=Zc*Kc(e)*Kc(n)),[o/r,Uc((a-(e*e+n*n)*r*r)/(2*r))]},o}var Eh=function(){return Vh(Th).scale(155.424).center([0,33.6442])},jh=function(){return Eh().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var Lh=function(){var e,t,n,r,a,i,o=jh(),s=Eh().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Eh().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){i=[e,t]}};function l(e){var t=e[0],o=e[1];return i=null,n.point(t,o),i||(r.point(t,o),i)||(a.point(t,o),i)}function g(){return e=t=null,l}return l.invert=function(e){var t=o.scale(),n=o.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?s:a>=.166&&a<.234&&r>=-.214&&r<-.115?u:o).invert(e)},l.stream=function(n){return e&&t===n?e:e=function(e){var t=e.length;return{point:function(n,r){for(var a=-1;++a<t;)e[a].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([o.stream(t=n),s.stream(n),u.stream(n)])},l.precision=function(e){return arguments.length?(o.precision(e),s.precision(e),u.precision(e),g()):o.precision()},l.scale=function(e){return arguments.length?(o.scale(e),s.scale(.35*e),u.scale(e),l.translate(o.translate())):o.scale()},l.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),i=+e[0],l=+e[1];return n=o.translate(e).clipExtent([[i-.455*t,l-.238*t],[i+.455*t,l+.238*t]]).stream(c),r=s.translate([i-.307*t,l+.201*t]).clipExtent([[i-.425*t+Sc,l+.12*t+Sc],[i-.214*t-Sc,l+.234*t-Sc]]).stream(c),a=u.translate([i-.205*t,l+.212*t]).clipExtent([[i-.214*t+Sc,l+.166*t+Sc],[i-.115*t-Sc,l+.234*t-Sc]]).stream(c),g()},l.fitExtent=function(e,t){return xh(l,e,t)},l.fitSize=function(e,t){return Sh(l,e,t)},l.fitWidth=function(e,t){return kh(l,e,t)},l.fitHeight=function(e,t){return Zh(l,e,t)},l.scale(1070)};function Xh(e){return function(t,n){var r=Ec(t),a=Ec(n),i=e(r*a);return i===1/0?[2,0]:[i*a*zc(t),i*zc(n)]}}function Hh(e){return function(t,n){var r=_c(t*t+n*n),a=e(r),i=zc(a),o=Ec(a);return[Tc(t*i,r*o),Uc(r&&n*i/r)]}}var Yh=Xh((function(e){return _c(2/(1+e))}));Yh.invert=Hh((function(e){return 2*Uc(e/2)}));var zh=function(){return Fh(Yh).scale(124.75).clipAngle(179.999)},Kh=Xh((function(e){return(e=Pc(e))&&e/zc(e)}));Kh.invert=Hh((function(e){return e}));var _h=function(){return Fh(Kh).scale(79.4188).clipAngle(179.999)};function Dh(e,t){return[e,Hc(Dc((Rc+t)/2))]}Dh.invert=function(e,t){return[e,2*Vc(Lc(t))-Rc]};var Ph=function(){return Uh(Dh).scale(961/Oc)};function Uh(e){var t,n,r,a=Fh(e),i=a.center,o=a.scale,s=a.translate,u=a.clipExtent,c=null;function l(){var i=Zc*o(),s=a(kg(a.rotate()).invert([0,0]));return u(null==c?[[s[0]-i,s[1]-i],[s[0]+i,s[1]+i]]:e===Dh?[[Math.max(s[0]-i,c),t],[Math.min(s[0]+i,n),r]]:[[c,Math.max(s[1]-i,t)],[n,Math.min(s[1]+i,r)]])}return a.scale=function(e){return arguments.length?(o(e),l()):o()},a.translate=function(e){return arguments.length?(s(e),l()):s()},a.center=function(e){return arguments.length?(i(e),l()):i()},a.clipExtent=function(e){return arguments.length?(null==e?c=t=n=r=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),l()):null==c?null:[[c,t],[n,r]]},l()}function Jh(e){return Dc((Rc+e)/2)}function Qh(e,t){var n=Ec(e),r=e===t?zc(e):Hc(n/Ec(t))/Hc(Jh(t)/Jh(e)),a=n*Yc(Jh(e),r)/r;if(!r)return Dh;function i(e,t){a>0?t<-Rc+Sc&&(t=-Rc+Sc):t>Rc-Sc&&(t=Rc-Sc);var n=a/Yc(Jh(t),r);return[n*zc(r*e),a-n*Ec(r*e)]}return i.invert=function(e,t){var n=a-t,i=Kc(r)*_c(e*e+n*n),o=Tc(e,Mc(n))*Kc(n);return n*r<0&&(o-=Zc*Kc(e)*Kc(n)),[o/r,2*Vc(Yc(a/i,1/r))-Rc]},i}var qh=function(){return Vh(Qh).scale(109.5).parallels([30,30])};function $h(e,t){return[e,t]}$h.invert=$h;var ef=function(){return Fh($h).scale(152.63)};function tf(e,t){var n=Ec(e),r=e===t?zc(e):(n-Ec(t))/(t-e),a=n/r+e;if(Mc(r)<Sc)return $h;function i(e,t){var n=a-t,i=r*e;return[n*zc(i),a-n*Ec(i)]}return i.invert=function(e,t){var n=a-t,i=Tc(e,Mc(n))*Kc(n);return n*r<0&&(i-=Zc*Kc(e)*Kc(n)),[i/r,a-Kc(r)*_c(e*e+n*n)]},i}var nf=function(){return Vh(tf).scale(131.154).center([0,13.9389])},rf=1.340264,af=-.081106,of=893e-6,sf=.003796,uf=_c(3)/2;function cf(e,t){var n=Uc(uf*zc(t)),r=n*n,a=r*r*r;return[e*Ec(n)/(uf*(rf+3*af*r+a*(7*of+9*sf*r))),n*(rf+af*r+a*(of+sf*r))]}cf.invert=function(e,t){for(var n,r=t,a=r*r,i=a*a*a,o=0;o<12&&(i=(a=(r-=n=(r*(rf+af*a+i*(of+sf*a))-t)/(rf+3*af*a+i*(7*of+9*sf*a)))*r)*a*a,!(Mc(n)<kc));++o);return[uf*e*(rf+3*af*a+i*(7*of+9*sf*a))/Ec(r),Uc(zc(r)/uf)]};var lf=function(){return Fh(cf).scale(177.158)};function gf(e,t){var n=Ec(t),r=Ec(e)*n;return[n*zc(e)/r,zc(t)/r]}gf.invert=Hh(Vc);var df=function(){return Fh(gf).scale(144.049).clipAngle(60)},hf=function(){var e,t,n,r,a,i,o,s=1,u=0,c=0,l=1,g=1,d=0,h=null,f=1,p=1,I=wh({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),C=Gd;function m(){return f=s*l,p=s*g,i=o=null,b}function b(n){var r=n[0]*f,a=n[1]*p;if(d){var i=a*e-r*t;r=r*e+a*t,a=i}return[r+u,a+c]}return b.invert=function(n){var r=n[0]-u,a=n[1]-c;if(d){var i=a*e+r*t;r=r*e-a*t,a=i}return[r/f,a/p]},b.stream=function(e){return i&&o===e?i:i=I(C(o=e))},b.postclip=function(e){return arguments.length?(C=e,h=n=r=a=null,m()):C},b.clipExtent=function(e){return arguments.length?(C=null==e?(h=n=r=a=null,Gd):_g(h=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),m()):null==h?null:[[h,n],[r,a]]},b.scale=function(e){return arguments.length?(s=+e,m()):s},b.translate=function(e){return arguments.length?(u=+e[0],c=+e[1],m()):[u,c]},b.angle=function(n){return arguments.length?(t=zc(d=n%360*Fc),e=Ec(d),m()):d*Wc},b.reflectX=function(e){return arguments.length?(l=e?-1:1,m()):l<0},b.reflectY=function(e){return arguments.length?(g=e?-1:1,m()):g<0},b.fitExtent=function(e,t){return xh(b,e,t)},b.fitSize=function(e,t){return Sh(b,e,t)},b.fitWidth=function(e,t){return kh(b,e,t)},b.fitHeight=function(e,t){return Zh(b,e,t)},b};function ff(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}ff.invert=function(e,t){var n,r=t,a=25;do{var i=r*r,o=i*i;r-=n=(r*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-t)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o)))}while(Mc(n)>Sc&&--a>0);return[e/(.8707+(i=r*r)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),r]};var pf=function(){return Fh(ff).scale(175.295)};function If(e,t){return[Ec(t)*zc(e),zc(t)]}If.invert=Hh(Uc);var Cf=function(){return Fh(If).scale(249.5).clipAngle(90.000001)};function mf(e,t){var n=Ec(t),r=1+Ec(e)*n;return[n*zc(e)/r,zc(t)/r]}mf.invert=Hh((function(e){return 2*Vc(e)}));var bf=function(){return Fh(mf).scale(250).clipAngle(142)};function vf(e,t){return[Hc(Dc((Rc+t)/2)),-e]}vf.invert=function(e,t){return[-t,2*Vc(Lc(e))-Rc]};var Af=function(){var e=Uh(vf),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)};function yf(e,t){return e.parent===t.parent?1:2}function wf(e,t){return e+t.x}function Gf(e,t){return Math.max(e,t.y)}var Bf=function(){var e=yf,t=1,n=1,r=!1;function a(a){var i,o=0;a.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(wf,0)/e.length}(n),t.y=function(e){return 1+e.reduce(Gf,0)}(n)):(t.x=i?o+=e(t,i):0,t.y=0,i=t)}));var s=function(e){for(var t;t=e.children;)e=t[0];return e}(a),u=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(a),c=s.x-e(s,u)/2,l=u.x+e(u,s)/2;return a.eachAfter(r?function(e){e.x=(e.x-a.x)*t,e.y=(a.y-e.y)*n}:function(e){e.x=(e.x-c)/(l-c)*t,e.y=(1-(a.y?e.y/a.y:1))*n})}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a};function xf(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}var Sf=s.a.mark(kf);function kf(){var e,t,n,r,a,i;return s.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=[e=this];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){o.next=8;break}return o.next=5,e;case 5:if(r=e.children)for(a=0,i=r.length;a<i;++a)n.push(r[a]);o.next=2;break;case 8:if(n.length){o.next=1;break}case 9:case"end":return o.stop()}}),Sf,this)}function Zf(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=Nf)):void 0===t&&(t=Rf);for(var n,r,a,i,o,s=new Ff(e),u=[s];n=u.pop();)if((a=t(n.data))&&(o=(a=Array.from(a)).length))for(n.children=a,i=o-1;i>=0;--i)u.push(r=a[i]=new Ff(a[i])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(Wf)}function Rf(e){return e.children}function Nf(e){return Array.isArray(e)?e[1]:null}function Of(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function Wf(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Ff(e){this.data=e,this.depth=this.height=0,this.parent=null}Ff.prototype=Zf.prototype=Object(Bt.a)({constructor:Ff,count:function(){return this.eachAfter(xf)},each:function(e,t){var n,r=-1,a=Object(u.a)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.call(t,i,++r,this)}}catch(o){a.e(o)}finally{a.f()}return this},eachAfter:function(e,t){for(var n,r,a,i=this,o=[i],s=[],u=-1;i=o.pop();)if(s.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)o.push(n[r]);for(;i=s.pop();)e.call(t,i,++u,this);return this},eachBefore:function(e,t){for(var n,r,a=this,i=[a],o=-1;a=i.pop();)if(e.call(t,a,++o,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this},find:function(e,t){var n,r=-1,a=Object(u.a)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e.call(t,i,++r,this))return i}}catch(o){a.e(o)}finally{a.f()}},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)n+=r[a].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),a=null;e=n.pop(),t=r.pop();for(;e===t;)a=e,e=n.pop(),t=r.pop();return a}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var a=r.length;e!==n;)r.splice(a,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return Zf(this).eachBefore(Of)}},Symbol.iterator,kf);var Mf=function(e){for(var t,n,r=0,a=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Array.from(e))).length,i=[];r<a;)t=e[r],n&&Ef(n,t)?++r:(n=Lf(i=Vf(i,t)),r=0);return n};function Vf(e,t){var n,r;if(jf(t,e))return[t];for(n=0;n<e.length;++n)if(Tf(t,e[n])&&jf(Xf(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(Tf(Xf(e[n],e[r]),t)&&Tf(Xf(e[n],t),e[r])&&Tf(Xf(e[r],t),e[n])&&jf(Hf(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function Tf(e,t){var n=e.r-t.r,r=t.x-e.x,a=t.y-e.y;return n<0||n*n<r*r+a*a}function Ef(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function jf(e,t){for(var n=0;n<t.length;++n)if(!Ef(e,t[n]))return!1;return!0}function Lf(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return Xf(e[0],e[1]);case 3:return Hf(e[0],e[1],e[2])}var t}function Xf(e,t){var n=e.x,r=e.y,a=e.r,i=t.x,o=t.y,s=t.r,u=i-n,c=o-r,l=s-a,g=Math.sqrt(u*u+c*c);return{x:(n+i+u/g*l)/2,y:(r+o+c/g*l)/2,r:(g+a+s)/2}}function Hf(e,t,n){var r=e.x,a=e.y,i=e.r,o=t.x,s=t.y,u=t.r,c=n.x,l=n.y,g=n.r,d=r-o,h=r-c,f=a-s,p=a-l,I=u-i,C=g-i,m=r*r+a*a-i*i,b=m-o*o-s*s+u*u,v=m-c*c-l*l+g*g,A=h*f-d*p,y=(f*v-p*b)/(2*A)-r,w=(p*I-f*C)/A,G=(h*b-d*v)/(2*A)-a,B=(d*C-h*I)/A,x=w*w+B*B-1,S=2*(i+y*w+G*B),k=y*y+G*G-i*i,Z=-(x?(S+Math.sqrt(S*S-4*x*k))/(2*x):k/S);return{x:r+y+w*Z,y:a+G+B*Z,r:Z}}function Yf(e,t,n){var r,a,i,o,s=e.x-t.x,u=e.y-t.y,c=s*s+u*u;c?(a=t.r+n.r,a*=a,o=e.r+n.r,a>(o*=o)?(r=(c+o-a)/(2*c),i=Math.sqrt(Math.max(0,o/c-r*r)),n.x=e.x-r*s-i*u,n.y=e.y-r*u+i*s):(r=(c+a-o)/(2*c),i=Math.sqrt(Math.max(0,a/c-r*r)),n.x=t.x+r*s-i*u,n.y=t.y+r*u+i*s)):(n.x=t.x+n.r,n.y=t.y)}function zf(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function Kf(e){var t=e._,n=e.next._,r=t.r+n.r,a=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return a*a+i*i}function _f(e){this._=e,this.next=null,this.previous=null}function Df(e){if(!(i=(t=e,e="object"===typeof t&&"length"in t?t:Array.from(t)).length))return 0;var t,n,r,a,i,o,s,u,c,l,g,d;if((n=e[0]).x=0,n.y=0,!(i>1))return n.r;if(r=e[1],n.x=-r.r,r.x=n.r,r.y=0,!(i>2))return n.r+r.r;Yf(r,n,a=e[2]),n=new _f(n),r=new _f(r),a=new _f(a),n.next=a.previous=r,r.next=n.previous=a,a.next=r.previous=n;e:for(u=3;u<i;++u){Yf(n._,r._,a=e[u]),a=new _f(a),c=r.next,l=n.previous,g=r._.r,d=n._.r;do{if(g<=d){if(zf(c._,a._)){r=c,n.next=r,r.previous=n,--u;continue e}g+=c._.r,c=c.next}else{if(zf(l._,a._)){(n=l).next=r,r.previous=n,--u;continue e}d+=l._.r,l=l.previous}}while(c!==l.next);for(a.previous=n,a.next=r,n.next=r.previous=r=a,o=Kf(n);(a=a.next)!==r;)(s=Kf(a))<o&&(n=a,o=s);r=n.next}for(n=[r._],a=r;(a=a.next)!==r;)n.push(a._);for(a=Mf(n),u=0;u<i;++u)(n=e[u]).x-=a.x,n.y-=a.y;return a.r}var Pf=function(e){return Df(e),e};function Uf(e){return null==e?null:Jf(e)}function Jf(e){if("function"!==typeof e)throw new Error;return e}function Qf(){return 0}var qf=function(e){return function(){return e}};function $f(e){return Math.sqrt(e.value)}var ep=function(){var e=null,t=1,n=1,r=Qf;function a(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(tp(e)).eachAfter(np(r,.5)).eachBefore(rp(1)):a.eachBefore(tp($f)).eachAfter(np(Qf,1)).eachAfter(np(r,a.r/Math.min(t,n))).eachBefore(rp(Math.min(t,n)/(2*a.r))),a}return a.radius=function(t){return arguments.length?(e=Uf(t),a):e},a.size=function(e){return arguments.length?(t=+e[0],n=+e[1],a):[t,n]},a.padding=function(e){return arguments.length?(r="function"===typeof e?e:qf(+e),a):r},a};function tp(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function np(e,t){return function(n){if(r=n.children){var r,a,i,o=r.length,s=e(n)*t||0;if(s)for(a=0;a<o;++a)r[a].r+=s;if(i=Df(r),s)for(a=0;a<o;++a)r[a].r-=s;n.r=i+s}}}function rp(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}var ap=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},ip=function(e,t,n,r,a){for(var i,o=e.children,s=-1,u=o.length,c=e.value&&(r-t)/e.value;++s<u;)(i=o[s]).y0=n,i.y1=a,i.x0=t,i.x1=t+=i.value*c},op=function(){var e=1,t=1,n=0,r=!1;function a(a){var i=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/i,a.eachBefore(function(e,t){return function(r){r.children&&ip(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var a=r.x0,i=r.y0,o=r.x1-n,s=r.y1-n;o<a&&(a=o=(a+o)/2),s<i&&(i=s=(i+s)/2),r.x0=a,r.y0=i,r.x1=o,r.y1=s}}(t,i)),r&&a.eachBefore(ap),a}return a.round=function(e){return arguments.length?(r=!!e,a):r},a.size=function(n){return arguments.length?(e=+n[0],t=+n[1],a):[e,t]},a.padding=function(e){return arguments.length?(n=+e,a):n},a},sp={depth:-1},up={};function cp(e){return e.id}function lp(e){return e.parentId}var gp=function(){var e=cp,t=lp;function n(n){var r,a,i,o,s,u,c,l=Array.from(n),g=l.length,d=new Map;for(a=0;a<g;++a)r=l[a],s=l[a]=new Ff(r),null!=(u=e(r,a,n))&&(u+="")&&(c=s.id=u,d.set(c,d.has(c)?up:s)),null!=(u=t(r,a,n))&&(u+="")&&(s.parent=u);for(a=0;a<g;++a)if(u=(s=l[a]).parent){if(!(o=d.get(u)))throw new Error("missing: "+u);if(o===up)throw new Error("ambiguous: "+u);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(i)throw new Error("multiple roots");i=s}if(!i)throw new Error("no root");if(i.parent=sp,i.eachBefore((function(e){e.depth=e.parent.depth+1,--g})).eachBefore(Wf),i.parent=null,g>0)throw new Error("cycle");return i}return n.id=function(t){return arguments.length?(e=Jf(t),n):e},n.parentId=function(e){return arguments.length?(t=Jf(e),n):t},n};function dp(e,t){return e.parent===t.parent?1:2}function hp(e){var t=e.children;return t?t[0]:e.t}function fp(e){var t=e.children;return t?t[t.length-1]:e.t}function pp(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Ip(e,t,n){return e.a.parent===t.parent?e.a:n}function Cp(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Cp.prototype=Object.create(Ff.prototype);var mp=function(){var e=dp,t=1,n=1,r=null;function a(a){var u=function(e){for(var t,n,r,a,i,o=new Cp(e,0),s=[o];t=s.pop();)if(r=t._.children)for(t.children=new Array(i=r.length),a=i-1;a>=0;--a)s.push(n=t.children[a]=new Cp(r[a],a)),n.parent=t;return(o.parent=new Cp(null,0)).children=[o],o}(a);if(u.eachAfter(i),u.parent.m=-u.z,u.eachBefore(o),r)a.eachBefore(s);else{var c=a,l=a,g=a;a.eachBefore((function(e){e.x<c.x&&(c=e),e.x>l.x&&(l=e),e.depth>g.depth&&(g=e)}));var d=c===l?1:e(c,l)/2,h=d-c.x,f=t/(l.x+d+h),p=n/(g.depth||1);a.eachBefore((function(e){e.x=(e.x+h)*f,e.y=e.depth*p}))}return a}function i(t){var n=t.children,r=t.parent.children,a=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,a=e.children,i=a.length;--i>=0;)(t=a[i]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;a?(t.z=a.z+e(t._,a._),t.m=t.z-i):t.z=i}else a&&(t.z=a.z+e(t._,a._));t.parent.A=function(t,n,r){if(n){for(var a,i=t,o=t,s=n,u=i.parent.children[0],c=i.m,l=o.m,g=s.m,d=u.m;s=fp(s),i=hp(i),s&&i;)u=hp(u),(o=fp(o)).a=t,(a=s.z+g-i.z-c+e(s._,i._))>0&&(pp(Ip(s,t,r),t,a),c+=a,l+=a),g+=s.m,c+=i.m,d+=u.m,l+=o.m;s&&!fp(o)&&(o.t=s,o.m+=g-l),i&&!hp(u)&&(u.t=i,u.m+=c-d,r=t)}return r}(t,a,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function s(e){e.x*=t,e.y=e.depth*n}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a},bp=function(e,t,n,r,a){for(var i,o=e.children,s=-1,u=o.length,c=e.value&&(a-n)/e.value;++s<u;)(i=o[s]).x0=t,i.x1=r,i.y0=n,i.y1=n+=i.value*c},vp=(1+Math.sqrt(5))/2;function Ap(e,t,n,r,a,i){for(var o,s,u,c,l,g,d,h,f,p,I,C=[],m=t.children,b=0,v=0,A=m.length,y=t.value;b<A;){u=a-n,c=i-r;do{l=m[v++].value}while(!l&&v<A);for(g=d=l,I=l*l*(p=Math.max(c/u,u/c)/(y*e)),f=Math.max(d/I,I/g);v<A;++v){if(l+=s=m[v].value,s<g&&(g=s),s>d&&(d=s),I=l*l*p,(h=Math.max(d/I,I/g))>f){l-=s;break}f=h}C.push(o={value:l,dice:u<c,children:m.slice(b,v)}),o.dice?ip(o,n,r,a,y?r+=c*l/y:i):bp(o,n,r,y?n+=u*l/y:a,i),y-=l,b=v}return C}var yp=function e(t){function n(e,n,r,a,i){Ap(t,e,n,r,a,i)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(vp),wp=function(){var e=yp,t=!1,n=1,r=1,a=[0],i=Qf,o=Qf,s=Qf,u=Qf,c=Qf;function l(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(g),a=[0],t&&e.eachBefore(ap),e}function g(t){var n=a[t.depth],r=t.x0+n,l=t.y0+n,g=t.x1-n,d=t.y1-n;g<r&&(r=g=(r+g)/2),d<l&&(l=d=(l+d)/2),t.x0=r,t.y0=l,t.x1=g,t.y1=d,t.children&&(n=a[t.depth+1]=i(t)/2,r+=c(t)-n,l+=o(t)-n,(g-=s(t)-n)<r&&(r=g=(r+g)/2),(d-=u(t)-n)<l&&(l=d=(l+d)/2),e(t,r,l,g,d))}return l.round=function(e){return arguments.length?(t=!!e,l):t},l.size=function(e){return arguments.length?(n=+e[0],r=+e[1],l):[n,r]},l.tile=function(t){return arguments.length?(e=Jf(t),l):e},l.padding=function(e){return arguments.length?l.paddingInner(e).paddingOuter(e):l.paddingInner()},l.paddingInner=function(e){return arguments.length?(i="function"===typeof e?e:qf(+e),l):i},l.paddingOuter=function(e){return arguments.length?l.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):l.paddingTop()},l.paddingTop=function(e){return arguments.length?(o="function"===typeof e?e:qf(+e),l):o},l.paddingRight=function(e){return arguments.length?(s="function"===typeof e?e:qf(+e),l):s},l.paddingBottom=function(e){return arguments.length?(u="function"===typeof e?e:qf(+e),l):u},l.paddingLeft=function(e){return arguments.length?(c="function"===typeof e?e:qf(+e),l):c},l},Gp=function(e,t,n,r,a){var i,o,s=e.children,u=s.length,c=new Array(u+1);for(c[0]=o=i=0;i<u;++i)c[i+1]=o+=s[i].value;!function e(t,n,r,a,i,o,u){if(t>=n-1){var l=s[t];return l.x0=a,l.y0=i,l.x1=o,void(l.y1=u)}var g=c[t],d=r/2+g,h=t+1,f=n-1;for(;h<f;){var p=h+f>>>1;c[p]<d?h=p+1:f=p}d-c[h-1]<c[h]-d&&t+1<h&&--h;var I=c[h]-g,C=r-I;if(o-a>u-i){var m=r?(a*C+o*I)/r:o;e(t,h,I,a,i,m,u),e(h,n,C,m,i,o,u)}else{var b=r?(i*C+u*I)/r:u;e(t,h,I,a,i,o,b),e(h,n,C,a,b,o,u)}}(0,u,e.value,t,n,r,a)},Bp=function(e,t,n,r,a){(1&e.depth?bp:ip)(e,t,n,r,a)},xp=function e(t){function n(e,n,r,a,i){if((o=e._squarify)&&o.ratio===t)for(var o,s,u,c,l,g=-1,d=o.length,h=e.value;++g<d;){for(u=(s=o[g]).children,c=s.value=0,l=u.length;c<l;++c)s.value+=u[c].value;s.dice?ip(s,n,r,a,h?r+=(i-r)*s.value/h:i):bp(s,n,r,h?n+=(a-n)*s.value/h:a,i),h-=s.value}else e._squarify=o=Ap(t,e,n,r,a,i),o.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(vp),Sp=function(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}},kp=function(e,t){var n=Nr(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}},Zp=function(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}};function Rp(e){return((e=Math.exp(e))+1/e)/2}var Np=function e(t,n,r){function a(e,a){var i,o,s=e[0],u=e[1],c=e[2],l=a[0],g=a[1],d=a[2],h=l-s,f=g-u,p=h*h+f*f;if(p<1e-12)o=Math.log(d/c)/t,i=function(e){return[s+e*h,u+e*f,c*Math.exp(t*e*o)]};else{var I=Math.sqrt(p),C=(d*d-c*c+r*p)/(2*c*n*I),m=(d*d-c*c-r*p)/(2*d*n*I),b=Math.log(Math.sqrt(C*C+1)-C),v=Math.log(Math.sqrt(m*m+1)-m);o=(v-b)/t,i=function(e){var r,a=e*o,i=Rp(b),l=c/(n*I)*(i*(r=t*a+b,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+l*h,u+l*f,c*i/Rp(t*a+b)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function Op(e){return function(t,n){var r=e((t=wr(t)).h,(n=wr(n)).h),a=Wr(t.s,n.s),i=Wr(t.l,n.l),o=Wr(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var Wp=Op(Nr),Fp=Op(Wr);function Mp(e,t){var n=Wr((e=Oo(e)).l,(t=Oo(t)).l),r=Wr(e.a,t.a),a=Wr(e.b,t.b),i=Wr(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function Vp(e){return function(t,n){var r=e((t=Lo(t)).h,(n=Lo(n)).h),a=Wr(t.c,n.c),i=Wr(t.l,n.l),o=Wr(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var Tp=Vp(Nr),Ep=Vp(Wr);function jp(e){return function t(n){function r(t,r){var a=e((t=qo(t)).h,(r=qo(r)).h),i=Wr(t.s,r.s),o=Wr(t.l,r.l),s=Wr(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}var Lp=jp(Nr),Xp=jp(Wr);function Hp(e,t){void 0===t&&(t=e,e=Jr);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}var Yp=function(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n},zp=function(e){for(var t,n=-1,r=e.length,a=e[r-1],i=0;++n<r;)t=a,a=e[n],i+=t[1]*a[0]-t[0]*a[1];return i/2},Kp=function(e){for(var t,n,r=-1,a=e.length,i=0,o=0,s=e[a-1],u=0;++r<a;)t=s,s=e[r],u+=n=t[0]*s[1]-s[0]*t[1],i+=(t[0]+s[0])*n,o+=(t[1]+s[1])*n;return[i/(u*=3),o/u]};function _p(e,t){return e[0]-t[0]||e[1]-t[1]}function Dp(e){var t,n,r,a,i=e.length,o=[0,1],s=2;for(t=2;t<i;++t){for(;s>1&&(n=e[o[s-2]],r=e[o[s-1]],a=e[t],(r[0]-n[0])*(a[1]-n[1])-(r[1]-n[1])*(a[0]-n[0])<=0);)--s;o[s++]=t}return o.slice(0,s)}var Pp=function(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),a=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort(_p),t=0;t<n;++t)a[t]=[r[t][0],-r[t][1]];var i=Dp(r),o=Dp(a),s=o[0]===i[0],u=o[o.length-1]===i[i.length-1],c=[];for(t=i.length-1;t>=0;--t)c.push(e[r[i[t]][2]]);for(t=+s;t<o.length-u;++t)c.push(e[r[o[t]][2]]);return c},Up=function(e,t){for(var n,r,a=e.length,i=e[a-1],o=t[0],s=t[1],u=i[0],c=i[1],l=!1,g=0;g<a;++g)n=(i=e[g])[0],(r=i[1])>s!==c>s&&o<(u-n)*(s-r)/(c-r)+n&&(l=!l),u=n,c=r;return l},Jp=function(e){for(var t,n,r=-1,a=e.length,i=e[a-1],o=i[0],s=i[1],u=0;++r<a;)t=o,n=s,t-=o=(i=e[r])[0],n-=s=i[1],u+=Math.hypot(t,n);return u},Qp=Math.random,qp=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,1===arguments.length?(n=e,e=0):n-=e,function(){return t()*n+e}}return n.source=e,n}(Qp),$p=function e(t){function n(e,n){return arguments.length<2&&(n=e,e=0),e=Math.floor(e),n=Math.floor(n)-e,function(){return Math.floor(t()*n+e)}}return n.source=e,n}(Qp),eI=function e(t){function n(e,n){var r,a;return e=null==e?0:+e,n=null==n?1:+n,function(){var i;if(null!=r)i=r,r=null;else do{r=2*t()-1,i=2*t()-1,a=r*r+i*i}while(!a||a>1);return e+n*i*Math.sqrt(-2*Math.log(a)/a)}}return n.source=e,n}(Qp),tI=function e(t){var n=eI.source(t);function r(){var e=n.apply(this,arguments);return function(){return Math.exp(e())}}return r.source=e,r}(Qp),nI=function e(t){function n(e){return(e=+e)<=0?function(){return 0}:function(){for(var n=0,r=e;r>1;--r)n+=t();return n+r*t()}}return n.source=e,n}(Qp),rI=function e(t){var n=nI.source(t);function r(e){if(0===(e=+e))return t;var r=n(e);return function(){return r()/e}}return r.source=e,r}(Qp),aI=function e(t){function n(e){return function(){return-Math.log1p(-t())/e}}return n.source=e,n}(Qp),iI=function e(t){function n(e){if((e=+e)<0)throw new RangeError("invalid alpha");return e=1/-e,function(){return Math.pow(1-t(),e)}}return n.source=e,n}(Qp),oI=function e(t){function n(e){if((e=+e)<0||e>1)throw new RangeError("invalid p");return function(){return Math.floor(t()+e)}}return n.source=e,n}(Qp),sI=function e(t){function n(e){if((e=+e)<0||e>1)throw new RangeError("invalid p");return 0===e?function(){return 1/0}:1===e?function(){return 1}:(e=Math.log1p(-e),function(){return 1+Math.floor(Math.log1p(-t())/e)})}return n.source=e,n}(Qp),uI=function e(t){var n=eI.source(t)();function r(e,r){if((e=+e)<0)throw new RangeError("invalid k");if(0===e)return function(){return 0};if(r=null==r?1:+r,1===e)return function(){return-Math.log1p(-t())*r};var a=(e<1?e+1:e)-1/3,i=1/(3*Math.sqrt(a)),o=e<1?function(){return Math.pow(t(),1/e)}:function(){return 1};return function(){do{do{var e=n(),s=1+i*e}while(s<=0);s*=s*s;var u=1-t()}while(u>=1-.0331*e*e*e*e&&Math.log(u)>=.5*e*e+a*(1-s+Math.log(s)));return a*s*o()*r}}return r.source=e,r}(Qp),cI=function e(t){var n=uI.source(t);function r(e,t){var r=n(e),a=n(t);return function(){var e=r();return 0===e?0:e/(e+a())}}return r.source=e,r}(Qp),lI=function e(t){var n=sI.source(t),r=cI.source(t);function a(e,t){return e=+e,(t=+t)>=1?function(){return e}:t<=0?function(){return 0}:function(){for(var a=0,i=e,o=t;i*o>16&&i*(1-o)>16;){var s=Math.floor((i+1)*o),u=r(s,i-s+1)();u<=o?(a+=s,i-=s,o=(o-u)/(1-u)):(i=s-1,o/=u)}for(var c=o<.5,l=n(c?o:1-o),g=l(),d=0;g<=i;++d)g+=l();return a+(c?d:i-d)}}return a.source=e,a}(Qp),gI=function e(t){function n(e,n,r){var a;return 0===(e=+e)?a=function(e){return-Math.log(e)}:(e=1/e,a=function(t){return Math.pow(t,e)}),n=null==n?0:+n,r=null==r?1:+r,function(){return n+r*a(-Math.log1p(-t()))}}return n.source=e,n}(Qp),dI=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,function(){return e+n*Math.tan(Math.PI*t())}}return n.source=e,n}(Qp),hI=function e(t){function n(e,n){return e=null==e?0:+e,n=null==n?1:+n,function(){var r=t();return e+n*Math.log(r/(1-r))}}return n.source=e,n}(Qp),fI=function e(t){var n=uI.source(t),r=lI.source(t);function a(e){return function(){for(var a=0,i=e;i>16;){var o=Math.floor(.875*i),s=n(o)();if(s>i)return a+r(o-1,i/s)();a+=o,i-=s}for(var u=-Math.log1p(-t()),c=0;u<=i;++c)u-=Math.log1p(-t());return a+c}}return a.source=e,a}(Qp),pI=1664525,II=1013904223,CI=1/4294967296;function mI(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random(),t=0|(0<=e&&e<1?e/CI:Math.abs(e));return function(){return CI*((t=pI*t+II|0)>>>0)}}function bI(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function vI(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}var AI=Symbol("implicit");function yI(){var e=new Map,t=[],n=[],r=AI;function a(a){var i=a+"",o=e.get(i);if(!o){if(r!==AI)return r;e.set(i,o=t.push(a))}return n[(o-1)%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;var r,i=Object(u.a)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o+"";e.has(s)||e.set(s,t.push(o))}}catch(c){i.e(c)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return yI(t,n).unknown(r)},bI.apply(a,arguments),a}function wI(){var e,t,n=yI().unknown(void 0),r=n.domain,a=n.range,i=0,o=1,s=!1,u=0,c=0,l=.5;function g(){var n=r().length,g=o<i,d=g?o:i,h=g?i:o;e=(h-d)/Math.max(1,n-u+2*c),s&&(e=Math.floor(e)),d+=(h-d-e*(n-u))*l,t=e*(1-u),s&&(d=Math.round(d),t=Math.round(t));var f=Fe(n).map((function(t){return d+e*t}));return a(g?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),g()):r()},n.range=function(e){var t,n;return arguments.length?(t=e,n=Object(F.a)(t,2),i=n[0],o=n[1],i=+i,o=+o,g()):[i,o]},n.rangeRound=function(e){var t,n;return t=e,n=Object(F.a)(t,2),i=n[0],o=n[1],i=+i,o=+o,s=!0,g()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,g()):s},n.padding=function(e){return arguments.length?(u=Math.min(1,c=+e),g()):u},n.paddingInner=function(e){return arguments.length?(u=Math.min(1,e),g()):u},n.paddingOuter=function(e){return arguments.length?(c=+e,g()):c},n.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),g()):l},n.copy=function(){return wI(r(),[i,o]).round(s).paddingInner(u).paddingOuter(c).align(l)},bI.apply(g(),arguments)}function GI(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return GI(t())},e}function BI(){return GI(wI.apply(null,arguments).paddingInner(1))}function xI(e){return+e}var SI=[0,1];function kI(e){return e}function ZI(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function RI(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=ZI(a,r),i=n(o,i)):(r=ZI(r,a),i=n(i,o)),function(e){return i(r(e))}}function NI(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=ZI(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=I(e,t,1,r)-1;return i[n](a[n](t))}}function OI(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function WI(){var e,t,n,r,a,i,o=SI,s=SI,u=Jr,c=kI;function l(){var e=Math.min(o.length,s.length);return c!==kI&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?NI:RI,a=i=null,g}function g(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),s,u)))(e(c(t)))}return g.invert=function(n){return c(t((i||(i=r(s,o.map(e),Yr)))(n)))},g.domain=function(e){return arguments.length?(o=Array.from(e,xI),l()):o.slice()},g.range=function(e){return arguments.length?(s=Array.from(e),l()):s.slice()},g.rangeRound=function(e){return s=Array.from(e),u=Zp,l()},g.clamp=function(e){return arguments.length?(c=!!e||kI,l()):c!==kI},g.interpolate=function(e){return arguments.length?(u=e,l()):u},g.unknown=function(e){return arguments.length?(n=e,g):n},function(n,r){return e=n,t=r,l()}}function FI(){return WI()(kI,kI)}function MI(e,t,n,r){var a,i=he(e,t,n);switch((r=gc(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=Bc(i,o))||(r.precision=a),Ic(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=xc(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=Gc(i))||(r.precision=a-2*("%"===r.type))}return pc(r)}function VI(e){var t=e.domain;return e.ticks=function(e){var n=t();return ge(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return MI(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,s=i.length-1,u=i[o],c=i[s],l=10;for(c<u&&(a=u,u=c,c=a,a=o,o=s,s=a);l-- >0;){if((a=de(u,c,n))===r)return i[o]=u,i[s]=c,t(i);if(a>0)u=Math.floor(u/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;u=Math.ceil(u*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function TI(){var e=FI();return e.copy=function(){return OI(e,TI())},bI.apply(e,arguments),VI(e)}function EI(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,xI),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return EI(e).unknown(t)},e=arguments.length?Array.from(e,xI):[0,1],VI(n)}function jI(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function LI(e){return Math.log(e)}function XI(e){return Math.exp(e)}function HI(e){return-Math.log(-e)}function YI(e){return-Math.exp(-e)}function zI(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KI(e){return function(t){return-e(-t)}}function _I(e){var t,n,r=e(LI,XI),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?zI:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=KI(t),n=KI(n),e(HI,YI)):e(LI,XI),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r,o=a(),s=o[0],u=o[o.length-1];(r=u<s)&&(d=s,s=u,u=d);var c,l,g,d=t(s),h=t(u),f=null==e?10:+e,p=[];if(!(i%1)&&h-d<f){if(d=Math.floor(d),h=Math.ceil(h),s>0){for(;d<=h;++d)for(l=1,c=n(d);l<i;++l)if(!((g=c*l)<s)){if(g>u)break;p.push(g)}}else for(;d<=h;++d)for(l=i-1,c=n(d);l>=1;--l)if(!((g=c*l)<s)){if(g>u)break;p.push(g)}2*p.length<f&&(p=ge(s,u,f))}else p=ge(d,h,Math.min(h-d,f)).map(n);return r?p.reverse():p},r.tickFormat=function(e,a){if(null==a&&(a=10===i?".0e":","),"function"!==typeof a&&(a=pc(a)),e===1/0)return a;null==e&&(e=10);var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(jI(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function DI(){var e=_I(WI()).domain([1,10]);return e.copy=function(){return OI(e,DI()).base(e.base())},bI.apply(e,arguments),e}function PI(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function UI(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function JI(e){var t=1,n=e(PI(t),UI(t));return n.constant=function(n){return arguments.length?e(PI(t=+n),UI(t)):t},VI(n)}function QI(){var e=JI(WI());return e.copy=function(){return OI(e,QI()).constant(e.constant())},bI.apply(e,arguments)}function qI(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $I(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function eC(e){return e<0?-e*e:e*e}function tC(e){var t=e(kI,kI),n=1;function r(){return 1===n?e(kI,kI):.5===n?e($I,eC):e(qI(n),qI(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},VI(t)}function nC(){var e=tC(WI());return e.copy=function(){return OI(e,nC()).exponent(e.exponent())},bI.apply(e,arguments),e}function rC(){return nC.apply(null,arguments).exponent(.5)}function aC(e){return Math.sign(e)*e*e}function iC(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function oC(){var e,t=FI(),n=[0,1],r=!1;function a(n){var a=iC(t(n));return isNaN(a)?e:r?Math.round(a):a}return a.invert=function(e){return t.invert(aC(e))},a.domain=function(e){return arguments.length?(t.domain(e),a):t.domain()},a.range=function(e){return arguments.length?(t.range((n=Array.from(e,xI)).map(aC)),a):n.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(r=!!e,a):r},a.clamp=function(e){return arguments.length?(t.clamp(e),a):t.clamp()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return oC(t.domain(),n).round(r).clamp(t.clamp()).unknown(e)},bI.apply(a,arguments),VI(a)}function sC(){var e,t=[],n=[],r=[];function i(){var e=0,a=Math.max(1,n.length);for(r=new Array(a-1);++e<a;)r[e-1]=ye(t,e/a);return o}function o(t){return null==t||isNaN(t=+t)?e:n[I(r,t)]}return o.invertExtent=function(e){var a=n.indexOf(e);return a<0?[NaN,NaN]:[a>0?r[a-1]:t[0],a<r.length?r[a]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];var n,r=Object(u.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;null==o||isNaN(o=+o)||t.push(o)}}catch(s){r.e(s)}finally{r.f()}return t.sort(a),i()},o.range=function(e){return arguments.length?(n=Array.from(e),i()):n.slice()},o.unknown=function(t){return arguments.length?(e=t,o):e},o.quantiles=function(){return r.slice()},o.copy=function(){return sC().domain(t).range(n).unknown(e)},bI.apply(o,arguments)}function uC(){var e,t=0,n=1,r=1,a=[.5],i=[0,1];function o(t){return null!=t&&t<=t?i[I(a,t,0,r)]:e}function s(){var e=-1;for(a=new Array(r);++e<r;)a[e]=((e+1)*n-(e-r)*t)/(r+1);return o}return o.domain=function(e){var r,a;return arguments.length?(r=e,a=Object(F.a)(r,2),t=a[0],n=a[1],t=+t,n=+n,s()):[t,n]},o.range=function(e){return arguments.length?(r=(i=Array.from(e)).length-1,s()):i.slice()},o.invertExtent=function(e){var o=i.indexOf(e);return o<0?[NaN,NaN]:o<1?[t,a[0]]:o>=r?[a[r-1],n]:[a[o-1],a[o]]},o.unknown=function(t){return arguments.length?(e=t,o):o},o.thresholds=function(){return a.slice()},o.copy=function(){return uC().domain([t,n]).range(i).unknown(e)},bI.apply(VI(o),arguments)}function cC(){var e,t=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[I(t,a,0,r)]:e}return a.domain=function(e){return arguments.length?(t=Array.from(e),r=Math.min(t.length,n.length-1),a):t.slice()},a.range=function(e){return arguments.length?(n=Array.from(e),r=Math.min(t.length,n.length-1),a):n.slice()},a.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return cC().domain(t).range(n).unknown(e)},bI.apply(a,arguments)}var lC=1e3,gC=6e4,dC=36e5,hC=864e5,fC=6048e5,pC=2592e6,IC=31536e6,CC=new Date,mC=new Date;function bC(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,s=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return s;do{s.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return s},a.filter=function(n){return bC((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return CC.setTime(+t),mC.setTime(+r),e(CC),e(mC),Math.floor(n(CC,mC))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var vC=bC((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));vC.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?bC((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):vC:null};var AC=vC,yC=vC.range,wC=bC((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*lC)}),(function(e,t){return(t-e)/lC}),(function(e){return e.getUTCSeconds()})),GC=wC,BC=wC.range,xC=bC((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*lC)}),(function(e,t){e.setTime(+e+t*gC)}),(function(e,t){return(t-e)/gC}),(function(e){return e.getMinutes()})),SC=xC,kC=xC.range,ZC=bC((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*lC-e.getMinutes()*gC)}),(function(e,t){e.setTime(+e+t*dC)}),(function(e,t){return(t-e)/dC}),(function(e){return e.getHours()})),RC=ZC,NC=ZC.range,OC=bC((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gC)/hC}),(function(e){return e.getDate()-1})),WC=OC,FC=OC.range;function MC(e){return bC((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gC)/fC}))}var VC=MC(0),TC=MC(1),EC=MC(2),jC=MC(3),LC=MC(4),XC=MC(5),HC=MC(6),YC=VC.range,zC=TC.range,KC=EC.range,_C=jC.range,DC=LC.range,PC=XC.range,UC=HC.range,JC=bC((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),QC=JC,qC=JC.range,$C=bC((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));$C.every=function(e){return isFinite(e=Math.floor(e))&&e>0?bC((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var em=$C,tm=$C.range,nm=bC((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*gC)}),(function(e,t){return(t-e)/gC}),(function(e){return e.getUTCMinutes()})),rm=nm,am=nm.range,im=bC((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*dC)}),(function(e,t){return(t-e)/dC}),(function(e){return e.getUTCHours()})),om=im,sm=im.range,um=bC((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/hC}),(function(e){return e.getUTCDate()-1})),cm=um,lm=um.range;function gm(e){return bC((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/fC}))}var dm=gm(0),hm=gm(1),fm=gm(2),pm=gm(3),Im=gm(4),Cm=gm(5),mm=gm(6),bm=dm.range,vm=hm.range,Am=fm.range,ym=pm.range,wm=Im.range,Gm=Cm.range,Bm=mm.range,xm=bC((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),Sm=xm,km=xm.range,Zm=bC((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));Zm.every=function(e){return isFinite(e=Math.floor(e))&&e>0?bC((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var Rm=Zm,Nm=Zm.range;function Om(e,t,n,r,a,o){var s=[[GC,1,lC],[GC,5,5e3],[GC,15,15e3],[GC,30,3e4],[o,1,gC],[o,5,3e5],[o,15,9e5],[o,30,18e5],[a,1,dC],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,hC],[r,2,1728e5],[n,1,fC],[t,1,pC],[t,3,7776e6],[e,1,IC]];function u(t,n,r){var a=Math.abs(n-t)/r,o=i((function(e){return Object(F.a)(e,3)[2]})).right(s,a);if(o===s.length)return e.every(he(t/IC,n/IC,r));if(0===o)return AC.every(Math.max(he(t,n,r),1));var u=Object(F.a)(s[a/s[o-1][2]<s[o][2]/a?o-1:o],2),c=u[0],l=u[1];return c.every(l)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var Wm=Om(Rm,Sm,dm,cm,om,rm),Fm=Object(F.a)(Wm,2),Mm=Fm[0],Vm=Fm[1],Tm=Om(em,QC,VC,WC,RC,SC),Em=Object(F.a)(Tm,2),jm=Em[0],Lm=Em[1];function Xm(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Hm(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ym(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function zm(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,u=e.shortMonths,c=nb(a),l=rb(a),g=nb(i),d=rb(i),h=nb(o),f=rb(o),p=nb(s),I=rb(s),C=nb(u),m=rb(u),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Gb,e:Gb,f:Zb,g:Lb,G:Hb,H:Bb,I:xb,j:Sb,L:kb,m:Rb,M:Nb,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:gv,s:dv,S:Ob,u:Wb,U:Fb,V:Vb,w:Tb,W:Eb,x:null,X:null,y:jb,Y:Xb,Z:Yb,"%":lv},v={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return u[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:zb,e:zb,f:Ub,g:ov,G:uv,H:Kb,I:_b,j:Db,L:Pb,m:Jb,M:Qb,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:gv,s:dv,S:qb,u:$b,U:ev,V:nv,w:rv,W:av,x:null,X:null,y:iv,Y:sv,Z:cv,"%":lv},A={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=C.exec(t.slice(n));return r?(e.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.m=I.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return G(e,t,n,r)},d:fb,e:fb,f:vb,g:lb,G:cb,H:Ib,I:Ib,j:pb,L:bb,m:hb,M:Cb,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:db,Q:yb,s:wb,S:mb,u:ib,U:ob,V:sb,w:ab,W:ub,x:function(e,t,r){return G(e,n,t,r)},X:function(e,t,n){return G(e,r,t,n)},y:lb,Y:cb,Z:gb,"%":Ab};function y(e,t){return function(n){var r,a,i,o=[],s=-1,u=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(o.push(e.slice(u,s)),null!=(a=Jm[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),u=s+1);return o.push(e.slice(u,s)),o.join("")}}function w(e,t){return function(n){var r,a,i=Ym(1900,void 0,1);if(G(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=Hm(Ym(i.y,0,1))).getUTCDay(),r=a>4||0===a?hm.ceil(r):hm(r),r=cm.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=Xm(Ym(i.y,0,1))).getDay(),r=a>4||0===a?TC.ceil(r):TC(r),r=WC.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?Hm(Ym(i.y,0,1)).getUTCDay():Xm(Ym(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Hm(i)):Xm(i)}}function G(e,t,n,r){for(var a,i,o=0,s=t.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=A[a in Jm?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=y(n,b),b.X=y(r,b),b.c=y(t,b),v.x=y(n,v),v.X=y(r,v),v.c=y(t,v),{format:function(e){var t=y(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=w(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=y(e+="",v);return t.toString=function(){return e},t},utcParse:function(e){var t=w(e+="",!0);return t.toString=function(){return e},t}}}var Km,_m,Dm,Pm,Um,Jm={"-":"",_:" ",0:"0"},Qm=/^\s*\d+/,qm=/^%/,$m=/[\\^$*+?|[\]().{}]/g;function eb(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function tb(e){return e.replace($m,"\\$&")}function nb(e){return new RegExp("^(?:"+e.map(tb).join("|")+")","i")}function rb(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function ab(e,t,n){var r=Qm.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ib(e,t,n){var r=Qm.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ob(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function sb(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ub(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function cb(e,t,n){var r=Qm.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function lb(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function gb(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function db(e,t,n){var r=Qm.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function hb(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function fb(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function pb(e,t,n){var r=Qm.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ib(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Cb(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function mb(e,t,n){var r=Qm.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function bb(e,t,n){var r=Qm.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function vb(e,t,n){var r=Qm.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ab(e,t,n){var r=qm.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function yb(e,t,n){var r=Qm.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function wb(e,t,n){var r=Qm.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Gb(e,t){return eb(e.getDate(),t,2)}function Bb(e,t){return eb(e.getHours(),t,2)}function xb(e,t){return eb(e.getHours()%12||12,t,2)}function Sb(e,t){return eb(1+WC.count(em(e),e),t,3)}function kb(e,t){return eb(e.getMilliseconds(),t,3)}function Zb(e,t){return kb(e,t)+"000"}function Rb(e,t){return eb(e.getMonth()+1,t,2)}function Nb(e,t){return eb(e.getMinutes(),t,2)}function Ob(e,t){return eb(e.getSeconds(),t,2)}function Wb(e){var t=e.getDay();return 0===t?7:t}function Fb(e,t){return eb(VC.count(em(e)-1,e),t,2)}function Mb(e){var t=e.getDay();return t>=4||0===t?LC(e):LC.ceil(e)}function Vb(e,t){return e=Mb(e),eb(LC.count(em(e),e)+(4===em(e).getDay()),t,2)}function Tb(e){return e.getDay()}function Eb(e,t){return eb(TC.count(em(e)-1,e),t,2)}function jb(e,t){return eb(e.getFullYear()%100,t,2)}function Lb(e,t){return eb((e=Mb(e)).getFullYear()%100,t,2)}function Xb(e,t){return eb(e.getFullYear()%1e4,t,4)}function Hb(e,t){var n=e.getDay();return eb((e=n>=4||0===n?LC(e):LC.ceil(e)).getFullYear()%1e4,t,4)}function Yb(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+eb(t/60|0,"0",2)+eb(t%60,"0",2)}function zb(e,t){return eb(e.getUTCDate(),t,2)}function Kb(e,t){return eb(e.getUTCHours(),t,2)}function _b(e,t){return eb(e.getUTCHours()%12||12,t,2)}function Db(e,t){return eb(1+cm.count(Rm(e),e),t,3)}function Pb(e,t){return eb(e.getUTCMilliseconds(),t,3)}function Ub(e,t){return Pb(e,t)+"000"}function Jb(e,t){return eb(e.getUTCMonth()+1,t,2)}function Qb(e,t){return eb(e.getUTCMinutes(),t,2)}function qb(e,t){return eb(e.getUTCSeconds(),t,2)}function $b(e){var t=e.getUTCDay();return 0===t?7:t}function ev(e,t){return eb(dm.count(Rm(e)-1,e),t,2)}function tv(e){var t=e.getUTCDay();return t>=4||0===t?Im(e):Im.ceil(e)}function nv(e,t){return e=tv(e),eb(Im.count(Rm(e),e)+(4===Rm(e).getUTCDay()),t,2)}function rv(e){return e.getUTCDay()}function av(e,t){return eb(hm.count(Rm(e)-1,e),t,2)}function iv(e,t){return eb(e.getUTCFullYear()%100,t,2)}function ov(e,t){return eb((e=tv(e)).getUTCFullYear()%100,t,2)}function sv(e,t){return eb(e.getUTCFullYear()%1e4,t,4)}function uv(e,t){var n=e.getUTCDay();return eb((e=n>=4||0===n?Im(e):Im.ceil(e)).getUTCFullYear()%1e4,t,4)}function cv(){return"+0000"}function lv(){return"%"}function gv(e){return+e}function dv(e){return Math.floor(+e/1e3)}function hv(e){return Km=zm(e),_m=Km.format,Dm=Km.parse,Pm=Km.utcFormat,Um=Km.utcParse,Km}function fv(e){return new Date(e)}function pv(e){return e instanceof Date?+e:+new Date(+e)}function Iv(e,t,n,r,a,i,o,s,u,c){var l=FI(),g=l.invert,d=l.domain,h=c(".%L"),f=c(":%S"),p=c("%I:%M"),I=c("%I %p"),C=c("%a %d"),m=c("%b %d"),b=c("%B"),v=c("%Y");function A(e){return(u(e)<e?h:s(e)<e?f:o(e)<e?p:i(e)<e?I:r(e)<e?a(e)<e?C:m:n(e)<e?b:v)(e)}return l.invert=function(e){return new Date(g(e))},l.domain=function(e){return arguments.length?d(Array.from(e,pv)):d().map(fv)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?A:c(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(jI(n,e)):l},l.copy=function(){return OI(l,Iv(e,t,n,r,a,i,o,s,u,c))},l}function Cv(){return bI.apply(Iv(jm,Lm,em,QC,VC,WC,RC,SC,GC,_m).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function mv(){return bI.apply(Iv(Mm,Vm,Rm,Sm,dm,cm,om,rm,GC,Pm).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function bv(){var e,t,n,r,a,i=0,o=1,s=kI,u=!1;function c(t){return null==t||isNaN(t=+t)?a:s(0===n?.5:(t=(r(t)-e)*n,u?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a,i;return arguments.length?(n=t,a=(r=Object(F.a)(n,2))[0],i=r[1],s=e(a,i),c):[s(0),s(1)]}}return c.domain=function(a){var s,u;return arguments.length?(s=a,u=Object(F.a)(s,2),i=u[0],o=u[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(u=!!e,c):u},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=l(Jr),c.rangeRound=l(Zp),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function vv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Av(){var e=VI(bv()(kI));return e.copy=function(){return vv(e,Av())},vI.apply(e,arguments)}function yv(){var e=_I(bv()).domain([1,10]);return e.copy=function(){return vv(e,yv()).base(e.base())},vI.apply(e,arguments)}function wv(){var e=JI(bv());return e.copy=function(){return vv(e,wv()).constant(e.constant())},vI.apply(e,arguments)}function Gv(){var e=tC(bv());return e.copy=function(){return vv(e,Gv()).exponent(e.exponent())},vI.apply(e,arguments)}function Bv(){return Gv.apply(null,arguments).exponent(.5)}function xv(){var e=[],t=kI;function n(n){if(null!=n&&!isNaN(n=+n))return t((I(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];var r,i=Object(u.a)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;null==o||isNaN(o=+o)||e.push(o)}}catch(s){i.e(s)}finally{i.f()}return e.sort(a),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((function(n,r){return t(r/(e.length-1))}))},n.quantiles=function(t){return Array.from({length:t+1},(function(n,r){return Ae(e,r/t)}))},n.copy=function(){return xv(t).domain(e)},vI.apply(n,arguments)}function Sv(){var e,t,n,r,a,i,o,s=0,u=.5,c=1,l=1,g=kI,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),g(d?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,a,i,o;return arguments.length?(n=t,a=(r=Object(F.a)(n,3))[0],i=r[1],o=r[2],g=Hp(e,[a,i,o]),h):[g(0),g(.5),g(1)]}}return h.domain=function(o){var g,d;return arguments.length?(g=o,d=Object(F.a)(g,3),s=d[0],u=d[1],c=d[2],e=i(s=+s),t=i(u=+u),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[s,u,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(g=e,h):g},h.range=f(Jr),h.rangeRound=f(Zp),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(s),t=o(u),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function kv(){var e=VI(Sv()(kI));return e.copy=function(){return vv(e,kv())},vI.apply(e,arguments)}function Zv(){var e=_I(Sv()).domain([.1,1,10]);return e.copy=function(){return vv(e,Zv()).base(e.base())},vI.apply(e,arguments)}function Rv(){var e=JI(Sv());return e.copy=function(){return vv(e,Rv()).constant(e.constant())},vI.apply(e,arguments)}function Nv(){var e=tC(Sv());return e.copy=function(){return vv(e,Nv()).exponent(e.exponent())},vI.apply(e,arguments)}function Ov(){return Nv.apply(null,arguments).exponent(.5)}hv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Wv=function(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n},Fv=Wv("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Mv=Wv("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Vv=Wv("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Tv=Wv("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Ev=Wv("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),jv=Wv("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Lv=Wv("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Xv=Wv("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Hv=Wv("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),Yv=Wv("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),zv=function(e){return Vr(e[e.length-1])},Kv=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Wv),_v=zv(Kv),Dv=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Wv),Pv=zv(Dv),Uv=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Wv),Jv=zv(Uv),Qv=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Wv),qv=zv(Qv),$v=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Wv),eA=zv($v),tA=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Wv),nA=zv(tA),rA=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Wv),aA=zv(rA),iA=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Wv),oA=zv(iA),sA=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Wv),uA=zv(sA),cA=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Wv),lA=zv(cA),gA=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Wv),dA=zv(gA),hA=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Wv),fA=zv(hA),pA=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Wv),IA=zv(pA),CA=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Wv),mA=zv(CA),bA=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Wv),vA=zv(bA),AA=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Wv),yA=zv(AA),wA=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Wv),GA=zv(wA),BA=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Wv),xA=zv(BA),SA=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Wv),kA=zv(SA),ZA=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Wv),RA=zv(ZA),NA=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Wv),OA=zv(NA),WA=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Wv),FA=zv(WA),MA=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Wv),VA=zv(MA),TA=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Wv),EA=zv(TA),jA=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Wv),LA=zv(jA),XA=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Wv),HA=zv(XA),YA=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Wv),zA=zv(YA),KA=function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-2710.57*e)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-67.37*e)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-2475.67*e)))))))+")"},_A=Xp(qo(300,.5,0),qo(-240,.5,1)),DA=Xp(qo(-100,.75,.35),qo(80,1.5,.8)),PA=Xp(qo(260,.75,.35),qo(80,1.5,.8)),UA=qo(),JA=function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return UA.h=360*e-100,UA.s=1.5-1.5*t,UA.l=.8-.9*t,UA+""},QA=Ir(),qA=Math.PI/3,$A=2*Math.PI/3,ey=function(e){var t;return e=(.5-e)*Math.PI,QA.r=255*(t=Math.sin(e))*t,QA.g=255*(t=Math.sin(e+qA))*t,QA.b=255*(t=Math.sin(e+$A))*t,QA+""},ty=function(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-14825.05*e)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+707.56*e)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-6838.66*e)))))))+")"};function ny(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var ry=ny(Wv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ay=ny(Wv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),iy=ny(Wv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),oy=ny(Wv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),sy=function(e){return Yn(xn(e).call(document.documentElement))},uy=0;function cy(){return new ly}function ly(){this._="@"+(++uy).toString(36)}ly.prototype=cy.prototype={constructor:ly,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var gy=function(e,t){return e.target&&(e=Qr(e),void 0===t&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,(function(e){return qr(e,t)}))},dy=function(e){return"string"===typeof e?new Ln([document.querySelectorAll(e)],[document.documentElement]):new Ln([null==e?[]:kt(e)],jn)},hy=function(e){return function(){return e}},fy=Math.abs,py=Math.atan2,Iy=Math.cos,Cy=Math.max,my=Math.min,by=Math.sin,vy=Math.sqrt,Ay=1e-12,yy=Math.PI,wy=yy/2,Gy=2*yy;function By(e){return e>1?0:e<-1?yy:Math.acos(e)}function xy(e){return e>=1?wy:e<=-1?-wy:Math.asin(e)}function Sy(e){return e.innerRadius}function ky(e){return e.outerRadius}function Zy(e){return e.startAngle}function Ry(e){return e.endAngle}function Ny(e){return e&&e.padAngle}function Oy(e,t,n,r,a,i,o,s){var u=n-e,c=r-t,l=o-a,g=s-i,d=g*u-l*c;if(!(d*d<Ay))return[e+(d=(l*(t-i)-g*(e-a))/d)*u,t+d*c]}function Wy(e,t,n,r,a,i,o){var s=e-n,u=t-r,c=(o?i:-i)/vy(s*s+u*u),l=c*u,g=-c*s,d=e+l,h=t+g,f=n+l,p=r+g,I=(d+f)/2,C=(h+p)/2,m=f-d,b=p-h,v=m*m+b*b,A=a-i,y=d*p-f*h,w=(b<0?-1:1)*vy(Cy(0,A*A*v-y*y)),G=(y*b-m*w)/v,B=(-y*m-b*w)/v,x=(y*b+m*w)/v,S=(-y*m+b*w)/v,k=G-I,Z=B-C,R=x-I,N=S-C;return k*k+Z*Z>R*R+N*N&&(G=x,B=S),{cx:G,cy:B,x01:-l,y01:-g,x11:G*(a/A-1),y11:B*(a/A-1)}}var Fy=function(){var e=Sy,t=ky,n=hy(0),r=null,a=Zy,i=Ry,o=Ny,s=null;function u(){var u,c,l=+e.apply(this,arguments),g=+t.apply(this,arguments),d=a.apply(this,arguments)-wy,h=i.apply(this,arguments)-wy,f=fy(h-d),p=h>d;if(s||(s=u=co()),g<l&&(c=g,g=l,l=c),g>Ay)if(f>Gy-Ay)s.moveTo(g*Iy(d),g*by(d)),s.arc(0,0,g,d,h,!p),l>Ay&&(s.moveTo(l*Iy(h),l*by(h)),s.arc(0,0,l,h,d,p));else{var I,C,m=d,b=h,v=d,A=h,y=f,w=f,G=o.apply(this,arguments)/2,B=G>Ay&&(r?+r.apply(this,arguments):vy(l*l+g*g)),x=my(fy(g-l)/2,+n.apply(this,arguments)),S=x,k=x;if(B>Ay){var Z=xy(B/l*by(G)),R=xy(B/g*by(G));(y-=2*Z)>Ay?(v+=Z*=p?1:-1,A-=Z):(y=0,v=A=(d+h)/2),(w-=2*R)>Ay?(m+=R*=p?1:-1,b-=R):(w=0,m=b=(d+h)/2)}var N=g*Iy(m),O=g*by(m),W=l*Iy(A),F=l*by(A);if(x>Ay){var M,V=g*Iy(b),T=g*by(b),E=l*Iy(v),j=l*by(v);if(f<yy&&(M=Oy(N,O,E,j,V,T,W,F))){var L=N-M[0],X=O-M[1],H=V-M[0],Y=T-M[1],z=1/by(By((L*H+X*Y)/(vy(L*L+X*X)*vy(H*H+Y*Y)))/2),K=vy(M[0]*M[0]+M[1]*M[1]);S=my(x,(l-K)/(z-1)),k=my(x,(g-K)/(z+1))}}w>Ay?k>Ay?(I=Wy(E,j,N,O,g,k,p),C=Wy(V,T,W,F,g,k,p),s.moveTo(I.cx+I.x01,I.cy+I.y01),k<x?s.arc(I.cx,I.cy,k,py(I.y01,I.x01),py(C.y01,C.x01),!p):(s.arc(I.cx,I.cy,k,py(I.y01,I.x01),py(I.y11,I.x11),!p),s.arc(0,0,g,py(I.cy+I.y11,I.cx+I.x11),py(C.cy+C.y11,C.cx+C.x11),!p),s.arc(C.cx,C.cy,k,py(C.y11,C.x11),py(C.y01,C.x01),!p))):(s.moveTo(N,O),s.arc(0,0,g,m,b,!p)):s.moveTo(N,O),l>Ay&&y>Ay?S>Ay?(I=Wy(W,F,V,T,l,-S,p),C=Wy(N,O,E,j,l,-S,p),s.lineTo(I.cx+I.x01,I.cy+I.y01),S<x?s.arc(I.cx,I.cy,S,py(I.y01,I.x01),py(C.y01,C.x01),!p):(s.arc(I.cx,I.cy,S,py(I.y01,I.x01),py(I.y11,I.x11),!p),s.arc(0,0,l,py(I.cy+I.y11,I.cx+I.x11),py(C.cy+C.y11,C.cx+C.x11),p),s.arc(C.cx,C.cy,S,py(C.y11,C.x11),py(C.y01,C.x01),!p))):s.arc(0,0,l,A,v,p):s.lineTo(W,F)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-yy/2;return[Iy(r)*n,by(r)*n]},u.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:hy(+t),u):e},u.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:hy(+e),u):t},u.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:hy(+e),u):n},u.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:hy(+e),u):r},u.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:hy(+e),u):a},u.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:hy(+e),u):i},u.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:hy(+e),u):o},u.context=function(e){return arguments.length?(s=null==e?null:e,u):s},u},My=Array.prototype.slice,Vy=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)};function Ty(e){this._context=e}Ty.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Ey=function(e){return new Ty(e)};function jy(e){return e[0]}function Ly(e){return e[1]}var Xy=function(e,t){var n=hy(!0),r=null,a=Ey,i=null;function o(o){var s,u,c,l=(o=Vy(o)).length,g=!1;for(null==r&&(i=a(c=co())),s=0;s<=l;++s)!(s<l&&n(u=o[s],s,o))===g&&((g=!g)?i.lineStart():i.lineEnd()),g&&i.point(+e(u,s,o),+t(u,s,o));if(c)return i=null,c+""||null}return e="function"===typeof e?e:void 0===e?jy:hy(e),t="function"===typeof t?t:void 0===t?Ly:hy(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:hy(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:hy(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:hy(!!e),o):n},o.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),o):r},o},Hy=function(e,t,n){var r=null,a=hy(!0),i=null,o=Ey,s=null;function u(u){var c,l,g,d,h,f=(u=Vy(u)).length,p=!1,I=new Array(f),C=new Array(f);for(null==i&&(s=o(h=co())),c=0;c<=f;++c){if(!(c<f&&a(d=u[c],c,u))===p)if(p=!p)l=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),g=c-1;g>=l;--g)s.point(I[g],C[g]);s.lineEnd(),s.areaEnd()}p&&(I[c]=+e(d,c,u),C[c]=+t(d,c,u),s.point(r?+r(d,c,u):I[c],n?+n(d,c,u):C[c]))}if(h)return s=null,h+""||null}function c(){return Xy().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?jy:hy(+e),t="function"===typeof t?t:hy(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?Ly:hy(+n),u.x=function(t){return arguments.length?(e="function"===typeof t?t:hy(+t),r=null,u):e},u.x0=function(t){return arguments.length?(e="function"===typeof t?t:hy(+t),u):e},u.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:hy(+e),u):r},u.y=function(e){return arguments.length?(t="function"===typeof e?e:hy(+e),n=null,u):t},u.y0=function(e){return arguments.length?(t="function"===typeof e?e:hy(+e),u):t},u.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:hy(+e),u):n},u.lineX0=u.lineY0=function(){return c().x(e).y(t)},u.lineY1=function(){return c().x(e).y(n)},u.lineX1=function(){return c().x(r).y(t)},u.defined=function(e){return arguments.length?(a="function"===typeof e?e:hy(!!e),u):a},u.curve=function(e){return arguments.length?(o=e,null!=i&&(s=o(i)),u):o},u.context=function(e){return arguments.length?(null==e?i=s=null:s=o(i=e),u):i},u},Yy=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},zy=function(e){return e},Ky=function(){var e=zy,t=Yy,n=null,r=hy(0),a=hy(Gy),i=hy(0);function o(o){var s,u,c,l,g,d=(o=Vy(o)).length,h=0,f=new Array(d),p=new Array(d),I=+r.apply(this,arguments),C=Math.min(Gy,Math.max(-Gy,a.apply(this,arguments)-I)),m=Math.min(Math.abs(C)/d,i.apply(this,arguments)),b=m*(C<0?-1:1);for(s=0;s<d;++s)(g=p[f[s]=s]=+e(o[s],s,o))>0&&(h+=g);for(null!=t?f.sort((function(e,n){return t(p[e],p[n])})):null!=n&&f.sort((function(e,t){return n(o[e],o[t])})),s=0,c=h?(C-d*b)/h:0;s<d;++s,I=l)u=f[s],l=I+((g=p[u])>0?g*c:0)+b,p[u]={data:o[u],index:s,value:g,startAngle:I,endAngle:l,padAngle:m};return p}return o.value=function(t){return arguments.length?(e="function"===typeof t?t:hy(+t),o):e},o.sortValues=function(e){return arguments.length?(t=e,n=null,o):t},o.sort=function(e){return arguments.length?(n=e,t=null,o):n},o.startAngle=function(e){return arguments.length?(r="function"===typeof e?e:hy(+e),o):r},o.endAngle=function(e){return arguments.length?(a="function"===typeof e?e:hy(+e),o):a},o.padAngle=function(e){return arguments.length?(i="function"===typeof e?e:hy(+e),o):i},o},_y=Py(Ey);function Dy(e){this._curve=e}function Py(e){function t(t){return new Dy(e(t))}return t._curve=e,t}function Uy(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(Py(e)):t()._curve},e}Dy.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var Jy=function(){return Uy(Xy().curve(_y))},Qy=function(){var e=Hy().curve(_y),t=e.curve,n=e.lineX0,r=e.lineX1,a=e.lineY0,i=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return Uy(n())},delete e.lineX0,e.lineEndAngle=function(){return Uy(r())},delete e.lineX1,e.lineInnerRadius=function(){return Uy(a())},delete e.lineY0,e.lineOuterRadius=function(){return Uy(i())},delete e.lineY1,e.curve=function(e){return arguments.length?t(Py(e)):t()._curve},e},qy=function(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]};function $y(e){return e.source}function ew(e){return e.target}function tw(e){var t=$y,n=ew,r=jy,a=Ly,i=null;function o(){var o,s=My.call(arguments),u=t.apply(this,s),c=n.apply(this,s);if(i||(i=o=co()),e(i,+r.apply(this,(s[0]=u,s)),+a.apply(this,s),+r.apply(this,(s[0]=c,s)),+a.apply(this,s)),o)return i=null,o+""||null}return o.source=function(e){return arguments.length?(t=e,o):t},o.target=function(e){return arguments.length?(n=e,o):n},o.x=function(e){return arguments.length?(r="function"===typeof e?e:hy(+e),o):r},o.y=function(e){return arguments.length?(a="function"===typeof e?e:hy(+e),o):a},o.context=function(e){return arguments.length?(i=null==e?null:e,o):i},o}function nw(e,t,n,r,a){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,a,r,a)}function rw(e,t,n,r,a){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+a)/2,r,n,r,a)}function aw(e,t,n,r,a){var i=qy(t,n),o=qy(t,n=(n+a)/2),s=qy(r,n),u=qy(r,a);e.moveTo(i[0],i[1]),e.bezierCurveTo(o[0],o[1],s[0],s[1],u[0],u[1])}function iw(){return tw(nw)}function ow(){return tw(rw)}function sw(){var e=tw(aw);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var uw={draw:function(e,t){var n=Math.sqrt(t/yy);e.moveTo(n,0),e.arc(0,0,n,0,Gy)}},cw={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},lw=Math.sqrt(1/3),gw=2*lw,dw={draw:function(e,t){var n=Math.sqrt(t/gw),r=n*lw;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},hw=Math.sin(yy/10)/Math.sin(7*yy/10),fw=Math.sin(Gy/10)*hw,pw=-Math.cos(Gy/10)*hw,Iw={draw:function(e,t){var n=Math.sqrt(.8908130915292852*t),r=fw*n,a=pw*n;e.moveTo(0,-n),e.lineTo(r,a);for(var i=1;i<5;++i){var o=Gy*i/5,s=Math.cos(o),u=Math.sin(o);e.lineTo(u*n,-s*n),e.lineTo(s*r-u*a,u*r+s*a)}e.closePath()}},Cw={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},mw=Math.sqrt(3),bw={draw:function(e,t){var n=-Math.sqrt(t/(3*mw));e.moveTo(0,2*n),e.lineTo(-mw*n,-n),e.lineTo(mw*n,-n),e.closePath()}},vw=-.5,Aw=Math.sqrt(3)/2,yw=1/Math.sqrt(12),ww=3*(yw/2+1),Gw={draw:function(e,t){var n=Math.sqrt(t/ww),r=n/2,a=n*yw,i=r,o=n*yw+n,s=-i,u=o;e.moveTo(r,a),e.lineTo(i,o),e.lineTo(s,u),e.lineTo(vw*r-Aw*a,Aw*r+vw*a),e.lineTo(vw*i-Aw*o,Aw*i+vw*o),e.lineTo(vw*s-Aw*u,Aw*s+vw*u),e.lineTo(vw*r+Aw*a,vw*a-Aw*r),e.lineTo(vw*i+Aw*o,vw*o-Aw*i),e.lineTo(vw*s+Aw*u,vw*u-Aw*s),e.closePath()}},Bw=[uw,cw,dw,Cw,Iw,bw,Gw],xw=function(e,t){var n=null;function r(){var r;if(n||(n=r=co()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"===typeof e?e:hy(e||uw),t="function"===typeof t?t:hy(void 0===t?64:+t),r.type=function(t){return arguments.length?(e="function"===typeof t?t:hy(t),r):e},r.size=function(e){return arguments.length?(t="function"===typeof e?e:hy(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r},Sw=function(){};function kw(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Zw(e){this._context=e}Zw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kw(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Rw=function(e){return new Zw(e)};function Nw(e){this._context=e}Nw.prototype={areaStart:Sw,areaEnd:Sw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kw(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Ow=function(e){return new Nw(e)};function Ww(e){this._context=e}Ww.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:kw(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};var Fw=function(e){return new Ww(e)},Mw=function(){function e(t,n){Object(Z.a)(this,e),this._context=t,this._x=n}return Object(R.a)(e,[{key:"areaStart",value:function(){this._line=0}},{key:"areaEnd",value:function(){this._line=NaN}},{key:"lineStart",value:function(){this._point=0}},{key:"lineEnd",value:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}},{key:"point",value:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}]),e}();function Vw(e){return new Mw(e,!0)}function Tw(e){return new Mw(e,!1)}function Ew(e,t){this._basis=new Zw(e),this._beta=t}Ew.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,s=t[n]-i,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*e[u]+(1-this._beta)*(a+r*o),this._beta*t[u]+(1-this._beta)*(i+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var jw=function e(t){function n(e){return 1===t?new Zw(e):new Ew(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function Lw(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Xw(e,t){this._context=e,this._k=(1-t)/6}Xw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Lw(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Lw(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Hw=function e(t){function n(e){return new Xw(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Yw(e,t){this._context=e,this._k=(1-t)/6}Yw.prototype={areaStart:Sw,areaEnd:Sw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Lw(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var zw=function e(t){function n(e){return new Yw(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Kw(e,t){this._context=e,this._k=(1-t)/6}Kw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lw(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var _w=function e(t){function n(e){return new Kw(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Dw(e,t,n){var r=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>Ay){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,u=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/u,a=(a*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/u}if(e._l23_a>Ay){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,a,i,o,e._x2,e._y2)}function Pw(e,t){this._context=e,this._alpha=t}Pw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Dw(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Uw=function e(t){function n(e){return t?new Pw(e,t):new Xw(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Jw(e,t){this._context=e,this._alpha=t}Jw.prototype={areaStart:Sw,areaEnd:Sw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Dw(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Qw=function e(t){function n(e){return t?new Jw(e,t):new Yw(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function qw(e,t){this._context=e,this._alpha=t}qw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Dw(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var $w=function e(t){function n(e){return t?new qw(e,t):new Kw(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function eG(e){this._context=e}eG.prototype={areaStart:Sw,areaEnd:Sw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};var tG=function(e){return new eG(e)};function nG(e){return e<0?-1:1}function rG(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),s=(i*a+o*r)/(r+a);return(nG(i)+nG(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function aG(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function iG(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,s=(i-r)/3;e._context.bezierCurveTo(r+s,a+s*t,i-s,o-s*n,i,o)}function oG(e){this._context=e}function sG(e){this._context=new uG(e)}function uG(e){this._context=e}function cG(e){return new oG(e)}function lG(e){return new sG(e)}function gG(e){this._context=e}function dG(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}oG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:iG(this,this._t0,aG(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,iG(this,aG(this,n=rG(this,e,t)),n);break;default:iG(this,this._t0,n=rG(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(sG.prototype=Object.create(oG.prototype)).point=function(e,t){oG.prototype.point.call(this,t,e)},uG.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},gG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=dG(e),a=dG(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var hG=function(e){return new gG(e)};function fG(e,t){this._context=e,this._t=t}fG.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var pG=function(e){return new fG(e,.5)};function IG(e){return new fG(e,0)}function CG(e){return new fG(e,1)}var mG=function(e,t){if((a=e.length)>1)for(var n,r,a,i=1,o=e[t[0]],s=o.length;i<a;++i)for(r=o,o=e[t[i]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},bG=function(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n};function vG(e,t){return e[t]}function AG(e){var t=[];return t.key=e,t}var yG=function(){var e=hy([]),t=bG,n=mG,r=vG;function a(a){var i,o,s,c=Array.from(e.apply(this,arguments),AG),l=c.length,g=-1,d=Object(u.a)(a);try{for(d.s();!(s=d.n()).done;){var h=s.value;for(i=0,++g;i<l;++i)(c[i][g]=[0,+r(h,c[i].key,g,a)]).data=h}}catch(f){d.e(f)}finally{d.f()}for(i=0,o=Vy(t(c));i<l;++i)c[o[i]].index=i;return n(c,o),c}return a.keys=function(t){return arguments.length?(e="function"===typeof t?t:hy(Array.from(t)),a):e},a.value=function(e){return arguments.length?(r="function"===typeof e?e:hy(+e),a):r},a.order=function(e){return arguments.length?(t=null==e?bG:"function"===typeof e?e:hy(Array.from(e)),a):t},a.offset=function(e){return arguments.length?(n=null==e?mG:e,a):n},a},wG=function(e,t){if((r=e.length)>0){for(var n,r,a,i=0,o=e[0].length;i<o;++i){for(a=n=0;n<r;++n)a+=e[n][i][1]||0;if(a)for(n=0;n<r;++n)e[n][i][1]/=a}mG(e,t)}},GG=function(e,t){if((s=e.length)>0)for(var n,r,a,i,o,s,u=0,c=e[t[0]].length;u<c;++u)for(i=o=0,n=0;n<s;++n)(a=(r=e[t[n]][u])[1]-r[0])>0?(r[0]=i,r[1]=i+=a):a<0?(r[1]=o,r[0]=o+=a):(r[0]=0,r[1]=a)},BG=function(e,t){if((n=e.length)>0){for(var n,r=0,a=e[t[0]],i=a.length;r<i;++r){for(var o=0,s=0;o<n;++o)s+=e[o][r][1]||0;a[r][1]+=a[r][0]=-s/2}mG(e,t)}},xG=function(e,t){if((a=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,a,i=0,o=1;o<r;++o){for(var s=0,u=0,c=0;s<a;++s){for(var l=e[t[s]],g=l[o][1]||0,d=(g-(l[o-1][1]||0))/2,h=0;h<s;++h){var f=e[t[h]];d+=(f[o][1]||0)-(f[o-1][1]||0)}u+=g,c+=d*g}n[o-1][1]+=n[o-1][0]=i,u&&(i-=c/u)}n[o-1][1]+=n[o-1][0]=i,mG(e,t)}},SG=function(e){var t=e.map(kG);return bG(e).sort((function(e,n){return t[e]-t[n]}))};function kG(e){for(var t,n=-1,r=0,a=e.length,i=-1/0;++n<a;)(t=+e[n][1])>i&&(i=t,r=n);return r}var ZG=function(e){var t=e.map(RG);return bG(e).sort((function(e,n){return t[e]-t[n]}))};function RG(e){for(var t,n=0,r=-1,a=e.length;++r<a;)(t=+e[r][1])&&(n+=t);return n}var NG=function(e){return ZG(e).reverse()},OG=function(e){var t,n,r=e.length,a=e.map(RG),i=SG(e),o=0,s=0,u=[],c=[];for(t=0;t<r;++t)n=i[t],o<s?(o+=a[n],u.push(n)):(s+=a[n],c.push(n));return c.reverse().concat(u)},WG=function(e){return bG(e).reverse()},FG="%Y-%m-%dT%H:%M:%S.%LZ";var MG=Date.prototype.toISOString?function(e){return e.toISOString()}:Pm(FG);var VG=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:Um(FG),TG=function(e,t,n){var r=new ca,a=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?sa():+n,r._restart((function i(o){o+=a,r._restart(i,a+=t,n),e(o)}),t,n)},r.restart(e,t,n),r)},EG=function(e){return function(){return e}};function jG(e,t){var n=t.sourceEvent,r=t.target,a=t.transform,i=t.dispatch;Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:i}})}function LG(e,t,n){this.k=e,this.x=t,this.y=n}LG.prototype={constructor:LG,scale:function(e){return 1===e?this:new LG(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new LG(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var XG=new LG(1,0,0);function HG(e){for(;!e.__zoom;)if(!(e=e.parentNode))return XG;return e.__zoom}function YG(e){e.stopImmediatePropagation()}HG.prototype=LG.prototype;var zG=function(e){e.preventDefault(),e.stopImmediatePropagation()};function KG(e){return(!e.ctrlKey||"wheel"===e.type)&&!e.button}function _G(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function DG(){return this.__zoom||XG}function PG(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function UG(){return navigator.maxTouchPoints||"ontouchstart"in this}function JG(e,t,n){var r=e.invertX(t[0][0])-n[0][0],a=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o))}var QG=function(){var e,t,n,r=KG,a=_G,i=JG,o=PG,s=UG,u=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,g=Np,d=Gt("start","zoom","end"),h=500,f=0,p=10;function I(e){e.property("__zoom",DG).on("wheel.zoom",w).on("mousedown.zoom",G).on("dblclick.zoom",B).filter(s).on("touchstart.zoom",x).on("touchmove.zoom",S).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function C(e,t){return(t=Math.max(u[0],Math.min(u[1],t)))===e.k?e:new LG(t,e.x,e.y)}function m(e,t,n){var r=t[0]-n[0]*e.k,a=t[1]-n[1]*e.k;return r===e.x&&a===e.y?e:new LG(e.k,r,a)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function v(e,t,n,r){e.on("start.zoom",(function(){A(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){A(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,i=arguments,o=A(e,i).event(r),s=a.apply(e,i),u=null==n?b(s):"function"===typeof n?n.apply(e,i):n,c=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),l=e.__zoom,d="function"===typeof t?t.apply(e,i):t,h=g(l.invert(u).concat(c/l.k),d.invert(u).concat(c/d.k));return function(e){if(1===e)e=d;else{var t=h(e),n=c/t[2];e=new LG(n,u[0]-t[0]*n,u[1]-t[1]*n)}o.zoom(null,e)}}))}function A(e,t,n){return!n&&e.__zooming||new y(e,t)}function y(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=a.apply(e,t),this.taps=0}function w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];if(r.apply(this,arguments)){var s=A(this,n).event(e),l=this.__zoom,g=Math.max(u[0],Math.min(u[1],l.k*Math.pow(2,o.apply(this,arguments)))),d=qr(e);if(s.wheel)s.mouse[0][0]===d[0]&&s.mouse[0][1]===d[1]||(s.mouse[1]=l.invert(s.mouse[0]=d)),clearTimeout(s.wheel);else{if(l.k===g)return;s.mouse=[d,l.invert(d)],wa(this),s.start()}zG(e),s.wheel=setTimeout(h,150),s.zoom("mouse",i(m(C(l,g),s.mouse[0],s.mouse[1]),s.extent,c))}function h(){s.wheel=null,s.end()}}function G(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];if(!n&&r.apply(this,arguments)){var s=A(this,a,!0).event(e),u=Yn(e.view).on("mousemove.zoom",p,!0).on("mouseup.zoom",I,!0),l=qr(e,g),g=e.currentTarget,d=e.clientX,h=e.clientY;_n(e.view),YG(e),s.mouse=[l,this.__zoom.invert(l)],wa(this),s.start()}function p(e){if(zG(e),!s.moved){var t=e.clientX-d,n=e.clientY-h;s.moved=t*t+n*n>f}s.event(e).zoom("mouse",i(m(s.that.__zoom,s.mouse[0]=qr(e,g),s.mouse[1]),s.extent,c))}function I(e){u.on("mousemove.zoom mouseup.zoom",null),Dn(e.view,s.moved),zG(e),s.event(e).end()}}function B(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(r.apply(this,arguments)){var s=this.__zoom,u=qr(e.changedTouches?e.changedTouches[0]:e,this),g=s.invert(u),d=s.k*(e.shiftKey?.5:2),h=i(m(C(s,d),u,g),a.apply(this,n),c);zG(e),l>0?Yn(this).transition().duration(l).call(v,h,u,e):Yn(this).call(I.transform,h,u,e)}}function x(n){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];if(r.apply(this,arguments)){var s,u,c,l,g=n.touches,d=g.length,f=A(this,i,n.changedTouches.length===d).event(n);for(YG(n),u=0;u<d;++u)c=g[u],l=[l=qr(c,this),this.__zoom.invert(l),c.identifier],f.touch0?f.touch1||f.touch0[2]===l[2]||(f.touch1=l,f.taps=0):(f.touch0=l,s=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),s&&(f.taps<2&&(t=l[0],e=setTimeout((function(){e=null}),h)),wa(this),f.start())}}function S(e){if(this.__zooming){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,o,s,u,l=A(this,n).event(e),g=e.changedTouches,d=g.length;for(zG(e),a=0;a<d;++a)o=g[a],s=qr(o,this),l.touch0&&l.touch0[2]===o.identifier?l.touch0[0]=s:l.touch1&&l.touch1[2]===o.identifier&&(l.touch1[0]=s);if(o=l.that.__zoom,l.touch1){var h=l.touch0[0],f=l.touch0[1],p=l.touch1[0],I=l.touch1[1],b=(b=p[0]-h[0])*b+(b=p[1]-h[1])*b,v=(v=I[0]-f[0])*v+(v=I[1]-f[1])*v;o=C(o,Math.sqrt(b/v)),s=[(h[0]+p[0])/2,(h[1]+p[1])/2],u=[(f[0]+I[0])/2,(f[1]+I[1])/2]}else{if(!l.touch0)return;s=l.touch0[0],u=l.touch0[1]}l.zoom("touch",i(m(o,s,u),l.extent,c))}}function k(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];if(this.__zooming){var o,s,u=A(this,a).event(e),c=e.changedTouches,l=c.length;for(YG(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),h),o=0;o<l;++o)s=c[o],u.touch0&&u.touch0[2]===s.identifier?delete u.touch0:u.touch1&&u.touch1[2]===s.identifier&&delete u.touch1;if(u.touch1&&!u.touch0&&(u.touch0=u.touch1,delete u.touch1),u.touch0)u.touch0[1]=this.__zoom.invert(u.touch0[0]);else if(u.end(),2===u.taps&&(s=qr(s,this),Math.hypot(t[0]-s[0],t[1]-s[1])<p)){var g=Yn(this).on("dblclick.zoom");g&&g.apply(this,arguments)}}}return I.transform=function(e,t,n,r){var a=e.selection?e.selection():e;a.property("__zoom",DG),e!==a?v(e,t,n,r):a.interrupt().each((function(){A(this,arguments).event(r).start().zoom(null,"function"===typeof t?t.apply(this,arguments):t).end()}))},I.scaleBy=function(e,t,n,r){I.scaleTo(e,(function(){var e=this.__zoom.k,n="function"===typeof t?t.apply(this,arguments):t;return e*n}),n,r)},I.scaleTo=function(e,t,n,r){I.transform(e,(function(){var e=a.apply(this,arguments),r=this.__zoom,o=null==n?b(e):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(o),u="function"===typeof t?t.apply(this,arguments):t;return i(m(C(r,u),o,s),e,c)}),n,r)},I.translateBy=function(e,t,n,r){I.transform(e,(function(){return i(this.__zoom.translate("function"===typeof t?t.apply(this,arguments):t,"function"===typeof n?n.apply(this,arguments):n),a.apply(this,arguments),c)}),null,r)},I.translateTo=function(e,t,n,r,o){I.transform(e,(function(){var e=a.apply(this,arguments),o=this.__zoom,s=null==r?b(e):"function"===typeof r?r.apply(this,arguments):r;return i(XG.translate(s[0],s[1]).scale(o.k).translate("function"===typeof t?-t.apply(this,arguments):-t,"function"===typeof n?-n.apply(this,arguments):-n),e,c)}),r,o)},y.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Yn(this.that).datum();d.call(e,this.that,new jG(e,{sourceEvent:this.sourceEvent,target:I,type:e,transform:this.that.__zoom,dispatch:d}),t)}},I.wheelDelta=function(e){return arguments.length?(o="function"===typeof e?e:EG(+e),I):o},I.filter=function(e){return arguments.length?(r="function"===typeof e?e:EG(!!e),I):r},I.touchable=function(e){return arguments.length?(s="function"===typeof e?e:EG(!!e),I):s},I.extent=function(e){return arguments.length?(a="function"===typeof e?e:EG([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),I):a},I.scaleExtent=function(e){return arguments.length?(u[0]=+e[0],u[1]=+e[1],I):[u[0],u[1]]},I.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],I):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},I.constrain=function(e){return arguments.length?(i=e,I):i},I.duration=function(e){return arguments.length?(l=+e,I):l},I.interpolate=function(e){return arguments.length?(g=e,I):g},I.on=function(){var e=d.on.apply(d,arguments);return e===d?I:e},I.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,I):Math.sqrt(f)},I.tapDistance=function(e){return arguments.length?(p=+e,I):p},I}},function(e,t,n){"use strict";n.d(t,"y",(function(){return r})),n.d(t,"D",(function(){return a.b})),n.d(t,"E",(function(){return a.a})),n.d(t,"G",(function(){return a.c})),n.d(t,"F",(function(){return a.b})),n.d(t,"m",(function(){return i.b})),n.d(t,"n",(function(){return i.a})),n.d(t,"p",(function(){return i.c})),n.d(t,"o",(function(){return i.b})),n.d(t,"z",(function(){return u})),n.d(t,"A",(function(){return o})),n.d(t,"C",(function(){return s})),n.d(t,"B",(function(){return u})),n.d(t,"H",(function(){return h})),n.d(t,"I",(function(){return g})),n.d(t,"K",(function(){return d})),n.d(t,"J",(function(){return h})),n.d(t,"u",(function(){return C})),n.d(t,"v",(function(){return p})),n.d(t,"x",(function(){return I})),n.d(t,"w",(function(){return C})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"e",(function(){return G})),n.d(t,"f",(function(){return w})),n.d(t,"h",(function(){return G})),n.d(t,"g",(function(){return B})),n.d(t,"a",(function(){return Z})),n.d(t,"b",(function(){return S})),n.d(t,"d",(function(){return k})),n.d(t,"c",(function(){return Z})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return N})),n.d(t,"t",(function(){return O})),n.d(t,"s",(function(){return W}));var r=function(e){return+e},a=n(198),i=n(199),o=function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),s=function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),u=function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),c=Math.PI,l=c/2;function g(e){return 1===+e?1:1-Math.cos(e*l)}function d(e){return Math.sin(e*l)}function h(e){return(1-Math.cos(c*e))/2}function f(e){return 1.0009775171065494*(Math.pow(2,-10*e)-.0009765625)}function p(e){return f(1-+e)}function I(e){return 1-f(e)}function C(e){return((e*=2)<=1?f(1-e):2-f(e-1))/2}function m(e){return 1-Math.sqrt(1-e*e)}function b(e){return Math.sqrt(1- --e*e)}function v(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var A=4/11,y=7.5625;function w(e){return 1-G(1-e)}function G(e){return(e=+e)<A?y*e*e:e<.7272727272727273?y*(e-=.5454545454545454)*e+.75:e<.9090909090909091?y*(e-=.8181818181818182)*e+.9375:y*(e-=.9545454545454546)*e+.984375}function B(e){return((e*=2)<=1?1-G(1-e):G(e-1)+1)/2}var x=1.70158,S=function e(t){function n(e){return(e=+e)*e*(t*(e-1)+e)}return t=+t,n.overshoot=e,n}(x),k=function e(t){function n(e){return--e*e*((e+1)*t+e)+1}return t=+t,n.overshoot=e,n}(x),Z=function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(x),R=2*Math.PI,N=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=R);function a(e){return t*f(- --e)*Math.sin((r-e)/n)}return a.amplitude=function(t){return e(t,n*R)},a.period=function(n){return e(t,n)},a}(1,.3),O=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=R);function a(e){return 1-t*f(e=+e)*Math.sin((e+r)/n)}return a.amplitude=function(t){return e(t,n*R)},a.period=function(n){return e(t,n)},a}(1,.3),W=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=R);function a(e){return((e=2*e-1)<0?t*f(-e)*Math.sin((r-e)/n):2-t*f(e)*Math.sin((r+e)/n))/2}return a.amplitude=function(t){return e(t,n*R)},a.period=function(n){return e(t,n)},a}(1,.3)},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(21),a=n(19);function i(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}function o(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}i(n,t,e)}function s(e,t,n){for(var i=t.shape.length,o=i>1?t.shape[i-1]:1,s=n.length,u=1,c=o;c<s;++c)u*=n[c];var l=o<1?1:o;return{sliceRank:o,numUpdates:Object(a.O)(t.shape)/l,sliceSize:u,strides:[].concat(Object(r.a)(Object(a.j)(n.slice(0,o))),[1]),outputSize:Object(a.O)(n)}}},function(e,t,n){"use strict";n.r(t),n.d(t,"assertParamsValid",(function(){return i})),n.d(t,"maskToAxes",(function(){return o})),n.d(t,"computeOutShape",(function(){return s})),n.d(t,"stridesWithElidedDims",(function(){return u})),n.d(t,"getNormalizedAxes",(function(){return g})),n.d(t,"startIndicesWithElidedDims",(function(){return d})),n.d(t,"stopIndicesWithElidedDims",(function(){return h})),n.d(t,"stridesForAxis",(function(){return f})),n.d(t,"startForAxis",(function(){return p})),n.d(t,"stopForAxis",(function(){return I})),n.d(t,"isSliceContinous",(function(){return C})),n.d(t,"computeFlatOffset",(function(){return m})),n.d(t,"parseSliceParams",(function(){return b})),n.d(t,"sliceInfo",(function(){return v}));var r=n(21),a=n(19);function i(e,t,n){var r=e.shape.length;a.b(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),a.b(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var i=function(i){a.b(t[i]+n[i]<=e.shape[i],(function(){return"Error in slice".concat(r,"D: begin[").concat(i,"] + size[").concat(i,"] ")+"(".concat(t[i]+n[i],") would overflow input.shape[").concat(i,"] (").concat(e.shape[i],")")}))},o=0;o<r;++o)i(o)}function o(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function s(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function u(e,t,n,a){for(var i=Object(r.a)(e),o=i.length;o<a.length;o++)i.push(1);for(var s=0;s<n;s++)0===s?i[t]=1:(i.splice(t,0,1),i.pop());return i}function c(e,t,n){return n<=e?n:n-(t-1)}function l(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function g(e,t,n,r,a,i,o,s,c){var l=e.length,g=new Array(l),C=new Array(l),m=new Array(l);if(t.length&&n>0){var b=t[0],v=n+1;g=d(o,b,v,r,e),C=h(s,b,v,a,e),m=u(i,b,v,e)}else for(var A=0;A<l;A++)g[A]=p(o,r,i,e,A,c),C[A]=I(s,a,i,e,A,c),m[A]=f(i,A,c);return{begin:g,end:C,strides:m}}function d(e,t,n,a,i){for(var o=Object(r.a)(i),s=l(n,t),u=0;u<o.length;u++)if(s.indexOf(u)>-1)o[u]=0;else{var g=c(t,n,u),d=a[g];e&1<<g&&(d=0),o[u]=d}return o}function h(e,t,n,i,o){for(var s=Object(r.a)(o),u=l(n,t),g=0;g<s.length;g++)if(u.indexOf(g)>-1)s[g]=Number.MAX_SAFE_INTEGER;else{var d=c(t,n,g),h=i[d];e&1<<d&&(h=Number.MAX_SAFE_INTEGER),s[g]=h}for(var f=0;f<s.length;f++){var p=o[f];s[f]<0&&(s[f]+=p),s[f]=a.i(0,s[f],o[f])}return s}function f(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function p(e,t,n,r,i,o){var s=t[i],u=n[i]||1;(e&1<<i||o&1<<i||null==s)&&(s=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var c=r[i];return s<0&&(s+=c),s=a.i(0,s,c-1)}function I(e,t,n,r,i,o){var s=t[i],u=n[i]||1;(e&1<<i||o&1<<i||null==s)&&(s=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var c=r[i];return s<0&&(s+=c),s=u>0?a.i(0,s,c):a.i(-1,s,c-1)}function C(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function m(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function b(e,t,n){var i,o,s=e.shape.length;return(i="number"===typeof t?[t].concat(Object(r.a)(new Array(s-1).fill(0))):t.length<s?t.concat(new Array(s-t.length).fill(0)):t.slice()).forEach((function(e){a.b(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(s).fill(-1):"number"===typeof n?[n].concat(Object(r.a)(new Array(s-1).fill(-1))):n.length<s?n.concat(new Array(s-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(a.b(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-i[n])})),[i,o]}function v(e,t,n,r,a,i,u,c,l){var d=t.slice(),h=n.slice(),f=r;null==r&&(f=new Array(d.length));var p=o(u);if(p.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==u&&0!==c)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==u&&0!==l)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var I=e.length-d.length,C=o(c),m=e.slice();C.forEach((function(e){d[e]=0,h[e]=1,m.splice(e,0,1)}));var b=g(m,p,I,d,h,f,a,i,u),v=b.begin,A=b.end,y=b.strides;d=v,h=A,f=y;var w=o(l);w.forEach((function(e){h[e]=d[e]+1,f[e]=1}));var G=s(d,h,f),B=G.filter((function(e,t){return-1===w.indexOf(t)}));return{nonStrided:f.every((function(e){return 1===e})),$begin:d,$end:h,$strides:f,size:G,newShape:m,outShape:B}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);function a(e){var t=e.controlled,n=e.default,a=(e.name,e.state,r.useRef(void 0!==t).current),i=r.useState(n),o=i[0],s=i[1];return[a?t:o,r.useCallback((function(e){a||s(e)}),[])]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(27),u=n(53),c=n(10),l=n(18);var g=Object(c.b)({avgPool_:function(e,t,n,c,g){var d=Object(i.a)(e,"x","avgPool","float32");o.b(u.h(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var h=d,f=!1;3===d.rank&&(f=!0,h=Object(l.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===h.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(h.rank,".")})),null!=g&&o.b(o.v(c),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(g," but got pad ").concat(c,".")}));var p={x:h},I={filterSize:t,strides:n,pad:c,dimRoundingMode:g},C=r.a.runKernel(a.o,p,I);return C=Object(s.a)(C,d.dtype),f?Object(l.a)(C,[C.shape[1],C.shape[2],C.shape[3]]):C}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({cos_:function(e){var t={x:Object(i.a)(e,"x","cos")};return r.a.runKernel(a.I,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Object(i.a)(e,"x","cumsum"),u={x:s},c={axis:t,exclusive:n,reverse:o};return r.a.runKernel(a.L,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({floorDiv_:function(e,t){var n=Object(s.a)(e,"a","floorDiv"),u=Object(s.a)(t,"b","floorDiv"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.hb,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({elu_:function(e){var t={x:Object(i.a)(e,"x","elu")};return r.a.runKernel(a.W,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({floor_:function(e){var t={x:Object(i.a)(e,"x","floor")};return r.a.runKernel(a.gb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({imag_:function(e){var t={input:Object(i.a)(e,"input","imag")};return r.a.runKernel(a.sb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Object(i.a)(e,"x","leakyRelu"),o={x:n},s={alpha:t};return r.a.runKernel(a.yb,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({less_:function(e,t){var n=Object(s.a)(e,"a","less","string_or_numeric"),c=Object(s.a)(t,"b","less","string_or_numeric"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.zb,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(5),a=n(19),i=n(28),o=n(67),s=n(69),u=n(112),c=n(109),l=n(10),g=n(18),d=n(29),h=n(31);var f=Object(l.b)({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=Object(r.a)(e,"x","logSumExp"),f=Object(a.I)(t,l.shape),p=Object(c.a)(l,f,!0),I=Object(d.a)(l,p),C=Object(s.a)(I),m=Object(h.a)(C,f),b=Object(u.a)(m),v=Object(i.a)(Object(g.a)(p,b.shape),b);if(n){var A=Object(o.e)(v.shape,f);return Object(g.a)(v,A)}return v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(33),s=n(10);var u=Object(s.b)({logicalOr_:function(e,t){var n=Object(i.a)(e,"a","logicalOr","bool"),s=Object(i.a)(t,"b","logicalOr","bool");Object(o.a)(n.shape,s.shape);var u={a:n,b:s};return r.a.runKernel(a.Hb,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(53),u=n(10),c=n(18);var l=Object(u.b)({maxPool_:function(e,t,n,u,l){var g=Object(i.a)(e,"x","maxPool"),d=g,h=!1;3===g.rank&&(h=!0,d=Object(c.a)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),o.b(4===d.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,".")})),o.b(s.h(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=l&&o.b(o.v(u),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var f={x:d},p={filterSize:t,strides:n,pad:u,dimRoundingMode:l},I=r.a.runKernel(a.Jb,f,p);return h?Object(c.a)(I,[I.shape[1],I.shape[2],I.shape[3]]):I}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(27),l=n(10);var g=Object(l.b)({minimum_:function(e,t){var n=Object(s.a)(e,"a","minimum"),l=Object(s.a)(t,"b","minimum"),g=Object(o.makeTypesMatch)(n,l),d=Object(r.a)(g,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=Object(c.a)(n,"int32"),l=Object(c.a)(l,"int32")),Object(u.a)(n.shape,l.shape);var h={a:n,b:l};return a.a.runKernel(i.Rb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({notEqual_:function(e,t){var n=Object(s.a)(e,"a","notEqual","string_or_numeric"),c=Object(s.a)(t,"b","notEqual","string_or_numeric"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.ac,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({prelu_:function(e,t){var n={x:Object(i.a)(e,"x","prelu"),alpha:Object(i.a)(t,"alpha","prelu")};return r.a.runKernel(a.gc,n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({relu6_:function(e){var t={x:Object(i.a)(e,"x","relu6")};return r.a.runKernel(a.nc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(19),o=n(10);var s=Object(o.b)({fft_:function(e){Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.a.runKernel(a.db,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(19),a=n(93),i=n(54),o=n(171),s=n(10),u=n(152),c=n(18),l=n(45),g=n(95),d=n(114),h=n(34),f=n(181);var p=Object(s.b)({rfft_:function(e,t){Object(r.b)("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,s=e.shape[e.shape.length-1],p=e.size/s;if(null!=t&&t<s){var I=e.shape.map((function(e){return 0})),C=e.shape.map((function(e){return e}));C[e.shape.length-1]=t,n=Object(l.a)(e,I,C),s=t}else if(null!=t&&t>s){var m=e.shape.map((function(e){return e}));m[e.shape.length-1]=t-s,n=Object(i.a)([e,Object(d.a)(m)],e.shape.length-1),s=t}else n=e;var b=Object(h.a)(n),v=Object(c.a)(Object(a.a)(n,b),[p,s]),A=Object(f.a)(v),y=Math.floor(s/2)+1,w=Object(u.a)(A),G=Object(o.a)(A),B=Object(g.a)(w,[y,s-y],w.shape.length-1),x=Object(g.a)(G,[y,s-y],G.shape.length-1),S=n.shape.slice();return S[n.shape.length-1]=y,Object(c.a)(Object(a.a)(B[0],x[0]),S)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(33),c=n(10);var l=Object(c.b)({squaredDifference_:function(e,t){var n=Object(s.a)(e,"a","squaredDifference"),c=Object(s.a)(t,"b","squaredDifference"),l=Object(o.makeTypesMatch)(n,c),g=Object(r.a)(l,2);n=g[0],c=g[1],Object(u.a)(n.shape,c.shape);var d={a:n,b:c};return a.a.runKernel(i.Qc,d,{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({unsortedSegmentSum_:function(e,t,n){var s=Object(i.a)(e,"x","unsortedSegmentSum"),u=Object(i.a)(t,"segmentIds","unsortedSegmentSum","int32");Object(o.b)(Object(o.v)(n),(function(){return"numSegments must be of dtype int"}));var c={x:s,segmentIds:u},l={numSegments:n};return r.a.runKernel(a.gd,c,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n(5),a=n(19),i=n(71),o=n(67),s=n(109),u=n(151),c=n(10),l=n(85),g=n(18),d=n(32),h=n(65),f=n(43),p=n(31);function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return Object(i.a)(e);if(1!==e.rank&&null===n)return I(Object(g.a)(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Object(p.a)(Object(i.a)(e),n);if(t===1/0)return Object(s.a)(Object(i.a)(e),n);if(t===-1/0)return Object(u.a)(Object(i.a)(e),n);if("euclidean"===t||2===t)return Object(h.a)(Object(p.a)(Object(l.a)(Object(i.a)(e),Object(d.a)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Object(s.a)(Object(p.a)(Object(i.a)(e),n[0]),n[1]-1);if(t===1/0)return Object(s.a)(Object(p.a)(Object(i.a)(e),n[1]),n[0]);if(t===-1/0)return Object(u.a)(Object(p.a)(Object(i.a)(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Object(h.a)(Object(p.a)(Object(f.a)(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var C=Object(c.b)({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=I(e=Object(r.a)(e,"x","norm"),t,n),u=s.shape;if(i){var c=Object(a.I)(n,e.shape);u=o.e(s.shape,c)}return Object(g.a)(s,u)}})},function(e,t,n){"use strict";e.exports=n(415)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=(r=n(417))&&r.__esModule?r:{default:r},i=n(419);var o=a.default[a.default.length-1],s=(0,i.createReactPlayer)(a.default,o);t.default=s},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(257),a=n(264),i=n(141),o=n(258);function s(e){return Object(r.a)(e)||Object(a.a)(e)||Object(i.a)(e)||Object(o.a)()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(19),o=n(10),s=n(18);var u=Object(o.b)({conv2DBackpropInput_:function(e,t,n,o,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0;i.b(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var g=e,d=t,h=!1;3===t.rank&&(h=!0,d=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),g=[1,e[0],e[1],e[2]]),i.b(4===g.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(g.length,".")})),i.b(4===d.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(d.rank)})),i.b(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var f="NHWC"===c?g[3]:g[1],p="NHWC"===c?d.shape[3]:d.shape[1];i.b(f===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(f,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),i.b(p===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(p,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=l&&i.b(i.v(u),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var I={dy:d,filter:n},C={strides:o,pad:u,dataFormat:c,dimRoundingMode:l,inputShape:g},m=r.a.runKernel(a.E,I,C);return h?Object(s.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(11);n(5),n(19),n(24);function a(){return 32===r.a.backend.floatPrecision()?.001:.1}function i(e,t,n){if(null==n&&(n=a()),!o(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t))}function o(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(19),o=n(10),s=n(18);var u=Object(o.b)({conv2DBackpropFilter_:function(e,t,n,o,u){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0,g=e;3===e.rank&&(g=Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var d=t;3===d.rank&&(d=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.b(4===g.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(g.shape,".")})),i.b(4===d.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(d.shape,".")})),i.b(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var h="NHWC"===c?g.shape[3]:g.shape[1],f="NHWC"===c?d.shape[3]:d.shape[1];i.b(h===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(h,") must ")+"match input depth in filter (".concat(n[2],".")})),i.b(f===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(f,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=l&&i.b(i.v(u),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var p={x:g,dy:d},I={strides:o,pad:u,dataFormat:c,dimRoundingMode:l,filterShape:n};return r.a.runKernel(a.D,p,I)}})},function(e,t,n){"use strict";var r=/\s/;var a=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},i=/^\s+/;var o=function(e){return e?e.slice(0,a(e)+1).replace(i,""):e},s=n(155),u=n(98),c=n(121);var l=function(e){return"symbol"==typeof e||Object(c.a)(e)&&"[object Symbol]"==Object(u.a)(e)},g=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,h=/^0o[0-7]+$/i,f=parseInt;var p=function(e){if("number"==typeof e)return e;if(l(e))return NaN;if(Object(s.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(s.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=o(e);var n=d.test(e);return n||h.test(e)?f(e.slice(2),n?2:8):g.test(e)?NaN:+e},I=1/0;var C=function(e){return e?(e=p(e))===I||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0};t.a=function(e){var t=C(e),n=t%1;return t===t?n?t-n:t:0}},function(e,t,n){"use strict";var r=n(2),a=n.n(r);t.a=a.a.createContext(null)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")}},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))},function(e,t){var n,r,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"===typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var u,c=[],l=!1,g=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):g=-1,c.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++g<t;)u&&u[g].run();g=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||l||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=p,a.addListener=p,a.once=p,a.off=p,a.removeListener=p,a.removeAllListeners=p,a.emit=p,a.prependListener=p,a.prependOnceListener=p,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,n){"use strict";function r(e){return e*e}function a(e){return e*(2-e)}function i(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";function r(e){return e*e*e}function a(e){return--e*e*e+1}function i(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";(function(e){n(11);var t=n(219),r=n(36),a=Object(r.b)();a.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),a.registerFlag("IS_BROWSER",(function(){return t.isBrowser()})),a.registerFlag("IS_NODE",(function(){return"undefined"!==typeof e&&"undefined"!==typeof e.versions&&"undefined"!==typeof e.versions.node})),a.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),a.registerFlag("PROD",(function(){return!1})),a.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return a.getBool("DEBUG")})),a.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),a.registerFlag("IS_TEST",(function(){return!1})),a.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),a.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1}))}).call(this,n(197))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1),a=n(9),i=function(){function e(t,n){Object(r.a)(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return Object(a.a)(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),o=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"refCount",value:function(e){return s("refCount")}},{key:"incRef",value:function(e){return s("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return s("time")}},{key:"read",value:function(e){return s("read")}},{key:"readSync",value:function(e){return s("readSync")}},{key:"numDataIds",value:function(){return s("numDataIds")}},{key:"disposeData",value:function(e,t){return s("disposeData")}},{key:"write",value:function(e,t,n){return s("write")}},{key:"move",value:function(e,t,n,r,a){return s("move")}},{key:"memory",value:function(){return s("memory")}},{key:"floatPrecision",value:function(){return s("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return s("dispose")}}]),e}();function s(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},function(e,t,n){"use strict";var r=n(290);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";t.a=function(e,t){}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({tanh_:function(e){var t={x:Object(i.a)(e,"x","tanh")};return r.a.runKernel(a.Zc,t)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=1.7580993408473768,a=1.0507009873554805},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r=n(291);n.d(t,"a",(function(){return r.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(15),a=n(84),i=function(e,t){a.a.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof r.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=r.UniformsUtils.clone(e.uniforms),this.material=new r.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new a.a.FullScreenQuad(this.material)};i.prototype=Object.assign(Object.create(a.a.prototype),{constructor:i,render:function(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}})},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;0!==a--;){var o=i[a];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},,function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function o(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,t){for(var n,s,u=o(e),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))a.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var g=0;g<s.length;g++)i.call(n,s[g])&&(u[s[g]]=n[s[g]])}}return u}},function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);function a(e){var t=r.useState(e),n=t[0],a=t[1],i=e||n;return r.useEffect((function(){null==n&&a("mui-".concat(Math.round(1e5*Math.random())))}),[n]),i}},function(e,t,n){"use strict";function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var o=this,s=function(){e.apply(o,a)};clearTimeout(t),t=setTimeout(s,n)}return r.clear=function(){clearTimeout(t)},r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(81);function a(e){return Object(r.a)(e).defaultView||window}},function(e,t,n){"use strict";function r(e){if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function a(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(t),n.d(t,"isMobile",(function(){return r})),n.d(t,"isBrowser",(function(){return a}))},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","all","bool"),s={x:o},u={axis:t,keepDims:n};return r.a.runKernel(a.f,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","any","bool"),s={x:o},u={axis:t,keepDims:n};return r.a.runKernel(a.g,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMax"),o={x:n},s={axis:t};return r.a.runKernel(a.h,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMin"),o={x:n},s={axis:t};return r.a.runKernel(a.i,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({atan2_:function(e,t){var n=Object(s.a)(e,"a","atan2"),u=Object(s.a)(t,"b","atan2"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.m,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({bincount_:function(e,t,n){var s=Object(i.a)(e,"x","bincount"),u=Object(i.a)(t,"weights","bincount");o.b("int32"===s.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(s.dtype)})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(u.size===s.size||0===u.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(s.shape,", weights shape: ")+"".concat(u.shape,".")}));var c={x:s,weights:u},l={size:n};return r.a.runKernel(a.u,c,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5),a=n(19),i=n(103),o=n(53),s=n(10),u=n(18);var c=Object(s.b)({conv1d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,g=arguments.length>6?arguments[6]:void 0,d=Object(r.a)(e,"x","conv1d"),h=Object(r.a)(t,"filter","conv1d"),f=d,p=!1;2===d.rank&&(p=!0,f=Object(u.a)(d,[1,d.shape[0],d.shape[1]])),a.b(3===f.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(f.rank,".")})),a.b(3===h.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(h.rank,".")})),null!=g&&a.b(a.v(s),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(g," but got pad ").concat(s,".")})),a.b(f.shape[2]===h.shape[1],(function(){return"Error in conv1d: depth of input (".concat(f.shape[2],") must match ")+"input depth for filter ".concat(h.shape[1],".")})),a.b(o.h(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.b("NWC"===c,(function(){return"Error in conv1d: got dataFormat of ".concat(c," but only NWC is currently supported.")}));var I=Object(u.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),C=Object(u.a)(f,[f.shape[0],1,f.shape[1],f.shape[2]]),m=[1,n],b=[1,l],v="NHWC",A=Object(i.a)(C,I,m,s,v,b,g);return p?Object(u.a)(A,[A.shape[2],A.shape[3]]):Object(u.a)(A,[A.shape[0],A.shape[2],A.shape[3]])}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),a=n(190),i=n(10);var o=Object(i.b)({conv2dTranspose_:function(e,t,n,i,o,s){var u=Object(r.a)(e,"x","conv2dTranspose"),c=Object(r.a)(t,"filter","conv2dTranspose");return Object(a.a)(n,u,c,i,o,"NHWC",s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({cosh_:function(e){var t={x:Object(i.a)(e,"x","cosh")};return r.a.runKernel(a.J,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",s=Object(i.a)(e,"x","depthToSpace"),u="NHWC"===n?s.shape[1]:s.shape[2],c="NHWC"===n?s.shape[2]:s.shape[3],l="NHWC"===n?s.shape[3]:s.shape[1];o.b(u*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(s.shape)})),o.b(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t," for depthToSpace with input shape\n        ").concat(s.shape)})),o.b(l%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(s.shape)}));var g={x:s},d={blockSize:t,dataFormat:n};return r.a.runKernel(a.N,g,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10),u=n(18);var c=Object(s.b)({dilation2d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",g=Object(i.a)(e,"x","dilation2d"),d=Object(i.a)(t,"filter","dilation2d");o.b(3===g.rank||4===g.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(g.rank,".")})),o.b(3===d.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,".")})),o.b("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var h=g,f=!1;3===g.rank&&(h=Object(u.a)(g,[1,g.shape[0],g.shape[1],g.shape[2]]),f=!0);var p={x:h,filter:d},I={strides:n,pad:s,dilations:c},C=r.a.runKernel(a.S,p,I);return f?Object(u.a)(C,[C.shape[1],C.shape[2],C.shape[3]]):C}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(3),a=n(37),i=n(5),o=n(30),s=n(134),u=n(10),c=n(55),l=n(34);var g=Object(u.b)({divNoNan_:function(e,t){var n=Object(i.a)(e,"a","div"),u=Object(i.a)(t,"b","div"),g=Object(a.makeTypesMatch)(n,u),d=Object(r.a)(g,2);n=d[0],u=d[1];var h=Object(o.a)(n,u),f=Object(l.a)(h),p=Object(s.a)(u,f);return Object(c.a)(p,f,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(5),a=n(19),i=n(44),o=n(10),s=n(18);var u=Object(o.b)({dot_:function(e,t){var n=Object(r.a)(e,"t1","dot"),o=Object(r.a)(t,"t2","dot");a.b((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")}));var u=1===n.rank?n.size:n.shape[1],c=1===o.rank?o.size:o.shape[0];if(a.b(u===c,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(u," and ").concat(c,".")})),1===n.rank&&1===o.rank){var l=Object(s.a)(n,[1,-1]),g=Object(s.a)(o,[-1,1]),d=Object(i.a)(l,g);return Object(s.a)(d,[])}if(1===n.rank&&2===o.rank){var h=Object(s.a)(n,[1,-1]),f=Object(s.a)(o,[o.shape[0],o.shape[1]]),p=Object(i.a)(h,f);return Object(s.a)(p,[p.size])}if(2===n.rank&&1===o.rank){var I=Object(s.a)(o,[-1,1]),C=Object(i.a)(n,I);return Object(s.a)(C,[C.size])}var m=Object(s.a)(o,[o.shape[0],o.shape[1]]);return Object(i.a)(n,m)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10),u=n(18);var c=Object(s.b)({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=Object(i.a)(e,"x","localResponseNormalization");o.b(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.b(o.v(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var g=l,d=!1;3===l.rank&&(d=!0,g=Object(u.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var h={x:g},f={depthRadius:t,bias:n,alpha:s,beta:c},p=r.a.runKernel(a.wb,h,f);return d?Object(u.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({log1p_:function(e){var t={x:Object(i.a)(e,"x","log1p")};return r.a.runKernel(a.Db,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({softplus_:function(e){var t={x:Object(i.a)(e,"x","softplus")};return r.a.runKernel(a.Gc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5),a=n(33),i=n(94),o=n(137),s=n(175),u=n(10);var c=Object(u.b)({logicalXor_:function(e,t){var n=Object(r.a)(e,"a","logicalXor","bool"),u=Object(r.a)(t,"b","logicalXor","bool");return Object(a.a)(n.shape,u.shape),Object(i.a)(Object(s.a)(e,t),Object(o.a)(Object(i.a)(e,t)))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({mirrorPad_:function(e,t,n){o.b("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var s=Object(i.a)(e,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.b(t.length===s.rank,(function(){return"Padding doesn't match input. Must be ".concat(s.rank,". ")+"Got ".concat(t.length,".")}));for(var u="reflect"===n?1:0,c=function(e){o.b(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),o.b(t[e][0]>=0&&t[e][0]<=s.shape[e]-u&&t[e][1]>=0&&t[e][1]<=s.shape[e]-u,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(s.shape[e]-u," or less than 0 for input of ")+"shape ".concat(s.shape)}))},l=0;l<s.rank;l++)c(l);var g={paddings:t,mode:n},d={x:s};return r.a.runKernel(a.Sb,d,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(37),s=n(5),u=n(10);var c=Object(u.b)({mod_:function(e,t){var n=Object(s.a)(e,"a","mod"),u=Object(s.a)(t,"b","mod"),c=Object(o.makeTypesMatch)(n,u),l=Object(r.a)(c,2),g={a:n=l[0],b:u=l[1]};return a.a.runKernel(i.Tb,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var s=Object(i.a)(e,"indices","oneHot","int32"),u={indices:s},c={depth:t,onValue:n,offValue:o};return r.a.runKernel(a.bc,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),a=n(5),i=n(19),o=n(165),s=n(132),u=n(53),c=n(176),l=n(10),g=n(18),d=n(139);var h=Object(l.b)({pool_:function(e,t,n,l,h,f){null==h&&(h=[1,1]),null==f&&(f=1),0===l&&(l="valid");var p=Object(a.a)(e,"x","maxPool"),I=p,C=!1;3===p.rank&&(C=!0,I=Object(g.a)(p,[1,p.shape[0],p.shape[1],p.shape[2]])),i.b(u.h(f,h),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(f," and dilations '").concat(h,"'")}));var m,b=u.e(I.shape,t,f,h,l),v=[b.dilationHeight,b.dilationWidth];m="same"===l?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([b.filterHeight,b.filterWidth],v):[[0,0],[0,0]];var A=1===v[0]&&1===v[1],y=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]})),u=t.map((function(e,t){return[r[t],s[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[u,c]}([b.inHeight,b.inWidth],v,m),w=Object(r.a)(y,2),G=w[0],B=w[1],x=A?l:"valid",S=A?I:Object(d.a)(I,v,G),k=("avg"===n?function(){return Object(o.a)(S,t,f,x)}:function(){return Object(c.a)(S,t,f,x)})(),Z=A?k:Object(s.a)(k,v,B);return C?Object(g.a)(Z,[Z.shape[1],Z.shape[2],Z.shape[3]]):Z}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(27),s=n(10);var u=Object(s.b)({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(i.a)(e,"x","prod");"bool"===s.dtype&&(s=Object(o.a)(s,"int32"));var u={x:s},c={axis:t,keepDims:n};return r.a.runKernel(a.hc,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),a=n(10),i=n(144);var o=Object(a.b)({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0,s=Object(r.a)(e,a),u=new i.c(t,n,null,o),c=0;c<s.values.length;c++)s.values[c]=u.nextValue();return s.toTensor()}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({round_:function(e){var t={x:Object(i.a)(e,"x","round")};return r.a.runKernel(a.vc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({rsqrt_:function(e){var t={x:Object(i.a)(e,"x","rsqrt")};return r.a.runKernel(a.wc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({selu_:function(e){var t={x:Object(i.a)(e,"x","selu")};return r.a.runKernel(a.zc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5),a=n(19),i=n(103),o=n(133),s=n(10),u=n(18);var c=Object(s.b)({separableConv2d_:function(e,t,n,s,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",d=Object(r.a)(e,"x","separableConv2d"),h=Object(r.a)(t,"depthwiseFilter","separableConv2d"),f=Object(r.a)(n,"pointwiseFilter","separableConv2d"),p=d,I=!1;if(3===d.rank&&(I=!0,p=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===g)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.b(4===p.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")})),a.b(4===h.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.b(4===f.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.b(1===f.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(f.shape[0],".")})),a.b(1===f.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(f.shape[1],".")}));var C=h.shape[2],m=h.shape[3];a.b(f.shape[2]===C*m,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(C*m,", ")+"but got ".concat(f.shape[2],".")}));var b=Object(o.a)(p,h,s,c,g,l),v=1,A=Object(i.a)(b,f,v,"valid",g);return I?Object(u.a)(A,[A.shape[1],A.shape[2],A.shape[3]]):A}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({sin_:function(e){var t={x:Object(i.a)(e,"x","sin")};return r.a.runKernel(a.Cc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({sinh_:function(e){var t={x:Object(i.a)(e,"x","sinh")};return r.a.runKernel(a.Dc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(93),a=n(54),i=n(171),o=n(20),s=n(10),u=n(152),c=n(18),l=n(77),g=n(32),d=n(45),h=n(153);var f=Object(s.b)({irfft_:function(e){var t,n=e.shape[e.shape.length-1],s=e.size/n;if(n<=2){var f=Object(c.a)(e,[s,n]);t=Object(h.a)(f)}else{var p=[s,2*(n-1)],I=Object(c.a)(Object(u.a)(e),[s,n]),C=Object(c.a)(Object(i.a)(e),[s,n]),m=Object(l.a)(Object(d.a)(I,[0,1],[s,n-2]),1),b=Object(o.a)(Object(l.a)(Object(d.a)(C,[0,1],[s,n-2]),1),Object(g.a)(-1)),v=Object(a.a)([I,m],1),A=Object(a.a)([C,b],1),y=Object(c.a)(Object(r.a)(v,A),[p[0],p[1]]);t=Object(h.a)(y)}if(t=Object(u.a)(t),3===e.rank&&0!==e.shape[0]){var w=t,G=e.shape[0];t=Object(c.a)(t,[G,t.shape[0]/G,t.shape[1]]),w.dispose()}return t}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(5),a=n(19),i=n(79);function o(e,t,n){if(Object(a.d)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var o=Object(r.c)(e,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(i.a)(e,t,o,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3),a=n(11),i=n(6),o=n(5),s=n(10);var u=Object(s.b)({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=Object(o.a)(e,"x","topk");if(0===s.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var u=s.shape[s.shape.length-1];if(t>u)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(u,") ")+"but got ".concat(t));var c={x:s},l={k:t,sorted:n},g=a.a.runKernel(i.bd,c,l),d=Object(r.a)(g,2),h=d[0],f=d[1];return{values:h,indices:f}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),a=n(11),i=n(6),o=n(5),s=n(19),u=n(10);var c=Object(u.b)({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(e,"x","unique","string_or_numeric");Object(s.b)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var u={x:n},c={axis:t},l=a.a.runKernel(i.ed,u,c),g=Object(r.a)(l,2),d=g[0],h=g[1];return{values:d,indices:h}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),a=n.n(r),i=n(17),o=n(255),s=n(5);function u(){return(u=Object(i.a)(a.a.mark((function e(t){var n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(s.a)(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,i=Object(o.a)(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var c=function(e){return u.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(76);function a(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);for(var i=Object(r.a)(e,"int32"),o=Object(r.a)([n.length,e.length],"int32"),s=0;s<n.length;s++){var u=i.indexToLoc(n[s]),c=s*e.length;o.values.set(u,c)}return o.toTensor()}},function(e,t,n){"use strict";n.r(t);var r=Array.isArray;t.default=r},function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(207);function a(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},function(e,t,n){"use strict";var r=n(2),a=n.n(r).a.createContext(null);t.a=a},function(e,t,n){"use strict";var r=n(391),a=Object(r.a)();t.a=a},function(e,t,n){"use strict";t.a={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500}},function(e,t,n){"use strict";var r="function"===typeof Symbol&&Symbol.for;t.a=r?Symbol.for("mui.nested"):"__THEME_NESTED__"},function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n.d(t,"a",(function(){return r}))},function(e,t,n){(function(){"use strict";var r=this.THREE||n(15);if(!r)throw new Error("MeshLine requires three.js");function a(){r.BufferGeometry.call(this),this.type="MeshLine",this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this._vertices=[],this._bufferArray=[],this.widthCallback=null,this.matrixWorld=new r.Matrix4,Object.defineProperties(this,{geometry:{enumerable:!0,get:function(){return this},set:function(e){this.setFromGeometry(e)}},vertices:{enumerable:!0,get:function(){return this._vertices},set:function(e){this.setVertices(e)}},bufferArray:{enumerable:!0,get:function(){return this._bufferArray},set:function(e){this.setBufferArray(e)}}})}function i(e,t){var n=new r.Matrix4,a=new r.Ray,i=new r.Sphere,o=new r.Vector3,s=this.geometry;if(i.copy(s.boundingSphere),i.applyMatrix4(this.matrixWorld),!1!==e.ray.intersectSphere(i,o)){n.getInverse(this.matrixWorld),a.copy(e.ray).applyMatrix4(n);var u=new r.Vector3,c=new r.Vector3,l=new r.Vector3,g=this instanceof r.LineSegments?2:1,d=s.index,h=s.attributes;if(null!==d)for(var f=d.array,p=h.position.array,I=h.width.array,C=0,m=f.length-1;C<m;C+=g){var b=f[C],v=f[C+1];u.fromArray(p,3*b),c.fromArray(p,3*v);var A=void 0!=I[Math.floor(C/3)]?I[Math.floor(C/3)]:1,y=e.params.Line.threshold+this.material.lineWidth*A/2,w=y*y;if(!(a.distanceSqToSegment(u,c,o,l)>w)){o.applyMatrix4(this.matrixWorld);var G=e.ray.origin.distanceTo(o);G<e.near||G>e.far||(t.push({distance:G,point:l.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this}),C=m)}}}}function o(e,t,n,r,a){var i;if(e=e.subarray||e.slice?e:e.buffer,n=n.subarray||n.slice?n:n.buffer,e=t?e.subarray?e.subarray(t,a&&t+a):e.slice(t,a&&t+a):e,n.set)n.set(e,r);else for(i=0;i<e.length;i++)n[i+r]=e[i];return n}function s(e){r.ShaderMaterial.call(this,{uniforms:Object.assign({},r.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new r.Color(16777215)},opacity:{value:1},resolution:{value:new r.Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new r.Vector2(1,1)}}),vertexShader:r.ShaderChunk.meshline_vert,fragmentShader:r.ShaderChunk.meshline_frag}),this.type="MeshLineMaterial",Object.defineProperties(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(e){this.uniforms.map.value=e}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(e){this.uniforms.useMap.value=e}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(e){this.uniforms.alphaMap.value=e}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(e){this.uniforms.useAlphaMap.value=e}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(e){this.uniforms.color.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value.copy(e)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(e){this.uniforms.sizeAttenuation.value=e}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(e){this.uniforms.dashArray.value=e,this.useDash=0!==e?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(e){this.uniforms.dashOffset.value=e}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(e){this.uniforms.dashRatio.value=e}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(e){this.uniforms.useDash.value=e}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(e){this.uniforms.visibility.value=e}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(e){this.uniforms.repeat.value.copy(e)}}}),this.setValues(e)}a.prototype=Object.create(r.BufferGeometry.prototype),a.prototype.constructor=a,a.prototype.isMeshLine=!0,a.prototype.setMatrixWorld=function(e){this.matrixWorld=e},a.prototype.setFromGeometry=function(e,t){e instanceof r.Geometry&&this.setVertices(e.vertices,t),e instanceof r.BufferGeometry&&this.setBufferArray(e.getAttribute("position").array,t),(e instanceof Float32Array||e instanceof Array)&&this.setBufferArray(e,t)},a.prototype.setGeometry=function(e,t){this.setFromGeometry(e,t)},a.prototype.setVertices=function(e,t){this._vertices=e,this.widthCallback=t||this.widthCallback,this.positions=[],this.counters=[];for(var n=0;n<e.length;n++){var r=e[n],a=n/e.length;this.positions.push(r.x,r.y,r.z),this.positions.push(r.x,r.y,r.z),this.counters.push(a),this.counters.push(a)}this.process()},a.prototype.setBufferArray=function(e,t){this._bufferArray=e,this.widthCallback=t||this.widthCallback,this.positions=[],this.counters=[];for(var n=0;n<e.length;n+=3){var r=n/e.length;this.positions.push(e[n],e[n+1],e[n+2]),this.positions.push(e[n],e[n+1],e[n+2]),this.counters.push(r),this.counters.push(r)}this.process()},a.prototype.raycast=i,a.prototype.compareV3=function(e,t){var n=6*e,r=6*t;return this.positions[n]===this.positions[r]&&this.positions[n+1]===this.positions[r+1]&&this.positions[n+2]===this.positions[r+2]},a.prototype.copyV3=function(e){var t=6*e;return[this.positions[t],this.positions[t+1],this.positions[t+2]]},a.prototype.process=function(){var e,t,n=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],t=this.compareV3(0,n-1)?this.copyV3(n-2):this.copyV3(0),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);for(var a=0;a<n;a++){if(this.side.push(1),this.side.push(-1),e=this.widthCallback?this.widthCallback(a/(n-1)):1,this.width.push(e),this.width.push(e),this.uvs.push(a/(n-1),0),this.uvs.push(a/(n-1),1),a<n-1){t=this.copyV3(a),this.previous.push(t[0],t[1],t[2]),this.previous.push(t[0],t[1],t[2]);var i=2*a;this.indices_array.push(i,i+1,i+2),this.indices_array.push(i+2,i+1,i+3)}a>0&&(t=this.copyV3(a),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]))}t=this.compareV3(n-1,0)?this.copyV3(1):this.copyV3(n-1),this.next.push(t[0],t[1],t[2]),this.next.push(t[0],t[1],t[2]),this._attributes&&this._attributes.position.count===this.positions.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new r.BufferAttribute(new Float32Array(this.positions),3),previous:new r.BufferAttribute(new Float32Array(this.previous),3),next:new r.BufferAttribute(new Float32Array(this.next),3),side:new r.BufferAttribute(new Float32Array(this.side),1),width:new r.BufferAttribute(new Float32Array(this.width),1),uv:new r.BufferAttribute(new Float32Array(this.uvs),2),index:new r.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new r.BufferAttribute(new Float32Array(this.counters),1)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()},a.prototype.advance=function(e){var t=this._attributes.position.array,n=this._attributes.previous.array,r=this._attributes.next.array,a=t.length;o(t,0,n,0,a),o(t,6,t,0,a-6),t[a-6]=e.x,t[a-5]=e.y,t[a-4]=e.z,t[a-3]=e.x,t[a-2]=e.y,t[a-1]=e.z,o(t,6,r,0,a-6),r[a-6]=e.x,r[a-5]=e.y,r[a-4]=e.z,r[a-3]=e.x,r[a-2]=e.y,r[a-1]=e.z,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0},r.ShaderChunk.meshline_vert=["",r.ShaderChunk.logdepthbuf_pars_vertex,r.ShaderChunk.fog_pars_vertex,"","attribute vec3 previous;","attribute vec3 next;","attribute float side;","attribute float width;","attribute float counters;","","uniform vec2 resolution;","uniform float lineWidth;","uniform vec3 color;","uniform float opacity;","uniform float sizeAttenuation;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","vec2 fix( vec4 i, float aspect ) {","","    vec2 res = i.xy / i.w;","    res.x *= aspect;","\t vCounters = counters;","    return res;","","}","","void main() {","","    float aspect = resolution.x / resolution.y;","","    vColor = vec4( color, opacity );","    vUV = uv;","","    mat4 m = projectionMatrix * modelViewMatrix;","    vec4 finalPosition = m * vec4( position, 1.0 );","    vec4 prevPos = m * vec4( previous, 1.0 );","    vec4 nextPos = m * vec4( next, 1.0 );","","    vec2 currentP = fix( finalPosition, aspect );","    vec2 prevP = fix( prevPos, aspect );","    vec2 nextP = fix( nextPos, aspect );","","    float w = lineWidth * width;","","    vec2 dir;","    if( nextP == currentP ) dir = normalize( currentP - prevP );","    else if( prevP == currentP ) dir = normalize( nextP - currentP );","    else {","        vec2 dir1 = normalize( currentP - prevP );","        vec2 dir2 = normalize( nextP - currentP );","        dir = normalize( dir1 + dir2 );","","        vec2 perp = vec2( -dir1.y, dir1.x );","        vec2 miter = vec2( -dir.y, dir.x );","        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );","","    }","","    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;","    vec4 normal = vec4( -dir.y, dir.x, 0., 1. );","    normal.xy *= .5 * w;","    normal *= projectionMatrix;","    if( sizeAttenuation == 0. ) {","        normal.xy *= finalPosition.w;","        normal.xy /= ( vec4( resolution, 0., 1. ) * projectionMatrix ).xy;","    }","","    finalPosition.xy += normal.xy * side;","","    gl_Position = finalPosition;","",r.ShaderChunk.logdepthbuf_vertex,r.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",r.ShaderChunk.fog_vertex,"}"].join("\n"),r.ShaderChunk.meshline_frag=["",r.ShaderChunk.fog_pars_fragment,r.ShaderChunk.logdepthbuf_pars_fragment,"","uniform sampler2D map;","uniform sampler2D alphaMap;","uniform float useMap;","uniform float useAlphaMap;","uniform float useDash;","uniform float dashArray;","uniform float dashOffset;","uniform float dashRatio;","uniform float visibility;","uniform float alphaTest;","uniform vec2 repeat;","","varying vec2 vUV;","varying vec4 vColor;","varying float vCounters;","","void main() {","",r.ShaderChunk.logdepthbuf_fragment,"","    vec4 c = vColor;","    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );","    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;","    if( c.a < alphaTest ) discard;","    if( useDash == 1. ){","        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));","    }","    gl_FragColor = c;","    gl_FragColor.a *= step(vCounters, visibility);","",r.ShaderChunk.fog_fragment,"}"].join("\n"),s.prototype=Object.create(r.ShaderMaterial.prototype),s.prototype.constructor=s,s.prototype.isMeshLineMaterial=!0,s.prototype.copy=function(e){return r.ShaderMaterial.prototype.copy.call(this,e),this.lineWidth=e.lineWidth,this.map=e.map,this.useMap=e.useMap,this.alphaMap=e.alphaMap,this.useAlphaMap=e.useAlphaMap,this.color.copy(e.color),this.opacity=e.opacity,this.resolution.copy(e.resolution),this.sizeAttenuation=e.sizeAttenuation,this.dashArray.copy(e.dashArray),this.dashOffset.copy(e.dashOffset),this.dashRatio.copy(e.dashRatio),this.useDash=e.useDash,this.visibility=e.visibility,this.alphaTest=e.alphaTest,this.repeat.copy(e.repeat),this},e.exports&&(t=e.exports={MeshLine:a,MeshLineMaterial:s,MeshLineRaycast:i}),t.MeshLine=a,t.MeshLineMaterial=s,t.MeshLineRaycast=i}).call(this)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(19),o=n(10),s=n(18);var u=Object(o.b)({conv3DBackpropInput_:function(e,t,n,o,u){i.b(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var c=e,l=t,g=!1;4===t.rank&&(g=!0,l=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),c=[1,e[0],e[1],e[2],e[3]]);var d=c[4],h=l.shape[4];i.b(5===c.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(c.length,".")})),i.b(5===l.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(l.rank)})),i.b(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),i.b(d===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(d,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),i.b(h===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var f={dy:l,filter:n},p={pad:u,strides:o,inputShape:c},I=r.a.runKernel(a.H,f,p);return g?Object(s.a)(I,[I.shape[1],I.shape[2],I.shape[3],I.shape[4]]):I}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(189),a=n(11),i=n(6),o=n(5),s=n(19),u=n(10),c=n(18);var l=Object(u.b)({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=Object(o.a)(e,"images","resizeNearestNeighbor");s.b(3===l.rank||4===l.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),s.b(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),s.b("float32"===l.dtype||"int32"===l.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),s.b(!1===u||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var g=l,d=!1;3===l.rank&&(d=!0,g=Object(c.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Object(r.a)(t);var h={images:g},f={alignCorners:n,halfPixelCenters:u,size:t},p=a.a.runKernel(i.rc,h,f);return d?Object(c.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(189),a=n(11),i=n(6),o=n(5),s=n(19),u=n(10),c=n(18);var l=Object(u.b)({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=Object(o.a)(e,"images","resizeBilinear");s.b(3===l.rank||4===l.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),s.b(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),s.b(!1===u||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var g=l,d=!1;3===l.rank&&(d=!0,g=Object(c.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Object(r.a)(t);var h={images:g},f={alignCorners:n,halfPixelCenters:u,size:t},p=a.a.runKernel(i.pc,h,f);return d?Object(c.a)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(10),o=n(18);var s=Object(i.b)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,i,s){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=t,g=!1;3===t.rank&&(g=!0,l=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={dy:l,filter:n},h={strides:i,pad:s,dimRoundingMode:c,dilations:u,inputShape:e},f=r.a.runKernel(a.Q,d,h);return g?Object(o.a)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(10),o=n(18);var s=Object(i.b)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,i,s){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=e;3===e.rank&&(l=Object(o.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var g=t;3===g.rank&&(g=Object(o.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={x:l,dy:g},h={strides:i,pad:s,dimRoundingMode:c,dilations:u,filterShape:n};return r.a.runKernel(a.P,d,h)}})},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(148))},function(e,t,n){"use strict";t.a=function(e){return e}},function(e,t,n){"use strict";t.a=function(e,t,n){var r=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(a);++r<a;)i[r]=e[r+t];return i}},function(e,t,n){"use strict";e.exports=n(425)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStartTime=function(e){return d(e,u)},t.parseEndTime=function(e){return d(e,c)},t.randomString=function(){return Math.random().toString(36).substr(2,5)},t.queryString=function(e){return Object.keys(e).map((function(t){return"".concat(t,"=").concat(e[t])})).join("&")},t.getSDK=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.default,o=h(t);if(o&&a(o))return Promise.resolve(o);return new Promise((function(r,a){if(f[e])f[e].push({resolve:r,reject:a});else{f[e]=[{resolve:r,reject:a}];var o=function(t){f[e].forEach((function(e){return e.resolve(t)}))};if(n){var s=window[n];window[n]=function(){s&&s(),o(h(t))}}i(e,(function(r){r?(f[e].forEach((function(e){return e.reject(r)})),f[e]=null):n||o(h(t))}))}}))},t.getConfig=function(e,t){return(0,a.default)(t.config,e.config)},t.omit=function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var i=(t=[]).concat.apply(t,r),o={},s=Object.keys(e),u=0,c=s;u<c.length;u++){var l=c[u];-1===i.indexOf(l)&&(o[l]=e[l])}return o},t.callPlayer=function(e){var t;if(!this.player||!this.player[e]){var n="ReactPlayer: ".concat(this.constructor.displayName," player could not call %c").concat(e,"%c \u2013 ");return this.player?this.player[e]||(n+="The method was not available"):n+="The player was not available",console.warn(n,"font-weight: bold",""),null}for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return(t=this.player)[e].apply(t,a)},t.isMediaStream=function(e){return"undefined"!==typeof window&&"undefined"!==typeof window.MediaStream&&e instanceof window.MediaStream},t.isBlobUrl=function(e){return/^blob:/.test(e)},t.supportsWebKitPresentationMode=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("video"),t=!1===/iPhone|iPod/.test(navigator.userAgent);return e.webkitSupportsPresentationMode&&"function"===typeof e.webkitSetPresentationMode&&t};var r=i(n(418)),a=i(n(293));function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u=/[?&#](?:start|t)=([0-9hms]+)/,c=/[?&#]end=([0-9hms]+)/,l=/(\d+)(h|m|s)/g,g=/^\d+$/;function d(e,t){if(!(e instanceof Array)){var n=e.match(t);if(n){var r=n[1];if(r.match(l))return function(e){var t=0,n=l.exec(e);for(;null!==n;){var r=o(n,3),a=r[1],i=r[2];"h"===i&&(t+=60*parseInt(a,10)*60),"m"===i&&(t+=60*parseInt(a,10)),"s"===i&&(t+=parseInt(a,10)),n=l.exec(e)}return t}(r);if(g.test(r))return parseInt(r)}}}function h(e){return window[e]?window[e]:window.exports&&window.exports[e]?window.exports[e]:window.module&&window.module.exports&&window.module.exports[e]?window.module.exports[e]:null}var f={}},,,function(e,t,n){"use strict";(function(e){var r=n(426),a=n(427),i=n(428);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return g(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=d(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),a=(e=s(e,r)).write(t,n);a!==r&&(e=e.slice(0,a));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?s(e,0):d(e,t);if("Buffer"===t.type&&i(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function g(e,t){if(l(t),e=s(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function f(e,t){if(u.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return X(e).length;t=(""+t).toLowerCase(),r=!0}}function p(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return Z(this,t,n);case"base64":return B(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function I(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function C(e,t,n,r,a){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,a);if("number"===typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,a){var i,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var l=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var g=!0,d=0;d<u;d++)if(c(e,i+d)!==c(t,d)){g=!1;break}if(g)return i}return-1}function b(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function v(e,t,n,r){return Y(X(t,e.length-n),e,n,r)}function A(e,t,n,r){return Y(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function y(e,t,n,r){return A(e,t,n,r)}function w(e,t,n,r){return Y(H(t),e,n,r)}function G(e,t,n,r){return Y(function(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,a=n%256,i.push(a),i.push(r);return i}(t,e.length-n),e,n,r)}function B(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i,o,s,u,c=e[a],l=null,g=c>239?4:c>223?3:c>191?2:1;if(a+g<=n)switch(g){case 1:c<128&&(l=c);break;case 2:128===(192&(i=e[a+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[a+1],o=e[a+2],128===(192&i)&&128===(192&o)&&(u=(15&c)<<12|(63&i)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128===(192&i)&&128===(192&o)&&128===(192&s)&&(u=(15&c)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,g=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),a+=g}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=S));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=o(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"===typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return g(null,e)},u.allocUnsafeSlow=function(e){return g(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var o=e[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,a),a+=o.length}return r},u.byteLength=f,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)I(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)I(this,t,t+3),I(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)I(this,t,t+7),I(this,t+1,t+6),I(this,t+2,t+5),I(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):p.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,a){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(i,o),c=this.slice(r,a),l=e.slice(t,n),g=0;g<s;++g)if(c[g]!==l[g]){i=c[g],o=l[g];break}return i<o?-1:o<i?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return C(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return C(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":return A(this,e,t,n);case"latin1":case"binary":return y(this,e,t,n);case"base64":return w(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function k(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function Z(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=L(e[i]);return a}function N(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function O(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function W(e,t,n,r,a,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function F(e,t,n,r){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-n,2);a<i;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-n,4);a<i;++a)e[n+a]=t>>>8*(r?a:3-a)&255}function V(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function T(e,t,n,r,i){return i||V(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function E(e,t,n,r,i){return i||V(e,0,n,8),a.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var a=t-e;n=new u(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},u.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},u.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),a.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),a.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),a.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),a.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||W(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||W(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);W(this,e,t,n,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);W(this,e,t,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):F(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):F(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||W(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return T(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return T(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return E(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return E(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,i=r-n;if(this===e&&n<t&&t<r)for(a=i-1;a>=0;--a)e[a+t]=this[a+n];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},u.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=u.isBuffer(e)?e:X(new u(e,r).toString()),s=o.length;for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function L(e){return e<16?"0"+e.toString(16):e.toString(16)}function X(e,t){var n;t=t||1/0;for(var r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function Y(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}}).call(this,n(148))},function(e,t,n){"use strict";var r=n(64);Object.defineProperty(t,"__esModule",{value:!0}),t.sumArrayTill=function(e,t){return(0,i.default)((0,d.default)(e,t))},t.calculateSegmentStops=function(e){var t=e.tickData,n=e.customSegmentStops,r=e.min,a=e.max;if(!(0,s.default)(n)||(0,o.default)(n))return t;if((0,u.default)(n)!==r)throw new Error("First value should be equivalent to min value given. Current min value - ".concat(r));if((0,c.default)(n)!==a)throw new Error("Last value should be equivalent to max value given. Current min value - ".concat(a));var i=n.map((function(e,t){return 0===t?void 0:(e-n[t-1])/(a-r)}));return(0,l.default)(i)},t.calculateNeedleHeight=function(e){var t=e.heightRatio,n=e.radius;if(0>t||1<t)throw new Error("Invalid needleHeightRatio given - ".concat(t));return Math.round(n*t)},t.calculateSegmentLabelCount=function(e){var t=e.maxSegmentLabelCount,n=e.segmentCount,r=parseInt(t,10),i=parseInt(n,10);return(0,a.default)(r)&&0<=r&&r<=i?r:i},t.calculateScale=function(e){var t=e.min,n=e.max;e.segments;return(0,h.scaleLinear)().range([0,1]).domain([t,n])},t.calculateTicks=function(e,t){var n=t.min,r=t.max,a=t.segments,i=[];i=e.ticks(a),((0,c.default)(i)!==r||a<i.length)&&1<i.length&&(i=[n],(0,g.default)(a,(function(e){i.push(n+(e+1)*((r-n)/a))})));return 1===i.length&&(i=[n,r]),i},t.formatCurrentValueText=function(e,t){var n=t.labelFormat(e),r=t.currentValuePlaceholderStyle;return t.currentValueText.replace(r,n)},t.deg2rad=function(e){return e*Math.PI/180},t.centerTranslation=function(e,t,n){return"translate(".concat(e+t,", ").concat(e+n,")")},t.getRadius=function(e){return e.width/2};var a=r(n(451)),i=r(n(462)),o=r(n(335)),s=r(n(256)),u=r(n(452)),c=r(n(453)),l=r(n(454)),g=r(n(461)),d=r(n(455)),h=n(160)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transition=t.CustomSegmentLabelPosition=void 0;t.CustomSegmentLabelPosition={Inside:"INSIDE",Outside:"OUTSIDE"};t.Transition={easeLinear:"easeLinear",easeQuadIn:"easeQuadIn",easeQuadOut:"easeQuadOut",easeQuadInOut:"easeQuadInOut",easeCubicIn:"easeCubicIn",easeCubicOut:"easeCubicOut",easeCubicInOut:"easeCubicInOut",easePolyIn:"easePolyIn",easePolyOut:"easePolyOut",easePolyInOut:"easePolyInOut",easeSinIn:"easeSinIn",easeSinOut:"easeSinOut",easeSinInOut:"easeSinInOut",easeExpIn:"easeExpIn",easeExpOut:"easeExpOut",easeExpInOut:"easeExpInOut",easeCircleIn:"easeCircleIn",easeCircleOut:"easeCircleOut",easeCircleInOut:"easeCircleInOut",easeBounceIn:"easeBounceIn",easeBounceOut:"easeBounceOut",easeBounceInOut:"easeBounceInOut",easeBackIn:"easeBackIn",easeBackOut:"easeBackOut",easeBackInOut:"easeBackInOut",easeElasticIn:"easeElasticIn",easeElasticOut:"easeElasticOut",easeElasticInOut:"easeElasticInOut",easeElastic:"easeElastic"}},function(e,t){function n(e,t,n){var r,a,i,o,s;function u(){var c=Date.now()-o;c<t&&c>=0?r=setTimeout(u,t-c):(r=null,n||(s=e.apply(i,a),i=a=null))}null==t&&(t=100);var c=function(){i=this,a=arguments,o=Date.now();var c=n&&!r;return r||(r=setTimeout(u,t)),c&&(s=e.apply(i,a),i=a=null),s};return c.clear=function(){r&&(clearTimeout(r),r=null)},c.flush=function(){r&&(s=e.apply(i,a),i=a=null,clearTimeout(r),r=null)},c}n.debounce=n,e.exports=n},function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(x){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function a(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=a;var i={},o={};function s(e,t){var n,r,a;return t?(a=0<=(e>>>=0)&&e<256)&&(r=o[e])?r:(n=c(e,(0|e)<0?-1:0,!0),a&&(o[e]=n),n):(a=-128<=(e|=0)&&e<128)&&(r=i[e])?r:(n=c(e,e<0?-1:0,!1),a&&(i[e]=n),n)}function u(e,t){if(isNaN(e))return t?m:C;if(t){if(e<0)return m;if(e>=f)return w}else{if(e<=-p)return G;if(e+1>=p)return y}return e<0?u(-e,t).neg():c(e%h|0,e/h|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=s,r.fromNumber=u,r.fromBits=c;var l=Math.pow;function g(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return C;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return g(e.substring(1),t,n).neg();for(var a=u(l(n,8)),i=C,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),c=parseInt(e.substring(o,o+s),n);if(s<8){var d=u(l(n,s));i=i.mul(d).add(u(c))}else i=(i=i.mul(a)).add(u(c))}return i.unsigned=t,i}function d(e,t){return"number"===typeof e?u(e,t):"string"===typeof e?g(e,t):c(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}r.fromString=g,r.fromValue=d;var h=4294967296,f=h*h,p=f/2,I=s(1<<24),C=s(0);r.ZERO=C;var m=s(0,!0);r.UZERO=m;var b=s(1);r.ONE=b;var v=s(1,!0);r.UONE=v;var A=s(-1);r.NEG_ONE=A;var y=c(-1,2147483647,!1);r.MAX_VALUE=y;var w=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=w;var G=c(0,-2147483648,!1);r.MIN_VALUE=G;var B=r.prototype;B.toInt=function(){return this.unsigned?this.low>>>0:this.low},B.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},B.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(G)){var t=u(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=u(l(e,6),this.unsigned),i=this,o="";;){var s=i.div(a),c=(i.sub(s.mul(a)).toInt()>>>0).toString(e);if((i=s).isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},B.getHighBits=function(){return this.high},B.getHighBitsUnsigned=function(){return this.high>>>0},B.getLowBits=function(){return this.low},B.getLowBitsUnsigned=function(){return this.low>>>0},B.getNumBitsAbs=function(){if(this.isNegative())return this.eq(G)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},B.isZero=function(){return 0===this.high&&0===this.low},B.eqz=B.isZero,B.isNegative=function(){return!this.unsigned&&this.high<0},B.isPositive=function(){return this.unsigned||this.high>=0},B.isOdd=function(){return 1===(1&this.low)},B.isEven=function(){return 0===(1&this.low)},B.equals=function(e){return a(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},B.eq=B.equals,B.notEquals=function(e){return!this.eq(e)},B.neq=B.notEquals,B.ne=B.notEquals,B.lessThan=function(e){return this.comp(e)<0},B.lt=B.lessThan,B.lessThanOrEqual=function(e){return this.comp(e)<=0},B.lte=B.lessThanOrEqual,B.le=B.lessThanOrEqual,B.greaterThan=function(e){return this.comp(e)>0},B.gt=B.greaterThan,B.greaterThanOrEqual=function(e){return this.comp(e)>=0},B.gte=B.greaterThanOrEqual,B.ge=B.greaterThanOrEqual,B.compare=function(e){if(a(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},B.comp=B.compare,B.negate=function(){return!this.unsigned&&this.eq(G)?G:this.not().add(b)},B.neg=B.negate,B.add=function(e){a(e)||(e=d(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,u=e.low>>>16,l=0,g=0,h=0,f=0;return h+=(f+=i+(65535&e.low))>>>16,g+=(h+=r+u)>>>16,l+=(g+=n+s)>>>16,l+=t+o,c((h&=65535)<<16|(f&=65535),(l&=65535)<<16|(g&=65535),this.unsigned)},B.subtract=function(e){return a(e)||(e=d(e)),this.add(e.neg())},B.sub=B.subtract,B.multiply=function(e){if(this.isZero())return C;if(a(e)||(e=d(e)),n)return c(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return C;if(this.eq(G))return e.isOdd()?G:C;if(e.eq(G))return this.isOdd()?G:C;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(I)&&e.lt(I))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=e.high>>>16,l=65535&e.high,g=e.low>>>16,h=65535&e.low,f=0,p=0,m=0,b=0;return m+=(b+=o*h)>>>16,p+=(m+=i*h)>>>16,m&=65535,p+=(m+=o*g)>>>16,f+=(p+=r*h)>>>16,p&=65535,f+=(p+=i*g)>>>16,p&=65535,f+=(p+=o*l)>>>16,f+=t*h+r*g+i*l+o*s,c((m&=65535)<<16|(b&=65535),(f&=65535)<<16|(p&=65535),this.unsigned)},B.mul=B.multiply,B.divide=function(e){if(a(e)||(e=d(e)),e.isZero())throw Error("division by zero");var t,r,i;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:C;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return v;i=m}else{if(this.eq(G))return e.eq(b)||e.eq(A)?G:e.eq(G)?b:(t=this.shr(1).div(e).shl(1)).eq(C)?e.isNegative()?b:A:(r=this.sub(e.mul(t)),i=t.add(r.div(e)));if(e.eq(G))return this.unsigned?m:C;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=C}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(t)/Math.LN2),s=o<=48?1:l(2,o-48),g=u(t),h=g.mul(e);h.isNegative()||h.gt(r);)h=(g=u(t-=s,this.unsigned)).mul(e);g.isZero()&&(g=b),i=i.add(g),r=r.sub(h)}return i},B.div=B.divide,B.modulo=function(e){return a(e)||(e=d(e)),n?c((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},B.mod=B.modulo,B.rem=B.modulo,B.not=function(){return c(~this.low,~this.high,this.unsigned)},B.and=function(e){return a(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},B.or=function(e){return a(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},B.xor=function(e){return a(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},B.shiftLeft=function(e){return a(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},B.shl=B.shiftLeft,B.shiftRight=function(e){return a(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},B.shr=B.shiftRight,B.shiftRightUnsigned=function(e){if(a(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},B.shru=B.shiftRightUnsigned,B.shr_u=B.shiftRightUnsigned,B.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},B.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},B.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},B.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},B.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},function(e,t,n){"use strict";var r=n(74),a=n(64);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"CustomSegmentLabelPosition",{enumerable:!0,get:function(){return C.CustomSegmentLabelPosition}}),Object.defineProperty(t,"Transition",{enumerable:!0,get:function(){return C.Transition}}),t.default=void 0;var i=a(n(444)),o=a(n(445)),s=a(n(332)),u=a(n(446)),c=a(n(448)),l=a(n(449)),g=a(n(333)),d=r(n(2)),h=a(n(52)),f=n(160),p=n(450),I=n(456),C=n(281);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.default)(e);if(t){var a=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}var b=function(e){function t(e){var r;return(0,i.default)(this,t),r=n.call(this,e),(0,g.default)((0,s.default)(r),"render",(function(){return d.default.createElement("div",{ref:function(e){return r.gaugeDiv=e}})})),r.d3_refs={pointer:!1,current_value_text:!1},r}(0,u.default)(t,e);var n=m(t);return(0,o.default)(t,[{key:"componentDidMount",value:function(){this.renderGauge()}},{key:"componentDidUpdate",value:function(){this.props.forceRender?this.renderGauge():this.updateReadings()}},{key:"renderGauge",value:function(){this.config=(0,p.getConfig)({PROPS:this.props,parentWidth:this.gaugeDiv.parentNode.clientWidth,parentHeight:this.gaugeDiv.parentNode.clientHeight}),(0,f.select)(this.gaugeDiv).select("svg").remove(),this.d3_refs=(0,I.render)({container:this.gaugeDiv,config:this.config}),(0,I.update)({d3_refs:this.d3_refs,newValue:this.props.value,config:this.config})}},{key:"updateReadings",value:function(){this.config=(0,p.updateConfig)(this.config,{labelFormat:(0,f.format)(this.props.valueFormat||""),currentValueText:this.props.currentValueText||"${value}"}),(0,I.update)({d3_refs:this.d3_refs,newValue:this.props.value||0,config:this.config})}}]),t}(d.PureComponent);(0,g.default)(b,"displayName","ReactSpeedometer"),b.propTypes={value:h.default.number.isRequired,minValue:h.default.number.isRequired,maxValue:h.default.number.isRequired,forceRender:h.default.bool.isRequired,width:h.default.number.isRequired,height:h.default.number.isRequired,paddingHorizontal:h.default.number.isRequired,paddingVertical:h.default.number.isRequired,dimensionUnit:h.default.string.isRequired,fluidWidth:h.default.bool.isRequired,segments:h.default.number.isRequired,maxSegmentLabels:h.default.number,customSegmentStops:h.default.array,customSegmentLabels:h.default.arrayOf(h.default.shape({text:h.default.string,position:h.default.oneOf(["OUTSIDE","INSIDE"]),fontSize:h.default.string,color:h.default.string})),needleColor:h.default.string.isRequired,startColor:h.default.string.isRequired,endColor:h.default.string.isRequired,segmentColors:h.default.array.isRequired,needleTransition:h.default.string.isRequired,needleTransitionDuration:h.default.number.isRequired,needleHeightRatio:h.default.number.isRequired,ringWidth:h.default.number.isRequired,textColor:h.default.string.isRequired,valueFormat:h.default.string.isRequired,currentValueText:h.default.string.isRequired,currentValuePlaceholderStyle:h.default.string.isRequired,labelFontSize:h.default.string.isRequired,valueTextFontSize:h.default.string.isRequired,valueTextFontWeight:h.default.string.isRequired},b.defaultProps=p.DEFAULT_PROPS;var v=b;t.default=v},function(e,t,n){"use strict";(function(e){var r=n(272),a="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=a&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===a&&r.a.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();t.a=s}).call(this,n(334)(e))},function(e,t,n){"use strict";var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,a=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.a=a},,,,function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===a}(e)}(e)};var a="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?l((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function o(e,t,n){return e.concat(t).map((function(e){return i(e,n)}))}function s(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function u(e,t){try{return t in e}catch(n){return!1}}function c(e,t,n){var r={};return n.isMergeableObject(e)&&s(e).forEach((function(t){r[t]=i(e[t],n)})),s(t).forEach((function(a){(function(e,t){return u(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,a)||(u(e,a)&&n.isMergeableObject(t[a])?r[a]=function(e,t){if(!t.customMerge)return l;var n=t.customMerge(e);return"function"===typeof n?n:l}(a,n)(e[a],t[a],n):r[a]=i(t[a],n))})),r}function l(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||o,n.isMergeableObject=n.isMergeableObject||r,n.cloneUnlessOtherwiseSpecified=i;var a=Array.isArray(t);return a===Array.isArray(e)?a?n.arrayMerge(e,t,n):c(e,t,n):i(t,n)}l.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return l(e,n,t)}),{})};var g=l;e.exports=g},function(e,t,n){"use strict";n.r(t);var r=Number.isNaN||function(e){return"number"===typeof e&&e!==e};function a(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(a=e[n],i=t[n],!(a===i||r(a)&&r(i)))return!1;var a,i;return!0}t.default=function(e,t){var n;void 0===t&&(t=a);var r,i=[],o=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return o&&n===this&&t(a,i)||(r=e.apply(this,a),o=!0,n=this,i=a),r}}},function(e,t){var n="undefined"!==typeof Element,r="function"===typeof Map,a="function"===typeof Set,i="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function o(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var s,u,c,l;if(Array.isArray(e)){if((s=e.length)!=t.length)return!1;for(u=s;0!==u--;)if(!o(e[u],t[u]))return!1;return!0}if(r&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(l=e.entries();!(u=l.next()).done;)if(!t.has(u.value[0]))return!1;for(l=e.entries();!(u=l.next()).done;)if(!o(u.value[1],t.get(u.value[0])))return!1;return!0}if(a&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(l=e.entries();!(u=l.next()).done;)if(!t.has(u.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((s=e.length)!=t.length)return!1;for(u=s;0!==u--;)if(e[u]!==t[u])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if((s=(c=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(u=s;0!==u--;)if(!Object.prototype.hasOwnProperty.call(t,c[u]))return!1;if(n&&e instanceof Element)return!1;for(u=s;0!==u--;)if(("_owner"!==c[u]&&"__v"!==c[u]&&"__o"!==c[u]||!e.$$typeof)&&!o(e[c[u]],t[c[u]]))return!1;return!0}return e!==e&&t!==t}e.exports=function(e,t){try{return o(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProps=t.propTypes=void 0;var r,a=(r=n(52))&&r.__esModule?r:{default:r};var i=a.default.string,o=a.default.bool,s=a.default.number,u=a.default.array,c=a.default.oneOfType,l=a.default.shape,g=a.default.object,d=a.default.func,h=a.default.node,f={url:c([i,u,g]),playing:o,loop:o,controls:o,volume:s,muted:o,playbackRate:s,width:c([i,s]),height:c([i,s]),style:g,progressInterval:s,playsinline:o,pip:o,stopOnUnmount:o,light:c([o,i]),playIcon:h,previewTabIndex:s,fallback:h,wrapper:c([i,d,l({render:d.isRequired})]),config:l({soundcloud:l({options:g}),youtube:l({playerVars:g,embedOptions:g,onUnstarted:d}),facebook:l({appId:i,version:i,playerId:i,attributes:g}),dailymotion:l({params:g}),vimeo:l({playerOptions:g}),file:l({attributes:g,tracks:u,forceVideo:o,forceAudio:o,forceHLS:o,forceDASH:o,forceFLV:o,hlsOptions:g,hlsVersion:i,dashVersion:i,flvVersion:i}),wistia:l({options:g,playerId:i,customControls:u}),mixcloud:l({options:g}),twitch:l({options:g,playerId:i}),vidyard:l({options:g})}),onReady:d,onStart:d,onPlay:d,onPause:d,onBuffer:d,onBufferEnd:d,onEnded:d,onError:d,onDuration:d,onSeek:d,onProgress:d,onClickPreview:d,onEnablePIP:d,onDisablePIP:d};t.propTypes=f;var p=function(){},I={playing:!1,loop:!1,controls:!1,volume:null,muted:!1,playbackRate:1,width:"640px",height:"360px",style:{},progressInterval:1e3,playsinline:!1,pip:!1,stopOnUnmount:!0,light:!1,fallback:null,wrapper:"div",previewTabIndex:0,config:{soundcloud:{options:{visual:!0,buying:!1,liking:!1,download:!1,sharing:!1,show_comments:!1,show_playcount:!1}},youtube:{playerVars:{playsinline:1,showinfo:0,rel:0,iv_load_policy:3,modestbranding:1},embedOptions:{},onUnstarted:p},facebook:{appId:"1309697205772819",version:"v3.3",playerId:null,attributes:{}},dailymotion:{params:{api:1,"endscreen-enable":!1}},vimeo:{playerOptions:{autopause:!1,byline:!1,portrait:!1,title:!1}},file:{attributes:{},tracks:[],forceVideo:!1,forceAudio:!1,forceHLS:!1,forceDASH:!1,forceFLV:!1,hlsOptions:{},hlsVersion:"0.14.16",dashVersion:"3.1.3",flvVersion:"1.5.0"},wistia:{options:{},playerId:null,customControls:null},mixcloud:{options:{hide_cover:1}},twitch:{options:{},playerId:null},vidyard:{options:{}}},onReady:p,onStart:p,onPlay:p,onPause:p,onBuffer:p,onBufferEnd:p,onEnded:p,onError:p,onDuration:p,onSeek:p,onProgress:p,onClickPreview:p,onEnablePIP:p,onDisablePIP:p};t.defaultProps=I},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({acos_:function(e){var t={x:Object(i.a)(e,"x","acos")};return r.a.runKernel(a.b,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({acosh_:function(e){var t={x:Object(i.a)(e,"x","acosh")};return r.a.runKernel(a.c,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({addN_:function(e){o.b(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),o.b(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return Object(i.a)(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!o.a(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var s=t;return r.a.runKernel(a.e,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({asin_:function(e){var t={x:Object(i.a)(e,"x","asin")};return r.a.runKernel(a.j,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({asinh_:function(e){var t={x:Object(i.a)(e,"x","asinh")};return r.a.runKernel(a.k,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({atan_:function(e){var t={x:Object(i.a)(e,"x","atan")};return r.a.runKernel(a.l,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({atanh_:function(e){var t={x:Object(i.a)(e,"x","atanh")};return r.a.runKernel(a.n,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(27),u=n(10),c=n(18);var l=Object(u.b)({avgPool3d_:function(e,t,n,u,l){var g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",d=Object(i.a)(e,"x","avgPool3d","float32"),h=d,f=!1;4===d.rank&&(f=!0,h=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.b(5===h.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(h.rank,".")})),o.b("NDHWC"===g,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(g)})),null!=l&&o.b(o.v(u),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(u,".")}));var p={x:h},I={filterSize:t,strides:n,pad:u,dimRoundingMode:l,dataFormat:g},C=r.a.runKernel(a.p,p,I);return C=Object(s.a)(C,h.dtype),f?Object(c.a)(C,[C.shape[1],C.shape[2],C.shape[3],C.shape[4]]):C}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({ceil_:function(e){var t={x:Object(i.a)(e,"x","ceil")};return r.a.runKernel(a.x,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({clipByValue_:function(e,t,n){var s=Object(i.a)(e,"x","clipByValue");o.b(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var u={x:s},c={clipValueMin:t,clipValueMax:n};return r.a.runKernel(a.y,u,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(53),u=n(10),c=n(18);var l=Object(u.b)({conv3d_:function(e,t,n,u){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],d=Object(i.a)(e,"x","conv3d"),h=Object(i.a)(t,"filter","conv3d"),f=d,p=!1;4===d.rank&&(p=!0,f=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.b(5===f.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(f.rank,".")})),o.b(5===h.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(h.rank,".")})),o.b(f.shape[4]===h.shape[3],(function(){return"Error in conv3d: depth of input (".concat(f.shape[4],") must match ")+"input depth for filter ".concat(h.shape[3],".")})),o.b(Object(s.h)(n,g),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(g,"'")})),o.b("NDHWC"===l,(function(){return"Error in conv3d: got dataFormat of ".concat(l," but only NDHWC is currently supported.")}));var I={x:f,filter:h},C={strides:n,pad:u,dataFormat:l,dilations:g},m=r.a.runKernel(a.F,I,C);return p?Object(c.a)(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10);var u=Object(s.b)({denseBincount_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(i.a)(e,"x","denseBincount"),c=Object(i.a)(t,"weights","denseBincount");o.b("int32"===u.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(u.dtype)})),o.b(u.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(u.rank,".")})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(c.size===u.size||0===c.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(u.shape,", weights shape: ")+"".concat(c.shape,".")}));var l={x:u,weights:c},g={size:n,binaryOutput:s};return r.a.runKernel(a.M,l,g)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var s=n.map((function(e,t){return Object(i.a)(e,"tensors".concat(t),"einsum")})),u={equation:e};return r.a.runKernel(a.V,s,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(27),u=n(10);var c=Object(u.b)({erf_:function(e){var t=Object(i.a)(e,"x","erf");o.b("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Object(s.a)(t,"float32"));var n={x:t};return r.a.runKernel(a.Z,n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({expm1_:function(e){var t={x:Object(i.a)(e,"x","expm1")};return r.a.runKernel(a.cb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({isFinite_:function(e){var t={x:Object(i.a)(e,"x","isFinite")};return r.a.runKernel(a.tb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({isInf_:function(e){var t={x:Object(i.a)(e,"x","isInf")};return r.a.runKernel(a.ub,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({isNaN_:function(e){var t={x:Object(i.a)(e,"x","isNaN")};return r.a.runKernel(a.vb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(11),a=n(6);function i(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var i={start:e,stop:t,num:n};return r.a.runKernel(a.Bb,{},i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(59),a=n(5),i=n(20),o=n(49),s=n(10),u=n(108),c=n(236);var l=Object(s.b)({logSigmoid_:function(e){var t=Object(a.a)(e,"x","logSigmoid");return Object(r.a)((function(e){return{value:Object(o.a)(Object(c.a)(Object(o.a)(e))),gradFunc:function(t){return Object(i.a)(t,Object(u.a)(Object(o.a)(e)))}}}))(t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(3),a=n(59),i=n(5),o=n(27),s=n(69),u=n(112),c=n(109),l=n(20),g=n(10),d=n(29),h=n(31);var f=Object(g.b)({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var g=Object(a.a)((function(e,n){var a=Object(c.a)(e,t,!0),i=Object(d.a)(e,a),g=Object(d.a)(Object(o.a)(i,"float32"),Object(u.a)(Object(h.a)(Object(s.a)(i),t,!0)));n([g]);return{value:g,gradFunc:function(e,n){var a=Object(r.a)(n,1)[0],i=Object(s.a)(a);return Object(d.a)(e,Object(l.a)(Object(h.a)(e,t,!0),i))}}}));return g(n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(11),a=n(6),i=n(5),o=n(19),s=n(10),u=n(18);var c=Object(s.b)({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",g=Object(i.a)(e,"x","maxPool3d"),d=g,h=!1;4===g.rank&&(h=!0,d=Object(u.a)(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),o.b(5===d.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(d.rank,".")})),o.b("NDHWC"===l,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(l)})),null!=c&&o.b(o.v(s),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(c," but got pad ").concat(s,".")}));var f={x:d},p={filterSize:t,strides:n,pad:s,dimRoundingMode:c,dataFormat:l},I=r.a.runKernel(a.Kb,f,p);return h?Object(u.a)(I,[I.shape[1],I.shape[2],I.shape[3],I.shape[4]]):I}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({maxPoolWithArgmax_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=Object(i.a)(e,"x","maxPoolWithArgmax"),c={x:u},l={filterSize:t,strides:n,pad:o,includeBatchInIndex:s},g=r.a.runKernel(a.Nb,c,l);return{result:g[0],indexes:g[1]}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(10),s=n(18);var u=Object(o.b)({multinomial_:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(i.a)(e,"logits","multinomial"),c=u.size,l=u.rank;if(c<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(c,"."));if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(l));n=n||Math.random();var g=1===l?Object(s.a)(u,[1,-1]):u,d={logits:g},h={numSamples:t,seed:n,normalized:o},f=r.a.runKernel(a.Ub,d,h);return 1===l?Object(s.a)(f,[f.size]):f}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({onesLike_:function(e){var t={x:Object(i.a)(e,"x","onesLike")};return r.a.runKernel(a.cc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({reciprocal_:function(e){var t={x:Object(i.a)(e,"x","reciprocal")};return r.a.runKernel(a.lc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(7),a=n.n(r),i=n(17),o=n(14),s=n(5),u=n(19);function c(){return(c=Object(i.a)(a.a.mark((function e(t,n){var r,i,c,l,g,d,h,f,p,I,C;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(s.a)(t,"x","setdiff1d"),i=Object(s.a)(n,"y","setdiff1d"),u.b(r.dtype===i.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(i.dtype,").")})),u.b(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),u.b(1===i.rank,(function(){return"y should be 1D tensor, but got y (".concat(i.shape,").")})),e.next=7,r.data();case 7:return c=e.sent,e.next=10,i.data();case 10:for(l=e.sent,g=new Set(l),d=0,h=0;h<c.length;h++)g.has(c[h])||d++;for(f=new o.b([d],r.dtype),p=new o.b([d],"int32"),I=0,C=0;I<c.length;I++)g.has(c[I])||(f.values[C]=c[I],p.values[C]=I,C++);return e.abrupt("return",[f.toTensor(),p.toTensor()]);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(e,t){return c.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({sign_:function(e){var t={x:Object(i.a)(e,"x","sign")};return r.a.runKernel(a.Bc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var o={logits:n},s={dim:t};return r.a.runKernel(a.Fc,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({stridedSlice_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,g=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=Object(i.a)(e,"x","stridedSlice","string_or_numeric"),h={x:d},f={begin:t,end:n,strides:o,beginMask:s,endMask:u,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:g};return r.a.runKernel(a.Sc,h,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({tan_:function(e){var t={x:Object(i.a)(e,"x","tan")};return r.a.runKernel(a.Yc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(76),a=n(10),i=n(144);var o=Object(a.b)({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");for(var s=new i.a(t,n,a,!0,o),u=Object(r.a)(e,a),c=0;c<u.values.length;c++)u.values[c]=s.nextValue();return u.toTensor()}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6),i=n(5),o=n(10),s=n(162);var u=Object(o.b)({scatterND_:function(e,t,n){var o=Object(i.a)(e,"indices","scatterND","int32"),u=Object(i.a)(t,"updates","scatterND");s.b(u,o,n);var c={indices:o,updates:u},l={shape:n};return r.a.runKernel(a.xc,c,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(11),a=n(6),i=n(5),o=n(10);var s=Object(o.b)({gatherND_:function(e,t){var n=Object(i.a)(t,"indices","gatherND","int32"),o={params:Object(i.a)(e,"x","gatherND","string_or_numeric"),indices:n};return r.a.runKernel(a.mb,o)}})},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof e?e:function(e){return e()};function a(){return new Promise((function(e){return r((function(){return e()}))}))}}).call(this,n(440).setImmediate)},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";n.r(t);var r=Object.prototype;var a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)};var i=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),o=Object.prototype.hasOwnProperty;var s=function(e){if(!a(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t},u=n(98),c=n(155);var l=function(e){if(!Object(c.a)(e))return!1;var t=Object(u.a)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},g=n(80),d=g.a["__core-js_shared__"],h=function(){var e=/[^.]+$/.exec(d&&d.keys&&d.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var f=function(e){return!!h&&h in e},p=Function.prototype.toString;var I=function(e){if(null!=e){try{return p.call(e)}catch(t){}try{return e+""}catch(t){}}return""},C=/^\[object .+?Constructor\]$/,m=Function.prototype,b=Object.prototype,v=m.toString,A=b.hasOwnProperty,y=RegExp("^"+v.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var w=function(e){return!(!Object(c.a)(e)||f(e))&&(l(e)?y:C).test(I(e))};var G=function(e,t){return null==e?void 0:e[t]};var B=function(e,t){var n=G(e,t);return w(n)?n:void 0},x=B(g.a,"DataView"),S=B(g.a,"Map"),k=B(g.a,"Promise"),Z=B(g.a,"Set"),R=B(g.a,"WeakMap"),N="[object Map]",O="[object Promise]",W="[object Set]",F="[object WeakMap]",M="[object DataView]",V=I(x),T=I(S),E=I(k),j=I(Z),L=I(R),X=u.a;(x&&X(new x(new ArrayBuffer(1)))!=M||S&&X(new S)!=N||k&&X(k.resolve())!=O||Z&&X(new Z)!=W||R&&X(new R)!=F)&&(X=function(e){var t=Object(u.a)(e),n="[object Object]"==t?e.constructor:void 0,r=n?I(n):"";if(r)switch(r){case V:return M;case T:return N;case E:return O;case j:return W;case L:return F}return t});var H=X,Y=n(121);var z=function(e){return Object(Y.a)(e)&&"[object Arguments]"==Object(u.a)(e)},K=Object.prototype,_=K.hasOwnProperty,D=K.propertyIsEnumerable,P=z(function(){return arguments}())?z:function(e){return Object(Y.a)(e)&&_.call(e,"callee")&&!D.call(e,"callee")},U=n(256);var J=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Q=function(e){return null!=e&&J(e.length)&&!l(e)},q=n(387),$={};$["[object Float32Array]"]=$["[object Float64Array]"]=$["[object Int8Array]"]=$["[object Int16Array]"]=$["[object Int32Array]"]=$["[object Uint8Array]"]=$["[object Uint8ClampedArray]"]=$["[object Uint16Array]"]=$["[object Uint32Array]"]=!0,$["[object Arguments]"]=$["[object Array]"]=$["[object ArrayBuffer]"]=$["[object Boolean]"]=$["[object DataView]"]=$["[object Date]"]=$["[object Error]"]=$["[object Function]"]=$["[object Map]"]=$["[object Number]"]=$["[object Object]"]=$["[object RegExp]"]=$["[object Set]"]=$["[object String]"]=$["[object WeakMap]"]=!1;var ee=function(e){return Object(Y.a)(e)&&J(e.length)&&!!$[Object(u.a)(e)]};var te=function(e){return function(t){return e(t)}},ne=n(285),re=ne.a&&ne.a.isTypedArray,ae=re?te(re):ee,ie=Object.prototype.hasOwnProperty;t.default=function(e){if(null==e)return!0;if(Q(e)&&(Object(U.default)(e)||"string"==typeof e||"function"==typeof e.splice||Object(q.a)(e)||ae(e)||P(e)))return!e.length;var t=H(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(a(e))return!s(e).length;for(var n in e)if(ie.call(e,n))return!1;return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(11),a=n(6);function i(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var o=n(5),s=n(10);var u=Object(s.b)({sparseToDense_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=Object(o.a)(e,"sparseIndices","sparseToDense","int32"),c=Object(o.a)(t,"sparseValues","sparseToDense"),l=Object(o.a)(s,"defaultValue","sparseToDense",c.dtype);i(u,c,n,l);var g={sparseIndices:u,sparseValues:c,defaultValue:l},d={outputShape:n};return r.a.runKernel(a.Mc,g,d)}})},function(e,t){e.exports=function(e,t,n,r){var a=n?n.call(r,e,t):void 0;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),u=0;u<i.length;u++){var c=i[u];if(!s(c))return!1;var l=e[c],g=t[c];if(!1===(a=n?n.call(r,l,g,c):void 0)||void 0===a&&l!==g)return!1}return!0}},function(e,t,n){"use strict";t.a=function(e){function t(e,r,u,c,d){for(var h,f,p,I,v,y=0,w=0,G=0,B=0,x=0,O=0,F=p=h=0,V=0,T=0,E=0,j=0,L=u.length,X=L-1,H="",Y="",z="",K="";V<L;){if(f=u.charCodeAt(V),V===X&&0!==w+B+G+y&&(0!==w&&(f=47===w?10:47),B=G=y=0,L++,X++),0===w+B+G+y){if(V===X&&(0<T&&(H=H.replace(g,"")),0<H.trim().length)){switch(f){case 32:case 9:case 59:case 13:case 10:break;default:H+=u.charAt(V)}f=59}switch(f){case 123:for(h=(H=H.trim()).charCodeAt(0),p=1,j=++V;V<L;){switch(f=u.charCodeAt(V)){case 123:p++;break;case 125:p--;break;case 47:switch(f=u.charCodeAt(V+1)){case 42:case 47:e:{for(F=V+1;F<X;++F)switch(u.charCodeAt(F)){case 47:if(42===f&&42===u.charCodeAt(F-1)&&V+2!==F){V=F+1;break e}break;case 10:if(47===f){V=F+1;break e}}V=F}}break;case 91:f++;case 40:f++;case 34:case 39:for(;V++<X&&u.charCodeAt(V)!==f;);}if(0===p)break;V++}switch(p=u.substring(j,V),0===h&&(h=(H=H.replace(l,"").trim()).charCodeAt(0)),h){case 64:switch(0<T&&(H=H.replace(g,"")),f=H.charCodeAt(1)){case 100:case 109:case 115:case 45:T=r;break;default:T=N}if(j=(p=t(r,T,p,f,d+1)).length,0<W&&(v=s(3,p,T=n(N,H,E),r,k,S,j,f,d,c),H=T.join(""),void 0!==v&&0===(j=(p=v.trim()).length)&&(f=0,p="")),0<j)switch(f){case 115:H=H.replace(A,o);case 100:case 109:case 45:p=H+"{"+p+"}";break;case 107:p=(H=H.replace(C,"$1 $2"))+"{"+p+"}",p=1===R||2===R&&i("@"+p,3)?"@-webkit-"+p+"@"+p:"@"+p;break;default:p=H+p,112===c&&(Y+=p,p="")}else p="";break;default:p=t(r,n(r,H,E),p,c,d+1)}z+=p,p=E=T=F=h=0,H="",f=u.charCodeAt(++V);break;case 125:case 59:if(1<(j=(H=(0<T?H.replace(g,""):H).trim()).length))switch(0===F&&(h=H.charCodeAt(0),45===h||96<h&&123>h)&&(j=(H=H.replace(" ",":")).length),0<W&&void 0!==(v=s(1,H,r,e,k,S,Y.length,c,d,c))&&0===(j=(H=v.trim()).length)&&(H="\0\0"),h=H.charCodeAt(0),f=H.charCodeAt(1),h){case 0:break;case 64:if(105===f||99===f){K+=H+u.charAt(V);break}default:58!==H.charCodeAt(j-1)&&(Y+=a(H,h,f,H.charCodeAt(2)))}E=T=F=h=0,H="",f=u.charCodeAt(++V)}}switch(f){case 13:case 10:47===w?w=0:0===1+h&&107!==c&&0<H.length&&(T=1,H+="\0"),0<W*M&&s(0,H,r,e,k,S,Y.length,c,d,c),S=1,k++;break;case 59:case 125:if(0===w+B+G+y){S++;break}default:switch(S++,I=u.charAt(V),f){case 9:case 32:if(0===B+y+w)switch(x){case 44:case 58:case 9:case 32:I="";break;default:32!==f&&(I=" ")}break;case 0:I="\\0";break;case 12:I="\\f";break;case 11:I="\\v";break;case 38:0===B+w+y&&(T=E=1,I="\f"+I);break;case 108:if(0===B+w+y+Z&&0<F)switch(V-F){case 2:112===x&&58===u.charCodeAt(V-3)&&(Z=x);case 8:111===O&&(Z=O)}break;case 58:0===B+w+y&&(F=V);break;case 44:0===w+G+B+y&&(T=1,I+="\r");break;case 34:case 39:0===w&&(B=B===f?0:0===B?f:B);break;case 91:0===B+w+G&&y++;break;case 93:0===B+w+G&&y--;break;case 41:0===B+w+y&&G--;break;case 40:if(0===B+w+y){if(0===h)switch(2*x+3*O){case 533:break;default:h=1}G++}break;case 64:0===w+G+B+y+F+p&&(p=1);break;case 42:case 47:if(!(0<B+y+G))switch(w){case 0:switch(2*f+3*u.charCodeAt(V+1)){case 235:w=47;break;case 220:j=V,w=42}break;case 42:47===f&&42===x&&j+2!==V&&(33===u.charCodeAt(j+2)&&(Y+=u.substring(j,V+1)),I="",w=0)}}0===w&&(H+=I)}O=x,x=f,V++}if(0<(j=Y.length)){if(T=r,0<W&&(void 0!==(v=s(2,Y,T,e,k,S,j,c,d,c))&&0===(Y=v).length))return K+Y+z;if(Y=T.join(",")+"{"+Y+"}",0!==R*Z){switch(2!==R||i(Y,2)||(Z=0),Z){case 111:Y=Y.replace(b,":-moz-$1")+Y;break;case 112:Y=Y.replace(m,"::-webkit-input-$1")+Y.replace(m,"::-moz-$1")+Y.replace(m,":-ms-input-$1")+Y}Z=0}}return K+Y+z}function n(e,t,n){var a=t.trim().split(p);t=a;var i=a.length,o=e.length;switch(o){case 0:case 1:var s=0;for(e=0===o?"":e[0]+" ";s<i;++s)t[s]=r(e,t[s],n).trim();break;default:var u=s=0;for(t=[];s<i;++s)for(var c=0;c<o;++c)t[u++]=r(e[c]+" ",a[s],n).trim()}return t}function r(e,t,n){var r=t.charCodeAt(0);switch(33>r&&(r=(t=t.trim()).charCodeAt(0)),r){case 38:return t.replace(I,"$1"+e.trim());case 58:return e.trim()+t.replace(I,"$1"+e.trim());default:if(0<1*n&&0<t.indexOf("\f"))return t.replace(I,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function a(e,t,n,r){var o=e+";",s=2*t+3*n+4*r;if(944===s){e=o.indexOf(":",9)+1;var u=o.substring(e,o.length-1).trim();return u=o.substring(0,e).trim()+u+";",1===R||2===R&&i(u,1)?"-webkit-"+u+u:u}if(0===R||2===R&&!i(o,1))return o;switch(s){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(x,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(u=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+u+o;case 1005:return h.test(o)?o.replace(d,":-webkit-")+o.replace(d,":-moz-")+o:o;case 1e3:switch(t=(u=o.substring(13).trim()).indexOf("-")+1,u.charCodeAt(0)+u.charCodeAt(t)){case 226:u=o.replace(v,"tb");break;case 232:u=o.replace(v,"tb-rl");break;case 220:u=o.replace(v,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+u+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(t=(o=e).length-10,s=(u=(33===o.charCodeAt(t)?o.substring(0,t):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|u.charCodeAt(7))){case 203:if(111>u.charCodeAt(8))break;case 115:o=o.replace(u,"-webkit-"+u)+";"+o;break;case 207:case 102:o=o.replace(u,"-webkit-"+(102<s?"inline-":"")+"box")+";"+o.replace(u,"-webkit-"+u)+";"+o.replace(u,"-ms-"+u+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return u=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+u+"-ms-flex-"+u+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(w,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(w,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===B.test(e))return 115===(u=e.substring(e.indexOf(":")+1)).charCodeAt(0)?a(e.replace("stretch","fill-available"),t,n,r).replace(":fill-available",":stretch"):o.replace(u,"-webkit-"+u)+o.replace(u,"-moz-"+u.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,211===n+r&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(f,"$1-webkit-$2")+o}return o}function i(e,t){var n=e.indexOf(1===t?":":"{"),r=e.substring(0,3!==t?n:10);return n=e.substring(n+1,e.length-1),F(2!==t?r:r.replace(G,"$1"),n,t)}function o(e,t){var n=a(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return n!==t+";"?n.replace(y," or ($1)").substring(4):"("+t+")"}function s(e,t,n,r,a,i,o,s,u,l){for(var g,d=0,h=t;d<W;++d)switch(g=O[d].call(c,e,h,n,r,a,i,o,s,u,l)){case void 0:case!1:case!0:case null:break;default:h=g}if(h!==t)return h}function u(e){return void 0!==(e=e.prefix)&&(F=null,e?"function"!==typeof e?R=1:(R=2,F=e):R=0),u}function c(e,n){var r=e;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<W){var a=s(-1,n,r,r,k,S,0,0,0,0);void 0!==a&&"string"===typeof a&&(n=a)}var i=t(N,r,n,0,0);return 0<W&&(void 0!==(a=s(-2,i,r,r,k,S,i.length,0,0,0))&&(i=a)),"",Z=0,S=k=1,i}var l=/^\0+/g,g=/[\0\r\f]/g,d=/: */g,h=/zoo|gra/,f=/([,: ])(transform)/g,p=/,\r+?/g,I=/([\t\r\n ])*\f?&/g,C=/@(k\w+)\s*(\S*)\s*/,m=/::(place)/g,b=/:(read-only)/g,v=/[svh]\w+-[tblr]{2}/,A=/\(\s*(.*)\s*\)/g,y=/([\s\S]*?);/g,w=/-self|flex-/g,G=/[^]*?(:[rp][el]a[\w-]+)[^]*/,B=/stretch|:\s*\w+\-(?:conte|avail)/,x=/([^-])(image-set\()/,S=1,k=1,Z=0,R=1,N=[],O=[],W=0,F=null,M=0;return c.use=function e(t){switch(t){case void 0:case null:W=O.length=0;break;default:if("function"===typeof t)O[W++]=t;else if("object"===typeof t)for(var n=0,r=t.length;n<r;++n)e(t[n]);else M=0|!!t}return e},c.set=u,void 0!==e&&u(e),c}},function(e,t,n){"use strict";t.a={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";(function(e){var n="undefined"!==typeof window&&"undefined"!==typeof document&&"undefined"!==typeof navigator,r=function(){for(var e=["Edge","Trident","Firefox"],t=0;t<e.length;t+=1)if(n&&navigator.userAgent.indexOf(e[t])>=0)return 1;return 0}();var a=n&&window.Promise?function(e){var t=!1;return function(){t||(t=!0,window.Promise.resolve().then((function(){t=!1,e()})))}}:function(e){var t=!1;return function(){t||(t=!0,setTimeout((function(){t=!1,e()}),r))}};function i(e){return e&&"[object Function]"==={}.toString.call(e)}function o(e,t){if(1!==e.nodeType)return[];var n=e.ownerDocument.defaultView.getComputedStyle(e,null);return t?n[t]:n}function s(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function u(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var t=o(e),n=t.overflow,r=t.overflowX,a=t.overflowY;return/(auto|scroll|overlay)/.test(n+a+r)?e:u(s(e))}function c(e){return e&&e.referenceNode?e.referenceNode:e}var l=n&&!(!window.MSInputMethodContext||!document.documentMode),g=n&&/MSIE 10/.test(navigator.userAgent);function d(e){return 11===e?l:10===e?g:l||g}function h(e){if(!e)return document.documentElement;for(var t=d(10)?document.body:null,n=e.offsetParent||null;n===t&&e.nextElementSibling;)n=(e=e.nextElementSibling).offsetParent;var r=n&&n.nodeName;return r&&"BODY"!==r&&"HTML"!==r?-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===o(n,"position")?h(n):n:e?e.ownerDocument.documentElement:document.documentElement}function f(e){return null!==e.parentNode?f(e.parentNode):e}function p(e,t){if(!e||!e.nodeType||!t||!t.nodeType)return document.documentElement;var n=e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING,r=n?e:t,a=n?t:e,i=document.createRange();i.setStart(r,0),i.setEnd(a,0);var o=i.commonAncestorContainer;if(e!==o&&t!==o||r.contains(a))return function(e){var t=e.nodeName;return"BODY"!==t&&("HTML"===t||h(e.firstElementChild)===e)}(o)?o:h(o);var s=f(e);return s.host?p(s.host,t):p(e,f(t).host)}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n="top"===t?"scrollTop":"scrollLeft",r=e.nodeName;if("BODY"===r||"HTML"===r){var a=e.ownerDocument.documentElement,i=e.ownerDocument.scrollingElement||a;return i[n]}return e[n]}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=I(t,"top"),a=I(t,"left"),i=n?-1:1;return e.top+=r*i,e.bottom+=r*i,e.left+=a*i,e.right+=a*i,e}function m(e,t){var n="x"===t?"Left":"Top",r="Left"===n?"Right":"Bottom";return parseFloat(e["border"+n+"Width"])+parseFloat(e["border"+r+"Width"])}function b(e,t,n,r){return Math.max(t["offset"+e],t["scroll"+e],n["client"+e],n["offset"+e],n["scroll"+e],d(10)?parseInt(n["offset"+e])+parseInt(r["margin"+("Height"===e?"Top":"Left")])+parseInt(r["margin"+("Height"===e?"Bottom":"Right")]):0)}function v(e){var t=e.body,n=e.documentElement,r=d(10)&&getComputedStyle(n);return{height:b("Height",t,n,r),width:b("Width",t,n,r)}}var A=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),w=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function B(e){return G({},e,{right:e.left+e.width,bottom:e.top+e.height})}function x(e){var t={};try{if(d(10)){t=e.getBoundingClientRect();var n=I(e,"top"),r=I(e,"left");t.top+=n,t.left+=r,t.bottom+=n,t.right+=r}else t=e.getBoundingClientRect()}catch(h){}var a={left:t.left,top:t.top,width:t.right-t.left,height:t.bottom-t.top},i="HTML"===e.nodeName?v(e.ownerDocument):{},s=i.width||e.clientWidth||a.width,u=i.height||e.clientHeight||a.height,c=e.offsetWidth-s,l=e.offsetHeight-u;if(c||l){var g=o(e);c-=m(g,"x"),l-=m(g,"y"),a.width-=c,a.height-=l}return B(a)}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=d(10),a="HTML"===t.nodeName,i=x(e),s=x(t),c=u(e),l=o(t),g=parseFloat(l.borderTopWidth),h=parseFloat(l.borderLeftWidth);n&&a&&(s.top=Math.max(s.top,0),s.left=Math.max(s.left,0));var f=B({top:i.top-s.top-g,left:i.left-s.left-h,width:i.width,height:i.height});if(f.marginTop=0,f.marginLeft=0,!r&&a){var p=parseFloat(l.marginTop),I=parseFloat(l.marginLeft);f.top-=g-p,f.bottom-=g-p,f.left-=h-I,f.right-=h-I,f.marginTop=p,f.marginLeft=I}return(r&&!n?t.contains(c):t===c&&"BODY"!==c.nodeName)&&(f=C(f,t)),f}function k(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.ownerDocument.documentElement,r=S(e,n),a=Math.max(n.clientWidth,window.innerWidth||0),i=Math.max(n.clientHeight,window.innerHeight||0),o=t?0:I(n),s=t?0:I(n,"left"),u={top:o-r.top+r.marginTop,left:s-r.left+r.marginLeft,width:a,height:i};return B(u)}function Z(e){var t=e.nodeName;if("BODY"===t||"HTML"===t)return!1;if("fixed"===o(e,"position"))return!0;var n=s(e);return!!n&&Z(n)}function R(e){if(!e||!e.parentElement||d())return document.documentElement;for(var t=e.parentElement;t&&"none"===o(t,"transform");)t=t.parentElement;return t||document.documentElement}function N(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={top:0,left:0},o=a?R(e):p(e,c(t));if("viewport"===r)i=k(o,a);else{var l=void 0;"scrollParent"===r?"BODY"===(l=u(s(t))).nodeName&&(l=e.ownerDocument.documentElement):l="window"===r?e.ownerDocument.documentElement:r;var g=S(l,o,a);if("HTML"!==l.nodeName||Z(o))i=g;else{var d=v(e.ownerDocument),h=d.height,f=d.width;i.top+=g.top-g.marginTop,i.bottom=h+g.top,i.left+=g.left-g.marginLeft,i.right=f+g.left}}var I="number"===typeof(n=n||0);return i.left+=I?n:n.left||0,i.top+=I?n:n.top||0,i.right-=I?n:n.right||0,i.bottom-=I?n:n.bottom||0,i}function O(e){return e.width*e.height}function W(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var o=N(n,r,i,a),s={top:{width:o.width,height:t.top-o.top},right:{width:o.right-t.right,height:o.height},bottom:{width:o.width,height:o.bottom-t.bottom},left:{width:t.left-o.left,height:o.height}},u=Object.keys(s).map((function(e){return G({key:e},s[e],{area:O(s[e])})})).sort((function(e,t){return t.area-e.area})),c=u.filter((function(e){var t=e.width,r=e.height;return t>=n.clientWidth&&r>=n.clientHeight})),l=c.length>0?c[0].key:u[0].key,g=e.split("-")[1];return l+(g?"-"+g:"")}function F(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=r?R(t):p(t,c(n));return S(n,a,r)}function M(e){var t=e.ownerDocument.defaultView.getComputedStyle(e),n=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),r=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+r,height:e.offsetHeight+n}}function V(e){var t={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,(function(e){return t[e]}))}function T(e,t,n){n=n.split("-")[0];var r=M(e),a={width:r.width,height:r.height},i=-1!==["right","left"].indexOf(n),o=i?"top":"left",s=i?"left":"top",u=i?"height":"width",c=i?"width":"height";return a[o]=t[o]+t[u]/2-r[u]/2,a[s]=n===s?t[s]-r[c]:t[V(s)],a}function E(e,t){return Array.prototype.find?e.find(t):e.filter(t)[0]}function j(e,t,n){return(void 0===n?e:e.slice(0,function(e,t,n){if(Array.prototype.findIndex)return e.findIndex((function(e){return e[t]===n}));var r=E(e,(function(e){return e[t]===n}));return e.indexOf(r)}(e,"name",n))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var n=e.function||e.fn;e.enabled&&i(n)&&(t.offsets.popper=B(t.offsets.popper),t.offsets.reference=B(t.offsets.reference),t=n(t,e))})),t}function L(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=F(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=W(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=T(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=j(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function X(e,t){return e.some((function(e){var n=e.name;return e.enabled&&n===t}))}function H(e){for(var t=[!1,"ms","Webkit","Moz","O"],n=e.charAt(0).toUpperCase()+e.slice(1),r=0;r<t.length;r++){var a=t[r],i=a?""+a+n:e;if("undefined"!==typeof document.body.style[i])return i}return null}function Y(){return this.state.isDestroyed=!0,X(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[H("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function z(e){var t=e.ownerDocument;return t?t.defaultView:window}function K(e,t,n,r){var a="BODY"===e.nodeName,i=a?e.ownerDocument.defaultView:e;i.addEventListener(t,n,{passive:!0}),a||K(u(i.parentNode),t,n,r),r.push(i)}function _(e,t,n,r){n.updateBound=r,z(e).addEventListener("resize",n.updateBound,{passive:!0});var a=u(e);return K(a,"scroll",n.updateBound,n.scrollParents),n.scrollElement=a,n.eventsEnabled=!0,n}function D(){this.state.eventsEnabled||(this.state=_(this.reference,this.options,this.state,this.scheduleUpdate))}function P(){var e,t;this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=(e=this.reference,t=this.state,z(e).removeEventListener("resize",t.updateBound),t.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.updateBound)})),t.updateBound=null,t.scrollParents=[],t.scrollElement=null,t.eventsEnabled=!1,t))}function U(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function J(e,t){Object.keys(t).forEach((function(n){var r="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&U(t[n])&&(r="px"),e.style[n]=t[n]+r}))}var Q=n&&/Firefox/i.test(navigator.userAgent);function q(e,t,n){var r=E(e,(function(e){return e.name===t})),a=!!r&&e.some((function(e){return e.name===n&&e.enabled&&e.order<r.order}));if(!a){var i="`"+t+"`",o="`"+n+"`";console.warn(o+" modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return a}var $=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],ee=$.slice(3);function te(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ee.indexOf(e),r=ee.slice(n+1).concat(ee.slice(0,n));return t?r.reverse():r}var ne="flip",re="clockwise",ae="counterclockwise";function ie(e,t,n,r){var a=[0,0],i=-1!==["right","left"].indexOf(r),o=e.split(/(\+|\-)/).map((function(e){return e.trim()})),s=o.indexOf(E(o,(function(e){return-1!==e.search(/,|\s/)})));o[s]&&-1===o[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var u=/\s*,\s*|\s+/,c=-1!==s?[o.slice(0,s).concat([o[s].split(u)[0]]),[o[s].split(u)[1]].concat(o.slice(s+1))]:[o];return(c=c.map((function(e,r){var a=(1===r?!i:i)?"height":"width",o=!1;return e.reduce((function(e,t){return""===e[e.length-1]&&-1!==["+","-"].indexOf(t)?(e[e.length-1]=t,o=!0,e):o?(e[e.length-1]+=t,o=!1,e):e.concat(t)}),[]).map((function(e){return function(e,t,n,r){var a=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+a[1],o=a[2];if(!i)return e;if(0===o.indexOf("%")){var s=void 0;switch(o){case"%p":s=n;break;case"%":case"%r":default:s=r}return B(s)[t]/100*i}if("vh"===o||"vw"===o)return("vh"===o?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*i;return i}(e,a,t,n)}))}))).forEach((function(e,t){e.forEach((function(n,r){U(n)&&(a[t]+=n*("-"===e[r-1]?-1:1))}))})),a}var oe={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(e){var t=e.placement,n=t.split("-")[0],r=t.split("-")[1];if(r){var a=e.offsets,i=a.reference,o=a.popper,s=-1!==["bottom","top"].indexOf(n),u=s?"left":"top",c=s?"width":"height",l={start:w({},u,i[u]),end:w({},u,i[u]+i[c]-o[c])};e.offsets.popper=G({},o,l[r])}return e}},offset:{order:200,enabled:!0,fn:function(e,t){var n=t.offset,r=e.placement,a=e.offsets,i=a.popper,o=a.reference,s=r.split("-")[0],u=void 0;return u=U(+n)?[+n,0]:ie(n,i,o,s),"left"===s?(i.top+=u[0],i.left-=u[1]):"right"===s?(i.top+=u[0],i.left+=u[1]):"top"===s?(i.left+=u[0],i.top-=u[1]):"bottom"===s&&(i.left+=u[0],i.top+=u[1]),e.popper=i,e},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(e,t){var n=t.boundariesElement||h(e.instance.popper);e.instance.reference===n&&(n=h(n));var r=H("transform"),a=e.instance.popper.style,i=a.top,o=a.left,s=a[r];a.top="",a.left="",a[r]="";var u=N(e.instance.popper,e.instance.reference,t.padding,n,e.positionFixed);a.top=i,a.left=o,a[r]=s,t.boundaries=u;var c=t.priority,l=e.offsets.popper,g={primary:function(e){var n=l[e];return l[e]<u[e]&&!t.escapeWithReference&&(n=Math.max(l[e],u[e])),w({},e,n)},secondary:function(e){var n="right"===e?"left":"top",r=l[n];return l[e]>u[e]&&!t.escapeWithReference&&(r=Math.min(l[n],u[e]-("right"===e?l.width:l.height))),w({},n,r)}};return c.forEach((function(e){var t=-1!==["left","top"].indexOf(e)?"primary":"secondary";l=G({},l,g[t](e))})),e.offsets.popper=l,e},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(e){var t=e.offsets,n=t.popper,r=t.reference,a=e.placement.split("-")[0],i=Math.floor,o=-1!==["top","bottom"].indexOf(a),s=o?"right":"bottom",u=o?"left":"top",c=o?"width":"height";return n[s]<i(r[u])&&(e.offsets.popper[u]=i(r[u])-n[c]),n[u]>i(r[s])&&(e.offsets.popper[u]=i(r[s])),e}},arrow:{order:500,enabled:!0,fn:function(e,t){var n;if(!q(e.instance.modifiers,"arrow","keepTogether"))return e;var r=t.element;if("string"===typeof r){if(!(r=e.instance.popper.querySelector(r)))return e}else if(!e.instance.popper.contains(r))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var a=e.placement.split("-")[0],i=e.offsets,s=i.popper,u=i.reference,c=-1!==["left","right"].indexOf(a),l=c?"height":"width",g=c?"Top":"Left",d=g.toLowerCase(),h=c?"left":"top",f=c?"bottom":"right",p=M(r)[l];u[f]-p<s[d]&&(e.offsets.popper[d]-=s[d]-(u[f]-p)),u[d]+p>s[f]&&(e.offsets.popper[d]+=u[d]+p-s[f]),e.offsets.popper=B(e.offsets.popper);var I=u[d]+u[l]/2-p/2,C=o(e.instance.popper),m=parseFloat(C["margin"+g]),b=parseFloat(C["border"+g+"Width"]),v=I-e.offsets.popper[d]-m-b;return v=Math.max(Math.min(s[l]-p,v),0),e.arrowElement=r,e.offsets.arrow=(w(n={},d,Math.round(v)),w(n,h,""),n),e},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(e,t){if(X(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var n=N(e.instance.popper,e.instance.reference,t.padding,t.boundariesElement,e.positionFixed),r=e.placement.split("-")[0],a=V(r),i=e.placement.split("-")[1]||"",o=[];switch(t.behavior){case ne:o=[r,a];break;case re:o=te(r);break;case ae:o=te(r,!0);break;default:o=t.behavior}return o.forEach((function(s,u){if(r!==s||o.length===u+1)return e;r=e.placement.split("-")[0],a=V(r);var c=e.offsets.popper,l=e.offsets.reference,g=Math.floor,d="left"===r&&g(c.right)>g(l.left)||"right"===r&&g(c.left)<g(l.right)||"top"===r&&g(c.bottom)>g(l.top)||"bottom"===r&&g(c.top)<g(l.bottom),h=g(c.left)<g(n.left),f=g(c.right)>g(n.right),p=g(c.top)<g(n.top),I=g(c.bottom)>g(n.bottom),C="left"===r&&h||"right"===r&&f||"top"===r&&p||"bottom"===r&&I,m=-1!==["top","bottom"].indexOf(r),b=!!t.flipVariations&&(m&&"start"===i&&h||m&&"end"===i&&f||!m&&"start"===i&&p||!m&&"end"===i&&I),v=!!t.flipVariationsByContent&&(m&&"start"===i&&f||m&&"end"===i&&h||!m&&"start"===i&&I||!m&&"end"===i&&p),A=b||v;(d||C||A)&&(e.flipped=!0,(d||C)&&(r=o[u+1]),A&&(i=function(e){return"end"===e?"start":"start"===e?"end":e}(i)),e.placement=r+(i?"-"+i:""),e.offsets.popper=G({},e.offsets.popper,T(e.instance.popper,e.offsets.reference,e.placement)),e=j(e.instance.modifiers,e,"flip"))})),e},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function(e){var t=e.placement,n=t.split("-")[0],r=e.offsets,a=r.popper,i=r.reference,o=-1!==["left","right"].indexOf(n),s=-1===["top","left"].indexOf(n);return a[o?"left":"top"]=i[n]-(s?a[o?"width":"height"]:0),e.placement=V(t),e.offsets.popper=B(a),e}},hide:{order:800,enabled:!0,fn:function(e){if(!q(e.instance.modifiers,"hide","preventOverflow"))return e;var t=e.offsets.reference,n=E(e.instance.modifiers,(function(e){return"preventOverflow"===e.name})).boundaries;if(t.bottom<n.top||t.left>n.right||t.top>n.bottom||t.right<n.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}},computeStyle:{order:850,enabled:!0,fn:function(e,t){var n=t.x,r=t.y,a=e.offsets.popper,i=E(e.instance.modifiers,(function(e){return"applyStyle"===e.name})).gpuAcceleration;void 0!==i&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var o=void 0!==i?i:t.gpuAcceleration,s=h(e.instance.popper),u=x(s),c={position:a.position},l=function(e,t){var n=e.offsets,r=n.popper,a=n.reference,i=Math.round,o=Math.floor,s=function(e){return e},u=i(a.width),c=i(r.width),l=-1!==["left","right"].indexOf(e.placement),g=-1!==e.placement.indexOf("-"),d=t?l||g||u%2===c%2?i:o:s,h=t?i:s;return{left:d(u%2===1&&c%2===1&&!g&&t?r.left-1:r.left),top:h(r.top),bottom:h(r.bottom),right:d(r.right)}}(e,window.devicePixelRatio<2||!Q),g="bottom"===n?"top":"bottom",d="right"===r?"left":"right",f=H("transform"),p=void 0,I=void 0;if(I="bottom"===g?"HTML"===s.nodeName?-s.clientHeight+l.bottom:-u.height+l.bottom:l.top,p="right"===d?"HTML"===s.nodeName?-s.clientWidth+l.right:-u.width+l.right:l.left,o&&f)c[f]="translate3d("+p+"px, "+I+"px, 0)",c[g]=0,c[d]=0,c.willChange="transform";else{var C="bottom"===g?-1:1,m="right"===d?-1:1;c[g]=I*C,c[d]=p*m,c.willChange=g+", "+d}var b={"x-placement":e.placement};return e.attributes=G({},b,e.attributes),e.styles=G({},c,e.styles),e.arrowStyles=G({},e.offsets.arrow,e.arrowStyles),e},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(e){var t,n;return J(e.instance.popper,e.styles),t=e.instance.popper,n=e.attributes,Object.keys(n).forEach((function(e){!1!==n[e]?t.setAttribute(e,n[e]):t.removeAttribute(e)})),e.arrowElement&&Object.keys(e.arrowStyles).length&&J(e.arrowElement,e.arrowStyles),e},onLoad:function(e,t,n,r,a){var i=F(a,t,e,n.positionFixed),o=W(n.placement,i,t,e,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return t.setAttribute("x-placement",o),J(t,{position:n.positionFixed?"fixed":"absolute"}),n},gpuAcceleration:void 0}}},se=function(){function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};A(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=a(this.update.bind(this)),this.options=G({},e.Defaults,o),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=t&&t.jquery?t[0]:t,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(G({},e.Defaults.modifiers,o.modifiers)).forEach((function(t){r.options.modifiers[t]=G({},e.Defaults.modifiers[t]||{},o.modifiers?o.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(e){return G({name:e},r.options.modifiers[e])})).sort((function(e,t){return e.order-t.order})),this.modifiers.forEach((function(e){e.enabled&&i(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var s=this.options.eventsEnabled;s&&this.enableEventListeners(),this.state.eventsEnabled=s}return y(e,[{key:"update",value:function(){return L.call(this)}},{key:"destroy",value:function(){return Y.call(this)}},{key:"enableEventListeners",value:function(){return D.call(this)}},{key:"disableEventListeners",value:function(){return P.call(this)}}]),e}();se.Utils=("undefined"!==typeof window?window:e).PopperUtils,se.placements=$,se.Defaults=oe,t.a=se}).call(this,n(148))},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}),"Cancel");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M11.5 2C6.81 2 3 5.81 3 10.5S6.81 19 11.5 19h.5v3c4.86-2.34 8-7 8-11.5C20 5.81 16.19 2 11.5 2zm1 14.5h-2v-2h2v2zm0-3.5h-2c0-3.25 3-3 3-5 0-1.1-.9-2-2-2s-2 .9-2 2h-2c0-2.21 1.79-4 4-4s4 1.79 4 4c0 2.5-3 2.75-3 5z"}),"ContactSupport");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement(i.Fragment,null,i.createElement("circle",{cx:"12",cy:"12",r:"3.2"}),i.createElement("path",{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})),"PhotoCamera");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"}),"SkipNext");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"}),"Autorenew");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"}),"Keyboard");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M13 1.07V9h7c0-4.08-3.05-7.44-7-7.93zM4 15c0 4.42 3.58 8 8 8s8-3.58 8-8v-4H4v4zm7-13.93C7.05 1.56 4 4.92 4 9h7V1.07z"}),"Mouse");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"}),"School");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"}),"Brightness5");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6c3.31 0 6 2.69 6 6s-2.69 6-6 6z"}),"Brightness4");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement(i.Fragment,null,i.createElement("path",{d:"M11.1 12.08c-2.33-4.51-.5-8.48.53-10.07C6.27 2.2 1.98 6.59 1.98 12c0 .14.02.28.02.42.62-.27 1.29-.42 2-.42 1.66 0 3.18.83 4.1 2.15 1.67.48 2.9 2.02 2.9 3.85 0 1.52-.87 2.83-2.12 3.51.98.32 2.03.5 3.11.5 3.5 0 6.58-1.8 8.37-4.52-2.36.23-6.98-.97-9.26-5.41z"}),i.createElement("path",{d:"M7 16h-.18C6.4 14.84 5.3 14 4 14c-1.66 0-3 1.34-3 3s1.34 3 3 3h3c1.1 0 2-.9 2-2s-.9-2-2-2z"})),"NightsStay");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M22.17 9.17c0-3.87-3.13-7-7-7s-7 3.13-7 7c0 3.47 2.52 6.34 5.83 6.89V20H6v-3h1v-4c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v4h1v5h16v-2h-3v-3.88c3.47-.41 6.17-3.36 6.17-6.95zM4.5 11c.83 0 1.5-.67 1.5-1.5S5.33 8 4.5 8 3 8.67 3 9.5 3.67 11 4.5 11z"}),"NaturePeople");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"NotInterested");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M5 16c0 3.87 3.13 7 7 7s7-3.13 7-7v-4H5v4zM16.12 4.37l2.1-2.1-.82-.83-2.3 2.31C14.16 3.28 13.12 3 12 3s-2.16.28-3.09.75L6.6 1.44l-.82.83 2.1 2.1C6.14 5.64 5 7.68 5 10v1h14v-1c0-2.32-1.14-4.36-2.88-5.63zM9 9c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"}),"Adb");t.default=o},function(e,t,n){"use strict";e.exports=n(422)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15),a=function(e,t){void 0===t&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');var n=this,a=-1,i=0,o=1,s=2,u=3,c=4;this.object=e,this.domElement=t,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},this.target=new r.Vector3;var l=1e-6,g=new r.Vector3,d=1,h=a,f=a,p=new r.Vector3,I=new r.Vector2,C=new r.Vector2,m=new r.Vector3,b=0,v=new r.Vector2,A=new r.Vector2,y=0,w=0,G=new r.Vector2,B=new r.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var x={type:"change"},S={type:"start"},k={type:"end"};this.handleResize=function(){var e=n.domElement.getBoundingClientRect(),t=n.domElement.ownerDocument.documentElement;n.screen.left=e.left+window.pageXOffset-t.clientLeft,n.screen.top=e.top+window.pageYOffset-t.clientTop,n.screen.width=e.width,n.screen.height=e.height};var Z=function(){var e=new r.Vector2;return function(t,r){return e.set((t-n.screen.left)/n.screen.width,(r-n.screen.top)/n.screen.height),e}}(),R=function(){var e=new r.Vector2;return function(t,r){return e.set((t-.5*n.screen.width-n.screen.left)/(.5*n.screen.width),(n.screen.height+2*(n.screen.top-r))/n.screen.width),e}}();function N(e){if(!1!==n.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(e.preventDefault(),h===a)switch(e.button){case n.mouseButtons.LEFT:h=i;break;case n.mouseButtons.MIDDLE:h=o;break;case n.mouseButtons.RIGHT:h=s;break;default:h=a}var t=f!==a?f:h;t!==i||n.noRotate?t!==o||n.noZoom?t!==s||n.noPan||(G.copy(Z(e.pageX,e.pageY)),B.copy(G)):(v.copy(Z(e.pageX,e.pageY)),A.copy(v)):(C.copy(R(e.pageX,e.pageY)),I.copy(C));n.domElement.ownerDocument.addEventListener("pointermove",O),n.domElement.ownerDocument.addEventListener("pointerup",W),n.dispatchEvent(S)}(e)}}function O(e){if(!1!==n.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===n.enabled)return;e.preventDefault();var t=f!==a?f:h;t!==i||n.noRotate?t!==o||n.noZoom?t!==s||n.noPan||B.copy(Z(e.pageX,e.pageY)):A.copy(Z(e.pageX,e.pageY)):(I.copy(C),C.copy(R(e.pageX,e.pageY)))}(e)}}function W(e){if(!1!==n.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===n.enabled)return;e.preventDefault(),h=a,n.domElement.ownerDocument.removeEventListener("pointermove",O),n.domElement.ownerDocument.removeEventListener("pointerup",W),n.dispatchEvent(k)}(e)}}function F(e){!1!==n.enabled&&(window.removeEventListener("keydown",F),f===a&&(e.code!==n.keys[i]||n.noRotate?e.code!==n.keys[o]||n.noZoom?e.code!==n.keys[s]||n.noPan||(f=s):f=o:f=i))}function M(){!1!==n.enabled&&(f=a,window.addEventListener("keydown",F))}function V(e){if(!1!==n.enabled&&!0!==n.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:v.y-=.025*e.deltaY;break;case 1:v.y-=.01*e.deltaY;break;default:v.y-=25e-5*e.deltaY}n.dispatchEvent(S),n.dispatchEvent(k)}}function T(e){if(!1!==n.enabled){switch(e.preventDefault(),e.touches.length){case 1:h=u,C.copy(R(e.touches[0].pageX,e.touches[0].pageY)),I.copy(C);break;default:h=c;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;w=y=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;G.copy(Z(a,i)),B.copy(G)}n.dispatchEvent(S)}}function E(e){if(!1!==n.enabled)switch(e.preventDefault(),e.touches.length){case 1:I.copy(C),C.copy(R(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY;w=Math.sqrt(t*t+r*r);var a=(e.touches[0].pageX+e.touches[1].pageX)/2,i=(e.touches[0].pageY+e.touches[1].pageY)/2;B.copy(Z(a,i))}}function j(e){if(!1!==n.enabled){switch(e.touches.length){case 0:h=a;break;case 1:h=u,C.copy(R(e.touches[0].pageX,e.touches[0].pageY)),I.copy(C)}n.dispatchEvent(k)}}function L(e){!1!==n.enabled&&e.preventDefault()}this.rotateCamera=function(){var e,t=new r.Vector3,a=new r.Quaternion,i=new r.Vector3,o=new r.Vector3,s=new r.Vector3,u=new r.Vector3;return function(){u.set(C.x-I.x,C.y-I.y,0),(e=u.length())?(p.copy(n.object.position).sub(n.target),i.copy(p).normalize(),o.copy(n.object.up).normalize(),s.crossVectors(o,i).normalize(),o.setLength(C.y-I.y),s.setLength(C.x-I.x),u.copy(o.add(s)),t.crossVectors(u,p).normalize(),e*=n.rotateSpeed,a.setFromAxisAngle(t,e),p.applyQuaternion(a),n.object.up.applyQuaternion(a),m.copy(t),b=e):!n.staticMoving&&b&&(b*=Math.sqrt(1-n.dynamicDampingFactor),p.copy(n.object.position).sub(n.target),a.setFromAxisAngle(m,b),p.applyQuaternion(a),n.object.up.applyQuaternion(a)),I.copy(C)}}(),this.zoomCamera=function(){var e;h===c?(e=y/w,y=w,n.object.isPerspectiveCamera?p.multiplyScalar(e):n.object.isOrthographicCamera?(n.object.zoom*=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(A.y-v.y)*n.zoomSpeed)&&e>0&&(n.object.isPerspectiveCamera?p.multiplyScalar(e):n.object.isOrthographicCamera?(n.object.zoom/=e,n.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),n.staticMoving?v.copy(A):v.y+=(A.y-v.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new r.Vector2,t=new r.Vector3,a=new r.Vector3;return function(){if(e.copy(B).sub(G),e.lengthSq()){if(n.object.isOrthographicCamera){var r=(n.object.right-n.object.left)/n.object.zoom/n.domElement.clientWidth,i=(n.object.top-n.object.bottom)/n.object.zoom/n.domElement.clientWidth;e.x*=r,e.y*=i}e.multiplyScalar(p.length()*n.panSpeed),a.copy(p).cross(n.object.up).setLength(e.x),a.add(t.copy(n.object.up).setLength(e.y)),n.object.position.add(a),n.target.add(a),n.staticMoving?G.copy(B):G.add(e.subVectors(B,G).multiplyScalar(n.dynamicDampingFactor))}}}(),this.checkDistances=function(){n.noZoom&&n.noPan||(p.lengthSq()>n.maxDistance*n.maxDistance&&(n.object.position.addVectors(n.target,p.setLength(n.maxDistance)),v.copy(A)),p.lengthSq()<n.minDistance*n.minDistance&&(n.object.position.addVectors(n.target,p.setLength(n.minDistance)),v.copy(A)))},this.update=function(){p.subVectors(n.object.position,n.target),n.noRotate||n.rotateCamera(),n.noZoom||n.zoomCamera(),n.noPan||n.panCamera(),n.object.position.addVectors(n.target,p),n.object.isPerspectiveCamera?(n.checkDistances(),n.object.lookAt(n.target),g.distanceToSquared(n.object.position)>l&&(n.dispatchEvent(x),g.copy(n.object.position))):n.object.isOrthographicCamera?(n.object.lookAt(n.target),(g.distanceToSquared(n.object.position)>l||d!==n.object.zoom)&&(n.dispatchEvent(x),g.copy(n.object.position),d=n.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){h=a,f=a,n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.up.copy(n.up0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),p.subVectors(n.object.position,n.target),n.object.lookAt(n.target),n.dispatchEvent(x),g.copy(n.object.position),d=n.object.zoom},this.dispose=function(){n.domElement.removeEventListener("contextmenu",L),n.domElement.removeEventListener("pointerdown",N),n.domElement.removeEventListener("wheel",V),n.domElement.removeEventListener("touchstart",T),n.domElement.removeEventListener("touchend",j),n.domElement.removeEventListener("touchmove",E),n.domElement.ownerDocument.removeEventListener("pointermove",O),n.domElement.ownerDocument.removeEventListener("pointerup",W),window.removeEventListener("keydown",F),window.removeEventListener("keyup",M)},this.domElement.addEventListener("contextmenu",L),this.domElement.addEventListener("pointerdown",N),this.domElement.addEventListener("wheel",V),this.domElement.addEventListener("touchstart",T),this.domElement.addEventListener("touchend",j),this.domElement.addEventListener("touchmove",E),this.domElement.ownerDocument.addEventListener("pointermove",O),this.domElement.ownerDocument.addEventListener("pointerup",W),window.addEventListener("keydown",F),window.addEventListener("keyup",M),this.handleResize(),this.update()};a.prototype=Object.create(r.EventDispatcher.prototype),a.prototype.constructor=a},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(7),a=n.n(r),i=n(17),o=n(1),s=n(9),u=n(12),c=n(13),l=n(0),g=n(73),d=n(383),h=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"decodeUTF8",value:function(){return new f(this)}}]),n}(g.a),f=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this)).upstream=e,r.impl=new p(e),r}return Object(s.a)(n,[{key:"summary",value:function(){return this.impl.summary()}},{key:"next",value:function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.impl.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d.a),p=function(t){Object(u.a)(g,t);var r=Object(c.a)(g);function g(e){var t;if(Object(o.a)(this,g),(t=r.call(this)).upstream=e,Object(l.Ud)().get("IS_BROWSER"))t.decoder=new TextDecoder("utf-8");else{var a=n(442).StringDecoder;t.decoder=new a("utf8")}return t}return Object(s.a)(g,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Utf8")}},{key:"pump",value:function(){var t=Object(i.a)(a.a.mark((function t(){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.upstream.next();case 2:if(!(n=t.sent).done){t.next=7;break}return t.abrupt("return",!1);case 7:r=n.value;case 8:return i=Object(l.Ud)().get("IS_BROWSER")?this.decoder.decode(r,{stream:!0}):this.decoder.write(e.from(r.buffer)),this.outputQueue.push(i),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),g}(g.b)}).call(this,n(279).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(16),a=n(7),i=n.n(a),o=n(17),s=n(1),u=n(9),c=n(12),l=n(13),g=n(73),d=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"split",value:function(e){return new h(this,e)}}]),n}(g.a),h=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.impl=new f(e,r),a}return Object(u.a)(n,[{key:"summary",value:function(){return this.impl.summary()}},{key:"next",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.impl.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(d),f=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e,r){var a;return Object(s.a)(this,n),(a=t.call(this)).upstream=e,a.separator=r,a.carryover="",a}return Object(u.a)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Split('").concat(this.separator,"')")}},{key:"pump",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,n,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=9;break}if(""!==this.carryover){e.next=6;break}return e.abrupt("return",!1);case 6:return this.outputQueue.push(this.carryover),this.carryover="",e.abrupt("return",!0);case 9:(n=t.value.split(this.separator))[0]=this.carryover+n[0],a=Object(r.a)(n.slice(0,-1));try{for(a.s();!(o=a.n()).done;)s=o.value,this.outputQueue.push(s)}catch(i){a.e(i)}finally{a.f()}return this.carryover=n[n.length-1],e.abrupt("return",!0);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(g.b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(15),a=n(84),i=function(e,t,n,i,o){a.a.call(this),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=void 0!==o?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new r.Color};i.prototype=Object.assign(Object.create(a.a.prototype),{constructor:i,render:function(e,t,n){var r,a,i=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(a=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,r),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=a),e.autoClear=i}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={uniforms:{tDiffuse:{value:null},resolution:{value:new(n(15).Vector2)(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")}},function(e,t,n){var r=function e(){function t(e){return a.appendChild(e.dom),e}function n(e){for(var t=0;t<a.children.length;t++)a.children[t].style.display=t===e?"block":"none";r=e}var r=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",(function(e){e.preventDefault(),n(++r%a.children.length)}),!1);var i=(performance||Date).now(),o=i,s=0,u=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new e.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:a,addPanel:t,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(c.update(e-i,200),e>o+1e3&&(u.update(1e3*s/(e-o),100),o=e,s=0,l)){var t=performance.memory;l.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:a,setMode:n}};r.Panel=function(e,t,n){var r=1/0,a=0,i=Math.round,o=i(window.devicePixelRatio||1),s=80*o,u=48*o,c=3*o,l=2*o,g=3*o,d=15*o,h=74*o,f=30*o,p=document.createElement("canvas");p.width=s,p.height=u,p.style.cssText="width:80px;height:48px";var I=p.getContext("2d");return I.font="bold "+9*o+"px Helvetica,Arial,sans-serif",I.textBaseline="top",I.fillStyle=n,I.fillRect(0,0,s,u),I.fillStyle=t,I.fillText(e,c,l),I.fillRect(g,d,h,f),I.fillStyle=n,I.globalAlpha=.9,I.fillRect(g,d,h,f),{dom:p,update:function(u,C){r=Math.min(r,u),a=Math.max(a,u),I.fillStyle=n,I.globalAlpha=1,I.fillRect(0,0,s,d),I.fillStyle=t,I.fillText(i(u)+" "+e+" ("+i(r)+"-"+i(a)+")",c,l),I.drawImage(p,g+o,d,h-o,f,g,d,h-o,f),I.fillRect(g+h-o,d,o,f),I.fillStyle=n,I.globalAlpha=.9,I.fillRect(g+h-o,d,o,i((1-u/C)*f))}}},e.exports=r},function(e,t,n){"use strict";(function(e){var r=n(80),a=n(388),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.a.Buffer:void 0,u=(s?s.isBuffer:void 0)||a.a;t.a=u}).call(this,n(334)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M7.34 6.41L.86 12.9l6.49 6.48 6.49-6.48-6.5-6.49zM3.69 12.9l3.66-3.66L11 12.9l-3.66 3.66-3.65-3.66zm15.67-6.26C17.61 4.88 15.3 4 13 4V.76L8.76 5 13 9.24V6c1.79 0 3.58.68 4.95 2.05 2.73 2.73 2.73 7.17 0 9.9C16.58 19.32 14.79 20 13 20c-.97 0-1.94-.21-2.84-.61l-1.49 1.49C10.02 21.62 11.51 22 13 22c2.3 0 4.61-.88 6.36-2.64 3.52-3.51 3.52-9.21 0-12.72z"}),"Rotate90DegreesCcw");t.default=o},function(e,t,n){"use strict";var r=n(64),a=n(74);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n(2)),o=(0,r(n(75)).default)(i.createElement("path",{d:"M19 12h-2v3h-3v2h5v-5zM7 9h3V7H5v5h2V9zm14-6H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16.01H3V4.99h18v14.02z"}),"AspectRatio");t.default=o},function(e,t,n){"use strict";var r=n(83),a=n(38),i=n(498),o=n(25),s=["xs","sm","md","lg","xl"];function u(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:960,lg:1280,xl:1920}:t,r=e.unit,i=void 0===r?"px":r,u=e.step,c=void 0===u?5:u,l=Object(a.a)(e,["values","unit","step"]);function g(e){var t="number"===typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(i,")")}function d(e,t){var r=s.indexOf(t);return r===s.length-1?g(e):"@media (min-width:".concat("number"===typeof n[e]?n[e]:e).concat(i,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[s[r+1]]?n[s[r+1]]:t)-c/100).concat(i,")")}return Object(o.a)({keys:s,values:n,up:g,down:function(e){var t=s.indexOf(e)+1,r=n[s[t]];return t===s.length?g("xs"):"@media (max-width:".concat(("number"===typeof r&&t>0?r:e)-c/100).concat(i,")")},between:d,only:function(e){return d(e,e)},width:function(e){return n[e]}},l)}function c(e,t,n){var a;return Object(o.a)({gutters:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o.a)({paddingLeft:t(2),paddingRight:t(2)},n,Object(r.a)({},e.up("sm"),Object(o.a)({paddingLeft:t(3),paddingRight:t(3)},n[e.up("sm")])))},toolbar:(a={minHeight:56},Object(r.a)(a,"".concat(e.up("xs")," and (orientation: landscape)"),{minHeight:48}),Object(r.a)(a,e.up("sm"),{minHeight:64}),a)},n)}var l=n(394),g={black:"#000",white:"#fff"},d={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#d5d5d5",A200:"#aaaaaa",A400:"#303030",A700:"#616161"},h={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"},f={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"},p={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},I={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},C={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},m={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},b=n(58),v={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:g.white,default:d[50]},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},A={text:{primary:g.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",hint:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:d[800],default:"#303030"},action:{active:g.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function y(e,t,n,r){var a=r.light||r,i=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=Object(b.d)(e.main,a):"dark"===t&&(e.dark=Object(b.a)(e.main,i)))}function w(e){var t=e.primary,n=void 0===t?{light:h[300],main:h[500],dark:h[700]}:t,r=e.secondary,s=void 0===r?{light:f.A200,main:f.A400,dark:f.A700}:r,u=e.error,c=void 0===u?{light:p[300],main:p[500],dark:p[700]}:u,w=e.warning,G=void 0===w?{light:I[300],main:I[500],dark:I[700]}:w,B=e.info,x=void 0===B?{light:C[300],main:C[500],dark:C[700]}:B,S=e.success,k=void 0===S?{light:m[300],main:m[500],dark:m[700]}:S,Z=e.type,R=void 0===Z?"light":Z,N=e.contrastThreshold,O=void 0===N?3:N,W=e.tonalOffset,F=void 0===W?.2:W,M=Object(a.a)(e,["primary","secondary","error","warning","info","success","type","contrastThreshold","tonalOffset"]);function V(e){return Object(b.c)(e,A.text.primary)>=O?A.text.primary:v.text.primary}var T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:700;if(!(e=Object(o.a)({},e)).main&&e[t]&&(e.main=e[t]),!e.main)throw new Error(Object(l.a)(4,t));if("string"!==typeof e.main)throw new Error(Object(l.a)(5,JSON.stringify(e.main)));return y(e,"light",n,F),y(e,"dark",r,F),e.contrastText||(e.contrastText=V(e.main)),e},E={dark:A,light:v};return Object(i.a)(Object(o.a)({common:g,type:R,primary:T(n),secondary:T(s,"A400","A200","A700"),error:T(c),warning:T(G),info:T(x),success:T(k),grey:d,contrastThreshold:O,getContrastText:V,augmentColor:T,tonalOffset:F},E[R]),M)}function G(e){return Math.round(1e5*e)/1e5}var B={textTransform:"uppercase"},x='"Roboto", "Helvetica", "Arial", sans-serif';function S(e,t){var n="function"===typeof t?t(e):t,r=n.fontFamily,s=void 0===r?x:r,u=n.fontSize,c=void 0===u?14:u,l=n.fontWeightLight,g=void 0===l?300:l,d=n.fontWeightRegular,h=void 0===d?400:d,f=n.fontWeightMedium,p=void 0===f?500:f,I=n.fontWeightBold,C=void 0===I?700:I,m=n.htmlFontSize,b=void 0===m?16:m,v=n.allVariants,A=n.pxToRem,y=Object(a.a)(n,["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"]);var w=c/14,S=A||function(e){return"".concat(e/b*w,"rem")},k=function(e,t,n,r,a){return Object(o.a)({fontFamily:s,fontWeight:e,fontSize:S(t),lineHeight:n},s===x?{letterSpacing:"".concat(G(r/t),"em")}:{},a,v)},Z={h1:k(g,96,1.167,-1.5),h2:k(g,60,1.2,-.5),h3:k(h,48,1.167,0),h4:k(h,34,1.235,.25),h5:k(h,24,1.334,0),h6:k(p,20,1.6,.15),subtitle1:k(h,16,1.75,.15),subtitle2:k(p,14,1.57,.1),body1:k(h,16,1.5,.15),body2:k(h,14,1.43,.15),button:k(p,14,1.75,.4,B),caption:k(h,12,1.66,.4),overline:k(h,12,2.66,1,B)};return Object(i.a)(Object(o.a)({htmlFontSize:b,pxToRem:S,round:G,fontFamily:s,fontSize:c,fontWeightLight:g,fontWeightRegular:h,fontWeightMedium:p,fontWeightBold:C},Z),y,{clone:!1})}function k(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var Z=["none",k(0,2,1,-1,0,1,1,0,0,1,3,0),k(0,3,1,-2,0,2,2,0,0,1,5,0),k(0,3,3,-2,0,3,4,0,0,1,8,0),k(0,2,4,-1,0,4,5,0,0,1,10,0),k(0,3,5,-1,0,5,8,0,0,1,14,0),k(0,3,5,-1,0,6,10,0,0,1,18,0),k(0,4,5,-2,0,7,10,1,0,2,16,1),k(0,5,5,-3,0,8,10,1,0,3,14,2),k(0,5,6,-3,0,9,12,1,0,3,16,2),k(0,6,6,-3,0,10,14,1,0,4,18,3),k(0,6,7,-4,0,11,15,1,0,4,20,3),k(0,7,8,-4,0,12,17,2,0,5,22,4),k(0,7,8,-4,0,13,19,2,0,5,24,4),k(0,7,9,-4,0,14,21,2,0,5,26,4),k(0,8,9,-5,0,15,22,2,0,6,28,5),k(0,8,10,-5,0,16,24,2,0,6,30,5),k(0,8,11,-5,0,17,26,2,0,6,32,5),k(0,9,11,-5,0,18,28,2,0,7,34,6),k(0,9,12,-6,0,19,29,2,0,7,36,6),k(0,10,13,-6,0,20,31,3,0,8,38,7),k(0,10,13,-6,0,21,33,3,0,8,40,7),k(0,10,14,-6,0,22,35,3,0,8,42,7),k(0,11,14,-7,0,23,36,3,0,9,44,8),k(0,11,15,-7,0,24,38,3,0,9,46,8)],R={borderRadius:4},N=n(124),O=(n(123),n(202));n(52);var W=function(e,t){return t?Object(i.a)(e,t,{clone:!1}):e},F={xs:0,sm:600,md:960,lg:1280,xl:1920},M={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(F[e],"px)")}};var V={m:"margin",p:"padding"},T={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},E={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},j=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){if(e.length>2){if(!E[e])return[e];e=E[e]}var t=e.split(""),n=Object(N.a)(t,2),r=n[0],a=n[1],i=V[r],o=T[a]||"";return Array.isArray(o)?o.map((function(e){return i+e})):[i+o]})),L=["m","mt","mr","mb","ml","mx","my","p","pt","pr","pb","pl","px","py","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY"];function X(e){var t=e.spacing||8;return"number"===typeof t?function(e){return t*e}:Array.isArray(t)?function(e){return t[e]}:"function"===typeof t?t:function(){}}function H(e,t){return function(n){return e.reduce((function(e,r){return e[r]=function(e,t){if("string"===typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}(t,n),e}),{})}}function Y(e){var t=X(e.theme);return Object.keys(e).map((function(n){if(-1===L.indexOf(n))return null;var r=H(j(n),t),a=e[n];return function(e,t,n){if(Array.isArray(t)){var r=e.theme.breakpoints||M;return t.reduce((function(e,a,i){return e[r.up(r.keys[i])]=n(t[i]),e}),{})}if("object"===Object(O.a)(t)){var a=e.theme.breakpoints||M;return Object.keys(t).reduce((function(e,r){return e[a.up(r)]=n(t[r]),e}),{})}return n(t)}(e,a,r)})).reduce(W,{})}Y.propTypes={},Y.filterProps=L;function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=X({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===n.length?t(1):1===n.length?t(n[0]):n.map((function(e){if("string"===typeof e)return e;var n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return Object.defineProperty(n,"unit",{get:function(){return e}}),n.mui=!0,n}var K=n(90),_=n(262);t.a=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,r=e.mixins,o=void 0===r?{}:r,s=e.palette,l=void 0===s?{}:s,g=e.spacing,d=e.typography,h=void 0===d?{}:d,f=Object(a.a)(e,["breakpoints","mixins","palette","spacing","typography"]),p=w(l),I=u(n),C=z(g),m=Object(i.a)({breakpoints:I,direction:"ltr",mixins:c(I,C,o),overrides:{},palette:p,props:{},shadows:Z,typography:S(p,h),spacing:C,shape:R,transitions:K.a,zIndex:_.a},f),b=arguments.length,v=new Array(b>1?b-1:0),A=1;A<b;A++)v[A-1]=arguments[A];return m=v.reduce((function(e,t){return Object(i.a)(e,t)}),m)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(15),a=n(195),i=n(210),o=n(84),s=function(e,t){o.a.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};s.prototype=Object.assign(Object.create(o.a.prototype),{constructor:s,render:function(e,t,n){var r,a,i=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),this.inverse?(r=0,a=1):(r=1,a=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),o.buffers.stencil.setFunc(i.ALWAYS,r,4294967295),o.buffers.stencil.setClear(a),o.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(i.EQUAL,1,4294967295),o.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),o.buffers.stencil.setLocked(!0)}});var u=function(){o.a.call(this),this.needsSwap=!1};u.prototype=Object.create(o.a.prototype),Object.assign(u.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var c=function(e,t){if(this.renderer=e,void 0===t){var n={minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBAFormat},o=e.getSize(new r.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=o.width,this._height=o.height,(t=new r.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,n)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===a.a&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===i.a&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new i.a(a.a),this.clock=new r.Clock};Object.assign(c.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},removePass:function(e){var t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,n,r=this.renderer.getRenderTarget(),a=!1,i=this.passes.length;for(n=0;n<i;n++)if(!1!==(t=this.passes[n]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(n),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,a),t.needsSwap){if(a){var o=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(o.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(o.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==s&&(t instanceof s?a=!0:t instanceof u&&(a=!1))}this.renderer.setRenderTarget(r)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new r.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var a=0;a<this.passes.length;a++)this.passes[a].setSize(n,r)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var l=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(l.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),l.FullScreenQuad=function(){var e=new r.OrthographicCamera(-1,1,1,-1,0,1),t=new r.BufferGeometry;t.setAttribute("position",new r.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),t.setAttribute("uv",new r.Float32BufferAttribute([0,2,0,0,2,0],2));var n=function(e){this._mesh=new r.Mesh(t,e)};return Object.defineProperty(n.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(n.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),n}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(15),a=n(84),i=n(195),o={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new r.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},s=function(e,t,n,s){a.a.call(this),this.strength=void 0!==t?t:1,this.radius=n,this.threshold=s,this.resolution=void 0!==e?new r.Vector2(e.x,e.y):new r.Vector2(256,256),this.clearColor=new r.Color(0,0,0);var u={minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var c=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2);this.renderTargetBright=new r.WebGLRenderTarget(c,l,u),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var g=0;g<this.nMips;g++){var d=new r.WebGLRenderTarget(c,l,u);d.texture.name="UnrealBloomPass.h"+g,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d);var h=new r.WebGLRenderTarget(c,l,u);h.texture.name="UnrealBloomPass.v"+g,h.texture.generateMipmaps=!1,this.renderTargetsVertical.push(h),c=Math.round(c/2),l=Math.round(l/2)}void 0===o&&console.error("THREE.UnrealBloomPass relies on LuminosityHighPassShader");var f=o;this.highPassUniforms=r.UniformsUtils.clone(f.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new r.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var p=[3,5,7,9,11];for(c=Math.round(this.resolution.x/2),l=Math.round(this.resolution.y/2),g=0;g<this.nMips;g++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(p[g])),this.separableBlurMaterials[g].uniforms.texSize.value=new r.Vector2(c,l),c=Math.round(c/2),l=Math.round(l/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new r.Vector3(1,1,1),new r.Vector3(1,1,1),new r.Vector3(1,1,1),new r.Vector3(1,1,1),new r.Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===i.a&&console.error("THREE.UnrealBloomPass relies on CopyShader");var I=i.a;this.copyUniforms=r.UniformsUtils.clone(I.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new r.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:I.vertexShader,fragmentShader:I.fragmentShader,blending:r.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new r.Color,this.oldClearAlpha=1,this.basic=new r.MeshBasicMaterial,this.fsQuad=new a.a.FullScreenQuad(null)};s.prototype=Object.assign(Object.create(a.a.prototype),{constructor:s,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var n=Math.round(e/2),a=Math.round(t/2);this.renderTargetBright.setSize(n,a);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(n,a),this.renderTargetsVertical[i].setSize(n,a),this.separableBlurMaterials[i].uniforms.texSize.value=new r.Vector2(n,a),n=Math.round(n/2),a=Math.round(a/2)},render:function(e,t,n,r,a){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();var i=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),a&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var o=this.renderTargetBright,u=0;u<this.nMips;u++)this.fsQuad.material=this.separableBlurMaterials[u],this.separableBlurMaterials[u].uniforms.colorTexture.value=o.texture,this.separableBlurMaterials[u].uniforms.direction.value=s.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[u]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[u].uniforms.colorTexture.value=this.renderTargetsHorizontal[u].texture,this.separableBlurMaterials[u].uniforms.direction.value=s.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[u]),e.clear(),this.fsQuad.render(e),o=this.renderTargetsVertical[u];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,a&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(n),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=i},getSeperableBlurMaterial:function(e){return new r.ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new r.Vector2(.5,.5)},direction:{value:new r.Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new r.ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),s.BlurDirectionX=new r.Vector2(1,0),s.BlurDirectionY=new r.Vector2(0,1)},function(e,t,n){"use strict";function r(e){for(var t="https://material-ui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified Material-UI error #"+e+"; visit "+t+" for the full message."}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),a=n.n(r),i=n(260);function o(){return a.a.useContext(i.a)}},function(e,t,n){"use strict";var r=n(25),a=n(124),i=n(38),o=n(2),s=(n(52),n(398)),u=n(90),c=n(106),l=n(110),g=n(51),d={entering:{opacity:1},entered:{opacity:1}},h={enter:u.b.enteringScreen,exit:u.b.leavingScreen},f=o.forwardRef((function(e,t){var n=e.children,u=e.disableStrictModeCompat,f=void 0!==u&&u,p=e.in,I=e.onEnter,C=e.onEntered,m=e.onEntering,b=e.onExit,v=e.onExited,A=e.onExiting,y=e.style,w=e.TransitionComponent,G=void 0===w?s.a:w,B=e.timeout,x=void 0===B?h:B,S=Object(i.a)(e,["children","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","TransitionComponent","timeout"]),k=Object(c.a)(),Z=k.unstable_strictMode&&!f,R=o.useRef(null),N=Object(g.a)(n.ref,t),O=Object(g.a)(Z?R:void 0,N),W=function(e){return function(t,n){if(e){var r=Z?[R.current,t]:[t,n],i=Object(a.a)(r,2),o=i[0],s=i[1];void 0===s?e(o):e(o,s)}}},F=W(m),M=W((function(e,t){Object(l.b)(e);var n=Object(l.a)({style:y,timeout:x},{mode:"enter"});e.style.webkitTransition=k.transitions.create("opacity",n),e.style.transition=k.transitions.create("opacity",n),I&&I(e,t)})),V=W(C),T=W(A),E=W((function(e){var t=Object(l.a)({style:y,timeout:x},{mode:"exit"});e.style.webkitTransition=k.transitions.create("opacity",t),e.style.transition=k.transitions.create("opacity",t),b&&b(e)})),j=W(v);return o.createElement(G,Object(r.a)({appear:!0,in:p,nodeRef:Z?R:void 0,onEnter:M,onEntered:V,onEntering:F,onExit:E,onExited:j,onExiting:T,timeout:x},S),(function(e,t){return o.cloneElement(n,Object(r.a)({style:Object(r.a)({opacity:0,visibility:"exited"!==e||p?void 0:"hidden"},d[e],y,n.props.style),ref:O},t))}))}));t.a=f},function(e,t,n){"use strict";var r=n(25),a=n(38),i=n(2),o=n.n(i),s=(n(52),n(62)),u=n(48),c=n(51),l=n(66),g=n(56),d=n(131),h=n(123),f=n(97),p=n(208),I=n(156),C=n(194);function m(e,t){var n=Object.create(null);return e&&i.Children.map(e,(function(e){return e})).forEach((function(e){n[e.key]=function(e){return t&&Object(i.isValidElement)(e)?t(e):e}(e)})),n}function b(e,t,n){return null!=n[t]?n[t]:e.props[t]}function v(e,t,n){var r=m(e.children),a=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,a=Object.create(null),i=[];for(var o in e)o in t?i.length&&(a[o]=i,i=[]):i.push(o);var s={};for(var u in t){if(a[u])for(r=0;r<a[u].length;r++){var c=a[u][r];s[a[u][r]]=n(c)}s[u]=n(u)}for(r=0;r<i.length;r++)s[i[r]]=n(i[r]);return s}(t,r);return Object.keys(a).forEach((function(o){var s=a[o];if(Object(i.isValidElement)(s)){var u=o in t,c=o in r,l=t[o],g=Object(i.isValidElement)(l)&&!l.props.in;!c||u&&!g?c||!u||g?c&&u&&Object(i.isValidElement)(l)&&(a[o]=Object(i.cloneElement)(s,{onExited:n.bind(null,s),in:l.props.in,exit:b(s,"exit",e),enter:b(s,"enter",e)})):a[o]=Object(i.cloneElement)(s,{in:!1}):a[o]=Object(i.cloneElement)(s,{onExited:n.bind(null,s),in:!0,exit:b(s,"exit",e),enter:b(s,"enter",e)})}})),a}var A=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},y=function(e){function t(t,n){var r,a=(r=e.call(this,t,n)||this).handleExited.bind(Object(p.a)(r));return r.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},r}Object(I.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var n,r,a=t.children,o=t.handleExited;return{children:t.firstRender?(n=e,r=o,m(n.children,(function(e){return Object(i.cloneElement)(e,{onExited:r.bind(null,e),in:!0,appear:b(e,"appear",n),enter:b(e,"enter",n),exit:b(e,"exit",n)})}))):v(e,a,o),firstRender:!1}},n.handleExited=function(e,t){var n=m(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=Object(r.a)({},t.children);return delete n[e.key],{children:n}})))},n.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=Object(f.a)(e,["component","childFactory"]),a=this.state.contextValue,i=A(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?o.a.createElement(C.a.Provider,{value:a},i):o.a.createElement(C.a.Provider,{value:a},o.a.createElement(t,r,i))},t}(o.a.Component);y.propTypes={},y.defaultProps={component:"div",childFactory:function(e){return e}};var w=y,G="undefined"===typeof window?i.useEffect:i.useLayoutEffect;var B=function(e){var t=e.classes,n=e.pulsate,r=void 0!==n&&n,a=e.rippleX,o=e.rippleY,s=e.rippleSize,c=e.in,g=e.onExited,d=void 0===g?function(){}:g,h=e.timeout,f=i.useState(!1),p=f[0],I=f[1],C=Object(u.a)(t.ripple,t.rippleVisible,r&&t.ripplePulsate),m={width:s,height:s,top:-s/2+o,left:-s/2+a},b=Object(u.a)(t.child,p&&t.childLeaving,r&&t.childPulsate),v=Object(l.a)(d);return G((function(){if(!c){I(!0);var e=setTimeout(v,h);return function(){clearTimeout(e)}}}),[v,c,h]),i.createElement("span",{className:C,style:m},i.createElement("span",{className:b}))},x=i.forwardRef((function(e,t){var n=e.center,o=void 0!==n&&n,s=e.classes,c=e.className,l=Object(a.a)(e,["center","classes","className"]),g=i.useState([]),d=g[0],f=g[1],p=i.useRef(0),I=i.useRef(null);i.useEffect((function(){I.current&&(I.current(),I.current=null)}),[d]);var C=i.useRef(!1),m=i.useRef(null),b=i.useRef(null),v=i.useRef(null);i.useEffect((function(){return function(){clearTimeout(m.current)}}),[]);var A=i.useCallback((function(e){var t=e.pulsate,n=e.rippleX,r=e.rippleY,a=e.rippleSize,o=e.cb;f((function(e){return[].concat(Object(h.a)(e),[i.createElement(B,{key:p.current,classes:s,timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:a})])})),p.current+=1,I.current=o}),[s]),y=i.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.pulsate,a=void 0!==r&&r,i=t.center,s=void 0===i?o||t.pulsate:i,u=t.fakeElement,c=void 0!==u&&u;if("mousedown"===e.type&&C.current)C.current=!1;else{"touchstart"===e.type&&(C.current=!0);var l,g,d,h=c?null:v.current,f=h?h.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(f.width/2),g=Math.round(f.height/2);else{var p=e.touches?e.touches[0]:e,I=p.clientX,y=p.clientY;l=Math.round(I-f.left),g=Math.round(y-f.top)}if(s)(d=Math.sqrt((2*Math.pow(f.width,2)+Math.pow(f.height,2))/3))%2===0&&(d+=1);else{var w=2*Math.max(Math.abs((h?h.clientWidth:0)-l),l)+2,G=2*Math.max(Math.abs((h?h.clientHeight:0)-g),g)+2;d=Math.sqrt(Math.pow(w,2)+Math.pow(G,2))}e.touches?null===b.current&&(b.current=function(){A({pulsate:a,rippleX:l,rippleY:g,rippleSize:d,cb:n})},m.current=setTimeout((function(){b.current&&(b.current(),b.current=null)}),80)):A({pulsate:a,rippleX:l,rippleY:g,rippleSize:d,cb:n})}}),[o,A]),G=i.useCallback((function(){y({},{pulsate:!0})}),[y]),x=i.useCallback((function(e,t){if(clearTimeout(m.current),"touchend"===e.type&&b.current)return e.persist(),b.current(),b.current=null,void(m.current=setTimeout((function(){x(e,t)})));b.current=null,f((function(e){return e.length>0?e.slice(1):e})),I.current=t}),[]);return i.useImperativeHandle(t,(function(){return{pulsate:G,start:y,stop:x}}),[G,y,x]),i.createElement("span",Object(r.a)({className:Object(u.a)(s.root,c),ref:v},l),i.createElement(w,{component:null,exit:!0},d))})),S=Object(g.a)((function(e){return{root:{overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"},ripple:{opacity:0,position:"absolute"},rippleVisible:{opacity:.3,transform:"scale(1)",animation:"$enter ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},ripplePulsate:{animationDuration:"".concat(e.transitions.duration.shorter,"ms")},child:{opacity:1,display:"block",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"currentColor"},childLeaving:{opacity:0,animation:"$exit ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},childPulsate:{position:"absolute",left:0,top:0,animation:"$pulsate 2500ms ".concat(e.transitions.easing.easeInOut," 200ms infinite")},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.1},"100%":{transform:"scale(1)",opacity:.3}},"@keyframes exit":{"0%":{opacity:1},"100%":{opacity:0}},"@keyframes pulsate":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.92)"},"100%":{transform:"scale(1)"}}}}),{flip:!1,name:"MuiTouchRipple"})(i.memo(x)),k=i.forwardRef((function(e,t){var n=e.action,o=e.buttonRef,g=e.centerRipple,h=void 0!==g&&g,f=e.children,p=e.classes,I=e.className,C=e.component,m=void 0===C?"button":C,b=e.disabled,v=void 0!==b&&b,A=e.disableRipple,y=void 0!==A&&A,w=e.disableTouchRipple,G=void 0!==w&&w,B=e.focusRipple,x=void 0!==B&&B,k=e.focusVisibleClassName,Z=e.onBlur,R=e.onClick,N=e.onFocus,O=e.onFocusVisible,W=e.onKeyDown,F=e.onKeyUp,M=e.onMouseDown,V=e.onMouseLeave,T=e.onMouseUp,E=e.onTouchEnd,j=e.onTouchMove,L=e.onTouchStart,X=e.onDragLeave,H=e.tabIndex,Y=void 0===H?0:H,z=e.TouchRippleProps,K=e.type,_=void 0===K?"button":K,D=Object(a.a)(e,["action","buttonRef","centerRipple","children","classes","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","onBlur","onClick","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","onDragLeave","tabIndex","TouchRippleProps","type"]),P=i.useRef(null);var U=i.useRef(null),J=i.useState(!1),Q=J[0],q=J[1];v&&Q&&q(!1);var $=Object(d.a)(),ee=$.isFocusVisible,te=$.onBlurVisible,ne=$.ref;function re(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:G;return Object(l.a)((function(r){return t&&t(r),!n&&U.current&&U.current[e](r),!0}))}i.useImperativeHandle(n,(function(){return{focusVisible:function(){q(!0),P.current.focus()}}}),[]),i.useEffect((function(){Q&&x&&!y&&U.current.pulsate()}),[y,x,Q]);var ae=re("start",M),ie=re("stop",X),oe=re("stop",T),se=re("stop",(function(e){Q&&e.preventDefault(),V&&V(e)})),ue=re("start",L),ce=re("stop",E),le=re("stop",j),ge=re("stop",(function(e){Q&&(te(e),q(!1)),Z&&Z(e)}),!1),de=Object(l.a)((function(e){P.current||(P.current=e.currentTarget),ee(e)&&(q(!0),O&&O(e)),N&&N(e)})),he=function(){var e=s.findDOMNode(P.current);return m&&"button"!==m&&!("A"===e.tagName&&e.href)},fe=i.useRef(!1),pe=Object(l.a)((function(e){x&&!fe.current&&Q&&U.current&&" "===e.key&&(fe.current=!0,e.persist(),U.current.stop(e,(function(){U.current.start(e)}))),e.target===e.currentTarget&&he()&&" "===e.key&&e.preventDefault(),W&&W(e),e.target===e.currentTarget&&he()&&"Enter"===e.key&&!v&&(e.preventDefault(),R&&R(e))})),Ie=Object(l.a)((function(e){x&&" "===e.key&&U.current&&Q&&!e.defaultPrevented&&(fe.current=!1,e.persist(),U.current.stop(e,(function(){U.current.pulsate(e)}))),F&&F(e),R&&e.target===e.currentTarget&&he()&&" "===e.key&&!e.defaultPrevented&&R(e)})),Ce=m;"button"===Ce&&D.href&&(Ce="a");var me={};"button"===Ce?(me.type=_,me.disabled=v):("a"===Ce&&D.href||(me.role="button"),me["aria-disabled"]=v);var be=Object(c.a)(o,t),ve=Object(c.a)(ne,P),Ae=Object(c.a)(be,ve),ye=i.useState(!1),we=ye[0],Ge=ye[1];i.useEffect((function(){Ge(!0)}),[]);var Be=we&&!y&&!v;return i.createElement(Ce,Object(r.a)({className:Object(u.a)(p.root,I,Q&&[p.focusVisible,k],v&&p.disabled),onBlur:ge,onClick:R,onFocus:de,onKeyDown:pe,onKeyUp:Ie,onMouseDown:ae,onMouseLeave:se,onMouseUp:oe,onDragLeave:ie,onTouchEnd:ce,onTouchMove:le,onTouchStart:ue,ref:Ae,tabIndex:v?-1:Y},me,D),f,Be?i.createElement(S,Object(r.a)({ref:U,center:h},z)):null)}));t.a=Object(g.a)({root:{display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},"&$disabled":{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}},disabled:{},focusVisible:{}},{name:"MuiButtonBase"})(k)},function(e,t,n){"use strict";var r=n(97),a=n(156),i=(n(52),n(2)),o=n.n(i),s=n(62),u=n.n(s),c=!1,l=n(194),g="unmounted",d="exited",h="entering",f="entered",p="exiting",I=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var a,i=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?i?(a=d,r.appearStatus=h):a=f:a=t.unmountOnExit||t.mountOnEnter?g:d,r.state={status:a},r.nextCallback=null,r}Object(a.a)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===g?{status:d}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==h&&n!==f&&(t=h):n!==h&&n!==f||(t=p)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===h?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===d&&this.setState({status:g})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,a=this.props.nodeRef?[r]:[u.a.findDOMNode(this),r],i=a[0],o=a[1],s=this.getTimeouts(),l=r?s.appear:s.enter;!e&&!n||c?this.safeSetState({status:f},(function(){t.props.onEntered(i)})):(this.props.onEnter(i,o),this.safeSetState({status:h},(function(){t.props.onEntering(i,o),t.onTransitionEnd(l,(function(){t.safeSetState({status:f},(function(){t.props.onEntered(i,o)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:u.a.findDOMNode(this);t&&!c?(this.props.onExit(r),this.safeSetState({status:p},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:d},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:d},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:u.a.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],i=a[0],o=a[1];this.props.addEndListener(i,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===g)return null;var t=this.props,n=t.children,a=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,Object(r.a)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return o.a.createElement(l.a.Provider,{value:null},"function"===typeof n?n(e,a):o.a.cloneElement(o.a.Children.only(n),a))},t}(o.a.Component);function C(){}I.contextType=l.a,I.propTypes={},I.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:C,onEntering:C,onEntered:C,onExit:C,onExiting:C,onExited:C},I.UNMOUNTED=g,I.EXITED=d,I.ENTERING=h,I.ENTERED=f,I.EXITING=p;t.a=I},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canPlay=t.FLV_EXTENSIONS=t.DASH_EXTENSIONS=t.HLS_EXTENSIONS=t.VIDEO_EXTENSIONS=t.AUDIO_EXTENSIONS=t.MATCH_URL_KALTURA=t.MATCH_URL_VIDYARD=t.MATCH_URL_MIXCLOUD=t.MATCH_URL_DAILYMOTION=t.MATCH_URL_TWITCH_CHANNEL=t.MATCH_URL_TWITCH_VIDEO=t.MATCH_URL_WISTIA=t.MATCH_URL_STREAMABLE=t.MATCH_URL_FACEBOOK_WATCH=t.MATCH_URL_FACEBOOK=t.MATCH_URL_VIMEO=t.MATCH_URL_SOUNDCLOUD=t.MATCH_URL_YOUTUBE=void 0;var r=n(276);function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o=/(?:youtu\.be\/|youtube(?:-nocookie)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//;t.MATCH_URL_YOUTUBE=o;var s=/(?:soundcloud\.com|snd\.sc)\/[^.]+$/;t.MATCH_URL_SOUNDCLOUD=s;var u=/vimeo\.com\/.+/;t.MATCH_URL_VIMEO=u;var c=/^https?:\/\/(www\.)?facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/;t.MATCH_URL_FACEBOOK=c;var l=/^https?:\/\/fb\.watch\/.+$/;t.MATCH_URL_FACEBOOK_WATCH=l;var g=/streamable\.com\/([a-z0-9]+)$/;t.MATCH_URL_STREAMABLE=g;var d=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?(.*)$/;t.MATCH_URL_WISTIA=d;var h=/(?:www\.|go\.)?twitch\.tv\/videos\/(\d+)($|\?)/;t.MATCH_URL_TWITCH_VIDEO=h;var f=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+)($|\?)/;t.MATCH_URL_TWITCH_CHANNEL=f;var p=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?$/;t.MATCH_URL_DAILYMOTION=p;var I=/mixcloud\.com\/([^/]+\/[^/]+)/;t.MATCH_URL_MIXCLOUD=I;var C=/vidyard.com\/(?:watch\/)?([a-zA-Z0-9-]+)/;t.MATCH_URL_VIDYARD=C;var m=/^https?:\/\/[a-zA-Z]+\.kaltura.(com|org)\/p\/([0-9]+)\/sp\/([0-9]+)00\/embedIframeJs\/uiconf_id\/([0-9]+)\/partner_id\/([0-9]+)(.*)entry_id.([a-zA-Z0-9-_]+)$/;t.MATCH_URL_KALTURA=m;var b=/\.(m4a|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i;t.AUDIO_EXTENSIONS=b;var v=/\.(mp4|og[gv]|webm|mov|m4v)($|\?)/i;t.VIDEO_EXTENSIONS=v;var A=/\.(m3u8)($|\?)/i;t.HLS_EXTENSIONS=A;var y=/\.(mpd)($|\?)/i;t.DASH_EXTENSIONS=y;var w=/\.(flv)($|\?)/i;t.FLV_EXTENSIONS=w;var G={youtube:function(e){return e instanceof Array?e.every((function(e){return o.test(e)})):o.test(e)},soundcloud:function(e){return s.test(e)&&!b.test(e)},vimeo:function(e){return u.test(e)&&!v.test(e)&&!A.test(e)},facebook:function(e){return c.test(e)||l.test(e)},streamable:function(e){return g.test(e)},wistia:function(e){return d.test(e)},twitch:function(e){return h.test(e)||f.test(e)},dailymotion:function(e){return p.test(e)},mixcloud:function(e){return I.test(e)},vidyard:function(e){return C.test(e)},kaltura:function(e){return m.test(e)},file:function e(t){if(t instanceof Array){var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if("string"===typeof o&&e(o))return!0;if(e(o.src))return!0}}catch(s){i.e(s)}finally{i.f()}return!1}return!(!(0,r.isMediaStream)(t)&&!(0,r.isBlobUrl)(t))||(b.test(t)||v.test(t)||A.test(t)||y.test(t)||w.test(t))}};t.canPlay=G},,,,,,,,,function(e,t,n){"use strict";var r=n(213),a=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var o=60109,s=60110,u=60112;t.Suspense=60113;var c=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var g=Symbol.for;a=g("react.element"),i=g("react.portal"),t.Fragment=g("react.fragment"),t.StrictMode=g("react.strict_mode"),t.Profiler=g("react.profiler"),o=g("react.provider"),s=g("react.context"),u=g("react.forward_ref"),t.Suspense=g("react.suspense"),c=g("react.memo"),l=g("react.lazy")}var d="function"===typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p={};function I(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||f}function C(){}function m(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||f}I.prototype.isReactComponent={},I.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},I.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},C.prototype=I.prototype;var b=m.prototype=new C;b.constructor=m,r(b,I.prototype),b.isPureReactComponent=!0;var v={current:null},A=Object.prototype.hasOwnProperty,y={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,n){var r,i={},o=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)A.call(t,r)&&!y.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:a,type:e,key:o,ref:s,props:i,_owner:v.current}}function G(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var B=/\/+/g;function x(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function S(e,t,n,r,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case a:case i:u=!0}}if(u)return o=o(u=e),e=""===r?"."+x(u,0):r,Array.isArray(o)?(n="",null!=e&&(n=e.replace(B,"$&/")+"/"),S(o,t,n,"",(function(e){return e}))):null!=o&&(G(o)&&(o=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,n+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(B,"$&/")+"/")+e)),t.push(o)),1;if(u=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=r+x(s=e[c],c);u+=S(s,t,n,l,o)}else if("function"===typeof(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e)))for(e=l.call(e),c=0;!(s=e.next()).done;)u+=S(s=s.value,t,n,l=r+x(s,c++),o);else if("object"===s)throw t=""+e,Error(h(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return u}function k(e,t,n){if(null==e)return e;var r=[],a=0;return S(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function Z(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var R={current:null};function N(){var e=R.current;if(null===e)throw Error(h(321));return e}var O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:v,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:k,forEach:function(e,t,n){k(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return k(e,(function(){t++})),t},toArray:function(e){return k(e,(function(e){return e}))||[]},only:function(e){if(!G(e))throw Error(h(143));return e}},t.Component=I,t.PureComponent=m,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(h(267,e));var i=r({},e.props),o=e.key,s=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,u=v.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)A.call(t,l)&&!y.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){c=Array(l);for(var g=0;g<l;g++)c[g]=arguments[g+2];i.children=c}return{$$typeof:a,type:e.type,key:o,ref:s,props:i,_owner:u}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=G,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:Z}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return N().useCallback(e,t)},t.useContext=function(e,t){return N().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return N().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return N().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return N().useLayoutEffect(e,t)},t.useMemo=function(e,t){return N().useMemo(e,t)},t.useReducer=function(e,t,n){return N().useReducer(e,t,n)},t.useRef=function(e){return N().useRef(e)},t.useState=function(e){return N().useState(e)},t.version="17.0.1"},function(e,t,n){"use strict";var r=n(2),a=n(213),i=n(410);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(o(227));var s=new Set,u={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(u[e]=t,e=0;e<t.length;e++)s.add(t[e])}var g=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h=Object.prototype.hasOwnProperty,f={},p={};function I(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){C[e]=new I(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];C[t]=new I(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){C[e]=new I(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){C[e]=new I(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){C[e]=new I(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){C[e]=new I(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){C[e]=new I(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){C[e]=new I(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){C[e]=new I(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function v(e,t,n,r){var a=C.hasOwnProperty(t)?C[t]:null;(null!==a?0===a.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,b);C[t]=new I(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,b);C[t]=new I(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,b);C[t]=new I(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){C[e]=new I(e,1,!1,e.toLowerCase(),null,!1,!1)})),C.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){C[e]=new I(e,1,!1,e.toLowerCase(),null,!0,!0)}));var A=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,y=60103,w=60106,G=60107,B=60108,x=60114,S=60109,k=60110,Z=60112,R=60113,N=60120,O=60115,W=60116,F=60121,M=60128,V=60129,T=60130,E=60131;if("function"===typeof Symbol&&Symbol.for){var j=Symbol.for;y=j("react.element"),w=j("react.portal"),G=j("react.fragment"),B=j("react.strict_mode"),x=j("react.profiler"),S=j("react.provider"),k=j("react.context"),Z=j("react.forward_ref"),R=j("react.suspense"),N=j("react.suspense_list"),O=j("react.memo"),W=j("react.lazy"),F=j("react.block"),j("react.scope"),M=j("react.opaque.id"),V=j("react.debug_trace_mode"),T=j("react.offscreen"),E=j("react.legacy_hidden")}var L,X="function"===typeof Symbol&&Symbol.iterator;function H(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=X&&e[X]||e["@@iterator"])?e:null}function Y(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var z=!1;function K(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var a=u.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s])return"\n"+a[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Y(e):""}function _(e){switch(e.tag){case 5:return Y(e.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return e=K(e.type,!1);case 11:return e=K(e.type.render,!1);case 22:return e=K(e.type._render,!1);case 1:return e=K(e.type,!0);default:return""}}function D(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case G:return"Fragment";case w:return"Portal";case x:return"Profiler";case B:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case Z:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case O:return D(e.type);case F:return D(e._render);case W:t=e._payload,e=e._init;try{return D(e(t))}catch(n){}}return null}function P(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function U(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function J(e){e._valueTracker||(e._valueTracker=function(e){var t=U(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=U(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return a({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=P(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=P(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ae(e,t.type,n):t.hasOwnProperty("defaultValue")&&ae(e,t.type,P(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ae(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ie(e,t){return e=a({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function oe(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+P(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return a({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ue(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:P(n)}}function ce(e,t){var n=P(t.value),r=P(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var ge="http://www.w3.org/1999/xhtml",de="http://www.w3.org/2000/svg";function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var pe,Ie,Ce=(Ie=function(e,t){if(e.namespaceURI!==de||"innerHTML"in e)e.innerHTML=t;else{for((pe=pe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return Ie(e,t)}))}:Ie);function me(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var be={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ve=["Webkit","ms","Moz","O"];function Ae(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||be.hasOwnProperty(e)&&be[e]?(""+t).trim():t+"px"}function ye(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=Ae(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(be).forEach((function(e){ve.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),be[t]=be[e]}))}));var we=a({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ge(e,t){if(t){if(we[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function Be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,ke=null,Ze=null;function Re(e){if(e=ea(e)){if("function"!==typeof Se)throw Error(o(280));var t=e.stateNode;t&&(t=na(t),Se(e.stateNode,e.type,t))}}function Ne(e){ke?Ze?Ze.push(e):Ze=[e]:ke=e}function Oe(){if(ke){var e=ke,t=Ze;if(Ze=ke=null,Re(e),t)for(e=0;e<t.length;e++)Re(t[e])}}function We(e,t){return e(t)}function Fe(e,t,n,r,a){return e(t,n,r,a)}function Me(){}var Ve=We,Te=!1,Ee=!1;function je(){null===ke&&null===Ze||(Me(),Oe())}function Le(e,t){var n=e.stateNode;if(null===n)return null;var r=na(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Xe=!1;if(g)try{var He={};Object.defineProperty(He,"passive",{get:function(){Xe=!0}}),window.addEventListener("test",He,He),window.removeEventListener("test",He,He)}catch(Ie){Xe=!1}function Ye(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var ze=!1,Ke=null,_e=!1,De=null,Pe={onError:function(e){ze=!0,Ke=e}};function Ue(e,t,n,r,a,i,o,s,u){ze=!1,Ke=null,Ye.apply(Pe,arguments)}function Je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Je(e)!==e)throw Error(o(188))}function $e(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Je(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return qe(a),e;if(i===r)return qe(a),t;i=i.sibling}throw Error(o(188))}if(n.return!==r.return)n=a,r=i;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=i;break}if(u===r){s=!0,r=a,n=i;break}u=u.sibling}if(!s){for(u=i.child;u;){if(u===n){s=!0,n=i,r=a;break}if(u===r){s=!0,r=i,n=a;break}u=u.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,at,it=!1,ot=[],st=null,ut=null,ct=null,lt=new Map,gt=new Map,dt=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ft(e,t,n,r,a){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:a,targetContainers:[r]}}function pt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ut=null;break;case"mouseover":case"mouseout":ct=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gt.delete(t.pointerId)}}function It(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e=ft(t,n,r,a,i),null!==t&&(null!==(t=ea(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ct(e){var t=$r(e.target);if(null!==t){var n=Je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Qe(n)))return e.blockedOn=t,void at(e.lanePriority,(function(){i.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function mt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ea(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function bt(e,t,n){mt(e)&&n.delete(t)}function vt(){for(it=!1;0<ot.length;){var e=ot[0];if(null!==e.blockedOn){null!==(e=ea(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&ot.shift()}null!==st&&mt(st)&&(st=null),null!==ut&&mt(ut)&&(ut=null),null!==ct&&mt(ct)&&(ct=null),lt.forEach(bt),gt.forEach(bt)}function At(e,t){e.blockedOn===t&&(e.blockedOn=null,it||(it=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,vt)))}function yt(e){function t(t){return At(t,e)}if(0<ot.length){At(ot[0],e);for(var n=1;n<ot.length;n++){var r=ot[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==st&&At(st,e),null!==ut&&At(ut,e),null!==ct&&At(ct,e),lt.forEach(t),gt.forEach(t),n=0;n<dt.length;n++)(r=dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<dt.length&&null===(n=dt[0]).blockedOn;)Ct(n),null===n.blockedOn&&dt.shift()}function wt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Gt={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},Bt={},xt={};function St(e){if(Bt[e])return Bt[e];if(!Gt[e])return e;var t,n=Gt[e];for(t in n)if(n.hasOwnProperty(t)&&t in xt)return Bt[e]=n[t];return e}g&&(xt=document.createElement("div").style,"AnimationEvent"in window||(delete Gt.animationend.animation,delete Gt.animationiteration.animation,delete Gt.animationstart.animation),"TransitionEvent"in window||delete Gt.transitionend.transition);var kt=St("animationend"),Zt=St("animationiteration"),Rt=St("animationstart"),Nt=St("transitionend"),Ot=new Map,Wt=new Map,Ft=["abort","abort",kt,"animationEnd",Zt,"animationIteration",Rt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Nt,"transitionEnd","waiting","waiting"];function Mt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];a="on"+(a[0].toUpperCase()+a.slice(1)),Wt.set(r,t),Ot.set(r,a),c(a,[r])}}(0,i.unstable_now)();var Vt=8;function Tt(e){if(0!==(1&e))return Vt=15,1;if(0!==(2&e))return Vt=14,2;if(0!==(4&e))return Vt=13,4;var t=24&e;return 0!==t?(Vt=12,t):0!==(32&e)?(Vt=11,32):0!==(t=192&e)?(Vt=10,t):0!==(256&e)?(Vt=9,256):0!==(t=3584&e)?(Vt=8,t):0!==(4096&e)?(Vt=7,4096):0!==(t=4186112&e)?(Vt=6,t):0!==(t=62914560&e)?(Vt=5,t):67108864&e?(Vt=4,67108864):0!==(134217728&e)?(Vt=3,134217728):0!==(t=805306368&e)?(Vt=2,t):0!==(1073741824&e)?(Vt=1,1073741824):(Vt=8,e)}function Et(e,t){var n=e.pendingLanes;if(0===n)return Vt=0;var r=0,a=0,i=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==i)r=i,a=Vt=15;else if(0!==(i=134217727&n)){var u=i&~o;0!==u?(r=Tt(u),a=Vt):0!==(s&=i)&&(r=Tt(s),a=Vt)}else 0!==(i=n&~o)?(r=Tt(i),a=Vt):0!==s&&(r=Tt(s),a=Vt);if(0===r)return 0;if(r=n&((0>(r=31-zt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(Tt(t),a<=Vt)return t;Vt=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-zt(t)),r|=e[n],t&=~a;return r}function jt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Lt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Xt(24&~t))?Lt(10,t):e;case 10:return 0===(e=Xt(192&~t))?Lt(8,t):e;case 8:return 0===(e=Xt(3584&~t))&&(0===(e=Xt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Xt(805306368&~t))&&(t=268435456),t}throw Error(o(358,e))}function Xt(e){return e&-e}function Ht(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Yt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-zt(t)]=n}var zt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Kt(e)/_t|0)|0},Kt=Math.log,_t=Math.LN2;var Dt=i.unstable_UserBlockingPriority,Pt=i.unstable_runWithPriority,Ut=!0;function Jt(e,t,n,r){Te||Me();var a=qt,i=Te;Te=!0;try{Fe(a,e,t,n,r)}finally{(Te=i)||je()}}function Qt(e,t,n,r){Pt(Dt,qt.bind(null,e,t,n,r))}function qt(e,t,n,r){var a;if(Ut)if((a=0===(4&t))&&0<ot.length&&-1<ht.indexOf(e))e=ft(null,e,t,n,r),ot.push(e);else{var i=$t(e,t,n,r);if(null===i)a&&pt(e,r);else{if(a){if(-1<ht.indexOf(e))return e=ft(i,e,t,n,r),void ot.push(e);if(function(e,t,n,r,a){switch(t){case"focusin":return st=It(st,e,t,n,r,a),!0;case"dragenter":return ut=It(ut,e,t,n,r,a),!0;case"mouseover":return ct=It(ct,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return lt.set(i,It(lt.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,gt.set(i,It(gt.get(i)||null,e,t,n,r,a)),!0}return!1}(i,e,t,n,r))return;pt(e,r)}Or(e,t,r,null,n)}}}function $t(e,t,n,r){var a=xe(r);if(null!==(a=$r(a))){var i=Je(a);if(null===i)a=null;else{var o=i.tag;if(13===o){if(null!==(a=Qe(i)))return a;a=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return Or(e,t,r,a,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,a="value"in en?en.value:en.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return nn=a.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function sn(){return!1}function un(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?on:sn,this.isPropagationStopped=sn,this}return a(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var cn,ln,gn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=un(dn),fn=a({},dn,{view:0,detail:0}),pn=un(fn),In=a({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gn&&(gn&&"mousemove"===e.type?(cn=e.screenX-gn.screenX,ln=e.screenY-gn.screenY):ln=cn=0,gn=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),Cn=un(In),mn=un(a({},In,{dataTransfer:0})),bn=un(a({},fn,{relatedTarget:0})),vn=un(a({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),An=un(a({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),yn=un(a({},dn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Bn[e])&&!!t[e]}function Sn(){return xn}var kn=un(a({},fn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Gn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Zn=un(a({},In,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=un(a({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Nn=un(a({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=un(a({},In,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Wn=[9,13,27,32],Fn=g&&"CompositionEvent"in window,Mn=null;g&&"documentMode"in document&&(Mn=document.documentMode);var Vn=g&&"TextEvent"in window&&!Mn,Tn=g&&(!Fn||Mn&&8<Mn&&11>=Mn),En=String.fromCharCode(32),jn=!1;function Ln(e,t){switch(e){case"keyup":return-1!==Wn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Yn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Yn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ne(r),0<(t=Fr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var _n=null,Dn=null;function Pn(e){xr(e,0)}function Un(e){if(Q(ta(e)))return e}function Jn(e,t){if("change"===e)return t}var Qn=!1;if(g){var qn;if(g){var $n="oninput"in document;if(!$n){var er=document.createElement("div");er.setAttribute("oninput","return;"),$n="function"===typeof er.oninput}qn=$n}else qn=!1;Qn=qn&&(!document.documentMode||9<document.documentMode)}function tr(){_n&&(_n.detachEvent("onpropertychange",nr),Dn=_n=null)}function nr(e){if("value"===e.propertyName&&Un(Dn)){var t=[];if(Kn(t,Dn,e,xe(e)),e=Pn,Te)e(t);else{Te=!0;try{We(e,t)}finally{Te=!1,je()}}}}function rr(e,t,n){"focusin"===e?(tr(),Dn=n,(_n=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Un(Dn)}function ir(e,t){if("click"===e)return Un(t)}function or(e,t){if("input"===e||"change"===e)return Un(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},ur=Object.prototype.hasOwnProperty;function cr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!ur.call(t,n[r])||!sr(e[n[r]],t[n[r]]))return!1;return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function gr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var pr=g&&"documentMode"in document&&11>=document.documentMode,Ir=null,Cr=null,mr=null,br=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==Ir||Ir!==q(r)||("selectionStart"in(r=Ir)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},mr&&cr(mr,r)||(mr=r,0<(r=Fr(Cr,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ir)))}Mt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Mt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Mt(Ft,2);for(var Ar="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),yr=0;yr<Ar.length;yr++)Wt.set(Ar[yr],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Gr=new Set("cancel close invalid load scroll toggle".split(" ").concat(wr));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,i,s,u,c){if(Ue.apply(this,arguments),ze){if(!ze)throw Error(o(198));var l=Ke;ze=!1,Ke=null,_e||(_e=!0,De=l)}}(r,t,void 0,e),e.currentTarget=null}function xr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Br(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Br(a,s,c),i=u}}}if(_e)throw e=De,_e=!1,De=null,e}function Sr(e,t){var n=ra(t),r=e+"__bubble";n.has(r)||(Nr(t,e,2,!1),n.add(r))}var kr="_reactListening"+Math.random().toString(36).slice(2);function Zr(e){e[kr]||(e[kr]=!0,s.forEach((function(t){Gr.has(t)||Rr(t,!1,e,null),Rr(t,!0,e,null)})))}function Rr(e,t,n,r){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=n;if("selectionchange"===e&&9!==n.nodeType&&(i=n.ownerDocument),null!==r&&!t&&Gr.has(e)){if("scroll"!==e)return;a|=2,i=r}var o=ra(i),s=e+"__"+(t?"capture":"bubble");o.has(s)||(t&&(a|=4),Nr(i,e,a,t),o.add(s))}function Nr(e,t,n,r){var a=Wt.get(t);switch(void 0===a?2:a){case 0:a=Jt;break;case 1:a=Qt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!Xe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Or(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=$r(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(Ee)return e(t,n);Ee=!0;try{Ve(e,t,n)}finally{Ee=!1,je()}}((function(){var r=i,a=xe(n),o=[];e:{var s=Ot.get(e);if(void 0!==s){var u=hn,c=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":u=kn;break;case"focusin":c="focus",u=bn;break;case"focusout":c="blur",u=bn;break;case"beforeblur":case"afterblur":u=bn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=Cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Rn;break;case kt:case Zt:case Rt:u=vn;break;case Nt:u=Nn;break;case"scroll":u=pn;break;case"wheel":u=On;break;case"copy":case"cut":case"paste":u=An;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Zn}var l=0!==(4&t),g=!l&&"scroll"===e,d=l?null!==s?s+"Capture":null:s;l=[];for(var h,f=r;null!==f;){var p=(h=f).stateNode;if(5===h.tag&&null!==p&&(h=p,null!==d&&(null!=(p=Le(f,d))&&l.push(Wr(f,p,h)))),g)break;f=f.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(c=n.relatedTarget||n.fromElement)||!$r(c)&&!c[Qr])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?$r(c):null)&&(c!==(g=Je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=Cn,p="onMouseLeave",d="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(l=Zn,p="onPointerLeave",d="onPointerEnter",f="pointer"),g=null==u?s:ta(u),h=null==c?s:ta(c),(s=new l(p,f+"leave",u,n,a)).target=g,s.relatedTarget=h,p=null,$r(a)===r&&((l=new l(d,f+"enter",c,n,a)).target=h,l.relatedTarget=g,p=l),g=p,u&&c)e:{for(d=c,f=0,h=l=u;h;h=Mr(h))f++;for(h=0,p=d;p;p=Mr(p))h++;for(;0<f-h;)l=Mr(l),f--;for(;0<h-f;)d=Mr(d),h--;for(;f--;){if(l===d||null!==d&&l===d.alternate)break e;l=Mr(l),d=Mr(d)}l=null}else l=null;null!==u&&Vr(o,s,u,l,!1),null!==c&&null!==g&&Vr(o,g,c,l,!0)}if("select"===(u=(s=r?ta(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var I=Jn;else if(zn(s))if(Qn)I=or;else{I=ar;var C=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(I=ir);switch(I&&(I=I(e,r))?Kn(o,I,n,a):(C&&C(e,s,r),"focusout"===e&&(C=s._wrapperState)&&C.controlled&&"number"===s.type&&ae(s,"number",s.value)),C=r?ta(r):window,e){case"focusin":(zn(C)||"true"===C.contentEditable)&&(Ir=C,Cr=r,mr=null);break;case"focusout":mr=Cr=Ir=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,vr(o,n,a);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":vr(o,n,a)}var m;if(Fn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Ln(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Tn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(m=rn()):(tn="value"in(en=a)?en.value:en.textContent,Hn=!0)),0<(C=Fr(r,b)).length&&(b=new yn(b,e,null,n,a),o.push({event:b,listeners:C}),m?b.data=m:null!==(m=Xn(n))&&(b.data=m))),(m=Vn?function(e,t){switch(e){case"compositionend":return Xn(t);case"keypress":return 32!==t.which?null:(jn=!0,En);case"textInput":return(e=t.data)===En&&jn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Fn&&Ln(e,t)?(e=rn(),nn=tn=en=null,Hn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tn&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=Fr(r,"onBeforeInput")).length&&(a=new yn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=m))}xr(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Le(e,n))&&r.unshift(Wr(e,i,a)),null!=(i=Le(e,t))&&r.push(Wr(e,i,a))),e=e.return}return r}function Mr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Vr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=Le(n,i))&&o.unshift(Wr(n,u,s)):a||null!=(u=Le(n,i))&&o.push(Wr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}function Tr(){}var Er=null,jr=null;function Lr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Xr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Hr="function"===typeof setTimeout?setTimeout:void 0,Yr="function"===typeof clearTimeout?clearTimeout:void 0;function zr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Kr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function _r(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Dr=0;var Pr=Math.random().toString(36).slice(2),Ur="__reactFiber$"+Pr,Jr="__reactProps$"+Pr,Qr="__reactContainer$"+Pr,qr="__reactEvents$"+Pr;function $r(e){var t=e[Ur];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Qr]||n[Ur]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=_r(e);null!==e;){if(n=e[Ur])return n;e=_r(e)}return t}n=(e=n).parentNode}return null}function ea(e){return!(e=e[Ur]||e[Qr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ta(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function na(e){return e[Jr]||null}function ra(e){var t=e[qr];return void 0===t&&(t=e[qr]=new Set),t}var aa=[],ia=-1;function oa(e){return{current:e}}function sa(e){0>ia||(e.current=aa[ia],aa[ia]=null,ia--)}function ua(e,t){ia++,aa[ia]=e.current,e.current=t}var ca={},la=oa(ca),ga=oa(!1),da=ca;function ha(e,t){var n=e.type.contextTypes;if(!n)return ca;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function fa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function pa(){sa(ga),sa(la)}function Ia(e,t,n){if(la.current!==ca)throw Error(o(168));ua(la,t),ua(ga,n)}function Ca(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(o(108,D(t)||"Unknown",i));return a({},n,r)}function ma(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ca,da=la.current,ua(la,e),ua(ga,ga.current),!0}function ba(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Ca(e,t,da),r.__reactInternalMemoizedMergedChildContext=e,sa(ga),sa(la),ua(la,e)):sa(ga),ua(ga,n)}var va=null,Aa=null,ya=i.unstable_runWithPriority,wa=i.unstable_scheduleCallback,Ga=i.unstable_cancelCallback,Ba=i.unstable_shouldYield,xa=i.unstable_requestPaint,Sa=i.unstable_now,ka=i.unstable_getCurrentPriorityLevel,Za=i.unstable_ImmediatePriority,Ra=i.unstable_UserBlockingPriority,Na=i.unstable_NormalPriority,Oa=i.unstable_LowPriority,Wa=i.unstable_IdlePriority,Fa={},Ma=void 0!==xa?xa:function(){},Va=null,Ta=null,Ea=!1,ja=Sa(),La=1e4>ja?Sa:function(){return Sa()-ja};function Xa(){switch(ka()){case Za:return 99;case Ra:return 98;case Na:return 97;case Oa:return 96;case Wa:return 95;default:throw Error(o(332))}}function Ha(e){switch(e){case 99:return Za;case 98:return Ra;case 97:return Na;case 96:return Oa;case 95:return Wa;default:throw Error(o(332))}}function Ya(e,t){return e=Ha(e),ya(e,t)}function za(e,t,n){return e=Ha(e),wa(e,t,n)}function Ka(){if(null!==Ta){var e=Ta;Ta=null,Ga(e)}_a()}function _a(){if(!Ea&&null!==Va){Ea=!0;var e=0;try{var t=Va;Ya(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Va=null}catch(n){throw null!==Va&&(Va=Va.slice(e+1)),wa(Za,Ka),n}finally{Ea=!1}}}var Da=A.ReactCurrentBatchConfig;function Pa(e,t){if(e&&e.defaultProps){for(var n in t=a({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ua=oa(null),Ja=null,Qa=null,qa=null;function $a(){qa=Qa=Ja=null}function ei(e){var t=Ua.current;sa(Ua),e.type._context._currentValue=t}function ti(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function ni(e,t){Ja=e,qa=Qa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Fo=!0),e.firstContext=null)}function ri(e,t){if(qa!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(qa=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Qa){if(null===Ja)throw Error(o(308));Qa=t,Ja.dependencies={lanes:0,firstContext:t,responders:null}}else Qa=Qa.next=t;return e._currentValue}var ai=!1;function ii(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function si(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ui(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function ci(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function li(e,t,n,r){var i=e.updateQueue;ai=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var c=u,l=c.next;c.next=null,null===s?o=l:s.next=l,s=c;var g=e.alternate;if(null!==g){var d=(g=g.updateQueue).lastBaseUpdate;d!==s&&(null===d?g.firstBaseUpdate=l:d.next=l,g.lastBaseUpdate=c)}}if(null!==o){for(d=i.baseState,s=0,g=l=c=null;;){u=o.lane;var h=o.eventTime;if((r&u)===u){null!==g&&(g=g.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,p=o;switch(u=t,h=n,p.tag){case 1:if("function"===typeof(f=p.payload)){d=f.call(h,d,u);break e}d=f;break e;case 3:f.flags=-4097&f.flags|64;case 0:if(null===(u="function"===typeof(f=p.payload)?f.call(h,d,u):f)||void 0===u)break e;d=a({},d,u);break e;case 2:ai=!0}}null!==o.callback&&(e.flags|=32,null===(u=i.effects)?i.effects=[o]:u.push(o))}else h={eventTime:h,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===g?(l=g=h,c=d):g=g.next=h,s|=u;if(null===(o=o.next)){if(null===(u=i.shared.pending))break;o=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}null===g&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=g,Es|=s,e.lanes=s,e.memoizedState=d}}function gi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(o(191,a));a.call(r)}}}var di=(new r.Component).refs;function hi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fi={isMounted:function(e){return!!(e=e._reactInternals)&&Je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cu(),a=lu(e),i=si(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ui(e,i),gu(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cu(),a=lu(e),i=si(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),ui(e,i),gu(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cu(),r=lu(e),a=si(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),ui(e,a),gu(e,r,n)}};function pi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,i))}function Ii(e,t,n){var r=!1,a=ca,i=t.contextType;return"object"===typeof i&&null!==i?i=ri(i):(a=fa(t)?da:la.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?ha(e,a):ca),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ci(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fi.enqueueReplaceState(t,t.state,null)}function mi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=di,ii(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=ri(i):(i=fa(t)?da:la.current,a.context=ha(e,i)),li(e,n,a,r),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(hi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&fi.enqueueReplaceState(a,a.state,null),li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4)}var bi=Array.isArray;function vi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=r.refs;t===di&&(t=r.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Ai(e,t){if("textarea"!==e.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function yi(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Yu(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Du(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=vi(e,t,n),r.return=e,r):((r=zu(n.type,n.key,n.props,null,e.mode,r)).ref=vi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Pu(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function g(e,t,n,r,i){return null===t||7!==t.tag?((t=Ku(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Du(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case y:return(n=zu(t.type,t.key,t.props,null,e.mode,n)).ref=vi(e,null,t),n.return=e,n;case w:return(t=Pu(t,e.mode,n)).return=e,t}if(bi(t)||H(t))return(t=Ku(t,e.mode,n,null)).return=e,t;Ai(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case y:return n.key===a?n.type===G?g(e,t,n.props.children,r,a):c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null}if(bi(n)||H(n))return null!==a?null:g(e,t,n,r,null);Ai(e,n)}return null}function f(e,t,n,r,a){if("string"===typeof r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case y:return e=e.get(null===r.key?n:r.key)||null,r.type===G?g(t,e,r.props.children,a,r.key):c(t,e,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(bi(r)||H(r))return g(t,e=e.get(n)||null,r,a,null);Ai(t,r)}return null}function p(a,o,s,u){for(var c=null,l=null,g=o,p=o=0,I=null;null!==g&&p<s.length;p++){g.index>p?(I=g,g=null):I=g.sibling;var C=h(a,g,s[p],u);if(null===C){null===g&&(g=I);break}e&&g&&null===C.alternate&&t(a,g),o=i(C,o,p),null===l?c=C:l.sibling=C,l=C,g=I}if(p===s.length)return n(a,g),c;if(null===g){for(;p<s.length;p++)null!==(g=d(a,s[p],u))&&(o=i(g,o,p),null===l?c=g:l.sibling=g,l=g);return c}for(g=r(a,g);p<s.length;p++)null!==(I=f(g,a,p,s[p],u))&&(e&&null!==I.alternate&&g.delete(null===I.key?p:I.key),o=i(I,o,p),null===l?c=I:l.sibling=I,l=I);return e&&g.forEach((function(e){return t(a,e)})),c}function I(a,s,u,c){var l=H(u);if("function"!==typeof l)throw Error(o(150));if(null==(u=l.call(u)))throw Error(o(151));for(var g=l=null,p=s,I=s=0,C=null,m=u.next();null!==p&&!m.done;I++,m=u.next()){p.index>I?(C=p,p=null):C=p.sibling;var b=h(a,p,m.value,c);if(null===b){null===p&&(p=C);break}e&&p&&null===b.alternate&&t(a,p),s=i(b,s,I),null===g?l=b:g.sibling=b,g=b,p=C}if(m.done)return n(a,p),l;if(null===p){for(;!m.done;I++,m=u.next())null!==(m=d(a,m.value,c))&&(s=i(m,s,I),null===g?l=m:g.sibling=m,g=m);return l}for(p=r(a,p);!m.done;I++,m=u.next())null!==(m=f(p,a,I,m.value,c))&&(e&&null!==m.alternate&&p.delete(null===m.key?I:m.key),s=i(m,s,I),null===g?l=m:g.sibling=m,g=m);return e&&p.forEach((function(e){return t(a,e)})),l}return function(e,r,i,u){var c="object"===typeof i&&null!==i&&i.type===G&&null===i.key;c&&(i=i.props.children);var l="object"===typeof i&&null!==i;if(l)switch(i.$$typeof){case y:e:{for(l=i.key,c=r;null!==c;){if(c.key===l){switch(c.tag){case 7:if(i.type===G){n(e,c.sibling),(r=a(c,i.props.children)).return=e,e=r;break e}break;default:if(c.elementType===i.type){n(e,c.sibling),(r=a(c,i.props)).ref=vi(e,c,i),r.return=e,e=r;break e}}n(e,c);break}t(e,c),c=c.sibling}i.type===G?((r=Ku(i.props.children,e.mode,u,i.key)).return=e,e=r):((u=zu(i.type,i.key,i.props,null,e.mode,u)).ref=vi(e,r,i),u.return=e,e=u)}return s(e);case w:e:{for(c=i.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=a(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Pu(i,e.mode,u)).return=e,e=r}return s(e)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,i)).return=e,e=r):(n(e,r),(r=Du(i,e.mode,u)).return=e,e=r),s(e);if(bi(i))return p(e,r,i,u);if(H(i))return I(e,r,i,u);if(l&&Ai(e,i),"undefined"===typeof i&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(o(152,D(e.type)||"Component"))}return n(e,r)}}var wi=yi(!0),Gi=yi(!1),Bi={},xi=oa(Bi),Si=oa(Bi),ki=oa(Bi);function Zi(e){if(e===Bi)throw Error(o(174));return e}function Ri(e,t){switch(ua(ki,t),ua(Si,e),ua(xi,Bi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fe(null,"");break;default:t=fe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}sa(xi),ua(xi,t)}function Ni(){sa(xi),sa(Si),sa(ki)}function Oi(e){Zi(ki.current);var t=Zi(xi.current),n=fe(t,e.type);t!==n&&(ua(Si,e),ua(xi,n))}function Wi(e){Si.current===e&&(sa(xi),sa(Si))}var Fi=oa(0);function Mi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vi=null,Ti=null,Ei=!1;function ji(e,t){var n=Xu(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Xi(e){if(Ei){var t=Ti;if(t){var n=t;if(!Li(e,t)){if(!(t=Kr(n.nextSibling))||!Li(e,t))return e.flags=-1025&e.flags|2,Ei=!1,void(Vi=e);ji(Vi,n)}Vi=e,Ti=Kr(t.firstChild)}else e.flags=-1025&e.flags|2,Ei=!1,Vi=e}}function Hi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Vi=e}function Yi(e){if(e!==Vi)return!1;if(!Ei)return Hi(e),Ei=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Xr(t,e.memoizedProps))for(t=Ti;t;)ji(e,t),t=Kr(t.nextSibling);if(Hi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ti=Kr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ti=null}}else Ti=Vi?Kr(e.stateNode.nextSibling):null;return!0}function zi(){Ti=Vi=null,Ei=!1}var Ki=[];function _i(){for(var e=0;e<Ki.length;e++)Ki[e]._workInProgressVersionPrimary=null;Ki.length=0}var Di=A.ReactCurrentDispatcher,Pi=A.ReactCurrentBatchConfig,Ui=0,Ji=null,Qi=null,qi=null,$i=!1,eo=!1;function to(){throw Error(o(321))}function no(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ro(e,t,n,r,a,i){if(Ui=i,Ji=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Di.current=null===e||null===e.memoizedState?Ro:No,e=n(r,a),eo){i=0;do{if(eo=!1,!(25>i))throw Error(o(301));i+=1,qi=Qi=null,t.updateQueue=null,Di.current=Oo,e=n(r,a)}while(eo)}if(Di.current=Zo,t=null!==Qi&&null!==Qi.next,Ui=0,qi=Qi=Ji=null,$i=!1,t)throw Error(o(300));return e}function ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===qi?Ji.memoizedState=qi=e:qi=qi.next=e,qi}function io(){if(null===Qi){var e=Ji.alternate;e=null!==e?e.memoizedState:null}else e=Qi.next;var t=null===qi?Ji.memoizedState:qi.next;if(null!==t)qi=t,Qi=e;else{if(null===e)throw Error(o(310));e={memoizedState:(Qi=e).memoizedState,baseState:Qi.baseState,baseQueue:Qi.baseQueue,queue:Qi.queue,next:null},null===qi?Ji.memoizedState=qi=e:qi=qi.next=e}return qi}function oo(e,t){return"function"===typeof t?t(e):t}function so(e){var t=io(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=Qi,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var s=a.next;a.next=i.next,i.next=s}r.baseQueue=a=i,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var u=s=i=null,c=a;do{var l=c.lane;if((Ui&l)===l)null!==u&&(u=u.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var g={lane:l,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===u?(s=u=g,i=r):u=u.next=g,Ji.lanes|=l,Es|=l}c=c.next}while(null!==c&&c!==a);null===u?i=r:u.next=s,sr(r,t.memoizedState)||(Fo=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function uo(e){var t=io(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{i=e(i,s.action),s=s.next}while(s!==a);sr(i,t.memoizedState)||(Fo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function co(e,t,n){var r=t._getVersion;r=r(t._source);var a=t._workInProgressVersionPrimary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(Ui&e)===e)&&(t._workInProgressVersionPrimary=r,Ki.push(t))),e)return n(t._source);throw Ki.push(t),Error(o(350))}function lo(e,t,n,r){var a=Rs;if(null===a)throw Error(o(349));var i=t._getVersion,s=i(t._source),u=Di.current,c=u.useState((function(){return co(a,t,n)})),l=c[1],g=c[0];c=qi;var d=e.memoizedState,h=d.refs,f=h.getSnapshot,p=d.source;d=d.subscribe;var I=Ji;return e.memoizedState={refs:h,source:t,subscribe:r},u.useEffect((function(){h.getSnapshot=n,h.setSnapshot=l;var e=i(t._source);if(!sr(s,e)){e=n(t._source),sr(g,e)||(l(e),e=lu(I),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,o=e;0<o;){var u=31-zt(o),c=1<<u;r[u]|=e,o&=~c}}}),[n,t,r]),u.useEffect((function(){return r(t._source,(function(){var e=h.getSnapshot,n=h.setSnapshot;try{n(e(t._source));var r=lu(I);a.mutableReadLanes|=r&a.pendingLanes}catch(i){n((function(){throw i}))}}))}),[t,r]),sr(f,n)&&sr(p,t)&&sr(d,r)||((e={pending:null,dispatch:null,lastRenderedReducer:oo,lastRenderedState:g}).dispatch=l=ko.bind(null,Ji,e),c.queue=e,c.baseQueue=null,g=co(a,t,n),c.memoizedState=c.baseState=g),g}function go(e,t,n){return lo(io(),e,t,n)}function ho(e){var t=ao();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:oo,lastRenderedState:e}).dispatch=ko.bind(null,Ji,e),[t.memoizedState,e]}function fo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Ji.updateQueue)?(t={lastEffect:null},Ji.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function po(e){return e={current:e},ao().memoizedState=e}function Io(){return io().memoizedState}function Co(e,t,n,r){var a=ao();Ji.flags|=e,a.memoizedState=fo(1|t,n,void 0,void 0===r?null:r)}function mo(e,t,n,r){var a=io();r=void 0===r?null:r;var i=void 0;if(null!==Qi){var o=Qi.memoizedState;if(i=o.destroy,null!==r&&no(r,o.deps))return void fo(t,n,i,r)}Ji.flags|=e,a.memoizedState=fo(1|t,n,i,r)}function bo(e,t){return Co(516,4,e,t)}function vo(e,t){return mo(516,4,e,t)}function Ao(e,t){return mo(4,2,e,t)}function yo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function wo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,mo(4,2,yo.bind(null,t,e),n)}function Go(){}function Bo(e,t){var n=io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&no(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function xo(e,t){var n=io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&no(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function So(e,t){var n=Xa();Ya(98>n?98:n,(function(){e(!0)})),Ya(97<n?97:n,(function(){var n=Pi.transition;Pi.transition=1;try{e(!1),t()}finally{Pi.transition=n}}))}function ko(e,t,n){var r=cu(),a=lu(e),i={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===Ji||null!==o&&o===Ji)eo=$i=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=o(s,n);if(i.eagerReducer=o,i.eagerState=u,sr(u,s))return}catch(c){}gu(e,a,r)}}var Zo={readContext:ri,useCallback:to,useContext:to,useEffect:to,useImperativeHandle:to,useLayoutEffect:to,useMemo:to,useReducer:to,useRef:to,useState:to,useDebugValue:to,useDeferredValue:to,useTransition:to,useMutableSource:to,useOpaqueIdentifier:to,unstable_isNewReconciler:!1},Ro={readContext:ri,useCallback:function(e,t){return ao().memoizedState=[e,void 0===t?null:t],e},useContext:ri,useEffect:bo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Co(4,2,yo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Co(4,2,e,t)},useMemo:function(e,t){var n=ao();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ao();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=ko.bind(null,Ji,e),[r.memoizedState,e]},useRef:po,useState:ho,useDebugValue:Go,useDeferredValue:function(e){var t=ho(e),n=t[0],r=t[1];return bo((function(){var t=Pi.transition;Pi.transition=1;try{r(e)}finally{Pi.transition=t}}),[e]),n},useTransition:function(){var e=ho(!1),t=e[0];return po(e=So.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=ao();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},lo(r,e,t,n)},useOpaqueIdentifier:function(){if(Ei){var e=!1,t=function(e){return{$$typeof:M,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Dr++).toString(36))),Error(o(355))})),n=ho(t)[1];return 0===(2&Ji.mode)&&(Ji.flags|=516,fo(5,(function(){n("r:"+(Dr++).toString(36))}),void 0,null)),t}return ho(t="r:"+(Dr++).toString(36)),t},unstable_isNewReconciler:!1},No={readContext:ri,useCallback:Bo,useContext:ri,useEffect:vo,useImperativeHandle:wo,useLayoutEffect:Ao,useMemo:xo,useReducer:so,useRef:Io,useState:function(){return so(oo)},useDebugValue:Go,useDeferredValue:function(e){var t=so(oo),n=t[0],r=t[1];return vo((function(){var t=Pi.transition;Pi.transition=1;try{r(e)}finally{Pi.transition=t}}),[e]),n},useTransition:function(){var e=so(oo)[0];return[Io().current,e]},useMutableSource:go,useOpaqueIdentifier:function(){return so(oo)[0]},unstable_isNewReconciler:!1},Oo={readContext:ri,useCallback:Bo,useContext:ri,useEffect:vo,useImperativeHandle:wo,useLayoutEffect:Ao,useMemo:xo,useReducer:uo,useRef:Io,useState:function(){return uo(oo)},useDebugValue:Go,useDeferredValue:function(e){var t=uo(oo),n=t[0],r=t[1];return vo((function(){var t=Pi.transition;Pi.transition=1;try{r(e)}finally{Pi.transition=t}}),[e]),n},useTransition:function(){var e=uo(oo)[0];return[Io().current,e]},useMutableSource:go,useOpaqueIdentifier:function(){return uo(oo)[0]},unstable_isNewReconciler:!1},Wo=A.ReactCurrentOwner,Fo=!1;function Mo(e,t,n,r){t.child=null===e?Gi(t,null,n,r):wi(t,e.child,n,r)}function Vo(e,t,n,r,a){n=n.render;var i=t.ref;return ni(t,a),r=ro(e,t,n,r,i,a),null===e||Fo?(t.flags|=1,Mo(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,ns(e,t,a))}function To(e,t,n,r,a,i){if(null===e){var o=n.type;return"function"!==typeof o||Hu(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=zu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Eo(e,t,o,r,a,i))}return o=e.child,0===(a&i)&&(a=o.memoizedProps,(n=null!==(n=n.compare)?n:cr)(a,r)&&e.ref===t.ref)?ns(e,t,i):(t.flags|=1,(e=Yu(o,r)).ref=t.ref,e.return=t,t.child=e)}function Eo(e,t,n,r,a,i){if(null!==e&&cr(e.memoizedProps,r)&&e.ref===t.ref){if(Fo=!1,0===(i&a))return t.lanes=e.lanes,ns(e,t,i);0!==(16384&e.flags)&&(Fo=!0)}return Xo(e,t,n,r,i)}function jo(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},bu(t,n);else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},bu(t,e),null;t.memoizedState={baseLanes:0},bu(t,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,bu(t,r);return Mo(e,t,a,n),t.child}function Lo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Xo(e,t,n,r,a){var i=fa(n)?da:la.current;return i=ha(t,i),ni(t,a),n=ro(e,t,n,r,i,a),null===e||Fo?(t.flags|=1,Mo(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,ns(e,t,a))}function Ho(e,t,n,r,a){if(fa(n)){var i=!0;ma(t)}else i=!1;if(ni(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Ii(t,n,r),mi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=ri(c):c=ha(t,c=fa(n)?da:la.current);var l=n.getDerivedStateFromProps,g="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;g||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Ci(t,o,r,c),ai=!1;var d=t.memoizedState;o.state=d,li(t,r,o,a),u=t.memoizedState,s!==r||d!==u||ga.current||ai?("function"===typeof l&&(hi(t,n,l,r),u=t.memoizedState),(s=ai||pi(t,n,s,r,d,u,c))?(g||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,oi(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Pa(t.type,s),o.props=c,g=t.pendingProps,d=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=ri(u):u=ha(t,u=fa(n)?da:la.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==g||d!==u)&&Ci(t,o,r,u),ai=!1,d=t.memoizedState,o.state=d,li(t,r,o,a);var f=t.memoizedState;s!==g||d!==f||ga.current||ai?("function"===typeof h&&(hi(t,n,h,r),f=t.memoizedState),(c=ai||pi(t,n,c,r,d,f,u))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Yo(e,t,n,r,i,a)}function Yo(e,t,n,r,a,i){Lo(e,t);var o=0!==(64&t.flags);if(!r&&!o)return a&&ba(t,n,!1),ns(e,t,i);r=t.stateNode,Wo.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=wi(t,e.child,null,i),t.child=wi(t,null,s,i)):Mo(e,t,s,i),t.memoizedState=r.state,a&&ba(t,n,!0),t.child}function zo(e){var t=e.stateNode;t.pendingContext?Ia(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ia(0,t.context,!1),Ri(e,t.containerInfo)}var Ko,_o,Do,Po={dehydrated:null,retryLane:0};function Uo(e,t,n){var r,a=t.pendingProps,i=Fi.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(i|=1),ua(Fi,1&i),null===e?(void 0!==a.fallback&&Xi(t),e=a.children,i=a.fallback,o?(e=Jo(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Po,e):"number"===typeof a.unstable_expectedLoadTime?(e=Jo(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Po,t.lanes=33554432,e):((n=_u({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(a=qo(e,t,a.children,a.fallback,n),o=t.child,i=e.child.memoizedState,o.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=Po,a):(n=Qo(e,t,a.children,n),t.memoizedState=null,n))}function Jo(e,t,n,r){var a=e.mode,i=e.child;return t={mode:"hidden",children:t},0===(2&a)&&null!==i?(i.childLanes=0,i.pendingProps=t):i=_u(t,a,0,null),n=Ku(n,a,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function Qo(e,t,n,r){var a=e.child;return e=a.sibling,n=Yu(a,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function qo(e,t,n,r,a){var i=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:n};return 0===(2&i)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Yu(o,s),null!==e?r=Yu(e,r):(r=Ku(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function $o(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ti(e.return,t)}function es(e,t,n,r,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.lastEffect=i)}function ts(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Mo(e,t,r.children,n),0!==(2&(r=Fi.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$o(e,n);else if(19===e.tag)$o(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ua(Fi,r),0===(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Mi(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),es(t,!1,a,n,i,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Mi(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}es(t,!0,n,null,i,t.lastEffect);break;case"together":es(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ns(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Es|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Yu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Yu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function rs(e,t){if(!Ei)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function as(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return fa(t.type)&&pa(),null;case 3:return Ni(),sa(ga),sa(la),_i(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Yi(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Wi(t);var i=Zi(ki.current);if(n=t.type,null!==e&&null!=t.stateNode)_o(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(o(166));return null}if(e=Zi(xi.current),Yi(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Ur]=t,r[Jr]=s,n){case"dialog":Sr("cancel",r),Sr("close",r);break;case"iframe":case"object":case"embed":Sr("load",r);break;case"video":case"audio":for(e=0;e<wr.length;e++)Sr(wr[e],r);break;case"source":Sr("error",r);break;case"img":case"image":case"link":Sr("error",r),Sr("load",r);break;case"details":Sr("toggle",r);break;case"input":ee(r,s),Sr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Sr("invalid",r);break;case"textarea":ue(r,s),Sr("invalid",r)}for(var c in Ge(n,s),e=null,s)s.hasOwnProperty(c)&&(i=s[c],"children"===c?"string"===typeof i?r.textContent!==i&&(e=["children",i]):"number"===typeof i&&r.textContent!==""+i&&(e=["children",""+i]):u.hasOwnProperty(c)&&null!=i&&"onScroll"===c&&Sr("scroll",r));switch(n){case"input":J(r),re(r,s,!0);break;case"textarea":J(r),le(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Tr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(c=9===i.nodeType?i:i.ownerDocument,e===ge&&(e=he(n)),e===ge?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Ur]=t,e[Jr]=r,Ko(e,t),t.stateNode=e,c=Be(n,r),n){case"dialog":Sr("cancel",e),Sr("close",e),i=r;break;case"iframe":case"object":case"embed":Sr("load",e),i=r;break;case"video":case"audio":for(i=0;i<wr.length;i++)Sr(wr[i],e);i=r;break;case"source":Sr("error",e),i=r;break;case"img":case"image":case"link":Sr("error",e),Sr("load",e),i=r;break;case"details":Sr("toggle",e),i=r;break;case"input":ee(e,r),i=$(e,r),Sr("invalid",e);break;case"option":i=ie(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=a({},r,{value:void 0}),Sr("invalid",e);break;case"textarea":ue(e,r),i=se(e,r),Sr("invalid",e);break;default:i=r}Ge(n,i);var l=i;for(s in l)if(l.hasOwnProperty(s)){var g=l[s];"style"===s?ye(e,g):"dangerouslySetInnerHTML"===s?null!=(g=g?g.__html:void 0)&&Ce(e,g):"children"===s?"string"===typeof g?("textarea"!==n||""!==g)&&me(e,g):"number"===typeof g&&me(e,""+g):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(u.hasOwnProperty(s)?null!=g&&"onScroll"===s&&Sr("scroll",e):null!=g&&v(e,s,g,c))}switch(n){case"input":J(e),re(e,r,!1);break;case"textarea":J(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+P(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?oe(e,!!r.multiple,s,!1):null!=r.defaultValue&&oe(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Tr)}Lr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Do(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));n=Zi(ki.current),Zi(xi.current),Yi(t)?(r=t.stateNode,n=t.memoizedProps,r[Ur]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Ur]=t,t.stateNode=r)}return null;case 13:return sa(Fi),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Yi(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Fi.current)?0===Ms&&(Ms=3):(0!==Ms&&3!==Ms||(Ms=4),null===Rs||0===(134217727&Es)&&0===(134217727&js)||pu(Rs,Os))),(r||n)&&(t.flags|=4),null);case 4:return Ni(),null===e&&Zr(t.stateNode.containerInfo),null;case 10:return ei(t),null;case 17:return fa(t.type)&&pa(),null;case 19:if(sa(Fi),null===(r=t.memoizedState))return null;if(s=0!==(64&t.flags),null===(c=r.rendering))if(s)rs(r,!1);else{if(0!==Ms||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(c=Mi(e))){for(t.flags|=64,rs(r,!1),null!==(s=c.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ua(Fi,1&Fi.current|2),t.child}e=e.sibling}null!==r.tail&&La()>Ys&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=Mi(c))){if(t.flags|=64,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),rs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!c.alternate&&!Ei)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*La()-r.renderingStartTime>Ys&&1073741824!==n&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432);r.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=r.last)?n.sibling=c:t.child=c,r.last=c)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=La(),n.sibling=null,t=Fi.current,ua(Fi,s?1&t|2:1&t),n):null;case 23:case 24:return vu(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(o(156,t.tag))}function is(e){switch(e.tag){case 1:fa(e.type)&&pa();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Ni(),sa(ga),sa(la),_i(),0!==(64&(t=e.flags)))throw Error(o(285));return e.flags=-4097&t|64,e;case 5:return Wi(e),null;case 13:return sa(Fi),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return sa(Fi),null;case 4:return Ni(),null;case 10:return ei(e),null;case 23:case 24:return vu(),null;default:return null}}function os(e,t){try{var n="",r=t;do{n+=_(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function ss(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Ko=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},_o=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Zi(xi.current);var o,s=null;switch(n){case"input":i=$(e,i),r=$(e,r),s=[];break;case"option":i=ie(e,i),r=ie(e,r),s=[];break;case"select":i=a({},i,{value:void 0}),r=a({},r,{value:void 0}),s=[];break;case"textarea":i=se(e,i),r=se(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Tr)}for(g in Ge(n,r),n=null,i)if(!r.hasOwnProperty(g)&&i.hasOwnProperty(g)&&null!=i[g])if("style"===g){var c=i[g];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==g&&"children"!==g&&"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&"autoFocus"!==g&&(u.hasOwnProperty(g)?s||(s=[]):(s=s||[]).push(g,null));for(g in r){var l=r[g];if(c=null!=i?i[g]:void 0,r.hasOwnProperty(g)&&l!==c&&(null!=l||null!=c))if("style"===g)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(g,n)),n=l;else"dangerouslySetInnerHTML"===g?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(g,l)):"children"===g?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(g,""+l):"suppressContentEditableWarning"!==g&&"suppressHydrationWarning"!==g&&(u.hasOwnProperty(g)?(null!=l&&"onScroll"===g&&Sr("scroll",e),s||c===l||(s=[])):"object"===typeof l&&null!==l&&l.$$typeof===M?l.toString():(s=s||[]).push(g,l))}n&&(s=s||[]).push("style",n);var g=s;(t.updateQueue=g)&&(t.flags|=4)}},Do=function(e,t,n,r){n!==r&&(t.flags|=4)};var us="function"===typeof WeakMap?WeakMap:Map;function cs(e,t,n){(n=si(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ds||(Ds=!0,Ps=r),ss(0,t)},n}function ls(e,t,n){(n=si(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return ss(0,t),r(a)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Us?Us=new Set([this]):Us.add(this),ss(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var gs="function"===typeof WeakSet?WeakSet:Set;function ds(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Tu(e,n)}else t.current=null}function hs(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Pa(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&zr(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(o(163))}function fs(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!==(4&(a=a.tag))&&0!==(1&a)&&(Fu(n,e),Wu(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Pa(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&gi(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}gi(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Lr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&yt(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(o(163))}function ps(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var a=n.memoizedProps.style;a=void 0!==a&&null!==a&&a.hasOwnProperty("display")?a.display:null,r.style.display=Ae("display",a)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Is(e,t){if(Aa&&"function"===typeof Aa.onCommitFiberUnmount)try{Aa.onCommitFiberUnmount(va,t)}catch(i){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!==(4&r))Fu(t,n);else{r=t;try{a()}catch(i){Tu(r,i)}}n=n.next}while(n!==e)}break;case 1:if(ds(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){Tu(t,i)}break;case 5:ds(t);break;case 4:ys(e,t)}}function Cs(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function ms(e){return 5===e.tag||3===e.tag||4===e.tag}function bs(e){e:{for(var t=e.return;null!==t;){if(ms(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(o(161))}16&n.flags&&(me(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ms(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?vs(e,n,t):As(e,n,t)}function vs(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Tr));else if(4!==r&&null!==(e=e.child))for(vs(e,t,n),e=e.sibling;null!==e;)vs(e,t,n),e=e.sibling}function As(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(As(e,t,n),e=e.sibling;null!==e;)As(e,t,n),e=e.sibling}function ys(e,t){for(var n,r,a=t,i=!1;;){if(!i){i=a.return;e:for(;;){if(null===i)throw Error(o(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===a.tag||6===a.tag){e:for(var s=e,u=a,c=u;;)if(Is(s,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===u)break e;for(;null===c.sibling;){if(null===c.return||c.return===u)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(s=n,u=a.stateNode,8===s.nodeType?s.parentNode.removeChild(u):s.removeChild(u)):n.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(Is(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(i=!1)}a.sibling.return=a.return,a=a.sibling}}function ws(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var a=null!==e?e.memoizedProps:r;e=t.type;var i=t.updateQueue;if(t.updateQueue=null,null!==i){for(n[Jr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Be(e,a),t=Be(e,r),a=0;a<i.length;a+=2){var s=i[a],u=i[a+1];"style"===s?ye(n,u):"dangerouslySetInnerHTML"===s?Ce(n,u):"children"===s?me(n,u):v(n,s,u,t)}switch(e){case"input":ne(n,r);break;case"textarea":ce(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(i=r.value)?oe(n,!!r.multiple,i,!1):e!==!!r.multiple&&(null!=r.defaultValue?oe(n,!!r.multiple,r.defaultValue,!0):oe(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(o(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,yt(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Hs=La(),ps(t.child,!0)),void Gs(t);case 19:return void Gs(t);case 17:return;case 23:case 24:return void ps(t,null!==t.memoizedState)}throw Error(o(163))}function Gs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new gs),t.forEach((function(t){var r=ju.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Bs(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var xs=Math.ceil,Ss=A.ReactCurrentDispatcher,ks=A.ReactCurrentOwner,Zs=0,Rs=null,Ns=null,Os=0,Ws=0,Fs=oa(0),Ms=0,Vs=null,Ts=0,Es=0,js=0,Ls=0,Xs=null,Hs=0,Ys=1/0;function zs(){Ys=La()+500}var Ks,_s=null,Ds=!1,Ps=null,Us=null,Js=!1,Qs=null,qs=90,$s=[],eu=[],tu=null,nu=0,ru=null,au=-1,iu=0,ou=0,su=null,uu=!1;function cu(){return 0!==(48&Zs)?La():-1!==au?au:au=La()}function lu(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Xa()?1:2;if(0===iu&&(iu=Ts),0!==Da.transition){0!==ou&&(ou=null!==Xs?Xs.pendingLanes:0),e=iu;var t=4186112&~ou;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Xa(),0!==(4&Zs)&&98===e?e=Lt(12,iu):e=Lt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),iu),e}function gu(e,t,n){if(50<nu)throw nu=0,ru=null,Error(o(185));if(null===(e=du(e,t)))return null;Yt(e,t,n),e===Rs&&(js|=t,4===Ms&&pu(e,Os));var r=Xa();1===t?0!==(8&Zs)&&0===(48&Zs)?Iu(e):(hu(e,n),0===Zs&&(zs(),Ka())):(0===(4&Zs)||98!==r&&99!==r||(null===tu?tu=new Set([e]):tu.add(e)),hu(e,n)),Xs=e}function du(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function hu(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var u=31-zt(s),c=1<<u,l=i[u];if(-1===l){if(0===(c&r)||0!==(c&a)){l=t,Tt(c);var g=Vt;i[u]=10<=g?l+250:6<=g?l+5e3:-1}}else l<=t&&(e.expiredLanes|=c);s&=~c}if(r=Et(e,e===Rs?Os:0),t=Vt,0===r)null!==n&&(n!==Fa&&Ga(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Fa&&Ga(n)}15===t?(n=Iu.bind(null,e),null===Va?(Va=[n],Ta=wa(Za,_a)):Va.push(n),n=Fa):14===t?n=za(99,Iu.bind(null,e)):n=za(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(o(358,e))}}(t),fu.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function fu(e){if(au=-1,ou=iu=0,0!==(48&Zs))throw Error(o(327));var t=e.callbackNode;if(Ou()&&e.callbackNode!==t)return null;var n=Et(e,e===Rs?Os:0);if(0===n)return null;var r=n,a=Zs;Zs|=16;var i=wu();for(Rs===e&&Os===r||(zs(),Au(e,r));;)try{xu();break}catch(u){yu(e,u)}if($a(),Ss.current=i,Zs=a,null!==Ns?r=0:(Rs=null,Os=0,r=Ms),0!==(Ts&js))Au(e,0);else if(0!==r){if(2===r&&(Zs|=64,e.hydrate&&(e.hydrate=!1,zr(e.containerInfo)),0!==(n=jt(e))&&(r=Gu(e,n))),1===r)throw t=Vs,Au(e,0),pu(e,n),hu(e,La()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(o(345));case 2:Zu(e);break;case 3:if(pu(e,n),(62914560&n)===n&&10<(r=Hs+500-La())){if(0!==Et(e,0))break;if(((a=e.suspendedLanes)&n)!==n){cu(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Hr(Zu.bind(null,e),r);break}Zu(e);break;case 4:if(pu(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var s=31-zt(n);i=1<<s,(s=r[s])>a&&(a=s),n&=~i}if(n=a,10<(n=(120>(n=La()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xs(n/1960))-n)){e.timeoutHandle=Hr(Zu.bind(null,e),n);break}Zu(e);break;case 5:Zu(e);break;default:throw Error(o(329))}}return hu(e,La()),e.callbackNode===t?fu.bind(null,e):null}function pu(e,t){for(t&=~Ls,t&=~js,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zt(t),r=1<<n;e[n]=-1,t&=~r}}function Iu(e){if(0!==(48&Zs))throw Error(o(327));if(Ou(),e===Rs&&0!==(e.expiredLanes&Os)){var t=Os,n=Gu(e,t);0!==(Ts&js)&&(n=Gu(e,t=Et(e,t)))}else n=Gu(e,t=Et(e,0));if(0!==e.tag&&2===n&&(Zs|=64,e.hydrate&&(e.hydrate=!1,zr(e.containerInfo)),0!==(t=jt(e))&&(n=Gu(e,t))),1===n)throw n=Vs,Au(e,0),pu(e,t),hu(e,La()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zu(e),hu(e,La()),null}function Cu(e,t){var n=Zs;Zs|=1;try{return e(t)}finally{0===(Zs=n)&&(zs(),Ka())}}function mu(e,t){var n=Zs;Zs&=-2,Zs|=8;try{return e(t)}finally{0===(Zs=n)&&(zs(),Ka())}}function bu(e,t){ua(Fs,Ws),Ws|=t,Ts|=t}function vu(){Ws=Fs.current,sa(Fs)}function Au(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Yr(n)),null!==Ns)for(n=Ns.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&pa();break;case 3:Ni(),sa(ga),sa(la),_i();break;case 5:Wi(r);break;case 4:Ni();break;case 13:case 19:sa(Fi);break;case 10:ei(r);break;case 23:case 24:vu()}n=n.return}Rs=e,Ns=Yu(e.current,null),Os=Ws=Ts=t,Ms=0,Vs=null,Ls=js=Es=0}function yu(e,t){for(;;){var n=Ns;try{if($a(),Di.current=Zo,$i){for(var r=Ji.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}$i=!1}if(Ui=0,qi=Qi=Ji=null,eo=!1,ks.current=null,null===n||null===n.return){Ms=1,Vs=t,Ns=null;break}e:{var i=e,o=n.return,s=n,u=t;if(t=Os,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.lanes=l.lanes):(s.updateQueue=null,s.memoizedState=null)}var g=0!==(1&Fi.current),d=o;do{var h;if(h=13===d.tag){var f=d.memoizedState;if(null!==f)h=null!==f.dehydrated;else{var p=d.memoizedProps;h=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!g)}}if(h){var I=d.updateQueue;if(null===I){var C=new Set;C.add(c),d.updateQueue=C}else I.add(c);if(0===(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var m=si(-1,1);m.tag=2,ui(s,m)}s.lanes|=1;break e}u=void 0,s=t;var b=i.pingCache;if(null===b?(b=i.pingCache=new us,u=new Set,b.set(c,u)):void 0===(u=b.get(c))&&(u=new Set,b.set(c,u)),!u.has(s)){u.add(s);var v=Eu.bind(null,i,c,s);c.then(v,v)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((D(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Ms&&(Ms=2),u=os(u,s),d=o;do{switch(d.tag){case 3:i=u,d.flags|=4096,t&=-t,d.lanes|=t,ci(d,cs(0,i,t));break e;case 1:i=u;var A=d.type,y=d.stateNode;if(0===(64&d.flags)&&("function"===typeof A.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Us||!Us.has(y)))){d.flags|=4096,t&=-t,d.lanes|=t,ci(d,ls(d,i,t));break e}}d=d.return}while(null!==d)}ku(n)}catch(w){t=w,Ns===n&&null!==n&&(Ns=n=n.return);continue}break}}function wu(){var e=Ss.current;return Ss.current=Zo,null===e?Zo:e}function Gu(e,t){var n=Zs;Zs|=16;var r=wu();for(Rs===e&&Os===t||Au(e,t);;)try{Bu();break}catch(a){yu(e,a)}if($a(),Zs=n,Ss.current=r,null!==Ns)throw Error(o(261));return Rs=null,Os=0,Ms}function Bu(){for(;null!==Ns;)Su(Ns)}function xu(){for(;null!==Ns&&!Ba();)Su(Ns)}function Su(e){var t=Ks(e.alternate,e,Ws);e.memoizedProps=e.pendingProps,null===t?ku(e):Ns=t,ks.current=null}function ku(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=as(n,t,Ws)))return void(Ns=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Ws)||0===(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=is(t)))return n.flags&=2047,void(Ns=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ns=t);Ns=t=e}while(null!==t);0===Ms&&(Ms=5)}function Zu(e){var t=Xa();return Ya(99,Ru.bind(null,e,t)),null}function Ru(e,t){do{Ou()}while(null!==Qs);if(0!==(48&Zs))throw Error(o(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,i=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var s=e.eventTimes,u=e.expirationTimes;0<i;){var c=31-zt(i),l=1<<c;a[c]=0,s[c]=-1,u[c]=-1,i&=~l}if(null!==tu&&0===(24&r)&&tu.has(e)&&tu.delete(e),e===Rs&&(Ns=Rs=null,Os=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(a=Zs,Zs|=32,ks.current=null,Er=Ut,fr(s=hr())){if("selectionStart"in s)u={start:s.selectionStart,end:s.selectionEnd};else e:if(u=(u=s.ownerDocument)&&u.defaultView||window,(l=u.getSelection&&u.getSelection())&&0!==l.rangeCount){u=l.anchorNode,i=l.anchorOffset,c=l.focusNode,l=l.focusOffset;try{u.nodeType,c.nodeType}catch(x){u=null;break e}var g=0,d=-1,h=-1,f=0,p=0,I=s,C=null;t:for(;;){for(var m;I!==u||0!==i&&3!==I.nodeType||(d=g+i),I!==c||0!==l&&3!==I.nodeType||(h=g+l),3===I.nodeType&&(g+=I.nodeValue.length),null!==(m=I.firstChild);)C=I,I=m;for(;;){if(I===s)break t;if(C===u&&++f===i&&(d=g),C===c&&++p===l&&(h=g),null!==(m=I.nextSibling))break;C=(I=C).parentNode}I=m}u=-1===d||-1===h?null:{start:d,end:h}}else u=null;u=u||{start:0,end:0}}else u=null;jr={focusedElem:s,selectionRange:u},Ut=!1,su=null,uu=!1,_s=r;do{try{Nu()}catch(x){if(null===_s)throw Error(o(330));Tu(_s,x),_s=_s.nextEffect}}while(null!==_s);su=null,_s=r;do{try{for(s=e;null!==_s;){var b=_s.flags;if(16&b&&me(_s.stateNode,""),128&b){var v=_s.alternate;if(null!==v){var A=v.ref;null!==A&&("function"===typeof A?A(null):A.current=null)}}switch(1038&b){case 2:bs(_s),_s.flags&=-3;break;case 6:bs(_s),_s.flags&=-3,ws(_s.alternate,_s);break;case 1024:_s.flags&=-1025;break;case 1028:_s.flags&=-1025,ws(_s.alternate,_s);break;case 4:ws(_s.alternate,_s);break;case 8:ys(s,u=_s);var y=u.alternate;Cs(u),null!==y&&Cs(y)}_s=_s.nextEffect}}catch(x){if(null===_s)throw Error(o(330));Tu(_s,x),_s=_s.nextEffect}}while(null!==_s);if(A=jr,v=hr(),b=A.focusedElem,s=A.selectionRange,v!==b&&b&&b.ownerDocument&&dr(b.ownerDocument.documentElement,b)){null!==s&&fr(b)&&(v=s.start,void 0===(A=s.end)&&(A=v),"selectionStart"in b?(b.selectionStart=v,b.selectionEnd=Math.min(A,b.value.length)):(A=(v=b.ownerDocument||document)&&v.defaultView||window).getSelection&&(A=A.getSelection(),u=b.textContent.length,y=Math.min(s.start,u),s=void 0===s.end?y:Math.min(s.end,u),!A.extend&&y>s&&(u=s,s=y,y=u),u=gr(b,y),i=gr(b,s),u&&i&&(1!==A.rangeCount||A.anchorNode!==u.node||A.anchorOffset!==u.offset||A.focusNode!==i.node||A.focusOffset!==i.offset)&&((v=v.createRange()).setStart(u.node,u.offset),A.removeAllRanges(),y>s?(A.addRange(v),A.extend(i.node,i.offset)):(v.setEnd(i.node,i.offset),A.addRange(v))))),v=[];for(A=b;A=A.parentNode;)1===A.nodeType&&v.push({element:A,left:A.scrollLeft,top:A.scrollTop});for("function"===typeof b.focus&&b.focus(),b=0;b<v.length;b++)(A=v[b]).element.scrollLeft=A.left,A.element.scrollTop=A.top}Ut=!!Er,jr=Er=null,e.current=n,_s=r;do{try{for(b=e;null!==_s;){var w=_s.flags;if(36&w&&fs(b,_s.alternate,_s),128&w){v=void 0;var G=_s.ref;if(null!==G){var B=_s.stateNode;switch(_s.tag){case 5:v=B;break;default:v=B}"function"===typeof G?G(v):G.current=v}}_s=_s.nextEffect}}catch(x){if(null===_s)throw Error(o(330));Tu(_s,x),_s=_s.nextEffect}}while(null!==_s);_s=null,Ma(),Zs=a}else e.current=n;if(Js)Js=!1,Qs=e,qs=t;else for(_s=r;null!==_s;)t=_s.nextEffect,_s.nextEffect=null,8&_s.flags&&((w=_s).sibling=null,w.stateNode=null),_s=t;if(0===(r=e.pendingLanes)&&(Us=null),1===r?e===ru?nu++:(nu=0,ru=e):nu=0,n=n.stateNode,Aa&&"function"===typeof Aa.onCommitFiberRoot)try{Aa.onCommitFiberRoot(va,n,void 0,64===(64&n.current.flags))}catch(x){}if(hu(e,La()),Ds)throw Ds=!1,e=Ps,Ps=null,e;return 0!==(8&Zs)||Ka(),null}function Nu(){for(;null!==_s;){var e=_s.alternate;uu||null===su||(0!==(8&_s.flags)?et(_s,su)&&(uu=!0):13===_s.tag&&Bs(e,_s)&&et(_s,su)&&(uu=!0));var t=_s.flags;0!==(256&t)&&hs(e,_s),0===(512&t)||Js||(Js=!0,za(97,(function(){return Ou(),null}))),_s=_s.nextEffect}}function Ou(){if(90!==qs){var e=97<qs?97:qs;return qs=90,Ya(e,Mu)}return!1}function Wu(e,t){$s.push(t,e),Js||(Js=!0,za(97,(function(){return Ou(),null})))}function Fu(e,t){eu.push(t,e),Js||(Js=!0,za(97,(function(){return Ou(),null})))}function Mu(){if(null===Qs)return!1;var e=Qs;if(Qs=null,0!==(48&Zs))throw Error(o(331));var t=Zs;Zs|=32;var n=eu;eu=[];for(var r=0;r<n.length;r+=2){var a=n[r],i=n[r+1],s=a.destroy;if(a.destroy=void 0,"function"===typeof s)try{s()}catch(c){if(null===i)throw Error(o(330));Tu(i,c)}}for(n=$s,$s=[],r=0;r<n.length;r+=2){a=n[r],i=n[r+1];try{var u=a.create;a.destroy=u()}catch(c){if(null===i)throw Error(o(330));Tu(i,c)}}for(u=e.current.firstEffect;null!==u;)e=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=e;return Zs=t,Ka(),!0}function Vu(e,t,n){ui(e,t=cs(0,t=os(n,t),1)),t=cu(),null!==(e=du(e,1))&&(Yt(e,1,t),hu(e,t))}function Tu(e,t){if(3===e.tag)Vu(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Vu(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Us||!Us.has(r))){var a=ls(n,e=os(t,e),1);if(ui(n,a),a=cu(),null!==(n=du(n,1)))Yt(n,1,a),hu(n,a);else if("function"===typeof r.componentDidCatch&&(null===Us||!Us.has(r)))try{r.componentDidCatch(t,e)}catch(i){}break}}n=n.return}}function Eu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=cu(),e.pingedLanes|=e.suspendedLanes&n,Rs===e&&(Os&n)===n&&(4===Ms||3===Ms&&(62914560&Os)===Os&&500>La()-Hs?Au(e,0):Ls|=n),hu(e,t)}function ju(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Xa()?1:2:(0===iu&&(iu=Ts),0===(t=Xt(62914560&~iu))&&(t=4194304))),n=cu(),null!==(e=du(e,t))&&(Yt(e,t,n),hu(e,n))}function Lu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Xu(e,t,n,r){return new Lu(e,t,n,r)}function Hu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Yu(e,t){var n=e.alternate;return null===n?((n=Xu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function zu(e,t,n,r,a,i){var s=2;if(r=e,"function"===typeof e)Hu(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case G:return Ku(n.children,a,i,t);case V:s=8,a|=16;break;case B:s=8,a|=1;break;case x:return(e=Xu(12,n,t,8|a)).elementType=x,e.type=x,e.lanes=i,e;case R:return(e=Xu(13,n,t,a)).type=R,e.elementType=R,e.lanes=i,e;case N:return(e=Xu(19,n,t,a)).elementType=N,e.lanes=i,e;case T:return _u(n,a,i,t);case E:return(e=Xu(24,n,t,a)).elementType=E,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case k:s=9;break e;case Z:s=11;break e;case O:s=14;break e;case W:s=16,r=null;break e;case F:s=22;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Xu(s,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function Ku(e,t,n,r){return(e=Xu(7,e,r,t)).lanes=n,e}function _u(e,t,n,r){return(e=Xu(23,e,r,t)).elementType=T,e.lanes=n,e}function Du(e,t,n){return(e=Xu(6,e,null,t)).lanes=n,e}function Pu(e,t,n){return(t=Xu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uu(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ht(0),this.expirationTimes=Ht(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ht(0),this.mutableSourceEagerHydrationData=null}function Ju(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Qu(e,t,n,r){var a=t.current,i=cu(),s=lu(a);e:if(n){t:{if(Je(n=n._reactInternals)!==n||1!==n.tag)throw Error(o(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(fa(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(o(171))}if(1===n.tag){var c=n.type;if(fa(c)){n=Ca(n,c,u);break e}}n=u}else n=ca;return null===t.context?t.context=n:t.pendingContext=n,(t=si(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ui(a,t),gu(a,s,i),s}function qu(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function $u(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ec(e,t){$u(e,t),(e=e.alternate)&&$u(e,t)}function tc(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Uu(e,t,null!=n&&!0===n.hydrate),t=Xu(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ii(t),e[Qr]=n.current,Zr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var a=(t=r[e])._getVersion;a=a(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a)}this._internalRoot=n}function nc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function rc(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i._internalRoot;if("function"===typeof a){var s=a;a=function(){var e=qu(o);s.call(e)}}Qu(t,o,e,a)}else{if(i=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new tc(e,0,t?{hydrate:!0}:void 0)}(n,r),o=i._internalRoot,"function"===typeof a){var u=a;a=function(){var e=qu(o);u.call(e)}}mu((function(){Qu(t,o,e,a)}))}return qu(o)}function ac(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nc(t))throw Error(o(200));return Ju(e,t,null,n)}Ks=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||ga.current)Fo=!0;else{if(0===(n&r)){switch(Fo=!1,t.tag){case 3:zo(t),zi();break;case 5:Oi(t);break;case 1:fa(t.type)&&ma(t);break;case 4:Ri(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var a=t.type._context;ua(Ua,a._currentValue),a._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Uo(e,t,n):(ua(Fi,1&Fi.current),null!==(t=ns(e,t,n))?t.sibling:null);ua(Fi,1&Fi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return ts(e,t,n);t.flags|=64}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),ua(Fi,Fi.current),r)break;return null;case 23:case 24:return t.lanes=0,jo(e,t,n)}return ns(e,t,n)}Fo=0!==(16384&e.flags)}else Fo=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=ha(t,la.current),ni(t,n),a=ro(null,t,r,e,a,n),t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,fa(r)){var i=!0;ma(t)}else i=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,ii(t);var s=r.getDerivedStateFromProps;"function"===typeof s&&hi(t,r,s,e),a.updater=fi,t.stateNode=a,a._reactInternals=t,mi(t,r,e,n),t=Yo(null,t,r,!0,i,n)}else t.tag=0,Mo(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(i=a._init)(a._payload),t.type=a,i=t.tag=function(e){if("function"===typeof e)return Hu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===Z)return 11;if(e===O)return 14}return 2}(a),e=Pa(a,e),i){case 0:t=Xo(null,t,a,e,n);break e;case 1:t=Ho(null,t,a,e,n);break e;case 11:t=Vo(null,t,a,e,n);break e;case 14:t=To(null,t,a,Pa(a.type,e),r,n);break e}throw Error(o(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,Xo(e,t,r,a=t.elementType===r?a:Pa(r,a),n);case 1:return r=t.type,a=t.pendingProps,Ho(e,t,r,a=t.elementType===r?a:Pa(r,a),n);case 3:if(zo(t),r=t.updateQueue,null===e||null===r)throw Error(o(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,oi(e,t),li(t,r,null,n),(r=t.memoizedState.element)===a)zi(),t=ns(e,t,n);else{if((i=(a=t.stateNode).hydrate)&&(Ti=Kr(t.stateNode.containerInfo.firstChild),Vi=t,i=Ei=!0),i){if(null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)(i=e[a])._workInProgressVersionPrimary=e[a+1],Ki.push(i);for(n=Gi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Mo(e,t,r,n),zi();t=t.child}return t;case 5:return Oi(t),null===e&&Xi(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,s=a.children,Xr(r,a)?s=null:null!==i&&Xr(r,i)&&(t.flags|=16),Lo(e,t),Mo(e,t,s,n),t.child;case 6:return null===e&&Xi(t),null;case 13:return Uo(e,t,n);case 4:return Ri(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wi(t,null,r,n):Mo(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Vo(e,t,r,a=t.elementType===r?a:Pa(r,a),n);case 7:return Mo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Mo(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value;var u=t.type._context;if(ua(Ua,u._currentValue),u._currentValue=i,null!==s)if(u=s.value,0===(i=sr(u,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,i):1073741823))){if(s.children===a.children&&!ga.current){t=ns(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var c=u.dependencies;if(null!==c){s=u.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&i)){1===u.tag&&((l=si(-1,n&-n)).tag=2,ui(u,l)),u.lanes|=n,null!==(l=u.alternate)&&(l.lanes|=n),ti(u.return,n),c.lanes|=n;break}l=l.next}}else s=10===u.tag&&u.type===t.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===t){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}Mo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(i=t.pendingProps).children,ni(t,n),r=r(a=ri(a,i.unstable_observedBits)),t.flags|=1,Mo(e,t,r,n),t.child;case 14:return i=Pa(a=t.type,t.pendingProps),To(e,t,a,i=Pa(a.type,i),r,n);case 15:return Eo(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:Pa(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,fa(r)?(e=!0,ma(t)):e=!1,ni(t,n),Ii(t,r,a),mi(t,r,a,n),Yo(null,t,r,!0,e,n);case 19:return ts(e,t,n);case 23:case 24:return jo(e,t,n)}throw Error(o(156,t.tag))},tc.prototype.render=function(e){Qu(e,this._internalRoot,null,null)},tc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Qu(null,e,null,(function(){t[Qr]=null}))},tt=function(e){13===e.tag&&(gu(e,4,cu()),ec(e,4))},nt=function(e){13===e.tag&&(gu(e,67108864,cu()),ec(e,67108864))},rt=function(e){if(13===e.tag){var t=cu(),n=lu(e);gu(e,n,t),ec(e,n)}},at=function(e,t){return t()},Se=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=na(r);if(!a)throw Error(o(90));Q(r),ne(r,a)}}}break;case"textarea":ce(e,n);break;case"select":null!=(t=n.value)&&oe(e,!!n.multiple,t,!1)}},We=Cu,Fe=function(e,t,n,r,a){var i=Zs;Zs|=4;try{return Ya(98,e.bind(null,t,n,r,a))}finally{0===(Zs=i)&&(zs(),Ka())}},Me=function(){0===(49&Zs)&&(function(){if(null!==tu){var e=tu;tu=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,hu(e,La())}))}Ka()}(),Ou())},Ve=function(e,t){var n=Zs;Zs|=2;try{return e(t)}finally{0===(Zs=n)&&(zs(),Ka())}};var ic={Events:[ea,ta,na,Ne,Oe,Ou,{current:!1}]},oc={findFiberByHostInstance:$r,bundleType:0,version:"17.0.1",rendererPackageName:"react-dom"},sc={bundleType:oc.bundleType,version:oc.version,rendererPackageName:oc.rendererPackageName,rendererConfig:oc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:A.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=$e(e))?null:e.stateNode},findFiberByHostInstance:oc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var uc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!uc.isDisabled&&uc.supportsFiber)try{va=uc.inject(sc),Aa=uc}catch(Ie){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ic,t.createPortal=ac,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw Error(o(268,Object.keys(e)))}return e=null===(e=$e(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Zs;if(0!==(48&n))return e(t);Zs|=1;try{if(e)return Ya(99,e.bind(null,t))}finally{Zs=n,Ka()}},t.hydrate=function(e,t,n){if(!nc(t))throw Error(o(200));return rc(null,e,t,!0,n)},t.render=function(e,t,n){if(!nc(t))throw Error(o(200));return rc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!nc(e))throw Error(o(40));return!!e._reactRootContainer&&(mu((function(){rc(null,null,e,!1,(function(){e._reactRootContainer=null,e[Qr]=null}))})),!0)},t.unstable_batchedUpdates=Cu,t.unstable_createPortal=function(e,t){return ac(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!nc(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return rc(e,t,n,!1,r)},t.version="17.0.1"},function(e,t,n){"use strict";e.exports=n(411)},function(e,t,n){"use strict";var r,a,i,o;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();t.unstable_now=function(){return u.now()-c}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,g=null,d=function e(){if(null!==l)try{var n=t.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(e,0),r}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(d,0))},a=function(e,t){g=setTimeout(e,t)},i=function(){clearTimeout(g)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,f=window.clearTimeout;if("undefined"!==typeof console){var p=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var I=!1,C=null,m=-1,b=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var A=new MessageChannel,y=A.port2;A.port1.onmessage=function(){if(null!==C){var e=t.unstable_now();v=e+b;try{C(!0,e)?y.postMessage(null):(I=!1,C=null)}catch(n){throw y.postMessage(null),n}}else I=!1},r=function(e){C=e,I||(I=!0,y.postMessage(null))},a=function(e,n){m=h((function(){e(t.unstable_now())}),n)},i=function(){f(m),m=-1}}function w(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<x(a,t)))break e;e[r]=t,e[n]=a,n=r}}function G(e){return void 0===(e=e[0])?null:e}function B(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var i=2*(r+1)-1,o=e[i],s=i+1,u=e[s];if(void 0!==o&&0>x(o,n))void 0!==u&&0>x(u,o)?(e[r]=u,e[s]=n,r=s):(e[r]=o,e[i]=n,r=i);else{if(!(void 0!==u&&0>x(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function x(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var S=[],k=[],Z=1,R=null,N=3,O=!1,W=!1,F=!1;function M(e){for(var t=G(k);null!==t;){if(null===t.callback)B(k);else{if(!(t.startTime<=e))break;B(k),t.sortIndex=t.expirationTime,w(S,t)}t=G(k)}}function V(e){if(F=!1,M(e),!W)if(null!==G(S))W=!0,r(T);else{var t=G(k);null!==t&&a(V,t.startTime-e)}}function T(e,n){W=!1,F&&(F=!1,i()),O=!0;var r=N;try{for(M(n),R=G(S);null!==R&&(!(R.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=R.callback;if("function"===typeof o){R.callback=null,N=R.priorityLevel;var s=o(R.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?R.callback=s:R===G(S)&&B(S),M(n)}else B(S);R=G(S)}if(null!==R)var u=!0;else{var c=G(k);null!==c&&a(V,c.startTime-n),u=!1}return u}finally{R=null,N=r,O=!1}}var E=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){W||O||(W=!0,r(T))},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return G(S)},t.unstable_next=function(e){switch(N){case 1:case 2:case 3:var t=3;break;default:t=N}var n=N;N=t;try{return e()}finally{N=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=E,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=N;N=e;try{return t()}finally{N=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:Z++,callback:n,priorityLevel:e,startTime:o,expirationTime:u=o+u,sortIndex:-1},o>s?(e.sortIndex=o,w(k,e),null===G(S)&&e===G(k)&&(F?i():F=!0,a(V,o-s))):(e.sortIndex=u,w(S,e),W||O||(W=!0,r(T))),e},t.unstable_wrapCallback=function(e){var t=N;return function(){var n=N;N=t;try{return e.apply(this,arguments)}finally{N=n}}}},,function(e,t,n){"use strict";var r=n(414);function a(){}function i(){}i.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";var r="function"===typeof Symbol&&Symbol.for,a=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,o=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,u=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,g=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.suspense_list"):60120,I=r?Symbol.for("react.memo"):60115,C=r?Symbol.for("react.lazy"):60116,m=r?Symbol.for("react.block"):60121,b=r?Symbol.for("react.fundamental"):60117,v=r?Symbol.for("react.responder"):60118,A=r?Symbol.for("react.scope"):60119;function y(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case g:case d:case o:case u:case s:case f:return e;default:switch(e=e&&e.$$typeof){case l:case h:case C:case I:case c:return e;default:return t}}case i:return t}}}function w(e){return y(e)===d}t.AsyncMode=g,t.ConcurrentMode=d,t.ContextConsumer=l,t.ContextProvider=c,t.Element=a,t.ForwardRef=h,t.Fragment=o,t.Lazy=C,t.Memo=I,t.Portal=i,t.Profiler=u,t.StrictMode=s,t.Suspense=f,t.isAsyncMode=function(e){return w(e)||y(e)===g},t.isConcurrentMode=w,t.isContextConsumer=function(e){return y(e)===l},t.isContextProvider=function(e){return y(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return y(e)===h},t.isFragment=function(e){return y(e)===o},t.isLazy=function(e){return y(e)===C},t.isMemo=function(e){return y(e)===I},t.isPortal=function(e){return y(e)===i},t.isProfiler=function(e){return y(e)===u},t.isStrictMode=function(e){return y(e)===s},t.isSuspense=function(e){return y(e)===f},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===d||e===u||e===s||e===f||e===p||"object"===typeof e&&null!==e&&(e.$$typeof===C||e.$$typeof===I||e.$$typeof===c||e.$$typeof===l||e.$$typeof===h||e.$$typeof===b||e.$$typeof===v||e.$$typeof===A||e.$$typeof===m)},t.typeOf=y},function(e,t,n){"use strict";n(213);var r=n(2),a=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var i=Symbol.for;a=i("react.element"),t.Fragment=i("react.fragment")}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:o.current}}t.jsx=c,t.jsxs=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(2),a=n(276),i=n(399),o=[{key:"youtube",name:"YouTube",canPlay:i.canPlay.youtube,lazyPlayer:(0,r.lazy)((function(){return n.e(13).then(n.t.bind(null,466,7))}))},{key:"soundcloud",name:"SoundCloud",canPlay:i.canPlay.soundcloud,lazyPlayer:(0,r.lazy)((function(){return n.e(7).then(n.t.bind(null,467,7))}))},{key:"vimeo",name:"Vimeo",canPlay:i.canPlay.vimeo,lazyPlayer:(0,r.lazy)((function(){return n.e(11).then(n.t.bind(null,468,7))}))},{key:"facebook",name:"Facebook",canPlay:i.canPlay.facebook,lazyPlayer:(0,r.lazy)((function(){return n.e(2).then(n.t.bind(null,469,7))}))},{key:"streamable",name:"Streamable",canPlay:i.canPlay.streamable,lazyPlayer:(0,r.lazy)((function(){return n.e(8).then(n.t.bind(null,470,7))}))},{key:"wistia",name:"Wistia",canPlay:i.canPlay.wistia,lazyPlayer:(0,r.lazy)((function(){return n.e(12).then(n.t.bind(null,471,7))}))},{key:"twitch",name:"Twitch",canPlay:i.canPlay.twitch,lazyPlayer:(0,r.lazy)((function(){return n.e(9).then(n.t.bind(null,472,7))}))},{key:"dailymotion",name:"DailyMotion",canPlay:i.canPlay.dailymotion,lazyPlayer:(0,r.lazy)((function(){return n.e(1).then(n.t.bind(null,473,7))}))},{key:"mixcloud",name:"Mixcloud",canPlay:i.canPlay.mixcloud,lazyPlayer:(0,r.lazy)((function(){return n.e(5).then(n.t.bind(null,474,7))}))},{key:"vidyard",name:"Vidyard",canPlay:i.canPlay.vidyard,lazyPlayer:(0,r.lazy)((function(){return n.e(10).then(n.t.bind(null,475,7))}))},{key:"kaltura",name:"Kaltura",canPlay:i.canPlay.kaltura,lazyPlayer:(0,r.lazy)((function(){return n.e(4).then(n.t.bind(null,476,7))}))},{key:"file",name:"FilePlayer",canPlay:i.canPlay.file,canEnablePIP:function(e){return i.canPlay.file(e)&&(document.pictureInPictureEnabled||(0,a.supportsWebKitPresentationMode)())&&!i.AUDIO_EXTENSIONS.test(e)},lazyPlayer:(0,r.lazy)((function(){return n.e(3).then(n.t.bind(null,477,7))}))}];t.default=o},function(e,t){function n(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function r(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,t,a){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("script");"function"===typeof t&&(a=t,t={}),t=t||{},a=a||function(){},o.type=t.type||"text/javascript",o.charset=t.charset||"utf8",o.async=!("async"in t)||!!t.async,o.src=e,t.attrs&&function(e,t){for(var n in t)e.setAttribute(n,t[n])}(o,t.attrs),t.text&&(o.text=""+t.text),("onload"in o?n:r)(o,a),o.onload||n(o,a),i.appendChild(o)}},function(e,t,n){"use strict";(function(e){function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.createReactPlayer=void 0;var a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}n.default=e,t&&t.set(e,n);return n}(n(2)),i=g(n(293)),o=g(n(294)),s=g(n(295)),u=n(296),c=n(276),l=g(n(420));function g(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){B(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function I(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=G(e);if(t){var a=G(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y(this,n)}}function y(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=(0,a.lazy)((function(){return n.e(6).then(n.t.bind(null,478,7))})),S="undefined"!==typeof window&&window.document,k="undefined"!==typeof e&&e.window&&e.window.document,Z=Object.keys(u.propTypes),R=S||k?a.Suspense:function(){return null},N=[];t.createReactPlayer=function(e,t){var n,r;return r=n=function(n){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(C,n);var r,g,d,h=A(C);function C(){var n;m(this,C);for(var r=arguments.length,s=new Array(r),g=0;g<r;g++)s[g]=arguments[g];return B(w(n=h.call.apply(h,[this].concat(s))),"state",{showPreview:!!n.props.light}),B(w(n),"references",{wrapper:function(e){n.wrapper=e},player:function(e){n.player=e}}),B(w(n),"handleClickPreview",(function(e){n.setState({showPreview:!1}),n.props.onClickPreview(e)})),B(w(n),"showPreview",(function(){n.setState({showPreview:!0})})),B(w(n),"getDuration",(function(){return n.player?n.player.getDuration():null})),B(w(n),"getCurrentTime",(function(){return n.player?n.player.getCurrentTime():null})),B(w(n),"getSecondsLoaded",(function(){return n.player?n.player.getSecondsLoaded():null})),B(w(n),"getInternalPlayer",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"player";return n.player?n.player.getInternalPlayer(e):null})),B(w(n),"seekTo",(function(e,t){if(!n.player)return null;n.player.seekTo(e,t)})),B(w(n),"handleReady",(function(){n.props.onReady(w(n))})),B(w(n),"getActivePlayer",(0,o.default)((function(n){for(var r=0,a=[].concat(N,I(e));r<a.length;r++){var i=a[r];if(i.canPlay(n))return i}return t||null}))),B(w(n),"getConfig",(0,o.default)((function(e,t){var r=n.props.config;return i.default.all([u.defaultProps.config,u.defaultProps.config[t]||{},r,r[t]||{}])}))),B(w(n),"getAttributes",(0,o.default)((function(e){return(0,c.omit)(n.props,Z)}))),B(w(n),"renderActivePlayer",(function(e){if(!e)return null;var t=n.getActivePlayer(e);if(!t)return null;var r=n.getConfig(e,t.key);return a.default.createElement(l.default,p({},n.props,{key:t.key,ref:n.references.player,config:r,activePlayer:t.lazyPlayer||t,onReady:n.handleReady}))})),n}return r=C,(g=[{key:"shouldComponentUpdate",value:function(e,t){return!(0,s.default)(this.props,e)||!(0,s.default)(this.state,t)}},{key:"componentDidUpdate",value:function(e){var t=this.props.light;!e.light&&t&&this.setState({showPreview:!0}),e.light&&!t&&this.setState({showPreview:!1})}},{key:"renderPreview",value:function(e){if(!e)return null;var t=this.props,n=t.light,r=t.playIcon,i=t.previewTabIndex;return a.default.createElement(x,{url:e,light:n,playIcon:r,previewTabIndex:i,onClick:this.handleClickPreview})}},{key:"render",value:function(){var e=this.props,t=e.url,n=e.style,r=e.width,i=e.height,o=e.fallback,s=e.wrapper,u=this.state.showPreview,c=this.getAttributes(t);return a.default.createElement(s,p({ref:this.references.wrapper,style:f(f({},n),{},{width:r,height:i})},c),a.default.createElement(R,{fallback:o},u?this.renderPreview(t):this.renderActivePlayer(t)))}}])&&b(r.prototype,g),d&&b(r,d),C}(a.Component),B(n,"displayName","ReactPlayer"),B(n,"propTypes",u.propTypes),B(n,"defaultProps",u.defaultProps),B(n,"addCustomPlayer",(function(e){N.push(e)})),B(n,"removeCustomPlayers",(function(){N.length=0})),B(n,"canPlay",(function(t){for(var n=0,r=[].concat(N,I(e));n<r.length;n++){if(r[n].canPlay(t))return!0}return!1})),B(n,"canEnablePIP",(function(t){for(var n=0,r=[].concat(N,I(e));n<r.length;n++){var a=r[n];if(a.canEnablePIP&&a.canEnablePIP(t))return!0}return!1})),r}}).call(this,n(148))},function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}n.default=e,t&&t.set(e,n);return n}(n(2)),o=(a=n(295))&&a.__esModule?a:{default:a},s=n(296);function u(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var a=I(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?p(e):t}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(s,e);var t,n,r,a=h(s);function s(){var e;l(this,s);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return C(p(e=a.call.apply(a,[this].concat(n))),"mounted",!1),C(p(e),"isReady",!1),C(p(e),"isPlaying",!1),C(p(e),"isLoading",!0),C(p(e),"loadOnReady",null),C(p(e),"startOnPlay",!0),C(p(e),"seekOnPlay",null),C(p(e),"onDurationCalled",!1),C(p(e),"handlePlayerMount",(function(t){e.player=t,e.player.load(e.props.url),e.progress()})),C(p(e),"getInternalPlayer",(function(t){return e.player?e.player[t]:null})),C(p(e),"progress",(function(){if(e.props.url&&e.player&&e.isReady){var t=e.getCurrentTime()||0,n=e.getSecondsLoaded(),r=e.getDuration();if(r){var a={playedSeconds:t,played:t/r};null!==n&&(a.loadedSeconds=n,a.loaded=n/r),a.playedSeconds===e.prevPlayed&&a.loadedSeconds===e.prevLoaded||e.props.onProgress(a),e.prevPlayed=a.playedSeconds,e.prevLoaded=a.loadedSeconds}}e.progressTimeout=setTimeout(e.progress,e.props.progressFrequency||e.props.progressInterval)})),C(p(e),"handleReady",(function(){if(e.mounted){e.isReady=!0,e.isLoading=!1;var t=e.props,n=t.onReady,r=t.playing,a=t.volume,i=t.muted;n(),i||null===a||e.player.setVolume(a),e.loadOnReady?(e.player.load(e.loadOnReady,!0),e.loadOnReady=null):r&&e.player.play(),e.handleDurationCheck()}})),C(p(e),"handlePlay",(function(){e.isPlaying=!0,e.isLoading=!1;var t=e.props,n=t.onStart,r=t.onPlay,a=t.playbackRate;e.startOnPlay&&(e.player.setPlaybackRate&&1!==a&&e.player.setPlaybackRate(a),n(),e.startOnPlay=!1),r(),e.seekOnPlay&&(e.seekTo(e.seekOnPlay),e.seekOnPlay=null),e.handleDurationCheck()})),C(p(e),"handlePause",(function(t){e.isPlaying=!1,e.isLoading||e.props.onPause(t)})),C(p(e),"handleEnded",(function(){var t=e.props,n=t.activePlayer,r=t.loop,a=t.onEnded;n.loopOnEnded&&r&&e.seekTo(0),r||(e.isPlaying=!1,a())})),C(p(e),"handleError",(function(){var t;e.isLoading=!1,(t=e.props).onError.apply(t,arguments)})),C(p(e),"handleDurationCheck",(function(){clearTimeout(e.durationCheckTimeout);var t=e.getDuration();t?e.onDurationCalled||(e.props.onDuration(t),e.onDurationCalled=!0):e.durationCheckTimeout=setTimeout(e.handleDurationCheck,100)})),C(p(e),"handleLoaded",(function(){e.isLoading=!1})),e}return t=s,(n=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){clearTimeout(this.progressTimeout),clearTimeout(this.durationCheckTimeout),this.isReady&&this.props.stopOnUnmount&&(this.player.stop(),this.player.disablePIP&&this.player.disablePIP()),this.mounted=!1}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.player){var n=this.props,r=n.url,a=n.playing,i=n.volume,s=n.muted,u=n.playbackRate,c=n.pip,l=n.loop,g=n.activePlayer;if(!(0,o.default)(e.url,r)){if(this.isLoading&&!g.forceLoad)return console.warn("ReactPlayer: the attempt to load ".concat(r," is being deferred until the player has loaded")),void(this.loadOnReady=r);this.isLoading=!0,this.startOnPlay=!0,this.onDurationCalled=!1,this.player.load(r,this.isReady)}e.playing||!a||this.isPlaying||this.player.play(),e.playing&&!a&&this.isPlaying&&this.player.pause(),!e.pip&&c&&this.player.enablePIP&&this.player.enablePIP(),e.pip&&!c&&this.player.disablePIP&&this.player.disablePIP(),e.volume!==i&&null!==i&&this.player.setVolume(i),e.muted!==s&&(s?this.player.mute():(this.player.unmute(),null!==i&&setTimeout((function(){return t.player.setVolume(i)})))),e.playbackRate!==u&&this.player.setPlaybackRate&&this.player.setPlaybackRate(u),e.loop!==l&&this.player.setLoop&&this.player.setLoop(l)}}},{key:"getDuration",value:function(){return this.isReady?this.player.getDuration():null}},{key:"getCurrentTime",value:function(){return this.isReady?this.player.getCurrentTime():null}},{key:"getSecondsLoaded",value:function(){return this.isReady?this.player.getSecondsLoaded():null}},{key:"seekTo",value:function(e,t){var n=this;if(!this.isReady&&0!==e)return this.seekOnPlay=e,void setTimeout((function(){n.seekOnPlay=null}),5e3);if(t?"fraction"===t:e>0&&e<1){var r=this.player.getDuration();return r?void this.player.seekTo(r*e):void console.warn("ReactPlayer: could not seek using fraction \u2013\xa0duration not yet available")}this.player.seekTo(e)}},{key:"render",value:function(){var e=this.props.activePlayer;return e?i.default.createElement(e,c({},this.props,{onMount:this.handlePlayerMount,onReady:this.handleReady,onPlay:this.handlePlay,onPause:this.handlePause,onEnded:this.handleEnded,onLoaded:this.handleLoaded,onError:this.handleError})):null}}])&&g(t.prototype,n),r&&g(t,r),s}(i.Component);t.default=m,C(m,"displayName","Player"),C(m,"propTypes",s.propTypes),C(m,"defaultProps",s.defaultProps)},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(N){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof I?t:I,i=Object.create(a.prototype),o=new k(r||[]);return i._invoke=function(e,t,n){var r=g;return function(a,i){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===a)throw i;return R()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=B(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===g)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?f:d,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(e,n,o),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=c;var g="suspendedStart",d="suspendedYield",h="executing",f="completed",p={};function I(){}function C(){}function m(){}var b={};b[i]=function(){return this};var v=Object.getPrototypeOf,A=v&&v(v(Z([])));A&&A!==n&&r.call(A,i)&&(b=A);var y=m.prototype=I.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function G(e,t){function n(a,i,o,s){var u=l(e[a],e,i);if("throw"!==u.type){var c=u.arg,g=c.value;return g&&"object"===typeof g&&r.call(g,"__await")?t.resolve(g.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(g).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}}function B(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,B(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var a=l(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,p;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function Z(e){if(e){var n=e[i];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:R}}function R(){return{value:t,done:!0}}return C.prototype=y.constructor=m,m.constructor=C,C.displayName=u(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===C||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},w(G.prototype),G.prototype[o]=function(){return this},e.AsyncIterator=G,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new G(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(y),u(y,s,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=Z,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return s.type="throw",s.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:Z(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=r}catch(a){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){(function(e){e.exports=function(t){var r={},a=n(213),i=n(2),o=n(423);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=60103,l=60106,g=60107,d=60108,h=60114,f=60109,p=60110,I=60112,C=60113,m=60120,b=60115,v=60116,A=60121,y=60129,w=60130,G=60131;if("function"===typeof Symbol&&Symbol.for){var B=Symbol.for;c=B("react.element"),l=B("react.portal"),g=B("react.fragment"),d=B("react.strict_mode"),h=B("react.profiler"),f=B("react.provider"),p=B("react.context"),I=B("react.forward_ref"),C=B("react.suspense"),m=B("react.suspense_list"),b=B("react.memo"),v=B("react.lazy"),A=B("react.block"),B("react.scope"),y=B("react.debug_trace_mode"),w=B("react.offscreen"),G=B("react.legacy_hidden")}var x="function"===typeof Symbol&&Symbol.iterator;function S(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=x&&e[x]||e["@@iterator"])?e:null}function k(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case g:return"Fragment";case l:return"Portal";case h:return"Profiler";case d:return"StrictMode";case C:return"Suspense";case m:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case p:return(e.displayName||"Context")+".Consumer";case f:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case b:return k(e.type);case A:return k(e._render);case v:t=e._payload,e=e._init;try{return k(e(t))}catch(n){}}return null}function Z(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function R(e){if(Z(e)!==e)throw Error(s(188))}function N(e){var t=e.alternate;if(!t){if(null===(t=Z(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return R(a),e;if(i===r)return R(a),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,u=a.child;u;){if(u===n){o=!0,n=a,r=i;break}if(u===r){o=!0,r=a,n=i;break}u=u.sibling}if(!o){for(u=i.child;u;){if(u===n){o=!0,n=i,r=a;break}if(u===r){o=!0,r=i,n=a;break}u=u.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}function O(e){if(!(e=N(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function W(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var F,M=t.getPublicInstance,V=t.getRootHostContext,T=t.getChildHostContext,E=t.prepareForCommit,j=t.resetAfterCommit,L=t.createInstance,X=t.appendInitialChild,H=t.finalizeInitialChildren,Y=t.prepareUpdate,z=t.shouldSetTextContent,K=t.createTextInstance,_=t.scheduleTimeout,D=t.cancelTimeout,P=t.noTimeout,U=t.isPrimaryRenderer,J=t.supportsMutation,Q=t.supportsPersistence,q=t.supportsHydration,$=t.getInstanceFromNode,ee=t.makeOpaqueHydratingObject,te=t.makeClientId,ne=t.beforeActiveInstanceBlur,re=t.afterActiveInstanceBlur,ae=t.preparePortalMount,ie=t.supportsTestSelectors,oe=t.findFiberRoot,se=t.getBoundingRect,ue=t.getTextContent,ce=t.isHiddenSubtree,le=t.matchAccessibilityRole,ge=t.setFocusIfFocusable,de=t.setupIntersectionObserver,he=t.appendChild,fe=t.appendChildToContainer,pe=t.commitTextUpdate,Ie=t.commitMount,Ce=t.commitUpdate,me=t.insertBefore,be=t.insertInContainerBefore,ve=t.removeChild,Ae=t.removeChildFromContainer,ye=t.resetTextContent,we=t.hideInstance,Ge=t.hideTextInstance,Be=t.unhideInstance,xe=t.unhideTextInstance,Se=t.clearContainer,ke=t.cloneInstance,Ze=t.createContainerChildSet,Re=t.appendChildToContainerChildSet,Ne=t.finalizeContainerChildren,Oe=t.replaceContainerChildren,We=t.cloneHiddenInstance,Fe=t.cloneHiddenTextInstance,Me=t.canHydrateInstance,Ve=t.canHydrateTextInstance,Te=t.isSuspenseInstancePending,Ee=t.isSuspenseInstanceFallback,je=t.getNextHydratableSibling,Le=t.getFirstHydratableChild,Xe=t.hydrateInstance,He=t.hydrateTextInstance,Ye=t.getNextHydratableInstanceAfterSuspenseInstance,ze=t.commitHydratedContainer,Ke=t.commitHydratedSuspenseInstance;function _e(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var De=!1;function Pe(e,t){if(!e||De)return"";De=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var a=u.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s])return"\n"+a[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{De=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_e(e):""}var Ue=[],Je=-1;function Qe(e){return{current:e}}function qe(e){0>Je||(e.current=Ue[Je],Ue[Je]=null,Je--)}function $e(e,t){Je++,Ue[Je]=e.current,e.current=t}var et={},tt=Qe(et),nt=Qe(!1),rt=et;function at(e,t){var n=e.type.contextTypes;if(!n)return et;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function it(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ot(){qe(nt),qe(tt)}function st(e,t,n){if(tt.current!==et)throw Error(s(168));$e(tt,t),$e(nt,n)}function ut(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(s(108,k(t)||"Unknown",i));return a({},n,r)}function ct(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||et,rt=tt.current,$e(tt,e),$e(nt,nt.current),!0}function lt(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=ut(e,t,rt),r.__reactInternalMemoizedMergedChildContext=e,qe(nt),qe(tt),$e(tt,e)):qe(nt),$e(nt,n)}var gt=null,dt=null;(0,o.unstable_now)();var ht=0,ft=8;function pt(e){if(0!==(1&e))return ft=15,1;if(0!==(2&e))return ft=14,2;if(0!==(4&e))return ft=13,4;var t=24&e;return 0!==t?(ft=12,t):0!==(32&e)?(ft=11,32):0!==(t=192&e)?(ft=10,t):0!==(256&e)?(ft=9,256):0!==(t=3584&e)?(ft=8,t):0!==(4096&e)?(ft=7,4096):0!==(t=4186112&e)?(ft=6,t):0!==(t=62914560&e)?(ft=5,t):67108864&e?(ft=4,67108864):0!==(134217728&e)?(ft=3,134217728):0!==(t=805306368&e)?(ft=2,t):0!==(1073741824&e)?(ft=1,1073741824):(ft=8,e)}function It(e,t){var n=e.pendingLanes;if(0===n)return ft=0;var r=0,a=0,i=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==i)r=i,a=ft=15;else if(0!==(i=134217727&n)){var u=i&~o;0!==u?(r=pt(u),a=ft):0!==(s&=i)&&(r=pt(s),a=ft)}else 0!==(i=n&~o)?(r=pt(i),a=ft):0!==s&&(r=pt(s),a=ft);if(0===r)return 0;if(r=n&((0>(r=31-yt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(pt(t),a<=ft)return t;ft=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-yt(t)),r|=e[n],t&=~a;return r}function Ct(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=bt(24&~t))?mt(10,t):e;case 10:return 0===(e=bt(192&~t))?mt(8,t):e;case 8:return 0===(e=bt(3584&~t))&&(0===(e=bt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=bt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function bt(e){return e&-e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function At(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-yt(t)]=n}var yt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(wt(e)/Gt|0)|0},wt=Math.log,Gt=Math.LN2;var Bt=o.unstable_runWithPriority,xt=o.unstable_scheduleCallback,St=o.unstable_cancelCallback,kt=o.unstable_shouldYield,Zt=o.unstable_requestPaint,Rt=o.unstable_now,Nt=o.unstable_getCurrentPriorityLevel,Ot=o.unstable_ImmediatePriority,Wt=o.unstable_UserBlockingPriority,Ft=o.unstable_NormalPriority,Mt=o.unstable_LowPriority,Vt=o.unstable_IdlePriority,Tt={},Et=void 0!==Zt?Zt:function(){},jt=null,Lt=null,Xt=!1,Ht=Rt(),Yt=1e4>Ht?Rt:function(){return Rt()-Ht};function zt(){switch(Nt()){case Ot:return 99;case Wt:return 98;case Ft:return 97;case Mt:return 96;case Vt:return 95;default:throw Error(s(332))}}function Kt(e){switch(e){case 99:return Ot;case 98:return Wt;case 97:return Ft;case 96:return Mt;case 95:return Vt;default:throw Error(s(332))}}function _t(e,t){return e=Kt(e),Bt(e,t)}function Dt(e,t,n){return e=Kt(e),xt(e,t,n)}function Pt(){if(null!==Lt){var e=Lt;Lt=null,St(e)}Ut()}function Ut(){if(!Xt&&null!==jt){Xt=!0;var e=0;try{var t=jt;_t(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),jt=null}catch(n){throw null!==jt&&(jt=jt.slice(e+1)),xt(Ot,Pt),n}finally{Xt=!1}}}var Jt=u.ReactCurrentBatchConfig;var Qt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},qt=Object.prototype.hasOwnProperty;function $t(e,t){if(Qt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!qt.call(t,n[r])||!Qt(e[n[r]],t[n[r]]))return!1;return!0}function en(e){switch(e.tag){case 5:return _e(e.type);case 16:return _e("Lazy");case 13:return _e("Suspense");case 19:return _e("SuspenseList");case 0:case 2:case 15:return e=Pe(e.type,!1);case 11:return e=Pe(e.type.render,!1);case 22:return e=Pe(e.type._render,!1);case 1:return e=Pe(e.type,!0);default:return""}}function tn(e,t){if(e&&e.defaultProps){for(var n in t=a({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var nn=Qe(null),rn=null,an=null,on=null;function sn(){on=an=rn=null}function un(e,t){e=e.type._context,U?($e(nn,e._currentValue),e._currentValue=t):($e(nn,e._currentValue2),e._currentValue2=t)}function cn(e){var t=nn.current;qe(nn),e=e.type._context,U?e._currentValue=t:e._currentValue2=t}function ln(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function gn(e,t){rn=e,on=an=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Hr=!0),e.firstContext=null)}function dn(e,t){if(on!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(on=e,t=1073741823),t={context:e,observedBits:t,next:null},null===an){if(null===rn)throw Error(s(308));an=t,rn.dependencies={lanes:0,firstContext:t,responders:null}}else an=an.next=t;return U?e._currentValue:e._currentValue2}var hn=!1;function fn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function pn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function In(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cn(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function mn(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function bn(e,t,n,r){var i=e.updateQueue;hn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var c=u,l=c.next;c.next=null,null===s?o=l:s.next=l,s=c;var g=e.alternate;if(null!==g){var d=(g=g.updateQueue).lastBaseUpdate;d!==s&&(null===d?g.firstBaseUpdate=l:d.next=l,g.lastBaseUpdate=c)}}if(null!==o){for(d=i.baseState,s=0,g=l=c=null;;){u=o.lane;var h=o.eventTime;if((r&u)===u){null!==g&&(g=g.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,p=o;switch(u=t,h=n,p.tag){case 1:if("function"===typeof(f=p.payload)){d=f.call(h,d,u);break e}d=f;break e;case 3:f.flags=-4097&f.flags|64;case 0:if(null===(u="function"===typeof(f=p.payload)?f.call(h,d,u):f)||void 0===u)break e;d=a({},d,u);break e;case 2:hn=!0}}null!==o.callback&&(e.flags|=32,null===(u=i.effects)?i.effects=[o]:u.push(o))}else h={eventTime:h,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===g?(l=g=h,c=d):g=g.next=h,s|=u;if(null===(o=o.next)){if(null===(u=i.shared.pending))break;o=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}null===g&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=g,gi|=s,e.lanes=s,e.memoizedState=d}}function vn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(s(191,a));a.call(r)}}}var An=(new i.Component).refs;function yn(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var wn={isMounted:function(e){return!!(e=e._reactInternals)&&Z(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Vi(),a=Ti(e),i=In(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),Cn(e,i),Ei(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Vi(),a=Ti(e),i=In(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),Cn(e,i),Ei(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Vi(),r=Ti(e),a=In(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),Cn(e,a),Ei(e,r,n)}};function Gn(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!$t(n,r)||!$t(a,i))}function Bn(e,t,n){var r=!1,a=et,i=t.contextType;return"object"===typeof i&&null!==i?i=dn(i):(a=it(t)?rt:tt.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?at(e,a):et),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=wn,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function xn(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&wn.enqueueReplaceState(t,t.state,null)}function Sn(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=An,fn(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=dn(i):(i=it(t)?rt:tt.current,a.context=at(e,i)),bn(e,n,a,r),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(yn(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&wn.enqueueReplaceState(a,a.state,null),bn(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4)}var kn=Array.isArray;function Zn(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=r.refs;t===An&&(t=r.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Rn(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Nn(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Go(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=ko(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=Zn(e,t,n),r.return=e,r):((r=Bo(n.type,n.key,n.props,null,e.mode,r)).ref=Zn(e,t,n),r.return=e,r)}function h(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Zo(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=xo(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=ko(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case c:return(n=Bo(t.type,t.key,t.props,null,e.mode,n)).ref=Zn(e,null,t),n.return=e,n;case l:return(t=Zo(t,e.mode,n)).return=e,t}if(kn(t)||S(t))return(t=xo(t,e.mode,n,null)).return=e,t;Rn(e,t)}return null}function I(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case c:return n.key===a?n.type===g?f(e,t,n.props.children,r,a):d(e,t,n,r):null;case l:return n.key===a?h(e,t,n,r):null}if(kn(n)||S(n))return null!==a?null:f(e,t,n,r,null);Rn(e,n)}return null}function C(e,t,n,r,a){if("string"===typeof r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case c:return e=e.get(null===r.key?n:r.key)||null,r.type===g?f(t,e,r.props.children,a,r.key):d(t,e,r,a);case l:return h(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(kn(r)||S(r))return f(t,e=e.get(n)||null,r,a,null);Rn(t,r)}return null}function m(a,o,s,u){for(var c=null,l=null,g=o,d=o=0,h=null;null!==g&&d<s.length;d++){g.index>d?(h=g,g=null):h=g.sibling;var f=I(a,g,s[d],u);if(null===f){null===g&&(g=h);break}e&&g&&null===f.alternate&&t(a,g),o=i(f,o,d),null===l?c=f:l.sibling=f,l=f,g=h}if(d===s.length)return n(a,g),c;if(null===g){for(;d<s.length;d++)null!==(g=p(a,s[d],u))&&(o=i(g,o,d),null===l?c=g:l.sibling=g,l=g);return c}for(g=r(a,g);d<s.length;d++)null!==(h=C(g,a,d,s[d],u))&&(e&&null!==h.alternate&&g.delete(null===h.key?d:h.key),o=i(h,o,d),null===l?c=h:l.sibling=h,l=h);return e&&g.forEach((function(e){return t(a,e)})),c}function b(a,o,u,c){var l=S(u);if("function"!==typeof l)throw Error(s(150));if(null==(u=l.call(u)))throw Error(s(151));for(var g=l=null,d=o,h=o=0,f=null,m=u.next();null!==d&&!m.done;h++,m=u.next()){d.index>h?(f=d,d=null):f=d.sibling;var b=I(a,d,m.value,c);if(null===b){null===d&&(d=f);break}e&&d&&null===b.alternate&&t(a,d),o=i(b,o,h),null===g?l=b:g.sibling=b,g=b,d=f}if(m.done)return n(a,d),l;if(null===d){for(;!m.done;h++,m=u.next())null!==(m=p(a,m.value,c))&&(o=i(m,o,h),null===g?l=m:g.sibling=m,g=m);return l}for(d=r(a,d);!m.done;h++,m=u.next())null!==(m=C(d,a,h,m.value,c))&&(e&&null!==m.alternate&&d.delete(null===m.key?h:m.key),o=i(m,o,h),null===g?l=m:g.sibling=m,g=m);return e&&d.forEach((function(e){return t(a,e)})),l}return function(e,r,i,u){var d="object"===typeof i&&null!==i&&i.type===g&&null===i.key;d&&(i=i.props.children);var h="object"===typeof i&&null!==i;if(h)switch(i.$$typeof){case c:e:{for(h=i.key,d=r;null!==d;){if(d.key===h){switch(d.tag){case 7:if(i.type===g){n(e,d.sibling),(r=a(d,i.props.children)).return=e,e=r;break e}break;default:if(d.elementType===i.type){n(e,d.sibling),(r=a(d,i.props)).ref=Zn(e,d,i),r.return=e,e=r;break e}}n(e,d);break}t(e,d),d=d.sibling}i.type===g?((r=xo(i.props.children,e.mode,u,i.key)).return=e,e=r):((u=Bo(i.type,i.key,i.props,null,e.mode,u)).ref=Zn(e,r,i),u.return=e,e=u)}return o(e);case l:e:{for(d=i.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=a(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Zo(i,e.mode,u)).return=e,e=r}return o(e)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,i)).return=e,e=r):(n(e,r),(r=ko(i,e.mode,u)).return=e,e=r),o(e);if(kn(i))return m(e,r,i,u);if(S(i))return b(e,r,i,u);if(h&&Rn(e,i),"undefined"===typeof i&&!d)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,k(e.type)||"Component"))}return n(e,r)}}var On=Nn(!0),Wn=Nn(!1),Fn={},Mn=Qe(Fn),Vn=Qe(Fn),Tn=Qe(Fn);function En(e){if(e===Fn)throw Error(s(174));return e}function jn(e,t){$e(Tn,t),$e(Vn,e),$e(Mn,Fn),e=V(t),qe(Mn),$e(Mn,e)}function Ln(){qe(Mn),qe(Vn),qe(Tn)}function Xn(e){var t=En(Tn.current),n=En(Mn.current);n!==(t=T(n,e.type,t))&&($e(Vn,e),$e(Mn,t))}function Hn(e){Vn.current===e&&(qe(Mn),qe(Vn))}var Yn=Qe(0);function zn(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Te(n)||Ee(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Kn=null,_n=null,Dn=!1;function Pn(e,t){var n=yo(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Un(e,t){switch(e.tag){case 5:return null!==(t=Me(t,e.type,e.pendingProps))&&(e.stateNode=t,!0);case 6:return null!==(t=Ve(t,e.pendingProps))&&(e.stateNode=t,!0);case 13:default:return!1}}function Jn(e){if(Dn){var t=_n;if(t){var n=t;if(!Un(e,t)){if(!(t=je(n))||!Un(e,t))return e.flags=-1025&e.flags|2,Dn=!1,void(Kn=e);Pn(Kn,n)}Kn=e,_n=Le(t)}else e.flags=-1025&e.flags|2,Dn=!1,Kn=e}}function Qn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Kn=e}function qn(e){if(!q||e!==Kn)return!1;if(!Dn)return Qn(e),Dn=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!z(t,e.memoizedProps))for(t=_n;t;)Pn(e,t),t=je(t);if(Qn(e),13===e.tag){if(!q)throw Error(s(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));_n=Ye(e)}else _n=Kn?je(e.stateNode):null;return!0}function $n(){q&&(_n=Kn=null,Dn=!1)}var er=[];function tr(){for(var e=0;e<er.length;e++){var t=er[e];U?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}er.length=0}var nr=u.ReactCurrentDispatcher,rr=u.ReactCurrentBatchConfig,ar=0,ir=null,or=null,sr=null,ur=!1,cr=!1;function lr(){throw Error(s(321))}function gr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qt(e[n],t[n]))return!1;return!0}function dr(e,t,n,r,a,i){if(ar=i,ir=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nr.current=null===e||null===e.memoizedState?Er:jr,e=n(r,a),cr){i=0;do{if(cr=!1,!(25>i))throw Error(s(301));i+=1,sr=or=null,t.updateQueue=null,nr.current=Lr,e=n(r,a)}while(cr)}if(nr.current=Tr,t=null!==or&&null!==or.next,ar=0,sr=or=ir=null,ur=!1,t)throw Error(s(300));return e}function hr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===sr?ir.memoizedState=sr=e:sr=sr.next=e,sr}function fr(){if(null===or){var e=ir.alternate;e=null!==e?e.memoizedState:null}else e=or.next;var t=null===sr?ir.memoizedState:sr.next;if(null!==t)sr=t,or=e;else{if(null===e)throw Error(s(310));e={memoizedState:(or=e).memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},null===sr?ir.memoizedState=sr=e:sr=sr.next=e}return sr}function pr(e,t){return"function"===typeof t?t(e):t}function Ir(e){var t=fr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=or,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var u=o=i=null,c=a;do{var l=c.lane;if((ar&l)===l)null!==u&&(u=u.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var g={lane:l,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===u?(o=u=g,i=r):u=u.next=g,ir.lanes|=l,gi|=l}c=c.next}while(null!==c&&c!==a);null===u?i=r:u.next=o,Qt(r,t.memoizedState)||(Hr=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Cr(e){var t=fr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{i=e(i,o.action),o=o.next}while(o!==a);Qt(i,t.memoizedState)||(Hr=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function mr(e,t,n){var r=t._getVersion;r=r(t._source);var a=U?t._workInProgressVersionPrimary:t._workInProgressVersionSecondary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(ar&e)===e)&&(U?t._workInProgressVersionPrimary=r:t._workInProgressVersionSecondary=r,er.push(t))),e)return n(t._source);throw er.push(t),Error(s(350))}function br(e,t,n,r){var a=ri;if(null===a)throw Error(s(349));var i=t._getVersion,o=i(t._source),u=nr.current,c=u.useState((function(){return mr(a,t,n)})),l=c[1],g=c[0];c=sr;var d=e.memoizedState,h=d.refs,f=h.getSnapshot,p=d.source;d=d.subscribe;var I=ir;return e.memoizedState={refs:h,source:t,subscribe:r},u.useEffect((function(){h.getSnapshot=n,h.setSnapshot=l;var e=i(t._source);if(!Qt(o,e)){e=n(t._source),Qt(g,e)||(l(e),e=Ti(I),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,s=e;0<s;){var u=31-yt(s),c=1<<u;r[u]|=e,s&=~c}}}),[n,t,r]),u.useEffect((function(){return r(t._source,(function(){var e=h.getSnapshot,n=h.setSnapshot;try{n(e(t._source));var r=Ti(I);a.mutableReadLanes|=r&a.pendingLanes}catch(i){n((function(){throw i}))}}))}),[t,r]),Qt(f,n)&&Qt(p,t)&&Qt(d,r)||((e={pending:null,dispatch:null,lastRenderedReducer:pr,lastRenderedState:g}).dispatch=l=Vr.bind(null,ir,e),c.queue=e,c.baseQueue=null,g=mr(a,t,n),c.memoizedState=c.baseState=g),g}function vr(e,t,n){return br(fr(),e,t,n)}function Ar(e){var t=hr();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:pr,lastRenderedState:e}).dispatch=Vr.bind(null,ir,e),[t.memoizedState,e]}function yr(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ir.updateQueue)?(t={lastEffect:null},ir.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function wr(e){return e={current:e},hr().memoizedState=e}function Gr(){return fr().memoizedState}function Br(e,t,n,r){var a=hr();ir.flags|=e,a.memoizedState=yr(1|t,n,void 0,void 0===r?null:r)}function xr(e,t,n,r){var a=fr();r=void 0===r?null:r;var i=void 0;if(null!==or){var o=or.memoizedState;if(i=o.destroy,null!==r&&gr(r,o.deps))return void yr(t,n,i,r)}ir.flags|=e,a.memoizedState=yr(1|t,n,i,r)}function Sr(e,t){return Br(516,4,e,t)}function kr(e,t){return xr(516,4,e,t)}function Zr(e,t){return xr(4,2,e,t)}function Rr(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Nr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,xr(4,2,Rr.bind(null,t,e),n)}function Or(){}function Wr(e,t){var n=fr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gr(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Fr(e,t){var n=fr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gr(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Mr(e,t){var n=zt();_t(98>n?98:n,(function(){e(!0)})),_t(97<n?97:n,(function(){var n=rr.transition;rr.transition=1;try{e(!1),t()}finally{rr.transition=n}}))}function Vr(e,t,n){var r=Vi(),a=Ti(e),i={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===ir||null!==o&&o===ir)cr=ur=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=o(s,n);if(i.eagerReducer=o,i.eagerState=u,Qt(u,s))return}catch(c){}Ei(e,a,r)}}var Tr={readContext:dn,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useLayoutEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useMutableSource:lr,useOpaqueIdentifier:lr,unstable_isNewReconciler:!1},Er={readContext:dn,useCallback:function(e,t){return hr().memoizedState=[e,void 0===t?null:t],e},useContext:dn,useEffect:Sr,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Br(4,2,Rr.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Br(4,2,e,t)},useMemo:function(e,t){var n=hr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=hr();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Vr.bind(null,ir,e),[r.memoizedState,e]},useRef:wr,useState:Ar,useDebugValue:Or,useDeferredValue:function(e){var t=Ar(e),n=t[0],r=t[1];return Sr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=Ar(!1),t=e[0];return wr(e=Mr.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=hr();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},br(r,e,t,n)},useOpaqueIdentifier:function(){if(Dn){var e=!1,t=ee((function(){throw e||(e=!0,n(te())),Error(s(355))})),n=Ar(t)[1];return 0===(2&ir.mode)&&(ir.flags|=516,yr(5,(function(){n(te())}),void 0,null)),t}return Ar(t=te()),t},unstable_isNewReconciler:!1},jr={readContext:dn,useCallback:Wr,useContext:dn,useEffect:kr,useImperativeHandle:Nr,useLayoutEffect:Zr,useMemo:Fr,useReducer:Ir,useRef:Gr,useState:function(){return Ir(pr)},useDebugValue:Or,useDeferredValue:function(e){var t=Ir(pr),n=t[0],r=t[1];return kr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=Ir(pr)[0];return[Gr().current,e]},useMutableSource:vr,useOpaqueIdentifier:function(){return Ir(pr)[0]},unstable_isNewReconciler:!1},Lr={readContext:dn,useCallback:Wr,useContext:dn,useEffect:kr,useImperativeHandle:Nr,useLayoutEffect:Zr,useMemo:Fr,useReducer:Cr,useRef:Gr,useState:function(){return Cr(pr)},useDebugValue:Or,useDeferredValue:function(e){var t=Cr(pr),n=t[0],r=t[1];return kr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=Cr(pr)[0];return[Gr().current,e]},useMutableSource:vr,useOpaqueIdentifier:function(){return Cr(pr)[0]},unstable_isNewReconciler:!1},Xr=u.ReactCurrentOwner,Hr=!1;function Yr(e,t,n,r){t.child=null===e?Wn(t,null,n,r):On(t,e.child,n,r)}function zr(e,t,n,r,a){n=n.render;var i=t.ref;return gn(t,a),r=dr(e,t,n,r,i,a),null===e||Hr?(t.flags|=1,Yr(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,ga(e,t,a))}function Kr(e,t,n,r,a,i){if(null===e){var o=n.type;return"function"!==typeof o||wo(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Bo(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,_r(e,t,o,r,a,i))}return o=e.child,0===(a&i)&&(a=o.memoizedProps,(n=null!==(n=n.compare)?n:$t)(a,r)&&e.ref===t.ref)?ga(e,t,i):(t.flags|=1,(e=Go(o,r)).ref=t.ref,e.return=t,t.child=e)}function _r(e,t,n,r,a,i){if(null!==e&&$t(e.memoizedProps,r)&&e.ref===t.ref){if(Hr=!1,0===(i&a))return t.lanes=e.lanes,ga(e,t,i);0!==(16384&e.flags)&&(Hr=!0)}return Ur(e,t,n,r,i)}function Dr(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},_i(t,n);else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},_i(t,e),null;t.memoizedState={baseLanes:0},_i(t,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,_i(t,r);return Yr(e,t,a,n),t.child}function Pr(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Ur(e,t,n,r,a){var i=it(n)?rt:tt.current;return i=at(t,i),gn(t,a),n=dr(e,t,n,r,i,a),null===e||Hr?(t.flags|=1,Yr(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,ga(e,t,a))}function Jr(e,t,n,r,a){if(it(n)){var i=!0;ct(t)}else i=!1;if(gn(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Bn(t,n,r),Sn(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=dn(c):c=at(t,c=it(n)?rt:tt.current);var l=n.getDerivedStateFromProps,g="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;g||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&xn(t,o,r,c),hn=!1;var d=t.memoizedState;o.state=d,bn(t,r,o,a),u=t.memoizedState,s!==r||d!==u||nt.current||hn?("function"===typeof l&&(yn(t,n,l,r),u=t.memoizedState),(s=hn||Gn(t,n,s,r,d,u,c))?(g||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,pn(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:tn(t.type,s),o.props=c,g=t.pendingProps,d=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=dn(u):u=at(t,u=it(n)?rt:tt.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==g||d!==u)&&xn(t,o,r,u),hn=!1,d=t.memoizedState,o.state=d,bn(t,r,o,a);var f=t.memoizedState;s!==g||d!==f||nt.current||hn?("function"===typeof h&&(yn(t,n,h,r),f=t.memoizedState),(c=hn||Gn(t,n,c,r,d,f,u))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),r=!1)}return Qr(e,t,n,r,i,a)}function Qr(e,t,n,r,a,i){Pr(e,t);var o=0!==(64&t.flags);if(!r&&!o)return a&&lt(t,n,!1),ga(e,t,i);r=t.stateNode,Xr.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=On(t,e.child,null,i),t.child=On(t,null,s,i)):Yr(e,t,s,i),t.memoizedState=r.state,a&&lt(t,n,!0),t.child}function qr(e){var t=e.stateNode;t.pendingContext?st(0,t.pendingContext,t.pendingContext!==t.context):t.context&&st(0,t.context,!1),jn(e,t.containerInfo)}var $r,ea,ta,na,ra={dehydrated:null,retryLane:0};function aa(e,t,n){var r,a=t.pendingProps,i=Yn.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(i|=1),$e(Yn,1&i),null===e?(void 0!==a.fallback&&Jn(t),e=a.children,i=a.fallback,o?(e=ia(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=ra,e):"number"===typeof a.unstable_expectedLoadTime?(e=ia(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=ra,t.lanes=33554432,e):((n=So({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(a=sa(e,t,a.children,a.fallback,n),o=t.child,i=e.child.memoizedState,o.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=ra,a):(n=oa(e,t,a.children,n),t.memoizedState=null,n))}function ia(e,t,n,r){var a=e.mode,i=e.child;return t={mode:"hidden",children:t},0===(2&a)&&null!==i?(i.childLanes=0,i.pendingProps=t):i=So(t,a,0,null),n=xo(n,a,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function oa(e,t,n,r){var a=e.child;return e=a.sibling,n=Go(a,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function sa(e,t,n,r,a){var i=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:n};return 0===(2&i)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Go(o,s),null!==e?r=Go(e,r):(r=xo(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function ua(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ln(e.return,t)}function ca(e,t,n,r,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.lastEffect=i)}function la(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Yr(e,t,r.children,n),0!==(2&(r=Yn.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ua(e,n);else if(19===e.tag)ua(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if($e(Yn,r),0===(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===zn(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),ca(t,!1,a,n,i,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===zn(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}ca(t,!0,n,null,i,t.lastEffect);break;case"together":ca(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ga(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),gi|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Go(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Go(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function da(e){e.flags|=4}if(J)$r=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)X(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},ea=function(){},ta=function(e,t,n,r,a){if((e=e.memoizedProps)!==r){var i=t.stateNode,o=En(Mn.current);n=Y(i,n,e,r,a,o),(t.updateQueue=n)&&da(t)}},na=function(e,t,n,r){n!==r&&da(t)};else if(Q){$r=function(e,t,n,r){for(var a=t.child;null!==a;){if(5===a.tag){var i=a.stateNode;n&&r&&(i=We(i,a.type,a.memoizedProps,a)),X(e,i)}else if(6===a.tag)i=a.stateNode,n&&r&&(i=Fe(i,a.memoizedProps,a)),X(e,i);else if(4!==a.tag){if(13===a.tag&&0!==(4&a.flags)&&(i=null!==a.memoizedState)){var o=a.child;if(null!==o&&(null!==o.child&&(o.child.return=o,$r(e,o,!0,i)),null!==(i=o.sibling))){i.return=a,a=i;continue}}if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};var ha=function e(t,n,r,a){for(var i=n.child;null!==i;){if(5===i.tag){var o=i.stateNode;r&&a&&(o=We(o,i.type,i.memoizedProps,i)),Re(t,o)}else if(6===i.tag)o=i.stateNode,r&&a&&(o=Fe(o,i.memoizedProps,i)),Re(t,o);else if(4!==i.tag){if(13===i.tag&&0!==(4&i.flags)&&(o=null!==i.memoizedState)){var s=i.child;if(null!==s&&(null!==s.child&&(s.child.return=s,e(t,s,!0,o)),null!==(o=s.sibling))){o.return=i,i=o;continue}}if(null!==i.child){i.child.return=i,i=i.child;continue}}if(i===n)break;for(;null===i.sibling;){if(null===i.return||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};ea=function(e){var t=e.stateNode;if(null!==e.firstEffect){var n=t.containerInfo,r=Ze(n);ha(r,e,!1,!1),t.pendingChildren=r,da(e),Ne(n,r)}},ta=function(e,t,n,r,a){var i=e.stateNode,o=e.memoizedProps;if((e=null===t.firstEffect)&&o===r)t.stateNode=i;else{var s=t.stateNode,u=En(Mn.current),c=null;o!==r&&(c=Y(s,n,o,r,a,u)),e&&null===c?t.stateNode=i:(i=ke(i,c,n,o,r,t,e,s),H(i,n,r,a,u)&&da(t),t.stateNode=i,e?da(t):$r(i,t,!1,!1))}},na=function(e,t,n,r){n!==r?(e=En(Tn.current),n=En(Mn.current),t.stateNode=K(r,e,n,t),da(t)):t.stateNode=e.stateNode}}else ea=function(){},ta=function(){},na=function(){};function fa(e,t){if(!Dn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function pa(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return it(t.type)&&ot(),null;case 3:return Ln(),qe(nt),qe(tt),tr(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qn(t)?da(t):r.hydrate||(t.flags|=256)),ea(t),null;case 5:Hn(t);var a=En(Tn.current);if(n=t.type,null!==e&&null!=t.stateNode)ta(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=En(Mn.current),qn(t)){if(!q)throw Error(s(175));e=Xe(t.stateNode,t.type,t.memoizedProps,a,e,t),t.updateQueue=e,null!==e&&da(t)}else{var i=L(n,r,a,e,t);$r(i,t,!1,!1),t.stateNode=i,H(i,n,r,a,e)&&da(t)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)na(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=En(Tn.current),a=En(Mn.current),qn(t)){if(!q)throw Error(s(176));He(t.stateNode,t.memoizedProps,t)&&da(t)}else t.stateNode=K(r,e,a,t)}return null;case 13:return qe(Yn),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,a=!1,null===e?void 0!==t.memoizedProps.fallback&&qn(t):a=null!==e.memoizedState,r&&!a&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Yn.current)?0===ui&&(ui=3):(0!==ui&&3!==ui||(ui=4),null===ri||0===(134217727&gi)&&0===(134217727&di)||Hi(ri,ii))),Q&&r&&(t.flags|=4),J&&(r||a)&&(t.flags|=4),null);case 4:return Ln(),ea(t),null===e&&ae(t.stateNode.containerInfo),null;case 10:return cn(t),null;case 17:return it(t.type)&&ot(),null;case 19:if(qe(Yn),null===(r=t.memoizedState))return null;if(a=0!==(64&t.flags),null===(i=r.rendering))if(a)fa(r,!1);else{if(0!==ui||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(i=zn(e))){for(t.flags|=64,fa(r,!1),null!==(e=i.updateQueue)&&(t.updateQueue=e,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,e=n,r=t.child;null!==r;)n=e,(a=r).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(i=a.alternate)?(a.childLanes=0,a.lanes=n,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,n=i.dependencies,a.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext}),r=r.sibling;return $e(Yn,1&Yn.current|2),t.child}e=e.sibling}null!==r.tail&&Yt()>Ii&&(t.flags|=64,a=!0,fa(r,!1),t.lanes=33554432)}else{if(!a)if(null!==(e=zn(i))){if(t.flags|=64,a=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),fa(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!Dn)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Yt()-r.renderingStartTime>Ii&&1073741824!==n&&(t.flags|=64,a=!0,fa(r,!1),t.lanes=33554432);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Yt(),e.sibling=null,t=Yn.current,$e(Yn,a?1&t|2:1&t),e):null;case 23:case 24:return Di(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function Ia(e){switch(e.tag){case 1:it(e.type)&&ot();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Ln(),qe(nt),qe(tt),tr(),0!==(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return Hn(e),null;case 13:return qe(Yn),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return qe(Yn),null;case 4:return Ln(),null;case 10:return cn(e),null;case 23:case 24:return Di(),null;default:return null}}function Ca(e,t){try{var n="",r=t;do{n+=en(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function ma(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ba="function"===typeof WeakMap?WeakMap:Map;function va(e,t,n){(n=In(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){vi||(vi=!0,Ai=r),ma(0,t)},n}function Aa(e,t,n){(n=In(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return ma(0,t),r(a)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===yi?yi=new Set([this]):yi.add(this),ma(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var ya="function"===typeof WeakSet?WeakSet:Set;function wa(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){lo(e,n)}else t.current=null}function Ga(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:tn(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(J&&256&t.flags&&Se(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(s(163))}function Ba(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function xa(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!==(4&(a=a.tag))&&0!==(1&a)&&(so(n,e),oo(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:tn(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&vn(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=M(n.child.stateNode);break;case 1:e=n.child.stateNode}vn(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Ie(e,n.type,n.memoizedProps,n));case 6:case 4:case 12:return;case 13:return void(q&&null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Ke(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(s(163))}function Sa(e,t){if(J)for(var n=e;;){if(5===n.tag){var r=n.stateNode;t?we(r):Be(n.stateNode,n.memoizedProps)}else if(6===n.tag)r=n.stateNode,t?Ge(r):xe(r,n.memoizedProps);else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ka(e,t){if(dt&&"function"===typeof dt.onCommitFiberUnmount)try{dt.onCommitFiberUnmount(gt,t)}catch(i){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!==(4&r))so(t,n);else{r=t;try{a()}catch(i){lo(r,i)}}n=n.next}while(n!==e)}break;case 1:if(wa(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){lo(t,i)}break;case 5:wa(t);break;case 4:J?Ma(e,t):Q&&Q&&(t=t.stateNode.containerInfo,e=Ze(t),Oe(t,e))}}function Za(e,t){for(var n=t;;)if(ka(e,n),null===n.child||J&&4===n.tag){if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else n.child.return=n,n=n.child}function Ra(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Na(e){return 5===e.tag||3===e.tag||4===e.tag}function Oa(e){if(J){e:{for(var t=e.return;null!==t;){if(Na(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(ye(t),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Na(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?Wa(e,n,t):Fa(e,n,t)}}function Wa(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?be(n,e,t):fe(n,e);else if(4!==r&&null!==(e=e.child))for(Wa(e,t,n),e=e.sibling;null!==e;)Wa(e,t,n),e=e.sibling}function Fa(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?me(n,e,t):he(n,e);else if(4!==r&&null!==(e=e.child))for(Fa(e,t,n),e=e.sibling;null!==e;)Fa(e,t,n),e=e.sibling}function Ma(e,t){for(var n,r,a=t,i=!1;;){if(!i){i=a.return;e:for(;;){if(null===i)throw Error(s(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===a.tag||6===a.tag)Za(e,a),r?Ae(n,a.stateNode):ve(n,a.stateNode);else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(ka(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(i=!1)}a.sibling.return=a.return,a=a.sibling}}function Va(e,t){if(J){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Ba(3,t);case 1:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var a=t.type,i=t.updateQueue;t.updateQueue=null,null!==i&&Ce(n,i,a,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(s(162));return n=t.memoizedProps,void pe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(q&&(t=t.stateNode,t.hydrate&&(t.hydrate=!1,ze(t.containerInfo))));case 12:return;case 13:return Ta(t),void Ea(t);case 19:return void Ea(t);case 17:return;case 23:case 24:return void Sa(t,null!==t.memoizedState)}throw Error(s(163))}switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Ba(3,t);case 12:return;case 13:return Ta(t),void Ea(t);case 19:return void Ea(t);case 3:q&&((n=t.stateNode).hydrate&&(n.hydrate=!1,ze(n.containerInfo)));break;case 23:case 24:return}e:if(Q){switch(t.tag){case 1:case 5:case 6:case 20:break e;case 3:case 4:t=t.stateNode,Oe(t.containerInfo,t.pendingChildren);break e}throw Error(s(163))}}function Ta(e){null!==e.memoizedState&&(pi=Yt(),J&&Sa(e.child,!0))}function Ea(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ya),t.forEach((function(t){var r=ho.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ja(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var La=0,Xa=1,Ha=2,Ya=3,za=4;if("function"===typeof Symbol&&Symbol.for){var Ka=Symbol.for;La=Ka("selector.component"),Xa=Ka("selector.has_pseudo_class"),Ha=Ka("selector.role"),Ya=Ka("selector.test_id"),za=Ka("selector.text")}function _a(e){var t=$(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(s(364));return t}if(null===(e=oe(e)))throw Error(s(362));return e.stateNode.current}function Da(e,t){switch(t.$$typeof){case La:if(e.type===t.value)return!0;break;case Xa:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],a=e[n++],i=t[a];if(5!==r.tag||!ce(r)){for(;null!=i&&Da(r,i);)i=t[++a];if(a===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,a),r=r.sibling}}t=!1}return t;case Ha:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case za:if((5===e.tag||6===e.tag)&&(null!==(e=ue(e))&&0<=e.indexOf(t.value)))return!0;break;case Ya:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(s(365,t))}return!1}function Pa(e){switch(e.$$typeof){case La:return"<"+(k(e.value)||"Unknown")+">";case Xa:return":has("+(Pa(e)||"")+")";case Ha:return'[role="'+e.value+'"]';case za:return'"'+e.value+'"';case Ya:return'[data-testname="'+e.value+'"]';default:throw Error(s(365,e))}}function Ua(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var a=e[r++],i=e[r++],o=t[i];if(5!==a.tag||!ce(a)){for(;null!=o&&Da(a,o);)o=t[++i];if(i===t.length)n.push(a);else for(a=a.child;null!==a;)e.push(a,i),a=a.sibling}}return n}function Ja(e,t){if(!ie)throw Error(s(363));e=Ua(e=_a(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(5===r.tag)ce(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var Qa=null;var qa=Math.ceil,$a=u.ReactCurrentDispatcher,ei=u.ReactCurrentOwner,ti=u.IsSomeRendererActing,ni=0,ri=null,ai=null,ii=0,oi=0,si=Qe(0),ui=0,ci=null,li=0,gi=0,di=0,hi=0,fi=null,pi=0,Ii=1/0;function Ci(){Ii=Yt()+500}var mi,bi=null,vi=!1,Ai=null,yi=null,wi=!1,Gi=null,Bi=90,xi=[],Si=[],ki=null,Zi=0,Ri=null,Ni=-1,Oi=0,Wi=0,Fi=null,Mi=!1;function Vi(){return 0!==(48&ni)?Yt():-1!==Ni?Ni:Ni=Yt()}function Ti(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===zt()?1:2;if(0===Oi&&(Oi=li),0!==Jt.transition){0!==Wi&&(Wi=null!==fi?fi.pendingLanes:0),e=Oi;var t=4186112&~Wi;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=zt(),0!==(4&ni)&&98===e?e=mt(12,Oi):e=mt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Oi),e}function Ei(e,t,n){if(50<Zi)throw Zi=0,Ri=null,Error(s(185));if(null===(e=ji(e,t)))return null;At(e,t,n),e===ri&&(di|=t,4===ui&&Hi(e,ii));var r=zt();1===t?0!==(8&ni)&&0===(48&ni)?Yi(e):(Li(e,n),0===ni&&(Ci(),Pt())):(0===(4&ni)||98!==r&&99!==r||(null===ki?ki=new Set([e]):ki.add(e)),Li(e,n)),fi=e}function ji(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Li(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var u=31-yt(o),c=1<<u,l=i[u];if(-1===l){if(0===(c&r)||0!==(c&a)){l=t,pt(c);var g=ft;i[u]=10<=g?l+250:6<=g?l+5e3:-1}}else l<=t&&(e.expiredLanes|=c);o&=~c}if(r=It(e,e===ri?ii:0),t=ft,0===r)null!==n&&(n!==Tt&&St(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Tt&&St(n)}15===t?(n=Yi.bind(null,e),null===jt?(jt=[n],Lt=xt(Ot,Ut)):jt.push(n),n=Tt):14===t?n=Dt(99,Yi.bind(null,e)):n=Dt(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),Xi.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function Xi(e){if(Ni=-1,Wi=Oi=0,0!==(48&ni))throw Error(s(327));var t=e.callbackNode;if(io()&&e.callbackNode!==t)return null;var n=It(e,e===ri?ii:0);if(0===n)return null;var r=n,a=ni;ni|=16;var i=Ji();for(ri===e&&ii===r||(Ci(),Pi(e,r));;)try{$i();break}catch(u){Ui(e,u)}if(sn(),$a.current=i,ni=a,null!==ai?r=0:(ri=null,ii=0,r=ui),0!==(li&di))Pi(e,0);else if(0!==r){if(2===r&&(ni|=64,e.hydrate&&(e.hydrate=!1,Se(e.containerInfo)),0!==(n=Ct(e))&&(r=Qi(e,n))),1===r)throw t=ci,Pi(e,0),Hi(e,n),Li(e,Yt()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:no(e);break;case 3:if(Hi(e,n),(62914560&n)===n&&10<(r=pi+500-Yt())){if(0!==It(e,0))break;if(((a=e.suspendedLanes)&n)!==n){Vi(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=_(no.bind(null,e),r);break}no(e);break;case 4:if(Hi(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var o=31-yt(n);i=1<<o,(o=r[o])>a&&(a=o),n&=~i}if(n=a,10<(n=(120>(n=Yt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*qa(n/1960))-n)){e.timeoutHandle=_(no.bind(null,e),n);break}no(e);break;case 5:no(e);break;default:throw Error(s(329))}}return Li(e,Yt()),e.callbackNode===t?Xi.bind(null,e):null}function Hi(e,t){for(t&=~hi,t&=~di,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-yt(t),r=1<<n;e[n]=-1,t&=~r}}function Yi(e){if(0!==(48&ni))throw Error(s(327));if(io(),e===ri&&0!==(e.expiredLanes&ii)){var t=ii,n=Qi(e,t);0!==(li&di)&&(n=Qi(e,t=It(e,t)))}else n=Qi(e,t=It(e,0));if(0!==e.tag&&2===n&&(ni|=64,e.hydrate&&(e.hydrate=!1,Se(e.containerInfo)),0!==(t=Ct(e))&&(n=Qi(e,t))),1===n)throw n=ci,Pi(e,0),Hi(e,t),Li(e,Yt()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,no(e),Li(e,Yt()),null}function zi(e,t){var n=ni;ni|=1;try{return e(t)}finally{0===(ni=n)&&(Ci(),Pt())}}function Ki(e,t){var n=ni;if(0!==(48&n))return e(t);ni|=1;try{if(e)return _t(99,e.bind(null,t))}finally{ni=n,Pt()}}function _i(e,t){$e(si,oi),oi|=t,li|=t}function Di(){oi=si.current,qe(si)}function Pi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==P&&(e.timeoutHandle=P,D(n)),null!==ai)for(n=ai.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ot();break;case 3:Ln(),qe(nt),qe(tt),tr();break;case 5:Hn(r);break;case 4:Ln();break;case 13:case 19:qe(Yn);break;case 10:cn(r);break;case 23:case 24:Di()}n=n.return}ri=e,ai=Go(e.current,null),ii=oi=li=t,ui=0,ci=null,hi=di=gi=0}function Ui(e,t){for(;;){var n=ai;try{if(sn(),nr.current=Tr,ur){for(var r=ir.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}ur=!1}if(ar=0,sr=or=ir=null,cr=!1,ei.current=null,null===n||null===n.return){ui=1,ci=t,ai=null;break}e:{var i=e,o=n.return,s=n,u=t;if(t=ii,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.lanes=l.lanes):(s.updateQueue=null,s.memoizedState=null)}var g=0!==(1&Yn.current),d=o;do{var h;if(h=13===d.tag){var f=d.memoizedState;if(null!==f)h=null!==f.dehydrated;else{var p=d.memoizedProps;h=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!g)}}if(h){var I=d.updateQueue;if(null===I){var C=new Set;C.add(c),d.updateQueue=C}else I.add(c);if(0===(2&d.mode)){if(d.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var m=In(-1,1);m.tag=2,Cn(s,m)}s.lanes|=1;break e}u=void 0,s=t;var b=i.pingCache;if(null===b?(b=i.pingCache=new ba,u=new Set,b.set(c,u)):void 0===(u=b.get(c))&&(u=new Set,b.set(c,u)),!u.has(s)){u.add(s);var v=go.bind(null,i,c,s);c.then(v,v)}d.flags|=4096,d.lanes=t;break e}d=d.return}while(null!==d);u=Error((k(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==ui&&(ui=2),u=Ca(u,s),d=o;do{switch(d.tag){case 3:i=u,d.flags|=4096,t&=-t,d.lanes|=t,mn(d,va(0,i,t));break e;case 1:i=u;var A=d.type,y=d.stateNode;if(0===(64&d.flags)&&("function"===typeof A.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===yi||!yi.has(y)))){d.flags|=4096,t&=-t,d.lanes|=t,mn(d,Aa(d,i,t));break e}}d=d.return}while(null!==d)}to(n)}catch(w){t=w,ai===n&&null!==n&&(ai=n=n.return);continue}break}}function Ji(){var e=$a.current;return $a.current=Tr,null===e?Tr:e}function Qi(e,t){var n=ni;ni|=16;var r=Ji();for(ri===e&&ii===t||Pi(e,t);;)try{qi();break}catch(a){Ui(e,a)}if(sn(),ni=n,$a.current=r,null!==ai)throw Error(s(261));return ri=null,ii=0,ui}function qi(){for(;null!==ai;)eo(ai)}function $i(){for(;null!==ai&&!kt();)eo(ai)}function eo(e){var t=mi(e.alternate,e,oi);e.memoizedProps=e.pendingProps,null===t?to(e):ai=t,ei.current=null}function to(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=pa(n,t,oi)))return void(ai=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&oi)||0===(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=Ia(t)))return n.flags&=2047,void(ai=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(ai=t);ai=t=e}while(null!==t);0===ui&&(ui=5)}function no(e){var t=zt();return _t(99,ro.bind(null,e,t)),null}function ro(e,t){do{io()}while(null!==Gi);if(0!==(48&ni))throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,i=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var o=e.eventTimes,u=e.expirationTimes;0<i;){var c=31-yt(i),l=1<<c;a[c]=0,o[c]=-1,u[c]=-1,i&=~l}if(null!==ki&&0===(24&r)&&ki.has(e)&&ki.delete(e),e===ri&&(ai=ri=null,ii=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){a=ni,ni|=32,ei.current=null,Fi=E(e.containerInfo),Mi=!1,bi=r;do{try{ao()}catch(m){if(null===bi)throw Error(s(330));lo(bi,m),bi=bi.nextEffect}}while(null!==bi);Fi=null,bi=r;do{try{for(o=e;null!==bi;){var g=bi.flags;if(16&g&&J&&ye(bi.stateNode),128&g){var d=bi.alternate;if(null!==d){var h=d.ref;null!==h&&("function"===typeof h?h(null):h.current=null)}}switch(1038&g){case 2:Oa(bi),bi.flags&=-3;break;case 6:Oa(bi),bi.flags&=-3,Va(bi.alternate,bi);break;case 1024:bi.flags&=-1025;break;case 1028:bi.flags&=-1025,Va(bi.alternate,bi);break;case 4:Va(bi.alternate,bi);break;case 8:u=o,i=bi,J?Ma(u,i):Za(u,i);var f=i.alternate;Ra(i),null!==f&&Ra(f)}bi=bi.nextEffect}}catch(m){if(null===bi)throw Error(s(330));lo(bi,m),bi=bi.nextEffect}}while(null!==bi);Mi&&re(),j(e.containerInfo),e.current=n,bi=r;do{try{for(g=e;null!==bi;){var p=bi.flags;if(36&p&&xa(g,bi.alternate,bi),128&p){d=void 0;var I=bi.ref;if(null!==I){var C=bi.stateNode;switch(bi.tag){case 5:d=M(C);break;default:d=C}"function"===typeof I?I(d):I.current=d}}bi=bi.nextEffect}}catch(m){if(null===bi)throw Error(s(330));lo(bi,m),bi=bi.nextEffect}}while(null!==bi);bi=null,Et(),ni=a}else e.current=n;if(wi)wi=!1,Gi=e,Bi=t;else for(bi=r;null!==bi;)t=bi.nextEffect,bi.nextEffect=null,8&bi.flags&&((p=bi).sibling=null,p.stateNode=null),bi=t;if(0===(r=e.pendingLanes)&&(yi=null),1===r?e===Ri?Zi++:(Zi=0,Ri=e):Zi=0,n=n.stateNode,dt&&"function"===typeof dt.onCommitFiberRoot)try{dt.onCommitFiberRoot(gt,n,void 0,64===(64&n.current.flags))}catch(m){}if(Li(e,Yt()),vi)throw vi=!1,e=Ai,Ai=null,e;return 0!==(8&ni)||Pt(),null}function ao(){for(;null!==bi;){var e=bi.alternate;Mi||null===Fi||(0!==(8&bi.flags)?W(bi,Fi)&&(Mi=!0,ne()):13===bi.tag&&ja(e,bi)&&W(bi,Fi)&&(Mi=!0,ne()));var t=bi.flags;0!==(256&t)&&Ga(e,bi),0===(512&t)||wi||(wi=!0,Dt(97,(function(){return io(),null}))),bi=bi.nextEffect}}function io(){if(90!==Bi){var e=97<Bi?97:Bi;return Bi=90,_t(e,uo)}return!1}function oo(e,t){xi.push(t,e),wi||(wi=!0,Dt(97,(function(){return io(),null})))}function so(e,t){Si.push(t,e),wi||(wi=!0,Dt(97,(function(){return io(),null})))}function uo(){if(null===Gi)return!1;var e=Gi;if(Gi=null,0!==(48&ni))throw Error(s(331));var t=ni;ni|=32;var n=Si;Si=[];for(var r=0;r<n.length;r+=2){var a=n[r],i=n[r+1],o=a.destroy;if(a.destroy=void 0,"function"===typeof o)try{o()}catch(c){if(null===i)throw Error(s(330));lo(i,c)}}for(n=xi,xi=[],r=0;r<n.length;r+=2){a=n[r],i=n[r+1];try{var u=a.create;a.destroy=u()}catch(c){if(null===i)throw Error(s(330));lo(i,c)}}for(u=e.current.firstEffect;null!==u;)e=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=e;return ni=t,Pt(),!0}function co(e,t,n){Cn(e,t=va(0,t=Ca(n,t),1)),t=Vi(),null!==(e=ji(e,1))&&(At(e,1,t),Li(e,t))}function lo(e,t){if(3===e.tag)co(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){co(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===yi||!yi.has(r))){var a=Aa(n,e=Ca(t,e),1);if(Cn(n,a),a=Vi(),null!==(n=ji(n,1)))At(n,1,a),Li(n,a);else if("function"===typeof r.componentDidCatch&&(null===yi||!yi.has(r)))try{r.componentDidCatch(t,e)}catch(i){}break}}n=n.return}}function go(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Vi(),e.pingedLanes|=e.suspendedLanes&n,ri===e&&(ii&n)===n&&(4===ui||3===ui&&(62914560&ii)===ii&&500>Yt()-pi?Pi(e,0):hi|=n),Li(e,t)}function ho(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===zt()?1:2:(0===Oi&&(Oi=li),0===(t=bt(62914560&~Oi))&&(t=4194304))),n=Vi(),null!==(e=ji(e,t))&&(At(e,t,n),Li(e,n))}mi=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||nt.current)Hr=!0;else{if(0===(n&r)){switch(Hr=!1,t.tag){case 3:qr(t),$n();break;case 5:Xn(t);break;case 1:it(t.type)&&ct(t);break;case 4:jn(t,t.stateNode.containerInfo);break;case 10:un(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?aa(e,t,n):($e(Yn,1&Yn.current),null!==(t=ga(e,t,n))?t.sibling:null);$e(Yn,1&Yn.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return la(e,t,n);t.flags|=64}var a=t.memoizedState;if(null!==a&&(a.rendering=null,a.tail=null,a.lastEffect=null),$e(Yn,Yn.current),r)break;return null;case 23:case 24:return t.lanes=0,Dr(e,t,n)}return ga(e,t,n)}Hr=0!==(16384&e.flags)}else Hr=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=at(t,tt.current),gn(t,n),a=dr(null,t,r,e,a,n),t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,it(r)){var i=!0;ct(t)}else i=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,fn(t);var o=r.getDerivedStateFromProps;"function"===typeof o&&yn(t,r,o,e),a.updater=wn,t.stateNode=a,a._reactInternals=t,Sn(t,r,e,n),t=Qr(null,t,r,!0,i,n)}else t.tag=0,Yr(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(i=a._init)(a._payload),t.type=a,i=t.tag=function(e){if("function"===typeof e)return wo(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===b)return 14}return 2}(a),e=tn(a,e),i){case 0:t=Ur(null,t,a,e,n);break e;case 1:t=Jr(null,t,a,e,n);break e;case 11:t=zr(null,t,a,e,n);break e;case 14:t=Kr(null,t,a,tn(a.type,e),r,n);break e}throw Error(s(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ur(e,t,r,a=t.elementType===r?a:tn(r,a),n);case 1:return r=t.type,a=t.pendingProps,Jr(e,t,r,a=t.elementType===r?a:tn(r,a),n);case 3:if(qr(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,pn(e,t),bn(t,r,null,n),(r=t.memoizedState.element)===a)$n(),t=ga(e,t,n);else{if((i=(a=t.stateNode).hydrate)&&(q?(_n=Le(t.stateNode.containerInfo),Kn=t,i=Dn=!0):i=!1),i){if(q&&null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)i=e[a],o=e[a+1],U?i._workInProgressVersionPrimary=o:i._workInProgressVersionSecondary=o,er.push(i);for(n=Wn(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Yr(e,t,r,n),$n();t=t.child}return t;case 5:return Xn(t),null===e&&Jn(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,o=a.children,z(r,a)?o=null:null!==i&&z(r,i)&&(t.flags|=16),Pr(e,t),Yr(e,t,o,n),t.child;case 6:return null===e&&Jn(t),null;case 13:return aa(e,t,n);case 4:return jn(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=On(t,null,r,n):Yr(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,zr(e,t,r,a=t.elementType===r?a:tn(r,a),n);case 7:return Yr(e,t,t.pendingProps,n),t.child;case 8:case 12:return Yr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,un(t,i=a.value),null!==o){var u=o.value;if(0===(i=Qt(u,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,i):1073741823))){if(o.children===a.children&&!nt.current){t=ga(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var c=u.dependencies;if(null!==c){o=u.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&i)){1===u.tag&&((l=In(-1,n&-n)).tag=2,Cn(u,l)),u.lanes|=n,null!==(l=u.alternate)&&(l.lanes|=n),ln(u.return,n),c.lanes|=n;break}l=l.next}}else o=10===u.tag&&u.type===t.type?null:u.child;if(null!==o)o.return=u;else for(o=u;null!==o;){if(o===t){o=null;break}if(null!==(u=o.sibling)){u.return=o.return,o=u;break}o=o.return}u=o}}Yr(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(i=t.pendingProps).children,gn(t,n),r=r(a=dn(a,i.unstable_observedBits)),t.flags|=1,Yr(e,t,r,n),t.child;case 14:return i=tn(a=t.type,t.pendingProps),Kr(e,t,a,i=tn(a.type,i),r,n);case 15:return _r(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:tn(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,it(r)?(e=!0,ct(t)):e=!1,gn(t,n),Bn(t,r,a),Sn(t,r,a,n),Qr(null,t,r,!0,e,n);case 19:return la(e,t,n);case 23:case 24:return Dr(e,t,n)}throw Error(s(156,t.tag))};var fo={current:!1},po=o.unstable_flushAllWithoutAsserting,Io="function"===typeof po;function Co(){if(void 0!==po)return po();for(var e=!1;io();)e=!0;return e}function mo(t){try{Co(),function(t){if(null===Qa)try{var n=("require"+Math.random()).slice(0,7);Qa=(e&&e[n]).call(e,"timers").setImmediate}catch(r){Qa=function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}Qa(t)}((function(){Co()?mo(t):t()}))}catch(n){t(n)}}var bo=0,vo=!1;function Ao(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function yo(e,t,n,r){return new Ao(e,t,n,r)}function wo(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Go(e,t){var n=e.alternate;return null===n?((n=yo(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Bo(e,t,n,r,a,i){var o=2;if(r=e,"function"===typeof e)wo(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case g:return xo(n.children,a,i,t);case y:o=8,a|=16;break;case d:o=8,a|=1;break;case h:return(e=yo(12,n,t,8|a)).elementType=h,e.type=h,e.lanes=i,e;case C:return(e=yo(13,n,t,a)).type=C,e.elementType=C,e.lanes=i,e;case m:return(e=yo(19,n,t,a)).elementType=m,e.lanes=i,e;case w:return So(n,a,i,t);case G:return(e=yo(24,n,t,a)).elementType=G,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case f:o=10;break e;case p:o=9;break e;case I:o=11;break e;case b:o=14;break e;case v:o=16,r=null;break e;case A:o=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=yo(o,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function xo(e,t,n,r){return(e=yo(7,e,r,t)).lanes=n,e}function So(e,t,n,r){return(e=yo(23,e,r,t)).elementType=w,e.lanes=n,e}function ko(e,t,n){return(e=yo(6,e,null,t)).lanes=n,e}function Zo(e,t,n){return(t=yo(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ro(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=P,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),q&&(this.mutableSourceEagerHydrationData=null)}function No(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return null===(e=O(t))?null:e.stateNode}function Oo(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wo(e,t){Oo(e,t),(e=e.alternate)&&Oo(e,t)}function Fo(e){return null===(e=O(e))?null:e.stateNode}function Mo(){return null}return r.IsThisRendererActing=fo,r.act=function(e){function t(){bo--,ti.current=n,fo.current=r}!1===vo&&(vo=!0,console.error("act(...) is not supported in production builds of React, and might not behave as expected.")),bo++;var n=ti.current,r=fo.current;ti.current=!0,fo.current=!0;try{var a=zi(e)}catch(i){throw t(),i}if(null!==a&&"object"===typeof a&&"function"===typeof a.then)return{then:function(e,r){a.then((function(){1<bo||!0===Io&&!0===n?(t(),e()):mo((function(n){t(),n?r(n):e()}))}),(function(e){t(),r(e)}))}};try{1!==bo||!1!==Io&&!1!==n||Co(),t()}catch(i){throw t(),i}return{then:function(e){e()}}},r.attemptContinuousHydration=function(e){13===e.tag&&(Ei(e,67108864,Vi()),Wo(e,67108864))},r.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Vi(),n=Ti(e);Ei(e,n,t),Wo(e,n)}},r.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.hydrate){var n=pt(t.pendingLanes);t.expiredLanes|=n&t.pendingLanes,Li(t,Yt()),0===(48&ni)&&(Ci(),Pt())}break;case 13:var r=Vi();Ki((function(){return Ei(e,1,r)})),Wo(e,4)}},r.attemptUserBlockingHydration=function(e){13===e.tag&&(Ei(e,4,Vi()),Wo(e,4))},r.batchedEventUpdates=function(e,t){var n=ni;ni|=2;try{return e(t)}finally{0===(ni=n)&&(Ci(),Pt())}},r.batchedUpdates=zi,r.createComponentSelector=function(e){return{$$typeof:La,value:e}},r.createContainer=function(e,t,n){return e=new Ro(e,t,n),t=yo(3,null,null,2===t?7:1===t?3:0),e.current=t,t.stateNode=e,fn(t),e},r.createHasPsuedoClassSelector=function(e){return{$$typeof:Xa,value:e}},r.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:l,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},r.createRoleSelector=function(e){return{$$typeof:Ha,value:e}},r.createTestNameSelector=function(e){return{$$typeof:Ya,value:e}},r.createTextSelector=function(e){return{$$typeof:za,value:e}},r.deferredUpdates=function(e){return _t(97,e)},r.discreteUpdates=function(e,t,n,r,a){var i=ni;ni|=4;try{return _t(98,e.bind(null,t,n,r,a))}finally{0===(ni=i)&&(Ci(),Pt())}},r.findAllNodes=Ja,r.findBoundingRects=function(e,t){if(!ie)throw Error(s(363));t=Ja(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,a=r+n.width,i=n.y,o=i+n.height,u=t-1;0<=u;u--)if(t!==u){var c=e[u],l=c.x,g=l+c.width,d=c.y,h=d+c.height;if(r>=l&&i>=d&&a<=g&&o<=h){e.splice(t,1);break}if(!(r!==l||n.width!==c.width||h<i||d>o)){d>i&&(c.height+=d-i,c.y=i),h<o&&(c.height=o-d),e.splice(t,1);break}if(!(i!==d||n.height!==c.height||g<r||l>a)){l>r&&(c.width+=l-r,c.x=r),g<a&&(c.width=a-l),e.splice(t,1);break}}return e},r.findHostInstance=No,r.findHostInstanceWithNoPortals=function(e){return null===(e=function(e){if(!(e=N(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child&&4!==t.tag)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}(e))?null:20===e.tag?e.stateNode.instance:e.stateNode},r.findHostInstanceWithWarning=function(e){return No(e)},r.flushControlled=function(e){var t=ni;ni|=1;try{_t(99,e)}finally{0===(ni=t)&&(Ci(),Pt())}},r.flushDiscreteUpdates=function(){0===(49&ni)&&(function(){if(null!==ki){var e=ki;ki=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Li(e,Yt())}))}Pt()}(),io())},r.flushPassiveEffects=io,r.flushSync=Ki,r.focusWithin=function(e,t){if(!ie)throw Error(s(363));for(t=Ua(e=_a(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!ce(n)){if(5===n.tag&&ge(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},r.getCurrentUpdateLanePriority=function(){return ht},r.getFindAllNodesFailureDescription=function(e,t){if(!ie)throw Error(s(363));var n=0,r=[];e=[_a(e),0];for(var a=0;a<e.length;){var i=e[a++],o=e[a++],u=t[o];if((5!==i.tag||!ce(i))&&(Da(i,u)&&(r.push(Pa(u)),++o>n&&(n=o)),o<t.length))for(i=i.child;null!==i;)e.push(i,o),i=i.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Pa(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},r.getPublicRootInstance=function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:return M(e.child.stateNode);default:return e.child.stateNode}},r.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:Fo,findFiberByHostInstance:e.findFiberByHostInstance||Mo,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!t.isDisabled&&t.supportsFiber)try{gt=t.inject(e),dt=t}catch(n){}e=!0}return e},r.observeVisibleRects=function(e,t,n,r){if(!ie)throw Error(s(363));e=Ja(e,t);var a=de(e,n,r).disconnect;return{disconnect:function(){a()}}},r.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},r.runWithPriority=function(e,t){var n=ht;try{return ht=e,t()}finally{ht=n}},r.shouldSuspend=function(){return!1},r.unbatchedUpdates=function(e,t){var n=ni;ni&=-2,ni|=8;try{return e(t)}finally{0===(ni=n)&&(Ci(),Pt())}},r.updateContainer=function(e,t,n,r){var a=t.current,i=Vi(),o=Ti(a);e:if(n){t:{if(Z(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(it(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(s(171))}if(1===n.tag){var c=n.type;if(it(c)){n=ut(n,c,u);break e}}n=u}else n=et;return null===t.context?t.context=n:t.pendingContext=n,(t=In(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),Cn(a,t),Ei(a,o,i),o},r}}).call(this,n(149)(e))},function(e,t,n){"use strict";e.exports=n(424)},function(e,t,n){"use strict";var r,a,i,o;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();t.unstable_now=function(){return u.now()-c}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,g=null,d=function e(){if(null!==l)try{var n=t.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(e,0),r}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(d,0))},a=function(e,t){g=setTimeout(e,t)},i=function(){clearTimeout(g)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,f=window.clearTimeout;if("undefined"!==typeof console){var p=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var I=!1,C=null,m=-1,b=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var A=new MessageChannel,y=A.port2;A.port1.onmessage=function(){if(null!==C){var e=t.unstable_now();v=e+b;try{C(!0,e)?y.postMessage(null):(I=!1,C=null)}catch(n){throw y.postMessage(null),n}}else I=!1},r=function(e){C=e,I||(I=!0,y.postMessage(null))},a=function(e,n){m=h((function(){e(t.unstable_now())}),n)},i=function(){f(m),m=-1}}function w(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<x(a,t)))break e;e[r]=t,e[n]=a,n=r}}function G(e){return void 0===(e=e[0])?null:e}function B(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var i=2*(r+1)-1,o=e[i],s=i+1,u=e[s];if(void 0!==o&&0>x(o,n))void 0!==u&&0>x(u,o)?(e[r]=u,e[s]=n,r=s):(e[r]=o,e[i]=n,r=i);else{if(!(void 0!==u&&0>x(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function x(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var S=[],k=[],Z=1,R=null,N=3,O=!1,W=!1,F=!1;function M(e){for(var t=G(k);null!==t;){if(null===t.callback)B(k);else{if(!(t.startTime<=e))break;B(k),t.sortIndex=t.expirationTime,w(S,t)}t=G(k)}}function V(e){if(F=!1,M(e),!W)if(null!==G(S))W=!0,r(T);else{var t=G(k);null!==t&&a(V,t.startTime-e)}}function T(e,n){W=!1,F&&(F=!1,i()),O=!0;var r=N;try{for(M(n),R=G(S);null!==R&&(!(R.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=R.callback;if("function"===typeof o){R.callback=null,N=R.priorityLevel;var s=o(R.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?R.callback=s:R===G(S)&&B(S),M(n)}else B(S);R=G(S)}if(null!==R)var u=!0;else{var c=G(k);null!==c&&a(V,c.startTime-n),u=!1}return u}finally{R=null,N=r,O=!1}}var E=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){W||O||(W=!0,r(T))},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return G(S)},t.unstable_next=function(e){switch(N){case 1:case 2:case 3:var t=3;break;default:t=N}var n=N;N=t;try{return e()}finally{N=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=E,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=N;N=e;try{return t()}finally{N=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:Z++,callback:n,priorityLevel:e,startTime:o,expirationTime:u=o+u,sortIndex:-1},o>s?(e.sortIndex=o,w(k,e),null===G(S)&&e===G(k)&&(F?i():F=!0,a(V,o-s))):(e.sortIndex=u,w(S,e),W||O||(W=!0,r(T))),e},t.unstable_wrapCallback=function(e){var t=N;return function(){var n=N;N=t;try{return e.apply(this,arguments)}finally{N=n}}}},function(e,t,n){"use strict";var r,a,i,o;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var u=Date,c=u.now();t.unstable_now=function(){return u.now()-c}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,g=null,d=function e(){if(null!==l)try{var n=t.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(e,0),r}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(d,0))},a=function(e,t){g=setTimeout(e,t)},i=function(){clearTimeout(g)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,f=window.clearTimeout;if("undefined"!==typeof console){var p=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var I=!1,C=null,m=-1,b=5,v=0;t.unstable_shouldYield=function(){return t.unstable_now()>=v},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<e?Math.floor(1e3/e):5};var A=new MessageChannel,y=A.port2;A.port1.onmessage=function(){if(null!==C){var e=t.unstable_now();v=e+b;try{C(!0,e)?y.postMessage(null):(I=!1,C=null)}catch(n){throw y.postMessage(null),n}}else I=!1},r=function(e){C=e,I||(I=!0,y.postMessage(null))},a=function(e,n){m=h((function(){e(t.unstable_now())}),n)},i=function(){f(m),m=-1}}function w(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<x(a,t)))break e;e[r]=t,e[n]=a,n=r}}function G(e){return void 0===(e=e[0])?null:e}function B(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var i=2*(r+1)-1,o=e[i],s=i+1,u=e[s];if(void 0!==o&&0>x(o,n))void 0!==u&&0>x(u,o)?(e[r]=u,e[s]=n,r=s):(e[r]=o,e[i]=n,r=i);else{if(!(void 0!==u&&0>x(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function x(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var S=[],k=[],Z=1,R=null,N=3,O=!1,W=!1,F=!1;function M(e){for(var t=G(k);null!==t;){if(null===t.callback)B(k);else{if(!(t.startTime<=e))break;B(k),t.sortIndex=t.expirationTime,w(S,t)}t=G(k)}}function V(e){if(F=!1,M(e),!W)if(null!==G(S))W=!0,r(T);else{var t=G(k);null!==t&&a(V,t.startTime-e)}}function T(e,n){W=!1,F&&(F=!1,i()),O=!0;var r=N;try{for(M(n),R=G(S);null!==R&&(!(R.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=R.callback;if("function"===typeof o){R.callback=null,N=R.priorityLevel;var s=o(R.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?R.callback=s:R===G(S)&&B(S),M(n)}else B(S);R=G(S)}if(null!==R)var u=!0;else{var c=G(k);null!==c&&a(V,c.startTime-n),u=!1}return u}finally{R=null,N=r,O=!1}}var E=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){W||O||(W=!0,r(T))},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return G(S)},t.unstable_next=function(e){switch(N){case 1:case 2:case 3:var t=3;break;default:t=N}var n=N;N=t;try{return e()}finally{N=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=E,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=N;N=e;try{return t()}finally{N=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:Z++,callback:n,priorityLevel:e,startTime:o,expirationTime:u=o+u,sortIndex:-1},o>s?(e.sortIndex=o,w(k,e),null===G(S)&&e===G(k)&&(F?i():F=!0,a(V,o-s))):(e.sortIndex=u,w(S,e),W||O||(W=!0,r(T))),e},t.unstable_wrapCallback=function(e){var t=N;return function(){var n=N;N=t;try{return e.apply(this,arguments)}finally{N=n}}}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),o=r[0],s=r[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,g=s>0?o-4:o;for(n=0;n<g;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===s&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===s&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],o=16383,s=0,u=n-a;s<u;s+=o)i.push(l(e,s,s+o>u?u:s+o));1===a?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],a=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],a[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var a,i,o=[],s=t;s<n;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(i=a)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,a){var i,o,s=8*a-r-1,u=(1<<s)-1,c=u>>1,l=-7,g=n?a-1:0,d=n?-1:1,h=e[t+g];for(g+=d,i=h&(1<<-l)-1,h>>=-l,l+=s;l>0;i=256*i+e[t+g],g+=d,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[t+g],g+=d,l-=8);if(0===i)i=1-c;else{if(i===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),i-=c}return(h?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,a,i){var o,s,u,c=8*i-a-1,l=(1<<c)-1,g=l>>1,d=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,f=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+g>=1?d/u:d*Math.pow(2,1-g))*u>=2&&(o++,u/=2),o+g>=l?(s=0,o=l):o+g>=1?(s=(t*u-1)*Math.pow(2,a),o+=g):(s=t*Math.pow(2,g-1)*Math.pow(2,a),o=0));a>=8;e[n+h]=255&s,h+=f,s/=256,a-=8);for(o=o<<a|s,c+=a;c>0;e[n+h]=255&o,h+=f,o/=256,c-=8);e[n+h-f]|=128*p}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(e){var t,r=n(1),a=n(9),i=n(36),o=function(){return n(430)};var s=function(){function s(){Object(r.a)(this,s),this.util=n(431),this.textEncoder=new this.util.TextEncoder}return Object(a.a)(s,[{key:"fetch",value:function(e,n){return null!=Object(i.b)().global.fetch?Object(i.b)().global.fetch(e,n):(null==t&&(t=o()),t(e,n))}},{key:"now",value:function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),s}();Object(i.b)().get("IS_NODE")&&Object(i.b)().setPlatform("node",new s)}).call(this,n(197))},,,function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n(102)&&n(159)?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e,n(102))}).call(this,n(149)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n(102)&&n(159)?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e,n(102))}).call(this,n(149)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n(102)&&n(159)?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e,n(102))}).call(this,n(149)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n(102)&&n(159)?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e,n(102))}).call(this,n(149)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n(102)&&n(159)?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e,n(102))}).call(this,n(149)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n(102)&&n(159)?void 0===(r=function(){return u}.call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e,n(102))}).call(this,n(149)(e))},function(e,t,n){var r;!function(a,i){var o,s=this,u=256,c=i.pow(u,6),l=i.pow(2,52),g=2*l,d=255;function h(e,t,n){var r=[],d=C(I((t=1==t?{entropy:!0}:t||{}).entropy?[e,m(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),m(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,m(a)]}}():e,3),r),h=new f(r),b=function(){for(var e=h.g(6),t=c,n=0;e<l;)e=(e+n)*u,t*=u,n=h.g(1);for(;e>=g;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|h.g(4)},b.quick=function(){return h.g(4)/4294967296},b.double=b,C(m(h.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&p(r,h),e.state=function(){return p(h,{})}),n?(i.random=e,t):e})(b,d,"global"in t?t.global:this==i,t.state)}function f(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<u;)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=d&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*u+o[d&(o[a]=o[i=d&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(u)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function I(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(I(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function C(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=h,C(i.random(),a),e.exports){e.exports=h;try{o=n(439)}catch(b){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}([],Math)},,function(e,t,n){(function(e){var r="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(a.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(a.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(441),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(148))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,a=1,i={},o=!1,s=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){l(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var e=s.documentElement;r=function(t){var n=s.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},u.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return i[a]=o,r(a),a++},u.clearImmediate=c}function c(e){delete i[e]}function l(e){if(o)setTimeout(l,0,e);else{var t=i[e];if(t){o=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{c(e),o=!1}}}}}("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,n(148),n(197))},,,function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(447);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(292).default,a=n(332);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?a(e):t},e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";var r=n(64);Object.defineProperty(t,"__esModule",{value:!0}),t.updateConfig=t.getConfig=t.DEFAULT_PROPS=void 0;var a=r(n(333)),i=n(160),o=n(280);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t,n=1;n<arguments.length;n++)t=null==arguments[n]?{}:arguments[n],n%2?s(Object(t),!0).forEach((function(n){(0,a.default)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}var c={value:0,minValue:0,maxValue:1e3,forceRender:!1,width:300,height:300,paddingHorizontal:0,paddingVertical:0,fluidWidth:!1,dimensionUnit:"px",segments:5,maxSegmentLabels:-1,customSegmentStops:[],customSegmentLabels:[],needleColor:"steelblue",startColor:"#FF471A",endColor:"#33CC33",segmentColors:[],needleTransition:n(281).Transition.easeQuadInOut,needleTransitionDuration:500,needleHeightRatio:.9,ringWidth:60,textColor:"#666",valueFormat:"",currentValueText:"${value}",currentValuePlaceholderStyle:"${value}",labelFontSize:"14px",valueTextFontSize:"16px",valueTextFontWeight:"bold"};t.DEFAULT_PROPS=c;var l={ringInset:20,pointerWidth:10,pointerTailLength:5,minAngle:-90,maxAngle:90,labelInset:10};t.getConfig=function(e){var t=e.PROPS,n=e.parentWidth,r=e.parentHeight,a={width:t.fluidWidth?n:t.width,height:t.fluidWidth?r:t.height,paddingHorizontal:t.paddingHorizontal,paddingVertical:t.paddingVertical,dimensionUnit:t.dimensionUnit,ringWidth:t.ringWidth,minValue:t.minValue,maxValue:t.maxValue,needleColor:t.needleColor,majorTicks:t.segments,customSegmentStops:t.customSegmentStops,customSegmentLabels:t.customSegmentLabels,maxSegmentLabels:(0,o.calculateSegmentLabelCount)({maxSegmentLabelCount:t.maxSegmentLabels,segmentCount:t.segments}),segmentColors:t.segmentColors,arcColorFn:0<t.segmentColors.length?(0,i.scaleQuantize)(t.segmentColors):(0,i.interpolateHsl)((0,i.rgb)(t.startColor),(0,i.rgb)(t.endColor)),needleTransition:t.needleTransition,needleTransitionDuration:t.needleTransitionDuration,needleHeightRatio:t.needleHeightRatio,textColor:t.textColor,labelFormat:(0,i.format)(t.valueFormat),currentValueText:t.currentValueText,currentValuePlaceholderStyle:t.currentValuePlaceholderStyle,labelFontSize:t.labelFontSize,valueTextFontSize:t.valueTextFontSize,valueTextFontWeight:t.valueTextFontWeight};return Object.assign({},l,a)};t.updateConfig=function(e,t){return u(u({},e),t)}},function(e,t,n){"use strict";n.r(t);var r=n(98),a=n(121);t.default=function(e){return"number"==typeof e||Object(a.a)(e)&&"[object Number]"==Object(r.a)(e)}},function(e,t,n){"use strict";n.r(t),t.default=function(e){return e&&e.length?e[0]:void 0}},function(e,t,n){"use strict";n.r(t),t.default=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){"use strict";n.r(t);var r=n(274),a=n(193);t.default=function(e,t,n){var i=null==e?0:e.length;return i?(t=n||void 0===t?1:Object(a.a)(t),Object(r.a)(e,t<0?0:t,i)):[]}},function(e,t,n){"use strict";n.r(t);var r=n(274),a=n(193);t.default=function(e,t,n){return e&&e.length?(t=n||void 0===t?1:Object(a.a)(t),Object(r.a)(e,0,t<0?0:t)):[]}},function(e,t,n){"use strict";var r=n(64);Object.defineProperty(t,"__esModule",{value:!0}),t._renderLabels=l,t.render=t.update=void 0;var a=n(160),i=r(n(335)),o=r(n(256)),s=n(280),u=n(457),c=n(458);t.update=function(e){var t=e.d3_refs,n=e.newValue,r=e.config,a=(0,c.configureScale)(r)(n),i=r.maxAngle-r.minAngle,o=r.minAngle+a*i;t.pointer.transition().duration(r.needleTransitionDuration).ease((0,u.getNeedleTransition)(r.needleTransition)).attr("transform","rotate(".concat(o,")")),t.current_value_text.text((0,s.formatCurrentValueText)(n,r))};function l(e){var t=e.config,n=e.svg,r=e.centerTx,a=e.r,u=(0,c.configureTicks)(t),l=(0,c.configureTickData)(t),g=(0,c.configureScale)(t),d=t.maxAngle-t.minAngle,h=t.customSegmentLabels,f=(0,o.default)(h)&&!(0,i.default)(h),p=f&&h.length===l.length;if(f&&!p)throw new Error("Custom Segment Labels should be an array with length of ".concat(l.length));f&&p?function(e){function t(e,t){var r=0===g.length?c(e):(0,s.sumArrayTill)(u,t);return n.minAngle+r*l}var n=e.config,r=e.svg,a=e.centerTx,i=e.r,o=e.ticks,u=e.tickData,c=e.scale,l=e.range,g=n.customSegmentStops,d=n.customSegmentLabels,h=d.map((function(e,n){var r=n,a=n+1,i=t(o[r],r);return(t(o[a],a)+i)/2})),f=i-n.ringWidth-n.ringInset,p=i-n.ringInset;r.append("g").attr("class","label").attr("transform",a).selectAll("text").data(d).enter().append("text").attr("transform",(function(e,t){var r=h[t],a="rotate(".concat(r,") translate(0, ").concat(n.labelInset-i,")"),o="rotate(".concat(r,") translate(0, ").concat(n.labelInset/2-(p-(p-f)/2),")");return"OUTSIDE"===e.position?a:o})).text((function(e){return e.text||""})).attr("class","segment-value").style("text-anchor","middle").style("font-size",(function(e){return e.fontSize||n.labelFontSize})).style("font-weight","bold").style("fill",(function(e){return e.color||n.textColor}))}({config:t,svg:n,centerTx:r,r:a,ticks:u,tickData:l,scale:g,range:d}):n.append("g").attr("class","label").attr("transform",r).selectAll("text").data(u).enter().append("text").attr("transform",(function(e,n){var r=0===t.customSegmentStops.length?g(e):(0,s.sumArrayTill)(l,n),i=t.minAngle+r*d;return"rotate(".concat(i,") translate(0, ").concat(t.labelInset-a,")")})).text(t.labelFormat).attr("class","segment-value").style("text-anchor","middle").style("font-size",t.labelFontSize).style("font-weight","bold").style("fill",t.textColor)}function g(e){var t=e.config,n=e.svg,r=(t.width+2*t.paddingHorizontal)/2,a=(t.width+4*t.paddingVertical)/2;return n.append("g").attr("transform","translate(".concat(r,", ").concat(a,")")).append("text").attr("class","current-value").attr("text-anchor","middle").attr("y",23).text(t.currentValue).style("font-size",t.valueTextFontSize).style("font-weight",t.valueTextFontWeight).style("fill",t.textColor)}function d(e){var t=e.config,n=e.svg,r=e.r,i=e.centerTx,o=(0,s.calculateNeedleHeight)({heightRatio:t.needleHeightRatio,radius:r}),u=[[t.pointerWidth/2,0],[0,-o],[-t.pointerWidth/2,0],[0,t.pointerTailLength],[t.pointerWidth/2,0]],c=(0,a.line)().curve(a.curveMonotoneX);return n.append("g").data([u]).attr("class","pointer").attr("transform",i).style("fill",t.needleColor).append("path").attr("d",c).attr("transform","rotate(".concat(t.minAngle,")"))}t.render=function(e){var t=e.container,n=e.config,r=(0,s.getRadius)(n),o=(0,s.centerTranslation)(r,n.paddingHorizontal,n.paddingVertical),u=function(e){var t=e.container,n=e.config,r=n.width+2*n.paddingHorizontal,i=n.height+2*n.paddingVertical;return(0,a.select)(t).append("svg:svg").attr("class","speedometer").attr("width","".concat(r).concat(n.dimensionUnit)).attr("height","".concat(i).concat(n.dimensionUnit)).style("width","".concat(r).concat(n.dimensionUnit)).style("height","".concat(i).concat(n.dimensionUnit))}({container:t,config:n});return function(e){var t=e.config,n=e.svg,r=e.centerTx,a=(0,c.configureTickData)(t),o=(0,c.configureArc)(t);n.append("g").attr("class","arc").attr("transform",r).selectAll("path").data(a).enter().append("path").attr("class","speedo-segment").attr("fill",(function(e,n){return!(0,i.default)(t.segmentColors)&&t.segmentColors[n]?t.segmentColors[n]:t.arcColorFn(e*n)})).attr("d",o)}({config:n,svg:u,centerTx:o}),l({config:n,svg:u,centerTx:o,r:r}),{current_value_text:g({config:n,svg:u}),pointer:d({config:n,svg:u,r:r,centerTx:o})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNeedleTransition=function(e){return e===a.Transition.easeLinear?r.easeLinear:e===a.Transition.easeQuadIn?r.easeQuadIn:e===a.Transition.easeQuadOut?r.easeQuadOut:e===a.Transition.easeQuadInOut?r.easeQuadInOut:e===a.Transition.easeCubicIn?r.easeCubicIn:e===a.Transition.easeCubicOut?r.easeCubicOut:e===a.Transition.easeCubicInOut?r.easeCubicInOut:e===a.Transition.easePolyIn?r.easePolyIn:e===a.Transition.easePolyOut?r.easePolyOut:e===a.Transition.easePolyInOut?r.easePolyInOut:e===a.Transition.easeSinIn?r.easeSinIn:e===a.Transition.easeSinOut?r.easeSinOut:e===a.Transition.easeSinInOut?r.easeSinInOut:e===a.Transition.easeExpIn?r.easeExpIn:e===a.Transition.easeExpOut?r.easeExpOut:e===a.Transition.easeExpInOut?r.easeExpInOut:e===a.Transition.easeCircleIn?r.easeCircleIn:e===a.Transition.easeCircleOut?r.easeCircleOut:e===a.Transition.easeCircleInOut?r.easeCircleInOut:e===a.Transition.easeBounceIn?r.easeBounceIn:e===a.Transition.easeBounceOut?r.easeBounceOut:e===a.Transition.easeBounceInOut?r.easeBounceInOut:e===a.Transition.easeBackIn?r.easeBackIn:e===a.Transition.easeBackOut?r.easeBackOut:e===a.Transition.easeBackInOut?r.easeBackInOut:e===a.Transition.easeElasticIn?r.easeElasticIn:e===a.Transition.easeElasticOut?r.easeElasticOut:e===a.Transition.easeElasticInOut?r.easeElasticInOut:e===a.Transition.easeElastic?r.easeElastic:r.easeQuadInOut};var r=n(160),a=n(281)},function(e,t,n){"use strict";var r=n(64);Object.defineProperty(t,"__esModule",{value:!0}),t.configureArc=t.configureTickData=t.configureTicks=t.configureScale=void 0;var a=r(n(294)),i=n(160),o=n(280),s=(0,a.default)((function(e){return(0,o.calculateScale)({min:e.minValue,max:e.maxValue,segments:e.maxSegmentLabels})}));t.configureScale=s;var u=(0,a.default)((function(e){var t=s(e),n=(0,o.calculateTicks)(t,{min:e.minValue,max:e.maxValue,segments:e.maxSegmentLabels});return 0<e.customSegmentStops.length&&0!==e.maxSegmentLabels&&(n=e.customSegmentStops),n}));t.configureTicks=u;var c=(0,a.default)((function(e){var t=(0,i.range)(e.majorTicks).map((function(){return 1/e.majorTicks}));return(0,o.calculateSegmentStops)({tickData:t,customSegmentStops:e.customSegmentStops,min:e.minValue,max:e.maxValue})}));t.configureTickData=c;var l=(0,a.default)((function(e){var t=c(e),n=e.maxAngle-e.minAngle,r=e.width/2;return(0,i.arc)().innerRadius(r-e.ringWidth-e.ringInset).outerRadius(r-e.ringInset).startAngle((function(r,a){var i=(0,o.sumArrayTill)(t,a);return(0,o.deg2rad)(e.minAngle+i*n)})).endAngle((function(r,a){var i=(0,o.sumArrayTill)(t,a+1);return(0,o.deg2rad)(e.minAngle+i*n)}))}));t.configureArc=l},,function(e,t,n){"use strict";n.r(t),n.d(t,"capitalize",(function(){return r.a})),n.d(t,"createChainedFunction",(function(){return a.a})),n.d(t,"createSvgIcon",(function(){return h})),n.d(t,"debounce",(function(){return f.a})),n.d(t,"deprecatedPropType",(function(){return p})),n.d(t,"isMuiElement",(function(){return I})),n.d(t,"ownerDocument",(function(){return C.a})),n.d(t,"ownerWindow",(function(){return m.a})),n.d(t,"requirePropFactory",(function(){return b})),n.d(t,"setRef",(function(){return v.a})),n.d(t,"unsupportedProp",(function(){return A})),n.d(t,"useControlled",(function(){return y.a})),n.d(t,"useEventCallback",(function(){return w.a})),n.d(t,"useForkRef",(function(){return G.a})),n.d(t,"unstable_useId",(function(){return B.a})),n.d(t,"useIsFocusVisible",(function(){return x.a}));var r=n(57),a=n(142),i=n(25),o=n(2),s=n.n(o),u=n(38),c=(n(52),n(48)),l=n(56),g=o.forwardRef((function(e,t){var n=e.children,a=e.classes,s=e.className,l=e.color,g=void 0===l?"inherit":l,d=e.component,h=void 0===d?"svg":d,f=e.fontSize,p=void 0===f?"default":f,I=e.htmlColor,C=e.titleAccess,m=e.viewBox,b=void 0===m?"0 0 24 24":m,v=Object(u.a)(e,["children","classes","className","color","component","fontSize","htmlColor","titleAccess","viewBox"]);return o.createElement(h,Object(i.a)({className:Object(c.a)(a.root,s,"inherit"!==g&&a["color".concat(Object(r.a)(g))],"default"!==p&&a["fontSize".concat(Object(r.a)(p))]),focusable:"false",viewBox:b,color:I,"aria-hidden":!C||void 0,role:C?"img":void 0,ref:t},v),n,C?o.createElement("title",null,C):null)}));g.muiName="SvgIcon";var d=Object(l.a)((function(e){return{root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:e.typography.pxToRem(24),transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(35)}}}),{name:"MuiSvgIcon"})(g);function h(e,t){var n=function(t,n){return s.a.createElement(d,Object(i.a)({ref:n},t),e)};return n.muiName=d.muiName,s.a.memo(s.a.forwardRef(n))}var f=n(217);function p(e,t){return function(){return null}}function I(e,t){return o.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}var C=n(81),m=n(218);function b(e){return function(){return null}}var v=n(105);function A(e,t,n,r,a){return null}var y=n(164),w=n(66),G=n(51),B=n(216),x=n(131)},function(e,t,n){"use strict";n.r(t);var r=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},a=n(273);var i=function(e){return"function"==typeof e?e:a.a},o=n(193),s=4294967295,u=Math.min;t.default=function(e,t){if((e=Object(o.a)(e))<1||e>9007199254740991)return[];var n=s,a=u(e,s);t=i(t),e-=s;for(var c=r(a,t);++n<e;)t(n);return c}},function(e,t,n){"use strict";n.r(t);var r=function(e,t){for(var n,r=-1,a=e.length;++r<a;){var i=t(e[r]);void 0!==i&&(n=void 0===n?i:n+i)}return n},a=n(273);t.default=function(e){return e&&e.length?r(e,a.a):0}},function(e,t,n){"use strict";var r=n(38),a=n(25),i=n(2),o=(n(52),n(48)),s=n(56),u=i.forwardRef((function(e,t){var n=e.classes,s=e.className,u=e.component,c=void 0===u?"div":u,l=e.square,g=void 0!==l&&l,d=e.elevation,h=void 0===d?1:d,f=e.variant,p=void 0===f?"elevation":f,I=Object(r.a)(e,["classes","className","component","square","elevation","variant"]);return i.createElement(c,Object(a.a)({className:Object(o.a)(n.root,s,"outlined"===p?n.outlined:n["elevation".concat(h)],!g&&n.rounded),ref:t},I))}));t.a=Object(s.a)((function(e){var t={};return e.shadows.forEach((function(e,n){t["elevation".concat(n)]={boxShadow:e}})),Object(a.a)({root:{backgroundColor:e.palette.background.paper,color:e.palette.text.primary,transition:e.transitions.create("box-shadow")},rounded:{borderRadius:e.shape.borderRadius},outlined:{border:"1px solid ".concat(e.palette.divider)}},t)}),{name:"MuiPaper"})(u)},function(e,t,n){"use strict";var r=n(25),a=n(38),i=n(2),o=(n(52),n(48)),s=n(56),u=n(396),c=i.forwardRef((function(e,t){var n=e.children,s=e.classes,c=e.className,l=e.invisible,g=void 0!==l&&l,d=e.open,h=e.transitionDuration,f=e.TransitionComponent,p=void 0===f?u.a:f,I=Object(a.a)(e,["children","classes","className","invisible","open","transitionDuration","TransitionComponent"]);return i.createElement(p,Object(r.a)({in:d,timeout:h},I),i.createElement("div",{className:Object(o.a)(s.root,c,g&&s.invisible),"aria-hidden":!0,ref:t},n))}));t.a=Object(s.a)({root:{zIndex:-1,position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},invisible:{backgroundColor:"transparent"}},{name:"MuiBackdrop"})(c)},function(e,t,n){"use strict";var r=n(38),a=n(25),i=n(2),o=n(62),s=(n(52),n(395)),u=n(499),c=n(81),l=n(496),g=n(142),d=n(51),h=n(66),f=n(262);var p=n(196),I=n(123);var C=n(218);function m(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function b(e){return parseInt(window.getComputedStyle(e)["padding-right"],10)||0}function v(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4?arguments[4]:void 0,i=[t,n].concat(Object(I.a)(r)),o=["TEMPLATE","SCRIPT","STYLE"];[].forEach.call(e.children,(function(e){1===e.nodeType&&-1===i.indexOf(e)&&-1===o.indexOf(e.tagName)&&m(e,a)}))}function A(e,t){var n=-1;return e.some((function(e,r){return!!t(e)&&(n=r,!0)})),n}function y(e,t){var n,r=[],a=[],i=e.container;if(!t.disableScrollLock){if(function(e){var t=Object(c.a)(e);return t.body===e?Object(C.a)(t).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(i)){var o=function(){var e=document.createElement("div");e.style.width="99px",e.style.height="99px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}();r.push({value:i.style.paddingRight,key:"padding-right",el:i}),i.style["padding-right"]="".concat(b(i)+o,"px"),n=Object(c.a)(i).querySelectorAll(".mui-fixed"),[].forEach.call(n,(function(e){a.push(e.style.paddingRight),e.style.paddingRight="".concat(b(e)+o,"px")}))}var s=i.parentElement,u="HTML"===s.nodeName&&"scroll"===window.getComputedStyle(s)["overflow-y"]?s:i;r.push({value:u.style.overflow,key:"overflow",el:u}),u.style.overflow="hidden"}return function(){n&&[].forEach.call(n,(function(e,t){a[t]?e.style.paddingRight=a[t]:e.style.removeProperty("padding-right")})),r.forEach((function(e){var t=e.value,n=e.el,r=e.key;t?n.style.setProperty(r,t):n.style.removeProperty(r)}))}}var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.modals=[],this.containers=[]}return Object(p.a)(e,[{key:"add",value:function(e,t){var n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&m(e.modalRef,!1);var r=function(e){var t=[];return[].forEach.call(e.children,(function(e){e.getAttribute&&"true"===e.getAttribute("aria-hidden")&&t.push(e)})),t}(t);v(t,e.mountNode,e.modalRef,r,!0);var a=A(this.containers,(function(e){return e.container===t}));return-1!==a?(this.containers[a].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblingNodes:r}),n)}},{key:"mount",value:function(e,t){var n=A(this.containers,(function(t){return-1!==t.modals.indexOf(e)})),r=this.containers[n];r.restore||(r.restore=y(r,t))}},{key:"remove",value:function(e){var t=this.modals.indexOf(e);if(-1===t)return t;var n=A(this.containers,(function(t){return-1!==t.modals.indexOf(e)})),r=this.containers[n];if(r.modals.splice(r.modals.indexOf(e),1),this.modals.splice(t,1),0===r.modals.length)r.restore&&r.restore(),e.modalRef&&m(e.modalRef,!0),v(r.container,e.mountNode,e.modalRef,r.hiddenSiblingNodes,!1),this.containers.splice(n,1);else{var a=r.modals[r.modals.length-1];a.modalRef&&m(a.modalRef,!1)}return t}},{key:"isTopModal",value:function(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}]),e}();var G=function(e){var t=e.children,n=e.disableAutoFocus,r=void 0!==n&&n,a=e.disableEnforceFocus,s=void 0!==a&&a,u=e.disableRestoreFocus,l=void 0!==u&&u,g=e.getDoc,h=e.isEnabled,f=e.open,p=i.useRef(),I=i.useRef(null),C=i.useRef(null),m=i.useRef(),b=i.useRef(null),v=i.useCallback((function(e){b.current=o.findDOMNode(e)}),[]),A=Object(d.a)(t.ref,v),y=i.useRef();return i.useEffect((function(){y.current=f}),[f]),!y.current&&f&&"undefined"!==typeof window&&(m.current=g().activeElement),i.useEffect((function(){if(f){var e=Object(c.a)(b.current);r||!b.current||b.current.contains(e.activeElement)||(b.current.hasAttribute("tabIndex")||b.current.setAttribute("tabIndex",-1),b.current.focus());var t=function(){null!==b.current&&(e.hasFocus()&&!s&&h()&&!p.current?b.current&&!b.current.contains(e.activeElement)&&b.current.focus():p.current=!1)},n=function(t){!s&&h()&&9===t.keyCode&&e.activeElement===b.current&&(p.current=!0,t.shiftKey?C.current.focus():I.current.focus())};e.addEventListener("focus",t,!0),e.addEventListener("keydown",n,!0);var a=setInterval((function(){t()}),50);return function(){clearInterval(a),e.removeEventListener("focus",t,!0),e.removeEventListener("keydown",n,!0),l||(m.current&&m.current.focus&&m.current.focus(),m.current=null)}}}),[r,s,l,h,f]),i.createElement(i.Fragment,null,i.createElement("div",{tabIndex:0,ref:I,"data-test":"sentinelStart"}),i.cloneElement(t,{ref:A}),i.createElement("div",{tabIndex:0,ref:C,"data-test":"sentinelEnd"}))},B={root:{zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},invisible:{backgroundColor:"transparent"}},x=i.forwardRef((function(e,t){var n=e.invisible,o=void 0!==n&&n,s=e.open,u=Object(r.a)(e,["invisible","open"]);return s?i.createElement("div",Object(a.a)({"aria-hidden":!0,ref:t},u,{style:Object(a.a)({},B.root,o?B.invisible:{},u.style)})):null}));var S=new w,k=i.forwardRef((function(e,t){var n=Object(s.a)(),p=Object(u.a)({name:"MuiModal",props:Object(a.a)({},e),theme:n}),I=p.BackdropComponent,C=void 0===I?x:I,b=p.BackdropProps,v=p.children,A=p.closeAfterTransition,y=void 0!==A&&A,w=p.container,B=p.disableAutoFocus,k=void 0!==B&&B,Z=p.disableBackdropClick,R=void 0!==Z&&Z,N=p.disableEnforceFocus,O=void 0!==N&&N,W=p.disableEscapeKeyDown,F=void 0!==W&&W,M=p.disablePortal,V=void 0!==M&&M,T=p.disableRestoreFocus,E=void 0!==T&&T,j=p.disableScrollLock,L=void 0!==j&&j,X=p.hideBackdrop,H=void 0!==X&&X,Y=p.keepMounted,z=void 0!==Y&&Y,K=p.manager,_=void 0===K?S:K,D=p.onBackdropClick,P=p.onClose,U=p.onEscapeKeyDown,J=p.onRendered,Q=p.open,q=Object(r.a)(p,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),$=i.useState(!0),ee=$[0],te=$[1],ne=i.useRef({}),re=i.useRef(null),ae=i.useRef(null),ie=Object(d.a)(ae,t),oe=function(e){return!!e.children&&e.children.props.hasOwnProperty("in")}(p),se=function(){return Object(c.a)(re.current)},ue=function(){return ne.current.modalRef=ae.current,ne.current.mountNode=re.current,ne.current},ce=function(){_.mount(ue(),{disableScrollLock:L}),ae.current.scrollTop=0},le=Object(h.a)((function(){var e=function(e){return e="function"===typeof e?e():e,o.findDOMNode(e)}(w)||se().body;_.add(ue(),e),ae.current&&ce()})),ge=i.useCallback((function(){return _.isTopModal(ue())}),[_]),de=Object(h.a)((function(e){re.current=e,e&&(J&&J(),Q&&ge()?ce():m(ae.current,!0))})),he=i.useCallback((function(){_.remove(ue())}),[_]);if(i.useEffect((function(){return function(){he()}}),[he]),i.useEffect((function(){Q?le():oe&&y||he()}),[Q,he,oe,y,le]),!z&&!Q&&(!oe||ee))return null;var fe=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}}(n||{zIndex:f.a}),pe={};return void 0===v.props.tabIndex&&(pe.tabIndex=v.props.tabIndex||"-1"),oe&&(pe.onEnter=Object(g.a)((function(){te(!1)}),v.props.onEnter),pe.onExited=Object(g.a)((function(){te(!0),y&&he()}),v.props.onExited)),i.createElement(l.a,{ref:de,container:w,disablePortal:V},i.createElement("div",Object(a.a)({ref:ie,onKeyDown:function(e){"Escape"===e.key&&ge()&&(U&&U(e),F||(e.stopPropagation(),P&&P(e,"escapeKeyDown")))},role:"presentation"},q,{style:Object(a.a)({},fe.root,!Q&&ee?fe.hidden:{},q.style)}),H?null:i.createElement(C,Object(a.a)({open:Q,onClick:function(e){e.target===e.currentTarget&&(D&&D(e),!R&&P&&P(e,"backdropClick"))}},b)),i.createElement(G,{disableEnforceFocus:O,disableAutoFocus:k,disableRestoreFocus:E,getDoc:se,isEnabled:ge,open:Q},i.cloneElement(v,pe))))}));t.a=k},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(2),a=n(62),i=(n(52),n(105)),o=n(51);var s="undefined"!==typeof window?r.useLayoutEffect:r.useEffect,u=r.forwardRef((function(e,t){var n=e.children,u=e.container,c=e.disablePortal,l=void 0!==c&&c,g=e.onRendered,d=r.useState(null),h=d[0],f=d[1],p=Object(o.a)(r.isValidElement(n)?n.ref:null,t);return s((function(){l||f(function(e){return e="function"===typeof e?e():e,a.findDOMNode(e)}(u)||document.body)}),[u,l]),s((function(){if(h&&!l)return Object(i.a)(t,h),function(){Object(i.a)(t,null)}}),[t,h,l]),s((function(){g&&(h||l)&&g()}),[g,h,l]),l?r.isValidElement(n)?r.cloneElement(n,{ref:p}):n:h?a.createPortal(n,h):h}));t.a=u},function(e,t,n){"use strict";var r=n(25),a=n(124),i=n(38),o=n(2),s=(n(52),n(398)),u=n(106),c=n(110),l=n(51);function g(e){return"scale(".concat(e,", ").concat(Math.pow(e,2),")")}var d={entering:{opacity:1,transform:g(1)},entered:{opacity:1,transform:"none"}},h=o.forwardRef((function(e,t){var n=e.children,h=e.disableStrictModeCompat,f=void 0!==h&&h,p=e.in,I=e.onEnter,C=e.onEntered,m=e.onEntering,b=e.onExit,v=e.onExited,A=e.onExiting,y=e.style,w=e.timeout,G=void 0===w?"auto":w,B=e.TransitionComponent,x=void 0===B?s.a:B,S=Object(i.a)(e,["children","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),k=o.useRef(),Z=o.useRef(),R=Object(u.a)(),N=R.unstable_strictMode&&!f,O=o.useRef(null),W=Object(l.a)(n.ref,t),F=Object(l.a)(N?O:void 0,W),M=function(e){return function(t,n){if(e){var r=N?[O.current,t]:[t,n],i=Object(a.a)(r,2),o=i[0],s=i[1];void 0===s?e(o):e(o,s)}}},V=M(m),T=M((function(e,t){Object(c.b)(e);var n,r=Object(c.a)({style:y,timeout:G},{mode:"enter"}),a=r.duration,i=r.delay;"auto"===G?(n=R.transitions.getAutoHeightDuration(e.clientHeight),Z.current=n):n=a,e.style.transition=[R.transitions.create("opacity",{duration:n,delay:i}),R.transitions.create("transform",{duration:.666*n,delay:i})].join(","),I&&I(e,t)})),E=M(C),j=M(A),L=M((function(e){var t,n=Object(c.a)({style:y,timeout:G},{mode:"exit"}),r=n.duration,a=n.delay;"auto"===G?(t=R.transitions.getAutoHeightDuration(e.clientHeight),Z.current=t):t=r,e.style.transition=[R.transitions.create("opacity",{duration:t,delay:a}),R.transitions.create("transform",{duration:.666*t,delay:a||.333*t})].join(","),e.style.opacity="0",e.style.transform=g(.75),b&&b(e)})),X=M(v);return o.useEffect((function(){return function(){clearTimeout(k.current)}}),[]),o.createElement(x,Object(r.a)({appear:!0,in:p,nodeRef:N?O:void 0,onEnter:T,onEntered:E,onEntering:V,onExit:L,onExited:X,onExiting:j,addEndListener:function(e,t){var n=N?e:t;"auto"===G&&(k.current=setTimeout(n,Z.current||0))},timeout:"auto"===G?null:G},S),(function(e,t){return o.cloneElement(n,Object(r.a)({style:Object(r.a)({opacity:0,transform:g(.75),visibility:"exited"!==e||p?void 0:"hidden"},d[e],y,n.props.style),ref:F},t))}))}));h.muiSupportAuto=!0,t.a=h},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(25),a=n(202);function i(e){return e&&"object"===Object(a.a)(e)&&e.constructor===Object}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},a=n.clone?Object(r.a)({},e):e;return i(e)&&i(t)&&Object.keys(t).forEach((function(r){"__proto__"!==r&&(i(t[r])&&r in e?a[r]=o(e[r],t[r],n):a[r]=t[r])})),a}},function(e,t,n){"use strict";function r(e){var t=e.theme,n=e.name,r=e.props;if(!t||!t.props||!t.props[n])return r;var a,i=t.props[n];for(a in i)void 0===r[a]&&(r[a]=i[a]);return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r=n(38),a=n(25),i=n(2),o=(n(52),n(48)),s=n(56),u=n(58),c=n(397),l=n(57),g=i.forwardRef((function(e,t){var n=e.children,s=e.classes,u=e.className,g=e.color,d=void 0===g?"default":g,h=e.component,f=void 0===h?"button":h,p=e.disabled,I=void 0!==p&&p,C=e.disableElevation,m=void 0!==C&&C,b=e.disableFocusRipple,v=void 0!==b&&b,A=e.endIcon,y=e.focusVisibleClassName,w=e.fullWidth,G=void 0!==w&&w,B=e.size,x=void 0===B?"medium":B,S=e.startIcon,k=e.type,Z=void 0===k?"button":k,R=e.variant,N=void 0===R?"text":R,O=Object(r.a)(e,["children","classes","className","color","component","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"]),W=S&&i.createElement("span",{className:Object(o.a)(s.startIcon,s["iconSize".concat(Object(l.a)(x))])},S),F=A&&i.createElement("span",{className:Object(o.a)(s.endIcon,s["iconSize".concat(Object(l.a)(x))])},A);return i.createElement(c.a,Object(a.a)({className:Object(o.a)(s.root,s[N],u,"inherit"===d?s.colorInherit:"default"!==d&&s["".concat(N).concat(Object(l.a)(d))],"medium"!==x&&[s["".concat(N,"Size").concat(Object(l.a)(x))],s["size".concat(Object(l.a)(x))]],m&&s.disableElevation,I&&s.disabled,G&&s.fullWidth),component:f,disabled:I,focusRipple:!v,focusVisibleClassName:Object(o.a)(s.focusVisible,y),ref:t,type:Z},O),i.createElement("span",{className:s.label},W,n,F))}));t.a=Object(s.a)((function(e){return{root:Object(a.a)({},e.typography.button,{boxSizing:"border-box",minWidth:64,padding:"6px 16px",borderRadius:e.shape.borderRadius,color:e.palette.text.primary,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none",backgroundColor:Object(u.b)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"},"&$disabled":{backgroundColor:"transparent"}},"&$disabled":{color:e.palette.action.disabled}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},text:{padding:"6px 8px"},textPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(u.b)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},textSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(u.b)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlined:{padding:"5px 15px",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$disabled":{border:"1px solid ".concat(e.palette.action.disabledBackground)}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(Object(u.b)(e.palette.primary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.primary.main),backgroundColor:Object(u.b)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(Object(u.b)(e.palette.secondary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.secondary.main),backgroundColor:Object(u.b)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{border:"1px solid ".concat(e.palette.action.disabled)}},contained:{color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],boxShadow:e.shadows[2],"&:hover":{backgroundColor:e.palette.grey.A100,boxShadow:e.shadows[4],"@media (hover: none)":{boxShadow:e.shadows[2],backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},"&$focusVisible":{boxShadow:e.shadows[6]},"&:active":{boxShadow:e.shadows[8]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}},containedPrimary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},containedSecondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},disableElevation:{boxShadow:"none","&:hover":{boxShadow:"none"},"&$focusVisible":{boxShadow:"none"},"&:active":{boxShadow:"none"},"&$disabled":{boxShadow:"none"}},focusVisible:{},disabled:{},colorInherit:{color:"inherit",borderColor:"currentColor"},textSizeSmall:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},textSizeLarge:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},outlinedSizeSmall:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},outlinedSizeLarge:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},containedSizeSmall:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},containedSizeLarge:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},sizeSmall:{},sizeLarge:{},fullWidth:{width:"100%"},startIcon:{display:"inherit",marginRight:8,marginLeft:-4,"&$iconSizeSmall":{marginLeft:-2}},endIcon:{display:"inherit",marginRight:-4,marginLeft:8,"&$iconSizeSmall":{marginRight:-2}},iconSizeSmall:{"& > *:first-child":{fontSize:18}},iconSizeMedium:{"& > *:first-child":{fontSize:20}},iconSizeLarge:{"& > *:first-child":{fontSize:22}}}}),{name:"MuiButton"})(g)},function(e,t,n){"use strict";var r=n(25),a=n(38),i=n(83),o=n(2),s=(n(52),n(48)),u=n(56),c=n(57),l=n(465),g=n(464),d=n(396),h=n(90),f=n(463),p={enter:h.b.enteringScreen,exit:h.b.leavingScreen},I=o.forwardRef((function(e,t){var n=e.BackdropProps,i=e.children,u=e.classes,h=e.className,I=e.disableBackdropClick,C=void 0!==I&&I,m=e.disableEscapeKeyDown,b=void 0!==m&&m,v=e.fullScreen,A=void 0!==v&&v,y=e.fullWidth,w=void 0!==y&&y,G=e.maxWidth,B=void 0===G?"sm":G,x=e.onBackdropClick,S=e.onClose,k=e.onEnter,Z=e.onEntered,R=e.onEntering,N=e.onEscapeKeyDown,O=e.onExit,W=e.onExited,F=e.onExiting,M=e.open,V=e.PaperComponent,T=void 0===V?f.a:V,E=e.PaperProps,j=void 0===E?{}:E,L=e.scroll,X=void 0===L?"paper":L,H=e.TransitionComponent,Y=void 0===H?d.a:H,z=e.transitionDuration,K=void 0===z?p:z,_=e.TransitionProps,D=e["aria-describedby"],P=e["aria-labelledby"],U=Object(a.a)(e,["BackdropProps","children","classes","className","disableBackdropClick","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClose","onEnter","onEntered","onEntering","onEscapeKeyDown","onExit","onExited","onExiting","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps","aria-describedby","aria-labelledby"]),J=o.useRef();return o.createElement(l.a,Object(r.a)({className:Object(s.a)(u.root,h),BackdropComponent:g.a,BackdropProps:Object(r.a)({transitionDuration:K},n),closeAfterTransition:!0,disableBackdropClick:C,disableEscapeKeyDown:b,onEscapeKeyDown:N,onClose:S,open:M,ref:t},U),o.createElement(Y,Object(r.a)({appear:!0,in:M,timeout:K,onEnter:k,onEntering:R,onEntered:Z,onExit:O,onExiting:F,onExited:W,role:"none presentation"},_),o.createElement("div",{className:Object(s.a)(u.container,u["scroll".concat(Object(c.a)(X))]),onMouseUp:function(e){e.target===e.currentTarget&&e.target===J.current&&(J.current=null,x&&x(e),!C&&S&&S(e,"backdropClick"))},onMouseDown:function(e){J.current=e.target}},o.createElement(T,Object(r.a)({elevation:24,role:"dialog","aria-describedby":D,"aria-labelledby":P},j,{className:Object(s.a)(u.paper,u["paperScroll".concat(Object(c.a)(X))],u["paperWidth".concat(Object(c.a)(String(B)))],j.className,A&&u.paperFullScreen,w&&u.paperFullWidth)}),i))))}));t.a=Object(u.a)((function(e){return{root:{"@media print":{position:"absolute !important"}},scrollPaper:{display:"flex",justifyContent:"center",alignItems:"center"},scrollBody:{overflowY:"auto",overflowX:"hidden",textAlign:"center","&:after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}},container:{height:"100%","@media print":{height:"auto"},outline:0},paper:{margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},paperScrollPaper:{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},paperScrollBody:{display:"inline-block",verticalAlign:"middle",textAlign:"left"},paperWidthFalse:{maxWidth:"calc(100% - 64px)"},paperWidthXs:{maxWidth:Math.max(e.breakpoints.values.xs,444),"&$paperScrollBody":Object(i.a)({},e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+64),{maxWidth:"calc(100% - 64px)"})},paperWidthSm:{maxWidth:e.breakpoints.values.sm,"&$paperScrollBody":Object(i.a)({},e.breakpoints.down(e.breakpoints.values.sm+64),{maxWidth:"calc(100% - 64px)"})},paperWidthMd:{maxWidth:e.breakpoints.values.md,"&$paperScrollBody":Object(i.a)({},e.breakpoints.down(e.breakpoints.values.md+64),{maxWidth:"calc(100% - 64px)"})},paperWidthLg:{maxWidth:e.breakpoints.values.lg,"&$paperScrollBody":Object(i.a)({},e.breakpoints.down(e.breakpoints.values.lg+64),{maxWidth:"calc(100% - 64px)"})},paperWidthXl:{maxWidth:e.breakpoints.values.xl,"&$paperScrollBody":Object(i.a)({},e.breakpoints.down(e.breakpoints.values.xl+64),{maxWidth:"calc(100% - 64px)"})},paperFullWidth:{width:"calc(100% - 64px)"},paperFullScreen:{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,"&$paperScrollBody":{margin:0,maxWidth:"100%"}}}}),{name:"MuiDialog"})(I)},function(e,t,n){"use strict";var r=n(25),a=n(38),i=n(2),o=(n(52),n(48)),s=n(56),u=n(58),c=n(397),l=n(57),g=i.forwardRef((function(e,t){var n=e.edge,s=void 0!==n&&n,u=e.children,g=e.classes,d=e.className,h=e.color,f=void 0===h?"default":h,p=e.disabled,I=void 0!==p&&p,C=e.disableFocusRipple,m=void 0!==C&&C,b=e.size,v=void 0===b?"medium":b,A=Object(a.a)(e,["edge","children","classes","className","color","disabled","disableFocusRipple","size"]);return i.createElement(c.a,Object(r.a)({className:Object(o.a)(g.root,d,"default"!==f&&g["color".concat(Object(l.a)(f))],I&&g.disabled,"small"===v&&g["size".concat(Object(l.a)(v))],{start:g.edgeStart,end:g.edgeEnd}[s]),centerRipple:!0,focusRipple:!m,disabled:I,ref:t},A),i.createElement("span",{className:g.label},u))}));t.a=Object(s.a)((function(e){return{root:{textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:12,borderRadius:"50%",overflow:"visible",color:e.palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{backgroundColor:Object(u.b)(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{backgroundColor:"transparent",color:e.palette.action.disabled}},edgeStart:{marginLeft:-12,"$sizeSmall&":{marginLeft:-3}},edgeEnd:{marginRight:-12,"$sizeSmall&":{marginRight:-3}},colorInherit:{color:"inherit"},colorPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(u.b)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},colorSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(u.b)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},disabled:{},sizeSmall:{padding:3,fontSize:e.typography.pxToRem(18)},label:{width:"100%",display:"flex",alignItems:"inherit",justifyContent:"inherit"}}}),{name:"MuiIconButton"})(g)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(21),a=n(3),i=n(1),o=n(12),s=n(13),u=n(2),c=n(47),l=n(15),g=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.call(this,{uniforms:{time:{value:0},fade:{value:1}},vertexShader:"\n      uniform float time;\n      attribute float size;\n      varying vec3 vColor;\n      void main() {\n        vColor = color;\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(mvPosition.x + 2.0 * time + 100.0));\n        gl_Position = projectionMatrix * mvPosition;\n      }",fragmentShader:"\n      uniform sampler2D pointTexture;\n      uniform float fade;\n      varying vec3 vColor;\n      void main() {\n        float opacity = 1.0;\n        if (fade == 1.0) {\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\n        }\n        gl_FragColor = vec4(vColor, opacity);\n      }"})}return n}(l.ShaderMaterial),d=function(e){return(new l.Vector3).setFromSpherical(new l.Spherical(e,Math.acos(1-2*Math.random()),2*Math.random()*Math.PI))},h=u.forwardRef((function(e,t){var n=e.radius,i=void 0===n?100:n,o=e.depth,s=void 0===o?50:o,h=e.count,f=void 0===h?5e3:h,p=e.saturation,I=void 0===p?0:p,C=e.factor,m=void 0===C?4:C,b=e.fade,v=void 0!==b&&b,A=u.useRef(),y=u.useMemo((function(){for(var e=[],t=[],n=Array.from({length:f},(function(){return(.5+.5*Math.random())*m})),a=new l.Color,o=i+s,u=s/f,c=0;c<f;c++)o-=u*Math.random(),e.push.apply(e,Object(r.a)(d(o).toArray())),a.setHSL(c/f,I,.9),t.push(a.r,a.g,a.b);return[new Float32Array(e),new Float32Array(t),new Float32Array(n)]}),[f,s,m,i,I]),w=Object(a.a)(y,3),G=w[0],B=w[1],x=w[2];Object(c.f)((function(e){return A.current&&(A.current.uniforms.time.value=e.clock.getElapsedTime())}));var S=u.useState((function(){return new g})),k=Object(a.a)(S,1)[0];return u.createElement("points",{ref:t},u.createElement("bufferGeometry",{attach:"geometry"},u.createElement("bufferAttribute",{attachObject:["attributes","position"],args:[G,3]}),u.createElement("bufferAttribute",{attachObject:["attributes","color"],args:[B,3]}),u.createElement("bufferAttribute",{attachObject:["attributes","size"],args:[x,1]})),u.createElement("primitive",{dispose:void 0,ref:A,object:k,attach:"material",blending:l.AdditiveBlending,"uniforms-fade-value":v,transparent:!0,vertexColors:!0}))}))},function(e,t,n){"use strict";var r=n(25),a=n(2),i=n.n(a),o=(n(52),n(260)),s=n(395),u=n(263);t.a=function(e){var t=e.children,n=e.theme,a=Object(s.a)(),c=i.a.useMemo((function(){var e=null===a?n:function(e,t){return"function"===typeof t?t(e):Object(r.a)({},e,t)}(a,n);return null!=e&&(e[u.a]=null!==a),e}),[n,a]);return i.a.createElement(o.a.Provider,{value:c},t)}},function(e,t,n){"use strict";var r=n(25),a=n(2),i=(n(52),n(56)),o={WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box"},s=function(e){return Object(r.a)({color:e.palette.text.primary},e.typography.body2,{backgroundColor:e.palette.background.default,"@media print":{backgroundColor:e.palette.common.white}})};t.a=Object(i.a)((function(e){return{"@global":{html:o,"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:Object(r.a)({margin:0},s(e),{"&::backdrop":{backgroundColor:e.palette.background.default}})}}}),{name:"MuiCssBaseline"})((function(e){var t=e.children,n=void 0===t?null:t;return e.classes,a.createElement(a.Fragment,null,n)}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ye})),n.d(t,"b",(function(){return ze}));var r=n(25),a=n(38),i=n(2),o=n.n(i),s=(n(52),n(263)),u=["checked","disabled","error","focused","focusVisible","required","expanded","selected"];var c=n(82),l=Date.now(),g="fnValues"+l,d="fnStyle"+ ++l,h=function(){return{onCreateRule:function(e,t,n){if("function"!==typeof t)return null;var r=Object(c.c)(e,{},n);return r[d]=t,r},onProcessStyle:function(e,t){if(g in t||d in t)return e;var n={};for(var r in e){var a=e[r];"function"===typeof a&&(delete e[r],n[r]=a)}return t[g]=n,e},onUpdate:function(e,t,n,r){var a=t,i=a[d];i&&(a.style=i(e)||{});var o=a[g];if(o)for(var s in o)a.prop(s,o[s](e),r)}}},f="@global",p="@global ",I=function(){function e(e,t,n){for(var a in this.type="global",this.at=f,this.rules=void 0,this.options=void 0,this.key=void 0,this.isProcessed=!1,this.key=e,this.options=n,this.rules=new c.a(Object(r.a)({},n,{parent:this})),t)this.rules.add(a,t[a]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.addRule=function(e,t,n){var r=this.rules.add(e,t,n);return r&&this.options.jss.plugins.onProcessRule(r),r},t.indexOf=function(e){return this.rules.indexOf(e)},t.toString=function(){return this.rules.toString()},e}(),C=function(){function e(e,t,n){this.type="global",this.at=f,this.options=void 0,this.rule=void 0,this.isProcessed=!1,this.key=void 0,this.key=e,this.options=n;var a=e.substr(p.length);this.rule=n.jss.createRule(a,t,Object(r.a)({},n,{parent:this}))}return e.prototype.toString=function(e){return this.rule?this.rule.toString(e):""},e}(),m=/\s*,\s*/g;function b(e,t){for(var n=e.split(m),r="",a=0;a<n.length;a++)r+=t+" "+n[a].trim(),n[a+1]&&(r+=", ");return r}var v=function(){return{onCreateRule:function(e,t,n){if(!e)return null;if(e===f)return new I(e,t,n);if("@"===e[0]&&e.substr(0,p.length)===p)return new C(e,t,n);var r=n.parent;return r&&("global"===r.type||r.options.parent&&"global"===r.options.parent.type)&&(n.scoped=!1),!1===n.scoped&&(n.selector=e),null},onProcessRule:function(e,t){"style"===e.type&&t&&(function(e,t){var n=e.options,a=e.style,i=a?a[f]:null;if(i){for(var o in i)t.addRule(o,i[o],Object(r.a)({},n,{selector:b(o,e.selector)}));delete a[f]}}(e,t),function(e,t){var n=e.options,a=e.style;for(var i in a)if("@"===i[0]&&i.substr(0,f.length)===f){var o=b(i.substr(f.length),e.selector);t.addRule(o,a[i],Object(r.a)({},n,{selector:o})),delete a[i]}}(e,t))}}},A=/\s*,\s*/g,y=/&/g,w=/\$([\w-]+)/g;var G=function(){function e(e,t){return function(n,r){var a=e.getRule(r)||t&&t.getRule(r);return a?(a=a).selector:r}}function t(e,t){for(var n=t.split(A),r=e.split(A),a="",i=0;i<n.length;i++)for(var o=n[i],s=0;s<r.length;s++){var u=r[s];a&&(a+=", "),a+=-1!==u.indexOf("&")?u.replace(y,o):o+" "+u}return a}function n(e,t,n){if(n)return Object(r.a)({},n,{index:n.index+1});var a=e.options.nestingLevel;a=void 0===a?1:a+1;var i=Object(r.a)({},e.options,{nestingLevel:a,index:t.indexOf(e)+1});return delete i.name,i}return{onProcessStyle:function(a,i,o){if("style"!==i.type)return a;var s,u,c=i,l=c.options.parent;for(var g in a){var d=-1!==g.indexOf("&"),h="@"===g[0];if(d||h){if(s=n(c,l,s),d){var f=t(g,c.selector);u||(u=e(l,o)),f=f.replace(w,u),l.addRule(f,a[g],Object(r.a)({},s,{selector:f}))}else h&&l.addRule(g,{},s).addRule(c.key,a[g],{selector:c.selector});delete a[g]}}return a}}},B=/[A-Z]/g,x=/^ms-/,S={};function k(e){return"-"+e.toLowerCase()}var Z=function(e){if(S.hasOwnProperty(e))return S[e];var t=e.replace(B,k);return S[e]=x.test(t)?"-"+t:t};function R(e){var t={};for(var n in e){t[0===n.indexOf("--")?n:Z(n)]=e[n]}return e.fallbacks&&(Array.isArray(e.fallbacks)?t.fallbacks=e.fallbacks.map(R):t.fallbacks=R(e.fallbacks)),t}var N=function(){return{onProcessStyle:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)e[t]=R(e[t]);return e}return R(e)},onChangeValue:function(e,t,n){if(0===t.indexOf("--"))return e;var r=Z(t);return t===r?e:(n.prop(r,e),null)}}},O=c.e&&CSS?CSS.px:"px",W=c.e&&CSS?CSS.ms:"ms",F=c.e&&CSS?CSS.percent:"%";function M(e){var t=/(-[a-z])/g,n=function(e){return e[1].toUpperCase()},r={};for(var a in e)r[a]=e[a],r[a.replace(t,n)]=e[a];return r}var V=M({"animation-delay":W,"animation-duration":W,"background-position":O,"background-position-x":O,"background-position-y":O,"background-size":O,border:O,"border-bottom":O,"border-bottom-left-radius":O,"border-bottom-right-radius":O,"border-bottom-width":O,"border-left":O,"border-left-width":O,"border-radius":O,"border-right":O,"border-right-width":O,"border-top":O,"border-top-left-radius":O,"border-top-right-radius":O,"border-top-width":O,"border-width":O,"border-block":O,"border-block-end":O,"border-block-end-width":O,"border-block-start":O,"border-block-start-width":O,"border-block-width":O,"border-inline":O,"border-inline-end":O,"border-inline-end-width":O,"border-inline-start":O,"border-inline-start-width":O,"border-inline-width":O,"border-start-start-radius":O,"border-start-end-radius":O,"border-end-start-radius":O,"border-end-end-radius":O,margin:O,"margin-bottom":O,"margin-left":O,"margin-right":O,"margin-top":O,"margin-block":O,"margin-block-end":O,"margin-block-start":O,"margin-inline":O,"margin-inline-end":O,"margin-inline-start":O,padding:O,"padding-bottom":O,"padding-left":O,"padding-right":O,"padding-top":O,"padding-block":O,"padding-block-end":O,"padding-block-start":O,"padding-inline":O,"padding-inline-end":O,"padding-inline-start":O,"mask-position-x":O,"mask-position-y":O,"mask-size":O,height:O,width:O,"min-height":O,"max-height":O,"min-width":O,"max-width":O,bottom:O,left:O,top:O,right:O,inset:O,"inset-block":O,"inset-block-end":O,"inset-block-start":O,"inset-inline":O,"inset-inline-end":O,"inset-inline-start":O,"box-shadow":O,"text-shadow":O,"column-gap":O,"column-rule":O,"column-rule-width":O,"column-width":O,"font-size":O,"font-size-delta":O,"letter-spacing":O,"text-decoration-thickness":O,"text-indent":O,"text-stroke":O,"text-stroke-width":O,"word-spacing":O,motion:O,"motion-offset":O,outline:O,"outline-offset":O,"outline-width":O,perspective:O,"perspective-origin-x":F,"perspective-origin-y":F,"transform-origin":F,"transform-origin-x":F,"transform-origin-y":F,"transform-origin-z":F,"transition-delay":W,"transition-duration":W,"vertical-align":O,"flex-basis":O,"shape-margin":O,size:O,gap:O,grid:O,"grid-gap":O,"row-gap":O,"grid-row-gap":O,"grid-column-gap":O,"grid-template-rows":O,"grid-template-columns":O,"grid-auto-rows":O,"grid-auto-columns":O,"box-shadow-x":O,"box-shadow-y":O,"box-shadow-blur":O,"box-shadow-spread":O,"font-line-height":O,"text-shadow-x":O,"text-shadow-y":O,"text-shadow-blur":O});function T(e,t,n){if(null==t)return t;if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]=T(e,t[r],n);else if("object"===typeof t)if("fallbacks"===e)for(var a in t)t[a]=T(a,t[a],n);else for(var i in t)t[i]=T(e+"-"+i,t[i],n);else if("number"===typeof t&&!1===isNaN(t)){var o=n[e]||V[e];return!o||0===t&&o===O?t.toString():"function"===typeof o?o(t).toString():""+t+o}return t}var E=function(e){void 0===e&&(e={});var t=M(e);return{onProcessStyle:function(e,n){if("style"!==n.type)return e;for(var r in e)e[r]=T(r,e[r],t);return e},onChangeValue:function(e,n){return T(n,e,t)}}},j=n(157),L=n(123),X="",H="",Y="",z="",K=j.a&&"ontouchstart"in document.documentElement;if(j.a){var _={Moz:"-moz-",ms:"-ms-",O:"-o-",Webkit:"-webkit-"},D=document.createElement("p").style;for(var P in _)if(P+"Transform"in D){X=P,H=_[P];break}"Webkit"===X&&"msHyphens"in D&&(X="ms",H=_.ms,z="edge"),"Webkit"===X&&"-apple-trailing-word"in D&&(Y="apple")}var U=X,J=H,Q=Y,q=z,$=K;var ee={noPrefill:["appearance"],supportedProperty:function(e){return"appearance"===e&&("ms"===U?"-webkit-"+e:J+e)}},te={noPrefill:["color-adjust"],supportedProperty:function(e){return"color-adjust"===e&&("Webkit"===U?J+"print-"+e:e)}},ne=/[-\s]+(.)?/g;function re(e,t){return t?t.toUpperCase():""}function ae(e){return e.replace(ne,re)}function ie(e){return ae("-"+e)}var oe,se={noPrefill:["mask"],supportedProperty:function(e,t){if(!/^mask/.test(e))return!1;if("Webkit"===U){var n="mask-image";if(ae(n)in t)return e;if(U+ie(n)in t)return J+e}return e}},ue={noPrefill:["text-orientation"],supportedProperty:function(e){return"text-orientation"===e&&("apple"!==Q||$?e:J+e)}},ce={noPrefill:["transform"],supportedProperty:function(e,t,n){return"transform"===e&&(n.transform?e:J+e)}},le={noPrefill:["transition"],supportedProperty:function(e,t,n){return"transition"===e&&(n.transition?e:J+e)}},ge={noPrefill:["writing-mode"],supportedProperty:function(e){return"writing-mode"===e&&("Webkit"===U||"ms"===U&&"edge"!==q?J+e:e)}},de={noPrefill:["user-select"],supportedProperty:function(e){return"user-select"===e&&("Moz"===U||"ms"===U||"apple"===Q?J+e:e)}},he={supportedProperty:function(e,t){return!!/^break-/.test(e)&&("Webkit"===U?"WebkitColumn"+ie(e)in t&&J+"column-"+e:"Moz"===U&&("page"+ie(e)in t&&"page-"+e))}},fe={supportedProperty:function(e,t){if(!/^(border|margin|padding)-inline/.test(e))return!1;if("Moz"===U)return e;var n=e.replace("-inline","");return U+ie(n)in t&&J+n}},pe={supportedProperty:function(e,t){return ae(e)in t&&e}},Ie={supportedProperty:function(e,t){var n=ie(e);return"-"===e[0]||"-"===e[0]&&"-"===e[1]?e:U+n in t?J+e:"Webkit"!==U&&"Webkit"+n in t&&"-webkit-"+e}},Ce={supportedProperty:function(e){return"scroll-snap"===e.substring(0,11)&&("ms"===U?""+J+e:e)}},me={supportedProperty:function(e){return"overscroll-behavior"===e&&("ms"===U?J+"scroll-chaining":e)}},be={"flex-grow":"flex-positive","flex-shrink":"flex-negative","flex-basis":"flex-preferred-size","justify-content":"flex-pack",order:"flex-order","align-items":"flex-align","align-content":"flex-line-pack"},ve={supportedProperty:function(e,t){var n=be[e];return!!n&&(U+ie(n)in t&&J+n)}},Ae={flex:"box-flex","flex-grow":"box-flex","flex-direction":["box-orient","box-direction"],order:"box-ordinal-group","align-items":"box-align","flex-flow":["box-orient","box-direction"],"justify-content":"box-pack"},ye=Object.keys(Ae),we=function(e){return J+e},Ge=[ee,te,se,ue,ce,le,ge,de,he,fe,pe,Ie,Ce,me,ve,{supportedProperty:function(e,t,n){var r=n.multiple;if(ye.indexOf(e)>-1){var a=Ae[e];if(!Array.isArray(a))return U+ie(a)in t&&J+a;if(!r)return!1;for(var i=0;i<a.length;i++)if(!(U+ie(a[0])in t))return!1;return a.map(we)}return!1}}],Be=Ge.filter((function(e){return e.supportedProperty})).map((function(e){return e.supportedProperty})),xe=Ge.filter((function(e){return e.noPrefill})).reduce((function(e,t){return e.push.apply(e,Object(L.a)(t.noPrefill)),e}),[]),Se={};if(j.a){oe=document.createElement("p");var ke=window.getComputedStyle(document.documentElement,"");for(var Ze in ke)isNaN(Ze)||(Se[ke[Ze]]=ke[Ze]);xe.forEach((function(e){return delete Se[e]}))}function Re(e,t){if(void 0===t&&(t={}),!oe)return e;if(null!=Se[e])return Se[e];"transition"!==e&&"transform"!==e||(t[e]=e in oe.style);for(var n=0;n<Be.length&&(Se[e]=Be[n](e,oe.style,t),!Se[e]);n++);try{oe.style[e]=""}catch(r){return!1}return Se[e]}var Ne,Oe={},We={transition:1,"transition-property":1,"-webkit-transition":1,"-webkit-transition-property":1},Fe=/(^\s*[\w-]+)|, (\s*[\w-]+)(?![^()]*\))/g;function Me(e,t,n){if("var"===t)return"var";if("all"===t)return"all";if("all"===n)return", all";var r=t?Re(t):", "+Re(n);return r||(t||n)}function Ve(e,t){var n=t;if(!Ne||"content"===e)return t;if("string"!==typeof n||!isNaN(parseInt(n,10)))return n;var r=e+n;if(null!=Oe[r])return Oe[r];try{Ne.style[e]=n}catch(a){return Oe[r]=!1,!1}if(We[e])n=n.replace(Fe,Me);else if(""===Ne.style[e]&&("-ms-flex"===(n=J+n)&&(Ne.style[e]="-ms-flexbox"),Ne.style[e]=n,""===Ne.style[e]))return Oe[r]=!1,!1;return Ne.style[e]="",Oe[r]=n,Oe[r]}j.a&&(Ne=document.createElement("p"));var Te=function(){function e(t){for(var n in t){var r=t[n];if("fallbacks"===n&&Array.isArray(r))t[n]=r.map(e);else{var a=!1,i=Re(n);i&&i!==n&&(a=!0);var o=!1,s=Ve(i,Object(c.f)(r));s&&s!==r&&(o=!0),(a||o)&&(a&&delete t[n],t[i||n]=s||r)}}return t}return{onProcessRule:function(e){if("keyframes"===e.type){var t=e;t.at="-"===(n=t.at)[1]||"ms"===U?n:"@"+J+"keyframes"+n.substr(10)}var n},onProcessStyle:function(t,n){return"style"!==n.type?t:e(t)},onChangeValue:function(e,t){return Ve(t,Object(c.f)(e))||e}}};var Ee=function(){var e=function(e,t){return e.length===t.length?e>t?1:-1:e.length-t.length};return{onProcessStyle:function(t,n){if("style"!==n.type)return t;for(var r={},a=Object.keys(t).sort(e),i=0;i<a.length;i++)r[a[i]]=t[a[i]];return r}}};function je(){return{plugins:[h(),v(),G(),N(),E(),"undefined"===typeof window?null:Te(),Ee()]}}var Le,Xe=Object(c.b)(je()),He={disableGeneration:!1,generateClassName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.disableGlobal,n=void 0!==t&&t,r=e.productionPrefix,a=void 0===r?"jss":r,i=e.seed,o=void 0===i?"":i,c=""===o?"":"".concat(o,"-"),l=0,g=function(){return l+=1};return function(e,t){var r=t.options.name;if(r&&0===r.indexOf("Mui")&&!t.options.link&&!n){if(-1!==u.indexOf(e.key))return"Mui-".concat(e.key);var i="".concat(c).concat(r,"-").concat(e.key);return t.options.theme[s.a]&&""===o?"".concat(i,"-").concat(g()):i}return"".concat(c).concat(a).concat(g())}}(),jss:Xe,sheetsCache:null,sheetsManager:new Map,sheetsRegistry:null},Ye=o.a.createContext(He);function ze(e){var t=e.children,n=e.injectFirst,i=void 0!==n&&n,s=e.disableGeneration,u=void 0!==s&&s,l=Object(a.a)(e,["children","injectFirst","disableGeneration"]),g=o.a.useContext(Ye),d=Object(r.a)({},g,{disableGeneration:u},l);if(!d.jss.options.insertionPoint&&i&&"undefined"!==typeof window){if(!Le){var h=document.head;Le=document.createComment("mui-inject-first"),h.insertBefore(Le,h.firstChild)}d.jss=Object(c.b)({plugins:je().plugins,insertionPoint:Le})}return o.a.createElement(Ye.Provider,{value:d},t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return ge}));var r=n(1),a=n(9),i=n(12),o=n(13),s=n(15),u=new WeakMap,c=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).decoderPath="",a.decoderConfig={},a.decoderBinary=null,a.decoderPending=null,a.workerLimit=4,a.workerPool=[],a.workerNextTaskID=1,a.workerSourceURL="",a.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},a.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},a}return Object(a.a)(n,[{key:"setDecoderPath",value:function(e){return this.decoderPath=e,this}},{key:"setDecoderConfig",value:function(e){return this.decoderConfig=e,this}},{key:"setWorkerLimit",value:function(e){return this.workerLimit=e,this}},{key:"load",value:function(e,t,n,r){var a=this,i=new s.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(e){var n={attributeIDs:a.defaultAttributeIDs,attributeTypes:a.defaultAttributeTypes,useUniqueIDs:!1};a.decodeGeometry(e,n).then(t).catch(r)}),n,r)}},{key:"decodeDracoFile",value:function(e,t,n,r){var a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,a).then(t)}},{key:"decodeGeometry",value:function(e,t){var n=this;for(var r in t.attributeTypes){var a=t.attributeTypes[r];void 0!==a.BYTES_PER_ELEMENT&&(t.attributeTypes[r]=a.name)}var i,o=JSON.stringify(t);if(u.has(e)){var s=u.get(e);if(s.key===o)return s.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var c=this.workerNextTaskID++,l=e.byteLength,g=this._getWorker(c,l).then((function(n){return i=n,new Promise((function(n,r){i._callbacks[c]={resolve:n,reject:r},i.postMessage({type:"decode",id:c,taskConfig:t,buffer:e},[e])}))})).then((function(e){return n._createGeometry(e.geometry)}));return g.catch((function(){return!0})).then((function(){i&&c&&n._releaseTask(i,c)})),u.set(e,{key:o,promise:g}),g}},{key:"_createGeometry",value:function(e){var t=new s.BufferGeometry;e.index&&t.setIndex(new s.BufferAttribute(e.index.array,1));for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n],a=r.name,i=r.array,o=r.itemSize;t.setAttribute(a,new s.BufferAttribute(i,o))}return t}},{key:"_loadLibrary",value:function(e,t){var n=new s.FileLoader(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((function(t,r){n.load(e,t,void 0,r)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(n){var r=n[0];t||(e.decoderConfig.wasmBinary=n[1]);var a=l.toString(),i=["/* draco decoder */",r,"","/* worker */",a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([i]))})),this.decoderPending}},{key:"_getWorker",value:function(e,t){var n=this;return this._initDecoder().then((function(){if(n.workerPool.length<n.workerLimit){var r=new Worker(n.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:n.decoderConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},n.workerPool.push(r)}else n.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));var a=n.workerPool[n.workerPool.length-1];return a._taskCosts[e]=t,a._taskLoad+=t,a}))}},{key:"_releaseTask",value:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))}},{key:"dispose",value:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}]),n}(s.Loader);function l(){var e,t;function n(e,t,n,r,a,i){var o=i.num_components(),s=n.num_points()*o,u=s*a.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,a),l=e._malloc(u);t.GetAttributeDataArrayForAllPoints(n,i,c,u,l);var g=new a(e.HEAPF32.buffer,l,s).slice();return e._free(l),{name:r,array:g,itemSize:o}}onmessage=function(r){var a=r.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var i=a.buffer,o=a.taskConfig;t.then((function(e){var t=e.draco,r=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(i),i.byteLength);try{var u=function(e,t,r,a){var i,o,s=a.attributeIDs,u=a.attributeTypes,c=t.GetEncodedGeometryType(r);if(c===e.TRIANGULAR_MESH)i=new e.Mesh,o=t.DecodeBufferToMesh(r,i);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");i=new e.PointCloud,o=t.DecodeBufferToPointCloud(r,i)}if(!o.ok()||0===i.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var l={index:null,attributes:[]};for(var g in s){var d=self[u[g]],h=void 0,f=void 0;if(a.useUniqueIDs)f=s[g],h=t.GetAttributeByUniqueId(i,f);else{if(-1===(f=t.GetAttributeId(i,e[s[g]])))continue;h=t.GetAttribute(i,f)}l.attributes.push(n(e,t,i,g,d,h))}c===e.TRIANGULAR_MESH&&(l.index=function(e,t,n){var r=3*n.num_faces(),a=4*r,i=e._malloc(a);t.GetTrianglesUInt32Array(n,a,i);var o=new Uint32Array(e.HEAPF32.buffer,i,r).slice();return e._free(i),{array:o,itemSize:1}}(e,t,i));return e.destroy(i),l}(t,r,s,o),c=u.attributes.map((function(e){return e.array.buffer}));u.index&&c.push(u.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:u},c)}catch(l){console.error(l),self.postMessage({type:"error",id:a.id,error:l.message})}finally{t.destroy(s),t.destroy(r)}}))}}}var g=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!==typeof WebAssembly)return{supported:!1};var n,r="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(r="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",console.log("Warning: meshopt_decoder is using experimental SIMD support"));var a=WebAssembly.instantiate(function(e){for(var n=new Uint8Array(e.length),r=0;r<e.length;++r){var a=e.charCodeAt(r);n[r]=a>96?a-71:a>64?a-65:a>47?a+4:a>46?63:62}var i=0;for(r=0;r<e.length;++r)n[i++]=n[r]<60?t[n[r]]:64*(n[r]-60)+n[++r];return n.buffer.slice(0,i)}(r),{}).then((function(e){(n=e.instance).exports.__wasm_call_ctors()}));function i(e,t,r,a,i,o){var s=n.exports.sbrk,u=r+3&-4,c=s(u*a),l=s(i.length),g=new Uint8Array(n.exports.memory.buffer);g.set(i,l);var d=e(c,r,a,l,i.length);if(0==d&&o&&o(c,u,a),t.set(g.subarray(c,c+r*a)),s(c-s(0)),0!=d)throw new Error("Malformed buffer data: "+d)}var o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},s={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:a,supported:!0,decodeVertexBuffer:function(e,t,r,a,s){i(n.exports.meshopt_decodeVertexBuffer,e,t,r,a,n.exports[o[s]])},decodeIndexBuffer:function(e,t,r,a){i(n.exports.meshopt_decodeIndexBuffer,e,t,r,a)},decodeIndexSequence:function(e,t,r,a){i(n.exports.meshopt_decodeIndexSequence,e,t,r,a)},decodeGltfBuffer:function(e,t,r,a,u,c){i(n.exports[s[u]],e,t,r,a,n.exports[o[c]])}}}(),d=n(50),h=n(23),f=n(22),p=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).dracoLoader=null,a.ktx2Loader=null,a.meshoptDecoder=null,a.pluginCallbacks=[],a.register((function(e){return new v(e)})),a.register((function(e){return new y(e)})),a.register((function(e){return new w(e)})),a.register((function(e){return new A(e)})),a.register((function(e){return new m(e)})),a.register((function(e){return new G(e)})),a}return Object(a.a)(n,[{key:"load",value:function(e,t,n,r){var a,i=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:s.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);var o=function(t){r?r(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},u=new s.FileLoader(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,(function(n){try{i.parse(n,a,(function(n){t(n),i.manager.itemEnd(e)}),o)}catch(r){o(r)}}),n,o)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,n,r){var a,i={},o={};if("string"===typeof e)a=e;else if(s.LoaderUtils.decodeText(new Uint8Array(e,0,4))===B){try{i[C.KHR_BINARY_GLTF]=new k(e)}catch(p){return void(r&&r(p))}a=i[C.KHR_BINARY_GLTF].content}else a=s.LoaderUtils.decodeText(new Uint8Array(e));var u=JSON.parse(a);if(void 0===u.asset||u.asset.version[0]<2)r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var c=new ie(u,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(var l=0;l<this.pluginCallbacks.length;l++){var g=this.pluginCallbacks[l](c);o[g.name]=g,i[g.name]=!0}if(u.extensionsUsed)for(var d=0;d<u.extensionsUsed.length;++d){var h=u.extensionsUsed[d],f=u.extensionsRequired||[];switch(h){case C.KHR_MATERIALS_UNLIT:i[h]=new b;break;case C.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:i[h]=new O;break;case C.KHR_DRACO_MESH_COMPRESSION:i[h]=new Z(u,this.dracoLoader);break;case C.KHR_TEXTURE_TRANSFORM:i[h]=new R;break;case C.KHR_MESH_QUANTIZATION:i[h]=new W;break;default:f.indexOf(h)>=0&&void 0===o[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(i),c.setPlugins(o),c.parse(n,r)}}}]),n}(s.Loader);function I(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var C={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},m=function(){function e(t){Object(r.a)(this,e),this.parser=t,this.name=C.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return Object(a.a)(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var a=t[n];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var a,i=t.json,o=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e],u=new s.Color(16777215);void 0!==o.color&&u.fromArray(o.color);var c=void 0!==o.range?o.range:0;switch(o.type){case"directional":(a=new s.DirectionalLight(u)).target.position.set(0,0,-1),a.add(a.target);break;case"point":(a=new s.PointLight(u)).distance=c;break;case"spot":(a=new s.SpotLight(u)).distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,void 0!==o.intensity&&(a.intensity=o.intensity),a.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(a),t.cache.add(n,r),r}},{key:"createNodeAttachment",value:function(e){var t=this,n=this.parser,r=n.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then((function(e){return n._getNodeRef(t.cache,a,e)}))}}]),e}(),b=function(){function e(){Object(r.a)(this,e),this.name=C.KHR_MATERIALS_UNLIT}return Object(a.a)(e,[{key:"getMaterialType",value:function(){return s.MeshBasicMaterial}},{key:"extendParams",value:function(e,t,n){var r=[];e.color=new s.Color(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var i=a.baseColorFactor;e.color.fromArray(i),e.opacity=i[3]}void 0!==a.baseColorTexture&&r.push(n.assignTexture(e,"map",a.baseColorTexture))}return Promise.all(r)}}]),e}(),v=function(){function e(t){Object(r.a)(this,e),this.parser=t,this.name=C.KHR_MATERIALS_CLEARCOAT}return Object(a.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var a=[],i=r.extensions[this.name];if(void 0!==i.clearcoatFactor&&(t.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&a.push(n.assignTexture(t,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(t.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&a.push(n.assignTexture(t,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(a.push(n.assignTexture(t,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){var o=i.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new s.Vector2(o,-o)}return Promise.all(a)}}]),e}(),A=function(){function e(t){Object(r.a)(this,e),this.parser=t,this.name=C.KHR_MATERIALS_TRANSMISSION}return Object(a.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?s.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var a=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&a.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(a)}}]),e}(),y=function(){function e(t){Object(r.a)(this,e),this.parser=t,this.name=C.KHR_TEXTURE_BASISU}return Object(a.a)(e,[{key:"loadTexture",value:function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var a=r.extensions[this.name],i=n.images[a.source],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i,o)}}]),e}(),w=function(){function e(t){Object(r.a)(this,e),this.parser=t,this.name=C.EXT_TEXTURE_WEBP,this.isSupported=null}return Object(a.a)(e,[{key:"loadTexture",value:function(e){var t=this.name,n=this.parser,r=n.json,a=r.textures[e];if(!a.extensions||!a.extensions[t])return null;var i=a.extensions[t],o=r.images[i.source],s=n.textureLoader;if(o.uri){var u=n.options.manager.getHandler(o.uri);null!==u&&(s=u)}return this.detectSupport().then((function(a){if(a)return n.loadTextureImage(e,o,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),G=function(){function e(t){Object(r.a)(this,e),this.name=C.EXT_MESHOPT_COMPRESSION,this.parser=t}return Object(a.a)(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],a=this.parser.getDependency("buffer",r.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([a,i.ready]).then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,a=r.count,o=r.byteStride,s=new ArrayBuffer(a*o),u=new Uint8Array(e[0],t,n);return i.decodeGltfBuffer(new Uint8Array(s),a,o,u,r.mode,r.filter),s}))}return null}}]),e}(),B="glTF",x=1313821514,S=5130562,k=function e(t){Object(r.a)(this,e),this.name=C.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,12);if(this.header={magic:s.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==B)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var a=this.header.length-12,i=new DataView(t,12),o=0;o<a;){var u=i.getUint32(o,!0);o+=4;var c=i.getUint32(o,!0);if(o+=4,c===x){var l=new Uint8Array(t,12+o,u);this.content=s.LoaderUtils.decodeText(l)}else if(c===S){var g=12+o;this.body=t.slice(g,g+u)}o+=u}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")},Z=function(){function e(t,n){if(Object(r.a)(this,e),!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=C.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}return Object(a.a)(e,[{key:"decodePrimitive",value:function(e,t){var n=this.json,r=this.dracoLoader,a=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,o={},s={},u={};for(var c in i){var l=_[c]||c.toLowerCase();o[l]=i[c]}for(var g in e.attributes){var d=_[g]||g.toLowerCase();if(void 0!==i[g]){var h=n.accessors[e.attributes[g]],f=H[h.componentType];u[d]=f,s[d]=!0===h.normalized}}return t.getDependency("bufferView",a).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],a=s[n];void 0!==a&&(r.normalized=a)}t(e)}),o,u)}))}))}}]),e}(),R=function(){function e(){Object(r.a)(this,e),this.name=C.KHR_TEXTURE_TRANSFORM}return Object(a.a)(e,[{key:"extendTexture",value:function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e}}]),e}(),N=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;Object(r.a)(this,n),(a=t.call(this)).isGLTFSpecularGlossinessMaterial=!0;var i=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),o=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),g={specular:{value:(new s.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return a._extraUniforms=g,a.onBeforeCompile=function(e){for(var t in g)e.uniforms[t]=g[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",i).replace("#include <metalnessmap_pars_fragment>",o).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",l)},Object.defineProperties(Object(d.a)(a),{specular:{get:function(){return g.specular.value},set:function(e){g.specular.value=e}},specularMap:{get:function(){return g.specularMap.value},set:function(e){g.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return g.glossiness.value},set:function(e){g.glossiness.value=e}},glossinessMap:{get:function(){return g.glossinessMap.value},set:function(e){g.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete a.metalness,delete a.roughness,delete a.metalnessMap,delete a.roughnessMap,a.setValues(e),a}return Object(a.a)(n,[{key:"copy",value:function(e){return Object(h.a)(Object(f.a)(n.prototype),"copy",this).call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),n}(s.MeshStandardMaterial),O=function(){function e(){Object(r.a)(this,e),this.name=C.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return Object(a.a)(e,[{key:"getMaterialType",value:function(){return N}},{key:"extendParams",value:function(e,t,n){var r=t.extensions[this.name];e.color=new s.Color(1,1,1),e.opacity=1;var a=[];if(Array.isArray(r.diffuseFactor)){var i=r.diffuseFactor;e.color.fromArray(i),e.opacity=i[3]}if(void 0!==r.diffuseTexture&&a.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new s.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new s.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var o=r.specularGlossinessTexture;a.push(n.assignTexture(e,"glossinessMap",o)),a.push(n.assignTexture(e,"specularMap",o))}return Promise.all(a)}},{key:"createMaterial",value:function(e){var t=new N(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=s.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}]),e}(),W=function e(){Object(r.a)(this,e),this.name=C.KHR_MESH_QUANTIZATION},F=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e,a,i,o){return Object(r.a)(this,n),t.call(this,e,a,i,o)}return Object(a.a)(n,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r*3+r,i=0;i!==r;i++)t[i]=n[a+i];return t}}]),n}(s.Interpolant);F.prototype.beforeStart_=F.prototype.copySampleValue_,F.prototype.afterEnd_=F.prototype.copySampleValue_,F.prototype.interpolate_=function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=2*o,u=3*o,c=r-t,l=(n-t)/c,g=l*l,d=g*l,h=e*u,f=h-u,p=-2*d+3*g,I=d-g,C=1-p,m=I-g+l,b=0;b!==o;b++){var v=i[f+b+o],A=i[f+b+s]*c,y=i[h+b+o],w=i[h+b]*c;a[b]=C*v+m*A+p*y+I*w}return a};var M=0,V=1,T=2,E=3,j=4,L=5,X=6,H={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Y={9728:s.NearestFilter,9729:s.LinearFilter,9984:s.NearestMipmapNearestFilter,9985:s.LinearMipmapNearestFilter,9986:s.NearestMipmapLinearFilter,9987:s.LinearMipmapLinearFilter},z={33071:s.ClampToEdgeWrapping,33648:s.MirroredRepeatWrapping,10497:s.RepeatWrapping},K={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},D={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},P={CUBICSPLINE:void 0,LINEAR:s.InterpolateLinear,STEP:s.InterpolateDiscrete},U="OPAQUE",J="MASK",Q="BLEND";function q(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function $(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function ee(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function te(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(var i=0,o=a.length;i<o;i++)e.morphTargetDictionary[a[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function ne(e){var t=e.extensions&&e.extensions[C.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+re(t.attributes):e.indices+":"+re(e.attributes)+":"+e.mode}function re(e){for(var t="",n=Object.keys(e).sort(),r=0,a=n.length;r<a;r++)t+=n[r]+":"+e[n[r]]+";";return t}function ae(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new I,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new s.ImageBitmapLoader(this.options.manager):this.textureLoader=new s.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new s.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return Object(a.a)(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var n=this,r=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};$(a,i,r),ee(i,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(i)}))).then((function(){e(i)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,a=t.length;r<a;r++)for(var i=t[r].joints,o=0,s=i.length;o<s;o++)e[i[o]].isBone=!0;for(var u=0,c=e.length;u<c;u++){var l=e[u];void 0!==l.mesh&&(this._addNodeRef(this.meshCache,l.mesh),void 0!==l.skin&&(n[l.mesh].isSkinnedMesh=!0)),void 0!==l.camera&&this._addNodeRef(this.cameraCache,l.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,n){if(e.refs[t]<=1)return n;var r=n.clone();return r.name+="_instance_"+e.uses[t]++,r}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],r=0;r<t.length;r++){var a=e(t[r]);a&&n.push(a)}return n}},{key:"getDependency",value:function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[C.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,a){n.load(q(t.uri,r.path),e,void 0,(function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))}},{key:"loadAccessor",value:function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var a=[];return void 0!==r.bufferView?a.push(this.getDependency("bufferView",r.bufferView)):a.push(null),void 0!==r.sparse&&(a.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(a).then((function(e){var a,i,o=e[0],u=K[r.type],c=H[r.componentType],l=c.BYTES_PER_ELEMENT,g=l*u,d=r.byteOffset||0,h=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,f=!0===r.normalized;if(h&&h!==g){var p=Math.floor(d/h),I="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+p+":"+r.count,C=t.cache.get(I);C||(a=new c(o,p*h,r.count*h/l),C=new s.InterleavedBuffer(a,h/l),t.cache.add(I,C)),i=new s.InterleavedBufferAttribute(C,u,d%h/l,f)}else a=null===o?new c(r.count*u):new c(o,d,r.count*u),i=new s.BufferAttribute(a,u,f);if(void 0!==r.sparse){var m=K.SCALAR,b=H[r.sparse.indices.componentType],v=r.sparse.indices.byteOffset||0,A=r.sparse.values.byteOffset||0,y=new b(e[1],v,r.sparse.count*m),w=new c(e[2],A,r.sparse.count*u);null!==o&&(i=new s.BufferAttribute(i.array.slice(),i.itemSize,i.normalized));for(var G=0,B=y.length;G<B;G++){var x=y[G];if(i.setX(x,w[G*u]),u>=2&&i.setY(x,w[G*u+1]),u>=3&&i.setZ(x,w[G*u+2]),u>=4&&i.setW(x,w[G*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i}))}},{key:"loadTexture",value:function(e){var t=this.json,n=this.options,r=t.textures[e],a=t.images[r.source],i=this.textureLoader;if(a.uri){var o=n.manager.getHandler(a.uri);null!==o&&(i=o)}return this.loadTextureImage(e,a,i)}},{key:"loadTextureImage",value:function(e,t,n){var r=this,a=this.json,i=this.options,o=a.textures[e],u=self.URL||self.webkitURL,c=t.uri,l=!1,g=!0;if("image/jpeg"===t.mimeType&&(g=!1),void 0!==t.bufferView)c=r.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){var n=new DataView(e,25,1).getUint8(0,!1);g=6===n||4===n||3===n}l=!0;var r=new Blob([e],{type:t.mimeType});return c=u.createObjectURL(r)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(c).then((function(e){return new Promise((function(t,r){var a=t;!0===n.isImageBitmapLoader&&(a=function(e){t(new s.CanvasTexture(e))}),n.load(q(e,i.path),a,void 0,r)}))})).then((function(t){!0===l&&u.revokeObjectURL(c),t.flipY=!1,o.name&&(t.name=o.name),g||(t.format=s.RGBFormat);var n=(a.samplers||{})[o.sampler]||{};return t.magFilter=Y[n.magFilter]||s.LinearFilter,t.minFilter=Y[n.minFilter]||s.LinearMipmapLinearFilter,t.wrapS=z[n.wrapS]||s.RepeatWrapping,t.wrapT=z[n.wrapT]||s.RepeatWrapping,r.associations.set(t,{type:"textures",index:e}),t}))}},{key:"assignTexture",value:function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(a){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[C.KHR_TEXTURE_TRANSFORM]){var i=void 0!==n.extensions?n.extensions[C.KHR_TEXTURE_TRANSFORM]:void 0;if(i){var o=r.associations.get(a);a=r.extensions[C.KHR_TEXTURE_TRANSFORM].extendTexture(a,i),r.associations.set(a,o)}}e[t]=a}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,n=e.material,r=void 0!==t.attributes.tangent,a=void 0!==t.attributes.color,i=void 0===t.attributes.normal,o=!0===e.isSkinnedMesh,u=Object.keys(t.morphAttributes).length>0,c=u&&void 0!==t.morphAttributes.normal;if(e.isPoints){var l="PointsMaterial:"+n.uuid,g=this.cache.get(l);g||(g=new s.PointsMaterial,s.Material.prototype.copy.call(g,n),g.color.copy(n.color),g.map=n.map,g.sizeAttenuation=!1,this.cache.add(l,g)),n=g}else if(e.isLine){var d="LineBasicMaterial:"+n.uuid,h=this.cache.get(d);h||(h=new s.LineBasicMaterial,s.Material.prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(d,h)),n=h}if(r||a||i||o||u){var f="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(f+="specular-glossiness:"),o&&(f+="skinning:"),r&&(f+="vertex-tangents:"),a&&(f+="vertex-colors:"),i&&(f+="flat-shading:"),u&&(f+="morph-targets:"),c&&(f+="morph-normals:");var p=this.cache.get(f);p||(p=n.clone(),o&&(p.skinning=!0),a&&(p.vertexColors=!0),i&&(p.flatShading=!0),u&&(p.morphTargets=!0),c&&(p.morphNormals=!0),r&&(p.vertexTangents=!0,p.normalScale&&(p.normalScale.y*=-1),p.clearcoatNormalScale&&(p.clearcoatNormalScale.y*=-1)),this.cache.add(f,p),this.associations.set(p,this.associations.get(n))),n=p}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}},{key:"getMaterialType",value:function(){return s.MeshStandardMaterial}},{key:"loadMaterial",value:function(e){var t,n=this,r=this.json,a=this.extensions,i=r.materials[e],o={},u=i.extensions||{},c=[];if(u[C.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=a[C.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),c.push(l.extendParams(o,i,n))}else if(u[C.KHR_MATERIALS_UNLIT]){var g=a[C.KHR_MATERIALS_UNLIT];t=g.getMaterialType(),c.push(g.extendParams(o,i,n))}else{var d=i.pbrMetallicRoughness||{};if(o.color=new s.Color(1,1,1),o.opacity=1,Array.isArray(d.baseColorFactor)){var h=d.baseColorFactor;o.color.fromArray(h),o.opacity=h[3]}void 0!==d.baseColorTexture&&c.push(n.assignTexture(o,"map",d.baseColorTexture)),o.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,o.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(n.assignTexture(o,"metalnessMap",d.metallicRoughnessTexture)),c.push(n.assignTexture(o,"roughnessMap",d.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),c.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===i.doubleSided&&(o.side=s.DoubleSide);var f=i.alphaMode||U;return f===Q?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,f===J&&(o.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==s.MeshBasicMaterial&&(c.push(n.assignTexture(o,"normalMap",i.normalTexture)),o.normalScale=new s.Vector2(1,-1),void 0!==i.normalTexture.scale&&o.normalScale.set(i.normalTexture.scale,-i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==s.MeshBasicMaterial&&(c.push(n.assignTexture(o,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(o.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==s.MeshBasicMaterial&&(o.emissive=(new s.Color).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==s.MeshBasicMaterial&&c.push(n.assignTexture(o,"emissiveMap",i.emissiveTexture)),Promise.all(c).then((function(){var r;return r=t===N?a[C.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new t(o),i.name&&(r.name=i.name),r.map&&(r.map.encoding=s.sRGBEncoding),r.emissiveMap&&(r.emissiveMap.encoding=s.sRGBEncoding),ee(r,i),n.associations.set(r,{type:"materials",index:e}),i.extensions&&$(a,r,i),r}))}},{key:"createUniqueName",value:function(e){for(var t=s.PropertyBinding.sanitizeNodeName(e||""),n=t,r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}},{key:"loadGeometries",value:function(e){var t=this,n=this.extensions,r=this.primitiveCache;function a(e){return n[C.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return se(n,e,t)}))}for(var i=[],o=0,u=e.length;o<u;o++){var c=e[o],l=ne(c),g=r[l];if(g)i.push(g.promise);else{var d=void 0;d=c.extensions&&c.extensions[C.KHR_DRACO_MESH_COMPRESSION]?a(c):se(new s.BufferGeometry,c,t),r[l]={primitive:c,promise:d},i.push(d)}}return Promise.all(i)}},{key:"loadMesh",value:function(e){for(var t,n=this,r=this.json,a=this.extensions,i=r.meshes[e],o=i.primitives,u=[],c=0,l=o.length;c<l;c++){var g=void 0===o[c].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new s.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:s.FrontSide})),t.DefaultMaterial):this.getDependency("material",o[c].material);u.push(g)}return u.push(n.loadGeometries(o)),Promise.all(u).then((function(t){for(var r=t.slice(0,t.length-1),u=t[t.length-1],c=[],l=0,g=u.length;l<g;l++){var d=u[l],h=o[l],f=void 0,p=r[l];if(h.mode===j||h.mode===L||h.mode===X||void 0===h.mode)!0!==(f=!0===i.isSkinnedMesh?new s.SkinnedMesh(d,p):new s.Mesh(d,p)).isSkinnedMesh||f.geometry.attributes.skinWeight.normalized||f.normalizeSkinWeights(),h.mode===L?f.geometry=ue(f.geometry,s.TriangleStripDrawMode):h.mode===X&&(f.geometry=ue(f.geometry,s.TriangleFanDrawMode));else if(h.mode===V)f=new s.LineSegments(d,p);else if(h.mode===E)f=new s.Line(d,p);else if(h.mode===T)f=new s.LineLoop(d,p);else{if(h.mode!==M)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);f=new s.Points(d,p)}Object.keys(f.geometry.morphAttributes).length>0&&te(f,i),f.name=n.createUniqueName(i.name||"mesh_"+e),ee(f,i),h.extensions&&$(a,f,h),n.assignFinalMaterial(f),c.push(f)}if(1===c.length)return c[0];for(var I=new s.Group,C=0,m=c.length;C<m;C++)I.add(c[C]);return I}))}},{key:"loadCamera",value:function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new s.PerspectiveCamera(s.MathUtils.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new s.OrthographicCamera(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ee(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}},{key:"loadAnimation",value:function(e){for(var t=this.json.animations[e],n=[],r=[],a=[],i=[],o=[],u=0,c=t.channels.length;u<c;u++){var l=t.channels[u],g=t.samplers[l.sampler],d=l.target,h=void 0!==d.node?d.node:d.id,f=void 0!==t.parameters?t.parameters[g.input]:g.input,p=void 0!==t.parameters?t.parameters[g.output]:g.output;n.push(this.getDependency("node",h)),r.push(this.getDependency("accessor",f)),a.push(this.getDependency("accessor",p)),i.push(g),o.push(d)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(a),Promise.all(i),Promise.all(o)]).then((function(n){for(var r=n[0],a=n[1],i=n[2],o=n[3],u=n[4],c=[],l=function(e,t){var n=r[e],l=a[e],g=i[e],d=o[e],h=u[e];if(void 0===n)return"continue";n.updateMatrix(),n.matrixAutoUpdate=!0;var f=void 0;switch(D[h.path]){case D.weights:f=s.NumberKeyframeTrack;break;case D.rotation:f=s.QuaternionKeyframeTrack;break;case D.position:case D.scale:default:f=s.VectorKeyframeTrack}var p=n.name?n.name:n.uuid,I=void 0!==d.interpolation?P[d.interpolation]:s.InterpolateLinear,C=[];D[h.path]===D.weights?n.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&C.push(e.name?e.name:e.uuid)})):C.push(p);var m=g.array;if(g.normalized){for(var b=ae(m.constructor),v=new Float32Array(m.length),A=0,y=m.length;A<y;A++)v[A]=m[A]*b;m=v}for(var w=0,G=C.length;w<G;w++){var B=new f(C[w]+"."+D[h.path],l.array,m,I);"CUBICSPLINE"===d.interpolation&&(B.createInterpolant=function(e){return new F(this.times,this.values,this.getValueSize()/3,e)},B.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(B)}},g=0,d=r.length;g<d;g++)l(g);var h=t.name?t.name:"animation_"+e;return new s.AnimationClip(h,void 0,c)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,n=this,r=t.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then((function(e){var t=n._getNodeRef(n.meshCache,r.mesh,e);return void 0!==r.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=r.weights.length;t<n;t++)e.morphTargetInfluences[t]=r.weights[t]})),t}))}},{key:"loadNode",value:function(e){var t=this.json,n=this.extensions,r=this,a=t.nodes[e],i=a.name?r.createUniqueName(a.name):"";return function(){var t=[],n=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return n&&t.push(n),void 0!==a.camera&&t.push(r.getDependency("camera",a.camera).then((function(e){return r._getNodeRef(r.cameraCache,a.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){var o;if((o=!0===a.isBone?new s.Bone:t.length>1?new s.Group:1===t.length?t[0]:new s.Object3D)!==t[0])for(var u=0,c=t.length;u<c;u++)o.add(t[u]);if(a.name&&(o.userData.name=a.name,o.name=i),ee(o,a),a.extensions&&$(n,o,a),void 0!==a.matrix){var l=new s.Matrix4;l.fromArray(a.matrix),o.applyMatrix4(l)}else void 0!==a.translation&&o.position.fromArray(a.translation),void 0!==a.rotation&&o.quaternion.fromArray(a.rotation),void 0!==a.scale&&o.scale.fromArray(a.scale);return r.associations.set(o,{type:"nodes",index:e}),o}))}},{key:"loadScene",value:function(e){var t=this.json,n=this.extensions,r=this.json.scenes[e],a=new s.Group;r.name&&(a.name=this.createUniqueName(r.name)),ee(a,r),r.extensions&&$(n,a,r);for(var i=r.nodes||[],o=[],u=0,c=i.length;u<c;u++)o.push(oe(i[u],a,t,this));return Promise.all(o).then((function(){return a}))}}]),e}();function oe(e,t,n,r){var a=n.nodes[e];return r.getDependency("node",e).then((function(e){return void 0===a.skin?e:r.getDependency("skin",a.skin).then((function(e){for(var n=[],a=0,i=(t=e).joints.length;a<i;a++)n.push(r.getDependency("node",t.joints[a]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],a=[],i=0,o=n.length;i<o;i++){var u=n[i];if(u){r.push(u);var c=new s.Matrix4;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*i),a.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[i])}e.bind(new s.Skeleton(r,a),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var i=[];if(a.children)for(var o=a.children,s=0,u=o.length;s<u;s++){var c=o[s];i.push(oe(c,e,n,r))}return Promise.all(i)}))}function se(e,t,n){var r=t.attributes,a=[];function i(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var o in r){var u=_[o]||o.toLowerCase();u in e.attributes||a.push(i(r[o],u))}if(void 0!==t.indices&&!e.index){var c=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));a.push(c)}return ee(e,t),function(e,t,n){var r=t.attributes,a=new s.Box3;if(void 0!==r.POSITION){var i=n.json.accessors[r.POSITION],o=i.min,u=i.max;if(void 0!==o&&void 0!==u){if(a.set(new s.Vector3(o[0],o[1],o[2]),new s.Vector3(u[0],u[1],u[2])),i.normalized){var c=ae(H[i.componentType]);a.min.multiplyScalar(c),a.max.multiplyScalar(c)}var l=t.targets;if(void 0!==l){for(var g=new s.Vector3,d=new s.Vector3,h=0,f=l.length;h<f;h++){var p=l[h];if(void 0!==p.POSITION){var I=n.json.accessors[p.POSITION],C=I.min,m=I.max;if(void 0!==C&&void 0!==m){if(d.setX(Math.max(Math.abs(C[0]),Math.abs(m[0]))),d.setY(Math.max(Math.abs(C[1]),Math.abs(m[1]))),d.setZ(Math.max(Math.abs(C[2]),Math.abs(m[2]))),I.normalized){var b=ae(H[I.componentType]);d.multiplyScalar(b)}g.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}a.expandByVector(g)}e.boundingBox=a;var v=new s.Sphere;a.getCenter(v.center),v.radius=a.min.distanceTo(a.max)/2,e.boundingSphere=v}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(a).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,a=!1,i=0,o=t.length;i<o;i++){var s=t[i];if(void 0!==s.POSITION&&(r=!0),void 0!==s.NORMAL&&(a=!0),r&&a)break}if(!r&&!a)return Promise.resolve(e);for(var u=[],c=[],l=0,g=t.length;l<g;l++){var d=t[l];if(r){var h=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;u.push(h)}if(a){var f=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal;c.push(f)}}return Promise.all([Promise.all(u),Promise.all(c)]).then((function(t){var n=t[0],i=t[1];return r&&(e.morphAttributes.position=n),a&&(e.morphAttributes.normal=i),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function ue(e,t){var n=e.getIndex();if(null===n){var r=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var i=0;i<a.count;i++)r.push(i);e.setIndex(r),n=e.getIndex()}var o=n.count-2,u=[];if(t===s.TriangleFanDrawMode)for(var c=1;c<=o;c++)u.push(n.getX(0)),u.push(n.getX(c)),u.push(n.getX(c+1));else for(var l=0;l<o;l++)l%2===0?(u.push(n.getX(l)),u.push(n.getX(l+1)),u.push(n.getX(l+2))):(u.push(n.getX(l+2)),u.push(n.getX(l+1)),u.push(n.getX(l)));u.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var g=e.clone();return g.setIndex(u),g}var ce=n(47);function le(e,t){return function(n){if(e){var r=new c;r.setDecoderPath("string"===typeof e?e:"https://www.gstatic.com/draco/v1/decoders/"),n.setDRACOLoader(r)}t&&n.setMeshoptDecoder(g)}}function ge(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(ce.g)(p,e,le(t,n));return r}ge.preload=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return ce.g.preload(p,e,le(t,n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(3),a=n(101),i=n(25),o=n(2),s=n(1),u=n(12),c=n(13);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=n(15),d=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){return Object(s.a)(this,n),t.call(this,new g.BoxGeometry(1,1,1),n.material)}return n}(g.Mesh);l(d,"SkyShader",{uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new g.Vector3},up:{value:new g.Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","#include <tonemapping_fragment>","#include <encodings_fragment>","}"].join("\n")}),l(d,"material",new g.ShaderMaterial({name:"SkyShader",fragmentShader:d.SkyShader.fragmentShader,vertexShader:d.SkyShader.vertexShader,uniforms:g.UniformsUtils.clone(d.SkyShader.uniforms),side:g.BackSide,depthWrite:!1}));var h=o.forwardRef((function(e,t){var n=e.inclination,s=void 0===n?0:n,u=e.azimuth,c=void 0===u?.25:u,l=e.distance,h=void 0===l?100:l,f=e.mieCoefficient,p=void 0===f?.005:f,I=e.mieDirectionalG,C=void 0===I?.8:I,m=e.rayleigh,b=void 0===m?1:m,v=e.turbidity,A=void 0===v?2:v,y=e.sunPosition,w=void 0===y?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new g.Vector3,r=Math.PI*(e-.5),a=2*Math.PI*(t-.5);return n.x=Math.cos(a),n.y=Math.sin(r),n.z=Math.sin(a),n}(s,c):y,G=Object(a.a)(e,["inclination","azimuth","distance","mieCoefficient","mieDirectionalG","rayleigh","turbidity","sunPosition"]),B=o.useMemo((function(){return(new g.Vector3).setScalar(h)}),[h]),x=o.useState((function(){return new d})),S=Object(r.a)(x,1)[0];return o.createElement("primitive",Object(i.a)({dispose:void 0,object:S,ref:t,"material-uniforms-mieCoefficient-value":p,"material-uniforms-mieDirectionalG-value":C,"material-uniforms-rayleigh-value":b,"material-uniforms-sunPosition-value":w,"material-uniforms-turbidity-value":A,scale:B},G))}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(26),a=n(3),i=n(2),o=n(21),s=n(15),u=n(7),c=n.n(u);function l(e){var t,n=new Set,r=function(e,r){var a="function"===typeof e?e(t):e;if(a!==t){var i=t;t=r?a:Object.assign({},t,a),n.forEach((function(e){return e(t,i)}))}},a=function(){return t},i={setState:r,getState:a,subscribe:function(e,r,i){return r||i?function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,o=r(t);function s(){var n=r(t);if(!i(o,n)){var a=o;e(o=n,a)}}return n.add(s),function(){return n.delete(s)}}(e,r,i):(n.add(e),function(){return n.delete(e)})},destroy:function(){return n.clear()}};return t=e(r,a,i),i}var g="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?i.useEffect:i.useLayoutEffect;var d=0,h=function(e){var t="function"===typeof e?l(e):e,n=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,o=Object(i.useReducer)((function(e){return e+1}),0),s=Object(a.a)(o,2),u=s[1],c=t.getState(),l=Object(i.useRef)(c),d=Object(i.useRef)(n),h=Object(i.useRef)(r),f=Object(i.useRef)(!1),p=Object(i.useRef)();void 0===p.current&&(p.current=n(c));var I=!1;(l.current!==c||d.current!==n||h.current!==r||f.current)&&(e=n(c),I=!r(p.current,e)),g((function(){I&&(p.current=e),l.current=c,d.current=n,h.current=r,f.current=!1}));var C=Object(i.useRef)(c);return g((function(){var e=function(){try{var e=t.getState(),n=d.current(e);h.current(p.current,n)||(l.current=e,p.current=n,u())}catch(r){f.current=!0,u()}},n=t.subscribe(e);return t.getState()!==C.current&&e(),n}),[]),I?e:p.current};return Object.assign(n,t),n[Symbol.iterator]=c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("[useStore, api] = create() is deprecated and will be removed in v4"),e.next=3,n;case 3:return e.next=5,t;case 5:case"end":return e.stop()}}),e)})),n}((function(e){return s.DefaultLoadingManager.onStart=function(t,n,r){e({active:!0,item:t,loaded:n,total:r,progress:(n-d)/(r-d)*100})},s.DefaultLoadingManager.onLoad=function(){e({active:!1})},s.DefaultLoadingManager.onError=function(t){return e((function(e){return{errors:[].concat(Object(o.a)(e.errors),[t])}}))},s.DefaultLoadingManager.onProgress=function(t,n,r){n===r&&(d=r),e({active:!0,item:t,loaded:n,total:r,progress:(n-d)/(r-d)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}})),f=function(e){return"Loading ".concat(e,"%")};function p(e){var t=e.containerStyles,n=e.innerStyles,o=e.barStyles,s=e.dataStyles,u=e.dataInterpolation,c=void 0===u?f:u,l=e.initialState,g=void 0===l?function(e){return e}:l,d=h(),p=d.active,C=d.progress,m=i.useRef(0),b=i.useRef(0),v=i.useRef(null),A=i.useState(g(p)),y=Object(a.a)(A,2),w=y[0],G=y[1];i.useEffect((function(){var e;return p!==w&&(e=setTimeout((function(){return G(p)}),300)),function(){return clearTimeout(e)}}),[w,p]);var B=i.useCallback((function(){v.current&&(m.current+=(C-m.current)/2,(m.current>.95*C||100===C)&&(m.current=C),v.current.innerText=c(m.current),m.current<C&&(b.current=requestAnimationFrame(B)))}),[c,C]);return i.useEffect((function(){return B(),function(){return cancelAnimationFrame(b.current)}}),[B]),w?i.createElement("div",{style:Object(r.a)(Object(r.a)({},I.container),{},{opacity:p?1:0},t)},i.createElement("div",null,i.createElement("div",{style:Object(r.a)(Object(r.a)({},I.inner),n)},i.createElement("div",{style:Object(r.a)(Object(r.a)({},I.bar),{},{transform:"scaleX(".concat(C/100,")")},o)}),i.createElement("span",{ref:v,style:Object(r.a)(Object(r.a)({},I.data),s)})))):null}var I={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}}},function(e,t,n){"use strict";var r=n(25),a=n(38),i=n(2),o=(n(52),n(48)),s=n(465),u=n(464),c=n(56),l=n(62),g=n(217),d=n(398),h=n(51),f=n(106),p=n(90),I=n(110);function C(e,t){var n=function(e,t){var n,r=t.getBoundingClientRect();if(t.fakeTransform)n=t.fakeTransform;else{var a=window.getComputedStyle(t);n=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("transform")}var i=0,o=0;if(n&&"none"!==n&&"string"===typeof n){var s=n.split("(")[1].split(")")[0].split(",");i=parseInt(s[4],10),o=parseInt(s[5],10)}return"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(").concat(i-r.left,"px)"):"right"===e?"translateX(-".concat(r.left+r.width-i,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(").concat(o-r.top,"px)"):"translateY(-".concat(r.top+r.height-o,"px)")}(e,t);n&&(t.style.webkitTransform=n,t.style.transform=n)}var m={enter:p.b.enteringScreen,exit:p.b.leavingScreen},b=i.forwardRef((function(e,t){var n=e.children,o=e.direction,s=void 0===o?"down":o,u=e.in,c=e.onEnter,p=e.onEntered,b=e.onEntering,v=e.onExit,A=e.onExited,y=e.onExiting,w=e.style,G=e.timeout,B=void 0===G?m:G,x=e.TransitionComponent,S=void 0===x?d.a:x,k=Object(a.a)(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),Z=Object(f.a)(),R=i.useRef(null),N=i.useCallback((function(e){R.current=l.findDOMNode(e)}),[]),O=Object(h.a)(n.ref,N),W=Object(h.a)(O,t),F=function(e){return function(t){e&&(void 0===t?e(R.current):e(R.current,t))}},M=F((function(e,t){C(s,e),Object(I.b)(e),c&&c(e,t)})),V=F((function(e,t){var n=Object(I.a)({timeout:B,style:w},{mode:"enter"});e.style.webkitTransition=Z.transitions.create("-webkit-transform",Object(r.a)({},n,{easing:Z.transitions.easing.easeOut})),e.style.transition=Z.transitions.create("transform",Object(r.a)({},n,{easing:Z.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",b&&b(e,t)})),T=F(p),E=F(y),j=F((function(e){var t=Object(I.a)({timeout:B,style:w},{mode:"exit"});e.style.webkitTransition=Z.transitions.create("-webkit-transform",Object(r.a)({},t,{easing:Z.transitions.easing.sharp})),e.style.transition=Z.transitions.create("transform",Object(r.a)({},t,{easing:Z.transitions.easing.sharp})),C(s,e),v&&v(e)})),L=F((function(e){e.style.webkitTransition="",e.style.transition="",A&&A(e)})),X=i.useCallback((function(){R.current&&C(s,R.current)}),[s]);return i.useEffect((function(){if(!u&&"down"!==s&&"right"!==s){var e=Object(g.a)((function(){R.current&&C(s,R.current)}));return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}}),[s,u]),i.useEffect((function(){u||X()}),[u,X]),i.createElement(S,Object(r.a)({nodeRef:R,onEnter:M,onEntered:T,onEntering:V,onExit:j,onExited:L,onExiting:E,appear:!0,in:u,timeout:B},k),(function(e,t){return i.cloneElement(n,Object(r.a)({ref:W,style:Object(r.a)({visibility:"exited"!==e||u?void 0:"hidden"},w,n.props.style)},t))}))})),v=n(463),A=n(57),y={left:"right",right:"left",top:"down",bottom:"up"};var w={enter:p.b.enteringScreen,exit:p.b.leavingScreen},G=i.forwardRef((function(e,t){var n=e.anchor,c=void 0===n?"left":n,l=e.BackdropProps,g=e.children,d=e.classes,h=e.className,p=e.elevation,I=void 0===p?16:p,C=e.ModalProps,m=(C=void 0===C?{}:C).BackdropProps,G=Object(a.a)(C,["BackdropProps"]),B=e.onClose,x=e.open,S=void 0!==x&&x,k=e.PaperProps,Z=void 0===k?{}:k,R=e.SlideProps,N=e.TransitionComponent,O=void 0===N?b:N,W=e.transitionDuration,F=void 0===W?w:W,M=e.variant,V=void 0===M?"temporary":M,T=Object(a.a)(e,["anchor","BackdropProps","children","classes","className","elevation","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"]),E=Object(f.a)(),j=i.useRef(!1);i.useEffect((function(){j.current=!0}),[]);var L=function(e,t){return"rtl"===e.direction&&function(e){return-1!==["left","right"].indexOf(e)}(t)?y[t]:t}(E,c),X=i.createElement(v.a,Object(r.a)({elevation:"temporary"===V?I:0,square:!0},Z,{className:Object(o.a)(d.paper,d["paperAnchor".concat(Object(A.a)(L))],Z.className,"temporary"!==V&&d["paperAnchorDocked".concat(Object(A.a)(L))])}),g);if("permanent"===V)return i.createElement("div",Object(r.a)({className:Object(o.a)(d.root,d.docked,h),ref:t},T),X);var H=i.createElement(O,Object(r.a)({in:S,direction:y[L],timeout:F,appear:j.current},R),X);return"persistent"===V?i.createElement("div",Object(r.a)({className:Object(o.a)(d.root,d.docked,h),ref:t},T),H):i.createElement(s.a,Object(r.a)({BackdropProps:Object(r.a)({},l,m,{transitionDuration:F}),BackdropComponent:u.a,className:Object(o.a)(d.root,d.modal,h),open:S,onClose:B,ref:t},T,G),H)}));t.a=Object(c.a)((function(e){return{root:{},docked:{flex:"0 0 auto"},paper:{overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:e.zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},paperAnchorLeft:{left:0,right:"auto"},paperAnchorRight:{left:"auto",right:0},paperAnchorTop:{top:0,left:0,bottom:"auto",right:0,height:"auto",maxHeight:"100%"},paperAnchorBottom:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},paperAnchorDockedLeft:{borderRight:"1px solid ".concat(e.palette.divider)},paperAnchorDockedTop:{borderBottom:"1px solid ".concat(e.palette.divider)},paperAnchorDockedRight:{borderLeft:"1px solid ".concat(e.palette.divider)},paperAnchorDockedBottom:{borderTop:"1px solid ".concat(e.palette.divider)},modal:{}}}),{name:"MuiDrawer",flip:!1})(G)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),a=n(47),i=n(386),o=n.n(i),s=n(3);function u(e,t){"function"===typeof e?e(t):null!=e&&(e.current=t)}var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,a=r.useState(),i=Object(s.a)(a,2),o=i[0],c=i[1];return r.useLayoutEffect((function(){var t=e();return c(t),u(n,t),function(){return u(n,null)}}),t),o};function l(e){var t=e.showPanel,n=void 0===t?0:t,i=e.className,s=e.parent,u=c((function(){return new o.a}),[]);return r.useEffect((function(){if(u){var e=s&&s.current||document.body;u.showPanel(n),null==e||e.appendChild(u.dom),i&&u.dom.classList.add(i);var t=Object(a.c)((function(){return u.begin()})),r=Object(a.b)((function(){return u.end()}));return function(){null==e||e.removeChild(u.dom),t(),r()}}}),[s,u,i,n]),null}},function(e,t,n){"use strict";var r=n(25),a=n(124),i=n(38),o=n(83),s=n(2),u=n(62),c=(n(52),n(48)),l=n(498),g=n(58),d=n(56),h=n(57),f=n(497),p=n(342),I=n(395),C=n(496),m=n(142),b=n(105),v=n(51);function A(e){return"function"===typeof e?e():e}var y="undefined"!==typeof window?s.useLayoutEffect:s.useEffect,w={},G=s.forwardRef((function(e,t){var n=e.anchorEl,a=e.children,o=e.container,u=e.disablePortal,c=void 0!==u&&u,l=e.keepMounted,g=void 0!==l&&l,d=e.modifiers,h=e.open,f=e.placement,G=void 0===f?"bottom":f,B=e.popperOptions,x=void 0===B?w:B,S=e.popperRef,k=e.style,Z=e.transition,R=void 0!==Z&&Z,N=Object(i.a)(e,["anchorEl","children","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition"]),O=s.useRef(null),W=Object(v.a)(O,t),F=s.useRef(null),M=Object(v.a)(F,S),V=s.useRef(M);y((function(){V.current=M}),[M]),s.useImperativeHandle(S,(function(){return F.current}),[]);var T=s.useState(!0),E=T[0],j=T[1],L=function(e,t){if("ltr"===(t&&t.direction||"ltr"))return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(G,Object(I.a)()),X=s.useState(L),H=X[0],Y=X[1];s.useEffect((function(){F.current&&F.current.update()}));var z=s.useCallback((function(){if(O.current&&n&&h){F.current&&(F.current.destroy(),V.current(null));var e=function(e){Y(e.placement)},t=(A(n),new p.a(A(n),O.current,Object(r.a)({placement:L},x,{modifiers:Object(r.a)({},c?{}:{preventOverflow:{boundariesElement:"window"}},d,x.modifiers),onCreate:Object(m.a)(e,x.onCreate),onUpdate:Object(m.a)(e,x.onUpdate)})));V.current(t)}}),[n,c,d,h,L,x]),K=s.useCallback((function(e){Object(b.a)(W,e),z()}),[W,z]),_=function(){F.current&&(F.current.destroy(),V.current(null))};if(s.useEffect((function(){return function(){_()}}),[]),s.useEffect((function(){h||R||_()}),[h,R]),!g&&!h&&(!R||E))return null;var D={placement:H};return R&&(D.TransitionProps={in:h,onEnter:function(){j(!1)},onExited:function(){j(!0),_()}}),s.createElement(C.a,{disablePortal:c,container:o},s.createElement("div",Object(r.a)({ref:K,role:"tooltip"},N,{style:Object(r.a)({position:"fixed",top:0,left:0,display:h||!g||R?null:"none"},k)}),"function"===typeof a?a(D):a))})),B=n(216),x=n(131),S=n(164),k=n(106);function Z(e){return Math.round(1e5*e)/1e5}var R=!1,N=null;var O=s.forwardRef((function(e,t){var n=e.arrow,o=void 0!==n&&n,g=e.children,d=e.classes,p=e.disableFocusListener,I=void 0!==p&&p,C=e.disableHoverListener,m=void 0!==C&&C,A=e.disableTouchListener,y=void 0!==A&&A,w=e.enterDelay,Z=void 0===w?100:w,O=e.enterNextDelay,W=void 0===O?0:O,F=e.enterTouchDelay,M=void 0===F?700:F,V=e.id,T=e.interactive,E=void 0!==T&&T,j=e.leaveDelay,L=void 0===j?0:j,X=e.leaveTouchDelay,H=void 0===X?1500:X,Y=e.onClose,z=e.onOpen,K=e.open,_=e.placement,D=void 0===_?"bottom":_,P=e.PopperComponent,U=void 0===P?G:P,J=e.PopperProps,Q=e.title,q=e.TransitionComponent,$=void 0===q?f.a:q,ee=e.TransitionProps,te=Object(i.a)(e,["arrow","children","classes","disableFocusListener","disableHoverListener","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","id","interactive","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","title","TransitionComponent","TransitionProps"]),ne=Object(k.a)(),re=s.useState(),ae=re[0],ie=re[1],oe=s.useState(null),se=oe[0],ue=oe[1],ce=s.useRef(!1),le=s.useRef(),ge=s.useRef(),de=s.useRef(),he=s.useRef(),fe=Object(S.a)({controlled:K,default:!1,name:"Tooltip",state:"open"}),pe=Object(a.a)(fe,2),Ie=pe[0],Ce=pe[1],me=Ie,be=Object(B.a)(V);s.useEffect((function(){return function(){clearTimeout(le.current),clearTimeout(ge.current),clearTimeout(de.current),clearTimeout(he.current)}}),[]);var ve=function(e){clearTimeout(N),R=!0,Ce(!0),z&&z(e)},Ae=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t){var n=g.props;"mouseover"===t.type&&n.onMouseOver&&e&&n.onMouseOver(t),ce.current&&"touchstart"!==t.type||(ae&&ae.removeAttribute("title"),clearTimeout(ge.current),clearTimeout(de.current),Z||R&&W?(t.persist(),ge.current=setTimeout((function(){ve(t)}),R?W:Z)):ve(t))}},ye=Object(x.a)(),we=ye.isFocusVisible,Ge=ye.onBlurVisible,Be=ye.ref,xe=s.useState(!1),Se=xe[0],ke=xe[1],Ze=function(){Se&&(ke(!1),Ge())},Re=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t){ae||ie(t.currentTarget),we(t)&&(ke(!0),Ae()(t));var n=g.props;n.onFocus&&e&&n.onFocus(t)}},Ne=function(e){clearTimeout(N),N=setTimeout((function(){R=!1}),800+L),Ce(!1),Y&&Y(e),clearTimeout(le.current),le.current=setTimeout((function(){ce.current=!1}),ne.transitions.duration.shortest)},Oe=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(t){var n=g.props;"blur"===t.type&&(n.onBlur&&e&&n.onBlur(t),Ze()),"mouseleave"===t.type&&n.onMouseLeave&&t.currentTarget===ae&&n.onMouseLeave(t),clearTimeout(ge.current),clearTimeout(de.current),t.persist(),de.current=setTimeout((function(){Ne(t)}),L)}},We=function(e){ce.current=!0;var t=g.props;t.onTouchStart&&t.onTouchStart(e)},Fe=Object(v.a)(ie,t),Me=Object(v.a)(Be,Fe),Ve=s.useCallback((function(e){Object(b.a)(Me,u.findDOMNode(e))}),[Me]),Te=Object(v.a)(g.ref,Ve);""===Q&&(me=!1);var Ee=!me&&!m,je=Object(r.a)({"aria-describedby":me?be:null,title:Ee&&"string"===typeof Q?Q:null},te,g.props,{className:Object(c.a)(te.className,g.props.className),onTouchStart:We,ref:Te}),Le={};y||(je.onTouchStart=function(e){We(e),clearTimeout(de.current),clearTimeout(le.current),clearTimeout(he.current),e.persist(),he.current=setTimeout((function(){Ae()(e)}),M)},je.onTouchEnd=function(e){g.props.onTouchEnd&&g.props.onTouchEnd(e),clearTimeout(he.current),clearTimeout(de.current),e.persist(),de.current=setTimeout((function(){Ne(e)}),H)}),m||(je.onMouseOver=Ae(),je.onMouseLeave=Oe(),E&&(Le.onMouseOver=Ae(!1),Le.onMouseLeave=Oe(!1))),I||(je.onFocus=Re(),je.onBlur=Oe(),E&&(Le.onFocus=Re(!1),Le.onBlur=Oe(!1)));var Xe=s.useMemo((function(){return Object(l.a)({popperOptions:{modifiers:{arrow:{enabled:Boolean(se),element:se}}}},J)}),[se,J]);return s.createElement(s.Fragment,null,s.cloneElement(g,je),s.createElement(U,Object(r.a)({className:Object(c.a)(d.popper,E&&d.popperInteractive,o&&d.popperArrow),placement:D,anchorEl:ae,open:!!ae&&me,id:je["aria-describedby"],transition:!0},Le,Xe),(function(e){var t=e.placement,n=e.TransitionProps;return s.createElement($,Object(r.a)({timeout:ne.transitions.duration.shorter},n,ee),s.createElement("div",{className:Object(c.a)(d.tooltip,d["tooltipPlacement".concat(Object(h.a)(t.split("-")[0]))],ce.current&&d.touch,o&&d.tooltipArrow)},Q,o?s.createElement("span",{className:d.arrow,ref:ue}):null))})))}));t.a=Object(d.a)((function(e){return{popper:{zIndex:e.zIndex.tooltip,pointerEvents:"none"},popperInteractive:{pointerEvents:"auto"},popperArrow:{'&[x-placement*="bottom"] $arrow':{top:0,left:0,marginTop:"-0.71em",marginLeft:4,marginRight:4,"&::before":{transformOrigin:"0 100%"}},'&[x-placement*="top"] $arrow':{bottom:0,left:0,marginBottom:"-0.71em",marginLeft:4,marginRight:4,"&::before":{transformOrigin:"100% 0"}},'&[x-placement*="right"] $arrow':{left:0,marginLeft:"-0.71em",height:"1em",width:"0.71em",marginTop:4,marginBottom:4,"&::before":{transformOrigin:"100% 100%"}},'&[x-placement*="left"] $arrow':{right:0,marginRight:"-0.71em",height:"1em",width:"0.71em",marginTop:4,marginBottom:4,"&::before":{transformOrigin:"0 0"}}},tooltip:{backgroundColor:Object(g.b)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(10),lineHeight:"".concat(Z(1.4),"em"),maxWidth:300,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium},tooltipArrow:{position:"relative",margin:"0"},arrow:{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:Object(g.b)(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}},touch:{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:"".concat(Z(16/14),"em"),fontWeight:e.typography.fontWeightRegular},tooltipPlacementLeft:Object(o.a)({transformOrigin:"right center",margin:"0 24px "},e.breakpoints.up("sm"),{margin:"0 14px"}),tooltipPlacementRight:Object(o.a)({transformOrigin:"left center",margin:"0 24px"},e.breakpoints.up("sm"),{margin:"0 14px"}),tooltipPlacementTop:Object(o.a)({transformOrigin:"center bottom",margin:"24px 0"},e.breakpoints.up("sm"),{margin:"14px 0"}),tooltipPlacementBottom:Object(o.a)({transformOrigin:"center top",margin:"24px 0"},e.breakpoints.up("sm"),{margin:"14px 0"})}}),{name:"MuiTooltip",flip:!1})(O)},function(e,t,n){"use strict";var r=n(123),a=n(124),i=n(38),o=n(25),s=n(2),u=(n(52),n(48)),c=n(56),l=n(106),g=n(58),d=n(131),h=n(81),f=n(66),p=n(51),I=n(57),C=n(164);var m=Object(c.a)((function(e){return{thumb:{"&$open":{"& $offset":{transform:"scale(1) translateY(-10px)"}}},open:{},offset:Object(o.a)({zIndex:1},e.typography.body2,{fontSize:e.typography.pxToRem(12),lineHeight:1.2,transition:e.transitions.create(["transform"],{duration:e.transitions.duration.shortest}),top:-34,transformOrigin:"bottom center",transform:"scale(0)",position:"absolute"}),circle:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:"50% 50% 50% 0",backgroundColor:"currentColor",transform:"rotate(-45deg)"},label:{color:e.palette.primary.contrastText,transform:"rotate(45deg)"}}}),{name:"PrivateValueLabel"})((function(e){var t=e.children,n=e.classes,r=e.className,a=e.open,i=e.value,o=e.valueLabelDisplay;return"off"===o?t:s.cloneElement(t,{className:Object(u.a)(t.props.className,(a||"on"===o)&&n.open,n.thumb)},s.createElement("span",{className:Object(u.a)(n.offset,r)},s.createElement("span",{className:n.circle},s.createElement("span",{className:n.label},i))))}));function b(e,t){return e-t}function v(e,t,n){return Math.min(Math.max(t,e),n)}function A(e,t){return e.reduce((function(e,n,r){var a=Math.abs(t-n);return null===e||a<e.distance||a===e.distance?{distance:a,index:r}:e}),null).index}function y(e,t){if(void 0!==t.current&&e.changedTouches){for(var n=0;n<e.changedTouches.length;n+=1){var r=e.changedTouches[n];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function w(e,t,n){return 100*(e-t)/(n-t)}function G(e,t,n){var r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(function(e){if(Math.abs(e)<1){var t=e.toExponential().split("e-"),n=t[0].split(".")[1];return(n?n.length:0)+parseInt(t[1],10)}var r=e.toString().split(".")[1];return r?r.length:0}(t)))}function B(e){var t=e.values,n=e.source,r=e.newValue,a=e.index;if(t[a]===r)return n;var i=t.slice();return i[a]=r,i}function x(e){var t=e.sliderRef,n=e.activeIndex,r=e.setActive;t.current.contains(document.activeElement)&&Number(document.activeElement.getAttribute("data-index"))===n||t.current.querySelector('[role="slider"][data-index="'.concat(n,'"]')).focus(),r&&r(n)}var S={horizontal:{offset:function(e){return{left:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},"horizontal-reverse":{offset:function(e){return{right:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},vertical:{offset:function(e){return{bottom:"".concat(e,"%")}},leap:function(e){return{height:"".concat(e,"%")}}}},k=function(e){return e},Z=s.forwardRef((function(e,t){var n=e["aria-label"],c=e["aria-labelledby"],g=e["aria-valuetext"],Z=e.classes,R=e.className,N=e.color,O=void 0===N?"primary":N,W=e.component,F=void 0===W?"span":W,M=e.defaultValue,V=e.disabled,T=void 0!==V&&V,E=e.getAriaLabel,j=e.getAriaValueText,L=e.marks,X=void 0!==L&&L,H=e.max,Y=void 0===H?100:H,z=e.min,K=void 0===z?0:z,_=e.name,D=e.onChange,P=e.onChangeCommitted,U=e.onMouseDown,J=e.orientation,Q=void 0===J?"horizontal":J,q=e.scale,$=void 0===q?k:q,ee=e.step,te=void 0===ee?1:ee,ne=e.ThumbComponent,re=void 0===ne?"span":ne,ae=e.track,ie=void 0===ae?"normal":ae,oe=e.value,se=e.ValueLabelComponent,ue=void 0===se?m:se,ce=e.valueLabelDisplay,le=void 0===ce?"off":ce,ge=e.valueLabelFormat,de=void 0===ge?k:ge,he=Object(i.a)(e,["aria-label","aria-labelledby","aria-valuetext","classes","className","color","component","defaultValue","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","onMouseDown","orientation","scale","step","ThumbComponent","track","value","ValueLabelComponent","valueLabelDisplay","valueLabelFormat"]),fe=Object(l.a)(),pe=s.useRef(),Ie=s.useState(-1),Ce=Ie[0],me=Ie[1],be=s.useState(-1),ve=be[0],Ae=be[1],ye=Object(C.a)({controlled:oe,default:M,name:"Slider"}),we=Object(a.a)(ye,2),Ge=we[0],Be=we[1],xe=Array.isArray(Ge),Se=xe?Ge.slice().sort(b):[Ge];Se=Se.map((function(e){return v(e,K,Y)}));var ke=!0===X&&null!==te?Object(r.a)(Array(Math.floor((Y-K)/te)+1)).map((function(e,t){return{value:K+te*t}})):X||[],Ze=Object(d.a)(),Re=Ze.isFocusVisible,Ne=Ze.onBlurVisible,Oe=Ze.ref,We=s.useState(-1),Fe=We[0],Me=We[1],Ve=s.useRef(),Te=Object(p.a)(Oe,Ve),Ee=Object(p.a)(t,Te),je=Object(f.a)((function(e){var t=Number(e.currentTarget.getAttribute("data-index"));Re(e)&&Me(t),Ae(t)})),Le=Object(f.a)((function(){-1!==Fe&&(Me(-1),Ne()),Ae(-1)})),Xe=Object(f.a)((function(e){var t=Number(e.currentTarget.getAttribute("data-index"));Ae(t)})),He=Object(f.a)((function(){Ae(-1)})),Ye="rtl"===fe.direction,ze=Object(f.a)((function(e){var t,n=Number(e.currentTarget.getAttribute("data-index")),r=Se[n],a=(Y-K)/10,i=ke.map((function(e){return e.value})),o=i.indexOf(r),s=Ye?"ArrowLeft":"ArrowRight",u=Ye?"ArrowRight":"ArrowLeft";switch(e.key){case"Home":t=K;break;case"End":t=Y;break;case"PageUp":te&&(t=r+a);break;case"PageDown":te&&(t=r-a);break;case s:case"ArrowUp":t=te?r+te:i[o+1]||i[i.length-1];break;case u:case"ArrowDown":t=te?r-te:i[o-1]||i[0];break;default:return}if(e.preventDefault(),te&&(t=G(t,te,K)),t=v(t,K,Y),xe){var c=t;t=B({values:Se,source:Ge,newValue:t,index:n}).sort(b),x({sliderRef:Ve,activeIndex:t.indexOf(c)})}Be(t),Me(n),D&&D(e,t),P&&P(e,t)})),Ke=s.useRef(),_e=Q;Ye&&"vertical"!==Q&&(_e+="-reverse");var De=function(e){var t,n,r=e.finger,a=e.move,i=void 0!==a&&a,o=e.values,s=e.source,u=Ve.current.getBoundingClientRect(),c=u.width,l=u.height,g=u.bottom,d=u.left;if(t=0===_e.indexOf("vertical")?(g-r.y)/l:(r.x-d)/c,-1!==_e.indexOf("-reverse")&&(t=1-t),n=function(e,t,n){return(n-t)*e+t}(t,K,Y),te)n=G(n,te,K);else{var h=ke.map((function(e){return e.value}));n=h[A(h,n)]}n=v(n,K,Y);var f=0;if(xe){var p=n;f=(n=B({values:o,source:s,newValue:n,index:f=i?Ke.current:A(o,n)}).sort(b)).indexOf(p),Ke.current=f}return{newValue:n,activeIndex:f}},Pe=Object(f.a)((function(e){var t=y(e,pe);if(t){var n=De({finger:t,move:!0,values:Se,source:Ge}),r=n.newValue,a=n.activeIndex;x({sliderRef:Ve,activeIndex:a,setActive:me}),Be(r),D&&D(e,r)}})),Ue=Object(f.a)((function(e){var t=y(e,pe);if(t){var n=De({finger:t,values:Se,source:Ge}).newValue;me(-1),"touchend"===e.type&&Ae(-1),P&&P(e,n),pe.current=void 0;var r=Object(h.a)(Ve.current);r.removeEventListener("mousemove",Pe),r.removeEventListener("mouseup",Ue),r.removeEventListener("touchmove",Pe),r.removeEventListener("touchend",Ue)}})),Je=Object(f.a)((function(e){e.preventDefault();var t=e.changedTouches[0];null!=t&&(pe.current=t.identifier);var n=y(e,pe),r=De({finger:n,values:Se,source:Ge}),a=r.newValue,i=r.activeIndex;x({sliderRef:Ve,activeIndex:i,setActive:me}),Be(a),D&&D(e,a);var o=Object(h.a)(Ve.current);o.addEventListener("touchmove",Pe),o.addEventListener("touchend",Ue)}));s.useEffect((function(){var e=Ve.current;e.addEventListener("touchstart",Je);var t=Object(h.a)(e);return function(){e.removeEventListener("touchstart",Je),t.removeEventListener("mousemove",Pe),t.removeEventListener("mouseup",Ue),t.removeEventListener("touchmove",Pe),t.removeEventListener("touchend",Ue)}}),[Ue,Pe,Je]);var Qe=Object(f.a)((function(e){U&&U(e),e.preventDefault();var t=y(e,pe),n=De({finger:t,values:Se,source:Ge}),r=n.newValue,a=n.activeIndex;x({sliderRef:Ve,activeIndex:a,setActive:me}),Be(r),D&&D(e,r);var i=Object(h.a)(Ve.current);i.addEventListener("mousemove",Pe),i.addEventListener("mouseup",Ue)})),qe=w(xe?Se[0]:K,K,Y),$e=w(Se[Se.length-1],K,Y)-qe,et=Object(o.a)({},S[_e].offset(qe),S[_e].leap($e));return s.createElement(F,Object(o.a)({ref:Ee,className:Object(u.a)(Z.root,Z["color".concat(Object(I.a)(O))],R,T&&Z.disabled,ke.length>0&&ke.some((function(e){return e.label}))&&Z.marked,!1===ie&&Z.trackFalse,"vertical"===Q&&Z.vertical,"inverted"===ie&&Z.trackInverted),onMouseDown:Qe},he),s.createElement("span",{className:Z.rail}),s.createElement("span",{className:Z.track,style:et}),s.createElement("input",{value:Se.join(","),name:_,type:"hidden"}),ke.map((function(e,t){var n,r=w(e.value,K,Y),a=S[_e].offset(r);return n=!1===ie?-1!==Se.indexOf(e.value):"normal"===ie&&(xe?e.value>=Se[0]&&e.value<=Se[Se.length-1]:e.value<=Se[0])||"inverted"===ie&&(xe?e.value<=Se[0]||e.value>=Se[Se.length-1]:e.value>=Se[0]),s.createElement(s.Fragment,{key:e.value},s.createElement("span",{style:a,"data-index":t,className:Object(u.a)(Z.mark,n&&Z.markActive)}),null!=e.label?s.createElement("span",{"aria-hidden":!0,"data-index":t,style:a,className:Object(u.a)(Z.markLabel,n&&Z.markLabelActive)},e.label):null)})),Se.map((function(e,t){var r=w(e,K,Y),a=S[_e].offset(r);return s.createElement(ue,{key:t,valueLabelFormat:de,valueLabelDisplay:le,className:Z.valueLabel,value:"function"===typeof de?de($(e),t):de,index:t,open:ve===t||Ce===t||"on"===le,disabled:T},s.createElement(re,{className:Object(u.a)(Z.thumb,Z["thumbColor".concat(Object(I.a)(O))],Ce===t&&Z.active,T&&Z.disabled,Fe===t&&Z.focusVisible),tabIndex:T?null:0,role:"slider",style:a,"data-index":t,"aria-label":E?E(t):n,"aria-labelledby":c,"aria-orientation":Q,"aria-valuemax":$(Y),"aria-valuemin":$(K),"aria-valuenow":$(e),"aria-valuetext":j?j($(e),t):g,onKeyDown:ze,onFocus:je,onBlur:Le,onMouseOver:Xe,onMouseLeave:He}))})))}));t.a=Object(c.a)((function(e){return{root:{height:2,width:"100%",boxSizing:"content-box",padding:"13px 0",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",color:e.palette.primary.main,WebkitTapHighlightColor:"transparent","&$disabled":{pointerEvents:"none",cursor:"default",color:e.palette.grey[400]},"&$vertical":{width:2,height:"100%",padding:"0 13px"},"@media (pointer: coarse)":{padding:"20px 0","&$vertical":{padding:"0 20px"}},"@media print":{colorAdjust:"exact"}},colorPrimary:{},colorSecondary:{color:e.palette.secondary.main},marked:{marginBottom:20,"&$vertical":{marginBottom:"auto",marginRight:20}},vertical:{},disabled:{},rail:{display:"block",position:"absolute",width:"100%",height:2,borderRadius:1,backgroundColor:"currentColor",opacity:.38,"$vertical &":{height:"100%",width:2}},track:{display:"block",position:"absolute",height:2,borderRadius:1,backgroundColor:"currentColor","$vertical &":{width:2}},trackFalse:{"& $track":{display:"none"}},trackInverted:{"& $track":{backgroundColor:"light"===e.palette.type?Object(g.d)(e.palette.primary.main,.62):Object(g.a)(e.palette.primary.main,.5)},"& $rail":{opacity:1}},thumb:{position:"absolute",width:12,height:12,marginLeft:-6,marginTop:-5,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:e.transitions.create(["box-shadow"],{duration:e.transitions.duration.shortest}),"&::after":{position:"absolute",content:'""',borderRadius:"50%",left:-15,top:-15,right:-15,bottom:-15},"&$focusVisible,&:hover":{boxShadow:"0px 0px 0px 8px ".concat(Object(g.b)(e.palette.primary.main,.16)),"@media (hover: none)":{boxShadow:"none"}},"&$active":{boxShadow:"0px 0px 0px 14px ".concat(Object(g.b)(e.palette.primary.main,.16))},"&$disabled":{width:8,height:8,marginLeft:-4,marginTop:-3,"&:hover":{boxShadow:"none"}},"$vertical &":{marginLeft:-5,marginBottom:-6},"$vertical &$disabled":{marginLeft:-3,marginBottom:-4}},thumbColorPrimary:{},thumbColorSecondary:{"&$focusVisible,&:hover":{boxShadow:"0px 0px 0px 8px ".concat(Object(g.b)(e.palette.secondary.main,.16))},"&$active":{boxShadow:"0px 0px 0px 14px ".concat(Object(g.b)(e.palette.secondary.main,.16))}},active:{},focusVisible:{},valueLabel:{left:"calc(-50% - 4px)"},mark:{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor"},markActive:{backgroundColor:e.palette.background.paper,opacity:.8},markLabel:Object(o.a)({},e.typography.body2,{color:e.palette.text.secondary,position:"absolute",top:26,transform:"translateX(-50%)",whiteSpace:"nowrap","$vertical &":{top:"auto",left:26,transform:"translateY(50%)"},"@media (pointer: coarse)":{top:40,"$vertical &":{left:31}}}),markLabelActive:{color:e.palette.text.primary}}}),{name:"MuiSlider"})(Z)}]]);
//# sourceMappingURL=15.7cdeb6de.chunk.js.map